import{R as V,_ as D}from"./AuthenticatedLayout-G2k8vM3k.js";import{r as c,c as L,f as z,a as o,o as l,d as g,u as q,h as M,w as _,b as t,i as v,t as n,m as p,F as A,l as O,g as f,p as N}from"./app-BosDeu9q.js";import{_ as U}from"./PrimaryButton-STiVSC5k.js";import{_ as $}from"./SecondaryButton-B6E-c3zE.js";import G from"./CustomComposeEmailContent-gcsbDCq6.js";import H from"./CustomEmailApprovalContent-W-NLYz7u.js";import{_ as I}from"./EmailDetailsContent-yAbN27s7.js";import J from"./EmailActionContent-DRpaV1VK.js";import K from"./ReceivedEmailActionContent--M-dGnkk.js";import"./Modal-BmGRC3Dd.js";import"./InputLabel-BWlCNYFi.js";import"./InputError-vpzRpDny.js";import"./index-02j6vIIq.js";import"./BaseFormModal-DV79F91Q.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-_DQdc3EJ.js";import"./SelectDropdown-DkHSCcqm.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-wdL_4Jov.js";import"./MultiSelectDropdown-29CkYnDy.js";import"./createLucideIcon-D87RImiA.js";import"./plus-ChQxe4d5.js";import"./DangerButton-B-JXqq2e.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-CXrRDQtV.js";import"./CustomMultiSelect-Cz3hXxw6.js";import"./EmailEditor-rEgiL5hy.js";import"./EmailEditor.vue_vue_type_style_index_0_lang-oRkuZT9r.js";import"./useEmailSignature-D4ZGECbu.js";import"./useEmailTemplate-JedPxLIn.js";import"./EmailAttachmentsList-2-w0AclT.js";import"./TrashIcon-V33p34Ux.js";import"./TaskCreationForm-peRZrRBD.js";const Q={class:"flex items-center justify-between w-full"},W={class:"flex items-center gap-2"},X={class:"py-6 min-h-screen w-full"},Y={class:"w-full px-4 sm:px-6 lg:px-8"},Z={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ee={class:"p-6 text-gray-900"},te={key:0,class:"mb-4 text-red-600"},se={key:1,class:"animate-pulse space-y-3"},ae={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},le={class:"lg:col-span-2 space-y-6"},ie={class:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm"},oe={class:"font-medium"},de={key:0},re={class:"font-medium"},ne={key:1},ue={class:"font-medium"},me={key:2},pe={class:"font-medium"},ve={key:3},ce={class:"font-medium"},ge={key:0,class:"text-gray-500 text-sm"},_e={key:1,class:"text-red-600 text-sm"},fe={key:2,class:"text-gray-500 text-sm"},ye={key:3,class:"overflow-x-auto shadow rounded-md border border-gray-100"},xe={class:"min-w-full divide-y divide-gray-200"},be={class:"divide-y divide-gray-200"},we={class:"px-4 py-2"},he={class:"px-4 py-2"},ke={class:"px-4 py-2"},Ee={class:"px-4 py-2"},Ce={class:"px-4 py-2"},$e={class:"flex items-center gap-2"},Se={key:4,class:"mt-3 flex items-center gap-2"},Ae={class:"text-sm text-gray-600"},nt={__name:"Show",props:{id:{type:Number,required:!0}},setup(F){const h=F,y=c(!1),x=c(""),i=c(null),R=L(()=>{var a,e;return((a=i.value)==null?void 0:a.name)||((e=i.value)==null?void 0:e.email)||`User #${h.id}`}),j=async()=>{var a,e;y.value=!0,x.value="";try{const{data:u}=await N.get(`/api/users/${h.id}`);i.value=u}catch(u){console.error("Failed to load user",u),x.value=((e=(a=u==null?void 0:u.response)==null?void 0:a.data)==null?void 0:e.message)||"Failed to load user"}finally{y.value=!1}},k=c([]),E=c(!1),b=c(""),m=c({current_page:1,last_page:1,total:0}),C=async(a=1)=>{var e,u;E.value=!0,b.value="";try{const{data:d}=await N.get(`/api/users/${h.id}/emails`,{params:{page:a}});k.value=d.data||[],m.value={current_page:d.current_page||1,last_page:d.last_page||1,total:d.total||(Array.isArray(d.data)?d.data.length:0)}}catch(d){console.error("Failed to load user emails",d),b.value=((u=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:u.message)||"Failed to load emails"}finally{E.value=!1}},s=c({show:!1,mode:null,title:"",data:null,loading:!1}),B=a=>{s.value={show:!0,mode:"view-email",title:"Email Details",data:a,loading:!1}},P=a=>{s.value.show=!0,s.value.data=a,a.type==="received"&&(a.status==="pending_approval_received"||a.status==="received")?(s.value.mode="received-edit",s.value.title="Approve Received Email"):a.template_id?(s.value.mode="edit",s.value.title="Edit & Approve Template Email"):(s.value.mode="custom-edit",s.value.title="Edit & Approve Custom Email")},w=()=>{s.value.show=!1,C(m.value.current_page)},S=a=>{a<1||a>m.value.last_page||C(a)};return z(async()=>{await j(),await C(1)}),(a,e)=>(l(),o(A,null,[g(q(M),{title:`User: ${R.value}`},null,8,["title"]),g(D,null,{header:_(()=>[t("div",Q,[e[4]||(e[4]=t("div",{class:"flex items-center gap-3"},[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"User Details")],-1)),t("div",W,[g($,{as:"a",href:"/users"},{default:_(()=>e[3]||(e[3]=[p("Back to Users",-1)])),_:1,__:[3]})])])]),default:_(()=>{var u,d;return[t("div",X,[t("div",Y,[t("div",Z,[t("div",ee,[x.value?(l(),o("div",te,n(x.value),1)):v("",!0),y.value?(l(),o("div",se,e[5]||(e[5]=[t("div",{class:"h-5 bg-gray-200 rounded w-1/3"},null,-1),t("div",{class:"h-4 bg-gray-200 rounded w-1/2"},null,-1),t("div",{class:"h-32 bg-gray-100 rounded"},null,-1)]))):v("",!0),i.value&&!y.value?(l(),o("div",ae,[t("section",le,[t("div",null,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold mb-2"},"Profile",-1)),t("div",ie,[t("div",null,[e[6]||(e[6]=t("span",{class:"text-gray-500"},"Name:",-1)),e[7]||(e[7]=p()),t("span",oe,n(i.value.name),1)]),i.value.email?(l(),o("div",de,[e[8]||(e[8]=t("span",{class:"text-gray-500"},"Email:",-1)),e[9]||(e[9]=p()),t("span",re,n(i.value.email),1)])):v("",!0),(u=i.value.role_data)!=null&&u.name||i.value.role?(l(),o("div",ne,[e[10]||(e[10]=t("span",{class:"text-gray-500"},"Role:",-1)),e[11]||(e[11]=p()),t("span",ue,n(((d=i.value.role_data)==null?void 0:d.name)||i.value.role),1)])):v("",!0),i.value.user_type?(l(),o("div",me,[e[12]||(e[12]=t("span",{class:"text-gray-500"},"Type:",-1)),e[13]||(e[13]=p()),t("span",pe,n(i.value.user_type),1)])):v("",!0),i.value.timezone?(l(),o("div",ve,[e[14]||(e[14]=t("span",{class:"text-gray-500"},"Timezone:",-1)),e[15]||(e[15]=p()),t("span",ce,n(i.value.timezone),1)])):v("",!0)])]),t("div",null,[e[22]||(e[22]=t("div",{class:"flex items-center justify-between mb-2"},[t("h3",{class:"text-lg font-semibold"},"Emails")],-1)),E.value?(l(),o("div",ge,"Loading emails...")):b.value?(l(),o("div",_e,n(b.value),1)):k.value.length===0?(l(),o("div",fe,"No emails found for this user.")):(l(),o("div",ye,[t("table",xe,[e[19]||(e[19]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Subject"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Status"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Type"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Created"),t("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Actions")])],-1)),t("tbody",be,[(l(!0),o(A,null,O(k.value,r=>(l(),o("tr",{key:r.id},[t("td",we,n(r.subject||"(no subject)"),1),t("td",he,n(r.status),1),t("td",ke,n(r.type),1),t("td",Ee,n(new Date(r.created_at).toLocaleString()),1),t("td",Ce,[t("div",$e,[g(U,{onClick:T=>B(r)},{default:_(()=>e[17]||(e[17]=[p("View",-1)])),_:2,__:[17]},1032,["onClick"]),g(U,{onClick:T=>P(r)},{default:_(()=>e[18]||(e[18]=[p("Edit",-1)])),_:2,__:[18]},1032,["onClick"])])])]))),128))])])])),m.value.last_page>1?(l(),o("div",Se,[g($,{onClick:e[0]||(e[0]=r=>S(m.value.current_page-1)),disabled:m.value.current_page===1},{default:_(()=>e[20]||(e[20]=[p("Prev",-1)])),_:1,__:[20]},8,["disabled"]),t("span",Ae,"Page "+n(m.value.current_page)+" of "+n(m.value.last_page),1),g($,{onClick:e[1]||(e[1]=r=>S(m.value.current_page+1)),disabled:m.value.current_page===m.value.last_page},{default:_(()=>e[21]||(e[21]=[p("Next",-1)])),_:1,__:[21]},8,["disabled"])])):v("",!0)])]),e[23]||(e[23]=t("section",{class:"space-y-6"},[t("div",{class:"p-4 bg-gray-50 rounded border border-gray-100 text-sm text-gray-600"},"Additional user widgets can go here.")],-1))])):v("",!0)])])])]),g(V,{show:s.value.show,"onUpdate:show":e[2]||(e[2]=r=>s.value.show=r),title:s.value.title},{content:_(()=>{var r;return[s.value.mode==="custom-compose"?(l(),f(G,{key:0,initialRecipientEmail:((r=i.value)==null?void 0:r.email)||"",onSubmitted:w},null,8,["initialRecipientEmail"])):s.value.mode==="view-email"?(l(),f(I,{key:1,email:s.value.data},null,8,["email"])):s.value.mode==="edit"?(l(),f(J,{key:2,email:s.value.data,mode:"edit",onSubmitted:w},null,8,["email"])):s.value.mode==="custom-edit"?(l(),f(H,{key:3,email:s.value.data,mode:"edit",onSubmitted:w},null,8,["email"])):s.value.mode==="received-edit"?(l(),f(K,{key:4,email:s.value.data,mode:"edit",onSubmitted:w},null,8,["email"])):v("",!0)]}),_:1},8,["show","title"])]}),_:1})],64))}};export{nt as default};
