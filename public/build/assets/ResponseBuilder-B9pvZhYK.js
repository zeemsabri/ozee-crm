import{r as u,b as k,m as V,c as x,o as h,a as o,e as I,k as B,t as j,f as w,v as J}from"./app-CBdUZ0sn.js";import _ from"./FieldBuilder-CdxSnIuH.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C={class:"font-sans"},F={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},E={class:"p-0 md:pr-4"},M={class:"mt-4"},$={key:0,class:"mt-2"},z={class:"p-0 md:pl-4"},R={class:"mt-4"},U=["value"],D={__name:"ResponseBuilder",props:{responseVariables:{type:Array,default:()=>[]},responseJsonTemplate:{type:Array,default:()=>[]}},emits:["update:responseVariables","update:responseJsonTemplate"],setup(N,{emit:S}){const i=N,m=S,a=u([]),c=u(""),f=u(""),v=u(""),d=u(!1),b=r=>Array.isArray(r)?r.map(e=>{const t={...e};return Array.isArray(e.options)&&(t.options=e.options.join(", ")),e.schema&&(t.schema=b(e.schema)),Object.prototype.hasOwnProperty.call(e,"example")&&(t.example=e.example),t}):[],g=r=>(r||[]).map(e=>{const t={name:e.name,type:e.type,validations:e.validations||{}};return e.options&&(t.options=typeof e.options=="string"?e.options.split(",").map(n=>n.trim()):e.options),e.itemType&&(t.itemType=e.itemType),e.schema&&(t.schema=g(e.schema)),e.example!==void 0&&(t.example=e.example),t}),O=r=>Array.isArray(r)?r:typeof r=="string"?r.split(",").map(e=>e.trim()).filter(Boolean):[],y=(r=[])=>{const e={};return(r||[]).forEach(t=>{if(!t||!t.name)return;const n=t.name,T=t.type,s=t.example;switch(T){case"Text":case"Markdown":case"File":case"User":case"Date":e[n]=s!=null&&s!==""?s:`Enter your ${n} here.`;break;case"Number":e[n]=s!=null&&s!==""?Number(s):0;break;case"Boolean":typeof s=="boolean"?e[n]=s:typeof s=="string"?e[n]=s.toLowerCase()==="true":e[n]=!0;break;case"Select":case"MultiSelect":{const l=O(t.options);e[n]=s!=null&&s!==""?s:l;break}case"Object":e[n]=y(t.schema);break;case"Array":if(t.itemType==="Object")e[n]=[y(t.schema)];else{let l;const p=t.itemType||"Text";s!=null&&s!==""?p==="Number"?l=Number(s):p==="Boolean"?l=typeof s=="boolean"?s:String(s).toLowerCase()==="true":l=s:p==="Number"?l=0:p==="Boolean"?l=!0:l=`Placeholder for ${p}`,e[n]=[l]}break;default:e[n]=s??null}}),e};k(()=>{Array.isArray(i.responseVariables)&&i.responseVariables.length>0?a.value=JSON.parse(JSON.stringify(i.responseVariables)):Array.isArray(i.responseJsonTemplate)&&i.responseJsonTemplate.length>0?a.value=b(i.responseJsonTemplate):a.value=[];const r=g(a.value);c.value=JSON.stringify(r,null,2),f.value=JSON.stringify(y(a.value),null,2),m("update:responseVariables",JSON.parse(JSON.stringify(a.value))),m("update:responseJsonTemplate",r)});const A=()=>{try{const r=JSON.parse(v.value);if(!Array.isArray(r))throw new Error("Invalid JSON format. Please provide a top-level JSON array.");a.value=b(r)}catch(r){alert(`Error importing JSON: ${r.message}`)}};return V(a,()=>{const r=g(a.value);c.value=JSON.stringify(r,null,2),f.value=JSON.stringify(y(a.value),null,2),m("update:responseVariables",JSON.parse(JSON.stringify(a.value))),m("update:responseJsonTemplate",r)},{deep:!0}),(r,e)=>(h(),x("div",C,[o("div",F,[o("div",E,[e[4]||(e[4]=o("h2",{class:"text-3xl font-bold text-gray-800 mb-6"},"Response Form Builder",-1)),e[5]||(e[5]=o("p",{class:"text-gray-600 mb-8"}," Manually create the response structure for the AI. Changes here will update the JSON output. ",-1)),I(_,{schema:a.value,"onUpdate:schema":e[0]||(e[0]=t=>a.value=t)},null,8,["schema"]),o("div",M,[o("button",{type:"button",onClick:e[1]||(e[1]=t=>d.value=!d.value),class:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200"},j(d.value?"Hide Import JSON":"Import JSON"),1),d.value?(h(),x("div",$,[w(o("textarea",{id:"jsonImport","onUpdate:modelValue":e[2]||(e[2]=t=>v.value=t),rows:"5",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 resize-none font-mono",placeholder:"Paste your JSON schema here to import..."},null,512),[[J,v.value]]),o("div",{class:"mt-2 flex justify-end"},[o("button",{onClick:A,class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}," Import ")])])):B("",!0)])]),o("div",z,[o("details",null,[e[6]||(e[6]=o("summary",{class:"text-base font-semibold text-gray-800 cursor-pointer"},"Schema JSON (Raw)",-1)),e[7]||(e[7]=o("p",{class:"text-gray-600 mb-2 mt-2"},"This is the full schema definition that will be saved with the prompt.",-1)),w(o("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>c.value=t),rows:"16",readonly:"",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md shadow-sm bg-gray-50 focus:outline-none resize-none font-mono"},null,512),[[J,c.value]])]),o("div",R,[e[8]||(e[8]=o("h2",{class:"text-3xl font-bold text-gray-800 mb-2"},"AI JSON Preview",-1)),e[9]||(e[9]=o("p",{class:"text-gray-600 mb-4"},"Preview of the generated JSON that the AI is expected to return. You can customize example values per field on the left; this preview updates live.",-1)),o("textarea",{value:f.value,rows:"20",readonly:"",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md shadow-sm bg-gray-50 focus:outline-none resize-none font-mono"},null,8,U)])])])]))}},q=P(D,[["__scopeId","data-v-03edc18f"]]);export{q as default};
