import{r as f,s as U,w as L,u as T,c as D,o as r,a as _,b as s,d as y,i,g,e as c,h as l,f as k,k as V,v as q,F as B,j as P,t as C,q as A,n as j,l as F,m as S,x as z}from"./app-DMqHzysD.js";import{_ as I}from"./AuthenticatedLayout-DHEMnzAD.js";import{_ as M,a as E}from"./InputError-He9lqnax.js";import{P as W}from"./PrimaryButton-BTqvdFjJ.js";import{_ as Z}from"./TextInput-BmI6SV3L.js";import"./ApplicationLogo-BbLJBDVN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton-Dn7dLQjC.js";const G={class:"font-semibold text-xl text-gray-800 leading-tight"},H={class:"py-12"},J={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Q={class:"p-6 bg-white border-b border-gray-200"},X={class:"mb-6 border border-gray-200 rounded-lg overflow-hidden"},Y={class:"text-gray-500"},ee={key:0},se={key:1},te={key:0,class:"p-4"},oe={class:"mb-4"},re={class:"mb-6 border border-gray-200 rounded-lg overflow-hidden"},ie={class:"text-gray-500"},ne={key:0},le={key:1},ae={key:0,class:"p-4"},de={class:"mb-6 border border-gray-200 rounded-lg overflow-hidden"},ce={class:"text-gray-500"},ue={key:0},pe={key:1},me={key:0,class:"p-4"},ge={class:"mb-4"},fe={class:"relative"},ye={key:0,class:"text-sm text-gray-500"},ve={key:1},be=["onClick"],xe={class:"font-medium text-gray-800"},he={class:"text-gray-500"},we={key:0},_e={key:1},ke={key:0,class:"p-3"},Ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},je={class:"flex items-center h-5"},Ee=["id","value"],$e=["for"],Ve={class:"flex items-center justify-end mt-4"},Le={__name:"Edit",props:{role:Object,permissions:Object,rolePermissions:Array},setup(v){const u=v,b=f(!0),x=f(!0),h=f(!0),m=f({}),p=f(""),$=()=>{u.permissions&&Object.keys(u.permissions).forEach(o=>{m.value[o]=!1})};$();const w=o=>{if(!p.value)return!1;const e=p.value.toLowerCase();return o.name.toLowerCase().includes(e)||o.description&&o.description.toLowerCase().includes(e)},N=U(()=>{if(!p.value)return{};const o={};return Object.entries(u.permissions).forEach(([e,n])=>{const d=n.filter(a=>w(a));d.length>0&&(o[e]=d)}),o});L(p,o=>{if(!o){$();return}Object.keys(N.value).forEach(e=>{m.value[e]=!0})});const t=T({name:u.role.name,description:u.role.description||"",type:u.role.type||"",permissions:u.rolePermissions||[]}),O=async()=>{try{t.processing=!0;const o=await z.put(`/api/roles/${u.role.id}`,{name:t.name,description:t.description,permissions:t.permissions,type:t.type||"application"});t.clearErrors(),console.log("Role updated successfully",o.data)}catch(o){o.response&&o.response.status===422?(t.setError("name",o.response.data.errors.name),t.setError("description",o.response.data.errors.description),t.setError("permissions",o.response.data.errors.permissions)):console.error("Error updating role:",o)}finally{t.processing=!1}};return(o,e)=>(r(),D(I,null,{header:_(()=>[s("h2",G," Edit Role: "+C(v.role.name),1)]),default:_(()=>[s("div",H,[s("div",J,[s("div",K,[s("div",Q,[s("form",{onSubmit:y(O,["prevent"])},[s("div",X,[s("button",{onClick:e[0]||(e[0]=y(n=>b.value=!b.value,["prevent"])),class:"w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 transition-colors"},[e[9]||(e[9]=s("h3",{class:"text-lg font-semibold text-gray-900"},"Basic Information",-1)),s("span",Y,[b.value?(r(),i("span",ee,"▼")):(r(),i("span",se,"▶"))])]),b.value?(r(),i("div",te,[s("div",oe,[c(M,{for:"name",value:"Role Name"}),c(Z,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:l(t).name,"onUpdate:modelValue":e[1]||(e[1]=n=>l(t).name=n),required:"",autofocus:""},null,8,["modelValue"]),c(E,{class:"mt-2",message:l(t).errors.name},null,8,["message"])]),s("div",null,[c(M,{for:"description",value:"Role Description"}),k(s("textarea",{id:"description",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm","onUpdate:modelValue":e[2]||(e[2]=n=>l(t).description=n),rows:"3",placeholder:"Describe the purpose and scope of this role"},null,512),[[V,l(t).description]]),c(E,{class:"mt-2",message:l(t).errors.description},null,8,["message"])])])):g("",!0)]),s("div",re,[s("button",{onClick:e[3]||(e[3]=y(n=>x.value=!x.value,["prevent"])),class:"w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 transition-colors"},[e[10]||(e[10]=s("h3",{class:"text-lg font-semibold text-gray-900"},"Role Type",-1)),s("span",ie,[x.value?(r(),i("span",ne,"▼")):(r(),i("span",le,"▶"))])]),x.value?(r(),i("div",ae,[e[12]||(e[12]=s("p",{class:"text-sm text-gray-600 mb-2"},"Select the scope where this role will be applied",-1)),k(s("select",{id:"type",class:"block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm","onUpdate:modelValue":e[4]||(e[4]=n=>l(t).type=n),required:""},e[11]||(e[11]=[s("option",{value:""},"Select a type",-1),s("option",{value:"application"},"Application",-1),s("option",{value:"client"},"Client",-1),s("option",{value:"project"},"Project",-1)]),512),[[q,l(t).type]]),c(E,{class:"mt-2",message:l(t).errors.type},null,8,["message"])])):g("",!0)]),s("div",de,[s("button",{onClick:e[5]||(e[5]=y(n=>h.value=!h.value,["prevent"])),class:"w-full flex justify-between items-center p-4 bg-gray-50 hover:bg-gray-100 transition-colors"},[e[13]||(e[13]=s("h3",{class:"text-lg font-semibold text-gray-900"},"Permissions",-1)),s("span",ce,[h.value?(r(),i("span",ue,"▼")):(r(),i("span",pe,"▶"))])]),h.value?(r(),i("div",me,[e[16]||(e[16]=s("p",{class:"text-sm text-gray-600 mb-4"},"Select the permissions to assign to this role",-1)),s("div",ge,[s("div",fe,[e[15]||(e[15]=s("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},[s("svg",{class:"w-4 h-4 text-gray-500","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[s("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1)),k(s("input",{type:"search","onUpdate:modelValue":e[6]||(e[6]=n=>p.value=n),class:"block w-full p-2 pl-10 pr-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-indigo-500 focus:border-indigo-500",placeholder:"Search permissions..."},null,512),[[V,p.value]]),p.value?(r(),i("button",{key:0,onClick:e[7]||(e[7]=n=>p.value=""),class:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-700",type:"button"},e[14]||(e[14]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):g("",!0)])]),Object.keys(v.permissions).length===0?(r(),i("div",ye," No permissions available. Please create some permissions first. ")):(r(),i("div",ve,[(r(!0),i(B,null,P(v.permissions,(n,d)=>(r(),i("div",{key:d,class:"mb-6 border border-gray-200 rounded-lg overflow-hidden"},[s("button",{onClick:y(a=>m.value[d]=!m.value[d],["prevent"]),class:"w-full flex justify-between items-center p-3 bg-gray-50 hover:bg-gray-100 transition-colors"},[s("h4",xe,C(d),1),s("span",he,[m.value[d]?(r(),i("span",we,"▼")):(r(),i("span",_e,"▶"))])],8,be),m.value[d]?(r(),i("div",ke,[s("div",Ce,[(r(!0),i(B,null,P(n,a=>(r(),i("div",{key:a.id,class:"flex items-start"},[s("div",je,[k(s("input",{id:`permission-${a.id}`,type:"checkbox",value:a.id,"onUpdate:modelValue":e[8]||(e[8]=R=>l(t).permissions=R),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,Ee),[[A,l(t).permissions]])]),s("div",{class:j(["ml-3 text-sm",{"bg-yellow-100 p-1 rounded":w(a)}])},[s("label",{for:`permission-${a.id}`,class:j(["font-medium",w(a)?"text-gray-900":"text-gray-700"])},C(a.name),11,$e),a.description?(r(),i("p",{key:0,class:j(w(a)?"text-gray-700":"text-gray-500")},C(a.description),3)):g("",!0)],2)]))),128))])])):g("",!0)]))),128))])),c(E,{class:"mt-2",message:l(t).errors.permissions},null,8,["message"])])):g("",!0)]),s("div",Ve,[c(l(F),{href:o.route("admin.roles.index"),class:"inline-flex items-center px-4 py-2 bg-gray-300 border border-transparent rounded-md font-semibold text-xs text-gray-800 uppercase tracking-widest hover:bg-gray-400 active:bg-gray-500 focus:outline-none focus:border-gray-500 focus:ring focus:ring-gray-300 disabled:opacity-25 transition mr-2"},{default:_(()=>e[17]||(e[17]=[S(" Cancel ",-1)])),_:1,__:[17]},8,["href"]),c(W,{class:j(["ml-4",{"opacity-25":l(t).processing}]),disabled:l(t).processing},{default:_(()=>e[18]||(e[18]=[S(" Update Role ",-1)])),_:1,__:[18]},8,["class","disabled"])])],32)])])])])]),_:1}))}};export{Le as default};
