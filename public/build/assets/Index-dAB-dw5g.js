import{B as P,_ as L}from"./AuthenticatedLayout-2bGXdlTQ.js";import{q as I,r as g,s as z,f as G,a as d,o as m,d as i,u as l,h as H,w as _,b as t,i as y,m as x,t as c,F as C,l as J,g as M,p as q}from"./app-DNyLw3kL.js";import{P as U}from"./PrimaryButton-BqxAc8eF.js";import{D as $}from"./DangerButton-B7H3dFeC.js";import{_ as O}from"./Modal-LDWekqmT.js";import{_ as r}from"./InputLabel-aah-Wjzx.js";import{_ as u}from"./TextInput-25srFAic.js";import{_ as p}from"./InputError-hgXXzus2.js";import{_ as Q}from"./SecondaryButton-D4V817Pp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SelectDropdown-CTk_771u.js";import"./Checkbox-Dj4QO9mJ.js";import"./ApplicationLogo-B-Pw6S0R.js";import"./moment-BLMuvzoS.js";const W={class:"py-12"},X={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Y={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Z={class:"p-6 text-gray-900"},ee={key:0,class:"mb-6"},te={key:1,class:"text-gray-600"},ie={key:2,class:"text-red-600"},ae={key:3,class:"text-gray-600"},le={key:4},se={class:"min-w-full divide-y divide-gray-200"},oe={class:"bg-white divide-y divide-gray-200"},ne={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-6 py-4 whitespace-nowrap"},re={class:"px-6 py-4 whitespace-nowrap"},ue={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},de={class:"flex items-center space-x-2"},_e={class:"mb-4"},ce={class:"mb-4"},fe={class:"mb-4"},ge={class:"mb-4"},xe={class:"mb-4"},ve={class:"mb-4"},ye={class:"mb-4"},be={class:"mb-4"},ke={class:"mb-4"},we={class:"mb-4"},Ve={class:"mb-4"},je={class:"mb-4"},he={class:"p-6"},Te={key:0,class:"mt-4 text-gray-800"},Pe={key:1,class:"text-red-600 text-sm mb-4"},Ce={class:"mt-6 flex justify-end"},ze={__name:"Index",setup(Me){const{canDo:j}=I(),E=j("create_project_tiers"),D=j("edit_project_tiers"),N=j("delete_project_tiers"),h=g([]),T=g(!0),f=g(""),b=g(!1),k=g(!1),v=g(!1),a=z({id:null,name:"",point_multiplier:1,min_profit_margin_percentage:0,max_profit_margin_percentage:100,min_client_amount_pkr:0,max_client_amount_pkr:1e6}),w=g(null),V=async()=>{T.value=!0,f.value="";try{const n=await q.get("/api/project-tiers");h.value=n.data}catch(n){f.value="Failed to fetch project tiers.",console.error("Error fetching project tiers:",n)}finally{T.value=!1}},A=()=>{a.reset(),a.clearErrors(),b.value=!0},B=()=>{b.value=!1,V()},S=n=>{a.reset(),a.clearErrors(),a.id=n.id,a.name=n.name,a.point_multiplier=n.point_multiplier,a.min_profit_margin_percentage=n.min_profit_margin_percentage,a.max_profit_margin_percentage=n.max_profit_margin_percentage,a.min_client_amount_pkr=n.min_client_amount_pkr,a.max_client_amount_pkr=n.max_client_amount_pkr,k.value=!0},F=()=>{k.value=!1,V()},K=n=>{w.value=n,v.value=!0},R=()=>{q.delete(`/api/project-tiers/${w.value.id}`).then(()=>{v.value=!1,V()}).catch(n=>{f.value="Failed to delete project tier.",console.error("Error deleting project tier:",n)})};return G(()=>{V()}),(n,e)=>(m(),d(C,null,[i(l(H),{title:"Project Tiers"}),i(L,null,{header:_(()=>e[16]||(e[16]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Project Tiers",-1)])),default:_(()=>[t("div",W,[t("div",X,[t("div",Y,[t("div",Z,[e[21]||(e[21]=t("h3",{class:"text-2xl font-bold mb-4"},"Manage Project Tiers",-1)),l(E)?(m(),d("div",ee,[i(U,{onClick:A},{default:_(()=>e[17]||(e[17]=[x(" Create New Project Tier ",-1)])),_:1,__:[17]})])):y("",!0),T.value?(m(),d("div",te,"Loading project tiers...")):f.value?(m(),d("div",ie,c(f.value),1)):h.value.length===0?(m(),d("div",ae,"No project tiers found.")):(m(),d("div",le,[t("table",se,[e[20]||(e[20]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Point Multiplier"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Profit Margin (%)"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client Amount (PKR)"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",oe,[(m(!0),d(C,null,J(h.value,s=>(m(),d("tr",{key:s.id},[t("td",ne,c(s.name),1),t("td",me,c(s.point_multiplier),1),t("td",re,c(s.min_profit_margin_percentage)+"% - "+c(s.max_profit_margin_percentage)+"% ",1),t("td",ue,c(s.min_client_amount_pkr.toLocaleString())+" - "+c(s.max_client_amount_pkr.toLocaleString()),1),t("td",pe,[t("div",de,[l(D)?(m(),M(U,{key:0,onClick:o=>S(s)},{default:_(()=>e[18]||(e[18]=[x(" Edit ",-1)])),_:2,__:[18]},1032,["onClick"])):y("",!0),l(N)?(m(),M($,{key:1,onClick:o=>K(s)},{default:_(()=>e[19]||(e[19]=[x(" Delete ",-1)])),_:2,__:[19]},1032,["onClick"])):y("",!0)])])]))),128))])])]))])])])]),i(P,{show:b.value,title:"Create New Project Tier","api-endpoint":"/api/project-tiers","http-method":"post","form-data":l(a),"submit-button-text":"Create Tier","success-message":"Project tier created successfully!",onClose:e[6]||(e[6]=s=>b.value=!1),onSubmitted:B},{default:_(({errors:s})=>[t("div",_e,[i(r,{for:"create_name",value:"Name"}),i(u,{id:"create_name",type:"text",class:"mt-1 block w-full",modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).name=o),required:"",autofocus:""},null,8,["modelValue"]),i(p,{message:s.name,class:"mt-2"},null,8,["message"])]),t("div",ce,[i(r,{for:"create_point_multiplier",value:"Point Multiplier"}),e[22]||(e[22]=t("p",{class:"text-sm text-gray-600 mb-1"}," The multiplier applied to all points earned on projects in this tier (e.g., 1.50 for Tier 1). ",-1)),i(u,{id:"create_point_multiplier",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:l(a).point_multiplier,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).point_multiplier=o),required:""},null,8,["modelValue"]),i(p,{message:s.point_multiplier,class:"mt-2"},null,8,["message"])]),t("div",fe,[i(r,{for:"create_min_profit_margin",value:"Minimum Profit Margin (%)"}),e[23]||(e[23]=t("p",{class:"text-sm text-gray-600 mb-1"}," The minimum profit margin a project must have to be in this tier. ",-1)),i(u,{id:"create_min_profit_margin",type:"number",step:"0.01",min:"0",max:"100",class:"mt-1 block w-full",modelValue:l(a).min_profit_margin_percentage,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).min_profit_margin_percentage=o),required:""},null,8,["modelValue"]),i(p,{message:s.min_profit_margin_percentage,class:"mt-2"},null,8,["message"])]),t("div",ge,[i(r,{for:"create_max_profit_margin",value:"Maximum Profit Margin (%)"}),e[24]||(e[24]=t("p",{class:"text-sm text-gray-600 mb-1"}," The maximum profit margin a project can have to be in this tier. ",-1)),i(u,{id:"create_max_profit_margin",type:"number",step:"0.01",min:"0",max:"100",class:"mt-1 block w-full",modelValue:l(a).max_profit_margin_percentage,"onUpdate:modelValue":e[3]||(e[3]=o=>l(a).max_profit_margin_percentage=o),required:""},null,8,["modelValue"]),i(p,{message:s.max_profit_margin_percentage,class:"mt-2"},null,8,["message"])]),t("div",xe,[i(r,{for:"create_min_client_amount",value:"Minimum Client Amount (PKR)"}),e[25]||(e[25]=t("p",{class:"text-sm text-gray-600 mb-1"}," The minimum total agreed-upon amount for a project to qualify for this tier. ",-1)),i(u,{id:"create_min_client_amount",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:l(a).min_client_amount_pkr,"onUpdate:modelValue":e[4]||(e[4]=o=>l(a).min_client_amount_pkr=o),required:""},null,8,["modelValue"]),i(p,{message:s.min_client_amount_pkr,class:"mt-2"},null,8,["message"])]),t("div",ve,[i(r,{for:"create_max_client_amount",value:"Maximum Client Amount (PKR)"}),e[26]||(e[26]=t("p",{class:"text-sm text-gray-600 mb-1"}," The maximum total agreed-upon amount for a project to qualify for this tier. ",-1)),i(u,{id:"create_max_client_amount",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:l(a).max_client_amount_pkr,"onUpdate:modelValue":e[5]||(e[5]=o=>l(a).max_client_amount_pkr=o),required:""},null,8,["modelValue"]),i(p,{message:s.max_client_amount_pkr,class:"mt-2"},null,8,["message"])])]),_:1},8,["show","form-data"]),i(P,{show:k.value,title:"Edit Project Tier","api-endpoint":`/api/project-tiers/${l(a).id}`,"http-method":"put","form-data":l(a),"submit-button-text":"Update Tier","success-message":"Project tier updated successfully!",onClose:e[13]||(e[13]=s=>k.value=!1),onSubmitted:F},{default:_(({errors:s})=>[t("div",ye,[i(r,{for:"edit_name",value:"Name"}),i(u,{id:"edit_name",type:"text",class:"mt-1 block w-full",modelValue:l(a).name,"onUpdate:modelValue":e[7]||(e[7]=o=>l(a).name=o),required:"",autofocus:""},null,8,["modelValue"]),i(p,{message:s.name,class:"mt-2"},null,8,["message"])]),t("div",be,[i(r,{for:"edit_point_multiplier",value:"Point Multiplier"}),e[27]||(e[27]=t("p",{class:"text-sm text-gray-600 mb-1"}," The multiplier applied to all points earned on projects in this tier (e.g., 1.50 for Tier 1). ",-1)),i(u,{id:"edit_point_multiplier",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:l(a).point_multiplier,"onUpdate:modelValue":e[8]||(e[8]=o=>l(a).point_multiplier=o),required:""},null,8,["modelValue"]),i(p,{message:s.point_multiplier,class:"mt-2"},null,8,["message"])]),t("div",ke,[i(r,{for:"edit_min_profit_margin",value:"Minimum Profit Margin (%)"}),e[28]||(e[28]=t("p",{class:"text-sm text-gray-600 mb-1"}," The minimum profit margin a project must have to be in this tier. ",-1)),i(u,{id:"edit_min_profit_margin",type:"number",step:"0.01",min:"0",max:"100",class:"mt-1 block w-full",modelValue:l(a).min_profit_margin_percentage,"onUpdate:modelValue":e[9]||(e[9]=o=>l(a).min_profit_margin_percentage=o),required:""},null,8,["modelValue"]),i(p,{message:s.min_profit_margin_percentage,class:"mt-2"},null,8,["message"])]),t("div",we,[i(r,{for:"edit_max_profit_margin",value:"Maximum Profit Margin (%)"}),e[29]||(e[29]=t("p",{class:"text-sm text-gray-600 mb-1"}," The maximum profit margin a project can have to be in this tier. ",-1)),i(u,{id:"edit_max_profit_margin",type:"number",step:"0.01",min:"0",max:"100",class:"mt-1 block w-full",modelValue:l(a).max_profit_margin_percentage,"onUpdate:modelValue":e[10]||(e[10]=o=>l(a).max_profit_margin_percentage=o),required:""},null,8,["modelValue"]),i(p,{message:s.max_profit_margin_percentage,class:"mt-2"},null,8,["message"])]),t("div",Ve,[i(r,{for:"edit_min_client_amount",value:"Minimum Client Amount (PKR)"}),e[30]||(e[30]=t("p",{class:"text-sm text-gray-600 mb-1"}," The minimum total agreed-upon amount for a project to qualify for this tier. ",-1)),i(u,{id:"edit_min_client_amount",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:l(a).min_client_amount_pkr,"onUpdate:modelValue":e[11]||(e[11]=o=>l(a).min_client_amount_pkr=o),required:""},null,8,["modelValue"]),i(p,{message:s.min_client_amount_pkr,class:"mt-2"},null,8,["message"])]),t("div",je,[i(r,{for:"edit_max_client_amount",value:"Maximum Client Amount (PKR)"}),e[31]||(e[31]=t("p",{class:"text-sm text-gray-600 mb-1"}," The maximum total agreed-upon amount for a project to qualify for this tier. ",-1)),i(u,{id:"edit_max_client_amount",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:l(a).max_client_amount_pkr,"onUpdate:modelValue":e[12]||(e[12]=o=>l(a).max_client_amount_pkr=o),required:""},null,8,["modelValue"]),i(p,{message:s.max_client_amount_pkr,class:"mt-2"},null,8,["message"])])]),_:1},8,["show","api-endpoint","form-data"]),i(O,{show:v.value,onClose:e[15]||(e[15]=s=>v.value=!1)},{default:_(()=>[t("div",he,[e[35]||(e[35]=t("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this project tier? ",-1)),e[36]||(e[36]=t("p",{class:"mt-1 text-sm text-gray-600"}," This action cannot be undone. All projects associated with this tier will have their tier set to null. ",-1)),w.value?(m(),d("div",Te,[e[32]||(e[32]=t("strong",null,"Tier:",-1)),x(" "+c(w.value.name),1)])):y("",!0),f.value?(m(),d("div",Pe,c(f.value),1)):y("",!0),t("div",Ce,[i(Q,{onClick:e[14]||(e[14]=s=>v.value=!1)},{default:_(()=>e[33]||(e[33]=[x("Cancel",-1)])),_:1,__:[33]}),i($,{class:"ms-3",onClick:R},{default:_(()=>e[34]||(e[34]=[x("Delete Tier",-1)])),_:1,__:[34]})])])]),_:1},8,["show"])]),_:1})],64))}};export{ze as default};
