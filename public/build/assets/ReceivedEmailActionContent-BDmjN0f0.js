import{q as V,r as u,e as $,a as p,o as f,b as d,d as o,u as r,w as b,m as y,j as _,s as k,p as c}from"./app-XxQQcn73.js";import{_ as v}from"./InputLabel-BvPcGWyA.js";import{_ as C}from"./TextInput-DMrmE1lx.js";import{_ as B}from"./EmailEditor-D1HOUNp0.js";import{_ as j}from"./InputError-BzaAVg_L.js";import{_ as q}from"./PrimaryButton-B-KGj6Hd.js";import{_ as N}from"./SecondaryButton-q-4gQyd4.js";import"./EmailEditor.vue_vue_type_style_index_0_lang-C2I1xa6A.js";const R={key:0,class:"flex justify-center py-8"},S={key:1,class:"p-4 space-y-6"},A={class:"mb-4"},F={class:"mb-6"},U={class:"flex items-center justify-end space-x-2"},J={__name:"ReceivedEmailActionContent",props:{email:{type:Object,required:!0}},emits:["submitted","error"],setup(g,{emit:x}){const l=g,i=x,a=V({subject:"",body:""}),m=u(!1),t=u(!1),h=async()=>{var s;if((s=l.email)!=null&&s.id){m.value=!0;try{const e=await c.get(`/api/emails/${l.email.id}`);a.subject=e.data.subject,a.body=e.data.body_html||e.data.body}catch(e){console.error("Failed to fetch email details:",e),i("error",e)}finally{m.value=!1}}},w=async()=>{t.value=!0;try{const s={subject:a.subject,body:a.body};await c.post(`/api/emails/${l.email.id}/edit-and-approve`,s),i("submitted")}catch(s){console.error("Error approving email:",s),i("error",s)}finally{t.value=!1}},E=async()=>{t.value=!0;try{await c.post(`/api/emails/${l.email.id}/reject`,{rejection_reason:"Rejected by user."}),i("submitted")}catch(s){console.error("Error rejecting email:",s),i("error",s)}finally{t.value=!1}};return $(()=>l.email,s=>{s&&h()},{immediate:!0}),(s,e)=>m.value?(f(),p("div",R,e[3]||(e[3]=[d("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"},null,-1)]))):(f(),p("div",S,[d("form",{onSubmit:e[2]||(e[2]=k(()=>{},["prevent"]))},[d("div",A,[o(v,{for:"subject",value:"Subject"}),o(C,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:r(a).subject,"onUpdate:modelValue":e[0]||(e[0]=n=>r(a).subject=n),required:""},null,8,["modelValue"]),o(j,{message:r(a).errors.subject,class:"mt-2"},null,8,["message"])]),d("div",F,[o(v,{for:"body",value:"Email Body",class:"sr-only"}),o(B,{id:"body",modelValue:r(a).body,"onUpdate:modelValue":e[1]||(e[1]=n=>r(a).body=n),placeholder:"Edit the email here...",height:"300px"},null,8,["modelValue"]),o(j,{message:r(a).errors.body,class:"mt-2"},null,8,["message"])]),d("div",U,[o(q,{onClick:w,class:_({"opacity-25":t.value}),disabled:t.value},{default:b(()=>e[4]||(e[4]=[y(" Approve ",-1)])),_:1,__:[4]},8,["class","disabled"]),o(N,{onClick:E,class:_({"opacity-25":t.value}),disabled:t.value},{default:b(()=>e[5]||(e[5]=[y(" Reject ",-1)])),_:1,__:[5]},8,["class","disabled"])])],32)]))}};export{J as default};
