import{r as n,m as w,l as ae,b8 as ct,E as dt,b as Ve,c as u,o as i,e as y,u as Fe,h as vt,w as ge,a as s,n as R,F as ye,q as mt,k as d,t as A,i as pt,f as Le,A as gt,v as yt,y as ft,V as _t,G as $e}from"./app-CdAy66B_.js";import{d as ht,a as kt}from"./currency-BoZdXFVF.js";import{i as bt,_ as wt}from"./AuthenticatedLayout-CrvSB6uc.js";import xt from"./Filters-B96JB8-q.js";import Dt from"./ProjectCards-BQwp_IV4.js";import Ct from"./Sidebar-DaRrDkLl.js";import{_ as Pt}from"./KanbanBoard-C80fAMBq.js";import{S as $}from"./SelectDropdown-NcnKkYwS.js";import Tt from"./DailyWorkLog-C8L4mZo8.js";import{a as At,u as St,s as Be,c as jt,r as It,p as Mt,b as Ut}from"./taskState-CvclpzVf.js";import"./PrimaryButton-DKDVT9yu.js";import"./Modal-Z-mcDOgr.js";import"./InputLabel-CVUkGvsV.js";import"./InputError-5LI0JdCX.js";import"./SecondaryButton-B1O6HvSH.js";import"./index-BNAK2JUE.js";import"./BaseFormModal-BwX1BFM7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-VqOxWGBy.js";import"./debounce-C-hnF4Z3.js";import"./RightSidebar-COZG_AL_.js";import"./ApplicationLogo-CwNObRNM.js";import"./MultiSelectDropdown-BNMdbUa-.js";import"./createLucideIcon-C35i-icL.js";import"./plus-DVV8RatJ.js";import"./DangerButton-CMV_x11R.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-RVrk6Sn9.js";import"./x-GToanPWG.js";import"./ProjectCard-C58GORyz.js";/* empty css                                                                       */const Vt={class:"flex items-center justify-between"},Ft={class:"flex items-center gap-3"},Lt={class:"flex items-center rounded-lg border border-gray-200 overflow-hidden shadow-sm"},$t={class:"py-10"},Bt={key:0,class:"max-w-3xl mx-auto"},Ht={class:"mb-6"},Wt={key:0,class:"flex flex-col lg:flex-row gap-8"},Ot={class:"lg:w-2/3"},Rt={class:"lg:w-1/3"},Et={key:1,class:"mt-4"},Kt={class:"mb-3 flex flex-col gap-3"},Nt={class:"flex items-center justify-between gap-4"},zt={class:"flex items-center gap-2"},Yt={key:0,class:"text-xs text-gray-500"},qt={key:1,class:"text-xs text-red-600"},Jt={class:"relative"},Gt={key:0,class:"absolute right-0 mt-2 w-56 bg-white border rounded-md shadow-lg z-10 p-3"},Qt={class:"space-y-2"},Xt=["value"],Zt={key:0,class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-7 gap-3"},ea={class:"relative"},ta={class:"absolute inset-y-0 right-2 flex items-center gap-1"},aa={class:"flex items-center gap-2"},sa={class:"flex-1"},la={class:"flex items-center gap-2"},oa={class:"flex-1"},na={class:"flex items-center gap-2"},ra={class:"flex-1"},ia={key:0,class:"flex items-center gap-2"},ua={class:"flex-1"},ca={class:"flex items-center gap-2"},da={class:"flex-1"},va={class:"flex items-center gap-2"},ma={class:"flex-1"},pa=["onDragstart","onClick","title"],ga={key:0,class:"absolute top-1 right-1 text-red-500",title:"Overdue"},ya={class:"flex items-start gap-1"},fa={class:"text-sm font-medium text-gray-800 truncate flex-1"},_a=["title"],ha={key:1,class:"text-xs text-gray-500 truncate"},ka={class:"text-xs text-gray-500 truncate"},ba={key:2,class:"text-xs text-gray-500 truncate"},wa={key:0,class:"mt-6 flex justify-center"},xa=["disabled"],ss={__name:"Index",setup(Da){const m=n(localStorage.getItem("workspace_view")||"projects");w(m,e=>{try{localStorage.setItem("workspace_view",e)}catch{}});const x=n(m.value==="kanban");w(x,e=>{m.value=e?"kanban":"projects"}),w(m,e=>{x.value=e==="kanban"});const se=n([{id:1,name:"Project Phoenix",role:"Manager",health:"at-risk",alert:{text:"Client email from Project Phoenix requires a reply.",timer:"3h 25m",incentive:"Reply in time to earn 50 points."},overview:{milestone:"3 of 5 - Design Phase (60% Complete)",budget:"$15,000 / $25,000 Used",status:"On Track"},tasks:{today:[{name:"Create new ad copy",status:"started",assignee:"Alex Ray"},{name:"Review wireframes",status:"blocked",assignee:"Sarah Chen"}],tomorrow:[{name:"Client feedback call",status:"paused",assignee:"Jane Doe"},{name:"Design review meeting",status:"complete",assignee:"Team A"}],completed:[{name:"Initial Project Kickoff",status:"complete"}]},communication:{lastSent:"Today at 9:15 AM",lastReceived:"3 days ago at 4:30 PM"}},{id:2,name:"Project Odyssey",role:"Contributor",health:"needs-attention",tasks:{today:[{name:"Develop login API endpoint",status:"blocked"},{name:"Write unit tests for checkout process",status:"started"}],tomorrow:[{name:"Refactor database schema",status:"paused"}],completed:[{name:"Update documentation",status:"complete"}]},milestone:{name:"Backend API Development",deadline:"September 5, 2025",progress:75,incentive:"Complete on time to earn a 5% bonus and 200 points!"}},{id:3,name:"Project Gemini",role:"Manager",health:"on-track",alert:null,overview:{milestone:"2 of 4 - Testing Phase (95% Complete)",budget:"$8,000 / $10,000 Used",status:"In Progress"},tasks:{today:[{name:"User Acceptance Testing",status:"complete"}],tomorrow:[{name:"Deploy to staging",status:"started"}],completed:[{name:"Initial QA Review",status:"complete"}]},communication:{lastSent:"Yesterday at 11:00 AM",lastReceived:"Yesterday at 10:45 AM"}},{id:4,name:"Project Alpha",role:"Contributor",health:"on-track",tasks:{today:[],tomorrow:[],completed:[{name:"Initial project setup",status:"complete"},{name:"Write documentation",status:"complete"}]},milestone:{name:"Project Kickoff",deadline:"September 20, 2025",progress:100,incentive:"Complete on time to earn a 5% bonus and 200 points!"}}]),U=n("all"),le=n(""),oe=n("with");ae(()=>U.value==="all"?se.value:U.value==="manager"?se.value.filter(e=>e.role==="Manager"):U.value==="contributor"?se.value.filter(e=>e.role==="Contributor"):[]);const ne=n(["Follow up with Alex on Project Phoenix","Prepare for sprint planning"]),fe=n(localStorage.getItem("my_dashboard_notes")||"");function He(e){e&&ne.value.push(e)}function We(e){ne.value.splice(e,1)}function Oe(e){fe.value=e,localStorage.setItem("my_dashboard_notes",e)}w(x,e=>{try{localStorage.setItem("workspace_kanban_view",e?"1":"0")}catch{}});const _e=[{key:"To Do",title:"To Do"},{key:"In Progress",title:"In Progress"},{key:"Paused",title:"Paused"},{key:"Blocked",title:"Blocked"},{key:"Done",title:"Done"},{key:"Archived",title:"Archived"}],Re=["To Do","In Progress","Paused","Blocked","Done"],E=n((()=>{try{const e=JSON.parse(localStorage.getItem("workspace_kanban_columns")||"null");if(Array.isArray(e)&&e.length)return e}catch{}return Re})()),re=n(!1);w(E,e=>{try{localStorage.setItem("workspace_kanban_columns",JSON.stringify(e))}catch{}},{deep:!0});const Ee=ae(()=>_e.filter(e=>E.value.includes(e.key))),f=n([]),S=n(!1),K=n(""),h=n(""),k=n("all"),D=n("all"),_=n(null),v=n(null),j=n(""),C=n(null),B=n(!1),H=n([]),V=n([]),N=n([]),Ke=ct(),{canDo:ie}=dt(),p=new Date,I=new Date(p);I.setDate(p.getDate()-p.getDay()),I.setHours(0,0,0,0);const F=new Date(I);F.setDate(I.getDate()+6),F.setHours(23,59,59,999);const z=new Date(p);z.setDate(p.getDate()-1),z.setHours(0,0,0,0);const he=new Date(z);he.setHours(23,59,59,999);const Y=new Date(I);Y.setMilliseconds(-1);const ue=new Date(Y);ue.setDate(Y.getDate()-6),ue.setHours(0,0,0,0);const ke=new Date(p.getFullYear(),p.getMonth(),1),be=new Date(p.getFullYear(),p.getMonth()+1,0);be.setHours(23,59,59,999);const q=new Date(ke);q.setMilliseconds(-1);const we=new Date(q.getFullYear(),q.getMonth(),1);we.setHours(0,0,0,0);const ce=new Date(p);ce.setDate(p.getDate()-6),ce.setHours(0,0,0,0);const de=new Date(p);de.setDate(p.getDate()-29),de.setHours(0,0,0,0);const Ne=[{value:"",label:"All Priorities"},{value:"high",label:"High"},{value:"medium",label:"Medium"},{value:"low",label:"Low"}],ze=()=>{h.value="",_.value=null,v.value=null,j.value="",C.value=null,k.value="all",D.value="all"},Ye=()=>{_.value=null},qe=()=>{v.value=null},Je=()=>{j.value=""},Ge=()=>{C.value=null},Qe=()=>{k.value="all"},Xe=()=>{D.value="all"},Ze=()=>{h.value=""},ve=new Map,et=async()=>{try{const{data:e}=await window.axios.get("/api/projects-simplified"),a=Array.isArray(e)?e.map(t=>({value:t.id,label:t.name})):[];H.value=[{value:null,label:"All Projects"},...a]}catch(e){console.error("Failed to fetch projects-simplified",e),H.value=[{value:null,label:"All Projects"}]}},xe=async()=>{try{const{data:e}=await window.axios.get("/api/users"),a=(Array.isArray(e)?e:[]).map(t=>({value:t.id,label:t.name}));V.value=[{value:"__all__",label:"All Users"},...a]}catch(e){console.error("Failed to fetch users",e),V.value=[{value:"__all__",label:"All Users"}]}},me=async e=>{if(!e&&e!==0)return[];if(ve.has(e))return ve.get(e);try{const{data:a}=await window.axios.get(`/api/projects/${e}/users`),t=(Array.isArray(a)?a:[]).map(l=>({value:l.id,label:l.name}));return ve.set(e,t),t}catch(a){return console.error("Failed to fetch project users",a),[]}},De=async()=>{const e=H.value.map(l=>l.value).filter(l=>l!==null),a=new Map;await Promise.all(e.map(async l=>{const o=await me(l);for(const r of o)a.has(r.value)||a.set(r.value,r)}));const t=Array.from(a.values()).sort((l,o)=>String(l.label).localeCompare(String(o.label)));V.value=[{value:"__all__",label:"All Users"},...t]},tt=async e=>{if(N.value=[],!!e)try{const{data:a}=await window.axios.get(`/api/projects/${e}/milestones`);N.value=(Array.isArray(a)?a:[]).map(t=>({value:t.id,label:t.name}))}catch(a){console.warn("Failed to fetch project milestones; falling back to none",a),N.value=[]}};Ve(async()=>{try{await Ke.fetchGlobalPermissions()}catch{}await et(),ie("view_all_user").value?await xe():await De()}),w(_,async e=>{if(C.value=null,await tt(e),ie("view_all_user").value)if(e){const a=await me(e);V.value=[{value:"__all__",label:"All Users"},...a]}else await xe();else if(e){const a=await me(e);V.value=[{value:"__all__",label:"All Users"},...a]}else await De();if(x.value&&v.value==="__all__"){const a={};e&&(a.project_id=e),P.value=1,await Ce(a)}});const P=n(1),J=n(1),G=async(e,a=!1)=>{S.value=!0,K.value="";try{h.value&&!e.search&&(e.search=h.value),e.page=P.value,e.per_page||(e.per_page=100);const{data:t}=await window.axios.get("/api/tasks",{params:e}),l=Array.isArray(t)?t:Array.isArray(t==null?void 0:t.data)?t.data:[];if(a){const o=new Set(f.value.map(b=>b.id)),r=l.filter(b=>!o.has(b.id));f.value=[...f.value,...r]}else f.value=l;!Array.isArray(t)&&t.last_page?(J.value=t.last_page,P.value=t.current_page):J.value=1}catch(t){console.error("Failed to load tasks",t),K.value="Failed to load tasks",a||(f.value=[])}finally{S.value=!1}},at=async(e=!1)=>{var t,l;const a=(l=(t=$e().props.auth)==null?void 0:t.user)==null?void 0:l.id;a&&await G({assigned_to_user_id:a,per_page:100},e)},Ce=async(e={},a=!1)=>{const t=new Date().toISOString().slice(0,10);let l={...e,per_page:100,statuses:"To Do,In Progress,Paused,Blocked,Done"};if(h.value||(l.due_until=t),!ie("view_all_user").value&&!e.project_id){const o=H.value.map(r=>r.value).filter(r=>r!==null);o.length>0&&(l.project_ids=o.join(","))}await G(l,a)};w(x,e=>{setTimeout(()=>{e&&f.value.length===0&&!S.value&&at()},500)},{immediate:!0});const pe=async(e=!1)=>{var l,o;if(!x.value)return;const a=(o=(l=$e().props.auth)==null?void 0:l.user)==null?void 0:o.id,t={};_.value&&(t.project_id=_.value),v.value==="__all__"?await Ce(t,e):v.value?await G({...t,assigned_to_user_id:v.value,per_page:100},e):a&&await G({...t,assigned_to_user_id:a,per_page:100},e)};w(v,async e=>{P.value=1,await pe()});const st=async()=>{P.value>=J.value||(P.value++,await pe(!0))};let Pe=null;w(h,e=>{x.value&&(clearTimeout(Pe),Pe=setTimeout(async()=>{P.value=1,await pe()},400))});const lt=ae(()=>{const e=(h.value||"").toLowerCase().trim();return(f.value||[]).filter(t=>{var Te,Ae,Se,je,Ie,Me;const l=!e||String(t.name||t.title||"").toLowerCase().includes(e)||String(((Te=t.milestone)==null?void 0:Te.name)||"").toLowerCase().includes(e)||String(((Ae=t.project)==null?void 0:Ae.name)||"").toLowerCase().includes(e)||String(t.description||"").toLowerCase().includes(e),o=((Se=t.project)==null?void 0:Se.id)??((je=t.milestone)==null?void 0:je.project_id)??null,r=!_.value||o&&String(o)===String(_.value),b=t.assigned_to_user_id??((Ie=t.assigned_to)==null?void 0:Ie.id)??t.assigned_to_id??null,Z=!v.value||v.value==="__all__"||b&&String(b)===String(v.value),ee=!j.value||String(t.priority||"").toLowerCase()===String(j.value),O=((Me=t.milestone)==null?void 0:Me.id)??null,te=!C.value||O&&String(O)===String(C.value);let T=!0;if(k.value&&k.value!=="all"){const M=t.due_date?new Date(t.due_date):null;if(!M)T=!1;else{const c=new Date(M);c.setHours(0,0,0,0);const L=new Date;L.setHours(0,0,0,0),k.value==="today"?T=c.getTime()===L.getTime():k.value==="overdue"?T=c.getTime()<L.getTime():k.value==="week"&&(T=M>=I&&M<=F)}}let g=!0;if(D.value&&D.value!=="all"){const M=t.completed_at||(t.status==="Done"?t.updated_at:null);if(!M)g=!1;else{const c=new Date(M),L=new Date(c);L.setHours(0,0,0,0);const Ue=new Date;switch(Ue.setHours(0,0,0,0),D.value){case"completed_today":g=L.getTime()===Ue.getTime();break;case"completed_yesterday":g=c>=z&&c<=he;break;case"completed_this_week":g=c>=I&&c<=F;break;case"completed_last_week":g=c>=ue&&c<=Y;break;case"completed_this_month":g=c>=ke&&c<=be;break;case"completed_last_month":g=c>=we&&c<=q;break;case"completed_last_7":g=c>=ce&&c<=F;break;case"completed_last_30":g=c>=de&&c<=F;break;default:g=!0}g&&(g=t.status==="Done")}}return l&&r&&Z&&ee&&te&&T&&g})}),ot=ae(()=>{const e={"To Do":[],"In Progress":[],Paused:[],Blocked:[],Done:[],Archived:[]};for(const a of lt.value){const t=a.status&&e[a.status]!==void 0?a.status:"To Do";e[t].push(a)}return e.Done&&e.Done.length>0&&(e.Done.sort((a,t)=>new Date(t.updated_at||t.completed_at||0)-new Date(a.updated_at||a.completed_at||0)),e.Done=e.Done.slice(0,10)),e}),Q=n(!1),X=n(null),nt=e=>{X.value=e,Q.value=!0},rt=async e=>{if(X.value)try{const a=await Ut(X.value,e);W(a)}catch(a){console.error("Failed to block task from workspace:",a)}finally{Q.value=!1,X.value=null}},it=(e,a)=>e===a?null:e==="To Do"&&a==="In Progress"?"start":e==="In Progress"&&a==="Paused"?"pause":e==="Paused"&&a==="In Progress"?"resume":e==="In Progress"&&a==="Done"?"complete":(e==="To Do"||e==="In Progress"||e==="Paused")&&a==="Blocked"?"block":e==="Blocked"&&a==="In Progress"?"unblock_to_inprogress":e==="Done"&&a==="To Do"?"revise":null,W=e=>{if(!e)return;const a=f.value.findIndex(t=>String(t.id)===String(e.id));a>=0?f.value[a]={...f.value[a],...e}:f.value.push(e)},ut=async({data:e,to:a})=>{if(!e||!a)return;const t=e.status,l=it(t,a);if(!l)return;const o={...e};e.status=a,W(e);try{let r;switch(l){case"start":r=await Be(o);break;case"pause":r=await Mt(o);break;case"resume":r=await It(o);break;case"complete":r=await jt(o);break;case"block":return e.status=o.status,W(o),nt(o);case"unblock_to_inprogress":r=await St(o),r.status==="To Do"&&(r=await Be(r));break;case"revise":r=await At(o);break;default:throw new Error("Unsupported transition")}W(r)}catch{W(o)}};return Ve(async()=>{try{const e=localStorage.getItem("displayCurrency");e&&(ht.value=e),await kt()}catch(e){console.warn("Currency initialization failed in Workspace/Index.vue:",e)}}),(e,a)=>(i(),u(ye,null,[y(Fe(vt),{title:"My Workspace"}),y(wt,null,{header:ge(()=>[s("div",Vt,[s("div",Ft,[a[17]||(a[17]=s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Workspace",-1)),s("div",Lt,[s("button",{type:"button",class:R(["px-3 py-1.5 text-sm transition font-medium",m.value==="projects"?"bg-indigo-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"]),onClick:a[0]||(a[0]=t=>m.value="projects")},"Projects",2),s("button",{type:"button",class:R(["px-3 py-1.5 text-sm transition font-medium border-l border-r border-gray-200",m.value==="kanban"?"bg-indigo-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"]),onClick:a[1]||(a[1]=t=>m.value="kanban")},"Kanban",2),s("button",{type:"button",class:R(["px-3 py-1.5 text-sm transition font-medium",m.value==="daily"?"bg-indigo-600 text-white":"bg-white text-gray-600 hover:bg-gray-50"]),onClick:a[2]||(a[2]=t=>m.value="daily")},"ðŸ“‹ Daily Log",2)])])])]),default:ge(()=>[s("div",$t,[s("div",{class:R(m.value==="kanban"?"max-w-none w-full px-4 sm:px-6 lg:px-8":"max-w-7xl mx-auto sm:px-6 lg:px-8")},[m.value==="daily"?(i(),u("div",Bt,[y(Tt)])):(i(),u(ye,{key:1},[s("div",Ht,[m.value==="projects"?(i(),mt(xt,{key:0,"onUpdate:filter":a[3]||(a[3]=t=>U.value=t),"active-filter":U.value,search:le.value,"onUpdate:search":a[4]||(a[4]=t=>le.value=t),"pending-filter":oe.value,"onUpdate:pending":a[5]||(a[5]=t=>oe.value=t)},null,8,["active-filter","search","pending-filter"])):d("",!0)]),x.value?(i(),u("div",Et,[s("div",Kt,[s("div",Nt,[a[19]||(a[19]=s("h3",{class:"text-lg font-semibold text-gray-800"},"My Tasks (Kanban)",-1)),s("div",zt,[S.value?(i(),u("span",Yt,"Loading...")):K.value?(i(),u("span",qt,A(K.value),1)):d("",!0),s("div",Jt,[s("button",{type:"button",class:"px-3 py-1.5 text-sm border rounded-md bg-white hover:bg-gray-50",onClick:a[6]||(a[6]=t=>re.value=!re.value)}," Columns "),re.value?(i(),u("div",Gt,[s("div",Qt,[(i(),u(ye,null,pt(_e,t=>s("label",{key:t.key,class:"flex items-center gap-2 text-sm"},[Le(s("input",{type:"checkbox",class:"rounded",value:t.key,"onUpdate:modelValue":a[7]||(a[7]=l=>E.value=l)},null,8,Xt),[[gt,E.value]]),s("span",null,A(t.title),1)])),64)),a[18]||(a[18]=s("div",{class:"text-xs text-gray-500 pt-1"},"Tip: Archived is optional",-1))])])):d("",!0)]),s("button",{type:"button",class:"px-3 py-1.5 text-sm border rounded-md bg-white hover:bg-gray-50",onClick:a[8]||(a[8]=t=>B.value=!B.value)},A(B.value?"Hide Filters":"Show Filters"),1),B.value?(i(),u("button",{key:2,type:"button",class:"px-3 py-1.5 text-sm border rounded-md bg-white hover:bg-gray-50",onClick:ze,title:"Clear all filters"}," Clear All ")):d("",!0)])]),B.value?(i(),u("div",Zt,[s("div",ea,[Le(s("input",{type:"text","onUpdate:modelValue":a[9]||(a[9]=t=>h.value=t),placeholder:"Search tasks...",class:"w-full pr-16 px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,512),[[yt,h.value]]),s("div",ta,[h.value?(i(),u("button",{key:0,type:"button",class:"text-xs text-gray-600 hover:text-gray-900",onClick:Ze},"Clear")):d("",!0)])]),s("div",aa,[s("div",sa,[y($,{modelValue:_.value,"onUpdate:modelValue":a[10]||(a[10]=t=>_.value=t),options:H.value,placeholder:"Filter by project"},null,8,["modelValue","options"])]),_.value?(i(),u("button",{key:0,type:"button",class:"text-xs text-gray-600 hover:text-gray-900",onClick:Ye},"Clear")):d("",!0)]),s("div",la,[s("div",oa,[y($,{modelValue:v.value,"onUpdate:modelValue":a[11]||(a[11]=t=>v.value=t),options:V.value,placeholder:"Filter by assignee"},null,8,["modelValue","options"])]),v.value?(i(),u("button",{key:0,type:"button",class:"text-xs text-gray-600 hover:text-gray-900",onClick:qe},"Clear")):d("",!0)]),s("div",na,[s("div",ra,[y($,{modelValue:j.value,"onUpdate:modelValue":a[12]||(a[12]=t=>j.value=t),options:Ne,placeholder:"Priority"},null,8,["modelValue"])]),j.value?(i(),u("button",{key:0,type:"button",class:"text-xs text-gray-600 hover:text-gray-900",onClick:Je},"Clear")):d("",!0)]),_.value?(i(),u("div",ia,[s("div",ua,[y($,{modelValue:C.value,"onUpdate:modelValue":a[13]||(a[13]=t=>C.value=t),options:N.value,placeholder:"Filter by milestone"},null,8,["modelValue","options"])]),C.value?(i(),u("button",{key:0,type:"button",class:"text-xs text-gray-600 hover:text-gray-900",onClick:Ge},"Clear")):d("",!0)])):d("",!0),s("div",ca,[s("div",da,[y($,{modelValue:k.value,"onUpdate:modelValue":a[14]||(a[14]=t=>k.value=t),options:[{value:"all",label:"All Due"},{value:"today",label:"Due Today"},{value:"overdue",label:"Overdue"},{value:"week",label:"Due This Week"}],placeholder:"Due filter"},null,8,["modelValue"])]),k.value!=="all"?(i(),u("button",{key:0,type:"button",class:"text-xs text-gray-600 hover:text-gray-900",onClick:Qe},"Clear")):d("",!0)]),s("div",va,[s("div",ma,[y($,{modelValue:D.value,"onUpdate:modelValue":a[15]||(a[15]=t=>D.value=t),options:[{value:"all",label:"All Completed"},{value:"completed_today",label:"Completed Today"},{value:"completed_yesterday",label:"Completed Yesterday"},{value:"completed_this_week",label:"Completed This Week"},{value:"completed_last_week",label:"Completed Last Week"},{value:"completed_this_month",label:"Completed This Month"},{value:"completed_last_month",label:"Completed Last Month"},{value:"completed_last_7",label:"Completed in Last 7 Days"},{value:"completed_last_30",label:"Completed in Last 30 Days"}],placeholder:"Completed filter"},null,8,["modelValue"])]),D.value!=="all"?(i(),u("button",{key:0,type:"button",class:"text-xs text-gray-600 hover:text-gray-900",onClick:Xe},"Clear")):d("",!0)])])):d("",!0)]),y(Pt,{columns:Ee.value,"items-by-column":ot.value,loading:S.value,onDrop:ut},{item:ge(({item:t,columnKey:l})=>{var o,r,b,Z,ee,O;return[s("div",{class:R(["relative p-3 rounded-md bg-white border border-gray-200 shadow-sm cursor-move border-l-4",[String(t.priority||"").toLowerCase()==="high"?"border-l-red-500":String(t.priority||"").toLowerCase()==="medium"?"border-l-yellow-500":String(t.priority||"").toLowerCase()==="low"?"border-l-green-500":"border-l-gray-200",t.due_date&&new Date(t.due_date)<new Date(new Date().setHours(0,0,0,0))&&t.status!=="Done"?"ring-1 ring-red-300":""]]),draggable:"true",onDragstart:te=>te.dataTransfer.setData("text/plain",JSON.stringify(t)),onClick:ft(te=>{var T;return Fe(_t)(t.id,(T=t.milestone)==null?void 0:T.project_id)},["stop"]),title:(o=t.milestone)!=null&&o.name?`${t.name} â€” ${t.milestone.name}`:t.name},[t.due_date&&new Date(t.due_date)<new Date(new Date().setHours(0,0,0,0))&&t.status!=="Done"?(i(),u("div",ga,a[20]||(a[20]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.487 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11.75 13a.75.75 0 01-1.5 0v-2.25a.75.75 0 011.5 0V13zm-1.5-7.5a.75.75 0 011.5 0v1.5a.75.75 0 01-1.5 0V5.5z","clip-rule":"evenodd"})],-1)]))):d("",!0),s("div",ya,[s("div",fa,A(t.name||t.title||"Task"),1),t.source&&t.source!=="local"?(i(),u("div",{key:0,class:"text-indigo-500 mt-0.5 flex-shrink-0",title:`External Task: ${t.source}`},a[21]||(a[21]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})],-1)]),8,_a)):d("",!0)]),(r=t.milestone)!=null&&r.name?(i(),u("div",ha,A(t.milestone.name),1)):d("",!0),s("div",ka,A(((b=t.project)==null?void 0:b.name)||((ee=(Z=t.milestone)==null?void 0:Z.project)==null?void 0:ee.name)),1),!v.value||v.value==="__all__"?(i(),u("div",ba,A((O=t.assigned_to)==null?void 0:O.name),1)):d("",!0)],42,pa)]}),_:1},8,["columns","items-by-column","loading"]),y(bt,{show:Q.value,title:"Block Task","confirm-text":"Block Task",placeholder:"Enter reason for blocking...",onClose:a[16]||(a[16]=t=>Q.value=!1),onConfirm:rt},null,8,["show"]),P.value<J.value?(i(),u("div",wa,[s("button",{onClick:st,disabled:S.value,class:"px-5 py-2.5 rounded-md border border-gray-300 bg-white text-gray-700 font-medium hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm transition-all"},A(S.value?"Loading...":"Load More Tasks"),9,xa)])):d("",!0)])):(i(),u("div",Wt,[s("div",Ot,[y(Dt,{search:le.value,"active-filter":U.value,"pending-filter":oe.value},null,8,["search","active-filter","pending-filter"])]),s("div",Rt,[y(Ct,{"checklist-items":ne.value,notes:fe.value,onAddChecklistItem:He,onRemoveChecklistItem:We,onUpdateNotes:Oe},null,8,["checklist-items","notes"])])]))],64))],2)])]),_:1})],64))}};export{ss as default};
