import{h as de,S as pe,B as Ee,b as zt,c as qt,R as Gt,d as Kt,e as Jt,_ as Zt}from"./AuthenticatedLayout-Bes_VhZ2.js";import{r as x,B as be,i as d,o as n,b as e,F as K,j as ee,g as D,t as g,m as F,ae as Te,e as p,af as Xe,a as N,A as ie,c as le,ag as ut,L as ct,n as Q,D as xe,T as ze,ah as se,H as Xt,Q as Ie,M as Qt,d as we,z as ke,w as re,s as R,f as ce,k as fe,v as We,h as q,G as es,_ as Ce,ad as ts,q as Qe,ai as mt,S as et,a3 as ss,Y as Le,u as ls,N as as,ab as is,a9 as ns,y as os,a8 as rs}from"./app-Zv3ebzGJ.js";import{c as he,a as Oe,d as Be,f as je,b as ds,_ as us}from"./ProjectForm-CWAPzuZK.js";import{a as ye,_ as Se}from"./SecondaryButton-B57-gx7f.js";import{P as ue}from"./PrimaryButton-DvmJCt9V.js";import{a as yt,_ as ft}from"./StandupModal-D3HVkYQ_.js";import{_ as W}from"./InputLabel-TUkV8NLc.js";import{_ as ne,a as ae}from"./InputError-CjL299TP.js";import{_ as bt}from"./EmailEditor-BEfSLWNQ.js";import"./ApplicationLogo-iCiZO1Mf.js";import"./Checkbox-B6Gp16gR.js";import"./ProjectTypeInput-D6bznq6m.js";const cs={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},ms={key:0,class:"text-sm text-gray-500"},vs={key:1,class:"text-sm text-gray-500"},ps={key:2,class:"space-y-3"},hs={class:"flex justify-between items-start"},gs={class:"font-medium text-gray-900"},ys={class:"text-sm text-gray-600"},fs={key:0,class:"text-sm text-gray-600 mt-1"},bs={class:"flex space-x-2"},_s=["href"],ws=["href"],xs=["onClick"],ks={__name:"ProjectMeetingsList",props:{projectId:{type:Number,required:!0}},setup(l,{expose:t}){const s=l,o=x([]),i=x(!1),a=x(""),u=()=>{try{a.value=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(f){console.error("Error detecting user timezone:",f),a.value="UTC"}},r=(f,b=null,k=!1)=>{if(!f)return"";try{if(k||f.endsWith("Z")){if(b&&b===a.value){const S={dateStyle:"medium",timeStyle:"short"};return new Date(f).toLocaleString(void 0,S)}const w={dateStyle:"medium",timeStyle:"short",timeZone:b||a.value};return new Date(f).toLocaleString(void 0,w)}else{if(b&&b===a.value){const S={dateStyle:"medium",timeStyle:"short"};return new Date(f).toLocaleString(void 0,S)}const w={dateStyle:"medium",timeStyle:"short",timeZone:b||a.value};return new Date(f).toLocaleString(void 0,w)}}catch(w){return console.error("Error formatting meeting time:",w),new Date(f).toLocaleString()}},m=(f,b=null,k=!1)=>{if(!f)return"";try{if(k||f.endsWith("Z")){if(b&&b===a.value){const S={timeStyle:"short"};return new Date(f).toLocaleTimeString(void 0,S)}const w={timeStyle:"short",timeZone:b||a.value};return new Date(f).toLocaleTimeString(void 0,w)}else{if(b&&b===a.value){const S={timeStyle:"short"};return new Date(f).toLocaleTimeString(void 0,S)}const w={timeStyle:"short",timeZone:b||a.value};return new Date(f).toLocaleTimeString(void 0,w)}}catch(w){return console.error("Error formatting meeting time (time only):",w),new Date(f).toLocaleTimeString()}},c=async()=>{i.value=!0;try{const f=await window.axios.get(`/api/projects/${s.projectId}/meetings`);o.value=f.data}catch(f){console.error("Error fetching project meetings:",f)}finally{i.value=!1}},v=async f=>{if(confirm("Are you sure you want to delete this meeting?"))try{await window.axios.delete(`/api/projects/${s.projectId}/meetings/${f}`),await c()}catch(b){console.error("Error deleting meeting:",b),alert("Failed to delete meeting. Please try again.")}};return t({fetchMeetings:c}),be(()=>{u(),c()}),(f,b)=>(n(),d("div",cs,[b[4]||(b[4]=e("h4",{class:"text-md font-semibold text-gray-900 mb-2"},"Upcoming Meetings",-1)),i.value?(n(),d("div",ms," Loading meetings... ")):o.value.length===0?(n(),d("div",vs," No upcoming meetings scheduled. ")):(n(),d("div",ps,[(n(!0),d(K,null,ee(o.value,k=>(n(),d("div",{key:k.id,class:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[e("div",hs,[e("div",null,[e("h5",gs,g(k.summary),1),e("p",ys,g(r(k.start_time,k.timezone,k.is_utc))+" - "+g(m(k.end_time,k.timezone,k.is_utc)),1),k.location?(n(),d("p",fs,[b[0]||(b[0]=e("span",{class:"font-medium"},"Location:",-1)),F(" "+g(k.location),1)])):D("",!0)]),e("div",bs,[e("a",{href:k.google_event_link,target:"_blank",class:"text-blue-600 hover:text-blue-800",title:"View in Google Calendar"},b[1]||(b[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]),8,_s),k.google_meet_link?(n(),d("a",{key:0,href:k.google_meet_link,target:"_blank",class:"text-green-600 hover:text-green-800",title:"Join Google Meet"},b[2]||(b[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,ws)):D("",!0),e("button",{onClick:w=>v(k.google_event_id),class:"text-red-600 hover:text-red-800",title:"Delete Meeting"},b[3]||(b[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,xs)])])]))),128))]))]))}};var Ds=Object.defineProperty,Cs=(l,t,s)=>t in l?Ds(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s,$e=(l,t,s)=>Cs(l,typeof t!="symbol"?t+"":t,s);const $s=(l,t,s)=>{const o=l[t];return o?typeof o=="function"?o():Promise.resolve(o):new Promise((i,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==s?". Note that variables only represent file names one level deep.":""))))})};let Pe,vt,pt,_e,Re={},Ae={};class Ss{constructor(t,s=!1){$e(this,"texts",{}),$e(this,"dateToMinutes",o=>o.getHours()*60+o.getMinutes()),_e=this,this._texts=t,!s&&Date&&!Date.prototype.addDays&&this._initDatePrototypes()}_initDatePrototypes(){Date.prototype.addDays=function(t){return _e.addDays(this,t)},Date.prototype.subtractDays=function(t){return _e.subtractDays(this,t)},Date.prototype.addHours=function(t){return _e.addHours(this,t)},Date.prototype.subtractHours=function(t){return _e.subtractHours(this,t)},Date.prototype.addMinutes=function(t){return _e.addMinutes(this,t)},Date.prototype.subtractMinutes=function(t){return _e.subtractMinutes(this,t)},Date.prototype.getWeek=function(){return _e.getWeek(this)},Date.prototype.isToday=function(){return _e.isToday(this)},Date.prototype.isLeapYear=function(){return _e.isLeapYear(this)},Date.prototype.format=function(t="YYYY-MM-DD"){return _e.formatDate(this,t)},Date.prototype.formatTime=function(t="HH:mm"){return _e.formatTime(this,t)}}removePrototypes(){delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime}updateTexts(t){this._texts=t}_todayFormatted(){return vt!==new Date().getDate()&&(Pe=new Date,vt=Pe.getDate(),pt=`${Pe.getFullYear()}-${Pe.getMonth()}-${Pe.getDate()}`),pt}addDays(t,s){const o=new Date(t.valueOf());return o.setDate(o.getDate()+s),o}subtractDays(t,s){const o=new Date(t.valueOf());return o.setDate(o.getDate()-s),o}addHours(t,s){const o=new Date(t.valueOf());return o.setHours(o.getHours()+s),o}subtractHours(t,s){const o=new Date(t.valueOf());return o.setHours(o.getHours()-s),o}addMinutes(t,s){const o=new Date(t.valueOf());return o.setMinutes(o.getMinutes()+s),o}subtractMinutes(t,s){const o=new Date(t.valueOf());return o.setMinutes(o.getMinutes()-s),o}getWeek(t){const s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),o=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-o);const i=new Date(Date.UTC(s.getUTCFullYear(),0,1));return Math.ceil(((s-i)/864e5+1)/7)}isToday(t){return`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`===this._todayFormatted()}isLeapYear(t){const s=t.getFullYear();return!(s%400)||s%100&&!(s%4)}getPreviousFirstDayOfWeek(t=null,s){const o=t&&new Date(t.valueOf())||new Date,i=s?7:6;return o.setDate(o.getDate()-(o.getDay()+i)%7),o}stringToDate(t){return t instanceof Date?t:(t.length===10&&(t+=" 00:00"),new Date(t.replace(/-/g,"/")))}countDays(t,s){typeof t=="string"&&(t=t.replace(/-/g,"/")),typeof s=="string"&&(s=s.replace(/-/g,"/")),t=new Date(t).setHours(0,0,0,0),s=new Date(s).setHours(0,0,1,0);const o=(new Date(s).getTimezoneOffset()-new Date(t).getTimezoneOffset())*60*1e3;return Math.ceil((s-t-o)/(24*3600*1e3))}datesInSameTimeStep(t,s,o){return Math.abs(t.getTime()-s.getTime())<=o*60*1e3}formatDate(t,s="YYYY-MM-DD",o=null){if(o||(o=this._texts),s||(s="YYYY-MM-DD"),s==="YYYY-MM-DD")return this.formatDateLite(t);Re={},Ae={};const i={YYYY:()=>this._hydrateDateObject(t,o).YYYY,YY:()=>this._hydrateDateObject(t,o).YY(),M:()=>this._hydrateDateObject(t,o).M,MM:()=>this._hydrateDateObject(t,o).MM(),MMM:()=>this._hydrateDateObject(t,o).MMM(),MMMM:()=>this._hydrateDateObject(t,o).MMMM(),MMMMG:()=>this._hydrateDateObject(t,o).MMMMG(),D:()=>this._hydrateDateObject(t,o).D,DD:()=>this._hydrateDateObject(t,o).DD(),S:()=>this._hydrateDateObject(t,o).S(),d:()=>this._hydrateDateObject(t,o).d,dd:()=>this._hydrateDateObject(t,o).dd(),ddd:()=>this._hydrateDateObject(t,o).ddd(),dddd:()=>this._hydrateDateObject(t,o).dddd(),HH:()=>this._hydrateTimeObject(t,o).HH,H:()=>this._hydrateTimeObject(t,o).H,hh:()=>this._hydrateTimeObject(t,o).hh,h:()=>this._hydrateTimeObject(t,o).h,am:()=>this._hydrateTimeObject(t,o).am,AM:()=>this._hydrateTimeObject(t,o).AM,mm:()=>this._hydrateTimeObject(t,o).mm,m:()=>this._hydrateTimeObject(t,o).m};return s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(a,u)=>{const r=i[u.replace(/\{|\}/g,"")];return r!==void 0?r():u})}formatDateLite(t){const s=t.getMonth()+1,o=t.getDate();return`${t.getFullYear()}-${s<10?"0":""}${s}-${o<10?"0":""}${o}`}formatTime(t,s="HH:mm",o=null,i=!1){let a=!1;if(i){const[m,c,v]=[t.getHours(),t.getMinutes(),t.getSeconds()];m+c+v===141&&(a=!0)}if(t instanceof Date&&s==="HH:mm")return a?"24:00":this.formatTimeLite(t);Ae={},o||(o=this._texts);const u=this._hydrateTimeObject(t,o),r=s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(m,c)=>{const v=u[c.replace(/\{|\}/g,"")];return v!==void 0?v:c});return a?r.replace("23:59","24:00"):r}formatTimeLite(t){const s=t.getHours(),o=t.getMinutes();return`${(s<10?"0":"")+s}:${(o<10?"0":"")+o}`}_nth(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}_hydrateDateObject(t,s){if(Re.D)return Re;const o=t.getFullYear(),i=t.getMonth()+1,a=t.getDate(),r=(t.getDay()-1+7)%7;return Re={YYYY:o,YY:()=>o.toString().substring(2),M:i,MM:()=>(i<10?"0":"")+i,MMM:()=>s.months[i-1].substring(0,3),MMMM:()=>s.months[i-1],MMMMG:()=>(s.monthsGenitive||s.months)[i-1],D:a,DD:()=>(a<10?"0":"")+a,S:()=>this._nth(a),d:r+1,dd:()=>s.weekDays[r][0],ddd:()=>s.weekDays[r].substr(0,3),dddd:()=>s.weekDays[r]},Re}_hydrateTimeObject(t,s){if(Ae.am)return Ae;let o,i;t instanceof Date?(o=t.getHours(),i=t.getMinutes()):(o=Math.floor(t/60),i=Math.floor(t%60));const a=o%12?o%12:12,u=(s||{am:"am",pm:"pm"})[o===24||o<12?"am":"pm"];return Ae={H:o,h:a,HH:(o<10?"0":"")+o,hh:(a<10?"0":"")+a,am:u,AM:u.toUpperCase(),m:i,mm:(i<10?"0":"")+i},Ae}}const Es=1440;class Ms{constructor(t){$e(this,"_vuecal",null),$e(this,"selectCell",(s=!1,o,i)=>{this._vuecal.$emit("cell-click",i?{date:o,split:i}:o),this._vuecal.clickToNavigate||s?this._vuecal.switchToNarrowerView():this._vuecal.dblclickToNavigate&&"ontouchstart"in window&&(this._vuecal.domEvents.dblTapACell.taps++,setTimeout(()=>this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.domEvents.dblTapACell.timeout),this._vuecal.domEvents.dblTapACell.taps>=2&&(this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.switchToNarrowerView(),this._vuecal.$emit("cell-dblclick",i?{date:o,split:i}:o)))}),$e(this,"keyPressEnterCell",(s,o)=>{this._vuecal.$emit("cell-keypress-enter",o?{date:s,split:o}:s),this._vuecal.switchToNarrowerView()}),$e(this,"getPosition",s=>{const{left:o,top:i}=this._vuecal.cellsEl.getBoundingClientRect(),{clientX:a,clientY:u}="ontouchstart"in window&&s.touches?s.touches[0]:s;return{x:a-o,y:u-i}}),$e(this,"minutesAtCursor",s=>{let o=0,i={x:0,y:0};const{timeStep:a,timeCellHeight:u,timeFrom:r}=this._vuecal.$props;return typeof s=="number"?o=s:typeof s=="object"&&(i=this.getPosition(s),o=Math.round(i.y*a/parseInt(u)+r)),{minutes:Math.max(Math.min(o,Es),0),cursorCoords:i}}),this._vuecal=t}}const Ts=2,Je=1440;let me,ve,Ze;class js{constructor(t,s){$e(this,"_vuecal",null),$e(this,"eventDefaults",{_eid:null,start:"",startTimeMinutes:0,end:"",endTimeMinutes:0,title:"",content:"",background:!1,allDay:!1,segments:null,repeat:null,daysCount:1,deletable:!0,deleting:!1,titleEditable:!0,resizable:!0,resizing:!1,draggable:!0,dragging:!1,draggingStatic:!1,focused:!1,class:""}),this._vuecal=t,me=s}createAnEvent(t,s,o){if(typeof t=="string"&&(t=me.stringToDate(t)),!(t instanceof Date))return!1;const i=me.dateToMinutes(t);s=s*1||Ts*60;const a=i+s,u=me.addMinutes(new Date(t),s);o.end&&(typeof o.end=="string"&&(o.end=me.stringToDate(o.end)),o.endTimeMinutes=me.dateToMinutes(o.end));const r={...this.eventDefaults,_eid:`${this._vuecal._.uid}_${this._vuecal.eventIdIncrement++}`,start:t,startTimeMinutes:i,end:u,endTimeMinutes:a,segments:null,...o};if(!(typeof this._vuecal.onEventCreate=="function"&&!this._vuecal.onEventCreate(r,()=>this.deleteAnEvent(r))))return r.startDateF!==r.endDateF&&(r.daysCount=me.countDays(r.start,r.end)),this._vuecal.mutableEvents.push(r),this._vuecal.addEventsToView([r]),this._vuecal.emitWithEvent("event-create",r),this._vuecal.$emit("event-change",{event:this._vuecal.cleanupEvent(r),originalEvent:null}),r}addEventSegment(t){t.segments||(t.segments={},t.segments[me.formatDateLite(t.start)]={start:t.start,startTimeMinutes:t.startTimeMinutes,endTimeMinutes:Je,isFirstDay:!0,isLastDay:!1});const s=t.segments[me.formatDateLite(t.end)];s&&(s.isLastDay=!1,s.endTimeMinutes=Je);const o=me.addDays(t.end,1),i=me.formatDateLite(o);return o.setHours(0,0,0,0),t.segments[i]={start:o,startTimeMinutes:0,endTimeMinutes:t.endTimeMinutes,isFirstDay:!1,isLastDay:!0},t.end=me.addMinutes(o,t.endTimeMinutes),t.daysCount=Object.keys(t.segments).length,i}removeEventSegment(t){let s=Object.keys(t.segments).length;if(s<=1)return me.formatDateLite(t.end);delete t.segments[me.formatDateLite(t.end)],s--;const o=me.subtractDays(t.end,1),i=me.formatDateLite(o),a=t.segments[i];return s?a&&(a.isLastDay=!0,a.endTimeMinutes=t.endTimeMinutes):t.segments=null,t.daysCount=s||1,t.end=o,i}createEventSegments(t,s,o){const i=s.getTime(),a=o.getTime();let u=t.start.getTime(),r=t.end.getTime(),m=!1,c,v,f;for(!t.end.getHours()&&!t.end.getMinutes()&&(r-=1e3),t.segments={},t.repeat?(c=i,v=Math.min(a,t.repeat.until?me.stringToDate(t.repeat.until).getTime():a)):(c=Math.max(i,u),v=Math.min(a,r));c<=v;){let b=!1;const k=me.addDays(new Date(c),1).setHours(0,0,0,0);let w,S,y,h;if(t.repeat){const M=new Date(c),j=me.formatDateLite(M);(m||t.occurrences&&t.occurrences[j])&&(m||(u=t.occurrences[j].start,f=new Date(u).setHours(0,0,0,0),r=t.occurrences[j].end),m=!0,b=!0),w=c===f,S=j===me.formatDateLite(new Date(r)),y=new Date(w?u:c),h=me.formatDateLite(y),S&&(m=!1)}else b=!0,w=c===u,S=v===r&&k>v,y=w?t.start:new Date(c),h=me.formatDateLite(w?t.start:y);b&&(t.segments[h]={start:y,startTimeMinutes:w?t.startTimeMinutes:0,endTimeMinutes:S?t.endTimeMinutes:Je,isFirstDay:w,isLastDay:S}),c=k}return t}deleteAnEvent(t){this._vuecal.emitWithEvent("event-delete",t),this._vuecal.mutableEvents=this._vuecal.mutableEvents.filter(s=>s._eid!==t._eid),this._vuecal.view.events=this._vuecal.view.events.filter(s=>s._eid!==t._eid)}checkCellOverlappingEvents(t,s){Ze=t.slice(0),ve={},t.forEach(i=>{Ze.shift(),ve[i._eid]||(ve[i._eid]={overlaps:[],start:i.start,position:0}),ve[i._eid].position=0,Ze.forEach(a=>{ve[a._eid]||(ve[a._eid]={overlaps:[],start:a.start,position:0});const u=this.eventInRange(a,i.start,i.end),r=s.overlapsPerTimeStep?me.datesInSameTimeStep(i.start,a.start,s.timeStep):1;if(!i.background&&!i.allDay&&!a.background&&!a.allDay&&u&&r)ve[i._eid].overlaps.push(a._eid),ve[i._eid].overlaps=[...new Set(ve[i._eid].overlaps)],ve[a._eid].overlaps.push(i._eid),ve[a._eid].overlaps=[...new Set(ve[a._eid].overlaps)],ve[a._eid].position++;else{let m,c;(m=(ve[i._eid]||{overlaps:[]}).overlaps.indexOf(a._eid))>-1&&ve[i._eid].overlaps.splice(m,1),(c=(ve[a._eid]||{overlaps:[]}).overlaps.indexOf(i._eid))>-1&&ve[a._eid].overlaps.splice(c,1),ve[a._eid].position--}})});let o=0;for(const i in ve){const a=ve[i],u=a.overlaps.map(r=>({id:r,start:ve[r].start}));u.push({id:i,start:a.start}),u.sort((r,m)=>r.start<m.start?-1:r.start>m.start?1:r.id>m.id?-1:1),a.position=u.findIndex(r=>r.id===i),o=Math.max(this.getOverlapsStreak(a,ve),o)}return[ve,o]}getOverlapsStreak(t,s={}){let o=t.overlaps.length+1,i=[];return t.overlaps.forEach(a=>{i.includes(a)||t.overlaps.filter(r=>r!==a).forEach(r=>{s[r].overlaps.includes(a)||i.push(r)})}),i=[...new Set(i)],o-=i.length,o}eventInRange(t,s,o){if(t.allDay||!this._vuecal.time){const u=new Date(t.start).setHours(0,0,0,0);return new Date(t.end).setHours(23,59,0,0)>=new Date(s).setHours(0,0,0,0)&&u<=new Date(o).setHours(0,0,0,0)}const i=t.start.getTime(),a=t.end.getTime();return i<o.getTime()&&a>s.getTime()}}const Vs={class:"vuecal__flex vuecal__weekdays-headings"},As=["onClick"],Os={class:"vuecal__flex weekday-label",grow:""},Is={class:"full"},Ls={class:"small"},Us={class:"xsmall"},Ns={key:0},Ps={key:0,class:"vuecal__flex vuecal__split-days-headers",grow:""};function Rs(l,t,s,o,i,a){return n(),d("div",Vs,[(n(!0),d(K,null,ee(a.headings,(u,r)=>(n(),d(K,{key:r},[u.hide?D("",!0):(n(),d("div",{key:0,class:Q(["vuecal__flex vuecal__heading",{today:u.today,clickable:a.cellHeadingsClickable}]),style:xe(a.weekdayCellStyles),onClick:m=>a.view.id==="week"&&a.selectCell(u.date,m),onDblclick:t[0]||(t[0]=m=>a.view.id==="week"&&a.vuecal.dblclickToNavigate&&s.switchToNarrowerView())},[p(ze,{name:`slide-fade--${s.transitionDirection}`,appear:a.vuecal.transitions},{default:N(()=>[(n(),d("div",{class:"vuecal__flex",column:"",key:a.vuecal.transitions?`${r}-${u.dayOfMonth}`:!1},[e("div",Os,[ie(l.$slots,"weekday-heading",{heading:a.cleanupHeading(u),view:a.view},()=>[e("span",Is,g(u.full),1),e("span",Ls,g(u.small),1),e("span",Us,g(u.xsmall),1),u.dayOfMonth?(n(),d("span",Ns," "+g(u.dayOfMonth),1)):D("",!0)])]),a.vuecal.hasSplits&&a.vuecal.stickySplitLabels?(n(),d("div",Ps,[(n(!0),d(K,null,ee(a.vuecal.daySplits,(m,c)=>(n(),d("div",{class:Q(["day-split-header",m.class||!1]),key:c},[ie(l.$slots,"split-label",{split:m,view:a.view},()=>[F(g(m.label),1)])],2))),128))])):D("",!0)]))]),_:2},1032,["name","appear"])],46,As))],64))),128))])}const Ue=(l,t)=>{const s=l.__vccOpts||l;for(const[o,i]of t)s[o]=i;return s},Fs={inject:["vuecal","utils","view"],props:{transitionDirection:{type:String,default:"right"},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},methods:{selectCell(l,t){l.getTime()!==this.view.selectedDate.getTime()&&(this.view.selectedDate=l),this.utils.cell.selectCell(!1,l,t)},cleanupHeading:l=>({label:l.full,date:l.date,...l.today?{today:l.today}:{}})},computed:{headings(){if(!["month","week"].includes(this.view.id))return[];let l=!1;return this.weekDays.map((s,o)=>{const i=this.utils.date.addDays(this.view.startDate,this.vuecal.startWeekOnSunday&&this.vuecal.hideWeekends?o-1:o);return{hide:s.hide,full:s.label,small:s.short||s.label.substr(0,3),xsmall:s.short||s.label.substr(0,1),...this.view.id==="week"?{dayOfMonth:i.getDate(),date:i,today:!l&&this.utils.date.isToday(i)&&!l++}:{}}})},cellWidth(){return 100/(7-this.weekDays.reduce((l,t)=>l+t.hide,0))},weekdayCellStyles(){return{...this.vuecal.hideWeekdays.length?{width:`${this.cellWidth}%`}:{}}},cellHeadingsClickable(){return this.view.id==="week"&&(this.vuecal.clickToNavigate||this.vuecal.dblclickToNavigate)}}},_t=Ue(Fs,[["render",Rs]]),Bs={class:"vuecal__header"},Hs={key:0,class:"vuecal__flex vuecal__menu",role:"tablist","aria-label":"Calendar views navigation"},Ws=["onDragenter","onDragleave","onClick","aria-label"],Ys={key:1,class:"vuecal__title-bar"},zs=["aria-label"],qs={class:"vuecal__flex vuecal__title",grow:""},Gs=["aria-label"],Ks={key:0,class:"vuecal__flex vuecal__split-days-headers"};function Js(l,t,s,o,i,a){const u=Te("weekdays-headings");return n(),d("div",Bs,[s.options.hideViewSelector?D("",!0):(n(),d("div",Hs,[(n(!0),d(K,null,ee(s.viewProps.views,(r,m)=>(n(),d(K,{key:m},[r.enabled?(n(),d("button",{key:0,class:Q(["vuecal__view-btn",{"vuecal__view-btn--active":a.view.id===m,"vuecal__view-btn--highlighted":l.highlightedControl===m}]),type:"button",onDragenter:c=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(c,m,l.$data),onDragleave:c=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(c,m,l.$data),onClick:c=>a.switchView(m,null,!0),"aria-label":`${r.label} view`},g(r.label),43,Ws)):D("",!0)],64))),128))])),s.options.hideTitleBar?D("",!0):(n(),d("div",Ys,[e("button",{class:Q(["vuecal__arrow vuecal__arrow--prev",{"vuecal__arrow--highlighted":l.highlightedControl==="previous"}]),type:"button",onClick:t[0]||(t[0]=(...r)=>a.previous&&a.previous(...r)),onDragenter:t[1]||(t[1]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(r,"previous",l.$data)),onDragleave:t[2]||(t[2]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(r,"previous",l.$data)),"aria-label":`Previous ${a.view.id}`},[ie(l.$slots,"arrow-prev")],42,zs),e("div",qs,[p(ze,{name:s.options.transitions?`slide-fade--${a.transitionDirection}`:""},{default:N(()=>[(n(),le(Xt(a.broaderView?"button":"span"),{type:!!a.broaderView&&"button",key:`${a.view.id}${a.view.startDate.toString()}`,onClick:t[3]||(t[3]=r=>!!a.broaderView&&a.switchToBroaderView()),"aria-label":!!a.broaderView&&`Go to ${a.broaderView} view`},{default:N(()=>[ie(l.$slots,"title")]),_:3},8,["type","aria-label"]))]),_:3},8,["name"])]),s.options.todayButton?(n(),d("button",{key:0,class:Q(["vuecal__today-btn",{"vuecal__today-btn--highlighted":l.highlightedControl==="today"}]),type:"button",onClick:t[4]||(t[4]=(...r)=>a.goToToday&&a.goToToday(...r)),onDragenter:t[5]||(t[5]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(r,"today",l.$data)),onDragleave:t[6]||(t[6]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(r,"today",l.$data)),"aria-label":"Today"},[ie(l.$slots,"today-button")],34)):D("",!0),e("button",{class:Q(["vuecal__arrow vuecal__arrow--next",{"vuecal__arrow--highlighted":l.highlightedControl==="next"}]),type:"button",onClick:t[7]||(t[7]=(...r)=>a.next&&a.next(...r)),onDragenter:t[8]||(t[8]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(r,"next",l.$data)),onDragleave:t[9]||(t[9]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(r,"next",l.$data)),"aria-label":`Next ${a.view.id}`},[ie(l.$slots,"arrow-next")],42,Gs)])),s.viewProps.weekDaysInHeader?(n(),le(u,{key:2,"week-days":s.weekDays,"transition-direction":a.transitionDirection,"switch-to-narrower-view":s.switchToNarrowerView},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:N(({heading:r,view:m})=>[ie(l.$slots,"weekday-heading",{heading:r,view:m})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:N(({split:r})=>[ie(l.$slots,"split-label",{split:r,view:a.view})]),key:"1"}:void 0]),1032,["week-days","transition-direction","switch-to-narrower-view"])):D("",!0),p(ze,{name:`slide-fade--${a.transitionDirection}`},{default:N(()=>[a.showDaySplits?(n(),d("div",Ks,[(n(!0),d(K,null,ee(s.daySplits,(r,m)=>(n(),d("div",{class:Q(["day-split-header",r.class||!1]),key:m},[ie(l.$slots,"split-label",{split:r,view:a.view.id},()=>[F(g(r.label),1)])],2))),128))])):D("",!0)]),_:3},8,["name"])])}const Zs={inject:["vuecal","previous","next","switchView","updateSelectedDate","modules","view"],components:{WeekdaysHeadings:_t},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},hasSplits:{type:[Boolean,Number],default:!1},daySplits:{type:Array,default:()=>[]},viewProps:{type:Object,default:()=>({})},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},data:()=>({highlightedControl:null}),methods:{goToToday(){this.updateSelectedDate(new Date(new Date().setHours(0,0,0,0)))},switchToBroaderView(){this.transitionDirection="left",this.broaderView&&this.switchView(this.broaderView)}},computed:{transitionDirection:{get(){return this.vuecal.transitionDirection},set(l){this.vuecal.transitionDirection=l}},broaderView(){const{enabledViews:l}=this.vuecal;return l[l.indexOf(this.view.id)-1]},showDaySplits(){return this.view.id==="day"&&this.hasSplits&&this.options.stickySplitLabels&&!this.options.minSplitWidth},dnd(){return this.modules.dnd}}},Xs=Ue(Zs,[["render",Js]]),Qs=["draggable"];function el(l,t,s,o,i,a){return n(),d("div",{class:Q(["vuecal__event",a.eventClasses]),style:xe(a.eventStyles),tabindex:"0",onFocus:t[4]||(t[4]=(...u)=>a.focusEvent&&a.focusEvent(...u)),onKeypress:t[5]||(t[5]=Ie(we((...u)=>a.onEnterKeypress&&a.onEnterKeypress(...u),["stop"]),["enter"])),onMouseenter:t[6]||(t[6]=(...u)=>a.onMouseEnter&&a.onMouseEnter(...u)),onMouseleave:t[7]||(t[7]=(...u)=>a.onMouseLeave&&a.onMouseLeave(...u)),onTouchstart:t[8]||(t[8]=we((...u)=>a.onTouchStart&&a.onTouchStart(...u),["stop"])),onMousedown:t[9]||(t[9]=u=>a.onMouseDown(u)),onMouseup:t[10]||(t[10]=(...u)=>a.onMouseUp&&a.onMouseUp(...u)),onTouchend:t[11]||(t[11]=(...u)=>a.onMouseUp&&a.onMouseUp(...u)),onTouchmove:t[12]||(t[12]=(...u)=>a.onTouchMove&&a.onTouchMove(...u)),onDblclick:t[13]||(t[13]=(...u)=>a.onDblClick&&a.onDblClick(...u)),draggable:a.draggable,onDragstart:t[14]||(t[14]=u=>a.draggable&&a.onDragStart(u)),onDragend:t[15]||(t[15]=u=>a.draggable&&a.onDragEnd())},[a.vuecal.editEvents.delete&&s.event.deletable?(n(),d("div",{key:0,class:"vuecal__event-delete",onClick:t[0]||(t[0]=we((...u)=>a.deleteEvent&&a.deleteEvent(...u),["stop"])),onTouchstart:t[1]||(t[1]=we((...u)=>a.touchDeleteEvent&&a.touchDeleteEvent(...u),["stop"]))},g(a.vuecal.texts.deleteEvent),33)):D("",!0),ie(l.$slots,"event",{event:s.event,view:a.view.id}),a.resizable?(n(),d("div",{key:1,class:"vuecal__event-resize-handle",contenteditable:"false",onMousedown:t[2]||(t[2]=we((...u)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...u),["stop","prevent"])),onTouchstart:t[3]||(t[3]=we((...u)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...u),["stop","prevent"]))},null,32)):D("",!0)],46,Qs)}const tl={inject:["vuecal","utils","modules","view","domEvents","editEvents"],props:{cellFormattedDate:{type:String,default:""},event:{type:Object,default:()=>({})},cellEvents:{type:Array,default:()=>[]},overlaps:{type:Array,default:()=>[]},eventPosition:{type:Number,default:0},overlapsStreak:{type:Number,default:0},allDay:{type:Boolean,default:!1}},data:()=>({touch:{dragThreshold:30,startX:0,startY:0,dragged:!1}}),methods:{onMouseDown(l,t=!1){if("ontouchstart"in window&&!t)return!1;const{clickHoldAnEvent:s,focusAnEvent:o,resizeAnEvent:i,dragAnEvent:a}=this.domEvents;if(o._eid===this.event._eid&&s._eid===this.event._eid)return!0;this.focusEvent(),s._eid=null,this.vuecal.editEvents.delete&&this.event.deletable&&(s.timeoutId=setTimeout(()=>{!i._eid&&!a._eid&&(s._eid=this.event._eid,this.event.deleting=!0)},s.timeout))},onMouseUp(l){this.domEvents.focusAnEvent._eid===this.event._eid&&!this.touch.dragged&&(this.domEvents.focusAnEvent.mousedUp=!0),this.touch.dragged=!1},onMouseEnter(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-enter",this.event)},onMouseLeave(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-leave",this.event)},onTouchMove(l){if(typeof this.vuecal.onEventClick!="function")return;const{clientX:t,clientY:s}=l.touches[0],{startX:o,startY:i,dragThreshold:a}=this.touch;(Math.abs(t-o)>a||Math.abs(s-i)>a)&&(this.touch.dragged=!0)},onTouchStart(l){this.touch.startX=l.touches[0].clientX,this.touch.startY=l.touches[0].clientY,this.onMouseDown(l,!0)},onEnterKeypress(l){if(typeof this.vuecal.onEventClick=="function")return this.vuecal.onEventClick(this.event,l)},onDblClick(l){if(typeof this.vuecal.onEventDblclick=="function")return this.vuecal.onEventDblclick(this.event,l)},onDragStart(l){this.dnd&&this.dnd.eventDragStart(l,this.event)},onDragEnd(){this.dnd&&this.dnd.eventDragEnd(this.event)},onResizeHandleMouseDown(){this.focusEvent(),this.domEvents.dragAnEvent._eid=null,this.domEvents.resizeAnEvent=Object.assign(this.domEvents.resizeAnEvent,{_eid:this.event._eid,start:(this.segment||this.event).start,split:this.event.split||null,segment:!!this.segment&&this.utils.date.formatDateLite(this.segment.start),originalEnd:new Date((this.segment||this.event).end),originalEndTimeMinutes:this.event.endTimeMinutes}),this.event.resizing=!0},deleteEvent(l=!1){if("ontouchstart"in window&&!l)return!1;this.utils.event.deleteAnEvent(this.event)},touchDeleteEvent(l){this.deleteEvent(!0)},cancelDeleteEvent(){this.event.deleting=!1},focusEvent(){const{focusAnEvent:l}=this.domEvents,t=l._eid;if(t!==this.event._eid){if(t){const s=this.view.events.find(o=>o._eid===t);s&&(s.focused=!1)}this.vuecal.cancelDelete(),this.vuecal.emitWithEvent("event-focus",this.event),l._eid=this.event._eid,this.event.focused=!0}}},computed:{eventDimensions(){const{startTimeMinutes:l,endTimeMinutes:t}=this.segment||this.event;let s=l-this.vuecal.timeFrom;const o=Math.max(Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),0);s=Math.min(t,this.vuecal.timeTo)-this.vuecal.timeFrom;const i=Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),a=Math.max(i-o,5);return{top:o,height:a}},eventStyles(){if(this.event.allDay||!this.vuecal.time||!this.event.endTimeMinutes||this.view.id==="month"||this.allDay)return{};let l=100/Math.min(this.overlaps.length+1,this.overlapsStreak),t=100/(this.overlaps.length+1)*this.eventPosition;this.vuecal.minEventWidth&&l<this.vuecal.minEventWidth&&(l=this.vuecal.minEventWidth,t=(100-this.vuecal.minEventWidth)/this.overlaps.length*this.eventPosition);const{top:s,height:o}=this.eventDimensions;return{top:`${s}px`,height:`${o}px`,width:`${l}%`,left:this.event.left&&`${this.event.left}px`||`${t}%`}},eventClasses(){const{isFirstDay:l,isLastDay:t}=this.segment||{};return{[this.event.class]:!!this.event.class,"vuecal__event--focus":this.event.focused,"vuecal__event--resizing":this.event.resizing,"vuecal__event--background":this.event.background,"vuecal__event--deletable":this.event.deleting,"vuecal__event--all-day":this.event.allDay,"vuecal__event--dragging":!this.event.draggingStatic&&this.event.dragging,"vuecal__event--static":this.event.dragging&&this.event.draggingStatic,"vuecal__event--multiple-days":!!this.segment,"event-start":this.segment&&l&&!t,"event-middle":this.segment&&!l&&!t,"event-end":this.segment&&t&&!l}},segment(){return this.event.segments&&this.event.segments[this.cellFormattedDate]||null},draggable(){const{draggable:l,background:t,daysCount:s}=this.event;return this.vuecal.editEvents.drag&&l&&!t&&s===1},resizable(){const{editEvents:l,time:t}=this.vuecal;return l.resize&&this.event.resizable&&t&&!this.allDay&&(!this.segment||this.segment&&this.segment.isLastDay)&&this.view.id!=="month"},dnd(){return this.modules.dnd}}},sl=Ue(tl,[["render",el]]),ll=["data-split","aria-label","onTouchstart","onMousedown","onDragover","onDrop"],al={key:0,class:"cell-time-labels"},il=["innerHTML"],nl={key:2,class:"vuecal__cell-events"},ol=["title"];function rl(l,t,s,o,i,a){const u=Te("event");return n(),le(Qt,{class:Q(["vuecal__cell",a.cellClasses]),name:`slide-fade--${a.transitionDirection}`,tag:"div",appear:s.options.transitions,style:xe(a.cellStyles)},{default:N(()=>[(n(!0),d(K,null,ee(a.splitsCount?a.splits:1,(r,m)=>(n(),d("div",{class:Q(["vuecal__flex vuecal__cell-content",a.splitsCount&&a.splitClasses(r)]),key:s.options.transitions?`${a.view.id}-${s.data.content}-${m}`:m,"data-split":a.splitsCount?r.id:!1,column:"",tabindex:"0","aria-label":s.data.content,onFocus:t[0]||(t[0]=c=>a.onCellFocus(c)),onKeypress:t[1]||(t[1]=Ie(c=>a.onCellkeyPressEnter(c),["enter"])),onTouchstart:c=>!a.isDisabled&&a.onCellTouchStart(c,a.splitsCount?r.id:null),onMousedown:c=>!a.isDisabled&&a.onCellMouseDown(c,a.splitsCount?r.id:null),onClick:t[2]||(t[2]=c=>!a.isDisabled&&a.onCellClick(c)),onDblclick:t[3]||(t[3]=c=>!a.isDisabled&&a.onCellDblClick(c)),onContextmenu:t[4]||(t[4]=c=>!a.isDisabled&&s.options.cellContextmenu&&a.onCellContextMenu(c)),onDragenter:t[5]||(t[5]=c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragEnter(c,l.$data,s.data.startDate)),onDragover:c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragOver(c,l.$data,s.data.startDate,a.splitsCount?r.id:null),onDragleave:t[6]||(t[6]=c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragLeave(c,l.$data,s.data.startDate)),onDrop:c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragDrop(c,l.$data,s.data.startDate,a.splitsCount?r.id:null)},[s.options.showTimeInCells&&s.options.time&&a.isWeekOrDayView&&!s.allDay?(n(),d("div",al,[(n(!0),d(K,null,ee(a.vuecal.timeCells,(c,v)=>(n(),d("span",{class:"cell-time-label",key:v},g(c.label),1))),128))])):D("",!0),a.isWeekOrDayView&&!s.allDay&&a.specialHours.length?(n(!0),d(K,{key:1},ee(a.specialHours,(c,v)=>(n(),d("div",{class:Q(["vuecal__special-hours",`vuecal__special-hours--day${c.day} ${c.class}`]),style:xe(`height: ${c.height}px;top: ${c.top}px`)},[c.label?(n(),d("div",{key:0,class:"special-hours-label",innerHTML:c.label},null,8,il)):D("",!0)],6))),256)):D("",!0),ie(l.$slots,"cell-content",{events:a.events,selectCell:c=>a.selectCell(c,!0),split:a.splitsCount?r:!1}),a.eventsCount&&(a.isWeekOrDayView||a.view.id==="month"&&s.options.eventsOnMonthView)?(n(),d("div",nl,[(n(!0),d(K,null,ee(a.splitsCount?r.events:a.events,(c,v)=>(n(),le(u,{key:v,"cell-formatted-date":s.data.formattedDate,event:c,"all-day":s.allDay,"cell-events":a.splitsCount?r.events:a.events,overlaps:((a.splitsCount?r.overlaps[c._eid]:l.cellOverlaps[c._eid])||[]).overlaps,"event-position":((a.splitsCount?r.overlaps[c._eid]:l.cellOverlaps[c._eid])||[]).position,"overlaps-streak":a.splitsCount?r.overlapsStreak:l.cellOverlapsStreak},{event:N(({event:f,view:b})=>[ie(l.$slots,"event",{view:b,event:f})]),_:2},1032,["cell-formatted-date","event","all-day","cell-events","overlaps","event-position","overlaps-streak"]))),128))])):D("",!0)],42,ll))),128)),a.timelineVisible?(n(),d("div",{class:"vuecal__now-line",style:xe(`top: ${a.todaysTimePosition}px`),key:s.options.transitions?`${a.view.id}-now-line`:"now-line",title:a.utils.date.formatTime(a.vuecal.now)},null,12,ol)):D("",!0)]),_:3},8,["class","name","appear","style"])}const dl={inject:["vuecal","utils","modules","view","domEvents"],components:{Event:sl},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},data:{type:Object,required:!0},cellSplits:{type:Array,default:()=>[]},minTimestamp:{type:[Number,null],default:null},maxTimestamp:{type:[Number,null],default:null},cellWidth:{type:[Number,Boolean],default:!1},allDay:{type:Boolean,default:!1}},data:()=>({cellOverlaps:{},cellOverlapsStreak:1,timeAtCursor:null,highlighted:!1,highlightedSplit:null}),methods:{getSplitAtCursor({target:l}){let s=l.classList.contains("vuecal__cell-split")?l:this.vuecal.findAncestor(l,"vuecal__cell-split");return s&&(s=s.attributes["data-split"].value,parseInt(s).toString()===s.toString()&&(s=parseInt(s))),s||null},splitClasses(l){return{"vuecal__cell-split":!0,"vuecal__cell-split--highlighted":this.highlightedSplit===l.id,[l.class]:!!l.class}},checkCellOverlappingEvents(){this.options.time&&this.eventsCount&&!this.splitsCount&&(this.eventsCount===1?(this.cellOverlaps=[],this.cellOverlapsStreak=1):[this.cellOverlaps,this.cellOverlapsStreak]=this.utils.event.checkCellOverlappingEvents(this.events,this.options))},isDOMElementAnEvent(l){return this.vuecal.isDOMElementAnEvent(l)},selectCell(l,t=!1){const s=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.selectCell(t,this.timeAtCursor,s),this.timeAtCursor=null},onCellkeyPressEnter(l){this.isSelected||this.onCellFocus(l);const t=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.keyPressEnterCell(this.timeAtCursor,t),this.timeAtCursor=null},onCellFocus(l){if(!this.isSelected&&!this.isDisabled){this.isSelected=this.data.startDate;const t=this.splitsCount?this.getSplitAtCursor(l):null,s=this.timeAtCursor||this.data.startDate;this.vuecal.$emit("cell-focus",t?{date:s,split:t}:s)}},onCellMouseDown(l,t=null,s=!1){if("ontouchstart"in window&&!s)return!1;this.isSelected||this.onCellFocus(l);const{clickHoldACell:o,focusAnEvent:i}=this.domEvents;this.domEvents.cancelClickEventCreation=!1,o.eventCreated=!1,this.timeAtCursor=new Date(this.data.startDate);const{minutes:a,cursorCoords:{y:u}}=this.vuecal.minutesAtCursor(l);this.timeAtCursor.setMinutes(a);const r=this.isDOMElementAnEvent(l.target);!r&&i._eid&&((this.view.events.find(m=>m._eid===i._eid)||{}).focused=!1),this.editEvents.create&&!r&&this.setUpEventCreation(l,u)},setUpEventCreation(l,t){if(this.options.dragToCreateEvent&&["week","day"].includes(this.view.id)){const{dragCreateAnEvent:s}=this.domEvents;if(s.startCursorY=t,s.split=this.splitsCount?this.getSplitAtCursor(l):null,s.start=this.timeAtCursor,this.options.snapToTime){let o=this.timeAtCursor.getHours()*60+this.timeAtCursor.getMinutes();const i=o+this.options.snapToTime/2;o=i-i%this.options.snapToTime,s.start.setHours(0,o,0,0)}}else this.options.cellClickHold&&["month","week","day"].includes(this.view.id)&&this.setUpCellHoldTimer(l)},setUpCellHoldTimer(l){const{clickHoldACell:t}=this.domEvents;t.cellId=`${this.vuecal._.uid}_${this.data.formattedDate}`,t.split=this.splitsCount?this.getSplitAtCursor(l):null,t.timeoutId=setTimeout(()=>{if(t.cellId&&!this.domEvents.cancelClickEventCreation){const{_eid:s}=this.utils.event.createAnEvent(this.timeAtCursor,null,t.split?{split:t.split}:{});t.eventCreated=s}},t.timeout)},onCellTouchStart(l,t=null){this.onCellMouseDown(l,t,!0)},onCellClick(l){this.isDOMElementAnEvent(l.target)||this.selectCell(l)},onCellDblClick(l){const t=new Date(this.data.startDate);t.setMinutes(this.vuecal.minutesAtCursor(l).minutes);const s=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-dblclick",s?{date:t,split:s}:t),this.options.dblclickToNavigate&&this.vuecal.switchToNarrowerView()},onCellContextMenu(l){l.stopPropagation(),l.preventDefault();const t=new Date(this.data.startDate),{cursorCoords:s,minutes:o}=this.vuecal.minutesAtCursor(l);t.setMinutes(o);const i=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-contextmenu",{date:t,...s,...i||{},e:l})}},computed:{dnd(){return this.modules.dnd},nowInMinutes(){return this.utils.date.dateToMinutes(this.vuecal.now)},isBeforeMinDate(){return this.minTimestamp!==null&&this.minTimestamp>this.data.endDate.getTime()},isAfterMaxDate(){return this.maxTimestamp&&this.maxTimestamp<this.data.startDate.getTime()},isDisabled(){const{disableDays:l}=this.options,{isYearsOrYearView:t}=this.vuecal;return l.length&&l.includes(this.data.formattedDate)&&!t?!0:this.isBeforeMinDate||this.isAfterMaxDate},isSelected:{get(){let l=!1;const{selectedDate:t}=this.view;return this.view.id==="years"?l=t.getFullYear()===this.data.startDate.getFullYear():this.view.id==="year"?l=t.getFullYear()===this.data.startDate.getFullYear()&&t.getMonth()===this.data.startDate.getMonth():l=t.getTime()===this.data.startDate.getTime(),l},set(l){this.view.selectedDate=l,this.vuecal.$emit("update:selected-date",this.view.selectedDate)}},isWeekOrDayView(){return["week","day"].includes(this.view.id)},transitionDirection(){return this.vuecal.transitionDirection},specialHours(){return this.data.specialHours.map(l=>{let{from:t,to:s}=l;return t=Math.max(t,this.options.timeFrom),s=Math.min(s,this.options.timeTo),{...l,height:(s-t)*this.timeScale,top:(t-this.options.timeFrom)*this.timeScale}})},events(){const{startDate:l,endDate:t}=this.data;let s=[];if(!(["years","year"].includes(this.view.id)&&!this.options.eventsCountOnYearView)){if(s=this.view.events.slice(0),this.view.id==="month"&&s.push(...this.view.outOfScopeEvents),s=s.filter(o=>this.utils.event.eventInRange(o,l,t)),this.options.showAllDayEvents&&this.view.id!=="month"&&(s=s.filter(o=>!!o.allDay===this.allDay)),this.options.time&&this.isWeekOrDayView&&!this.allDay){const{timeFrom:o,timeTo:i}=this.options;s=s.filter(a=>{const u=a.daysCount>1&&a.segments[this.data.formattedDate]||{},r=a.daysCount===1&&a.startTimeMinutes<i&&a.endTimeMinutes>o,m=a.daysCount>1&&u.startTimeMinutes<i&&u.endTimeMinutes>o;return a.allDay||r||m||!1})}this.options.time&&this.isWeekOrDayView&&!(this.options.showAllDayEvents&&this.allDay)&&s.sort((o,i)=>o.start<i.start?-1:1),this.cellSplits.length||this.$nextTick(this.checkCellOverlappingEvents)}return s},eventsCount(){return this.events.length},splits(){return this.cellSplits.map((l,t)=>{const s=this.events.filter(a=>a.split===l.id),[o,i]=this.utils.event.checkCellOverlappingEvents(s.filter(a=>!a.background&&!a.allDay),this.options);return{...l,overlaps:o,overlapsStreak:i,events:s}})},splitsCount(){return this.splits.length},cellClasses(){return{[this.data.class]:!!this.data.class,"vuecal__cell--current":this.data.current,"vuecal__cell--today":this.data.today,"vuecal__cell--out-of-scope":this.data.outOfScope,"vuecal__cell--before-min":this.isDisabled&&this.isBeforeMinDate,"vuecal__cell--after-max":this.isDisabled&&this.isAfterMaxDate,"vuecal__cell--disabled":this.isDisabled,"vuecal__cell--selected":this.isSelected,"vuecal__cell--highlighted":this.highlighted,"vuecal__cell--has-splits":this.splitsCount,"vuecal__cell--has-events":this.eventsCount}},cellStyles(){return{...this.cellWidth?{width:`${this.cellWidth}%`}:{}}},timelineVisible(){const{time:l,timeTo:t}=this.options;return this.data.today&&this.isWeekOrDayView&&l&&!this.allDay&&this.nowInMinutes<=t},todaysTimePosition(){if(!this.data.today||!this.options.time)return;const l=this.nowInMinutes-this.options.timeFrom;return Math.round(l*this.timeScale)},timeScale(){return this.options.timeCellHeight/this.options.timeStep}}},wt=Ue(dl,[["render",rl]]),ul={key:0,class:"vuecal__all-day-text",style:{width:"3em"}};function cl(l,t,s,o,i,a){const u=Te("vuecal-cell");return n(),d("div",{class:"vuecal__flex vuecal__all-day",style:xe(s.cellOrSplitMinWidth&&{height:s.height})},[s.cellOrSplitMinWidth?D("",!0):(n(),d("div",ul,[e("span",null,g(s.label),1)])),e("div",{class:Q(["vuecal__flex vuecal__cells",`${a.view.id}-view`]),grow:"",style:xe(s.cellOrSplitMinWidth?`min-width: ${s.cellOrSplitMinWidth}px`:"")},[(n(!0),d(K,null,ee(s.cells,(r,m)=>(n(),le(u,{key:m,options:s.options,"edit-events":a.editEvents,data:r,"all-day":!0,"cell-width":s.options.hideWeekdays.length&&(a.vuecal.isWeekView||a.vuecal.isMonthView)&&a.vuecal.cellWidth,"min-timestamp":s.options.minTimestamp,"max-timestamp":s.options.maxTimestamp,"cell-splits":s.daySplits},{event:N(({event:c,view:v})=>[ie(l.$slots,"event",{view:v,event:c})]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],6)],4)}const ml={inject:["vuecal","view","editEvents"],components:{"vuecal-cell":wt},props:{options:{type:Object,required:!0},cells:{type:Array,required:!0},label:{type:String,required:!0},daySplits:{type:Array,default:()=>[]},shortEvents:{type:Boolean,default:!0},height:{type:String,default:""},cellOrSplitMinWidth:{type:Number,default:null}},computed:{hasCellOrSplitWidth(){return!!(this.options.minCellWidth||this.daySplits.length&&this.options.minSplitWidth)}}},vl=Ue(ml,[["render",cl]]),pl=["lang"],hl={class:"default"},gl={key:0,class:"vuecal__flex vuecal__body",grow:""},yl=["onBlur","innerHTML"],fl=["innerHTML"],bl=["innerHTML"],_l={class:"vuecal__flex",row:"",grow:""},wl={key:0,class:"vuecal__time-column"},xl={class:"vuecal__time-cell-label"},kl={key:1,class:"vuecal__flex vuecal__week-numbers",column:""},Dl=["wrap","column"],Cl=["onBlur","innerHTML"],$l=["innerHTML"],Sl=["innerHTML"],El=["wrap"],Ml=["innerHTML"],Tl=["innerHTML"],jl={key:2,class:"vuecal__cell-events-count"},Vl={key:3,class:"vuecal__no-event"},Al=["onBlur","innerHTML"],Ol=["innerHTML"],Il={key:2,class:"vuecal__event-time"},Ll={key:0},Ul={key:1,class:"days-to-end"},Nl=["innerHTML"],Pl={key:0,class:"vuecal__scrollbar-check"};function Rl(l,t,s,o,i,a){const u=Te("vuecal-header"),r=Te("all-day-bar"),m=Te("weekdays-headings"),c=Te("vuecal-cell");return n(),d("div",{class:Q(["vuecal__flex vuecal",a.cssClasses]),column:"",ref:"vuecal",lang:s.locale},[p(u,{options:l.$props,"edit-events":a.editEvents,"view-props":{views:a.views,weekDaysInHeader:a.weekDaysInHeader},"week-days":a.weekDays,"has-splits":a.hasSplits,"day-splits":a.daySplits,"switch-to-narrower-view":a.switchToNarrowerView},Xe({"arrow-prev":N(()=>[ie(l.$slots,"arrow-prev",{},()=>[t[0]||(t[0]=F(" ")),t[1]||(t[1]=e("i",{class:"angle"},null,-1)),t[2]||(t[2]=F(" "))])]),"arrow-next":N(()=>[ie(l.$slots,"arrow-next",{},()=>[t[3]||(t[3]=F(" ")),t[4]||(t[4]=e("i",{class:"angle"},null,-1)),t[5]||(t[5]=F(" "))])]),"today-button":N(()=>[ie(l.$slots,"today-button",{},()=>[e("span",hl,g(i.texts.today),1)])]),title:N(()=>[ie(l.$slots,"title",{title:a.viewTitle,view:i.view},()=>[F(g(a.viewTitle),1)])]),_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:N(({heading:v,view:f})=>[ie(l.$slots,"weekday-heading",{heading:v,view:f})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:N(({split:v})=>[ie(l.$slots,"split-label",{split:v,view:i.view.id})]),key:"1"}:void 0]),1032,["options","edit-events","view-props","week-days","has-splits","day-splits","switch-to-narrower-view"]),s.hideBody?D("",!0):(n(),d("div",gl,[p(ze,{name:`slide-fade--${i.transitionDirection}`,appear:s.transitions},{default:N(()=>[(n(),d("div",{class:"vuecal__flex",style:{"min-width":"100%"},key:s.transitions?i.view.id:!1,column:""},[s.showAllDayEvents&&a.hasTimeColumn&&(!a.cellOrSplitMinWidth||a.isDayView&&!s.minSplitWidth)?(n(),le(r,ut(ct({key:0},a.allDayBar)),{event:N(({event:v,view:f})=>[ie(l.$slots,"event",{view:f,event:v},()=>[a.editEvents.title&&v.titleEditable?(n(),d("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:b=>a.onEventTitleBlur(b,v),innerHTML:v.title},null,40,yl)):v.title?(n(),d("div",{key:1,class:"vuecal__event-title",innerHTML:v.title},null,8,fl)):D("",!0),v.content&&!a.hasShortEvents&&!a.isShortMonthView?(n(),d("div",{key:2,class:"vuecal__event-content",innerHTML:v.content},null,8,bl)):D("",!0)])]),_:3},16)):D("",!0),e("div",{class:Q(["vuecal__bg",{vuecal__flex:!a.hasTimeColumn}]),column:""},[e("div",_l,[a.hasTimeColumn?(n(),d("div",wl,[s.showAllDayEvents&&a.cellOrSplitMinWidth&&!(a.isDayView&&!s.minSplitWidth)?(n(),d("div",{key:0,class:"vuecal__all-day-text",style:xe({height:a.allDayBar.height})},[e("span",null,g(i.texts.allDay),1)],4)):D("",!0),(n(!0),d(K,null,ee(a.timeCells,(v,f)=>(n(),d("div",{class:"vuecal__time-cell",key:f,style:xe(`height: ${s.timeCellHeight}px`)},[ie(l.$slots,"time-cell",{hours:v.hours,minutes:v.minutes},()=>[t[6]||(t[6]=e("span",{class:"vuecal__time-cell-line"},null,-1)),e("span",xl,g(v.label),1)])],4))),128))])):D("",!0),s.showWeekNumbers&&a.isMonthView?(n(),d("div",kl,[(n(),d(K,null,ee(6,v=>e("div",{class:"vuecal__flex vuecal__week-number-cell",key:v,grow:""},[ie(l.$slots,"week-number-cell",{week:a.getWeekNumber(v-1)},()=>[F(g(a.getWeekNumber(v-1)),1)])])),64))])):D("",!0),e("div",{class:Q(["vuecal__flex vuecal__cells",`${i.view.id}-view`]),grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,column:!!a.cellOrSplitMinWidth},[a.cellOrSplitMinWidth&&a.isWeekView?(n(),le(m,{key:0,"transition-direction":i.transitionDirection,"week-days":a.weekDays,"switch-to-narrower-view":a.switchToNarrowerView,style:xe(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:N(({heading:v,view:f})=>[ie(l.$slots,"weekday-heading",{heading:v,view:f})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:N(({split:v})=>[ie(l.$slots,"split-label",{split:v,view:i.view.id})]),key:"1"}:void 0]),1032,["transition-direction","week-days","switch-to-narrower-view","style"])):a.hasSplits&&s.stickySplitLabels&&s.minSplitWidth?(n(),d("div",{key:1,class:"vuecal__flex vuecal__split-days-headers",style:xe(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(n(!0),d(K,null,ee(a.daySplits,(v,f)=>(n(),d("div",{class:Q(["day-split-header",v.class||!1]),key:f},[ie(l.$slots,"split-label",{split:v,view:i.view.id},()=>[F(g(v.label),1)])],2))),128))],4)):D("",!0),s.showAllDayEvents&&a.hasTimeColumn&&(a.isWeekView&&a.cellOrSplitMinWidth||a.isDayView&&a.hasSplits&&s.minSplitWidth)?(n(),le(r,ut(ct({key:2},a.allDayBar)),{event:N(({event:v,view:f})=>[ie(l.$slots,"event",{view:f,event:v},()=>[a.editEvents.title&&v.titleEditable?(n(),d("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:b=>a.onEventTitleBlur(b,v),innerHTML:v.title},null,40,Cl)):v.title?(n(),d("div",{key:1,class:"vuecal__event-title",innerHTML:v.title},null,8,$l)):D("",!0),v.content&&!a.hasShortEvents&&!a.isShortMonthView?(n(),d("div",{key:2,class:"vuecal__event-content",innerHTML:v.content},null,8,Sl)):D("",!0)])]),_:3},16)):D("",!0),e("div",{class:"vuecal__flex",ref:v=>i.cellsEl=v,grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,style:xe(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(n(!0),d(K,null,ee(a.viewCells,(v,f)=>(n(),le(c,{key:f,options:l.$props,"edit-events":a.editEvents,data:v,"cell-width":s.hideWeekdays.length&&(a.isWeekView||a.isMonthView)&&a.cellWidth,"min-timestamp":a.minTimestamp,"max-timestamp":a.maxTimestamp,"cell-splits":a.hasSplits&&a.daySplits||[]},{"cell-content":N(({events:b,split:k,selectCell:w})=>[ie(l.$slots,"cell-content",{cell:v,view:i.view,goNarrower:w,events:b},()=>[k&&!s.stickySplitLabels?(n(),d("div",{key:0,class:"split-label",innerHTML:k.label},null,8,Ml)):D("",!0),v.content?(n(),d("div",{key:1,class:"vuecal__cell-date",innerHTML:v.content},null,8,Tl)):D("",!0),(a.isMonthView&&!s.eventsOnMonthView||a.isYearsOrYearView&&s.eventsCountOnYearView)&&b.length?(n(),d("div",jl,[ie(l.$slots,"events-count",{view:i.view,events:b},()=>[F(g(b.length),1)])])):D("",!0),!a.cellOrSplitHasEvents(b,k)&&a.isWeekOrDayView?(n(),d("div",Vl,[ie(l.$slots,"no-event",{},()=>[F(g(i.texts.noEvent),1)])])):D("",!0)])]),event:N(({event:b,view:k})=>[ie(l.$slots,"event",{view:k,event:b},()=>[a.editEvents.title&&b.titleEditable?(n(),d("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:w=>a.onEventTitleBlur(w,b),innerHTML:b.title},null,40,Al)):b.title?(n(),d("div",{key:1,class:"vuecal__event-title",innerHTML:b.title},null,8,Ol)):D("",!0),s.time&&!b.allDay&&!(a.isMonthView&&(b.allDay||s.showAllDayEvents==="short"))&&!a.isShortMonthView?(n(),d("div",Il,[F(g(i.utils.date.formatTime(b.start,a.TimeFormat)),1),b.endTimeMinutes?(n(),d("span",Ll," - "+g(i.utils.date.formatTime(b.end,a.TimeFormat,null,!0)),1)):D("",!0),b.daysCount>1&&(b.segments[v.formattedDate]||{}).isFirstDay?(n(),d("small",Ul," +"+g(b.daysCount-1)+g((i.texts.day[0]||"").toLowerCase()),1)):D("",!0)])):D("",!0),b.content&&!(a.isMonthView&&b.allDay&&s.showAllDayEvents==="short")&&!a.isShortMonthView?(n(),d("div",{key:3,class:"vuecal__event-content",innerHTML:b.content},null,8,Nl)):D("",!0)])]),"no-event":N(()=>[ie(l.$slots,"no-event",{},()=>[F(g(i.texts.noEvent),1)])]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],12,El)],10,Dl)])],2)]))]),_:3},8,["name","appear"]),i.ready?D("",!0):(n(),d("div",Pl,t[7]||(t[7]=[e("div",null,null,-1)])))]))],10,pl)}const Fe=1440,Ye={weekDays:Array(7).fill(""),weekDaysShort:[],months:Array(12).fill(""),years:"",year:"",month:"",week:"",day:"",today:"",noEvent:"",allDay:"",deleteEvent:"",createEvent:"",dateFormat:"dddd MMMM D, YYYY",am:"am",pm:"pm"},ht=["years","year","month","week","day"],gt=new Ss(Ye),Fl={name:"vue-cal",components:{"vuecal-cell":wt,"vuecal-header":Xs,WeekdaysHeadings:_t,AllDayBar:vl},provide(){return{vuecal:this,utils:this.utils,modules:this.modules,previous:this.previous,next:this.next,switchView:this.switchView,updateSelectedDate:this.updateSelectedDate,editEvents:this.editEvents,view:this.view,domEvents:this.domEvents}},props:{activeView:{type:String,default:"week"},allDayBarHeight:{type:[String,Number],default:"25px"},cellClickHold:{type:Boolean,default:!0},cellContextmenu:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:!1},dblclickToNavigate:{type:Boolean,default:!0},disableDatePrototypes:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},disableViews:{type:Array,default:()=>[]},dragToCreateEvent:{type:Boolean,default:!0},dragToCreateThreshold:{type:Number,default:15},editableEvents:{type:[Boolean,Object],default:!1},events:{type:Array,default:()=>[]},eventsCountOnYearView:{type:Boolean,default:!1},eventsOnMonthView:{type:[Boolean,String],default:!1},hideBody:{type:Boolean,default:!1},hideTitleBar:{type:Boolean,default:!1},hideViewSelector:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:[String,Object],default:"en"},maxDate:{type:[String,Date],default:""},minCellWidth:{type:Number,default:0},minDate:{type:[String,Date],default:""},minEventWidth:{type:Number,default:0},minSplitWidth:{type:Number,default:0},onEventClick:{type:[Function,null],default:null},onEventCreate:{type:[Function,null],default:null},onEventDblclick:{type:[Function,null],default:null},overlapsPerTimeStep:{type:Boolean,default:!1},resizeX:{type:Boolean,default:!1},selectedDate:{type:[String,Date],default:""},showAllDayEvents:{type:[Boolean,String],default:!1},showTimeInCells:{type:Boolean,default:!1},showWeekNumbers:{type:[Boolean,String],default:!1},snapToTime:{type:Number,default:0},small:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},splitDays:{type:Array,default:()=>[]},startWeekOnSunday:{type:Boolean,default:!1},stickySplitLabels:{type:Boolean,default:!1},time:{type:Boolean,default:!0},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:Fe},todayButton:{type:Boolean,default:!1},transitions:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},watchRealTime:{type:Boolean,default:!1},xsmall:{type:Boolean,default:!1}},data(){return{ready:!1,texts:{...Ye},utils:{date:(this.disableDatePrototypes?gt.removePrototypes():!1)||gt,cell:null,event:null},modules:{dnd:null},cellsEl:null,view:{id:"",title:"",startDate:null,endDate:null,firstCellDate:null,lastCellDate:null,selectedDate:null,events:[]},eventIdIncrement:1,now:new Date,timeTickerIds:[null,null],domEvents:{resizeAnEvent:{_eid:null,start:null,split:null,segment:null,originalEndTimeMinutes:0,originalEnd:null,end:null,startCell:null,endCell:null},dragAnEvent:{_eid:null},dragCreateAnEvent:{startCursorY:null,start:null,split:null,event:null},focusAnEvent:{_eid:null,mousedUp:!1},clickHoldAnEvent:{_eid:null,timeout:1200,timeoutId:null},dblTapACell:{taps:0,timeout:500},clickHoldACell:{cellId:null,split:null,timeout:1200,timeoutId:null,eventCreated:!1},cancelClickEventCreation:!1},mutableEvents:[],transitionDirection:"right"}},methods:{async loadLocale(l){if(typeof this.locale=="object"){this.texts=Object.assign({},Ye,l),this.utils.date.updateTexts(this.texts);return}const t=await $s(Object.assign({"./i18n/ar.json":()=>se(()=>import("./ar.es-bitOgb9K.js"),[]),"./i18n/bg.json":()=>se(()=>import("./bg.es-5tp0KQRo.js"),[]),"./i18n/bn.json":()=>se(()=>import("./bn.es-C_qR0y0-.js"),[]),"./i18n/bs.json":()=>se(()=>import("./bs.es-DduooXS8.js"),[]),"./i18n/ca.json":()=>se(()=>import("./ca.es-DYDNDJFJ.js"),[]),"./i18n/cs.json":()=>se(()=>import("./cs.es-CvnAvfoI.js"),[]),"./i18n/da.json":()=>se(()=>import("./da.es-C_eJXDX3.js"),[]),"./i18n/de.json":()=>se(()=>import("./de.es-Cp-R9E16.js"),[]),"./i18n/el.json":()=>se(()=>import("./el.es-BZ44a1Tb.js"),[]),"./i18n/en.json":()=>se(()=>import("./en.es-DwVNOttH.js"),[]),"./i18n/es.json":()=>se(()=>import("./es.es-DO8PaQ_q.js"),[]),"./i18n/et.json":()=>se(()=>import("./et.es-DdRIcUrz.js"),[]),"./i18n/fa.json":()=>se(()=>import("./fa.es-XN0av8Tx.js"),[]),"./i18n/fi.json":()=>se(()=>import("./fi.es-B0Iy6aas.js"),[]),"./i18n/fr.json":()=>se(()=>import("./fr.es-B7WXlprl.js"),[]),"./i18n/he.json":()=>se(()=>import("./he.es-BWEk5prp.js"),[]),"./i18n/hr.json":()=>se(()=>import("./hr.es-B_iqHQyr.js"),[]),"./i18n/hu.json":()=>se(()=>import("./hu.es-D_t4Ibxf.js"),[]),"./i18n/id.json":()=>se(()=>import("./id.es-CzHAK-XV.js"),[]),"./i18n/is.json":()=>se(()=>import("./is.es-DChRpym4.js"),[]),"./i18n/it.json":()=>se(()=>import("./it.es-CquQA5xx.js"),[]),"./i18n/ja.json":()=>se(()=>import("./ja.es-B19gsG6H.js"),[]),"./i18n/ka.json":()=>se(()=>import("./ka.es-CuOe65jc.js"),[]),"./i18n/ko.json":()=>se(()=>import("./ko.es-CsMl2USK.js"),[]),"./i18n/lt.json":()=>se(()=>import("./lt.es-vqgjGyMx.js"),[]),"./i18n/mn.json":()=>se(()=>import("./mn.es-BmdwFdas.js"),[]),"./i18n/nl.json":()=>se(()=>import("./nl.es-CFxVMCWy.js"),[]),"./i18n/no.json":()=>se(()=>import("./no.es-qRcuRMwl.js"),[]),"./i18n/pl.json":()=>se(()=>import("./pl.es-BQ3a0ltx.js"),[]),"./i18n/pt-br.json":()=>se(()=>import("./pt-br.es-U9bVHsgs.js"),[]),"./i18n/pt-pt.json":()=>se(()=>import("./pt-pt.es-U9bVHsgs.js"),[]),"./i18n/ro.json":()=>se(()=>import("./ro.es-ldjMjt3l.js"),[]),"./i18n/ru.json":()=>se(()=>import("./ru.es-CS-QKsYL.js"),[]),"./i18n/sk.json":()=>se(()=>import("./sk.es-CAe8sEvL.js"),[]),"./i18n/sl.json":()=>se(()=>import("./sl.es-rdzOxu_X.js"),[]),"./i18n/sq.json":()=>se(()=>import("./sq.es-BY5E06HI.js"),[]),"./i18n/sr.json":()=>se(()=>import("./sr.es-QPseRVBy.js"),[]),"./i18n/sv.json":()=>se(()=>import("./sv.es-BfPUYcV1.js"),[]),"./i18n/tr.json":()=>se(()=>import("./tr.es-Cl6kz_IH.js"),[]),"./i18n/uk.json":()=>se(()=>import("./uk.es-DBEtNQnZ.js"),[]),"./i18n/vi.json":()=>se(()=>import("./vi.es-Bx2g_1jx.js"),[]),"./i18n/zh-cn.json":()=>se(()=>import("./zh-cn.es-BWMmCH-R.js"),[]),"./i18n/zh-hk.json":()=>se(()=>import("./zh-hk.es-DFZ0bKvi.js"),[])}),`./i18n/${l}.json`,3);this.texts=Object.assign({},Ye,t),this.utils.date.updateTexts(this.texts)},loadDragAndDrop(){se(()=>import("./drag-and-drop.es-CbCm7IHa.js"),[]).then(l=>{const{DragAndDrop:t}=l;this.modules.dnd=new t(this)}).catch(()=>console.warn("Vue Cal: Missing drag & drop module."))},validateView(l){return ht.includes(l)||(console.error(`Vue Cal: invalid active-view parameter provided: "${l}".
A valid view must be one of: ${ht.join(", ")}.`),l="week"),this.enabledViews.includes(l)||(console.warn(`Vue Cal: the provided active-view "${l}" is disabled. Using the "${this.enabledViews[0]}" view instead.`),l=this.enabledViews[0]),l},switchToNarrowerView(l=null){this.transitionDirection="right";const t=this.enabledViews[this.enabledViews.indexOf(this.view.id)+1];t&&this.switchView(t,l)},switchView(l,t=null,s=!1){l=this.validateView(l);const o=this.utils.date,i=this.view.startDate&&this.view.startDate.getTime();if(this.transitions&&s){if(this.view.id===l)return;const r=this.enabledViews;this.transitionDirection=r.indexOf(this.view.id)>r.indexOf(l)?"left":"right"}const a=this.view.id;switch(this.view.events=[],this.view.id=l,this.view.firstCellDate=null,this.view.lastCellDate=null,t||(t=this.view.selectedDate||this.view.startDate),l){case"years":{this.view.startDate=new Date(Math.floor(t.getFullYear()/25)*25||2e3,0,1),this.view.endDate=new Date(this.view.startDate.getFullYear()+25,0,1),this.view.endDate.setSeconds(-1);break}case"year":{this.view.startDate=new Date(t.getFullYear(),0,1),this.view.endDate=new Date(t.getFullYear()+1,0,1),this.view.endDate.setSeconds(-1);break}case"month":{this.view.startDate=new Date(t.getFullYear(),t.getMonth(),1),this.view.endDate=new Date(t.getFullYear(),t.getMonth()+1,1),this.view.endDate.setSeconds(-1);let r=new Date(this.view.startDate);if(r.getDay()!==(this.startWeekOnSunday?0:1)&&(r=o.getPreviousFirstDayOfWeek(r,this.startWeekOnSunday)),this.view.firstCellDate=r,this.view.lastCellDate=o.addDays(r,41),this.view.lastCellDate.setHours(23,59,59,0),this.hideWeekends){if([0,6].includes(this.view.firstCellDate.getDay())){const m=this.view.firstCellDate.getDay()===6&&!this.startWeekOnSunday?2:1;this.view.firstCellDate=o.addDays(this.view.firstCellDate,m)}if([0,6].includes(this.view.startDate.getDay())){const m=this.view.startDate.getDay()===6?2:1;this.view.startDate=o.addDays(this.view.startDate,m)}if([0,6].includes(this.view.lastCellDate.getDay())){const m=this.view.lastCellDate.getDay()===0&&!this.startWeekOnSunday?2:1;this.view.lastCellDate=o.subtractDays(this.view.lastCellDate,m)}if([0,6].includes(this.view.endDate.getDay())){const m=this.view.endDate.getDay()===0?2:1;this.view.endDate=o.subtractDays(this.view.endDate,m)}}break}case"week":{t=o.getPreviousFirstDayOfWeek(t,this.startWeekOnSunday);const r=this.hideWeekends?5:7;this.view.startDate=this.hideWeekends&&this.startWeekOnSunday?o.addDays(t,1):t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=o.addDays(t,r),this.view.endDate.setSeconds(-1);break}case"day":{this.view.startDate=t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=new Date(t),this.view.endDate.setHours(23,59,59,0);break}}this.addEventsToView();const u=this.view.startDate&&this.view.startDate.getTime();if(!(a===l&&u===i)&&(this.$emit("update:activeView",l),this.ready)){const r=this.view.startDate,m={view:l,startDate:r,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate,outOfScopeEvents:this.view.outOfScopeEvents.map(this.cleanupEvent)}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:o.getWeek(this.startWeekOnSunday?o.addDays(r,1):r)}:{}};this.$emit("view-change",m)}},previous(){this.previousNext(!1)},next(){this.previousNext()},previousNext(l=!0){const t=this.utils.date;this.transitionDirection=l?"right":"left";const s=l?1:-1;let o=null;const{startDate:i,id:a}=this.view;switch(a){case"years":o=new Date(i.getFullYear()+25*s,0,1);break;case"year":o=new Date(i.getFullYear()+1*s,1,1);break;case"month":o=new Date(i.getFullYear(),i.getMonth()+1*s,1);break;case"week":o=t[l?"addDays":"subtractDays"](t.getPreviousFirstDayOfWeek(i,this.startWeekOnSunday),7);break;case"day":o=t[l?"addDays":"subtractDays"](i,1);const u=o.getDay(),r=this.startWeekOnSunday?u:(u||7)-1;if(this.weekDays[r].hide){const c=this.weekDays.map((f,b)=>({...f,i:b}));let v=0;l?([...c.slice(r),...c].find(f=>(v++,!f.hide)).i,v--):[...c,...c.slice(0,r)].reverse().find(f=>(v++,!f.hide)).i,o=t[l?"addDays":"subtractDays"](o,v)}break}o&&this.switchView(a,o)},addEventsToView(l=[]){const t=this.utils.event,{startDate:s,endDate:o,firstCellDate:i,lastCellDate:a}=this.view;if(l.length||(this.view.events=[]),l=l.length?l:[...this.mutableEvents],!l||this.isYearsOrYearView&&!this.eventsCountOnYearView)return;let u=l.filter(r=>t.eventInRange(r,s,o));!this.isYearsOrYearView&&!(this.isMonthView&&!this.eventsOnMonthView)&&(u=u.map(r=>r.daysCount>1?t.createEventSegments(r,i||s,a||o):r)),this.view.events.push(...u),this.isMonthView&&(this.view.outOfScopeEvents=[],l.forEach(r=>{(t.eventInRange(r,i,s)||t.eventInRange(r,o,a))&&(this.view.events.some(m=>m._eid===r._eid)||this.view.outOfScopeEvents.push(r))}))},findAncestor(l,t){for(;(l=l.parentElement)&&!l.classList.contains(t););return l},isDOMElementAnEvent(l){return l.classList.contains("vuecal__event")||this.findAncestor(l,"vuecal__event")},onMouseMove(l){const{resizeAnEvent:t,dragAnEvent:s,dragCreateAnEvent:o}=this.domEvents;t._eid===null&&s._eid===null&&!o.start||(l.preventDefault(),t._eid?this.eventResizing(l):this.dragToCreateEvent&&o.start&&this.eventDragCreation(l))},onMouseUp(l){const{focusAnEvent:t,resizeAnEvent:s,clickHoldAnEvent:o,clickHoldACell:i,dragCreateAnEvent:a}=this.domEvents,{_eid:u}=o,{_eid:r}=s;let m=!1;const{event:c,start:v}=a,f=this.isDOMElementAnEvent(l.target),b=t.mousedUp;if(t.mousedUp=!1,f&&(this.domEvents.cancelClickEventCreation=!0),i.eventCreated)return;if(r){const{originalEnd:w,originalEndTimeMinutes:S,endTimeMinutes:y}=s,h=this.view.events.find(M=>M._eid===s._eid);if(m=y&&y!==S,h&&h.end.getTime()!==w.getTime()){const M=this.mutableEvents.find(P=>P._eid===s._eid);M.endTimeMinutes=h.endTimeMinutes,M.end=h.end;const j=this.cleanupEvent(h),O={...this.cleanupEvent(h),end:w,endTimeMinutes:h.originalEndTimeMinutes};this.$emit("event-duration-change",{event:j,oldDate:s.originalEnd,originalEvent:O}),this.$emit("event-change",{event:j,originalEvent:O})}h&&(h.resizing=!1),s._eid=null,s.start=null,s.split=null,s.segment=null,s.originalEndTimeMinutes=null,s.originalEnd=null,s.endTimeMinutes=null,s.startCell=null,s.endCell=null}else v&&(c&&(this.emitWithEvent("event-drag-create",c),a.event.resizing=!1),a.start=null,a.split=null,a.event=null);!f&&!r&&this.unfocusEvent(),o.timeoutId&&!u&&(clearTimeout(o.timeoutId),o.timeoutId=null),i.timeoutId&&(clearTimeout(i.timeoutId),i.timeoutId=null);const k=typeof this.onEventClick=="function";if(b&&!m&&!u&&!c&&k){let w=this.view.events.find(S=>S._eid===t._eid);return!w&&this.isMonthView&&(w=this.view.outOfScopeEvents.find(S=>S._eid===t._eid)),w&&this.onEventClick(w,l)}},onKeyUp(l){l.keyCode===27&&this.cancelDelete()},eventResizing(l){const{resizeAnEvent:t}=this.domEvents,s=this.view.events.find(c=>c._eid===t._eid)||{segments:{}},{minutes:o,cursorCoords:i}=this.minutesAtCursor(l),a=s.segments&&s.segments[t.segment],{date:u,event:r}=this.utils,m=Math.max(o,this.timeFrom+1,(a||s).startTimeMinutes+1);if(s.endTimeMinutes=t.endTimeMinutes=m,this.snapToTime){const c=s.endTimeMinutes+this.snapToTime/2;s.endTimeMinutes=c-c%this.snapToTime}if(a&&(a.endTimeMinutes=s.endTimeMinutes),s.end.setHours(0,s.endTimeMinutes,s.endTimeMinutes===Fe?-1:0,0),this.resizeX&&this.isWeekView){s.daysCount=u.countDays(s.start,s.end);const c=this.cellsEl,v=c.offsetWidth/c.childElementCount,f=Math.floor(i.x/v);if(t.startCell===null&&(t.startCell=f-(s.daysCount-1)),t.endCell!==f){t.endCell=f;const b=u.addDays(s.start,f-t.startCell),k=Math.max(u.countDays(s.start,b),1);if(k!==s.daysCount){let w=null;k>s.daysCount?w=r.addEventSegment(s):w=r.removeEventSegment(s),t.segment=w,s.endTimeMinutes+=.001}}}this.$emit("event-resizing",{_eid:s._eid,end:s.end,endTimeMinutes:s.endTimeMinutes})},eventDragCreation(l){const{dragCreateAnEvent:t}=this.domEvents,{start:s,startCursorY:o,split:i}=t,a=new Date(s),{minutes:u,cursorCoords:{y:r}}=this.minutesAtCursor(l);if(!(!t.event&&Math.abs(o-r)<this.dragToCreateThreshold))if(t.event){if(a.setHours(0,u,u===Fe?-1:0,0),this.snapToTime){let v=a.getHours()*60+a.getMinutes();const f=v+this.snapToTime/2;v=f-f%this.snapToTime,a.setHours(0,v,0,0)}const m=s<a,{event:c}=t;c.start=m?s:a,c.end=m?a:s,c.startTimeMinutes=c.start.getHours()*60+c.start.getMinutes(),c.endTimeMinutes=c.end.getHours()*60+c.end.getMinutes()}else{if(t.event=this.utils.event.createAnEvent(s,1,{split:i}),!t.event){t.start=null,t.split=null,t.event=null;return}t.event.resizing=!0}},unfocusEvent(){const{focusAnEvent:l,clickHoldAnEvent:t}=this.domEvents,s=this.view.events.find(o=>o._eid===(l._eid||t._eid));l._eid=null,t._eid=null,s&&(s.focused=!1,s.deleting=!1)},cancelDelete(){const{clickHoldAnEvent:l}=this.domEvents;if(l._eid){const t=this.view.events.find(s=>s._eid===l._eid);t&&(t.deleting=!1),l._eid=null,l.timeoutId=null}},onEventTitleBlur(l,t){if(t.title===l.target.innerHTML)return;const s=t.title;t.title=l.target.innerHTML;const o=this.cleanupEvent(t);this.$emit("event-title-change",{event:o,oldTitle:s}),this.$emit("event-change",{event:o,originalEvent:{...o,title:s}})},updateMutableEvents(){const l=this.utils.date;this.mutableEvents=[],this.events.forEach(t=>{const s=typeof t.start=="string"?l.stringToDate(t.start):t.start,o=l.formatDateLite(s),i=l.dateToMinutes(s);let a=null;typeof t.end=="string"&&t.end.includes("24:00")?(a=new Date(t.end.replace(" 24:00","")),a.setHours(23,59,59,0)):a=typeof t.end=="string"?l.stringToDate(t.end):t.end;let u=l.formatDateLite(a),r=l.dateToMinutes(a);(!r||r===Fe)&&(!this.time||typeof t.end=="string"&&t.end.length===10?a.setHours(23,59,59,0):a.setSeconds(a.getSeconds()-1),u=l.formatDateLite(a),r=Fe);const m=o!==u;t=Object.assign({...this.utils.event.eventDefaults},t,{_eid:`${this._.uid}_${this.eventIdIncrement++}`,segments:m?{}:null,start:s,startTimeMinutes:i,end:a,endTimeMinutes:r,daysCount:m?l.countDays(s,a):1,class:t.class}),this.mutableEvents.push(t)})},minutesAtCursor(l){return this.utils.cell.minutesAtCursor(l)},createEvent(l,t,s={}){return this.utils.event.createAnEvent(l,t,s)},cleanupEvent(l){return l={...l},["segments","deletable","deleting","titleEditable","resizable","resizing","draggable","dragging","draggingStatic","focused"].forEach(s=>{s in l&&delete l[s]}),l.repeat||delete l.repeat,l},emitWithEvent(l,t){this.$emit(l,this.cleanupEvent(t))},updateSelectedDate(l){if(l&&typeof l=="string"?l=this.utils.date.stringToDate(l):l=new Date(l),l&&l instanceof Date){const{selectedDate:t}=this.view;t&&(this.transitionDirection=t.getTime()>l.getTime()?"left":"right"),l.setHours(0,0,0,0),(!t||t.getTime()!==l.getTime())&&(this.view.selectedDate=l),this.switchView(this.view.id)}this.$emit("update:selected-date",this.view.selectedDate)},getWeekNumber(l){const t=this.utils.date,o=this.firstCellDateWeekNumber+l,i=this.startWeekOnSunday?1:0;return o>52?t.getWeek(t.addDays(this.view.firstCellDate,7*l+i)):o},timeTick(){this.now=new Date,this.timeTickerIds[1]=setTimeout(this.timeTick,60*1e3)},updateDateTexts(){this.utils.date.updateTexts(this.texts)},alignWithScrollbar(){if(document.getElementById("vuecal-align-with-scrollbar"))return;const l=this.$refs.vuecal.getElementsByClassName("vuecal__scrollbar-check")[0],t=l.offsetWidth-l.children[0].offsetWidth;if(t){const s=document.createElement("style");s.id="vuecal-align-with-scrollbar",s.type="text/css",s.innerHTML=`.vuecal--view-with-time .vuecal__weekdays-headings,.vuecal--view-with-time .vuecal__all-day {padding-right: ${t}px}`,document.head.appendChild(s)}},cellOrSplitHasEvents(l,t=null){return l.length&&(!t&&l.length||t&&l.some(s=>s.split===t.id))}},created(){this.utils.cell=new Ms(this),this.utils.event=new js(this,this.utils.date),this.loadLocale(this.locale),this.editEvents.drag&&this.loadDragAndDrop(),this.updateMutableEvents(this.events),this.view.id=this.currentView,this.selectedDate?this.updateSelectedDate(this.selectedDate):(this.view.selectedDate=new Date,this.switchView(this.currentView)),this.time&&this.watchRealTime&&(this.timeTickerIds[0]=setTimeout(this.timeTick,(60-this.now.getSeconds())*1e3))},mounted(){const l=this.utils.date,t="ontouchstart"in window,{resize:s,drag:o,create:i,delete:a,title:u}=this.editEvents,r=this.onEventClick&&typeof this.onEventClick=="function";(s||o||i||a||u||r)&&window.addEventListener(t?"touchend":"mouseup",this.onMouseUp),(s||o||i&&this.dragToCreateEvent)&&window.addEventListener(t?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),u&&window.addEventListener("keyup",this.onKeyUp),t&&(this.$refs.vuecal.oncontextmenu=function(v){v.preventDefault(),v.stopPropagation()}),this.hideBody||this.alignWithScrollbar();const m=this.view.startDate,c={view:this.view.id,startDate:m,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:l.getWeek(this.startWeekOnSunday?l.addDays(m,1):m)}:{}};this.$emit("ready",c),this.ready=!0},beforeUnmount(){const l="ontouchstart"in window;window.removeEventListener(l?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),window.removeEventListener(l?"touchend":"mouseup",this.onMouseUp),window.removeEventListener("keyup",this.onKeyUp),this.timeTickerIds[0]&&clearTimeout(this.timeTickerIds[0]),this.timeTickerIds[1]&&clearTimeout(this.timeTickerIds[1]),this.timeTickerIds=[null,null]},computed:{editEvents(){return this.editableEvents&&typeof this.editableEvents=="object"?{title:!!this.editableEvents.title,drag:!!this.editableEvents.drag,resize:!!this.editableEvents.resize,create:!!this.editableEvents.create,delete:!!this.editableEvents.delete}:{title:!!this.editableEvents,drag:!!this.editableEvents,resize:!!this.editableEvents,create:!!this.editableEvents,delete:!!this.editableEvents}},views(){return{years:{label:this.texts.years,enabled:!this.disableViews.includes("years")},year:{label:this.texts.year,enabled:!this.disableViews.includes("year")},month:{label:this.texts.month,enabled:!this.disableViews.includes("month")},week:{label:this.texts.week,enabled:!this.disableViews.includes("week")},day:{label:this.texts.day,enabled:!this.disableViews.includes("day")}}},currentView(){return this.validateView(this.activeView)},enabledViews(){return Object.keys(this.views).filter(l=>this.views[l].enabled)},hasTimeColumn(){return this.time&&this.isWeekOrDayView},isShortMonthView(){return this.isMonthView&&this.eventsOnMonthView==="short"},firstCellDateWeekNumber(){const l=this.utils.date,t=this.view.firstCellDate;return l.getWeek(this.startWeekOnSunday?l.addDays(t,1):t)},timeCells(){const l=[];for(let t=this.timeFrom,s=this.timeTo;t<s;t+=this.timeStep)l.push({hours:Math.floor(t/60),minutes:t%60,label:this.utils.date.formatTime(t,this.TimeFormat),value:t});return l},TimeFormat(){return this.timeFormat||(this.twelveHour?"h:mm{am}":"HH:mm")},daySplits(){return(this.splitDays.filter(l=>!l.hide)||[]).map((l,t)=>({...l,id:l.id||t+1}))},hasSplits(){return this.daySplits.length&&this.isWeekOrDayView},hasShortEvents(){return this.showAllDayEvents==="short"},cellOrSplitMinWidth(){let l=null;return this.hasSplits&&this.minSplitWidth?l=this.visibleDaysCount*this.minSplitWidth*this.daySplits.length:this.minCellWidth&&this.isWeekView&&(l=this.visibleDaysCount*this.minCellWidth),l},allDayBar(){let l=this.allDayBarHeight||null;return l&&!isNaN(l)&&(l+="px"),{cells:this.viewCells,options:this.$props,label:this.texts.allDay,shortEvents:this.hasShortEvents,daySplits:this.hasSplits&&this.daySplits||[],cellOrSplitMinWidth:this.cellOrSplitMinWidth,height:l}},minTimestamp(){let l=null;return this.minDate&&typeof this.minDate=="string"?l=this.utils.date.stringToDate(this.minDate):this.minDate&&this.minDate instanceof Date&&(l=this.minDate),l?l.getTime():null},maxTimestamp(){let l=null;return this.maxDate&&typeof this.maxDate=="string"?l=this.utils.date.stringToDate(this.maxDate):this.maxDate&&this.maxDate instanceof Date&&(l=this.maxDate),l?l.getTime():null},weekDays(){let{weekDays:l,weekDaysShort:t=[]}=this.texts;return l=l.slice(0).map((s,o)=>({label:s,...t.length?{short:t[o]}:{},hide:this.hideWeekends&&o>=5||this.hideWeekdays.length&&this.hideWeekdays.includes(o+1)})),this.startWeekOnSunday&&l.unshift(l.pop()),l},weekDaysInHeader(){return this.isMonthView||this.isWeekView&&!this.minCellWidth&&!(this.hasSplits&&this.minSplitWidth)},months(){return this.texts.months.map(l=>({label:l}))},specialDayHours(){return!this.specialHours||!Object.keys(this.specialHours).length?{}:Array(7).fill("").map((l,t)=>{let s=this.specialHours[t+1]||[];return Array.isArray(s)||(s=[s]),l=[],s.forEach(({from:o,to:i,class:a,label:u},r)=>{l[r]={day:t+1,from:[null,void 0].includes(o)?null:o*1,to:[null,void 0].includes(i)?null:i*1,class:a||"",label:u||""}}),l})},viewTitle(){const l=this.utils.date;let t="";const s=this.view.startDate,o=s.getFullYear(),i=s.getMonth();switch(this.view.id){case"years":{t=this.texts.years;break}case"year":{t=o;break}case"month":{t=`${this.months[i].label} ${o}`;break}case"week":{const a=this.view.endDate,u=s.getFullYear();let r=this.texts.months[s.getMonth()];this.xsmall&&(r=r.substring(0,3));let m=`${r} ${u}`;if(a.getMonth()!==s.getMonth()){const c=a.getFullYear();let v=this.texts.months[a.getMonth()];this.xsmall&&(v=v.substring(0,3)),u===c?m=`${r} - ${v} ${u}`:this.small?m=`${r.substring(0,3)} ${u} - ${v.substring(0,3)} ${c}`:m=`${r} ${u} - ${v} ${c}`}t=`${this.texts.week} ${l.getWeek(this.startWeekOnSunday?l.addDays(s,1):s)} (${m})`;break}case"day":{t=this.utils.date.formatDate(s,this.texts.dateFormat,this.texts);break}}return t},viewCells(){const l=this.utils.date;let t=[],s=null,o=!1;this.watchRealTime||(this.now=new Date);const i=this.now;switch(this.view.id){case"years":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(25)).map((a,u)=>{const r=new Date(s+u,0,1),m=new Date(s+u+1,0,1);return m.setSeconds(-1),{startDate:r,formattedDate:l.formatDateLite(r),endDate:m,content:s+u,current:s+u===i.getFullYear()}});break}case"year":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(12)).map((a,u)=>{const r=new Date(s,u,1),m=new Date(s,u+1,1);return m.setSeconds(-1),{startDate:r,formattedDate:l.formatDateLite(r),endDate:m,content:this.xsmall?this.months[u].label.substr(0,3):this.months[u].label,current:u===i.getMonth()&&s===i.getFullYear()}});break}case"month":{const a=this.view.startDate.getMonth(),u=new Date(this.view.firstCellDate);o=!1,t=Array.apply(null,Array(42)).map((r,m)=>{const c=l.addDays(u,m),v=new Date(c);v.setHours(23,59,59,0);const f=!o&&l.isToday(c)&&!o++;return{startDate:c,formattedDate:l.formatDateLite(c),endDate:v,content:c.getDate(),today:f,outOfScope:c.getMonth()!==a,class:`vuecal__cell--day${c.getDay()||7}`}}),(this.hideWeekends||this.hideWeekdays.length)&&(t=t.filter(r=>{const m=r.startDate.getDay()||7;return!(this.hideWeekends&&m>=6||this.hideWeekdays.length&&this.hideWeekdays.includes(m))}));break}case"week":{o=!1;const a=this.view.startDate,u=this.weekDays;t=u.map((r,m)=>{const c=l.addDays(a,this.startWeekOnSunday&&this.hideWeekends?m-1:m),v=new Date(c);v.setHours(23,59,59,0);const f=(c.getDay()||7)-1;return{startDate:c,formattedDate:l.formatDateLite(c),endDate:v,today:!o&&l.isToday(c)&&!o++,specialHours:this.specialDayHours[f]||[]}}).filter((r,m)=>!u[m].hide);break}case"day":{const a=this.view.startDate,u=new Date(this.view.startDate);u.setHours(23,59,59,0);const r=(a.getDay()||7)-1;t=[{startDate:a,formattedDate:l.formatDateLite(a),endDate:u,today:l.isToday(a),specialHours:this.specialDayHours[r]||[]}];break}}return t},visibleDaysCount(){return this.isDayView?1:7-this.weekDays.reduce((l,t)=>l+t.hide,0)},cellWidth(){return 100/this.visibleDaysCount},cssClasses(){const{resizeAnEvent:l,dragAnEvent:t,dragCreateAnEvent:s}=this.domEvents;return{[`vuecal--${this.view.id}-view`]:!0,[`vuecal--${this.locale}`]:this.locale,"vuecal--no-time":!this.time,"vuecal--view-with-time":this.hasTimeColumn,"vuecal--week-numbers":this.showWeekNumbers&&this.isMonthView,"vuecal--twelve-hour":this.twelveHour,"vuecal--click-to-navigate":this.clickToNavigate,"vuecal--hide-weekends":this.hideWeekends,"vuecal--split-days":this.hasSplits,"vuecal--sticky-split-labels":this.hasSplits&&this.stickySplitLabels,"vuecal--overflow-x":this.minCellWidth&&this.isWeekView||this.hasSplits&&this.minSplitWidth,"vuecal--small":this.small,"vuecal--xsmall":this.xsmall,"vuecal--resizing-event":l._eid,"vuecal--drag-creating-event":s.event,"vuecal--dragging-event":t._eid,"vuecal--events-on-month-view":this.eventsOnMonthView,"vuecal--short-events":this.isMonthView&&this.eventsOnMonthView==="short","vuecal--has-touch":typeof window<"u"&&"ontouchstart"in window}},isYearsOrYearView(){return["years","year"].includes(this.view.id)},isYearsView(){return this.view.id==="years"},isYearView(){return this.view.id==="year"},isMonthView(){return this.view.id==="month"},isWeekOrDayView(){return["week","day"].includes(this.view.id)},isWeekView(){return this.view.id==="week"},isDayView(){return this.view.id==="day"}},watch:{events:{handler(l,t){this.updateMutableEvents(l),this.addEventsToView()},deep:!0},locale(l){this.loadLocale(l)},selectedDate(l){this.updateSelectedDate(l)},activeView(l){this.switchView(l)}}},Bl=Ue(Fl,[["render",Rl]]),Hl={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Wl={class:"flex justify-between items-center mb-4"},Yl={class:"flex gap-3"},zl={class:"flex rounded-md shadow-sm mr-3"},ql={key:0,class:"mb-4 bg-gray-50 p-4 rounded-lg"},Gl={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Kl=["value"],Jl={class:"mt-1 relative rounded-md shadow-sm"},Zl={key:1,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Xl={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md"},Ql={key:3},ea={key:0,class:"space-y-4"},ta={key:0,class:"flex justify-between"},sa={class:"flex-grow"},la={class:"text-sm text-red-500 italic"},aa={class:"flex items-center mt-1"},ia={class:"text-xs text-gray-500"},na={key:1},oa={class:"flex-grow"},ra={class:"flex justify-between items-center mb-3"},da={class:"text-sm text-gray-600 bg-blue-100 px-2 py-1 rounded-full"},ua={class:"mb-3"},ca={class:"text-sm text-gray-700 ml-6"},ma={class:"mb-3"},va={class:"text-sm text-gray-700 ml-6"},pa={class:"mb-2"},ha={class:"text-sm text-gray-700 ml-6"},ga={class:"flex items-center mt-3 pt-2 border-t border-blue-200"},ya={class:"text-xs text-gray-500"},fa={key:1,class:"text-gray-400 text-sm"},ba={key:4,class:"mt-4"},_a={class:"flex justify-between items-center mb-6"},wa={class:"text-lg font-medium text-gray-900"},xa=["innerHTML"],ka=["innerHTML"],Da={key:0,class:"mt-1 text-xs p-1 rounded bg-red-50 border-l-2 border-red-500 text-red-700"},Ca={class:"mt-6 bg-white rounded-lg shadow p-4"},$a={key:0},Sa={class:"font-medium text-gray-800 mb-2"},Ea={class:"font-medium text-blue-800"},Ma={class:"text-sm text-gray-600 mt-1"},Ta={key:1,class:"text-gray-500 text-sm"},ja={__name:"DailyStandups",props:{projectId:{type:Number,required:!0},users:{type:Array,default:()=>[]}},emits:["standupAdded"],setup(l,{emit:t}){const s=l,o=x("list"),i=x(!1),a=x(!1),u=x(""),r=x([]),m=x(""),c=ke({startDate:"",endDate:"",search:"",userId:""}),v=I=>{const E=de(I);return E.isValid()?{start:E.clone().startOf("month").format("YYYY-MM-DD"),end:E.clone().endOf("month").format("YYYY-MM-DD")}:(console.warn("getMonthRange received an invalid input, defaulting to current date:",I),{start:de().startOf("month").format("YYYY-MM-DD"),end:de().endOf("month").format("YYYY-MM-DD")})};let f=null;const b=()=>{clearTimeout(f),f=setTimeout(()=>{w()},500)},k=async()=>{a.value=!0,u.value="";try{const I=new URLSearchParams;c.startDate&&I.append("start_date",c.startDate),c.endDate&&I.append("end_date",c.endDate),c.search&&I.append("search",c.search),c.userId&&I.append("user_id",String(c.userId));const E=I.toString(),T=`/api/projects/${s.projectId}/sections/notes?type=standup${E?`&${E}`:""}`,U=await window.axios.get(T);r.value=U.data.filter(Z=>Z.type==="standup")}catch(I){console.error("Error fetching project standups:",I),u.value="Failed to load standups. Please try again."}finally{a.value=!1}},w=()=>{k()},S=()=>{c.search="",c.userId="",c.startDate="",c.endDate="",k()},y=()=>{m.value=de(m.value).subtract(1,"month").format("YYYY-MM-DD")},h=()=>{m.value=de(m.value).add(1,"month").format("YYYY-MM-DD")};re(()=>m.value,I=>{if(o.value==="calendar"&&I){const E=v(I);c.startDate=E.start,c.endDate=E.end,k()}}),re(()=>o.value,I=>{I==="calendar"?(c.search="",c.userId="",m.value=v(new Date).start):(c.startDate="",c.endDate="",k())});const M=R(()=>(r.value||[]).map(I=>{var U;if(!(I!=null&&I.created_at))return null;const E=de(I.created_at);if(!E.isValid())return null;const T=L(I.content);return{start:E.format("YYYY-MM-DD HH:mm"),end:E.format("YYYY-MM-DD HH:mm"),title:`${((U=I.user)==null?void 0:U.name)||"Unknown"} - Standup`,content:`Yesterday: ${T.yesterday}
Today: ${T.today}
Blockers: ${T.blockers}`,class:"standup-event",standupData:I}}).filter(Boolean));be(()=>{k()});const j=R(()=>{if(!r.value)return[];let I=[...r.value];if(c.startDate&&(I=I.filter(E=>E.created_at&&de(E.created_at).isSameOrAfter(c.startDate,"day"))),c.endDate&&(I=I.filter(E=>E.created_at&&de(E.created_at).isSameOrBefore(c.endDate,"day"))),c.userId&&(I=I.filter(E=>E.user_id===parseInt(c.userId))),c.search){const E=c.search.toLowerCase();I=I.filter(T=>T.content&&T.content!=="[Encrypted content could not be decrypted]"&&T.content.toLowerCase().includes(E))}return I.sort((E,T)=>de(T.created_at).valueOf()-de(E.created_at).valueOf())}),O=I=>{const E=de(I).day();return E>=1&&E<=5},P=I=>de(I).isBefore(de(),"day"),J=(I,E)=>de(I).isSame(E,"day"),L=I=>{var A,_,C,$;if(!I||typeof I!="string"||I==="[Encrypted content could not be decrypted]"||I.trim()==="")return{yesterday:"N/A",today:"N/A",blockers:"N/A",date:"N/A"};const E=((A=I.match(/\*\*Yesterday:\*\* ([^\n]+)/))==null?void 0:A[1].trim())||"Nothing",T=((_=I.match(/\*\*Today:\*\* ([^\n]+)/))==null?void 0:_[1].trim())||"Nothing",U=((C=I.match(/\*\*Blockers:\*\* ([^\n]+)/))==null?void 0:C[1].trim())||"None",Z=(($=I.match(/\*\*Daily Standup - ([^*]+)\*\*/))==null?void 0:$[1].trim())||de().format("L");return{yesterday:E,today:T,blockers:U,date:Z}},V=R(()=>{const I={};return(r.value||[]).forEach(E=>{if(!(E!=null&&E.created_at))return;const T=de(E.created_at).format("YYYY-MM-DD");I[T]||(I[T]=[]),I[T].push(E)}),I});return(I,E)=>(n(),d("div",Hl,[e("div",Wl,[E[11]||(E[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Daily Standups",-1)),e("div",Yl,[e("div",zl,[e("button",{type:"button",onClick:E[0]||(E[0]=T=>o.value="list"),class:Q([o.value==="list"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-l-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},E[8]||(E[8]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})]),F(" List ")],-1)]),2),e("button",{type:"button",onClick:E[1]||(E[1]=T=>o.value="calendar"),class:Q([o.value==="calendar"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-r-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},E[9]||(E[9]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),F(" Calendar ")],-1)]),2)]),p(ue,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:E[2]||(E[2]=T=>i.value=!0)},{default:N(()=>E[10]||(E[10]=[F(" Submit Standup ",-1)])),_:1,__:[10]})])]),o.value==="list"?(n(),d("div",ql,[e("div",Gl,[e("div",null,[E[12]||(E[12]=e("label",{for:"standupStartDate",class:"block text-sm font-medium text-gray-700 mb-1"},"From Date",-1)),ce(e("input",{type:"date",id:"standupStartDate","onUpdate:modelValue":E[3]||(E[3]=T=>c.startDate=T),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:w},null,544),[[fe,c.startDate]])]),e("div",null,[E[13]||(E[13]=e("label",{for:"standupEndDate",class:"block text-sm font-medium text-gray-700 mb-1"},"To Date",-1)),ce(e("input",{type:"date",id:"standupEndDate","onUpdate:modelValue":E[4]||(E[4]=T=>c.endDate=T),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:w},null,544),[[fe,c.endDate]])]),e("div",null,[E[15]||(E[15]=e("label",{for:"standupUserFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),ce(e("select",{id:"standupUserFilter","onUpdate:modelValue":E[5]||(E[5]=T=>c.userId=T),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:w},[E[14]||(E[14]=e("option",{value:""},"All Users",-1)),(n(!0),d(K,null,ee(s.users,T=>(n(),d("option",{key:T.id,value:T.id},g(T.name),9,Kl))),128))],544),[[We,c.userId]])]),e("div",null,[E[17]||(E[17]=e("label",{for:"standupSearchFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Search Content",-1)),e("div",Jl,[ce(e("input",{type:"text",id:"standupSearchFilter","onUpdate:modelValue":E[6]||(E[6]=T=>c.search=T),class:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pr-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search in standup content...",onInput:b},null,544),[[fe,c.search]]),E[16]||(E[16]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:S}," Reset Filters ")])])):D("",!0),a.value?(n(),d("div",Zl,"Loading standups...")):u.value?(n(),d("div",Xl,g(u.value),1)):o.value==="list"?(n(),d("div",Ql,[j.value.length?(n(),d("div",ea,[(n(!0),d(K,null,ee(j.value,T=>{var U,Z;return n(),d("div",{key:T.id,class:"p-4 bg-blue-50 rounded-md shadow-sm hover:bg-blue-100 transition-colors border-l-4 border-blue-500"},[T.content==="[Encrypted content could not be decrypted]"?(n(),d("div",ta,[e("div",sa,[e("p",la,[F(g(T.content),1),E[18]||(E[18]=e("span",{class:"text-xs text-red-400 block mt-1"},"(There was an issue decrypting this standup. Please contact an administrator.)",-1))]),e("div",aa,[e("p",ia,"Submitted by "+g(((U=T.user)==null?void 0:U.name)||"Unknown")+" on "+g(q(de)(T.created_at).format("L")),1)])])])):(n(),d("div",na,[e("div",oa,[e("div",ra,[E[19]||(E[19]=e("h3",{class:"text-md font-bold text-gray-800"},"Daily Standup",-1)),e("span",da,g(L(T.content).date),1)]),e("div",ua,[E[20]||(E[20]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Yesterday:")],-1)),e("p",ca,g(L(T.content).yesterday),1)]),e("div",ma,[E[21]||(E[21]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-green-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Today:")],-1)),e("p",va,g(L(T.content).today),1)]),e("div",pa,[E[22]||(E[22]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-red-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Blockers:")],-1)),e("p",ha,g(L(T.content).blockers),1)]),e("div",ga,[e("p",ya,"Submitted by "+g(((Z=T.user)==null?void 0:Z.name)||"Unknown")+" on "+g(q(de)(T.created_at).format("L")),1)])])]))])}),128))])):(n(),d("p",fa,"No daily standups found for the selected criteria."))])):o.value==="calendar"?(n(),d("div",ba,[e("div",_a,[e("button",{onClick:y,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},E[23]||(E[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("h3",wa,g(m.value?q(de)(m.value).format("MMMM YYYY"):"Loading..."),1),e("button",{onClick:h,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},E[24]||(E[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),p(q(Bl),{class:"vuecal--blue-theme","active-view":"month",events:M.value,"selected-date":m.value,"hide-title-bar":"","disable-views":["week","day","years","year"],twelveHour:!0,"time-from":480,"time-to":1200,"time-step":30,"events-on-month-view":"short"},{event:N(({event:T})=>[e("div",{class:"vuecal__event-title",innerHTML:T.title},null,8,xa),e("div",{class:"vuecal__event-content",innerHTML:T.content},null,8,ka)]),"cell-content":N(({view:T,date:U})=>[T.id==="month"?(n(),d(K,{key:0},[U&&O(U)&&P(U)&&!M.value.some(Z=>J(Z.start,U))?(n(),d("div",Da," No standups ")):D("",!0)],64)):D("",!0)]),_:1},8,["events","selected-date"]),E[26]||(E[26]=es('<div class="mt-4 flex items-center space-x-4 text-sm"><div class="flex items-center"><span class="inline-block w-3 h-3 bg-blue-50 border-l-2 border-blue-500 mr-1"></span><span>Standup submitted</span></div><div class="flex items-center"><span class="inline-block w-3 h-3 bg-red-50 border-l-2 border-red-500 mr-1"></span><span>Missing standup</span></div></div>',1)),e("div",Ca,[E[25]||(E[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Standups Outside Current Month View",-1)),Object.entries(V.value).some(([T])=>!q(de)(T).isSame(m.value,"month"))?(n(),d("div",$a,[(n(!0),d(K,null,ee(Object.entries(V.value).filter(([T])=>!q(de)(T).isSame(m.value,"month")).sort((T,U)=>q(de)(T[0]).valueOf()-q(de)(U[0]).valueOf()),([T,U])=>(n(),d("div",{key:T,class:"mb-4"},[e("div",Sa,g(q(de)(T).format("dddd, MMMM Do YYYY")),1),(n(!0),d(K,null,ee(U,Z=>{var A;return n(),d("div",{key:Z.id,class:"p-2 mb-2 rounded bg-blue-50 border-l-2 border-blue-500"},[e("div",Ea,g(((A=Z.user)==null?void 0:A.name)||"Unknown"),1),e("div",Ma,g(q(de)(Z.created_at).format("LT")),1)])}),128))]))),128))])):(n(),d("div",Ta,"No standups outside the current month view."))])])):D("",!0),p(yt,{show:i.value,onClose:E[7]||(E[7]=T=>i.value=!1),onStandupAdded:k,projectId:l.projectId},null,8,["show","projectId"])]))}},Va={class:"relative"},Aa={key:0,class:"text-gray-400 text-sm"},Oa=["onClick"],Ia=["placeholder"],La={key:0,class:"absolute z-50 w-full bg-white border border-gray-300 rounded-md shadow-lg mt-1 max-h-60 overflow-y-auto"},Ua={class:"py-1"},Na={key:0,class:"px-4 py-2 text-gray-500 text-sm"},Pa=["onClick"],Ra={__name:"CustomMultiSelect",props:{modelValue:{type:Array,default:()=>[]},options:{type:Array,default:()=>[],required:!0},placeholder:{type:String,default:"Select items"},labelKey:{type:String,default:"name"},trackBy:{type:String,default:"id"}},emits:["update:modelValue"],setup(l,{emit:t}){const s=l,o=t,i=x(!1),a=x(""),u=R(()=>{if(!a.value)return s.options;const v=a.value.toLowerCase();return s.options.filter(f=>f[s.labelKey].toLowerCase().includes(v))});re(()=>s.modelValue,v=>{},{deep:!0});const r=v=>{const f=[...s.modelValue],b=f.findIndex(k=>k===v[s.trackBy]);b===-1?f.push(v[s.trackBy]):f.splice(b,1),o("update:modelValue",f),a.value=""},m=v=>{const f=s.options.find(b=>b[s.trackBy]===v);return f?f[s.labelKey]:""},c=v=>s.modelValue.includes(v);return(v,f)=>{const b=ts("click-outside");return ce((n(),d("div",Va,[e("div",{class:"flex flex-wrap items-center w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm cursor-pointer min-h-[38px] bg-white focus-within:border-indigo-500 focus-within:ring-indigo-500",onClick:f[2]||(f[2]=k=>i.value=!i.value)},[l.modelValue.length===0&&!a.value?(n(),d("span",Aa,g(l.placeholder),1)):D("",!0),(n(!0),d(K,null,ee(l.modelValue,k=>(n(),d("div",{key:k,class:"inline-flex items-center bg-indigo-100 text-indigo-800 text-xs font-medium px-2.5 py-0.5 rounded mr-2 mb-1"},[F(g(m(k))+" ",1),e("button",{type:"button",onClick:we(w=>r(l.options.find(S=>S[l.trackBy]===k)),["stop"]),class:"ml-1 text-indigo-800 hover:text-indigo-900 focus:outline-none"},f[3]||(f[3]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Oa)]))),128)),ce(e("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=k=>a.value=k),onInput:f[1]||(f[1]=k=>i.value=!0),class:"flex-grow border-none focus:ring-0 p-0 text-sm placeholder-gray-400 bg-transparent outline-none",placeholder:l.modelValue.length===0?"Search...":""},null,40,Ia),[[fe,a.value]])]),i.value?(n(),d("div",La,[e("ul",Ua,[u.value.length===0?(n(),d("li",Na,"No items found.")):D("",!0),(n(!0),d(K,null,ee(u.value,k=>(n(),d("li",{key:k[l.trackBy],class:Q(["px-4 py-2 cursor-pointer hover:bg-gray-100 text-sm",{"bg-indigo-50 text-indigo-900":c(k[l.trackBy])}]),onClick:w=>r(k)},g(k[l.labelKey]),11,Pa))),128))])])):D("",!0)])),[[b,()=>i.value=!1]])}}},He=Ce(Ra,[["__scopeId","data-v-5326f069"]]),Fa={class:"mt-6 space-y-6"},Ba={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ha={class:"flex items-center"},Wa={class:"flex items-center"},Ya={__name:"MeetingModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,a=["Africa/Cairo","Africa/Johannesburg","Africa/Lagos","America/Anchorage","America/Bogota","America/Chicago","America/Denver","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Dubai","Asia/Hong_Kong","Asia/Jerusalem","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Tokyo","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Berlin","Europe/Dublin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Rome","Pacific/Auckland","Pacific/Honolulu","UTC","GMT","Europe/Belfast","America/Adak","America/Boise","America/Detroit","America/Indianapolis","America/Juneau","America/Louisville","America/Menominee","America/Nome","America/Sitka","America/Yakutat","Asia/Karachi","Asia/Kolkata","Pacific/Auckland","Pacific/Chatham","Europe/Athens","Europe/Brussels","Europe/Budapest","Europe/Copenhagen","Europe/Helsinki","Europe/Lisbon","Europe/Oslo","Europe/Stockholm","Europe/Zurich","Europe/Vienna","Europe/Warsaw","Europe/Zurich","Europe/Sofia","Europe/Prague","Europe/Malta","Europe/Luxembourg","Europe/Kiev","Europe/Rome"].sort(),u=R(()=>a.map(h=>({value:h,label:h}))),r=R(()=>{const h=i(),M=a.includes(h);return console.log("DEBUG: Is detected timezone in list?",M,"Detected:",h),M?h:(console.log("DEBUG: Falling back to UTC for timezone as detected timezone not in list."),"UTC")}),m=ke({summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0,timezone:r.value,enable_recording:!1}),c=()=>{m.summary="",m.description="",m.attendee_user_ids=[],m.location="",m.with_google_meet=!0,m.timezone=r.value,m.enable_recording=!1,f(),console.log("DEBUG: Form reset. Current timezone in form:",m.timezone)},v=h=>{const M=new Date(h),j=M.getFullYear(),O=String(M.getMonth()+1).padStart(2,"0"),P=String(M.getDate()).padStart(2,"0"),J=String(M.getHours()).padStart(2,"0"),L=String(M.getMinutes()).padStart(2,"0");return`${j}-${O}-${P}T${J}:${L}`},f=()=>{const h=new Date,M=new Date(h.getTime()+3600*1e3),j=new Date(h.getTime()+7200*1e3);m.start_datetime=v(M),m.end_datetime=v(j),console.log("DEBUG: Default times set. Start:",m.start_datetime,"End:",m.end_datetime)};f(),re(()=>s.show,h=>{h&&c()},{immediate:!0});const b=h=>h?(console.log(h),h.replace("T"," ")+":00"):"",k=h=>{const M={...h};return M.start_datetime=b(h.start_datetime),M.end_datetime=b(h.end_datetime),console.log(M),M},w=R(()=>`/api/projects/${s.projectId}/meetings`),S=h=>{o("saved",h)},y=h=>{console.error("DEBUG: MeetingModal submission error:",h)};return(h,M)=>(n(),le(Ee,{show:l.show,title:"Schedule a Meeting","api-endpoint":w.value,"http-method":"post","form-data":m,"format-data-for-api":k,"submit-button-text":"Schedule Meeting","success-message":"Meeting scheduled successfully!",onClose:M[9]||(M[9]=j=>h.$emit("close")),onSubmitted:S,onError:y},{default:N(({errors:j})=>[e("div",Fa,[e("div",null,[p(W,{for:"summary",value:"Meeting Title"}),p(ne,{id:"summary",modelValue:m.summary,"onUpdate:modelValue":M[0]||(M[0]=O=>m.summary=O),type:"text",class:"mt-1 block w-full",placeholder:"Project Status Meeting",required:""},null,8,["modelValue"]),p(ae,{message:j.summary?j.summary[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"description",value:"Description"}),ce(e("textarea",{id:"description","onUpdate:modelValue":M[1]||(M[1]=O=>m.description=O),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Meeting agenda and details..."},null,512),[[fe,m.description]]),p(ae,{message:j.description?j.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Ba,[e("div",null,[p(W,{for:"start_datetime",value:"Start Date & Time"}),p(ne,{id:"start_datetime",modelValue:m.start_datetime,"onUpdate:modelValue":M[2]||(M[2]=O=>m.start_datetime=O),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:j.start_datetime?j.start_datetime[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"end_datetime",value:"End Date & Time"}),p(ne,{id:"end_datetime",modelValue:m.end_datetime,"onUpdate:modelValue":M[3]||(M[3]=O=>m.end_datetime=O),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:j.end_datetime?j.end_datetime[0]:"",class:"mt-2"},null,8,["message"])])]),e("div",null,[p(W,{for:"attendees",value:"Attendees"}),p(He,{id:"attendees",modelValue:m.attendee_user_ids,"onUpdate:modelValue":M[4]||(M[4]=O=>m.attendee_user_ids=O),options:s.projectUsers,"label-key":"name","track-by":"id",placeholder:"Select attendees",class:"mt-1"},null,8,["modelValue","options"]),M[10]||(M[10]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select project members to invite to this meeting ",-1)),p(ae,{message:j.attendee_user_ids?j.attendee_user_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"location",value:"Location (Optional)"}),p(ne,{id:"location",modelValue:m.location,"onUpdate:modelValue":M[5]||(M[5]=O=>m.location=O),type:"text",class:"mt-1 block w-full",placeholder:"Office, Conference Room, etc."},null,8,["modelValue"]),p(ae,{message:j.location?j.location[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"timezone",value:"Timezone"}),p(pe,{id:"timezone",modelValue:m.timezone,"onUpdate:modelValue":M[6]||(M[6]=O=>m.timezone=O),options:u.value,"value-key":"value","label-key":"label",placeholder:"Select timezone",class:"mt-1"},null,8,["modelValue","options"]),M[11]||(M[11]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select your timezone for this meeting ",-1)),p(ae,{message:j.timezone?j.timezone[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Ha,[ce(e("input",{id:"with_google_meet","onUpdate:modelValue":M[7]||(M[7]=O=>m.with_google_meet=O),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,m.with_google_meet]]),M[12]||(M[12]=e("label",{for:"with_google_meet",class:"ml-2 block text-sm text-gray-900"}," Create Google Meet video conference ",-1))]),e("div",Wa,[ce(e("input",{id:"enable_recording","onUpdate:modelValue":M[8]||(M[8]=O=>m.enable_recording=O),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,m.enable_recording]]),M[13]||(M[13]=e("label",{for:"enable_recording",class:"ml-2 block text-sm text-gray-900"}," Enable recording and transcript ",-1))])])]),_:1},8,["show","api-endpoint","form-data"]))}},za=Ce(Ya,[["__scopeId","data-v-4e53a3e5"]]),qa={class:"p-6"},Ga={key:0,class:"mb-4 p-3 bg-green-100 text-green-800 rounded-md"},Ka={key:1,class:"mb-4 p-3 bg-red-100 text-red-800 rounded-md"},Ja={class:"mb-4"},Za=["value"],Xa={class:"mt-6 flex justify-end space-x-3"},Qa={__name:"ProjectMagicLinkModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectClients:{type:Array,default:()=>[]}},emits:["close"],setup(l,{emit:t}){const s=l,o=t,i=x(!1),a=x(""),u=x(""),r=x(""),m=async()=>{var v,f;if(!a.value){r.value="Please select a client email";return}i.value=!0,u.value="",r.value="";try{const b=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{email:a.value});b.data.success?(u.value=b.data.message,a.value=""):r.value=b.data.message||"Failed to send magic link"}catch(b){console.error("Error sending magic link:",b),r.value=((f=(v=b.response)==null?void 0:v.data)==null?void 0:f.message)||"An error occurred while sending the magic link"}finally{i.value=!1}},c=()=>{a.value="",u.value="",r.value="",o("close")};return(v,f)=>(n(),le(Se,{show:l.show,onClose:c},{default:N(()=>[e("div",qa,[e("div",{class:"flex justify-between items-center mb-4"},[f[2]||(f[2]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Send Magic Link to Client",-1)),e("button",{onClick:c,class:"text-gray-400 hover:text-gray-500"},f[1]||(f[1]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u.value?(n(),d("div",Ga,g(u.value),1)):D("",!0),r.value?(n(),d("div",Ka,g(r.value),1)):D("",!0),e("div",Ja,[p(W,{for:"client-email",value:"Select Client"}),ce(e("select",{id:"client-email","onUpdate:modelValue":f[0]||(f[0]=b=>a.value=b),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full"},[f[3]||(f[3]=e("option",{value:""},"Select a client",-1)),(n(!0),d(K,null,ee(l.projectClients,b=>(n(),d("option",{key:b.id,value:b.email},g(b.name)+" ("+g(b.email)+") ",9,Za))),128))],512),[[We,a.value]]),f[4]||(f[4]=e("p",{class:"mt-2 text-sm text-gray-500"}," The magic link will be sent to the selected client's email address. ",-1))]),e("div",Xa,[p(ye,{onClick:c,type:"button"},{default:N(()=>f[5]||(f[5]=[F(" Cancel ",-1)])),_:1,__:[5]}),p(ue,{onClick:m,disabled:i.value||!a.value,class:"bg-purple-600 hover:bg-purple-700"},{default:N(()=>[F(g(i.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},ei={class:"mt-6 space-y-6"},ti={class:"mt-2 flex space-x-4"},si={class:"inline-flex items-center"},li={class:"inline-flex items-center"},ai={key:0},ii={key:1},ni=["required"],oi={__name:"ResourceModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},resource:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=x({name:"",type:"link",url:"",file:null,description:""}),a=x(null),u=R(()=>s.resource?`/api/projects/${s.projectId}/resources/${s.resource.id}`:`/api/projects/${s.projectId}/resources`),r=R(()=>s.resource?"put":"post"),m=R(()=>s.resource?"Update Resource":"Add Resource"),c=R(()=>s.resource?"Resource updated successfully!":"Resource added successfully!");re(()=>s.show,w=>{w&&(s.resource?i.value={name:s.resource.name,type:s.resource.type,url:s.resource.type==="link"?s.resource.url:"",file:null,description:s.resource.description||""}:i.value={name:"",type:"link",url:"",file:null,description:""},a.value&&(a.value.value=""))},{immediate:!0});const v=w=>{i.value.file=w.target.files[0]||null},f=w=>{const S=new FormData;return S.append("name",w.name||""),S.append("type",w.type||"link"),S.append("description",w.description||""),w.type==="link"?S.append("url",w.url||""):w.type==="file"&&w.file&&S.append("file",w.file),(r.value==="put"||r.value==="patch")&&S.append("_method","PUT"),S},b=w=>{o("saved",w.resource)},k=()=>{o("close")};return(w,S)=>(n(),le(Ee,{show:l.show,title:l.resource?"Edit Resource":"Add Resource","api-endpoint":u.value,"http-method":r.value,"form-data":i.value,"submit-button-text":m.value,"success-message":c.value,"format-data-for-api":f,onClose:k,onSubmitted:b},{default:N(({errors:y})=>[e("div",ei,[e("div",null,[p(W,{for:"resource-type",value:"Resource Type"}),e("div",ti,[e("label",si,[ce(e("input",{type:"radio","onUpdate:modelValue":S[0]||(S[0]=h=>i.value.type=h),value:"link",class:"form-radio text-indigo-600"},null,512),[[mt,i.value.type]]),S[5]||(S[5]=e("span",{class:"ml-2 text-gray-700"},"Link",-1))]),e("label",li,[ce(e("input",{type:"radio","onUpdate:modelValue":S[1]||(S[1]=h=>i.value.type=h),value:"file",class:"form-radio text-indigo-600"},null,512),[[mt,i.value.type]]),S[6]||(S[6]=e("span",{class:"ml-2 text-gray-700"},"File",-1))])])]),e("div",null,[p(W,{for:"resource-name",value:"Name"}),p(ne,{id:"resource-name",modelValue:i.value.name,"onUpdate:modelValue":S[2]||(S[2]=h=>i.value.name=h),type:"text",class:"mt-1 block w-full",placeholder:"Enter resource name",required:""},null,8,["modelValue"]),p(ae,{message:y.name?y.name[0]:"",class:"mt-2"},null,8,["message"])]),i.value.type==="link"?(n(),d("div",ai,[p(W,{for:"resource-url",value:"URL"}),p(ne,{id:"resource-url",modelValue:i.value.url,"onUpdate:modelValue":S[3]||(S[3]=h=>i.value.url=h),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com",required:""},null,8,["modelValue"]),p(ae,{message:y.url?y.url[0]:"",class:"mt-2"},null,8,["message"])])):D("",!0),i.value.type==="file"?(n(),d("div",ii,[p(W,{for:"resource-file",value:"File"}),e("input",{id:"resource-file",ref_key:"fileInputRef",ref:a,type:"file",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",onChange:v,required:!l.resource||i.value.type==="file"},null,40,ni),p(ae,{message:y.file?y.file[0]:"",class:"mt-2"},null,8,["message"])])):D("",!0),e("div",null,[p(W,{for:"resource-description",value:"Description (Optional)"}),ce(e("textarea",{id:"resource-description","onUpdate:modelValue":S[4]||(S[4]=h=>i.value.description=h),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter a description for this resource"},null,512),[[fe,i.value.description]]),p(ae,{message:y.description?y.description[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},ri=Ce(oi,[["__scopeId","data-v-f508dda8"]]),di={class:"flex flex-col space-y-6"},ui={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},ci={key:0},mi={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},vi={class:"mb-4"},pi={key:0,class:"text-xs text-gray-500 mt-1"},hi={key:0,class:"text-xs text-gray-500 mt-1"},gi={class:"flex justify-between items-center mb-3"},yi={key:0,class:"flex items-center"},fi={key:1},bi={class:"bg-gray-100 p-4 rounded-lg shadow-inner min-h-[300px]"},_i={key:0,class:"flex items-center justify-center h-full"},wi=["innerHTML"],xi={__name:"ComposeEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},clients:{type:Array,default:()=>[]}},emits:["close"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(""),u=x(!1),r=x({}),m=x({}),c=x(!1),v=ke({template_id:null,recipients:[],dynamic_data:{}});et(s.projectId);const f=R(()=>i.value.find(O=>O.id===v.template_id)),b=async O=>{c.value=!0,m.value={};const P=new Set;O.placeholders.forEach(J=>{(J.is_repeatable||J.is_selectable)&&J.source_model&&P.add(J.source_model)});try{const J=Array.from(P).map(L=>{const V=L.split("\\").pop(),I=`/api/projects/${s.projectId}/model-data/${V}`;return window.axios.get(I).then(E=>{m.value[V]=E.data})});await Promise.all(J)}catch(J){console.error("Failed to fetch source model data:",J)}finally{c.value=!1}},k=async()=>{try{const O=await window.axios.get("/api/email-templates");i.value=O.data}catch(O){console.error("Failed to fetch email templates:",O)}},w=async()=>{if(!v.template_id||v.recipients.length===0){a.value='<p class="text-gray-500 italic">Select a template and at least one recipient to see a preview.</p>';return}u.value=!0;try{const O=await window.axios.post(`/api/projects/${s.projectId}/email-preview`,{template_id:v.template_id,recipient_id:v.recipients[0],dynamic_data:v.dynamic_data});a.value=O.data.body_html}catch(O){console.error("Failed to fetch email preview:",O),a.value='<p class="text-red-500 italic">Error loading preview.</p>'}finally{u.value=!1}};re(()=>s.show,O=>{O&&(Object.assign(v,{template_id:null,recipients:[],dynamic_data:{}}),a.value="",r.value={},m.value={},k())}),re(f,O=>{v.dynamic_data={},O&&O.placeholders&&(O.placeholders.forEach(P=>{P.is_dynamic?v.dynamic_data[P.name]="":(P.is_repeatable||P.is_selectable)&&(P.is_repeatable?v.dynamic_data[P.name]=[]:v.dynamic_data[P.name]=null)}),b(O))});const S=()=>{o("close")},y=()=>{o("close")},h=R(()=>i.value.map(O=>({value:O.id,label:O.name}))),M=R(()=>f.value?f.value.placeholders.filter(O=>O.is_dynamic||O.is_repeatable||O.is_selectable):[]),j=R(()=>`/api/projects/${s.projectId}/send-email`);return be(()=>{k()}),(O,P)=>(n(),le(Ee,{show:l.show,title:"Compose Email from Template","api-endpoint":j.value,"http-method":"post","form-data":v,"submit-button-text":"Send Email","success-message":"Email sent successfully!",onClose:y,onSubmitted:S},{default:N(({errors:J})=>[e("div",di,[e("div",ui,[e("div",null,[p(W,{for:"template",value:"Select Template"}),p(pe,{id:"template",modelValue:v.template_id,"onUpdate:modelValue":P[0]||(P[0]=L=>v.template_id=L),options:h.value,placeholder:"Select a template","value-key":"value","label-key":"label","allow-empty":!0,class:"mt-1"},null,8,["modelValue","options"]),p(ae,{message:J.template_id?J.template_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"recipients",value:"Recipients"}),p(He,{id:"recipients",modelValue:v.recipients,"onUpdate:modelValue":P[1]||(P[1]=L=>v.recipients=L),options:l.clients,placeholder:"Select clients to send to","label-key":"name","track-by":"id",class:"mt-1"},null,8,["modelValue","options"]),p(ae,{message:J.recipients?J.recipients[0]:"",class:"mt-2"},null,8,["message"])])]),f.value?(n(),d("div",ci,[P[2]||(P[2]=e("h4",{class:"text-md font-semibold text-gray-800 mb-3"},"Dynamic Placeholders",-1)),e("div",mi,[(n(!0),d(K,null,ee(M.value,L=>(n(),d("div",{key:L.id},[e("div",vi,[p(W,{for:L.name,value:L.name},null,8,["for","value"]),L.is_repeatable&&L.source_model?(n(),d(K,{key:0},[p(He,{id:L.name,modelValue:v.dynamic_data[L.name],"onUpdate:modelValue":V=>v.dynamic_data[L.name]=V,options:m.value[L.source_model.split("\\").pop()]||[],placeholder:`Select one or more ${L.name}`,"label-key":L.source_attribute,"track-by":"id",class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue","options","placeholder","label-key"]),c.value?(n(),d("div",pi," Loading "+g(L.source_model.split("\\").pop())+"... ",1)):D("",!0)],64)):L.is_selectable&&L.source_model?(n(),d(K,{key:1},[p(pe,{id:L.name,modelValue:v.dynamic_data[L.name],"onUpdate:modelValue":V=>v.dynamic_data[L.name]=V,options:m.value[L.source_model.split("\\").pop()]||[],placeholder:`Select a ${L.name}`,"value-key":L.trackBy??"id","label-key":L.source_attribute,"allow-empty":!0,class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue","options","placeholder","value-key","label-key"]),c.value?(n(),d("div",hi," Loading "+g(L.source_model.split("\\").pop())+"... ",1)):D("",!0)],64)):L.is_dynamic&&L.is_link?(n(),le(ne,{key:2,id:L.name,type:"url",class:"mt-1 block w-full",modelValue:v.dynamic_data[L.name],"onUpdate:modelValue":V=>v.dynamic_data[L.name]=V,placeholder:"Enter URL"},null,8,["id","modelValue","onUpdate:modelValue"])):(n(),le(ne,{key:3,id:L.name,type:"text",class:"mt-1 block w-full",modelValue:v.dynamic_data[L.name],"onUpdate:modelValue":V=>v.dynamic_data[L.name]=V},null,8,["id","modelValue","onUpdate:modelValue"])),p(ae,{message:J[`dynamic_data.${L.name}`]?J[`dynamic_data.${L.name}`][0]:"",class:"mt-2"},null,8,["message"])])]))),128))])])):D("",!0),e("div",null,[e("div",gi,[P[4]||(P[4]=e("h4",{class:"text-md font-semibold text-gray-800"},"Email Preview",-1)),p(ue,{onClick:w,disabled:!v.template_id||v.recipients.length===0||u.value,class:Q({"opacity-50 cursor-not-allowed":!v.template_id||v.recipients.length===0||u.value})},{default:N(()=>[u.value?(n(),d("span",yi,P[3]||(P[3]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),F(" Loading... ",-1)]))):(n(),d("span",fi," Refresh Preview "))]),_:1},8,["disabled","class"])]),e("div",bi,[u.value?(n(),d("div",_i,P[5]||(P[5]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"},null,-1)]))):(n(),d("div",{key:1,innerHTML:a.value},null,8,wi))])])])]),_:1},8,["show","api-endpoint","form-data"]))}},ki={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Di={class:"flex justify-between items-center mb-4"},Ci={class:"flex gap-3"},$i={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Si={class:"text-2xl font-bold text-gray-900 tracking-tight mb-2"},Ei={class:"text-gray-600 text-base"},Mi={class:"space-y-3 text-sm text-gray-700"},Ti={class:"flex flex-wrap gap-2 mt-2 items-center"},ji=["href"],Vi=["href"],Ai=["href"],Oi={key:3,class:"text-gray-500 text-sm"},Ii={class:"relative"},Li=["onClick"],Ui={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ni={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Pi={key:0,class:"resource-tooltip absolute left-0 bottom-full mb-2 w-48 z-10"},Ri={class:"bg-white rounded-md shadow-lg p-3 text-sm border border-gray-200"},Fi={class:"flex justify-between items-center mb-2"},Bi={class:"font-medium text-gray-900"},Hi={key:0,class:"text-gray-600 text-xs mb-2"},Wi={class:"flex justify-between mt-2 pt-2 border-t border-gray-100"},Yi=["href"],zi={class:"flex space-x-2"},qi=["onClick"],Gi=["onClick"],Ki={class:"p-6"},Ji={key:0,class:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-md"},Zi={key:1,class:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md"},Xi={class:"mb-4"},Qi={key:0,class:"text-gray-500 text-sm mt-1"},en={key:1,class:"text-red-500 text-sm mt-1"},tn={class:"flex justify-end mt-6"},sn={__name:"ProjectGeneralInfoCard",props:{project:{type:Object,required:!0},projectId:{type:Number,required:!0},canManageProjects:{type:Boolean,required:!0},canEditProjects:{type:Boolean,required:!1},isSuperAdmin:{type:Boolean,required:!0}},emits:["openEditModal","openStandupModal","openMeetingModal","resourceSaved","openComposeModal"],setup(l,{emit:t}){const s=l,o=t,i=x(!1),a=x(null),u=x([]),r=x(!1),m=x(null),c=x(!1),v=x(!1),f=x(!1),b=x({client_ids:[]}),k=x({}),w=x(""),S=x([]),y=x(!1),h=x("");et(s.projectId);const M=async()=>{r.value=!0;try{const _=await window.axios.get(`/api/projects/${s.projectId}/resources`);_.data.success?u.value=_.data.resources:console.error("Failed to fetch resources:",_.data.message)}catch(_){console.error("Error fetching resources:",_)}finally{r.value=!1}},j=()=>{a.value=null,i.value=!0},O=_=>{a.value=_,i.value=!0},P=async _=>{if(confirm("Are you sure you want to delete this resource?"))try{const C=await window.axios.delete(`/api/projects/${s.projectId}/resources/${_}`);C.data.success?u.value=u.value.filter($=>$.id!==_):console.error("Failed to delete resource:",C.data.message)}catch(C){console.error("Error deleting resource:",C)}},J=_=>{if(a.value){const C=u.value.findIndex($=>$.id===_.id);C!==-1&&(u.value[C]=_)}else u.value.push(_);o("resourceSaved",_)},L=_=>{m.value=m.value===_?null:_},V=()=>{m.value=null},I=_=>{if(m.value!==null){const C=_.target.closest(".resource-tooltip"),$=_.target.closest(".resource-button");!C&&!$&&V()}};be(()=>{M(),document.addEventListener("click",I)}),ss(()=>{document.removeEventListener("click",I)});const E=async()=>{var _,C;y.value=!0,h.value="";try{const $=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);console.log($),S.value=$.data}catch($){console.error("Failed to fetch project clients:",$),h.value=((C=(_=$.response)==null?void 0:_.data)==null?void 0:C.message)||"Failed to load client data."}finally{y.value=!1}},T=()=>{b.value.client_ids=[],k.value={},w.value="",v.value=!0,E()},U=()=>{c.value=!0,E()},Z=()=>{v.value=!1},A=async()=>{if(k.value={},w.value="",f.value=!0,!b.value.client_ids||b.value.client_ids.length===0){k.value={client_ids:["Please select a client."]},f.value=!1;return}try{const _=b.value.client_ids[0];if(!S.value.find(H=>H.id===_)){k.value={client_ids:["Selected client does not have a valid email."]},f.value=!1;return}const $=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{client_id:_});$.data.success&&(w.value=$.data.message,b.value.client_ids=[])}catch(_){_.response&&_.response.status===422?k.value=_.response.data.errors:_.response&&_.response.data.message?k.value={general:[_.response.data.message]}:k.value={general:["An unexpected error occurred. Please try again."]}}finally{f.value=!1}};return(_,C)=>{var $;return n(),d(K,null,[e("div",ki,[e("div",Di,[C[10]||(C[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"General Information",-1)),e("div",Ci,[p(ue,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:C[0]||(C[0]=H=>o("openStandupModal"))},{default:N(()=>C[6]||(C[6]=[F(" Daily Standup ",-1)])),_:1,__:[6]}),l.canEditProjects||l.isSuperAdmin?(n(),le(ue,{key:0,onClick:C[1]||(C[1]=H=>_.$inertia.visit("/projects/"+l.projectId+"/edit")),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:N(()=>C[7]||(C[7]=[F(" Edit Project ",-1)])),_:1,__:[7]})):D("",!0),l.canManageProjects||l.isSuperAdmin?(n(),le(ue,{key:1,class:"bg-green-600 hover:bg-green-700 transition-colors",onClick:C[2]||(C[2]=H=>o("openMeetingModal"))},{default:N(()=>C[8]||(C[8]=[F(" Schedule Meeting ",-1)])),_:1,__:[8]})):D("",!0),l.canManageProjects||l.isSuperAdmin?(n(),le(ue,{key:2,class:"bg-blue-400 hover:bg-blue-600 transition-colors",onClick:U},{default:N(()=>C[9]||(C[9]=[F(" Compose Email ",-1)])),_:1,__:[9]})):D("",!0),l.canManageProjects?(n(),le(ue,{key:3,class:"bg-purple-600 hover:bg-purple-700 transition-colors",onClick:T,disabled:f.value},{default:N(()=>[F(g(f.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])):D("",!0)])]),e("div",$i,[e("div",null,[e("h3",Si,g(l.project.name),1),e("p",Ei,g(l.project.description||"No description provided"),1)]),e("div",Mi,[e("p",null,[C[11]||(C[11]=e("strong",{class:"text-gray-900"},"Status:",-1)),F(" "+g((($=l.project.status)==null?void 0:$.replace("_"," ").toUpperCase())||"N/A"),1)]),e("p",null,[C[12]||(C[12]=e("strong",{class:"text-gray-900"},"Project Type:",-1)),F(" "+g(l.project.project_type||"N/A"),1)]),e("p",null,[C[13]||(C[13]=e("strong",{class:"text-gray-900"},"Source:",-1)),F(" "+g(l.project.source||"N/A"),1)]),e("div",Ti,[e("button",{onClick:j,class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Add Resource"},C[14]||(C[14]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])),l.project.website?(n(),d("a",{key:0,href:l.project.website,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Visit Website"},C[15]||(C[15]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})],-1)]),8,ji)):D("",!0),l.project.social_media_link?(n(),d("a",{key:1,href:l.project.social_media_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Social Media"},C[16]||(C[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})],-1)]),8,Vi)):D("",!0),l.project.google_drive_link?(n(),d("a",{key:2,href:l.project.google_drive_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Google Drive"},C[17]||(C[17]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]),8,Ai)):D("",!0),r.value?(n(),d("div",Oi," Loading resources... ")):(n(!0),d(K,{key:4},ee(u.value,H=>(n(),d("div",{key:H.id,class:"relative"},[e("div",Ii,[e("button",{onClick:we(oe=>L(H.id),["prevent"]),class:"resource-button p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors block"},[H.type==="link"?(n(),d("svg",Ui,C[18]||(C[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.172 13.828a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.102 1.101"},null,-1)]))):(n(),d("svg",Ni,C[19]||(C[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])))],8,Li),m.value===H.id?(n(),d("div",Pi,[e("div",Ri,[e("div",Fi,[e("h4",Bi,g(H.name),1),e("button",{onClick:we(V,["prevent"]),class:"text-gray-400 hover:text-gray-600"},C[20]||(C[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),H.description?(n(),d("p",Hi,g(H.description),1)):D("",!0),e("div",Wi,[e("a",{href:H.url,target:"_blank",class:"text-xs text-indigo-600 hover:text-indigo-800"}," Open Link ",8,Yi),e("div",zi,[e("button",{onClick:we(oe=>O(H),["prevent"]),class:"p-1 text-gray-500 hover:text-indigo-600",title:"Edit"},C[21]||(C[21]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,qi),e("button",{onClick:we(oe=>P(H.id),["prevent"]),class:"p-1 text-gray-500 hover:text-red-600",title:"Delete"},C[22]||(C[22]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Gi)])])]),C[23]||(C[23]=e("div",{class:"absolute left-5 bottom-0 transform translate-y-1/2 rotate-45 w-2 h-2 bg-white border-r border-b border-gray-200"},null,-1))])):D("",!0)])]))),128))])])])]),p(ri,{show:i.value,"project-id":l.projectId,resource:a.value,onClose:C[3]||(C[3]=H=>i.value=!1),onSaved:J},null,8,["show","project-id","resource"]),p(Se,{show:v.value,onClose:Z},{default:N(()=>[e("div",Ki,[C[26]||(C[26]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Send Magic Link ",-1)),w.value?(n(),d("div",Ji,g(w.value),1)):D("",!0),k.value.general?(n(),d("div",Zi,g(k.value.general[0]),1)):D("",!0),e("form",{onSubmit:we(A,["prevent"])},[e("div",Xi,[p(W,{for:"client",value:"Select Client"}),y.value?(n(),d("div",Qi,"Loading clients...")):h.value?(n(),d("div",en,g(h.value),1)):(n(),le(He,{key:2,id:"client",modelValue:b.value.client_ids,"onUpdate:modelValue":C[4]||(C[4]=H=>b.value.client_ids=H),options:S.value,placeholder:"Select a client","label-key":"name","track-by":"id",class:"mt-1"},null,8,["modelValue","options"])),p(ae,{message:k.value.client_ids?k.value.client_ids[0]:"",class:"mt-2"},null,8,["message"]),C[24]||(C[24]=e("p",{class:"mt-2 text-sm text-gray-500"}," Select a client to send them a magic link for project access. ",-1))]),e("div",tn,[p(ye,{onClick:Z,class:"mr-3"},{default:N(()=>C[25]||(C[25]=[F(" Cancel ",-1)])),_:1,__:[25]}),p(ue,{type:"submit",class:"bg-purple-600 hover:bg-purple-700 transition-colors",disabled:f.value},{default:N(()=>[F(g(f.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),p(xi,{show:c.value,"project-id":l.projectId,clients:S.value,onClose:C[5]||(C[5]=H=>c.value=!1)},null,8,["show","project-id","clients"])],64)}}},ln=Ce(sn,[["__scopeId","data-v-f8fc7685"]]),an={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},nn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},on={class:"text-2xl font-bold text-indigo-600"},rn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},dn={class:"text-2xl font-bold text-indigo-600"},un={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},cn={class:"text-2xl font-bold text-indigo-600"},mn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},vn={class:"text-2xl font-bold text-indigo-600"},pn={__name:"ProjectStatsCards",props:{tasks:{type:Array,required:!0},emails:{type:Array,required:!0}},setup(l){const t=l,s=R(()=>t.tasks.filter(u=>u.status!=="Done").length),o=R(()=>t.emails.filter(u=>u.type==="received").length),i=R(()=>{const u=t.emails.filter(r=>r.status==="received"||r.type==="received");if(u.length>0){const r=[...u].sort((m,c)=>new Date(c.created_at)-new Date(m.created_at));return new Date(r[0].created_at).toLocaleDateString()}return"N/A"}),a=R(()=>{const u=t.tasks.filter(r=>r.status!=="Done");if(u.length>0){const r=u.filter(m=>m.due_date);if(r.length>0)return[...r].sort((c,v)=>new Date(c.due_date)-new Date(v.due_date))[0].due_date}return"N/A"});return(u,r)=>(n(),d("div",an,[e("div",nn,[r[0]||(r[0]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Pending Tasks",-1)),e("p",on,g(s.value),1)]),e("div",rn,[r[1]||(r[1]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Received Emails",-1)),e("p",dn,g(o.value),1)]),e("div",un,[r[2]||(r[2]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Last Email Received",-1)),e("p",cn,g(i.value),1)]),e("div",mn,[r[3]||(r[3]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Next Task Deadline",-1)),e("p",vn,g(a.value),1)])]))}},hn={class:"bg-white p-4 rounded-xl shadow-md mb-6"},gn={class:"border-b border-gray-200"},yn={class:"-mb-px flex space-x-8 overflow-x-auto"},fn={__name:"ProjectTabsNavigation",props:{selectedTab:{type:String,default:null},canViewEmails:{type:Boolean,required:!0},canViewNotes:{type:Boolean,required:!0},canViewDeliverables:{type:Boolean,required:!0},canViewSeoReports:{type:Boolean,required:!0}},emits:["update:selectedTab"],setup(l,{emit:t}){const s=l,o=t,i=R({get:()=>s.selectedTab,set:a=>o("update:selectedTab",a)});return(a,u)=>(n(),d("div",hn,[e("div",gn,[e("nav",yn,[e("button",{onClick:u[0]||(u[0]=r=>i.value=null),class:Q([i.value===null?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Overview ",2),e("button",{onClick:u[1]||(u[1]=r=>i.value="tasks"),class:Q([i.value==="tasks"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Project Tasks ",2),l.canViewEmails?(n(),d("button",{key:0,onClick:u[2]||(u[2]=r=>i.value="emails"),class:Q([i.value==="emails"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Email Communication ",2)):D("",!0),l.canViewNotes?(n(),d("button",{key:1,onClick:u[3]||(u[3]=r=>i.value="notes"),class:Q([i.value==="notes"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Notes ",2)):D("",!0),l.canViewNotes?(n(),d("button",{key:2,onClick:u[4]||(u[4]=r=>i.value="standups"),class:Q([i.value==="standups"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Daily Standups ",2)):D("",!0),l.canViewDeliverables?(n(),d("button",{key:3,onClick:u[5]||(u[5]=r=>i.value="deliverables"),class:Q([i.value==="deliverables"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Deliverables ",2)):D("",!0),l.canViewSeoReports?(n(),d("button",{key:4,onClick:u[6]||(u[6]=r=>i.value="seo-reports"),class:Q([i.value==="seo-reports"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," SEO Reports ",2)):D("",!0)])])]))}},bn={class:"space-y-4"},_n={key:0,class:"text-sm text-gray-500"},wn={class:"flex justify-between items-center"},xn={key:0,class:"text-sm text-gray-500"},kn="put",Dn="Update Task",Cn="Task updated successfully!",$n={__name:"EditTaskModal",props:{show:Boolean,projectId:Number,selectedTask:Object,projectUsers:Array,taskTypes:Array,milestones:Array,loadingTaskTypes:Boolean,loadingMilestones:Boolean},emits:["close","saved","open-add-milestone-modal"],setup(l,{emit:t}){const s=l,o=t,i=ke({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null}),a=["To Do","In Progress","Done","Blocked","Archived"],u=R(()=>"Edit Task"),r=R(()=>{var w;return`/api/tasks/${(w=s.selectedTask)==null?void 0:w.id}`});re(()=>[s.show,s.selectedTask],([w,S],[y,h]=[])=>{var M;if(w&&S){let j=null;if(S.milestone){const J=s.milestones.find(L=>L.name===S.milestone);J&&(j=J.id)}else S.milestone_id&&(j=S.milestone_id);let O=null;if(S.task_type){const J=s.taskTypes.find(L=>L.name===S.task_type);J&&(O=J.id)}else S.task_type_id&&(O=S.task_type_id);let P=null;if(S.assigned_to&&S.assigned_to!=="Unassigned"){const J=(M=s.projectUsers)==null?void 0:M.find(L=>L.name===S.assigned_to);J&&(P=J.id)}else S.assigned_to_id&&(P=S.assigned_to_id);Object.assign(i,{name:S.title,description:S.description||"",assigned_to_user_id:P,due_date:S.due_date||null,status:S.status,task_type_id:O,milestone_id:j})}else w||Object.assign(i,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null})},{immediate:!0});const m=w=>{o("saved",w),o("close")},c=()=>{o("open-add-milestone-modal")},v=()=>{o("close")},f=R(()=>s.projectUsers.map(w=>({value:w.id,label:w.name}))),b=R(()=>s.taskTypes.map(w=>({value:w.id,label:w.name}))),k=R(()=>s.milestones.map(w=>({value:w.id,label:w.name})));return(w,S)=>(n(),le(Ee,{show:l.show,title:u.value,"api-endpoint":r.value,"http-method":kn,"form-data":i,"submit-button-text":Dn,"success-message":Cn,onClose:v,onSubmitted:m},{default:N(({errors:y})=>[e("div",bn,[e("div",null,[p(W,{for:"task-name",value:"Task Name"}),p(ne,{id:"task-name",modelValue:i.name,"onUpdate:modelValue":S[0]||(S[0]=h=>i.name=h),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),p(ae,{message:y.name?y.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-description",value:"Description"}),ce(e("textarea",{id:"task-description","onUpdate:modelValue":S[1]||(S[1]=h=>i.description=h),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[fe,i.description]]),p(ae,{message:y.description?y.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-status",value:"Status"}),p(pe,{id:"task-status",modelValue:i.status,"onUpdate:modelValue":S[2]||(S[2]=h=>i.status=h),options:a.map(h=>({value:h,label:h})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),p(ae,{message:y.status?y.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-due-date",value:"Due Date"}),p(ne,{id:"task-due-date",modelValue:i.due_date,"onUpdate:modelValue":S[3]||(S[3]=h=>i.due_date=h),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),p(ae,{message:y.due_date?y.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-assigned-to",value:"Assigned To"}),p(pe,{id:"task-assigned-to",modelValue:i.assigned_to_user_id,"onUpdate:modelValue":S[4]||(S[4]=h=>i.assigned_to_user_id=h),options:f.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"]),p(ae,{message:y.assigned_to_user_id?y.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-type",value:"Task Type"}),l.loadingTaskTypes?(n(),d("div",_n,"Loading task types...")):(n(),le(pe,{key:1,id:"task-type",modelValue:i.task_type_id,"onUpdate:modelValue":S[5]||(S[5]=h=>i.task_type_id=h),options:b.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),p(ae,{message:y.task_type_id?y.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[e("div",wn,[p(W,{for:"task-milestone",value:"Milestone"}),e("button",{type:"button",onClick:c,class:"text-sm text-indigo-600 hover:text-indigo-800"}," + Create New Milestone ")]),l.loadingMilestones?(n(),d("div",xn,"Loading milestones...")):(n(),le(pe,{key:1,id:"task-milestone",modelValue:i.milestone_id,"onUpdate:modelValue":S[6]||(S[6]=h=>i.milestone_id=h),options:k.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),p(ae,{message:y.milestone_id?y.milestone_id[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},Sn={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},En={class:"flex justify-between items-center mb-4"},Mn={class:"flex gap-2"},Tn={key:0},jn={key:1},Vn={class:"mb-6 overflow-x-auto"},An={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},On={key:1,class:"text-center py-4"},In={key:2,class:"relative py-8"},Ln={class:"relative flex justify-between"},Un={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Nn={key:1,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pn={key:2,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Rn={key:3,class:"w-2 h-2 bg-white rounded-full"},Fn={class:"absolute -top-8 transform -translate-x-1/2 left-1/2 w-32"},Bn=["title"],Hn={class:"absolute top-8 transform -translate-x-1/2 left-1/2"},Wn={class:"text-xs text-gray-500 whitespace-nowrap"},Yn={class:"mb-6 bg-gray-50 p-4 rounded-lg"},zn={class:"flex flex-wrap items-center gap-4"},qn={class:"flex-1 min-w-[200px]"},Gn={class:"flex-1 min-w-[200px]"},Kn={class:"flex-1 min-w-[200px]"},Jn={class:"flex-1 min-w-[200px]"},Zn={key:0,class:"mt-3 text-sm text-gray-600"},Xn={key:0,class:"text-red-600 font-medium"},Qn={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},eo={key:1,class:"text-center py-4"},to={class:"text-red-600 text-sm font-medium"},so={key:2,class:"overflow-x-auto"},lo={class:"min-w-full divide-y divide-gray-200"},ao={class:"bg-white divide-y divide-gray-200"},io={class:"px-4 py-3 text-sm text-gray-900"},no={class:"px-4 py-3 text-sm text-gray-700"},oo={class:"px-4 py-3 text-sm text-gray-700"},ro={class:"px-4 py-3 text-sm text-gray-700"},uo={class:"px-4 py-3 text-sm text-gray-700"},co={class:"px-4 py-3 text-right"},mo={class:"flex justify-end space-x-2"},vo=["onClick"],po=["onClick"],ho=["onClick"],go=["onClick"],yo=["onClick"],fo={key:3,class:"text-center py-4"},bo={__name:"ProjectTasksTab",props:{projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},canManageProjects:{type:Boolean,required:!0}},emits:["tasksUpdated","openTaskDetailSidebar","open-create-task-modal"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(""),r=x(!1),m=x(null),c=x(!1),v=x(!1),f=x(null),b=x([]),k=x([]),w=x(!1),S=x(!1),y=ke({status:"",assigned_to_user_id:null,milestone_id:null,due_date_range:""}),h=[{value:"",label:"All Statuses"},{value:"To Do",label:"To Do"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Blocked",label:"Blocked"},{value:"Archived",label:"Archived"}],M=R(()=>{const X=[{value:null,label:"All Users"},{value:-1,label:"Unassigned"}];return X.push(...s.projectUsers.map(z=>({value:z.id,label:z.name}))),X}),j=R(()=>{const X=[{value:null,label:"All Milestones"},{value:-1,label:"No Milestone"}];return X.push(...k.value.map(z=>({value:z.id,label:z.name}))),X}),O=[{value:"",label:"All Dates"},{value:"today",label:"Due Today"},{value:"this_week",label:"Due This Week"},{value:"next_week",label:"Due Next Week"},{value:"overdue",label:"Overdue"},{value:"no_date",label:"No Due Date"}],P=R(()=>!k.value||!k.value.length?[]:[...k.value].sort((X,z)=>X.completion_date?z.completion_date?new Date(X.completion_date)-new Date(z.completion_date):-1:1)),J=R(()=>i.value.length?i.value.filter(X=>{if(y.status&&X.status!==y.status)return!1;if(y.assigned_to_user_id!==null){const z=parseInt(y.assigned_to_user_id);if(z===-1){if(X.assigned_to!=="Unassigned"&&X.assigned_to_id!==null)return!1}else if(X.assigned_to_id!==z)return!1}if(y.milestone_id!==null){const z=parseInt(y.milestone_id);if(z===-1){if(X.milestone_id)return!1}else if(X.milestone_id!==z)return!1}if(y.due_date_range){const z=new Date;z.setHours(0,0,0,0);const G=X.due_date?new Date(X.due_date):null;switch(y.due_date_range){case"today":if(!G||G.toDateString()!==z.toDateString())return!1;break;case"this_week":{if(!G)return!1;const ge=new Date(z);if(ge.setDate(z.getDate()+(6-z.getDay())),G<z||G>ge)return!1;break}case"next_week":{if(!G)return!1;const ge=new Date(z);ge.setDate(z.getDate()+(7-z.getDay()));const Ne=new Date(ge);if(Ne.setDate(ge.getDate()+6),G<ge||G>Ne)return!1;break}case"overdue":{if(!G||G>=z)return!1;break}case"no_date":{if(G)return!1;break}}}return!0}):[]),L=()=>{y.status="",y.assigned_to_user_id=null,y.milestone_id=null,y.due_date_range=""},V=async()=>{a.value=!0,u.value="";try{const X=await window.axios.get(`/api/projects/${s.projectId}/tasks`);i.value=X.data,o("tasksUpdated",i.value)}catch(X){u.value="Failed to load tasks data.",console.error("Error fetching project tasks:",X),X.response&&X.response.data&&X.response.data.message&&(u.value=X.response.data.message)}finally{a.value=!1}},I=async()=>{w.value=!0;try{const X=await window.axios.get("/api/task-types");b.value=X.data}catch(X){console.error("Error fetching task types:",X)}finally{w.value=!1}},E=async()=>{S.value=!0;try{const X=await window.axios.get(`/api/projects/${s.projectId}/milestones`);k.value=X.data}catch(X){console.error("Error fetching milestones:",X)}finally{S.value=!1}},T=()=>{o("open-create-task-modal")},U=async X=>{m.value=X,await I(),await E(),r.value=!0},Z=()=>{V()},A=X=>{console.log("ProjectTasksTab: Emitting open-task-detail-sidebar for taskId:",X.id),o("openTaskDetailSidebar",X.id)},_=()=>{c.value=!0},C=X=>{k.value.push(X),V()},$=X=>{f.value=X,v.value=!0},H=()=>{V()},oe=async X=>{try{await window.axios.post(`/api/tasks/${X.id}/complete`),await V()}catch(z){console.error("Error marking task as completed:",z),alert("Failed to mark task as completed. Please try again.")}},Ve=async X=>{try{await window.axios.post(`/api/tasks/${X.id}/start`),await V()}catch(z){console.error("Error starting task:",z),alert("Failed to start task. Please try again.")}};return be(()=>{V(),I(),E()}),re(()=>s.projectUsers,()=>{}),re(()=>s.taskTypes,()=>{}),re(()=>s.milestones,()=>{}),(X,z)=>(n(),d("div",Sn,[e("div",En,[z[8]||(z[8]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Tasks",-1)),e("div",Mn,[p(ye,{onClick:V,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:N(()=>[a.value?(n(),d("span",jn,"Loading...")):(n(),d("span",Tn,"Refresh"))]),_:1},8,["disabled"]),l.canManageProjects?(n(),le(ue,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:T},{default:N(()=>z[7]||(z[7]=[F(" Add Task ",-1)])),_:1,__:[7]})):D("",!0)])]),e("div",Vn,[S.value?(n(),d("div",An," Loading milestones... ")):P.value.length?(n(),d("div",In,[z[13]||(z[13]=e("div",{class:"absolute h-1 bg-gray-200 top-1/2 left-0 right-0 transform -translate-y-1/2"},null,-1)),e("div",Ln,[(n(!0),d(K,null,ee(P.value,(G,ge)=>(n(),d("div",{key:G.id,class:Q(["flex flex-col items-center relative z-10",{"ml-4":ge===0,"mr-4":ge===P.value.length-1}])},[e("div",{class:Q(["w-6 h-6 rounded-full shadow-lg flex items-center justify-center",{"bg-gray-300":G.status==="Not Started","bg-blue-500":G.status==="In Progress","bg-green-500":G.status==="Completed","bg-red-500":G.status==="Overdue"}])},[G.status==="Completed"?(n(),d("svg",Un,z[10]||(z[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):G.status==="In Progress"?(n(),d("svg",Nn,z[11]||(z[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))):G.status==="Overdue"?(n(),d("svg",Pn,z[12]||(z[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(n(),d("span",Rn))],2),e("div",Fn,[e("p",{class:"text-xs font-medium text-gray-700 text-center truncate",title:G.name},g(G.name),9,Bn)]),e("div",Hn,[e("p",Wn,g(G.completion_date?new Date(G.completion_date).toLocaleDateString():"No date"),1)])],2))),128))])])):(n(),d("div",On,z[9]||(z[9]=[e("p",{class:"text-gray-400 text-sm"},"No milestones found for this project.",-1)])))]),e("div",Yn,[e("div",zn,[e("div",qn,[p(W,{for:"status-filter",value:"Status"}),p(pe,{id:"status-filter",modelValue:y.status,"onUpdate:modelValue":z[0]||(z[0]=G=>y.status=G),options:h,"value-key":"value","label-key":"label",placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",Gn,[p(W,{for:"assigned-filter",value:"Assigned To"}),p(pe,{id:"assigned-filter",modelValue:y.assigned_to_user_id,"onUpdate:modelValue":z[1]||(z[1]=G=>y.assigned_to_user_id=G),options:M.value,"value-key":"value","label-key":"label",placeholder:"All Users",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Kn,[p(W,{for:"milestone-filter",value:"Milestone"}),p(pe,{id:"milestone-filter",modelValue:y.milestone_id,"onUpdate:modelValue":z[2]||(z[2]=G=>y.milestone_id=G),options:j.value,"value-key":"value","label-key":"label",placeholder:"All Milestones",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Jn,[p(W,{for:"due-date-filter",value:"Due Date"}),p(pe,{id:"due-date-filter",modelValue:y.due_date_range,"onUpdate:modelValue":z[3]||(z[3]=G=>y.due_date_range=G),options:O,"value-key":"value","label-key":"label",placeholder:"All Dates",class:"mt-1"},null,8,["modelValue"])]),e("div",{class:"flex items-end"},[e("button",{type:"button",onClick:L,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")])]),Object.values(y).some(G=>G!==null&&G!=="")?(n(),d("div",Zn,[e("p",null,[F(" Showing "+g(J.value.length)+" of "+g(i.value.length)+" tasks ",1),J.value.length===0?(n(),d("span",Xn," (No tasks match the current filters) ")):D("",!0)])])):D("",!0)]),a.value?(n(),d("div",Qn," Loading tasks... ")):u.value?(n(),d("div",eo,[e("p",to,g(u.value),1)])):i.value.length?(n(),d("div",so,[e("table",lo,[z[14]||(z[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned To"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Due Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Milestone"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ao,[(n(!0),d(K,null,ee(J.value,G=>(n(),d("tr",{key:G.id,class:"hover:bg-gray-50 transition-colors"},[e("td",io,g(G.title),1),e("td",no,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":G.status==="To Do","bg-blue-100 text-blue-800":G.status==="In Progress","bg-green-100 text-green-800":G.status==="Done","bg-red-100 text-red-800":G.status==="Blocked","bg-gray-100 text-gray-800":G.status==="Archived"})},g(G.status),3)]),e("td",oo,g(G.assigned_to),1),e("td",ro,g(G.due_date?G.due_date:"N/A"),1),e("td",uo,g(G.milestone||"N/A"),1),e("td",co,[e("div",mo,[e("button",{onClick:ge=>A(G),class:"text-purple-600 hover:text-purple-800 text-sm font-medium"}," View ",8,vo),e("button",{onClick:ge=>U(G),class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium"}," Edit ",8,po),e("button",{onClick:ge=>$(G),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Add Note ",8,ho),G.status==="To Do"?(n(),d("button",{key:0,onClick:ge=>Ve(G),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Start ",8,go)):D("",!0),G.status!=="Done"?(n(),d("button",{key:1,onClick:ge=>oe(G),class:"text-green-600 hover:text-green-800 text-sm font-medium"}," Complete ",8,yo)):D("",!0)])])]))),128))])])])):(n(),d("div",fo,z[15]||(z[15]=[e("p",{class:"text-gray-400 text-sm"},"No tasks found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add Task" button to create a new task. ',-1)]))),p($n,{show:r.value,"project-id":l.projectId,"selected-task":m.value,"project-users":l.projectUsers,"task-types":b.value,milestones:k.value,"loading-task-types":w.value,"loading-milestones":S.value,onClose:z[4]||(z[4]=G=>r.value=!1),onSaved:Z,onOpenAddMilestoneModal:_},null,8,["show","project-id","selected-task","project-users","task-types","milestones","loading-task-types","loading-milestones"]),p(zt,{show:c.value,"project-id":l.projectId,onClose:z[5]||(z[5]=G=>c.value=!1),onSaved:C},null,8,["show","project-id"]),p(qt,{show:v.value,"task-for-note":f.value,onClose:z[6]||(z[6]=G=>v.value=!1),onNoteAdded:H},null,8,["show","task-for-note"])]))}};function xt(l){const t=i=>{const a=/\[([^\]]+?)\][\s\u00A0]*\{([^}]+?)\}/g;return i.replace(a,(u,r,m)=>{let c=m.trim();return!c.startsWith("http://")&&!c.startsWith("https://")&&(c=`https://${c}`),`<a href="${c}" target="_blank" style="color: #1a73e8; text-decoration: underline;">${r.trim()}</a>`})},s=i=>{const a=/<(ul|ol)>(.*?)<\/(ul|ol)>/gs;return i.replace(a,(u,r,m)=>{const c=r,v=c==="ul"?"list-style-type: disc;":"list-style-type: decimal;",f=/<li>(.*?)<\/li>/gs,b=m.replace(f,(k,w)=>`<li style="margin-bottom: 5px; font-family: 'Inter', sans-serif; font-size: 16px; line-height: 1.6; color: #1a202c;">${w}</li>`);return`<${c} style="margin: 0; padding: 0 0 0 20px; ${v}">${b}</${c}>`})};return{processedHtmlBody:R(()=>{let i=l.value;return i=t(i),i=s(i),i})}}const _o={key:0},wo={class:"mb-4"},xo={class:"mb-6"},ko={class:"mb-2 flex justify-end space-x-2"},Do={class:"mb-2 flex justify-end space-x-2"},Co={key:1},$o={class:"mb-6"},So={class:"p-6"},Eo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Mo={class:"block sm:inline"},To={class:"mb-4"},jo={class:"mb-6"},Vo={class:"flex justify-end space-x-3"},Ao={class:"p-6"},Oo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Io={class:"block sm:inline"},Lo={class:"mb-4"},Uo={class:"mb-6"},No={class:"flex justify-end space-x-3"},Po={__name:"EmailActionModal",props:{show:{type:Boolean,default:!1},title:{type:String,required:!0},apiEndpoint:{type:String,required:!0},httpMethod:{type:String,default:"post"},initialFormData:{type:Object,default:()=>({})},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},emailId:{type:Number,required:!1},projectId:{type:Number,required:!0}},emits:["close","submitted","error","fetchEmails"],setup(l,{emit:t}){const s=l,o=t,i=ke({}),a=x(!1),u=x(""),r=x(""),m=x(""),c=x(!1),v=x(""),f=x("bullet"),b=x(""),k=R(()=>i.body||""),{processedHtmlBody:w}=xt(k);re(()=>s.show,T=>{if(T){for(const U in i)delete i[U];Object.assign(i,JSON.parse(JSON.stringify(s.initialFormData)))}},{immediate:!0});const S=T=>{const U={...T};return s.title==="Edit and Approve Email"&&(U.body=w.value),U},y=()=>{o("close")},h=T=>{o("submitted",T)},M=T=>{o("error",T)},j=()=>{u.value="",r.value="",m.value="",a.value=!0},O=()=>{if(!u.value.trim()){m.value="Link text cannot be empty.";return}let T=r.value.trim();!T.startsWith("http://")&&!T.startsWith("https://")&&(T="http://"+T);try{new URL(T)}catch{m.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const U=`[${u.value.trim()}] {${T}}`;i.body+=U,a.value=!1,u.value="",r.value="",m.value=""},P=()=>{v.value="",f.value="bullet",b.value="",c.value=!0},J=()=>{const T=v.value.split(`
`).map(A=>A.trim()).filter(A=>A!=="");if(T.length===0){b.value="Please enter at least one list item.";return}const U=f.value==="bullet"?"ul":"ol";let Z=`<${U}>`;T.forEach(A=>{Z+=`<li>${A}</li>`}),Z+=`</${U}>`,i.body+=Z,c.value=!1,v.value="",b.value=""},L=x({}),V=x(!1),I=async()=>{V.value=!0;try{await window.axios.post(`/api/emails/${s.emailId}/update`,{subject:i.subject,body:i.body}),typeof success=="function"?success("Email approved successfully!"):console.log("Email approved successfully!"),V.value=!1}catch(T){V.value=!1,T.response&&T.response.data.message?L.value=T.response.data.message:(L.value="Failed to approve email.",console.error("Error approving email directly:",T)),typeof T=="function"&&T(L.value)}},E=()=>{if(s.emailId){const T=`/emails/${s.emailId}/preview`;window.open(T,"_blank")}else console.warn("Cannot preview email: Email ID not available.")};return(T,U)=>(n(),d(K,null,[p(Ee,{show:l.show,title:l.title,"api-endpoint":l.apiEndpoint,"http-method":l.httpMethod,"form-data":i,"submit-button-text":l.submitButtonText,"success-message":l.successMessage,"format-data-for-api":S,onClose:y,onSubmitted:h,onError:M,"max-width":"3xl"},{default:N(({errors:Z})=>[l.title==="Edit and Approve Email"?(n(),d("div",_o,[e("div",wo,[p(W,{for:"edit_subject",value:"Subject"}),p(ne,{id:"edit_subject",type:"text",class:"mt-1 block w-full",modelValue:i.subject,"onUpdate:modelValue":U[0]||(U[0]=A=>i.subject=A),required:""},null,8,["modelValue"]),p(ae,{message:Z.subject?Z.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",xo,[e("div",ko,[p(ye,{type:"button",onClick:P},{default:N(()=>U[11]||(U[11]=[F(" Insert List ",-1)])),_:1,__:[11]}),p(ye,{type:"button",onClick:j},{default:N(()=>U[12]||(U[12]=[F(" Insert Link ",-1)])),_:1,__:[12]})]),p(W,{for:"edit_body",value:"Email Body",class:"sr-only"}),p(bt,{id:"edit_body",modelValue:i.body,"onUpdate:modelValue":U[1]||(U[1]=A=>i.body=A),placeholder:"Edit your email here...",height:"300px"},null,8,["modelValue"]),p(ae,{message:Z.body?Z.body[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Do,[p(ue,{type:"button",disabled:V.value,onClick:I},{default:N(()=>[F(g(V.value?"Saving...":"Save"),1)]),_:1},8,["disabled"]),p(ye,{type:"button",onClick:E},{default:N(()=>U[13]||(U[13]=[F(" Preview Email ",-1)])),_:1,__:[13]})])])):l.title==="Reject Email"?(n(),d("div",Co,[e("div",$o,[p(W,{for:"rejection_reason",value:"Rejection Reason"}),ce(e("textarea",{id:"rejection_reason",rows:"5",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":U[2]||(U[2]=A=>i.rejection_reason=A),required:"",placeholder:"Please provide a reason for rejecting this email (minimum 10 characters)"},null,512),[[fe,i.rejection_reason]]),p(ae,{message:Z.rejection_reason?Z.rejection_reason[0]:"",class:"mt-2"},null,8,["message"])])])):D("",!0)]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]),p(Se,{show:a.value,onClose:U[6]||(U[6]=Z=>a.value=!1),"max-width":"md"},{default:N(()=>[e("div",So,[U[16]||(U[16]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),m.value?(n(),d("div",Eo,[e("span",Mo,g(m.value),1)])):D("",!0),e("div",To,[p(W,{for:"link_text",value:"Link Text"}),p(ne,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:u.value,"onUpdate:modelValue":U[3]||(U[3]=Z=>u.value=Z),onKeyup:Ie(O,["enter"])},null,8,["modelValue"])]),e("div",jo,[p(W,{for:"link_url",value:"URL"}),p(ne,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:r.value,"onUpdate:modelValue":U[4]||(U[4]=Z=>r.value=Z),placeholder:"e.g., https://www.example.com",onKeyup:Ie(O,["enter"])},null,8,["modelValue"])]),e("div",Vo,[p(ye,{onClick:U[5]||(U[5]=Z=>a.value=!1)},{default:N(()=>U[14]||(U[14]=[F("Cancel",-1)])),_:1,__:[14]}),p(ue,{onClick:O},{default:N(()=>U[15]||(U[15]=[F("Insert",-1)])),_:1,__:[15]})])])]),_:1},8,["show"]),p(Se,{show:c.value,onClose:U[10]||(U[10]=Z=>c.value=!1),"max-width":"md"},{default:N(()=>[e("div",Ao,[U[20]||(U[20]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),b.value?(n(),d("div",Oo,[e("span",Io,g(b.value),1)])):D("",!0),e("div",Lo,[p(W,{for:"list_items",value:"List Items (one per line)"}),ce(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":U[7]||(U[7]=Z=>v.value=Z),placeholder:"Enter each list item on a new line"},null,512),[[fe,v.value]])]),e("div",Uo,[p(W,{for:"list_type",value:"List Type"}),ce(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":U[8]||(U[8]=Z=>f.value=Z)},U[17]||(U[17]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[We,f.value]])]),e("div",No,[p(ye,{onClick:U[9]||(U[9]=Z=>c.value=!1)},{default:N(()=>U[18]||(U[18]=[F("Cancel",-1)])),_:1,__:[18]}),p(ue,{onClick:J},{default:N(()=>U[19]||(U[19]=[F("Insert List",-1)])),_:1,__:[19]})])])]),_:1},8,["show"])],64))}},Ro=Ce(Po,[["__scopeId","data-v-53db9e10"]]);function Fo(l){const t=Le();return{userSignature:R(()=>{const o=t.value&&t.value.name?t.value.name:"",i=l.name??"",a="+61 456 639 389",u="ozeeweb.com.au",r="#1a73e8",m="#fbbc05",c="#1a202c",v="#4a5568",f="#e5e7eb",b="#f9fafb",k=`${window.location.origin}/logo.png`,w=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/facebook-new.png`,S=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/twitter.png`,y=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/linkedin.png`,h=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/instagram-new.png`;return`
            <div style="font-family: 'Inter', sans-serif; padding: 20px; border: 1px solid ${f}; margin-top: 30px; background-color: ${b}; border-radius: 8px; overflow: hidden; box-shadow: 0 0 0 3px ${m};">
                <table role="presentation" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td style="vertical-align: middle;">
                            <p style="margin: 0; font-size: 18px; color: ${c};">Best Regards</p>
                            <p style="margin: 0; font-size: 18px; font-weight: bold; color: ${c};">${o}</p>
                            <p style="margin: 5px 0 5px 0; font-size: 14px; color: ${v};">${i}</p>
                            <p style="margin: 0 0 15px 0; font-size: 12px; color: ${v};">
                                Your website and social media are like your home, first impressions matter!
                            </p>
                            <table role="presentation" cellspacing="0" cellpadding="0">
                                <tr>
                                    <td style="padding-right: 15px;">
                                        <p style="margin: 0; font-size: 13px; color: ${v};">📞 ${a}</p>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: ${v};">🌐 <a href="https://${u}" target="_blank" style="color: ${r}; text-decoration: none;">${u}</a></p>
                                    </td>
                                </tr>
                            </table>
                            <div style="margin-top: 15px; text-align: left;">
                                <a href="https://www.facebook.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${w}" alt="Facebook" style="vertical-align: middle;">
                                </a>
                                <a href="https://twitter.com/yourhandle" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${S}" alt="Twitter" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.linkedin.com/in/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${y}" alt="LinkedIn" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.instagram.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${h}" alt="Instagram" style="vertical-align: middle;">
                                </a>
                            </div>
                        </td>
                        <td style="padding-left: 20px; vertical-align: middle; width: 120px; text-align: right;">
                            <img src="${k}" alt="Company Logo" width="100" style="display: block; border-radius: 8px; margin-left: auto;">
                        </td>
                    </tr>
                </table>

                <p style="margin-top: 25px; font-size: 12px; color: ${v}; text-align: center;">
                    Powered by MMS IT & Web Solutions PTY Ltd.
                </p>
                <p style="margin-top: 10px; font-style: italic; color: ${v}; text-align: center; font-size: 13px;">
                    Please consider the environment before printing this email.
                </p>
                <p style="margin-top: 10px; text-align: center; font-size: 13px;">
                    How did I do? <a href="https://www.example.com/review" target="_blank" style="color: ${r}; text-decoration: none; font-weight: bold;">Leave a review!</a>
                </p>
            </div>
        `})}}const Bo={class:"mb-4"},Ho={key:0,class:"text-gray-500 text-sm"},Wo={key:1,class:"text-red-500 text-sm"},Yo={class:"mb-4"},zo={class:"mb-6"},qo={class:"mb-2 flex justify-end space-x-2"},Go={class:"mb-4"},Ko={key:0,class:"mt-2"},Jo={class:"text-gray-700 text-base mb-2"},Zo=["innerHTML"],Xo={class:"p-6"},Qo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},er={class:"block sm:inline"},tr={class:"mb-4"},sr={class:"mb-6"},lr={class:"flex justify-end space-x-3"},ar={class:"p-6"},ir={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},nr={class:"block sm:inline"},or={class:"mb-4"},rr={class:"mb-6"},dr={class:"flex justify-end space-x-3"},ur={__name:"ComponseEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},userProjectRole:{type:Object,required:!0}},emits:["close","submitted","error"],setup(l,{emit:t}){const s=l,o=t,i=ke({project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),a=x([]),u=x(!0),r=x(""),m=x(!1),c=x(""),v=x(""),f=x(""),b=x(!1),k=x(""),w=x("bullet"),S=x(""),y=x("full_name"),h=x(""),M=x([{value:"full_name",label:"Full Name"},{value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"custom",label:"Custom"}]),{userSignature:j}=Fo(R(()=>s.userProjectRole)),O=R(()=>i.body||""),{processedHtmlBody:P}=xt(O),J=R(()=>{if(i.client_ids&&i.client_ids.length>0){const C=i.client_ids[0],$=a.value.find(H=>H.id===C);if($){const H=$.name.split(" ").filter(X=>X.length>0),oe=H.length>0?H[0]:"",Ve=H.length>1?H[H.length-1]:"";switch(y.value){case"full_name":return`Hi ${$.name},`;case"first_name":return`Hi ${oe},`;case"last_name":return`Hi ${Ve},`;case"custom":return`Hi ${h.value.trim()||"there"},`;default:return`Hi ${$.name},`}}}return"Hi there,"});re(()=>s.show,C=>{C&&(Object.assign(i,{project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),y.value="full_name",h.value="",r.value="",_())},{immediate:!0});const L=C=>{const $={...C};return $.client_ids&&Array.isArray($.client_ids)&&($.client_ids=$.client_ids.map(H=>({id:H}))),$.body=P.value,$.greeting_name=J.value,$.custom_greeting_name=h.value.trim(),$.first_client_id=i.client_ids&&i.client_ids.length>0?i.client_ids[0]:null,$},V=()=>{o("close")},I=C=>{o("submitted",C)},E=C=>{o("error",C)},T=()=>{c.value="",v.value="",f.value="",m.value=!0},U=()=>{if(!c.value.trim()){f.value="Link text cannot be empty.";return}let C=v.value.trim();!C.startsWith("http://")&&!C.startsWith("https://")&&(C="http://"+C);try{new URL(C)}catch{f.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const $=`[${c.value.trim()}] {${C}}`;i.body+=$,m.value=!1,c.value="",v.value="",f.value=""},Z=()=>{k.value="",w.value="bullet",S.value="",b.value=!0},A=()=>{const C=k.value.split(`
`).map(oe=>oe.trim()).filter(oe=>oe!=="");if(C.length===0){S.value="Please enter at least one list item.";return}const $=w.value==="bullet"?"ul":"ol";let H=`<${$}>`;C.forEach(oe=>{H+=`<li>${oe}</li>`}),H+=`</${$}>`,i.body+=H,b.value=!1,k.value="",S.value=""},_=async()=>{var C,$;u.value=!0,r.value=null;try{const H=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);a.value=H.data}catch(H){console.error("Failed to fetch project clients:",H),r.value=(($=(C=H.response)==null?void 0:C.data)==null?void 0:$.message)||"Failed to load client data."}finally{u.value=!1}};return be(()=>{}),(C,$)=>(n(),d(K,null,[p(Ee,{show:l.show,title:"Compose New Email","api-endpoint":"/api/emails","http-method":"post","form-data":i,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","format-data-for-api":L,onClose:V,onSubmitted:I,onError:E,"max-width":"3xl"},{default:N(({errors:H})=>[e("div",Bo,[p(W,{for:"client_ids",value:"To (Clients)"}),u.value?(n(),d("div",Ho,"Loading clients...")):r.value?(n(),d("div",Wo,g(r.value),1)):(n(),le(He,{key:2,modelValue:i.client_ids,"onUpdate:modelValue":$[0]||($[0]=oe=>i.client_ids=oe),options:a.value,placeholder:"Select one or more clients","label-key":"name","value-key":"id"},null,8,["modelValue","options"])),p(ae,{message:H.client_ids?H.client_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Yo,[p(W,{for:"subject",value:"Subject"}),p(ne,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:i.subject,"onUpdate:modelValue":$[1]||($[1]=oe=>i.subject=oe),required:""},null,8,["modelValue"]),p(ae,{message:H.subject?H.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",zo,[e("div",qo,[p(ye,{type:"button",onClick:Z},{default:N(()=>$[13]||($[13]=[F(" Insert List ",-1)])),_:1,__:[13]}),p(ye,{type:"button",onClick:T},{default:N(()=>$[14]||($[14]=[F(" Insert Link ",-1)])),_:1,__:[14]})]),e("div",Go,[p(W,{for:"greeting_type",value:"Address Client By"}),p(pe,{id:"greeting_type",modelValue:y.value,"onUpdate:modelValue":$[2]||($[2]=oe=>y.value=oe),options:M.value,"value-key":"value","label-key":"label",class:"mt-1 block w-full"},null,8,["modelValue","options"]),y.value==="custom"?(n(),d("div",Ko,[p(W,{for:"custom_greeting_name",value:"Custom Name"}),p(ne,{id:"custom_greeting_name",type:"text",class:"mt-1 block w-full",modelValue:h.value,"onUpdate:modelValue":$[3]||($[3]=oe=>h.value=oe),placeholder:"e.g., Azaan"},null,8,["modelValue"])])):D("",!0)]),e("p",Jo,g(J.value),1),p(W,{for:"body",value:"Email Body",class:"sr-only"}),p(bt,{id:"body",modelValue:i.body,"onUpdate:modelValue":$[4]||($[4]=oe=>i.body=oe),placeholder:"Compose your email here...",height:"300px"},null,8,["modelValue"]),p(ae,{message:H.body?H.body[0]:"",class:"mt-2"},null,8,["message"])]),q(j)?(n(),d("div",{key:0,class:"unselectable-signature",innerHTML:q(j)},null,8,Zo)):D("",!0)]),_:1},8,["show","form-data"]),p(Se,{show:m.value,onClose:$[8]||($[8]=H=>m.value=!1),"max-width":"md"},{default:N(()=>[e("div",Xo,[$[17]||($[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),f.value?(n(),d("div",Qo,[e("span",er,g(f.value),1)])):D("",!0),e("div",tr,[p(W,{for:"link_text",value:"Link Text"}),p(ne,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:c.value,"onUpdate:modelValue":$[5]||($[5]=H=>c.value=H),onKeyup:Ie(U,["enter"])},null,8,["modelValue"])]),e("div",sr,[p(W,{for:"link_url",value:"URL"}),p(ne,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:v.value,"onUpdate:modelValue":$[6]||($[6]=H=>v.value=H),placeholder:"e.g., https://www.example.com",onKeyup:Ie(U,["enter"])},null,8,["modelValue"])]),e("div",lr,[p(ye,{onClick:$[7]||($[7]=H=>m.value=!1)},{default:N(()=>$[15]||($[15]=[F("Cancel",-1)])),_:1,__:[15]}),p(ue,{onClick:U},{default:N(()=>$[16]||($[16]=[F("Insert",-1)])),_:1,__:[16]})])])]),_:1},8,["show"]),p(Se,{show:b.value,onClose:$[12]||($[12]=H=>b.value=!1),"max-width":"md"},{default:N(()=>[e("div",ar,[$[21]||($[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),S.value?(n(),d("div",ir,[e("span",nr,g(S.value),1)])):D("",!0),e("div",or,[p(W,{for:"list_items",value:"List Items (one per line)"}),ce(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":$[9]||($[9]=H=>k.value=H),placeholder:"Enter each list item on a new line"},null,512),[[fe,k.value]])]),e("div",rr,[p(W,{for:"list_type",value:"List Type"}),ce(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":$[10]||($[10]=H=>w.value=H)},$[18]||($[18]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[We,w.value]])]),e("div",dr,[p(ye,{onClick:$[11]||($[11]=H=>b.value=!1)},{default:N(()=>$[19]||($[19]=[F("Cancel",-1)])),_:1,__:[19]}),p(ue,{onClick:A},{default:N(()=>$[20]||($[20]=[F("Insert List",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])],64))}},kt=Ce(ur,[["__scopeId","data-v-70bf1503"]]),cr={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},mr={class:"flex justify-between items-center mb-4"},vr={key:0,class:"flex gap-3"},pr={key:1,class:"mt-2 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative",role:"alert"},hr={class:"block sm:inline"},gr={class:"mb-4 bg-gray-50 p-4 rounded-lg"},yr={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},fr={class:"mt-1 relative rounded-md shadow-sm"},br={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},_r={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},wr={key:2,class:"overflow-x-auto"},xr={class:"min-w-full divide-y divide-gray-200"},kr={class:"bg-white divide-y divide-gray-200"},Dr={class:"px-4 py-3 text-sm text-gray-900"},Cr={class:"px-4 py-3 text-sm text-gray-700"},$r={class:"px-4 py-3 text-sm text-gray-700"},Sr={class:"px-4 py-3 text-sm text-gray-700"},Er={class:"px-4 py-3 text-sm text-gray-700"},Mr={class:"px-4 py-3 text-right"},Tr={key:3,class:"text-gray-400 text-sm"},jr={class:"p-6"},Vr={class:"flex justify-between items-center mb-4"},Ar={key:0,class:"space-y-4"},Or={class:"border-b pb-4"},Ir={class:"text-xl font-medium text-gray-900 mb-2"},Lr={class:"grid grid-cols-2 gap-4 text-sm"},Ur={class:"text-gray-600"},Nr={class:"text-gray-900"},Pr={class:"text-gray-600 mt-1"},Rr={class:"text-gray-600"},Fr={class:"text-gray-900"},Br={class:"prose max-w-none"},Hr=["innerHTML"],Wr={key:0,class:"mt-4 p-4 bg-red-50 rounded-md"},Yr={class:"text-red-700"},zr={key:1,class:"mt-4 text-sm text-gray-600"},qr={key:0},Gr={key:2,class:"mt-6 flex justify-end space-x-2"},Kr={__name:"ProjectEmailsTab",props:{projectId:{type:Number,required:!0},canViewEmails:{type:Boolean,required:!0},canComposeEmails:{type:Boolean,required:!0},canApproveEmails:{type:Boolean,required:!0},userProjectRole:{type:Object,required:!0},openCompose:{type:Boolean,required:!1,default:!1}},emits:["emailsUpdated","resetOpenCompose"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(""),r=x(null),m=x(!1),c=x(!1),v=x(""),f=x(""),b=x("post"),k=x(""),w=x(""),S=ke({}),y=x(!1);Le();const h=ke({type:"",startDate:"",endDate:"",search:""});let M=null;const j=()=>{J()},O=()=>{h.type="",h.startDate="",h.endDate="",h.search="",J()},P=()=>{clearTimeout(M),M=setTimeout(()=>{j()},500)},J=async()=>{a.value=!0,u.value="";try{const A=new URLSearchParams;h.type&&A.append("type",h.type),h.startDate&&A.append("start_date",h.startDate),h.endDate&&A.append("end_date",h.endDate),h.search&&A.append("search",h.search);const _=A.toString(),C=`/api/projects/${s.projectId}/emails-simplified${_?`?${_}`:""}`,$=await window.axios.get(C);i.value=$.data,o("emailsUpdated",i.value)}catch(A){u.value="Failed to load email data.",console.error("Error fetching project emails:",A)}finally{a.value=!1}},L=A=>{r.value=A,m.value=!0},V=A=>{r.value=A,v.value="Edit and Approve Email",f.value=`/api/emails/${A.id}/edit-and-approve`,b.value="post",k.value="Approve & Send",w.value="Email updated and approved successfully!";let _=A.body||"";Object.assign(S,{subject:A.subject,body:_}),c.value=!0,m.value=!1},I=A=>{r.value=A,v.value="Reject Email",f.value=`/api/emails/${A.id}/reject`,b.value="post",k.value="Reject Email",w.value="Email rejected successfully!",Object.assign(S,{rejection_reason:""}),c.value=!0,m.value=!1},E=async A=>{console.log("Form submitted successfully:",A),await J(),c.value=!1},T=()=>{c.value=!1},U=()=>{y.value=!1,o("resetOpenCompose")},Z=async A=>{console.log("Compose email submitted successfully:",A),await J(),y.value=!1,o("resetOpenCompose")};return re(()=>s.openCompose,A=>{console.log("Watcher triggered: openCompose changed to",A),A&&(console.log("Opening compose email modal"),y.value=!0)}),be(()=>{s.canViewEmails&&J(),s.openCompose&&(y.value=!0)}),(A,_)=>{var C;return l.canViewEmails?(n(),d("div",cr,[e("div",mr,[_[12]||(_[12]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Email Communication",-1)),l.canComposeEmails?(n(),d("div",vr,[p(ue,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:_[0]||(_[0]=$=>y.value=!0)},{default:N(()=>_[11]||(_[11]=[F(" Compose Email ",-1)])),_:1,__:[11]})])):D("",!0),u.value?(n(),d("div",pr,[e("span",hr,g(u.value),1)])):D("",!0)]),e("div",gr,[e("div",yr,[e("div",null,[p(W,{for:"typeFilter",value:"Type"}),ce(e("select",{id:"typeFilter","onUpdate:modelValue":_[1]||(_[1]=$=>h.type=$),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:j},_[13]||(_[13]=[e("option",{value:""},"All Types",-1),e("option",{value:"sent"},"Sent",-1),e("option",{value:"received"},"Received",-1)]),544),[[We,h.type]])]),e("div",null,[p(W,{for:"startDate",value:"From Date"}),p(ne,{type:"date",id:"startDate",modelValue:h.startDate,"onUpdate:modelValue":_[2]||(_[2]=$=>h.startDate=$),class:"mt-1 block w-full",onChange:j},null,8,["modelValue"])]),e("div",null,[p(W,{for:"endDate",value:"To Date"}),p(ne,{type:"date",id:"endDate",modelValue:h.endDate,"onUpdate:modelValue":_[3]||(_[3]=$=>h.endDate=$),class:"mt-1 block w-full",onChange:j},null,8,["modelValue"])]),e("div",null,[p(W,{for:"searchFilter",value:"Search Content"}),e("div",fr,[p(ne,{type:"text",id:"searchFilter",modelValue:h.search,"onUpdate:modelValue":_[4]||(_[4]=$=>h.search=$),class:"block w-full pr-10",placeholder:"Search in email content...",onInput:P},null,8,["modelValue"]),_[14]||(_[14]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:O}," Reset Filters ")])]),a.value?(n(),d("div",br," Loading email data... ")):u.value?(n(),d("div",_r,g(u.value),1)):i.value.length?(n(),d("div",wr,[e("table",xr,[_[16]||(_[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",kr,[(n(!0),d(K,null,ee(i.value,$=>{var H;return n(),d("tr",{key:$.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Dr,g($.subject),1),e("td",Cr,g(((H=$.sender)==null?void 0:H.name)||"N/A"),1),e("td",$r,g(new Date($.created_at).toLocaleDateString()),1),e("td",Sr,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":$.type==="sent","bg-purple-100 text-purple-800":$.type==="received"})},g($.type?$.type.toUpperCase():"N/A"),3)]),e("td",Er,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":$.status==="sent","bg-yellow-100 text-yellow-800":$.status==="pending_approval","bg-blue-200 text-blue-900":$.status==="pending_approval_received","bg-red-100 text-red-800":$.status==="rejected","bg-gray-100 text-gray-800":$.status==="draft"})},g($.status.replace("_"," ").toUpperCase()),3)]),e("td",Mr,[p(ye,{class:"text-indigo-600 hover:text-indigo-800",onClick:oe=>L($)},{default:N(()=>_[15]||(_[15]=[F(" View ",-1)])),_:2,__:[15]},1032,["onClick"])])])}),128))])])])):(n(),d("p",Tr,"No email communication found.")),p(Se,{show:m.value,onClose:_[8]||(_[8]=$=>m.value=!1)},{default:N(()=>{var $;return[e("div",jr,[e("div",Vr,[_[18]||(_[18]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Email Details",-1)),e("button",{onClick:_[5]||(_[5]=H=>m.value=!1),class:"text-gray-400 hover:text-gray-500"},_[17]||(_[17]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),r.value?(n(),d("div",Ar,[e("div",Or,[e("h4",Ir,g(r.value.subject),1),e("div",Lr,[e("div",null,[e("p",Ur,[_[19]||(_[19]=F("From: ",-1)),e("span",Nr,g((($=r.value.sender)==null?void 0:$.name)||"N/A"),1)]),e("p",Pr,[_[20]||(_[20]=F("Status: ",-1)),e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":r.value.status==="sent","bg-yellow-100 text-yellow-800":r.value.status==="pending_approval","bg-red-100 text-red-800":r.value.status==="rejected","bg-gray-100 text-gray-800":r.value.status==="draft"})},g(r.value.status.replace("_"," ").toUpperCase()),3)])]),e("div",null,[e("p",Rr,[_[21]||(_[21]=F("Date: ",-1)),e("span",Fr,g(new Date(r.value.created_at).toLocaleString()),1)])])])]),e("div",Br,[e("div",{innerHTML:r.value.body},null,8,Hr)]),r.value.rejection_reason?(n(),d("div",Wr,[_[22]||(_[22]=e("h5",{class:"font-medium text-red-800"},"Rejection Reason:",-1)),e("p",Yr,g(r.value.rejection_reason),1)])):D("",!0),r.value.approver?(n(),d("div",zr,[e("p",null,"Approved/Rejected by: "+g(r.value.approver.name),1),r.value.sent_at?(n(),d("p",qr,"Sent at: "+g(new Date(r.value.sent_at).toLocaleString()),1)):D("",!0)])):D("",!0),(r.value.status==="pending_approval"||r.value.status==="pending_approval_received")&&l.canApproveEmails?(n(),d("div",Gr,[p(ue,{onClick:_[6]||(_[6]=H=>V(r.value)),class:"bg-blue-600 hover:bg-blue-700"},{default:N(()=>_[23]||(_[23]=[F("Edit & Approve",-1)])),_:1,__:[23]}),p(ye,{onClick:_[7]||(_[7]=H=>I(r.value)),class:"text-red-600 hover:text-red-800"},{default:N(()=>_[24]||(_[24]=[F("Reject",-1)])),_:1,__:[24]})])):D("",!0)])):D("",!0)])]}),_:1},8,["show"]),p(kt,{show:y.value,"project-id":l.projectId,"user-project-role":l.userProjectRole,onClose:U,onSubmitted:Z,onError:_[9]||(_[9]=$=>console.error("ComposeEmailModal error:",$))},null,8,["show","project-id","user-project-role"]),p(Ro,{show:c.value,title:v.value,"api-endpoint":f.value,"http-method":b.value,"initial-form-data":S,"submit-button-text":k.value,"success-message":w.value,"email-id":(C=r.value)==null?void 0:C.id,"project-id":l.projectId,onClose:T,onSubmitted:E,onError:_[10]||(_[10]=$=>console.error("EmailActionModal error:",$))},null,8,["show","title","api-endpoint","http-method","initial-form-data","submit-button-text","success-message","email-id","project-id"])])):D("",!0)}}},Jr={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Zr={class:"flex justify-between items-center mb-4"},Xr={class:"flex gap-3"},Qr={class:"mb-4 bg-gray-50 p-4 rounded-lg"},ed={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},td={class:"mt-1 relative rounded-md shadow-sm"},sd={class:"mb-8 p-4 bg-blue-50 rounded-md"},ld={class:"flex items-center"},ad={class:"text-sm text-blue-800"},id={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},nd={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},od={key:2,class:"space-y-4"},rd={class:"flex justify-between"},dd={class:"flex-grow"},ud={key:0,class:"text-xs text-red-400 block mt-1"},cd={class:"flex items-center mt-1"},md={class:"text-xs text-gray-500"},vd={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},pd={key:0},hd={key:3,class:"text-gray-400 text-sm"},gd={class:"p-6"},yd={class:"flex justify-between items-center mb-4"},fd={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},bd={class:"text-sm text-gray-700"},_d={class:"text-xs text-gray-500 mt-1"},wd={key:1,class:"mb-4"},xd={key:0,class:"text-center py-4"},kd={key:1,class:"space-y-3 max-h-60 overflow-y-auto"},Dd={class:"text-sm text-gray-700"},Cd={class:"text-xs text-gray-500 mt-1"},$d={key:2,class:"text-center py-3"},Sd={key:2,class:"mb-4"},Ed={key:0,class:"mt-2 text-sm text-red-600"},Md={key:3,class:"mt-6 flex justify-end"},Td={__name:"ProjectNotesTab",props:{projectId:{type:Number,required:!0},googleChatId:{type:String,default:null},canViewNotes:{type:Boolean,required:!0},canAddNotes:{type:Boolean,required:!0}},emits:["notesUpdated"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(""),r=x(!1),m=x(!1),c=x(null),v=x(""),f=x(""),b=x([]),k=x(!1),w=ke({startDate:"",endDate:"",search:""});let S=null;const y=async()=>{a.value=!0,u.value="";try{const L=new URLSearchParams;w.startDate&&L.append("start_date",w.startDate),w.endDate&&L.append("end_date",w.endDate),w.search&&L.append("search",w.search);const V=L.toString(),I=`/api/projects/${s.projectId}/notes${V?`?${V}`:""}`,E=await window.axios.get(I);i.value=E.data,o("notesUpdated",i.value)}catch(L){u.value="Failed to load notes data.",console.error("Error fetching project notes:",L)}finally{a.value=!1}},h=()=>{r.value=!0},M=async L=>{c.value=L,v.value="",f.value="",b.value=[],k.value=!0,m.value=!0;try{const V=await window.axios.get(`/api/projects/${s.projectId}/notes/${L.id}/replies`);V.data.success?b.value=V.data.replies:console.error("Failed to fetch replies:",V.data.message)}catch(V){console.error("Error fetching replies:",V)}finally{k.value=!1}},j=async()=>{var L,V;if(!c.value||!v.value.trim()){f.value="Reply content is required";return}f.value="";try{const I=await window.axios.post(`/api/projects/${s.projectId}/notes/${c.value.id}/reply`,{content:v.value});if(I.data.success){v.value="",k.value=!0;const E=await window.axios.get(`/api/projects/${s.projectId}/notes/${c.value.id}/replies`);E.data.success&&(b.value=E.data.replies),k.value=!1,await y()}else f.value=I.data.message||"Failed to send reply"}catch(I){console.error("Error sending reply:",I),f.value=((V=(L=I.response)==null?void 0:L.data)==null?void 0:V.message)||"An error occurred while sending the reply"}},O=()=>{y()},P=()=>{w.startDate="",w.endDate="",w.search="",y()},J=()=>{clearTimeout(S),S=setTimeout(()=>{O()},500)};return be(()=>{s.canViewNotes&&y()}),(L,V)=>l.canViewNotes?(n(),d("div",Jr,[e("div",Zr,[V[10]||(V[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Notes",-1)),e("div",Xr,[l.canAddNotes?(n(),le(ue,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:h},{default:N(()=>V[9]||(V[9]=[F(" Add Note ",-1)])),_:1,__:[9]})):D("",!0)])]),e("div",Qr,[e("div",ed,[e("div",null,[p(W,{for:"noteStartDate",value:"From Date"}),p(ne,{type:"date",id:"noteStartDate",modelValue:w.startDate,"onUpdate:modelValue":V[0]||(V[0]=I=>w.startDate=I),class:"mt-1 block w-full",onChange:O},null,8,["modelValue"])]),e("div",null,[p(W,{for:"noteEndDate",value:"To Date"}),p(ne,{type:"date",id:"noteEndDate",modelValue:w.endDate,"onUpdate:modelValue":V[1]||(V[1]=I=>w.endDate=I),class:"mt-1 block w-full",onChange:O},null,8,["modelValue"])]),e("div",null,[p(W,{for:"noteSearchFilter",value:"Search Content"}),e("div",td,[p(ne,{type:"text",id:"noteSearchFilter",modelValue:w.search,"onUpdate:modelValue":V[2]||(V[2]=I=>w.search=I),class:"block w-full pr-10",placeholder:"Search in note content...",onInput:J},null,8,["modelValue"]),V[11]||(V[11]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:P}," Reset Filters ")])]),e("div",sd,[e("div",ld,[V[13]||(V[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",ad,[V[12]||(V[12]=F(" Daily Standups are now available in their own dedicated tab. ",-1)),e("button",{onClick:V[3]||(V[3]=I=>L.$emit("changeTab","standups")),class:"text-blue-600 hover:text-blue-800 font-medium underline"}," Click here to view Daily Standups ")])])]),e("div",null,[V[15]||(V[15]=e("h5",{class:"text-md font-semibold text-gray-900 mb-4 border-b pb-2"},"Notes",-1)),a.value?(n(),d("div",id," Loading notes... ")):u.value?(n(),d("div",nd,g(u.value),1)):i.value.length?(n(),d("div",od,[(n(!0),d(K,null,ee(i.value,I=>{var E;return n(),d("div",{key:I.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",rd,[e("div",dd,[e("p",{class:Q(["text-sm",{"text-gray-700":I.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":I.content==="[Encrypted content could not be decrypted]"}])},[F(g(I.content)+" ",1),I.content==="[Encrypted content could not be decrypted]"?(n(),d("span",ud," (There was an issue decrypting this note. Please contact an administrator.) ")):D("",!0)],2),e("div",cd,[e("p",md,"Added by "+g(((E=I.user)==null?void 0:E.name)||"Unknown")+" on "+g(new Date(I.created_at).toLocaleDateString()),1),I.reply_count>0?(n(),d("span",vd,g(I.reply_count)+" "+g(I.reply_count===1?"reply":"replies"),1)):D("",!0)])]),l.googleChatId&&I.chat_message_id?(n(),d("div",pd,[p(ye,{class:"text-sm text-indigo-600 hover:text-indigo-800",onClick:T=>M(I)},{default:N(()=>V[14]||(V[14]=[F(" View ",-1)])),_:2,__:[14]},1032,["onClick"])])):D("",!0)])])}),128))])):(n(),d("p",hd,"No notes available."))]),p(ft,{show:r.value,"project-id":l.projectId,onClose:V[4]||(V[4]=I=>r.value=!1),onNoteAdded:y},null,8,["show","project-id"]),p(Se,{show:m.value,onClose:V[8]||(V[8]=I=>m.value=!1)},{default:N(()=>{var I;return[e("div",gd,[e("div",yd,[V[17]||(V[17]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Reply to Note",-1)),e("button",{onClick:V[5]||(V[5]=E=>m.value=!1),class:"text-gray-400 hover:text-gray-500"},V[16]||(V[16]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),c.value?(n(),d("div",fd,[e("p",bd,g(c.value.content),1),e("p",_d,"Added by "+g(((I=c.value.user)==null?void 0:I.name)||"Unknown")+" on "+g(new Date(c.value.created_at).toLocaleDateString()),1)])):D("",!0),c.value?(n(),d("div",wd,[V[20]||(V[20]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Replies",-1)),k.value?(n(),d("div",xd,V[18]||(V[18]=[e("p",{class:"text-gray-500 text-sm"},"Loading replies...",-1)]))):b.value.length?(n(),d("div",kd,[(n(!0),d(K,null,ee(b.value,E=>{var T;return n(),d("div",{key:E.id,class:"p-2 bg-gray-50 rounded border-l-2 border-indigo-300"},[e("p",Dd,g(E.content),1),e("p",Cd,"Replied by "+g(((T=E.user)==null?void 0:T.name)||"Unknown")+" on "+g(new Date(E.created_at).toLocaleDateString()),1)])}),128))])):(n(),d("div",$d,V[19]||(V[19]=[e("p",{class:"text-gray-500 text-sm"},"No replies yet. Be the first to reply!",-1)])))])):D("",!0),l.canAddNotes?(n(),d("div",Sd,[p(W,{for:"reply-content",value:"Your Reply"}),ce(e("textarea",{id:"reply-content","onUpdate:modelValue":V[6]||(V[6]=E=>v.value=E),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your reply..."},null,512),[[fe,v.value]]),f.value?(n(),d("p",Ed,g(f.value),1)):D("",!0)])):D("",!0),l.canAddNotes?(n(),d("div",Md,[p(ye,{onClick:V[7]||(V[7]=E=>m.value=!1),class:"mr-2"},{default:N(()=>V[21]||(V[21]=[F("Cancel",-1)])),_:1,__:[21]}),p(ue,{onClick:j},{default:N(()=>V[22]||(V[22]=[F("Send Reply",-1)])),_:1,__:[22]})])):D("",!0)])]}),_:1},8,["show"])])):D("",!0)}},jd={class:"w-full"},Vd={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Ad={key:1,class:"text-red-600 text-sm py-2 text-center"},Od={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Id={class:"p-4 bg-blue-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Ld={class:"text-2xl font-bold text-blue-900 mt-1"},Ud={class:"p-4 bg-green-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Nd={class:"text-2xl font-bold text-green-900 mt-1"},Pd={class:"p-4 bg-red-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Rd={class:"text-2xl font-bold mt-1"},Fd={key:3,class:"space-y-2 text-sm text-gray-700 mt-6 pt-4 border-t border-gray-200"},Bd={key:0},Hd={class:"text-gray-900 whitespace-pre-wrap"},Wd={key:4,class:"text-gray-400 text-sm mt-4 text-center"},Yd={__name:"ProjectFinancialsCard",props:{projectId:{type:Number,required:!0},canViewProjectServicesAndPayments:{type:Boolean,default:!1},canViewProjectTransactions:{type:Boolean,default:!1}},setup(l){const t=l,s=x(null),o=x([]),i=x(!0),a=x(null),u=Be,r=R(()=>{var k;if(!he.value||Object.keys(he.value).length===0)return 0;const b=parseFloat(((k=s.value)==null?void 0:k.total_amount)||0);return Oe(b,"USD",u.value)}),m=R(()=>!o.value.length||!he.value||Object.keys(he.value).length===0?0:o.value.filter(b=>b.type==="expense").reduce((b,k)=>b+Oe(parseFloat(k.amount||0),k.currency,u.value),0)),c=R(()=>!o.value.length||!he.value||Object.keys(he.value).length===0?0:o.value.filter(b=>b.type==="income").reduce((b,k)=>b+Oe(parseFloat(k.amount||0),k.currency,u.value),0)),v=R(()=>c.value-m.value),f=async()=>{var b,k;if(i.value=!0,a.value=null,o.value=[],!he.value||Object.keys(he.value).length===0){a.value="Currency rates not loaded. Please try again.",i.value=!1;return}if(!t.canViewProjectServicesAndPayments&&!t.canViewProjectTransactions){a.value="You don't have permission to view project financials.",i.value=!1;return}try{if(t.canViewProjectServicesAndPayments){const w=await window.axios.get(`/api/projects/${t.projectId}/sections/services-payment`);s.value=w.data}else s.value=null;if(t.canViewProjectTransactions){const w=await window.axios.get(`/api/projects/${t.projectId}/sections/transactions`);o.value=w.data}else o.value=[]}catch(w){console.error("Failed to fetch project financials:",w),a.value=((k=(b=w.response)==null?void 0:b.data)==null?void 0:k.message)||"Failed to load financial data."}finally{i.value=!1}};return re([()=>t.canViewProjectServicesAndPayments,()=>t.canViewProjectTransactions,u,he],(b,k)=>{t.projectId&&he.value&&Object.keys(he.value).length>0?f():t.projectId||(i.value=!0,a.value=null)},{immediate:!0,deep:!0}),(b,k)=>{var w,S;return n(),d("div",jd,[i.value?(n(),d("div",Vd,[(n(),d(K,null,ee(4,y=>e("div",{key:y,class:"p-4 bg-gray-100 rounded-lg animate-pulse h-24"},k[0]||(k[0]=[e("div",{class:"h-4 bg-gray-200 rounded w-1/2 mb-3"},null,-1),e("div",{class:"h-6 bg-gray-200 rounded w-3/4"},null,-1)]))),64))])):a.value?(n(),d("div",Ad,[e("p",null,g(a.value),1)])):(n(),d("div",Od,[e("div",Id,[k[1]||(k[1]=e("p",{class:"text-sm font-medium text-blue-800"},"Contract Value",-1)),e("p",Ld,g(q(je)(r.value,q(u).value)),1)]),e("div",Ud,[k[2]||(k[2]=e("p",{class:"text-sm font-medium text-green-800"},"Total Income",-1)),e("p",Nd,g(q(je)(c.value,q(u))),1)]),e("div",Pd,[k[3]||(k[3]=e("p",{class:"text-sm font-medium text-red-800"},"Total Expenses",-1)),e("p",Rd,g(q(je)(m.value,q(u))),1)]),e("div",{class:Q(["p-4 rounded-lg shadow-sm transition-shadow hover:shadow-lg",{"bg-green-100":v.value>=0,"bg-red-100":v.value<0}])},[e("p",{class:Q(["text-sm font-medium",{"text-green-800":v.value>=0,"text-red-800":v.value<0}])},"Profit/Loss",2),e("p",{class:Q(["text-2xl font-bold mt-1",{"text-green-900":v.value>=0,"text-red-900":v.value<0}])},g(q(je)(v.value,q(u))),3)],2)])),!i.value&&!a.value&&((w=s.value)!=null&&w.contract_details)?(n(),d("dl",Fd,[(S=s.value)!=null&&S.contract_details?(n(),d("div",Bd,[k[4]||(k[4]=e("dt",{class:"font-medium w-full block mt-2"},"Contract Details:",-1)),e("dd",Hd,g(s.value.contract_details),1)])):D("",!0)])):D("",!0),!i.value&&!a.value&&!s.value&&!o.value.length?(n(),d("p",Wd," No financial information available. ")):D("",!0)])}}},zd={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},qd={key:0},Gd={key:1,class:"text-red-600 text-sm py-2"},Kd={key:2,class:"space-y-1 text-sm text-gray-700"},Jd={key:0},Zd={key:3,class:"text-gray-400 text-sm"},Xd={__name:"ProjectClientsCard",props:{projectId:{type:Number,required:!0},canViewClientContacts:{type:Boolean,default:!1}},setup(l){const t=l,s=x([]),o=x(!0),i=x(null),a=async()=>{var u,r;if(o.value=!0,i.value=null,!t.canViewClientContacts){i.value="You don't have permission to view project clients.",o.value=!1;return}try{const m=await window.axios.get(`/api/projects/${t.projectId}/sections/clients?type=clients`);s.value=m.data}catch(m){console.error("Failed to fetch project clients:",m),i.value=((r=(u=m.response)==null?void 0:u.data)==null?void 0:r.message)||"Failed to load client data."}finally{o.value=!1}};return be(()=>{a()}),re(()=>t.canViewClientContacts,()=>{a()}),(u,r)=>(n(),d("div",zd,[r[1]||(r[1]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Clients",-1)),o.value?(n(),d("div",qd,r[0]||(r[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):i.value?(n(),d("div",Gd,[e("p",null,g(i.value),1)])):s.value.length?(n(),d("ul",Kd,[(n(!0),d(K,null,ee(s.value,m=>(n(),d("li",{key:m.id},[F(g(m.name)+" ",1),m.email?(n(),d("span",Jd,"("+g(m.email)+")",1)):D("",!0)]))),128))])):(n(),d("p",Zd,"No clients assigned."))]))}},Qd={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},eu={key:0},tu={key:1,class:"text-red-600 text-sm py-2"},su={key:2},lu={key:0,class:"space-y-2 text-sm text-gray-700 mb-4"},au={class:"font-medium"},iu={class:"text-xs text-gray-500 mt-1"},nu={key:1,class:"text-gray-400 text-sm mb-4"},ou={__name:"ProjectTeamCard",props:{projectId:{type:Number,required:!0},canViewUsers:{type:Boolean,default:!1}},setup(l){const t=l,s=Le(),o=x([]),i=x(!0),a=x(null),u=async()=>{var m,c;if(i.value=!0,a.value=null,!t.canViewUsers){a.value="You don't have permission to view project team members.",i.value=!1,o.value=[];return}try{const v=await window.axios.get(`/api/projects/${t.projectId}/sections/users`);o.value=v.data.users||[],console.log("Fetched team users:",o.value)}catch(v){console.error("Failed to fetch project users:",v),a.value=((c=(m=v.response)==null?void 0:m.data)==null?void 0:c.message)||"Failed to load team data."}finally{i.value=!1}},r=m=>{if(!m.availabilities||m.availabilities.length===0)return"No availability submitted for today.";const c=m.availabilities[0];return c.is_available?c.time_slots&&c.time_slots.length>0?`${c.time_slots.map(f=>`${f.start_time}-${f.end_time}`).join(", ")}`:"No specific slots provided.":`Not available today: ${c.reason||"No reason provided"}`};return be(()=>{u()}),re([()=>t.canViewUsers,()=>s.value,()=>t.projectId],()=>{u()},{deep:!0}),(m,c)=>(n(),d("div",Qd,[c[3]||(c[3]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Team",-1)),i.value?(n(),d("div",eu,c[0]||(c[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):a.value?(n(),d("div",tu,[e("p",null,g(a.value),1)])):(n(),d("div",su,[o.value.length?(n(),d("ul",lu,[(n(!0),d(K,null,ee(o.value,v=>{var f;return n(),d("li",{key:v.id,class:"border-b pb-2 last:border-b-0"},[e("div",null,[e("strong",null,g(v.name),1),c[1]||(c[1]=F(" (Role: ",-1)),e("span",au,g(((f=v.pivot)==null?void 0:f.role)||"N/A"),1),c[2]||(c[2]=F(") ",-1))]),e("div",iu," Today's Availability: "+g(r(v)),1)])}),128))])):(n(),d("p",nu,"No team members assigned."))]))]))}},ru={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},du={key:0,class:"space-y-3"},uu={key:1,class:"text-red-600 text-sm py-2 text-center"},cu={key:2},mu={class:"space-y-1 text-sm text-gray-700"},vu={key:0},pu={class:"inline-block text-gray-900"},hu={class:"inline-block text-gray-900"},gu={class:"inline-block text-gray-900"},yu={key:1},fu={key:0,class:"text-gray-400 text-sm"},bu={key:1,class:"text-gray-400 text-sm"},_u={key:0,class:"mt-4 text-right"},wu={__name:"UserFinancialCard",props:{projectId:{type:Number,required:!0}},emits:["viewUserTransactions"],setup(l,{emit:t}){const s=l,o=t,i=Le(),a=x(!0),u=x(null),r=x([]),m=Be,c=async()=>{var S,y;if(a.value=!0,u.value=null,!i.value||!i.value.id||!s.projectId){r.value=[],a.value=!1;return}if(!he.value||Object.keys(he.value).length===0){u.value="Currency rates not loaded. Please try again.",a.value=!1;return}try{const h=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${i.value.id}`);r.value=h.data,console.log("User-specific transactions:",r.value)}catch(h){console.error("Failed to fetch user transactions for UserFinancialsCard:",h),u.value=((y=(S=h.response)==null?void 0:S.data)==null?void 0:y.message)||"Failed to load your financial data.",r.value=[]}finally{a.value=!1}},v=R(()=>!i.value||!i.value.id||!r.value.length||!he.value||Object.keys(he.value).length===0?0:r.value.filter(y=>y.type==="expense").reduce((y,h)=>y+Oe(parseFloat(h.amount||0),h.currency,m.value),0)),f=R(()=>!i.value||!i.value.id||!r.value.length||!he.value||Object.keys(he.value).length===0?0:r.value.filter(y=>y.type==="bonus").reduce((y,h)=>y+Oe(parseFloat(h.amount||0),h.currency,m.value),0)),b=R(()=>!i.value||!i.value.id||!r.value.length||!he.value||Object.keys(he.value).length===0?0:r.value.filter(y=>(y.type==="expense"||y.type==="bonus")&&y.is_paid===1).reduce((y,h)=>y+Oe(parseFloat(h.amount||0),h.currency,m.value),0)),k=R(()=>i.value&&(v.value>0||f.value>0||b.value>0));be(()=>{c()}),re([()=>i.value,()=>s.projectId,m,he],()=>{c()},{deep:!0});const w=()=>{o("viewUserTransactions")};return(S,y)=>(n(),d("div",ru,[y[5]||(y[5]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Your Financials",-1)),a.value?(n(),d("div",du,y[0]||(y[0]=[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"},null,-1)]))):u.value?(n(),d("div",uu,[e("p",null,g(u.value),1)])):(n(),d("div",cu,[e("dl",mu,[k.value?(n(),d("div",vu,[e("div",null,[y[1]||(y[1]=e("dt",{class:"font-medium inline-block w-32"},"Agreed Amount:",-1)),e("dd",pu,g(q(je)(v.value,q(m))),1)]),e("div",null,[y[2]||(y[2]=e("dt",{class:"font-medium inline-block w-32"},"Bonus Amount:",-1)),e("dd",hu,g(q(je)(f.value,q(m))),1)]),e("div",null,[y[3]||(y[3]=e("dt",{class:"font-medium inline-block w-32"},"Received Amount:",-1)),e("dd",gu,g(q(je)(b.value,q(m))),1)])])):(n(),d("div",yu,[q(i)?(n(),d("p",bu," Your financials for this project are not available or you're not assigned. ")):(n(),d("p",fu," Sign in to view your specific financials. "))]))]),q(i)?(n(),d("div",_u,[p(ue,{onClick:w},{default:N(()=>y[4]||(y[4]=[F(" View Transactions ",-1)])),_:1,__:[4]})])):D("",!0)]))]))}},xu=Ce(wu,[["__scopeId","data-v-34bab241"]]),ku={class:"p-4"},Du={key:0,class:"text-center text-gray-600"},Cu={key:1,class:"text-red-600 text-sm py-2"},$u={key:2,class:"text-gray-500 text-center py-4"},Su={key:3,class:"overflow-x-auto"},Eu={class:"min-w-full divide-y divide-gray-200"},Mu={class:"bg-white divide-y divide-gray-200"},Tu={class:"px-4 py-3 text-sm text-gray-900"},ju={class:"px-4 py-3 text-sm text-gray-700"},Vu={class:"px-4 py-3 text-sm text-right text-gray-900"},Au={class:"px-4 py-3 text-sm"},Ou={class:"px-4 py-3 text-sm text-gray-700"},Iu={__name:"UserTransactionsModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectName:{type:String,required:!1}},emits:["close"],setup(l,{emit:t}){const s=l,o=Le(),i=x(!0),a=x(null),u=x([]);x("PKR");const r=(c,v="USD")=>isNaN(c)||c==null?"0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:v,minimumFractionDigits:2,maximumFractionDigits:2}).format(c),m=async()=>{var c,v;if(i.value=!0,a.value=null,u.value=[],!o.value||!o.value.id||!s.projectId){a.value="User not authenticated or project ID missing.",i.value=!1;return}try{const f=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${o.value.id}`);u.value=f.data}catch(f){console.error("Failed to fetch user-specific transactions for modal:",f),a.value=((v=(c=f.response)==null?void 0:c.data)==null?void 0:v.message)||"Failed to load transactions."}finally{i.value=!1}};return re(()=>s.show,c=>{c&&m()},{immediate:!1}),re([()=>{var c;return(c=o.value)==null?void 0:c.id},()=>s.projectId],(c,v)=>{s.show&&m()},{deep:!0}),R(()=>`Your Transactions for Project ${s.projectId}`),(c,v)=>(n(),le(Ee,{show:l.show,title:"Transactions for: "+l.projectName,"show-footer":!1,onClose:v[0]||(v[0]=f=>c.$emit("close")),"hide-submit-button":!0,"hide-cancel-button":!0,"api-endpoint":null,"form-data":"{}"},{default:N(({errors:f})=>[e("div",ku,[i.value?(n(),d("div",Du,v[1]||(v[1]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"})],-1)]))):a.value?(n(),d("div",Cu,[e("p",null,g(a.value),1)])):u.value.length===0?(n(),d("div",$u," No transactions found for you on this project. ")):(n(),d("div",Su,[e("table",Eu,[v[2]||(v[2]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date")])],-1)),e("tbody",Mu,[(n(!0),d(K,null,ee(u.value,b=>(n(),d("tr",{key:b.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Tu,g(b.description),1),e("td",ju,g(b.type),1),e("td",Vu,g(r(b.amount,b.currency)),1),e("td",Au,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":b.is_paid===1,"bg-yellow-100 text-yellow-800":b.is_paid===0})},g(b.is_paid===1?"Paid":"Unpaid"),3)]),e("td",Ou,g(new Date(b.created_at).toLocaleDateString()),1)]))),128))])])]))])]),_:1},8,["show","title"]))}},Lu={class:"space-y-4"},Uu={key:0},Nu=["disabled"],Pu={key:0,class:"mt-4"},Ru=["src"],Fu={class:"flex items-center"},Bu="Create New Deliverable",Hu="post",Wu="Create Deliverable",Yu="Deliverable created successfully!",Dt={__name:"CreateDeliverableModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=ke({title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),a=[{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],u=[{value:"pending_review",label:"Pending Review (Requires Client Approval)"},{value:"for_information",label:"For Information Only (No Approval Needed)"}],r=[{value:null,label:"Select Type (if providing URL)"},{value:"google_doc",label:"Google Document (Doc, Sheet, Slide)"},{value:"pdf",label:"PDF Document"},{value:"image",label:"Image (JPG, PNG, GIF)"},{value:"video",label:"Video (YouTube, Vimeo, etc.)"},{value:"other",label:"Other Web Link"}],m=x(null),c=x(null);re(()=>s.show,y=>{y&&(Object.assign(i,{title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),c.value=null,m.value&&(m.value.value=""))});const v=y=>{const h=y.target.files[0];if(h)if(i.attachment_file=h,i.content_url="",i.content_url_type=null,h.type.startsWith("image/")){const M=new FileReader;M.onload=j=>{c.value=j.target.result},M.readAsDataURL(h)}else c.value=null;else i.attachment_file=null,c.value=null},f=()=>{i.content_url?(i.attachment_file=null,c.value=null,m.value&&(m.value.value="")):i.content_url_type=null},b=y=>{const h=new FormData;return h.append("title",y.title),h.append("description",y.description||""),h.append("type",y.type),h.append("is_visible_to_client",y.is_visible_to_client?1:0),h.append("initial_status",y.initial_status),y.attachment_file?h.append("attachment_file",y.attachment_file):y.content_url&&(h.append("content_url",y.content_url),h.append("content_url_type",y.content_url_type||"")),h},k=R(()=>`/api/projects/${s.projectId}/deliverables`),w=y=>{o("saved",y),o("close")},S=()=>{o("close")};return(y,h)=>(n(),le(Ee,{show:l.show,title:Bu,"api-endpoint":k.value,"http-method":Hu,"form-data":i,"submit-button-text":Wu,"success-message":Yu,"format-data-for-api":b,onClose:S,onSubmitted:w},{default:N(({errors:M})=>[e("div",Lu,[e("div",null,[p(W,{for:"title",value:"Title"}),p(ne,{id:"title",modelValue:i.title,"onUpdate:modelValue":h[0]||(h[0]=j=>i.title=j),type:"text",class:"mt-1 block w-full",required:"",autofocus:""},null,8,["modelValue"]),p(ae,{message:M.title?M.title[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"description",value:"Description"}),ce(e("textarea",{id:"description","onUpdate:modelValue":h[1]||(h[1]=j=>i.description=j),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter deliverable description"},null,512),[[fe,i.description]]),p(ae,{message:M.description?M.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"type",value:"Deliverable Type"}),p(pe,{id:"type",modelValue:i.type,"onUpdate:modelValue":h[2]||(h[2]=j=>i.type=j),options:a,"value-key":"value","label-key":"label",placeholder:"Select a type",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:M.type?M.type[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"initial_status",value:"Initial Status"}),p(pe,{id:"initial_status",modelValue:i.initial_status,"onUpdate:modelValue":h[3]||(h[3]=j=>i.initial_status=j),options:u,"value-key":"value","label-key":"label",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:M.initial_status?M.initial_status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"content_url",value:"Content URL (for Google Docs, external links)"}),p(ne,{id:"content_url",modelValue:i.content_url,"onUpdate:modelValue":h[4]||(h[4]=j=>i.content_url=j),type:"url",class:"mt-1 block w-full",disabled:!!i.attachment_file,onInput:f,placeholder:"e.g., https://docs.google.com/document/d/..."},null,8,["modelValue","disabled"]),h[7]||(h[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Leave empty if uploading a file below.",-1)),p(ae,{message:M.content_url?M.content_url[0]:"",class:"mt-2"},null,8,["message"])]),i.content_url&&!i.attachment_file?(n(),d("div",Uu,[p(W,{for:"content_url_type",value:"Type of Content URL"}),p(pe,{id:"content_url_type",modelValue:i.content_url_type,"onUpdate:modelValue":h[5]||(h[5]=j=>i.content_url_type=j),options:r,"value-key":"value","label-key":"label",placeholder:"Select the type of content this URL links to",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:M.content_url_type?M.content_url_type[0]:"",class:"mt-2"},null,8,["message"])])):D("",!0),e("div",null,[p(W,{for:"attachment_file",value:"Upload File (PDF, Image)"}),e("input",{id:"attachment_file",ref_key:"fileInput",ref:m,type:"file",onChange:v,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",disabled:!!i.content_url,accept:"application/pdf,image/*"},null,40,Nu),h[9]||(h[9]=e("p",{class:"text-xs text-gray-500 mt-1"},"Max 10MB. Leave empty if providing a URL above.",-1)),p(ae,{message:M.attachment_file?M.attachment_file[0]:"",class:"mt-2"},null,8,["message"]),c.value?(n(),d("div",Pu,[h[8]||(h[8]=e("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Image Preview:",-1)),e("img",{src:c.value,alt:"File Preview",class:"max-w-full h-auto rounded-lg shadow-md max-h-60 object-contain"},null,8,Ru)])):D("",!0)]),e("div",Fu,[ce(e("input",{id:"is_visible_to_client",type:"checkbox","onUpdate:modelValue":h[6]||(h[6]=j=>i.is_visible_to_client=j),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,512),[[Qe,i.is_visible_to_client]]),p(W,{for:"is_visible_to_client",value:"Visible to Client",class:"ml-2"}),p(ae,{message:M.is_visible_to_client?M.is_visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","api-endpoint","form-data"]))}};function zu(){return{formatDate:o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",formatDateTime:o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",timeAgo:o=>{if(!o)return"";const i=new Date(o),u=Math.floor((new Date-i)/1e3);let r=u/31536e3;return r>1?Math.floor(r)+" years ago":(r=u/2592e3,r>1?Math.floor(r)+" months ago":(r=u/86400,r>1?Math.floor(r)+" days ago":(r=u/3600,r>1?Math.floor(r)+" hours ago":(r=u/60,r>1?Math.floor(r)+" minutes ago":Math.floor(u)+" seconds ago"))))}}}const qu={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},Gu={class:"flex justify-between items-center mb-4"},Ku={class:"flex gap-2"},Ju={key:0},Zu={key:1},Xu={class:"mb-6 bg-gray-50 p-4 rounded-lg"},Qu={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},ec={key:0,class:"mt-3 text-sm text-gray-600"},tc={key:0,class:"text-red-600 font-medium"},sc={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},lc={key:1,class:"text-center py-4"},ac={class:"text-red-600 text-sm font-medium"},ic={key:2,class:"overflow-x-auto"},nc={class:"min-w-full divide-y divide-gray-200"},oc={class:"bg-white divide-y divide-gray-200"},rc={class:"px-4 py-3 text-sm text-gray-900"},dc={class:"px-4 py-3 text-sm text-gray-700 capitalize"},uc={class:"px-4 py-3 text-sm text-gray-700"},cc={class:"px-4 py-3 text-sm text-gray-700"},mc={class:"px-4 py-3 text-sm text-gray-700"},vc={class:"px-4 py-3 text-sm text-gray-700"},pc={class:"px-4 py-3 text-sm text-gray-700"},hc={class:"px-4 py-3 text-right"},gc={class:"flex justify-end space-x-2"},yc=["onClick"],fc={key:3,class:"text-center py-4"},bc={__name:"ProjectDeliverableTab",props:{projectId:{type:[String,Number],required:!0},canCreateDeliverables:{type:Boolean,default:!1},canViewDeliverables:{type:Boolean,default:!1}},emits:["deliverablesUpdated","openDeliverableDetailSidebar"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(null),r=x(!1),m=x({status:"",type:"",visibility:"",clientStatus:""}),c=[{value:"",label:"All Statuses"},{value:"pending_review",label:"Pending Review"},{value:"for_information",label:"For Information"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"},{value:"completed",label:"Completed"}],v=[{value:"",label:"All Types"},{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],f=[{value:"",label:"All Visibility"},{value:"visible_to_client",label:"Visible to Client"},{value:"not_visible_to_client",label:"Not Visible to Client"}],b=[{value:"",label:"All Client Status"},{value:"read",label:"Read"},{value:"unread",label:"Unread"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"}],k=j=>{var P;if(!j.is_visible_to_client)return{status:"N/A",class:"bg-gray-100 text-gray-800"};const O=(P=j.client_interactions)==null?void 0:P[0];return O?O.approved_at?{status:"Approved",class:"bg-green-100 text-green-800"}:O.revisions_requested_at?{status:"Revisions Requested",class:"bg-yellow-100 text-yellow-800"}:O.rejected_at?{status:"Rejected",class:"bg-red-100 text-red-800"}:O.read_at?{status:`Read on ${new Date(O.read_at).toLocaleDateString()}`,class:"bg-blue-100 text-blue-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}},w=R(()=>i.value.length?i.value.filter(j=>{const O=k(j);return!(m.value.status&&j.status!==m.value.status||m.value.type&&j.type!==m.value.type||m.value.visibility&&(m.value.visibility==="visible_to_client"&&!j.is_visible_to_client||m.value.visibility==="not_visible_to_client"&&j.is_visible_to_client)||m.value.clientStatus&&(m.value.clientStatus==="read"&&!O.status.startsWith("Read")||m.value.clientStatus==="unread"&&O.status!=="Unread"||m.value.clientStatus==="approved"&&O.status!=="Approved"||m.value.clientStatus==="revisions_requested"&&O.status!=="Revisions Requested"))}):[]),S=()=>{m.value.status="",m.value.type="",m.value.visibility="",m.value.clientStatus=""},y=async()=>{if(!s.canViewDeliverables){u.value="You do not have permission to view deliverables.",a.value=!1;return}a.value=!0,u.value=null;try{const j=await window.axios.get(route("projects.deliverables.index",s.projectId));i.value=j.data}catch(j){console.error("Error fetching deliverables:",j),u.value="Failed to load deliverables."}finally{a.value=!1}},h=()=>{y(),o("deliverablesUpdated")},M=j=>{o("openDeliverableDetailSidebar",j)};return be(()=>{y()}),re(()=>s.projectId,()=>{y()}),(j,O)=>(n(),d("div",qu,[e("div",Gu,[O[7]||(O[7]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Deliverables & Approvals",-1)),e("div",Ku,[p(ye,{onClick:y,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:N(()=>[a.value?(n(),d("span",Zu,"Loading...")):(n(),d("span",Ju,"Refresh"))]),_:1},8,["disabled"]),l.canCreateDeliverables?(n(),le(ue,{key:0,onClick:O[0]||(O[0]=P=>r.value=!0),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:N(()=>O[6]||(O[6]=[F(" Add New Deliverable ",-1)])),_:1,__:[6]})):D("",!0)])]),e("div",Xu,[e("div",Qu,[e("div",null,[p(W,{for:"deliverable-status-filter",value:"Status"}),p(pe,{id:"deliverable-status-filter",modelValue:m.value.status,"onUpdate:modelValue":O[1]||(O[1]=P=>m.value.status=P),options:c,placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(W,{for:"deliverable-type-filter",value:"Type"}),p(pe,{id:"deliverable-type-filter",modelValue:m.value.type,"onUpdate:modelValue":O[2]||(O[2]=P=>m.value.type=P),options:v,placeholder:"All Types",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(W,{for:"deliverable-visibility-filter",value:"Visibility"}),p(pe,{id:"deliverable-visibility-filter",modelValue:m.value.visibility,"onUpdate:modelValue":O[3]||(O[3]=P=>m.value.visibility=P),options:f,placeholder:"All Visibility",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(W,{for:"deliverable-client-status-filter",value:"Client Status"}),p(pe,{id:"deliverable-client-status-filter",modelValue:m.value.clientStatus,"onUpdate:modelValue":O[4]||(O[4]=P=>m.value.clientStatus=P),options:b,placeholder:"All Client Status",class:"mt-1"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end mt-4"},[e("button",{type:"button",onClick:S,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")]),Object.values(m.value).some(P=>P!==null&&P!=="")?(n(),d("div",ec,[e("p",null,[F(" Showing "+g(w.value.length)+" of "+g(i.value.length)+" deliverables ",1),w.value.length===0?(n(),d("span",tc," (No deliverables match the current filters) ")):D("",!0)])])):D("",!0)]),a.value?(n(),d("div",sc," Loading deliverables... ")):u.value?(n(),d("div",lc,[e("p",ac,g(u.value),1)])):w.value.length?(n(),d("div",ic,[e("table",nc,[O[8]||(O[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted By"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted On"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Visibility"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client Status"),F(),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",oc,[(n(!0),d(K,null,ee(w.value,P=>{var J;return n(),d("tr",{key:P.id,class:"hover:bg-gray-50 transition-colors"},[e("td",rc,g(P.title),1),e("td",dc,g(P.type.replace(/_/g," ")),1),e("td",uc,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":P.status==="pending_review"||P.status==="revisions_requested","bg-green-100 text-green-800":P.status==="approved","bg-blue-100 text-blue-800":P.status==="completed","bg-gray-100 text-gray-800":P.status==="for_information"})},g(P.status.replace(/_/g," ").replace(/\b\w/g,L=>L.toUpperCase())),3)]),e("td",cc,g(((J=P.team_member)==null?void 0:J.name)||"Unknown"),1),e("td",mc,g(new Date(P.submitted_at).toLocaleDateString()),1),e("td",vc,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":P.is_visible_to_client,"bg-red-100 text-red-800":!P.is_visible_to_client})},g(P.is_visible_to_client?"Visible":"Hidden"),3)]),e("td",pc,[e("span",{class:Q(["px-2 py-1 rounded-full text-xs font-medium",k(P).class])},g(k(P).status),3)]),e("td",hc,[e("div",gc,[e("button",{onClick:L=>M(P.id),class:"text-purple-600 hover:text-purple-800 text-sm font-medium"}," View Details ",8,yc)])])])}),128))])])])):(n(),d("div",fc,O[9]||(O[9]=[e("p",{class:"text-gray-400 text-sm"},"No deliverables found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add New Deliverable" button to create one. ',-1)]))),p(Dt,{show:r.value,"project-id":l.projectId,onClose:O[5]||(O[5]=P=>r.value=!1),onSaved:h},null,8,["show","project-id"])]))}},_c=Ce(bc,[["__scopeId","data-v-40d67f52"]]),wc={key:0,class:"text-center py-8 text-gray-500"},xc={key:1,class:"text-center py-8 text-red-600"},kc={key:2,class:"space-y-6"},Dc={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Cc={class:"text-xl font-bold text-gray-900 mb-2"},$c={class:"flex items-center space-x-2 text-sm text-gray-600 mb-4"},Sc={class:"text-indigo-600 font-medium"},Ec={class:"text-gray-700"},Mc={class:"text-gray-700 leading-relaxed"},Tc={class:"mt-4 space-y-2 text-sm"},jc={key:0,class:"text-blue-600 hover:underline"},Vc=["href"],Ac={key:1,class:"text-blue-600 hover:underline"},Oc=["href"],Ic={key:2,class:"text-green-600 font-medium"},Lc={class:"bg-white p-4 rounded-lg shadow-sm"},Uc={key:0,class:"space-y-3"},Nc={class:"font-semibold text-gray-800"},Pc={class:"text-sm text-gray-700"},Rc={class:"font-medium"},Fc={key:0,class:"text-xs text-gray-500 ml-2"},Bc={key:0,class:"text-sm text-gray-600 mt-1"},Hc={key:1,class:"text-gray-500 text-sm py-2"},Wc={class:"bg-white p-4 rounded-lg shadow-sm"},Yc={class:"flex justify-between items-center mb-4 border-b pb-2"},zc={class:"space-y-3 mb-4"},qc={key:0,class:"space-y-3"},Gc={class:"text-sm text-gray-700"},Kc={class:"text-xs text-gray-500 mt-1"},Jc={key:0},Zc={key:1,class:"ml-2 text-gray-400"},Xc={key:1,class:"text-gray-500 text-sm py-2"},Qc={key:3,class:"text-center py-8 text-gray-500"},em={__name:"DeliverableDetailSidebar",props:{projectId:{type:Number,required:!0},deliverableId:{type:Number,required:!0}},emits:["close","deliverable-updated"],setup(l,{emit:t}){const s=l,o=t,i=x(null),a=x(!0),u=x(""),{formatDateTime:r,timeAgo:m}=zu(),c=ls({comment_text:"",context:""}),v=async()=>{a.value=!0,u.value="";try{const y=await window.axios.get(route("projects.deliverables.show",{project:s.projectId,deliverable:s.deliverableId}));i.value=y.data}catch(y){u.value="Failed to load deliverable details.",console.error("Error fetching deliverable details:",y)}finally{a.value=!1}};re(()=>s.deliverableId,y=>{y?v():i.value=null},{immediate:!0});const f=x(!1),b=async()=>{var y,h;if(i.value){f.value=!0,c.errors={};try{const M=await window.axios.post(`/api/projects/${s.projectId}/deliverables/${s.deliverableId}/comments`,{comment_text:c.comment_text,context:c.context});c.comment_text="",c.context="",v(),o("deliverable-updated")}catch(M){console.error("Error adding comment:",M),M.response&&M.response.status===422?c.errors=M.response.data.errors:console.error("Failed to add comment:",((h=(y=M.response)==null?void 0:y.data)==null?void 0:h.message)||M.message)}finally{f.value=!1}}},k=R(()=>i.value?{"bg-yellow-100 text-yellow-800":i.value.status==="pending_review"||i.value.status==="revisions_requested","bg-green-100 text-green-800":i.value.status==="approved","bg-blue-100 text-blue-800":i.value.status==="completed","bg-gray-100 text-gray-800":i.value.status==="for_information"}:""),w=y=>{let h="No Action Yet",M="";return y.approved_at?(h="Approved",M=r(y.approved_at)):y.revisions_requested_at?(h="Revisions Requested",M=r(y.revisions_requested_at)):y.rejected_at?(h="Rejected",M=r(y.rejected_at)):y.read_at&&(h="Read",M=r(y.read_at)),{status:h,timestamp:M}},S=y=>y.creator_type==="App\\Models\\Client"?"Client":y.creator_type==="App\\Models\\User"?"Team Member":"Unknown";return(y,h)=>{var M;return a.value?(n(),d("div",wc," Loading deliverable details... ")):u.value?(n(),d("div",xc,g(u.value),1)):i.value?(n(),d("div",kc,[e("div",Dc,[e("h4",Cc,g(i.value.title),1),e("div",$c,[e("span",{class:Q(["px-2 py-1 rounded-full text-xs font-medium",k.value])},g(i.value.status.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())),3),e("span",Sc," | "+g(i.value.type.replace(/_/g," "))+" | ",1),e("span",Ec," Submitted by: "+g(((M=i.value.team_member)==null?void 0:M.name)||"Unknown"),1)]),e("p",Mc,g(i.value.description||"No description provided."),1),e("div",Tc,[i.value.content_url?(n(),d("div",jc,[e("a",{href:i.value.content_url,target:"_blank",rel:"noopener noreferrer"},"View Content Link ("+g(i.value.mime_type||"Unknown Type")+")",9,Vc)])):D("",!0),i.value.attachment_path?(n(),d("div",Ac,[e("a",{href:i.value.attachment_path,target:"_blank",rel:"noopener noreferrer"},"View Attachment",8,Oc)])):D("",!0),e("div",{class:Q(i.value.is_visible_to_client?"text-green-600":"text-red-600")}," Visibility: "+g(i.value.is_visible_to_client?"Visible to Client":"Not Visible to Client"),3),i.value.overall_approved_at?(n(),d("div",Ic," Overall Approved by Client on "+g(q(r)(i.value.overall_approved_at)),1)):D("",!0)])]),e("div",Lc,[h[3]||(h[3]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Client Interactions",-1)),i.value.client_interactions&&i.value.client_interactions.length>0?(n(),d("div",Uc,[(n(!0),d(K,null,ee(i.value.client_interactions,j=>{var O;return n(),d("div",{key:j.id,class:"p-3 bg-gray-50 rounded-md"},[e("p",Nc,g(((O=j.client)==null?void 0:O.name)||"Unknown Client"),1),e("p",Pc,[h[2]||(h[2]=F(" Status: ",-1)),e("span",Rc,g(w(j).status),1),w(j).timestamp?(n(),d("span",Fc," ("+g(w(j).timestamp)+") ",1)):D("",!0)]),j.feedback_text?(n(),d("p",Bc,'Feedback: "'+g(j.feedback_text)+'"',1)):D("",!0)])}),128))])):(n(),d("div",Hc,"No client interactions recorded yet."))]),e("div",Wc,[e("div",Yc,[h[5]||(h[5]=e("h5",{class:"text-lg font-semibold text-gray-800"},"Comments",-1)),p(ue,{onClick:b,disabled:q(c).processing,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:N(()=>h[4]||(h[4]=[F(" Add Comment ",-1)])),_:1,__:[4]},8,["disabled"])]),e("div",zc,[e("div",null,[p(W,{for:"new-comment-text",value:"New Comment",class:"sr-only"}),ce(e("textarea",{id:"new-comment-text","onUpdate:modelValue":h[0]||(h[0]=j=>q(c).comment_text=j),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Type your comment here..."},null,512),[[fe,q(c).comment_text]]),p(ae,{message:q(c).errors.comment_text,class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"comment-context",value:"Context (Optional, e.g., 'Paragraph 2', 'Image 1')",class:"sr-only"}),p(ne,{id:"comment-context",modelValue:q(c).context,"onUpdate:modelValue":h[1]||(h[1]=j=>q(c).context=j),type:"text",class:"mt-1 block w-full",placeholder:"Context (optional)"},null,8,["modelValue"]),p(ae,{message:q(c).errors.context,class:"mt-2"},null,8,["message"])])]),i.value.comments&&i.value.comments.length>0?(n(),d("div",qc,[(n(!0),d(K,null,ee(i.value.comments,j=>(n(),d("div",{key:j.id,class:"p-3 bg-gray-50 rounded-md"},[e("p",Gc,g(j.content),1),e("p",Kc,[F(" By "+g(j.creator_name||"Unknown")+" ("+g(S(j))+") ",1),j.created_at?(n(),d("span",Jc,g(q(m)(j.created_at)),1)):D("",!0),j.context?(n(),d("span",Zc,"("+g(j.context)+")",1)):D("",!0)])]))),128))])):(n(),d("div",Xc,"No comments for this deliverable yet."))])])):(n(),d("div",Qc," Select a deliverable to view details. "))}}},tm={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},sm={class:"flex justify-between items-center mb-4"},lm={class:"mb-6 bg-gray-50 p-4 rounded-lg"},am={class:"flex items-center gap-4"},im={class:"flex-1 min-w-[200px]"},nm={key:0,class:"text-red-600 text-sm mt-2"},om={key:1,class:"text-gray-600 text-sm mt-2 animate-pulse"},rm={key:2,class:"text-gray-500 text-sm mt-2"},dm={class:"mt-6"},um={class:"flex justify-between items-center mb-3"},cm={class:"text-md font-medium text-gray-800"},mm={key:0},vm={key:1},pm={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-8"},hm={key:1,class:"text-center py-8"},gm={class:"text-red-600 text-sm font-medium"},ym={key:2,class:"text-center py-8"},fm={class:"text-red-600 text-sm font-medium"},bm={key:3,class:"space-y-8"},_m={class:"bg-gray-50 p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},wm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},xm={class:"text-lg font-semibold text-gray-900"},km={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Dm={class:"text-lg font-semibold text-gray-900"},Cm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},$m={class:"text-lg font-semibold text-gray-900"},Sm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Em={class:"text-lg font-semibold text-gray-900"},Mm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Tm={class:"text-lg font-semibold text-gray-900"},jm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Vm={class:"text-lg font-semibold text-gray-900"},Am={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Om={class:"text-lg font-semibold text-gray-900"},Im={class:"bg-white p-6 rounded-lg shadow-sm"},Lm={class:"overflow-x-auto max-h-60"},Um={class:"min-w-full divide-y divide-gray-200"},Nm={class:"bg-white divide-y divide-gray-200"},Pm={class:"px-4 py-3 text-sm text-gray-900"},Rm={class:"px-4 py-3 text-sm text-gray-700"},Fm={class:"px-4 py-3 text-sm text-gray-700"},Bm={key:0,class:"text-gray-500 text-sm py-2"},Hm={class:"bg-white p-6 rounded-lg shadow-sm"},Wm={class:"overflow-x-auto max-h-60"},Ym={class:"min-w-full divide-y divide-gray-200"},zm={class:"bg-white divide-y divide-gray-200"},qm={class:"px-4 py-3 text-sm text-gray-900"},Gm={class:"px-4 py-3 text-sm text-gray-700"},Km={class:"px-4 py-3 text-sm text-gray-700"},Jm={class:"px-4 py-3 text-sm text-gray-700"},Zm={class:"px-4 py-3 text-sm text-gray-700"},Xm={key:0,class:"text-gray-500 text-sm py-2"},Qm={class:"bg-white p-6 rounded-lg shadow-sm"},ev={class:"overflow-x-auto max-h-60"},tv={class:"min-w-full divide-y divide-gray-200"},sv={class:"bg-white divide-y divide-gray-200"},lv={class:"px-4 py-3 text-sm text-gray-900"},av={class:"px-4 py-3 text-sm text-gray-700"},iv={key:0,class:"text-gray-500 text-sm py-2"},nv={class:"bg-white p-6 rounded-lg shadow-sm"},ov={class:"overflow-x-auto"},rv={class:"min-w-full divide-y divide-gray-200"},dv={class:"bg-white divide-y divide-gray-200"},uv={class:"px-4 py-3 text-sm text-gray-900"},cv={class:"px-4 py-3 text-sm text-gray-700"},mv={key:0,class:"text-gray-500 text-sm py-2"},vv={class:"bg-white p-6 rounded-lg shadow-sm"},pv={class:"overflow-x-auto"},hv={class:"min-w-full divide-y divide-gray-200"},gv={class:"bg-white divide-y divide-gray-200"},yv={class:"px-4 py-3 text-sm text-gray-900"},fv={class:"px-4 py-3 text-sm text-gray-700"},bv={key:0,class:"text-gray-500 text-sm py-2"},_v={class:"bg-white p-6 rounded-lg shadow-sm"},wv={class:"overflow-x-auto max-h-60"},xv={class:"min-w-full divide-y divide-gray-200"},kv={class:"bg-white divide-y divide-gray-200"},Dv={class:"px-4 py-3 text-sm text-gray-900"},Cv={class:"px-4 py-3 text-sm text-gray-700"},$v={key:0,class:"text-gray-500 text-sm py-2"},Sv={class:"bg-white p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6"},Ev={key:0,class:"space-y-2"},Mv={class:"font-medium"},Tv={key:1,class:"text-gray-500 text-sm py-2"},jv={key:0,class:"space-y-2"},Vv={class:"font-medium"},Av={key:1,class:"text-gray-500 text-sm py-2"},Ov={key:4,class:"text-center py-8 text-gray-500"},Iv={__name:"SeoReportTab",props:{projectId:{type:[String,Number],required:!0},canCreateSeoReports:{type:Boolean,default:!1}},emits:["openCreateSeoReportModal"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(""),u=x(null),r=x(!0),m=x(!1),c=x(null),v=x(null),f=x(null),b=async()=>{r.value=!0,c.value=null;try{const A=await window.axios.get(`/api/projects/${s.projectId}/seo-reports/available-months`);i.value=A.data.map(_=>({value:_,label:new Date(_+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})})),i.value.length>0&&(a.value=i.value[0].value)}catch(A){console.error("Error fetching available months:",A),c.value="Failed to load available report months."}finally{r.value=!1}},k=A=>{const C=["clientName","reportingPeriod","authorityScoreValue","totalClicksValue","totalImpressionsValue","averagePositionValue","totalBacklinksValue","clicksImpressions","trafficSources","deviceUsage","countryPerformance","coreVitals","topQueries","keywordRankings","backlinks","zeroClickKeywords"].filter($=>!($ in A));return C.length>0?`Report data is missing expected top-level keys: ${C.join(", ")}. Please ensure the JSON structure is correct.`:!A.clicksImpressions||!Array.isArray(A.clicksImpressions.labels)||!Array.isArray(A.clicksImpressions.clicks)?"clicksImpressions data is malformed.":!A.trafficSources||!Array.isArray(A.trafficSources.labels)||!Array.isArray(A.trafficSources.sessions)?"trafficSources data is malformed.":null},w=async()=>{if(!a.value){u.value=null,f.value=null;return}m.value=!0,v.value=null,f.value=null;try{const _=(await window.axios.get(`/api/projects/${s.projectId}/seo-reports/${a.value}`)).data,C=k(_);C?(f.value=C,u.value=null):u.value=_}catch(A){console.error("Error fetching SEO report:",A),v.value="Failed to load SEO report for the selected month.",u.value=null,f.value=null}finally{m.value=!1}},S=(A=null)=>{o("openCreateSeoReportModal",A)},y=R(()=>{var A;return((A=u.value)==null?void 0:A.clientName)||"N/A"}),h=R(()=>{var A;return((A=u.value)==null?void 0:A.reportingPeriod)||"N/A"}),M=R(()=>{var A;return((A=u.value)==null?void 0:A.authorityScoreValue)||"N/A"}),j=R(()=>{var A;return((A=u.value)==null?void 0:A.totalClicksValue)||"N/A"}),O=R(()=>{var A;return((A=u.value)==null?void 0:A.totalImpressionsValue)||"N/A"}),P=R(()=>{var A;return((A=u.value)==null?void 0:A.averagePositionValue)||"N/A"}),J=R(()=>{var A;return((A=u.value)==null?void 0:A.totalBacklinksValue)||"N/A"}),L=R(()=>{var A;return((A=u.value)==null?void 0:A.clicksImpressions)||{labels:[],clicks:[],impressions:[]}}),V=R(()=>{var A;return((A=u.value)==null?void 0:A.trafficSources)||{labels:[],sessions:[],colors:[]}}),I=R(()=>{var A;return((A=u.value)==null?void 0:A.deviceUsage)||{labels:[],clicks:[],colors:[]}}),E=R(()=>{var A;return((A=u.value)==null?void 0:A.countryPerformance)||{labels:[],clicks:[]}}),T=R(()=>{var A;return((A=u.value)==null?void 0:A.coreVitals)||{mobile:{},desktop:{}}}),U=R(()=>{var A;return((A=u.value)==null?void 0:A.topQueries)||[]}),Z=R(()=>{var A;return((A=u.value)==null?void 0:A.keywordRankings)||[]});return be(()=>{b()}),re(()=>s.projectId,()=>{b()}),re(a,A=>{A?w():(u.value=null,f.value=null)}),(A,_)=>(n(),d("div",tm,[e("div",sm,[_[4]||(_[4]=e("h4",{class:"text-lg font-semibold text-gray-900"},"SEO Reports",-1)),l.canCreateSeoReports?(n(),le(ue,{key:0,onClick:_[0]||(_[0]=C=>S()),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:N(()=>_[3]||(_[3]=[F(" Add New Report ",-1)])),_:1,__:[3]})):D("",!0)]),e("div",lm,[e("div",am,[e("div",im,[p(W,{for:"seo-report-month-filter",value:"Select Report Month"}),p(pe,{id:"seo-report-month-filter",modelValue:a.value,"onUpdate:modelValue":_[1]||(_[1]=C=>a.value=C),options:i.value,"value-key":"value","label-key":"label",placeholder:"Select a month",disabled:r.value||i.value.length===0,class:"mt-1"},null,8,["modelValue","options","disabled"])])]),c.value?(n(),d("div",nm,g(c.value),1)):D("",!0),r.value?(n(),d("div",om,"Loading available months...")):D("",!0),!r.value&&i.value.length===0?(n(),d("div",rm,"No SEO reports available for this project.")):D("",!0)]),e("div",dm,[e("div",um,[e("h5",cm,[a.value?(n(),d("span",mm,"Report for "+g(new Date(a.value+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})),1)):(n(),d("span",vm,"Select a month to view report"))]),l.canCreateSeoReports&&u.value&&a.value?(n(),le(ue,{key:0,onClick:_[2]||(_[2]=C=>S({report_date:a.value,data:JSON.stringify(u.value,null,2)})),class:"bg-blue-500 hover:bg-blue-600 transition-colors text-sm py-1 px-3"},{default:N(()=>_[5]||(_[5]=[F(" Edit Report ",-1)])),_:1,__:[5]})):D("",!0)]),m.value?(n(),d("div",pm," Loading SEO report data... ")):v.value?(n(),d("div",hm,[e("p",gm,g(v.value),1)])):f.value?(n(),d("div",ym,[e("p",fm,"Data Structure Error: "+g(f.value),1),_[6]||(_[6]=e("p",{class:"text-gray-500 text-sm mt-2"},"Please ensure the JSON data conforms to the expected format.",-1))])):u.value?(n(),d("div",bm,[e("div",_m,[e("div",wm,[_[7]||(_[7]=e("p",{class:"text-sm text-gray-500"},"Client Name",-1)),e("p",xm,g(y.value),1)]),e("div",km,[_[8]||(_[8]=e("p",{class:"text-sm text-gray-500"},"Reporting Period",-1)),e("p",Dm,g(h.value),1)]),e("div",Cm,[_[9]||(_[9]=e("p",{class:"text-sm text-gray-500"},"Authority Score",-1)),e("p",$m,g(M.value),1)]),e("div",Sm,[_[10]||(_[10]=e("p",{class:"text-sm text-gray-500"},"Total Clicks",-1)),e("p",Em,g(j.value),1)]),e("div",Mm,[_[11]||(_[11]=e("p",{class:"text-sm text-gray-500"},"Total Impressions",-1)),e("p",Tm,g(O.value),1)]),e("div",jm,[_[12]||(_[12]=e("p",{class:"text-sm text-gray-500"},"Average Position",-1)),e("p",Vm,g(P.value),1)]),e("div",Am,[_[13]||(_[13]=e("p",{class:"text-sm text-gray-500"},"Total Backlinks",-1)),e("p",Om,g(J.value),1)])]),e("div",Im,[_[15]||(_[15]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Clicks & Impressions Trend",-1)),e("div",Lm,[e("table",Um,[_[14]||(_[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions")])],-1)),e("tbody",Nm,[(n(!0),d(K,null,ee(L.value.labels,(C,$)=>(n(),d("tr",{key:$},[e("td",Pm,g(C),1),e("td",Rm,g(L.value.clicks[$]),1),e("td",Fm,g(L.value.impressions[$]),1)]))),128))])])]),L.value.labels.length?D("",!0):(n(),d("p",Bm,"No clicks and impressions data available."))]),e("div",Hm,[_[17]||(_[17]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Top Queries",-1)),e("div",Wm,[e("table",Ym,[_[16]||(_[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Query"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"CTR"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Position")])],-1)),e("tbody",zm,[(n(!0),d(K,null,ee(U.value,C=>(n(),d("tr",{key:C.query},[e("td",qm,g(C.query),1),e("td",Gm,g(C.clicks),1),e("td",Km,g(C.impressions),1),e("td",Jm,g(C.ctr)+"%",1),e("td",Zm,g(C.position),1)]))),128))])])]),U.value.length?D("",!0):(n(),d("p",Xm,"No top queries data available."))]),e("div",Qm,[_[19]||(_[19]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Keyword Rankings",-1)),e("div",ev,[e("table",tv,[_[18]||(_[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Keyword"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ranking")])],-1)),e("tbody",sv,[(n(!0),d(K,null,ee(Z.value,C=>(n(),d("tr",{key:C.keyword},[e("td",lv,g(C.keyword),1),e("td",av,g(C.ranking),1)]))),128))])])]),Z.value.length?D("",!0):(n(),d("p",iv,"No keyword rankings data available."))]),e("div",nv,[_[21]||(_[21]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Traffic Sources",-1)),e("div",ov,[e("table",rv,[_[20]||(_[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Source"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sessions")])],-1)),e("tbody",dv,[(n(!0),d(K,null,ee(V.value.labels,(C,$)=>(n(),d("tr",{key:C},[e("td",uv,g(C),1),e("td",cv,g(V.value.sessions[$]),1)]))),128))])])]),V.value.labels.length?D("",!0):(n(),d("p",mv,"No traffic sources data available."))]),e("div",vv,[_[23]||(_[23]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Device Usage",-1)),e("div",pv,[e("table",hv,[_[22]||(_[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Device"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",gv,[(n(!0),d(K,null,ee(I.value.labels,(C,$)=>(n(),d("tr",{key:C},[e("td",yv,g(C),1),e("td",fv,g(I.value.clicks[$]),1)]))),128))])])]),I.value.labels.length?D("",!0):(n(),d("p",bv,"No device usage data available."))]),e("div",_v,[_[25]||(_[25]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Country Performance (Top 10)",-1)),e("div",wv,[e("table",xv,[_[24]||(_[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Country"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",kv,[(n(!0),d(K,null,ee(E.value.labels,C=>(n(),d("tr",{key:C},[e("td",Dv,g(C),1),e("td",Cv,g(E.value.clicks[E.value.labels.indexOf(C)]),1)]))),128))])])]),E.value.labels.length?D("",!0):(n(),d("p",$v,"No country performance data available."))]),e("div",Sv,[e("div",null,[_[26]||(_[26]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Mobile)",-1)),T.value.mobile&&T.value.mobile.labels&&T.value.mobile.labels.length?(n(),d("div",Ev,[(n(!0),d(K,null,ee(T.value.mobile.labels,(C,$)=>(n(),d("div",{key:C,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(C)+":",1),e("span",Mv,g(T.value.mobile.scores[$]),1)]))),128))])):(n(),d("p",Tv,"No mobile core vitals data available."))]),e("div",null,[_[27]||(_[27]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Desktop)",-1)),T.value.desktop&&T.value.desktop.labels&&T.value.desktop.labels.length?(n(),d("div",jv,[(n(!0),d(K,null,ee(T.value.desktop.labels,(C,$)=>(n(),d("div",{key:C,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(C)+":",1),e("span",Vv,g(T.value.desktop.scores[$]),1)]))),128))])):(n(),d("p",Av,"No desktop core vitals data available."))])])])):(n(),d("div",Ov," No report data to display. Please select a month from the dropdown. "))])]))}},Lv=Ce(Iv,[["__scopeId","data-v-37cb2f02"]]),Uv={class:"space-y-4"},Nv={key:0,class:"text-xs text-gray-500 mt-1 text-red-500"},Pv=["onBlur"],Rv={__name:"CreateSeoReportModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0},initialData:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=ke({report_date:"",data:""}),a=x(null);re(()=>[s.show,s.initialData],([y,h])=>{y&&(h?Object.assign(i,{report_date:h.report_date||"",data:h.data||""}):Object.assign(i,{report_date:"",data:""}))},{immediate:!0});const u=y=>{let h=y.data;try{h=JSON.stringify(JSON.parse(y.data))}catch{console.warn("Provided data is not valid JSON, sending as plain string. Backend should validate.")}return{report_date:y.report_date,data:h}},r=R(()=>s.initialData?"Edit SEO Report":"Create New SEO Report"),m=R(()=>`/api/projects/${s.projectId}/seo-reports`),c=R(()=>"post"),v=R(()=>s.initialData?"Update Report":"Create Report"),f=R(()=>s.initialData?"SEO Report updated successfully!":"SEO Report created successfully!"),b=y=>{o("saved",y),o("close")},k=()=>{o("close")},w=()=>{try{const y=JSON.parse(i.data);i.data=JSON.stringify(y,null,2)}catch(y){console.error("Invalid JSON for pretty print:",y)}},S=y=>{if(i.data)try{JSON.parse(i.data),y.data&&y.data[0]==="The data field must be a valid JSON string."&&(y.data=[])}catch{(!y.data||y.data.length===0)&&(y.data=["The data field must be a valid JSON string."])}};return(y,h)=>(n(),le(Ee,{show:l.show,title:r.value,"api-endpoint":m.value,"http-method":c.value,"form-data":i,"submit-button-text":v.value,"success-message":f.value,"format-data-for-api":u,onClose:k,onSubmitted:b},{default:N(({errors:M})=>[e("div",Uv,[e("div",null,[p(W,{for:"report_date",value:"Report Month (YYYY-MM)"}),p(ne,{id:"report_date",modelValue:i.report_date,"onUpdate:modelValue":h[0]||(h[0]=j=>i.report_date=j),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 2025-07",required:"",autofocus:"",pattern:"\\d{4}-\\d{2}",title:"Please enter a date in YYYY-MM format (e.g., 2025-07)",disabled:!!l.initialData},null,8,["modelValue","disabled"]),p(ae,{message:M.report_date?M.report_date[0]:"",class:"mt-2"},null,8,["message"]),h[2]||(h[2]=e("p",{class:"text-xs text-gray-500 mt-1"},"Enter the report month in YYYY-MM format (e.g., 2025-07).",-1)),l.initialData?(n(),d("p",Nv,"Note: Report month cannot be changed when editing.")):D("",!0)]),e("div",null,[p(W,{for:"report_data",value:"Report Data (JSON)"}),ce(e("textarea",{id:"report_data",ref_key:"jsonInputRef",ref:a,"onUpdate:modelValue":h[1]||(h[1]=j=>i.data=j),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 font-mono",rows:"10",placeholder:'Enter JSON data for the report, e.g., {"keywords_ranked": 150, "traffic": 1200, "rankings": {"keyword1": 5, "keyword2": 12}}',required:"",onBlur:j=>S(M)},null,40,Pv),[[fe,i.data]]),p(ae,{message:M.data?M.data[0]:"",class:"mt-2"},null,8,["message"]),e("div",{class:"flex justify-end mt-2"},[e("button",{type:"button",onClick:w,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," Format JSON ")])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},Fv={class:"py-8 max-w-full mx-auto px-4 sm:px-6 lg:px-8"},Bv={key:0,class:"text-center text-gray-600 text-lg animate-pulse"},Hv={key:1,class:"text-center text-red-600 text-lg font-medium"},Wv={key:2,class:"space-y-8"},Yv={class:"flex justify-end items-center mb-5"},zv={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},qv={key:1},Gv={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Kv={class:"flex justify-between items-center mb-4"},Jv={class:"overflow-x-auto"},Zv={class:"min-w-full divide-y divide-gray-200"},Xv={class:"bg-white divide-y divide-gray-200"},Qv={class:"px-4 py-3 text-sm text-gray-900"},ep={class:"px-4 py-3 text-sm text-gray-700"},tp={class:"px-4 py-3 text-sm text-gray-700"},sp={class:"px-4 py-3 text-right"},lp=["onClick"],ap={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},ip={class:"flex justify-between items-center mb-4"},np={key:2,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},op={class:"flex justify-between items-center mb-4"},rp={key:0,class:"text-gray-400 text-sm"},dp={key:1,class:"overflow-x-auto"},up={class:"min-w-full divide-y divide-gray-200"},cp={class:"bg-white divide-y divide-gray-200"},mp={class:"px-4 py-3 text-sm text-gray-900"},vp={class:"px-4 py-3 text-sm text-gray-700"},pp={class:"px-4 py-3 text-sm text-gray-700"},hp={class:"px-4 py-3 text-sm text-gray-700"},gp={class:"px-4 py-3 text-sm text-gray-700"},yp={class:"px-4 py-3 text-right"},fp={key:3,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},bp={class:"flex justify-between items-center mb-4"},_p={class:"flex items-center gap-4"},wp={key:0},xp={key:0,class:"space-y-4"},kp={class:"flex justify-between"},Dp={class:"flex-grow"},Cp={key:0,class:"text-xs text-red-400 block mt-1"},$p={class:"flex items-center mt-1"},Sp={class:"text-xs text-gray-500"},Ep={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},Mp={key:0},Tp={key:1,class:"text-gray-400 text-sm"},jp={__name:"Show",setup(l){const t=Le(),s=as().props.id,o=x({clients:[],users:[],notes:[],transactions:[],documents:[],meetings:[],tasks:[],emails:[],deliverables:[]}),i=x(!0),a=x(""),u=x(!1),r=x(!1),m=x(!1),c=x(!1),v=x(!1),f=x(!1),b=x(!1),k=x(!1),w=x(!1),S=x(null),y=x(null),h=x(!1),M=x(!1),j=x(null),O=[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"on_hold",label:"On Hold"},{value:"archived",label:"Archived"}],P=[{value:"Website Designing",label:"Website Designing"},{value:"SEO",label:"SEO"},{value:"Social Media",label:"Social Media"},{value:"Content Writing",label:"Content Writing"},{value:"Graphic Design",label:"Graphic Design"}],J=[{value:"UpWork",label:"UpWork"},{value:"Direct",label:"Direct Client"},{value:"Wix Marketplace",label:"Wix Marketplace"},{value:"Referral",label:"Referral"}],L=x(null),V=x(null),I=is(o),{canDo:E,canView:T}=et(s),U=R(()=>{var te,B;return((B=(te=t.value)==null?void 0:te.role_data)==null?void 0:B.slug)==="super-admin"}),Z=R(()=>E("manage_projects").value||U.value),A=R(()=>E("edit_projects").value||U.value),_=R(()=>T("emails").value),C=R(()=>E("compose_emails").value),$=R(()=>E("approve_emails").value),H=R(()=>T("project_notes").value),oe=R(()=>E("add_project_notes").value),Ve=R(()=>T("deliverables").value),X=R(()=>E("create_deliverables").value),z=R(()=>T("seo_reports").value),G=R(()=>E("create_seo_reports").value),ge=R(()=>T("client_contacts").value);R(()=>T("users").value);const Ne=R(()=>T("project_financial",I).value),tt=R(()=>T("project_transactions").value);R(()=>T("client_financial").value);const Ct=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],qe=x([]),$t=async()=>{try{const te=await window.axios.get(`/api/projects/${s}/due-and-overdue-tasks`);qe.value=te.data}catch(te){console.error("Error fetching due and overdue tasks:",te)}},st=R(()=>o.value.notes?[...o.value.notes].filter(te=>te.type!=="standup").sort((te,B)=>new Date(B.created_at)-new Date(te.created_at)).slice(0,3):[]),lt=x([]),Ge=async()=>{try{const te=await window.axios.get(`/api/projects/${s}/emails-simplified`,{params:{limit:5}});lt.value=te.data}catch(te){console.error("Error fetching latest emails:",te)}},De=async()=>{i.value=!0,a.value="";try{const te=await window.axios.get(`/api/projects/${s}`);o.value=te.data,console.log("Full project data received (Show.vue main fetch):",o.value),await $t()}catch(te){a.value="Failed to load project data.",console.error("Error fetching project data:",te),te.response&&(te.response.status===401||te.response.status===403)&&(a.value="You are not authorized to view this project or your session expired. Please log in.")}finally{i.value=!1}},St=te=>{o.value=te,u.value=!1,De()},Et=te=>{o.value.tasks=te},Mt=te=>{o.value.emails=te,_.value&&Ge()},at=te=>{o.value.notes=te},Tt=()=>{De()},jt=()=>{L.value&&L.value.fetchMeetings()},it=()=>{De()},Vt=te=>{V.value=te,Ke(),ot()},At=()=>{f.value=!0},Ot=()=>{b.value=!0,V.value="emails"},It=async()=>{b.value=!1,await De(),_.value&&await Ge()},Lt=()=>{b.value=!1},nt=te=>{S.value=te,y.value=null,w.value=!0},Ke=()=>{w.value=!1,S.value=null},Ut=()=>{De()},Nt=te=>{o.value.tasks=o.value.tasks.filter(B=>B.id!==te),De(),Ke()},Pt=te=>{y.value=te,S.value=null,w.value=!0},ot=()=>{w.value=!1,y.value=null},Rt=()=>{De()},Ft=()=>{h.value=!0},Bt=()=>{h.value=!1,De()},Ht=(te=null)=>{j.value=te,M.value=!0},Wt=()=>{M.value=!1};return be(async()=>{console.log("Show.vue mounted, fetching initial data...");try{await ns(s),console.log("Project permissions fetched (includes global)")}catch(te){console.error(`Error fetching permissions for project ${s}:`,te)}await ds(),await De(),_.value&&await Ge()}),(te,B)=>{const Yt=Te("SecondaryButton");return n(),d(K,null,[p(q(os),{title:o.value.name||"Project Details"},null,8,["title"]),p(Zt,null,{default:N(()=>{var rt;return[e("div",Fv,[i.value?(n(),d("div",Bv," Loading project details... ")):a.value?(n(),d("div",Hv,g(a.value),1)):(n(),d("div",Wv,[p(ln,{project:o.value,"project-id":q(s),"can-manage-projects":Z.value,"is-super-admin":U.value,"can-edit-projects":A.value,onOpenEditModal:B[0]||(B[0]=Y=>u.value=!0),onOpenStandupModal:B[1]||(B[1]=Y=>m.value=!0),onOpenMeetingModal:B[2]||(B[2]=Y=>r.value=!0),onOpenMagicLinkModal:B[3]||(B[3]=Y=>v.value=!0),onResourceSaved:De,onOpenComposeModal:Ot},null,8,["project","project-id","can-manage-projects","is-super-admin","can-edit-projects"]),p(ks,{"project-id":q(s),ref_key:"meetingsListComponent",ref:L},null,8,["project-id"]),p(pn,{tasks:o.value.tasks||[],emails:o.value.emails||[]},null,8,["tasks","emails"]),e("div",Yv,[p(pe,{id:"display-currency-switcher",modelValue:q(Be),"onUpdate:modelValue":B[4]||(B[4]=Y=>rs(Be)?Be.value=Y:null),options:Ct,"value-key":"value","label-key":"label",class:"w-20",containerClasses:"max-w-[150px]"},null,8,["modelValue"])]),Ne.value&&tt.value?(n(),le(Yd,{key:0,"project-id":q(s),"can-view-project-services-and-payments":Ne.value,"can-view-project-transactions":tt.value},null,8,["project-id","can-view-project-services-and-payments","can-view-project-transactions"])):D("",!0),e("div",zv,[ge.value?(n(),le(Xd,{key:0,"project-id":q(s),"can-view-client-contacts":ge.value},null,8,["project-id","can-view-client-contacts"])):D("",!0),p(ou,{"project-id":q(s),"can-view-users":!0},null,8,["project-id"]),p(xu,{"project-id":q(s),onViewUserTransactions:At},null,8,["project-id"])]),p(fn,{selectedTab:V.value,"onUpdate:selectedTab":B[5]||(B[5]=Y=>V.value=Y),"can-view-emails":_.value,"can-view-notes":H.value,"can-view-deliverables":Ve.value,"can-view-seo-reports":z.value},null,8,["selectedTab","can-view-emails","can-view-notes","can-view-deliverables","can-view-seo-reports"]),V.value===null?(n(),d("div",qv,[qe.value.length>0?(n(),d("div",Gv,[e("div",Kv,[B[25]||(B[25]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:B[6]||(B[6]=Y=>V.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),e("div",Jv,[e("table",Zv,[B[26]||(B[26]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned To"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Xv,[(n(!0),d(K,null,ee(qe.value,Y=>{var Me;return n(),d("tr",{key:Y.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Qv,g(Y.name),1),e("td",ep,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":Y.status==="To Do","bg-blue-100 text-blue-800":Y.status==="In Progress","bg-green-100 text-green-800":Y.status==="Done","bg-red-100 text-red-800":Y.status==="Blocked","bg-gray-100 text-gray-800":Y.status==="Archived"})},g(Y.status),3)]),e("td",tp,g((Me=Y.assigned_to)==null?void 0:Me.name),1),e("td",sp,[e("button",{onClick:dt=>nt(Y.id),class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium"}," View/Edit ",8,lp)])])}),128))])])])])):(n(),d("div",ap,[e("div",ip,[B[27]||(B[27]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:B[7]||(B[7]=Y=>V.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),B[28]||(B[28]=e("p",{class:"text-gray-400 text-sm"},"No due or overdue tasks.",-1))])),_.value?(n(),d("div",np,[e("div",op,[B[29]||(B[29]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Emails",-1)),e("button",{onClick:B[8]||(B[8]=Y=>V.value="emails"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Emails → ")]),(rt=o.value.emails)!=null&&rt.length?(n(),d("div",dp,[e("table",up,[B[31]||(B[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",cp,[(n(!0),d(K,null,ee(lt.value,Y=>{var Me;return n(),d("tr",{key:Y.id,class:"hover:bg-gray-50 transition-colors"},[e("td",mp,g(Y.subject),1),e("td",vp,g(((Me=Y.sender)==null?void 0:Me.name)||"N/A"),1),e("td",pp,g(new Date(Y.created_at).toLocaleDateString()),1),e("td",hp,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":Y.type==="sent","bg-purple-100 text-purple-800":Y.type==="received"})},g(Y.type?Y.type.toUpperCase():"N/A"),3)]),e("td",gp,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":Y.status==="sent","bg-yellow-100 text-yellow-800":Y.status==="pending_approval","bg-blue-200 text-blue-900":Y.status==="pending_approval_received","bg-red-100 text-red-800":Y.status==="rejected","bg-gray-100 text-gray-800":Y.status==="draft"})},g(Y.status.replace("_"," ").toUpperCase()),3)]),e("td",yp,[p(Yt,{class:"text-indigo-600 hover:text-indigo-800",onClick:dt=>te.viewEmail(Y)},{default:N(()=>B[30]||(B[30]=[F(" View ",-1)])),_:2,__:[30]},1032,["onClick"])])])}),128))])])])):(n(),d("div",rp,"No email communication found."))])):D("",!0),H.value?(n(),d("div",fp,[e("div",bp,[B[33]||(B[33]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Notes",-1)),e("div",_p,[e("button",{onClick:B[9]||(B[9]=Y=>V.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Notes → "),oe.value?(n(),d("div",wp,[p(ue,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:B[10]||(B[10]=Y=>c.value=!0)},{default:N(()=>B[32]||(B[32]=[F(" Add Note ",-1)])),_:1,__:[32]})])):D("",!0)])]),st.value.length?(n(),d("div",xp,[(n(!0),d(K,null,ee(st.value,Y=>{var Me;return n(),d("div",{key:Y.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",kp,[e("div",Dp,[e("p",{class:Q(["text-sm",{"text-gray-700":Y.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":Y.content==="[Encrypted content could not be decrypted]"}])},[F(g(Y.content)+" ",1),Y.content==="[Encrypted content could not be decrypted]"?(n(),d("span",Cp," (There was an issue decrypting this note. Please contact an administrator.) ")):D("",!0)],2),e("div",$p,[e("p",Sp,"Added by "+g(((Me=Y.user)==null?void 0:Me.name)||"Unknown")+" on "+g(new Date(Y.created_at).toLocaleDateString()),1),Y.reply_count>0?(n(),d("span",Ep,g(Y.reply_count)+" "+g(Y.reply_count===1?"reply":"replies"),1)):D("",!0)])]),H.value&&Y.chat_message_id&&o.value.google_chat_id?(n(),d("div",Mp,[e("button",{onClick:B[11]||(B[11]=dt=>V.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View ")])):D("",!0)])])}),128))])):(n(),d("p",Tp,"No notes available."))])):D("",!0)])):D("",!0),V.value==="tasks"?(n(),le(bo,{key:2,"project-id":q(s),"project-users":o.value.users||[],"can-manage-projects":Z.value,onTasksUpdated:Et,onOpenTaskDetailSidebar:nt,onOpenCreateTaskModal:Ft},null,8,["project-id","project-users","can-manage-projects"])):D("",!0),V.value==="emails"?(n(),le(Kr,{key:3,"project-id":q(s),"can-view-emails":_.value,"can-compose-emails":C.value,"can-approve-emails":$.value,"user-project-role":q(I),"open-compose":b.value,onEmailsUpdated:Mt,onResetOpenCompose:B[12]||(B[12]=Y=>b.value=!1)},null,8,["project-id","can-view-emails","can-compose-emails","can-approve-emails","user-project-role","open-compose"])):D("",!0),V.value==="standups"?(n(),le(ja,{key:4,projectId:q(s),users:o.value.users||[],onStandupAdded:it},null,8,["projectId","users"])):D("",!0),V.value==="notes"?(n(),le(Td,{key:5,"project-id":q(s),"google-chat-id":o.value.google_chat_id,"can-view-notes":H.value,"can-add-notes":oe.value,onNotesUpdated:at,onChangeTab:Vt},null,8,["project-id","google-chat-id","can-view-notes","can-add-notes"])):D("",!0),V.value==="deliverables"?(n(),le(_c,{key:6,"project-id":q(s),"can-create-deliverables":X.value,"can-view-deliverables":Ve.value,onDeliverablesUpdated:Tt,onOpenDeliverableDetailSidebar:Pt},null,8,["project-id","can-create-deliverables","can-view-deliverables"])):D("",!0),V.value==="seo-reports"?(n(),le(Lv,{key:7,"project-id":q(s),"can-create-seo-reports":G.value,onOpenCreateSeoReportModal:Ht},null,8,["project-id","can-create-seo-reports"])):D("",!0)]))]),p(Se,{show:u.value,onClose:B[14]||(B[14]=Y=>u.value=!1)},{default:N(()=>[p(us,{show:u.value,project:o.value,statusOptions:O,departmentOptions:P,sourceOptions:J,clientRoleOptions:[],userRoleOptions:[],paymentTypeOptions:[],onClose:B[13]||(B[13]=Y=>u.value=!1),onSubmit:St},null,8,["show","project"])]),_:1},8,["show"]),p(za,{show:r.value,onClose:B[15]||(B[15]=Y=>r.value=!1),onSaved:jt,projectId:q(s),projectUsers:o.value.users||[]},null,8,["show","projectId","projectUsers"]),p(yt,{show:m.value,onClose:B[16]||(B[16]=Y=>m.value=!1),onStandupAdded:it,projectId:q(s)},null,8,["show","projectId"]),p(ft,{show:c.value,"project-id":q(s),onClose:B[17]||(B[17]=Y=>c.value=!1),onNoteAdded:at},null,8,["show","project-id"]),p(Qa,{show:v.value,"project-id":q(s),"project-clients":o.value.clients||[],onClose:B[18]||(B[18]=Y=>v.value=!1)},null,8,["show","project-id","project-clients"]),p(Iu,{show:f.value,"project-id":q(s),"project-name":o.value.name,onClose:B[19]||(B[19]=Y=>f.value=!1)},null,8,["show","project-id","project-name"]),p(kt,{show:b.value,"project-id":q(s),"user-project-role":q(I),onClose:Lt,onSubmitted:It,onError:B[20]||(B[20]=Y=>console.error("Error composing email:",Y))},null,8,["show","project-id","user-project-role"]),p(Gt,{show:w.value,"onUpdate:show":B[21]||(B[21]=Y=>w.value=Y),title:S.value?"Task Details":y.value?"Deliverable Details":"Details",initialWidth:50},{content:N(()=>[S.value?(n(),le(Kt,{key:0,"task-id":S.value,"project-users":o.value.users||[],onClose:Ke,onTaskUpdated:Ut,onTaskDeleted:Nt},null,8,["task-id","project-users"])):y.value?(n(),le(em,{key:1,"project-id":q(s),"deliverable-id":y.value,onClose:ot,onDeliverableUpdated:Rt},null,8,["project-id","deliverable-id"])):D("",!0)]),_:1},8,["show","title"]),p(Jt,{show:h.value,"project-id":q(s),onClose:B[22]||(B[22]=Y=>h.value=!1),onSaved:Bt},null,8,["show","project-id"]),p(Dt,{show:k.value,"project-id":q(s),onClose:B[23]||(B[23]=Y=>k.value=!1),onSaved:te.handleDeliverableSaved},null,8,["show","project-id","onSaved"]),p(Rv,{"project-id":q(s),show:M.value,"initial-data":j.value,onClose:B[24]||(B[24]=Y=>M.value=!1),onSaved:Wt},null,8,["project-id","show","initial-data"])]}),_:1})],64)}}},Wp=Ce(jp,[["__scopeId","data-v-4fb56b07"]]);export{Wp as default};
