import{r as l,c as _,p as i}from"./app-D5B69b4J.js";function L(e){const u=l(!1),c=l(""),s=l(null),d=l([]),v=l(!1),r=l(""),p=l(!1),y=_(()=>{if(!s.value)return"";const t=s.value.first_name||"",o=s.value.last_name||"";return`${t} ${o}`.trim()||s.value.email||"Lead"}),g=async()=>{var t,o;if(e!=null&&e.value){u.value=!0,c.value="";try{const{data:a}=await i.get(`/api/leads/${e.value}`);s.value=a}catch(a){console.error("Failed to load lead",a),c.value=((o=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to load lead"}finally{u.value=!1}}},m=async()=>{var t,o;if(e!=null&&e.value){v.value=!0,r.value="";try{const{data:a}=await i.get("/api/project_notes",{params:{noteable_id:e.value,noteable_type:"App\\Models\\Lead"}});d.value=Array.isArray(a)?a:(a==null?void 0:a.data)??[]}catch(a){console.error("Failed to load notes",a),r.value=((o=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to load notes"}finally{v.value=!1}}};return{loading:u,error:c,lead:s,fullName:y,notes:d,notesLoading:v,notesError:r,savingNote:p,fetchLead:g,fetchNotes:m,addNote:async t=>{var o,a;if(!(!(e!=null&&e.value)||!t||!t.trim()))try{p.value=!0,await i.post("/api/project_notes",{body:t,noteable_id:e.value,noteable_type:"App\\Models\\Lead"}),await m()}catch(n){throw console.error("Failed to save note",n),r.value=((a=(o=n==null?void 0:n.response)==null?void 0:o.data)==null?void 0:a.message)||"Failed to save note",n}finally{p.value=!1}}}}export{L as u};
