import{A as pe}from"./ApplicationLogo-CwsoziCi.js";import{B as Z,I as re,s as P,r as C,i as c,o as l,b as e,f as z,e as f,A as J,J as Y,a as y,n as E,T as ge,c as I,K as ue,h as D,l as G,t as B,F as H,j as q,L as ye,w as Q,d as ne,g as S,q as he,m as $,k as X,x as F,M as ae,N as be,H as oe,D as we,z as ke,O as xe,p as _e}from"./app-Qb6DK_6t.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as se}from"./PrimaryButton-CqXkNs_Q.js";import{a as ce,_ as ve}from"./SecondaryButton-C37zTitX.js";import{_ as N,b as W,a as ie}from"./InputError-BdE1OvOX.js";const $e={class:"relative"},de={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(i){const h=i,r=n=>{d.value&&n.key==="Escape"&&(d.value=!1)};Z(()=>document.addEventListener("keydown",r)),re(()=>document.removeEventListener("keydown",r));const w=P(()=>({48:"w-48"})[h.width.toString()]),u=P(()=>h.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":h.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),d=C(!1);return(n,g)=>(l(),c("div",$e,[e("div",{onClick:g[0]||(g[0]=k=>d.value=!d.value)},[J(n.$slots,"trigger")]),z(e("div",{class:"fixed inset-0 z-40",onClick:g[1]||(g[1]=k=>d.value=!1)},null,512),[[Y,d.value]]),f(ge,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:y(()=>[z(e("div",{class:E(["absolute z-50 mt-2 rounded-md shadow-lg",[w.value,u.value]]),style:{display:"none"},onClick:g[2]||(g[2]=k=>d.value=!1)},[e("div",{class:E(["rounded-md ring-1 ring-black ring-opacity-5",i.contentClasses])},[J(n.$slots,"content")],2)],2),[[Y,d.value]])]),_:3})]))}},K={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(i){return(h,r)=>(l(),I(D(G),ue({href:i.href,method:i.method,as:i.as},h.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:y(()=>[J(h.$slots,"default")]),_:3},16,["href","method","as"]))}},O={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(i){const h=i,r=P(()=>h.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(w,u)=>(l(),I(D(G),{href:i.href,class:E(r.value)},{default:y(()=>[J(w.$slots,"default")]),_:3},8,["href","class"]))}},U={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(i){const h=i,r=P(()=>h.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(w,u)=>(l(),I(D(G),ue({href:i.href,method:i.method,as:i.as},w.$attrs,{class:r.value}),{default:y(()=>[J(w.$slots,"default")]),_:3},16,["href","method","as","class"]))}},Se={class:"p-4 flex items-start"},Ce={class:"flex-shrink-0"},Ae=["d"],je={class:"ml-3 w-0 flex-1 pt-0.5"},Te={class:"text-sm font-medium"},Me={__name:"Notification",props:{type:{type:String,default:"info",validator:i=>["success","error","info","warning"].includes(i)},message:{type:String,required:!0},duration:{type:Number,default:5e3},id:{type:String,required:!0}},emits:["close"],setup(i,{emit:h}){const r=i,w=h,u=C(!1),d=C(null),n=P(()=>{switch(r.type){case"success":return"bg-green-50 text-green-800 border-green-400";case"error":return"bg-red-50 text-red-800 border-red-400";case"warning":return"bg-yellow-50 text-yellow-800 border-yellow-400";default:return"bg-blue-50 text-blue-800 border-blue-400"}}),g=P(()=>{switch(r.type){case"success":return"text-green-500";case"error":return"text-red-500";case"warning":return"text-yellow-500";default:return"text-blue-500"}}),k=P(()=>{switch(r.type){case"success":return"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z";case"error":return"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z";case"warning":return"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z";default:return"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}),x=()=>{u.value=!1,d.value&&clearTimeout(d.value),setTimeout(()=>{w("close",r.id)},300)};return Z(()=>{setTimeout(()=>{u.value=!0},100),r.duration>0&&(d.value=setTimeout(()=>{x()},r.duration))}),(_,M)=>(l(),c("div",{class:E(["fixed z-50 transition-all duration-300 ease-in-out transform",[u.value?"opacity-100 translate-y-0":"opacity-0 translate-y-2","max-w-sm w-full shadow-lg rounded-lg pointer-events-auto border-l-4",n.value]]),role:"alert"},[e("div",Se,[e("div",Ce,[(l(),c("svg",{class:E(["h-5 w-5",g.value]),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:k.value,"clip-rule":"evenodd"},null,8,Ae)],2))]),e("div",je,[e("p",Te,B(i.message),1)]),e("div",{class:"ml-4 flex-shrink-0 flex"},[e("button",{class:"bg-transparent rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:x},M[0]||(M[0]=[e("span",{class:"sr-only"},"Close",-1),e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])],2))}},Ee={class:"fixed top-4 right-4 z-50 space-y-4 w-full max-w-sm"},Ie={__name:"NotificationContainer",setup(i,{expose:h}){const r=C([]),w=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),u=(n,g="info",k=5e3)=>{const x=w();return r.value.push({id:x,message:n,type:g,duration:k}),x},d=n=>{const g=r.value.findIndex(k=>k.id===n);g!==-1&&r.value.splice(g,1)};return h({addNotification:u,removeNotification:d,success:(n,g)=>u(n,"success",g),error:(n,g)=>u(n,"error",g),info:(n,g)=>u(n,"info",g),warning:(n,g)=>u(n,"warning",g)}),(n,g)=>(l(),c("div",Ee,[f(ye,{name:"notification"},{default:y(()=>[(l(!0),c(H,null,q(r.value,k=>(l(),I(Me,{key:k.id,id:k.id,type:k.type,message:k.message,duration:k.duration,onClose:d},null,8,["id","type","message","duration"]))),128))]),_:1})]))}},De=te(Ie,[["__scopeId","data-v-24b5eed3"]]),Pe={class:"p-6"},Be={class:"mt-6"},Le={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},Ve={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},ze={class:"flex items-center mb-3"},Ue=["id","onUpdate:modelValue"],Ne=["for"],Re={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},We={key:0},He={class:"mb-4"},qe={class:"flex items-center"},Fe=["id","checked","onChange"],Ke=["for"],Ye={key:0,class:"mb-4"},Ge=["id","onUpdate:modelValue"],Je={key:1,class:"mb-4"},Qe={class:"flex-1"},Xe=["id","onUpdate:modelValue"],Ze={class:"flex-1"},Oe=["id","onUpdate:modelValue"],et={key:0,class:"flex items-end pb-1"},tt=["onClick"],st=["onClick"],at={class:"mt-6 flex justify-end space-x-3"},ot={key:0,class:"flex items-center"},lt={key:1},rt={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const i=new Date;return i.setDate(i.getDate()+1),i.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(i,{emit:h}){const r=()=>{const p=localStorage.getItem("authToken");p&&!F.defaults.headers.common.Authorization&&(F.defaults.headers.common.Authorization=`Bearer ${p}`,console.log("Auth headers set in AvailabilityModal"))},w=i,u=h,d=C({}),n=C({}),g=C(!1),k=C(""),x=()=>{const p=[],o=new Date,s=new Date(o);s.setDate(o.getDate()+1);for(let m=0;m<7;m++){const v=new Date(s);v.setDate(s.getDate()+m);const t=v.toISOString().split("T")[0];p.push({value:t,label:v.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),d.value[t]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return p},_=C([]);Z(()=>{r(),w.nextWeekDates.length>0?(_.value=w.nextWeekDates,w.nextWeekDates.forEach(p=>{d.value[p.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):_.value=x()});const M=async()=>{try{if(r(),_.value.length===0)return;const p=_.value[0].value,o=_.value[_.value.length-1].value,s=await F.get("/api/availabilities",{params:{start_date:p,end_date:o,user_id:w.userId}});if(s.data&&s.data.availabilities){const m=s.data.availabilities;_.value.forEach(v=>{d.value[v.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),m.forEach(v=>{const t=v.date.split("T")[0];d.value[t]&&(d.value[t].isSelected=!0,d.value[t].isAvailable=v.is_available,v.is_available?d.value[t].timeSlots=v.time_slots&&v.time_slots.length>0?[...v.time_slots]:[{start_time:"",end_time:""}]:d.value[t].reason=v.reason||"")})}}catch(p){console.error("Error fetching existing availabilities:",p),_.value.forEach(o=>{d.value[o.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};Q(()=>w.show,async p=>{p&&(n.value={},k.value="",await M())},{immediate:!0});const L=p=>{d.value[p].timeSlots.push({start_time:"",end_time:""})},V=(p,o)=>{d.value[p].timeSlots.length>1&&d.value[p].timeSlots.splice(o,1)},T=(p,o)=>{d.value[p].isAvailable=o,o?d.value[p].reason="":d.value[p].timeSlots=[{start_time:"",end_time:""}]},b=async()=>{g.value=!0,n.value={},k.value="";const p=[];let o=!1;for(const s of _.value){const m=s.value,v=d.value[m];if(v.isSelected){let t={};if(v.isAvailable)if(v.timeSlots.some(a=>!a.start_time||!a.end_time))t.timeSlots="Please fill in all time slots.",o=!0;else for(const a of v.timeSlots){const j=a.start_time.split(":").map(Number),A=a.end_time.split(":").map(Number);if(j.length!==2||A.length!==2||isNaN(j[0])||isNaN(j[1])||isNaN(A[0])||isNaN(A[1])){t.timeSlots="Invalid time format. Please use HH:MM format.",o=!0;break}const R=j[0]*60+j[1],fe=A[0]*60+A[1];if(R>=fe){t.timeSlots="End time must be after start time.",o=!0;break}}else v.reason.trim()||(t.reason="Please provide a reason for unavailability.",o=!0);Object.keys(t).length>0&&(n.value[m]=t),Object.keys(t).length===0&&p.push({date:m,is_available:v.isAvailable,reason:v.isAvailable?null:v.reason,time_slots:v.isAvailable?v.timeSlots:null})}}if(o){g.value=!1,n.value.general="Please correct the errors in the highlighted dates.";return}if(p.length===0){n.value.general="Please select at least one day to set availability for.",g.value=!1;return}try{r();const s=await F.post("/api/availabilities/batch",{availabilities:p});k.value="Availability saved successfully!";try{const m=await F.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",m.data.should_block_user),localStorage.setItem("allWeekdaysCovered",m.data.all_weekdays_covered);const v=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:m.data.should_block_user,allWeekdaysCovered:m.data.all_weekdays_covered}});window.dispatchEvent(v),console.log("Availability status updated from modal:",{shouldBlockUser:m.data.should_block_user,allWeekdaysCovered:m.data.all_weekdays_covered})}catch(m){console.error("Error updating availability status:",m)}u("availability-saved",s.data.availabilities),setTimeout(()=>{u("close")},1500)}catch(s){console.error("Error saving availability:",s),s.response&&s.response.data&&s.response.data.errors?n.value.general=s.response.data.message||"An error occurred while saving your availability.":s.response&&s.response.status===409?(k.value=s.response.data.message,setTimeout(()=>{u("close")},1500)):n.value.general="An unexpected error occurred while saving your availability."}finally{g.value=!1}};return(p,o)=>(l(),I(ve,{show:i.show,onClose:o[1]||(o[1]=s=>p.$emit("close")),"max-width":"xl"},{default:y(()=>[e("div",Pe,[o[6]||(o[6]=e("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),o[7]||(o[7]=e("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),e("div",Be,[e("form",{onSubmit:ne(b,["prevent"])},[k.value?(l(),c("div",Le,B(k.value),1)):S("",!0),n.value.general?(l(),c("div",Ve,B(n.value.general),1)):S("",!0),(l(!0),c(H,null,q(_.value,s=>{var m,v;return l(),c("div",{key:s.value,class:E(["mb-6 p-4 border rounded-lg shadow-sm",[d.value[s.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",d.value[s.value].isSelected&&!n.value[s.value]?"border-l-4 border-l-indigo-500":""]])},[e("div",ze,[z(e("input",{type:"checkbox",id:`select_date_${s.value}`,"onUpdate:modelValue":t=>d.value[s.value].isSelected=t,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,Ue),[[he,d.value[s.value].isSelected]]),e("label",{for:`select_date_${s.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[$(B(s.label)+" ",1),d.value[s.value].isSelected?(l(),c("span",Re," Saved ")):S("",!0)],8,Ne)]),d.value[s.value].isSelected?(l(),c("div",We,[e("div",He,[e("div",qe,[e("input",{type:"checkbox",id:`isAvailableToggle_${s.value}`,checked:d.value[s.value].isAvailable,onChange:t=>T(s.value,t.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,Fe),e("label",{for:`isAvailableToggle_${s.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,Ke)])]),d.value[s.value].isAvailable?S("",!0):(l(),c("div",Ye,[f(N,{for:`reason_${s.value}`,value:"Reason for Not Available"},null,8,["for"]),z(e("textarea",{id:`reason_${s.value}`,"onUpdate:modelValue":t=>d.value[s.value].reason=t,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,Ge),[[X,d.value[s.value].reason]]),f(W,{message:(m=n.value[s.value])==null?void 0:m.reason,class:"mt-2"},null,8,["message"])])),d.value[s.value].isAvailable?(l(),c("div",Je,[f(N,{value:"Available Time Slots"}),f(W,{message:(v=n.value[s.value])==null?void 0:v.timeSlots,class:"mt-2"},null,8,["message"]),(l(!0),c(H,null,q(d.value[s.value].timeSlots,(t,a)=>(l(),c("div",{key:a,class:"flex items-center space-x-2 mt-2"},[e("div",Qe,[f(N,{for:`start_time_${s.value}_${a}`,value:"Start Time",class:"text-xs"},null,8,["for"]),z(e("input",{id:`start_time_${s.value}_${a}`,type:"time","onUpdate:modelValue":j=>t.start_time=j,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Xe),[[X,t.start_time]])]),e("div",Ze,[f(N,{for:`end_time_${s.value}_${a}`,value:"End Time",class:"text-xs"},null,8,["for"]),z(e("input",{id:`end_time_${s.value}_${a}`,type:"time","onUpdate:modelValue":j=>t.end_time=j,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Oe),[[X,t.end_time]])]),d.value[s.value].timeSlots.length>1?(l(),c("div",et,[e("button",{type:"button",onClick:j=>V(s.value,a),class:"p-2 text-red-600 hover:text-red-800"},o[2]||(o[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,tt)])):S("",!0)]))),128)),e("button",{type:"button",onClick:t=>L(s.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},o[3]||(o[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),$(" Add Another Time Slot ",-1)]),8,st)])):S("",!0)])):S("",!0)],2)}),128)),e("div",at,[f(ce,{onClick:o[0]||(o[0]=s=>p.$emit("close"))},{default:y(()=>o[4]||(o[4]=[$(" Cancel ",-1)])),_:1,__:[4]}),f(se,{disabled:g.value,class:E({"opacity-50":g.value})},{default:y(()=>[g.value?(l(),c("span",ot,o[5]||(o[5]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),$(" Saving... ",-1)]))):(l(),c("span",lt,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},nt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},it={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},dt={class:"flex justify-center"},ut={__name:"AvailabilityBlocker",setup(i){const h=C(!1),r=C(!0),w=C(!1),u=C([]),d=P(()=>{var b;return((b=ae().props.auth.user)==null?void 0:b.id)||null}),n=()=>{const b=localStorage.getItem("authToken");b&&!F.defaults.headers.common.Authorization&&(F.defaults.headers.common.Authorization=`Bearer ${b}`)},g=async()=>{r.value=!0;const b=localStorage.getItem("shouldBlockUser"),p=localStorage.getItem("allWeekdaysCovered");if(b==="true"&&p==="false")h.value=!0,await k();else try{n();const o=await F.get("/api/availability-prompt");h.value=o.data.should_block_user&&!o.data.all_weekdays_covered,h.value&&await k()}catch(o){console.error("Error checking if user should be blocked:",o),h.value=!1}r.value=!1},k=async()=>{try{n();const b=await F.get("/api/availability-prompt");x(b.data.next_week_start,b.data.next_week_end)}catch(b){console.error("Error fetching next week dates:",b)}},x=(b,p)=>{const o=[],s=new Date(b),m=new Date(p),v=new Date(s);for(;v<=m;)o.push({value:v.toISOString().split("T")[0],label:v.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),v.setDate(v.getDate()+1);u.value=o},_=()=>{w.value=!0},M=()=>{g()},L=b=>{h.value=b.detail.shouldBlockUser&&!b.detail.allWeekdaysCovered},V=()=>{document.visibilityState==="visible"&&oe(()=>{g()})},T=b=>{(b.key==="shouldBlockUser"||b.key==="allWeekdaysCovered")&&oe(()=>{g()})};return Z(()=>{g(),window.addEventListener("availability-status-updated",L),document.addEventListener("visibilitychange",V),window.addEventListener("storage",T)}),re(()=>{window.removeEventListener("availability-status-updated",L),document.removeEventListener("visibilitychange",V),window.removeEventListener("storage",T)}),(b,p)=>h.value&&!r.value?(l(),c("div",nt,[e("div",it,[p[2]||(p[2]=be('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),e("div",dt,[f(se,{onClick:_,class:"bg-red-600 hover:bg-red-700"},{default:y(()=>p[1]||(p[1]=[$(" Submit Availability Now ",-1)])),_:1,__:[1]})]),f(rt,{show:w.value,"next-week-dates":u.value,date:u.value.length>0?u.value[0].value:"",userId:d.value,onClose:p[0]||(p[0]=o=>w.value=!1),onAvailabilitySaved:M},null,8,["show","next-week-dates","date","userId"])])])):S("",!0)}};let le=null;const ct=i=>{le=i},me=(i,h="info",r=5e3)=>le?le.addNotification(i,h,r):(console.warn("Notification container not set. Call setNotificationContainer first."),null),vt=(i,h=5e3)=>me(i,"success",h),mt=(i,h=5e3)=>me(i,"error",h),ft={class:"p-6"},pt={class:"flex justify-between items-center mb-4"},gt={class:"text-lg font-medium text-gray-900"},yt={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},ht={class:"block sm:inline"},bt={key:0,class:"mt-6 flex justify-end space-x-3"},wt={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:i=>["post","put","patch","delete"].includes(i.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:i=>i},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(i,{emit:h}){const r=i,w=h,u=C(!1),d=C({}),n=C("");Q(()=>r.show,x=>{x&&(d.value={},n.value="",u.value=!1)});const g=async()=>{u.value=!0,d.value={},n.value="";try{const x=r.formatDataForApi(r.formData);console.log("BaseFormModal: Data being sent to API:",x);let _;const M=r.httpMethod.toLowerCase();if(M==="post")_=await window.axios.post(r.apiEndpoint,x);else if(M==="put")_=await window.axios.put(r.apiEndpoint,x);else if(M==="patch")_=await window.axios.patch(r.apiEndpoint,x);else if(M==="delete")_=await window.axios.delete(r.apiEndpoint,{data:x});else throw new Error(`Unsupported HTTP method: ${r.httpMethod}`);vt(r.successMessage),w("submitted",_.data),w("close")}catch(x){console.error("BaseFormModal: API submission error:",x),x.response?x.response.status===422?(d.value=x.response.data.errors,n.value="Please correct the errors in the form."):n.value=x.response.data.message||"An unexpected error occurred.":n.value="A network error occurred or the server is unreachable.",mt(n.value),w("error",x)}finally{u.value=!1}},k=()=>{w("close")};return(x,_)=>(l(),I(ve,{show:i.show,onClose:k},{default:y(()=>[e("div",ft,[e("div",pt,[e("h2",gt,B(i.title),1),e("button",{onClick:k,class:"text-gray-400 hover:text-gray-500"},_[0]||(_[0]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),n.value?(l(),c("div",yt,[e("span",ht,B(n.value),1)])):S("",!0),e("form",{onSubmit:ne(g,["prevent"])},[J(x.$slots,"default",{errors:d.value},void 0,!0),i.showFooter?(l(),c("div",bt,[f(ce,{onClick:k,type:"button",disabled:u.value},{default:y(()=>_[1]||(_[1]=[$(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),f(se,{type:"submit",disabled:u.value,class:E({"opacity-75 cursor-not-allowed":u.value})},{default:y(()=>[$(B(u.value?"Submitting...":i.submitButtonText),1)]),_:1},8,["disabled","class"])])):S("",!0)],32)])]),_:3},8,["show"]))}},kt=te(wt,[["__scopeId","data-v-a2f6d2f8"]]),xt=["disabled"],_t={class:"absolute z-50 mt-1 w-full rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"},$t={class:"p-2 border-b border-gray-200"},St=["onClick"],Ct={key:0,class:"block px-4 py-2 text-sm text-gray-500"},At={__name:"SelectDropdown",props:{modelValue:{type:[String,Number,Object,null],default:null},options:{type:Array,default:()=>[]},placeholder:{type:String,default:"Select an option"},valueKey:{type:String,default:"value"},labelKey:{type:String,default:"label"},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},maxHeight:{type:String,default:"250px"},width:{type:String,default:"full"}},emits:["update:modelValue","change"],setup(i,{emit:h}){const r=i,w=h,u=C(!1),d=C(""),n=C(null),g=C(null),k=P(()=>{if(!d.value)return r.options;const T=d.value.toLowerCase();return r.options.filter(b=>b[r.labelKey].toLowerCase().includes(T))}),x=T=>{n.value&&!n.value.contains(T.target)&&(u.value=!1,d.value="")},_=T=>{T.key==="Escape"&&u.value&&(u.value=!1,d.value="")};Z(()=>{document.addEventListener("click",x),document.addEventListener("keydown",_)}),re(()=>{document.removeEventListener("click",x),document.removeEventListener("keydown",_)});const M=P(()=>{if(r.modelValue===null||r.modelValue===void 0||r.modelValue==="")return r.placeholder;const T=r.options.find(b=>b[r.valueKey]===r.modelValue);return T?T[r.labelKey]:r.placeholder}),L=T=>{w("update:modelValue",T[r.valueKey]),w("change",T[r.valueKey]),u.value=!1,d.value=""},V=()=>{r.disabled||(u.value=!u.value,u.value&&oe(()=>{g.value&&g.value.focus()}))};return Q(()=>r.modelValue,T=>{(T==null||T==="")&&(d.value="")}),(T,b)=>(l(),c("div",{ref_key:"dropdownRef",ref:n,class:E(["relative",{"w-full":i.width==="full"}])},[e("button",{type:"button",onClick:V,disabled:i.disabled,class:E(["border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full text-left px-3 py-2 text-gray-700 bg-white relative flex items-center justify-between",{"opacity-50 cursor-not-allowed":i.disabled}])},[e("span",{class:E({"text-gray-500":!r.modelValue})},B(M.value),3),b[3]||(b[3]=e("svg",{class:"h-4 w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))],10,xt),z(e("div",_t,[e("div",$t,[z(e("input",{ref_key:"searchInputRef",ref:g,type:"text","onUpdate:modelValue":b[0]||(b[0]=p=>d.value=p),onInput:b[1]||(b[1]=p=>u.value=!0),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm",placeholder:"Search...",onClick:b[2]||(b[2]=ne(()=>{},["stop"]))},null,544),[[X,d.value]])]),e("div",{class:"py-1 overflow-y-auto",style:we({maxHeight:i.maxHeight})},[(l(!0),c(H,null,q(k.value,p=>(l(),c("div",{key:p[i.valueKey],onClick:o=>L(p),class:E(["block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",{"bg-gray-100":p[i.valueKey]===i.modelValue}])},B(p[i.labelKey]),11,St))),128)),k.value.length===0?(l(),c("div",Ct," No options available ")):S("",!0)],4)],512),[[Y,u.value]])],2))}},ee=te(At,[["__scopeId","data-v-d21d43d1"]]),jt={class:"space-y-4"},Tt={key:0},Mt={key:0,class:"text-sm text-gray-500"},Et={key:0,class:"text-sm text-gray-500"},It={key:0,class:"text-sm text-gray-500"},Dt={key:0,class:"text-sm text-gray-500"},Pt="Create New Task",Bt="/api/tasks",Lt="post",Vt="Create Task",zt="Task created successfully!",Ut={__name:"CreateTaskModal",props:{show:Boolean,projectId:{type:Number,default:null}},emits:["close","saved"],setup(i,{emit:h}){const r=i,w=h,u=ke({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:r.projectId}),d=["To Do","In Progress","Done","Blocked","Archived"],n=C([]),g=C([]),k=C([]),x=C([]),_=C(!0),M=C(!1),L=C(!1),V=C(!1);Q(()=>r.show,async t=>{t&&(Object.assign(u,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:r.projectId}),r.projectId?await b(r.projectId):await T())},{immediate:!0}),Q(()=>u.project_id,async t=>{t?await b(t):(g.value=[],k.value=[],x.value=[])});const T=async()=>{_.value=!0;try{const t=await window.axios.get("/api/projects-simplified");n.value=t.data.map(a=>({value:a.id,label:a.name}))}catch(t){console.error("Error fetching projects:",t),n.value=[]}finally{_.value=!1}},b=async t=>{if(t){M.value=!0,L.value=!0,V.value=!0;try{const[a,j,A]=await Promise.all([window.axios.get(`/api/projects/${t}/users`),window.axios.get("/api/task-types"),window.axios.get(`/api/projects/${t}/milestones`)]);g.value=a.data.map(R=>({value:R.id,label:R.name})),k.value=j.data.map(R=>({value:R.id,label:R.name})),x.value=A.data.map(R=>({value:R.id,label:R.name}))}catch(a){console.error("Error fetching associated task data:",a),g.value=[],k.value=[],x.value=[]}finally{M.value=!1,L.value=!1,V.value=!1}}},p=t=>{w("saved",t),w("close")},o=()=>{w("close")},s=P(()=>g.value),m=P(()=>k.value),v=P(()=>x.value);return(t,a)=>(l(),I(kt,{show:i.show,title:Pt,"api-endpoint":Bt,"http-method":Lt,"form-data":u,"submit-button-text":Vt,"success-message":zt,onClose:o,onSubmitted:p},{default:y(({errors:j})=>[e("div",jt,[i.projectId?S("",!0):(l(),c("div",Tt,[f(N,{for:"task-project",value:"Project"}),_.value?(l(),c("div",Mt,"Loading projects...")):(l(),I(ee,{key:1,id:"task-project",modelValue:u.project_id,"onUpdate:modelValue":a[0]||(a[0]=A=>u.project_id=A),options:n.value,"value-key":"value","label-key":"label",placeholder:"Select a project",class:"mt-1",required:!0},null,8,["modelValue","options"])),f(W,{message:j.project_id?j.project_id[0]:"",class:"mt-2"},null,8,["message"])])),e("div",null,[f(N,{for:"task-name",value:"Task Name"}),f(ie,{id:"task-name",modelValue:u.name,"onUpdate:modelValue":a[1]||(a[1]=A=>u.name=A),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),f(W,{message:j.name?j.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[f(N,{for:"task-description",value:"Description"}),z(e("textarea",{id:"task-description","onUpdate:modelValue":a[2]||(a[2]=A=>u.description=A),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[X,u.description]]),f(W,{message:j.description?j.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[f(N,{for:"task-status",value:"Status"}),f(ee,{id:"task-status",modelValue:u.status,"onUpdate:modelValue":a[3]||(a[3]=A=>u.status=A),options:d.map(A=>({value:A,label:A})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),f(W,{message:j.status?j.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[f(N,{for:"task-due-date",value:"Due Date"}),f(ie,{id:"task-due-date",modelValue:u.due_date,"onUpdate:modelValue":a[4]||(a[4]=A=>u.due_date=A),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),f(W,{message:j.due_date?j.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[f(N,{for:"task-assigned-to",value:"Assigned To"}),M.value?(l(),c("div",Et,"Loading users...")):(l(),I(ee,{key:1,id:"task-assigned-to",modelValue:u.assigned_to_user_id,"onUpdate:modelValue":a[5]||(a[5]=A=>u.assigned_to_user_id=A),options:s.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(W,{message:j.assigned_to_user_id?j.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[f(N,{for:"task-type",value:"Task Type"}),L.value?(l(),c("div",It,"Loading task types...")):(l(),I(ee,{key:1,id:"task-type",modelValue:u.task_type_id,"onUpdate:modelValue":a[6]||(a[6]=A=>u.task_type_id=A),options:m.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(W,{message:j.task_type_id?j.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[f(N,{for:"task-milestone",value:"Milestone"}),V.value?(l(),c("div",Dt,"Loading milestones...")):(l(),I(ee,{key:1,id:"task-milestone",modelValue:u.milestone_id,"onUpdate:modelValue":a[7]||(a[7]=A=>u.milestone_id=A),options:v.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(W,{message:j.milestone_id?j.milestone_id[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]))}},Nt={class:"flex items-center p-4 h-16 border-b border-gray-700"},Rt={key:0,class:"text-xl font-semibold flex-1 truncate"},Wt=["title"],Ht={key:0,class:"p-4 border-b border-gray-700"},qt={class:"relative"},Ft={key:1,class:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-500 scrollbar-track-gray-700 p-4"},Kt={key:0,class:"mb-4"},Yt={class:"ml-2 mt-2 space-y-1"},Gt=["onClick"],Jt={class:"text-sm font-medium text-gray-300 truncate"},Qt={class:"ml-4 mt-1 space-y-1"},Xt={class:"truncate"},Zt={key:1,class:"mb-4"},Ot={class:"ml-2 mt-2 space-y-1"},es=["onClick"],ts={class:"text-sm font-medium text-gray-300 truncate"},ss={class:"ml-4 mt-1 space-y-1"},as={class:"truncate"},os={key:2,class:"mb-4"},ls={class:"ml-2 mt-2 space-y-1"},rs={class:"truncate"},ns={key:3,class:"text-gray-400 text-sm text-center py-4"},is={key:4,class:"text-gray-400 text-sm text-center py-4"},ds={key:2,class:"flex flex-col items-center pt-4 space-y-4"},us={key:0,class:"text-gray-400 text-xs text-center px-2"},cs={__name:"LeftSidebar",props:{allProjects:{type:Array,default:()=>[]},activeProjectId:{type:Number,default:null}},emits:["project-selected"],setup(i,{emit:h}){const r=i,w=h,u=C(localStorage.getItem("leftSidebarCollapsed")!=="false"),d=C(""),n=C({}),g=P(()=>{const o=new Set;return r.allProjects.forEach(s=>{s.project_type&&o.add(s.project_type)}),Array.from(o).sort()}),k=P(()=>{const o=new Set;return r.allProjects.forEach(s=>{s.department&&o.add(s.department)}),Array.from(o).sort()}),x=P(()=>{if(!d.value)return r.allProjects;const o=d.value.toLowerCase();return r.allProjects.filter(s=>{var m,v,t;return s.name.toLowerCase().includes(o)||((m=s.description)==null?void 0:m.toLowerCase().includes(o))||((v=s.project_type)==null?void 0:v.toLowerCase().includes(o))||((t=s.department)==null?void 0:t.toLowerCase().includes(o))})}),_=P(()=>{const o={};x.value.forEach(s=>{s.project_type&&(o[s.project_type]||(o[s.project_type]=[]),o[s.project_type].push(s))});for(const s in o)o[s].sort((m,v)=>m.name.localeCompare(v.name));return o}),M=P(()=>{const o={};x.value.forEach(s=>{s.department&&(o[s.department]||(o[s.department]=[]),o[s.department].push(s))});for(const s in o)o[s].sort((m,v)=>m.name.localeCompare(v.name));return o}),L=P(()=>x.value.filter(o=>!o.project_type&&!o.department).sort((o,s)=>o.name.localeCompare(s.name)));Q(()=>r.allProjects,()=>{g.value.forEach(o=>{const s=`type-${o}`;n.value[s]===void 0&&(n.value[s]=!0)}),k.value.forEach(o=>{const s=`department-${o}`;n.value[s]===void 0&&(n.value[s]=!0)}),n.value["main-types"]===void 0&&(n.value["main-types"]=!1),n.value["main-departments"]===void 0&&(n.value["main-departments"]=!1),n.value.uncategorized===void 0&&(n.value.uncategorized=!1)},{immediate:!0}),Q(u,o=>{localStorage.setItem("leftSidebarCollapsed",o)});const V=()=>{u.value=!u.value},T=o=>{n.value[o]=!n.value[o]},b=o=>{w("project-selected",o)},p=()=>{d.value=""};return(o,s)=>(l(),c("div",{class:E({"w-64":!u.value,"w-16":u.value,"min-w-16":!0,"bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out shrink-0 h-screen overflow-hidden":!0})},[e("div",Nt,[u.value?S("",!0):(l(),c("h2",Rt,"Projects")),e("button",{onClick:V,class:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:u.value?"Expand Sidebar":"Collapse Sidebar"},[(l(),c("svg",{class:E(["w-6 h-6 text-gray-400 transform transition-transform duration-300",{"rotate-180":u.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},s[4]||(s[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],8,Wt)]),u.value?S("",!0):(l(),c("div",Ht,[e("div",qt,[z(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=m=>d.value=m),placeholder:"Search all projects...",class:"w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 text-sm"},null,512),[[X,d.value]]),d.value?(l(),c("button",{key:0,onClick:p,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200",title:"Clear search"},s[5]||(s[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):S("",!0)])])),u.value?(l(),c("div",ds,[(l(!0),c(H,null,q(r.allProjects,m=>(l(),I(D(G),{key:m.id,href:o.route("projects.show",m.id),onClick:v=>b(m.id),class:E({"w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-200":!0,"bg-indigo-600 text-white":m.id===i.activeProjectId,"bg-gray-700 text-gray-300 hover:bg-gray-600":m.id!==i.activeProjectId}),title:m.name},{default:y(()=>[$(B(m.name.charAt(0).toUpperCase()),1)]),_:2},1032,["href","onClick","class","title"]))),128)),i.allProjects.length===0?(l(),c("div",us," No Projects ")):S("",!0)])):(l(),c("div",Ft,[Object.keys(_.value).length>0?(l(),c("div",Kt,[e("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:s[1]||(s[1]=m=>T("main-types"))},[s[7]||(s[7]=e("h3",{class:"text-sm font-semibold text-gray-400"},"By Type",-1)),(l(),c("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!n.value["main-types"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s[6]||(s[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),z(e("div",Yt,[(l(!0),c(H,null,q(_.value,(m,v)=>(l(),c("div",{key:v},[e("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:t=>T(`type-${v}`)},[e("h4",Jt,B(v),1),(l(),c("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!n.value[`type-${v}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s[8]||(s[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,Gt),z(e("ul",Qt,[(l(!0),c(H,null,q(m,t=>(l(),c("li",{key:t.id},[f(D(G),{href:o.route("projects.show",t.id),onClick:a=>b(t.id),class:E({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":t.id===i.activeProjectId,"hover:bg-gray-700 text-gray-200":t.id!==i.activeProjectId,"font-bold":t.id===i.activeProjectId})},{default:y(()=>[e("span",Xt,B(t.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[Y,!n.value[`type-${v}`]]])]))),128))],512),[[Y,!n.value["main-types"]]])])):S("",!0),Object.keys(M.value).length>0?(l(),c("div",Zt,[e("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:s[2]||(s[2]=m=>T("main-departments"))},[s[10]||(s[10]=e("h3",{class:"text-sm font-semibold text-gray-400"},"By Department",-1)),(l(),c("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!n.value["main-departments"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s[9]||(s[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),z(e("div",Ot,[(l(!0),c(H,null,q(M.value,(m,v)=>(l(),c("div",{key:v},[e("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:t=>T(`department-${v}`)},[e("h4",ts,B(v),1),(l(),c("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!n.value[`department-${v}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s[11]||(s[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,es),z(e("ul",ss,[(l(!0),c(H,null,q(m,t=>(l(),c("li",{key:t.id},[f(D(G),{href:o.route("projects.show",t.id),onClick:a=>b(t.id),class:E({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":t.id===i.activeProjectId,"hover:bg-gray-700 text-gray-200":t.id!==i.activeProjectId,"font-bold":t.id===i.activeProjectId})},{default:y(()=>[e("span",as,B(t.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[Y,!n.value[`department-${v}`]]])]))),128))],512),[[Y,!n.value["main-departments"]]])])):S("",!0),L.value.length>0?(l(),c("div",os,[e("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:s[3]||(s[3]=m=>T("uncategorized"))},[s[13]||(s[13]=e("h3",{class:"text-sm font-semibold text-gray-400"},"Uncategorized",-1)),(l(),c("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!n.value.uncategorized}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s[12]||(s[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),z(e("ul",ls,[(l(!0),c(H,null,q(L.value,m=>(l(),c("li",{key:m.id},[f(D(G),{href:o.route("projects.show",m.id),onClick:v=>b(m.id),class:E({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":m.id===i.activeProjectId,"hover:bg-gray-700 text-gray-200":m.id!==i.activeProjectId,"font-bold":m.id===i.activeProjectId})},{default:y(()=>[e("span",rs,B(m.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[Y,!n.value.uncategorized]])])):S("",!0),x.value.length===0?(l(),c("div",ns," No projects found matching your search. ")):i.allProjects.length===0&&!d.value?(l(),c("div",is," No projects available. ")):S("",!0)]))],2))}},vs=te(cs,[["__scopeId","data-v-f6516893"]]),ms={class:"flex h-screen overflow-hidden"},fs={class:"flex-1 flex flex-col overflow-hidden"},ps={class:"border-b border-gray-100 bg-white z-10 relative"},gs={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},ys={class:"flex h-16 justify-between"},hs={class:"flex"},bs={class:"flex shrink-0 items-center"},ws={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},ks={key:4,class:"hidden sm:flex sm:items-center"},xs={class:"hidden sm:ms-6 sm:flex sm:items-center"},_s={class:"relative ms-3"},$s={class:"inline-flex rounded-md"},Ss={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},Cs={class:"-me-2 flex items-center sm:hidden"},As={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},js={class:"space-y-1 pb-3 pt-2"},Ts={key:6,class:"mt-3 space-y-1"},Ms={class:"border-t border-gray-200 pb-1 pt-4"},Es={class:"px-4"},Is={class:"text-base font-medium text-gray-800"},Ds={class:"text-sm font-medium text-gray-500"},Ps={class:"text-sm font-medium text-gray-500 capitalize"},Bs={class:"mt-3 space-y-1"},Ls={key:0,class:"bg-white shadow"},Vs={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},zs={class:"flex-1 overflow-y-auto"},Fs={__name:"AuthenticatedLayout",setup(i){const h=C(!1),r=P(()=>ae().props.auth.user);P(()=>{var t;return((t=r.value.role_data)==null?void 0:t.name)||""});const{canDo:w}=xe(),u=w("manage_projects"),d=w("compose_emails"),n=w("approve_emails"),g=w("create_users"),k=w("manage_roles"),x=w("manage_task_types"),_=w("create_clients"),M=C(!1),L=C([]),V=C(!0),T=P(()=>ae().props.id||null),b=async()=>{const t=localStorage.getItem("authToken");if(t){window.axios.defaults.headers.common.Authorization=`Bearer ${t}`;try{await window.axios.get("/api/user")}catch(a){a.response&&a.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},p=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization},o=t=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},s=async()=>{V.value=!0;try{const t=await window.axios.get("/api/projects-simplified");L.value=t.data}catch(t){console.error("Error fetching all projects for sidebar:",t),L.value=[]}finally{V.value=!1}},m=t=>{_e.visit(route("projects.show",t))},v=C(null);return Z(()=>{b(),v.value&&ct(v.value),s()}),(t,a)=>{var j;return l(),c("div",ms,[f(vs,{"all-projects":L.value,"active-project-id":T.value,onProjectSelected:m},null,8,["all-projects","active-project-id"]),e("div",fs,[e("nav",ps,[e("div",gs,[e("div",ys,[e("div",hs,[e("div",bs,[f(D(G),{href:t.route("dashboard")},{default:y(()=>[f(pe,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),e("div",ws,[f(O,{href:t.route("dashboard"),active:t.route().current("dashboard")},{default:y(()=>a[5]||(a[5]=[$(" Dashboard ",-1)])),_:1,__:[5]},8,["href","active"]),D(u)?(l(),I(O,{key:0,href:t.route("projects.index"),active:t.route().current("projects.index")},{default:y(()=>a[6]||(a[6]=[$(" Projects ",-1)])),_:1,__:[6]},8,["href","active"])):S("",!0),D(n)?(l(),I(O,{key:1,href:t.route("emails.pending"),active:t.route().current("emails.pending")},{default:y(()=>a[7]||(a[7]=[$(" Approve Emails ",-1)])),_:1,__:[7]},8,["href","active"])):S("",!0),D(d)?(l(),I(O,{key:2,href:t.route("emails.rejected"),active:t.route().current("emails.rejected")},{default:y(()=>a[8]||(a[8]=[$(" Rejected Emails ",-1)])),_:1,__:[8]},8,["href","active"])):S("",!0),D(g)?(l(),I(O,{key:3,href:t.route("availability.index"),active:t.route().current("availability.index")},{default:y(()=>a[9]||(a[9]=[$(" Weekly Availability ",-1)])),_:1,__:[9]},8,["href","active"])):S("",!0),D(k)?(l(),c("div",ks,[f(de,{align:"right",width:"48"},{trigger:y(()=>a[10]||(a[10]=[e("span",{class:"inline-flex rounded-md"},[e("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},[$(" Admin "),e("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:y(()=>[D(_)?(l(),I(K,{key:0,href:t.route("clients.index"),active:t.route().current("clients.index")},{default:y(()=>a[11]||(a[11]=[$(" Clients ",-1)])),_:1,__:[11]},8,["href","active"])):S("",!0),D(g)?(l(),I(K,{key:1,href:t.route("users.index"),active:t.route().current("users.index")},{default:y(()=>a[12]||(a[12]=[$(" Users ",-1)])),_:1,__:[12]},8,["href","active"])):S("",!0),D(x)?(l(),I(K,{key:2,href:t.route("task-types.index"),active:t.route().current("task-types.index")},{default:y(()=>a[13]||(a[13]=[$(" Task Types ",-1)])),_:1,__:[13]},8,["href","active"])):S("",!0),f(K,{href:t.route("bonus-configuration.index"),active:t.route().current("bonus-configuration.index")},{default:y(()=>a[14]||(a[14]=[$(" Bonus Configuration ",-1)])),_:1,__:[14]},8,["href","active"]),f(K,{href:t.route("admin.roles.index")},{default:y(()=>a[15]||(a[15]=[$(" Manage Roles ",-1)])),_:1,__:[15]},8,["href"]),f(K,{href:t.route("admin.permissions.index")},{default:y(()=>a[16]||(a[16]=[$(" Manage Permissions ",-1)])),_:1,__:[16]},8,["href"])]),_:1})])):S("",!0)])]),e("div",xs,[f(se,{type:"button",onClick:a[0]||(a[0]=A=>M.value=!0),class:"mr-4 px-4 py-2 text-sm"},{default:y(()=>a[17]||(a[17]=[$(" Add Task ",-1)])),_:1,__:[17]}),e("div",_s,[f(de,{align:"right",width:"48"},{trigger:y(()=>{var A;return[e("span",$s,[e("button",Ss,[$(B(r.value.name)+" ("+B((A=r.value.role_data)==null?void 0:A.name)+") ",1),a[18]||(a[18]=e("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:y(()=>[f(K,{href:t.route("profile.edit")},{default:y(()=>a[19]||(a[19]=[$(" Profile ",-1)])),_:1,__:[19]},8,["href"]),f(K,{href:t.route("logout"),method:"post",as:"button",onSuccess:p,onError:o},{default:y(()=>a[20]||(a[20]=[$(" Log Out ",-1)])),_:1,__:[20]},8,["href"])]),_:1})])]),e("div",Cs,[e("button",{onClick:a[1]||(a[1]=A=>h.value=!h.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(l(),c("svg",As,[e("path",{class:E({hidden:h.value,"inline-flex":!h.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),e("path",{class:E({hidden:!h.value,"inline-flex":h.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])]),e("div",{class:E([{block:h.value,hidden:!h.value},"sm:hidden"])},[e("div",js,[f(U,{href:t.route("dashboard"),active:t.route().current("dashboard")},{default:y(()=>a[21]||(a[21]=[$(" Dashboard ",-1)])),_:1,__:[21]},8,["href","active"]),D(_)?(l(),I(U,{key:0,href:t.route("clients.index"),active:t.route().current("clients.index")},{default:y(()=>a[22]||(a[22]=[$(" Clients ",-1)])),_:1,__:[22]},8,["href","active"])):S("",!0),D(u)?(l(),I(U,{key:1,href:t.route("projects.index"),active:t.route().current("projects.index")},{default:y(()=>a[23]||(a[23]=[$(" Projects ",-1)])),_:1,__:[23]},8,["href","active"])):S("",!0),D(g)?(l(),I(U,{key:2,href:t.route("users.index"),active:t.route().current("users.index")},{default:y(()=>a[24]||(a[24]=[$(" Users ",-1)])),_:1,__:[24]},8,["href","active"])):S("",!0),D(d)?(l(),I(U,{key:3,href:t.route("emails.compose"),active:t.route().current("emails.compose")},{default:y(()=>a[25]||(a[25]=[$(" Compose Email ",-1)])),_:1,__:[25]},8,["href","active"])):S("",!0),D(n)?(l(),I(U,{key:4,href:t.route("emails.pending"),active:t.route().current("emails.pending")},{default:y(()=>a[26]||(a[26]=[$(" Approve Emails ",-1)])),_:1,__:[26]},8,["href","active"])):S("",!0),D(d)?(l(),I(U,{key:5,href:t.route("emails.rejected"),active:t.route().current("emails.rejected")},{default:y(()=>a[27]||(a[27]=[$(" Rejected Emails ",-1)])),_:1,__:[27]},8,["href","active"])):S("",!0),f(U,{href:t.route("availability.index"),active:t.route().current("availability.index")},{default:y(()=>a[28]||(a[28]=[$(" Weekly Availability ",-1)])),_:1,__:[28]},8,["href","active"]),D(k)?(l(),c("div",Ts,[a[31]||(a[31]=e("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),f(U,{href:t.route("admin.roles.index"),active:t.route().current("admin.roles.index")},{default:y(()=>a[29]||(a[29]=[$(" Manage Roles ",-1)])),_:1,__:[29]},8,["href","active"]),f(U,{href:t.route("admin.permissions.index"),active:t.route().current("admin.permissions.index")},{default:y(()=>a[30]||(a[30]=[$(" Manage Permissions ",-1)])),_:1,__:[30]},8,["href","active"])])):S("",!0)]),e("div",Ms,[e("div",Es,[e("div",Is,B(r.value.name),1),e("div",Ds,B(r.value.email),1),e("div",Ps,B((j=r.value.role_data)==null?void 0:j.name),1)]),e("div",Bs,[f(U,{as:"button",onClick:a[2]||(a[2]=A=>M.value=!0)},{default:y(()=>a[32]||(a[32]=[$(" Add Task ",-1)])),_:1,__:[32]}),f(U,{href:t.route("profile.edit")},{default:y(()=>a[33]||(a[33]=[$(" Profile ",-1)])),_:1,__:[33]},8,["href"]),f(U,{href:t.route("logout"),method:"post",as:"button",onSuccess:p,onError:o},{default:y(()=>a[34]||(a[34]=[$(" Log Out ",-1)])),_:1,__:[34]},8,["href"])])])],2)]),t.$slots.header?(l(),c("header",Ls,[e("div",Vs,[J(t.$slots,"header")])])):S("",!0),e("main",zs,[J(t.$slots,"default")]),f(Ut,{show:M.value,onClose:a[3]||(a[3]=A=>M.value=!1),onSaved:a[4]||(a[4]=A=>M.value=!1)},null,8,["show"])]),f(De,{ref_key:"notificationContainerRef",ref:v},null,512),f(ut)])}}};export{kt as B,ee as S,Fs as _,rt as a,Ut as b,mt as e,vt as s};
