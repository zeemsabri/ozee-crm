import{a as o,o as l,b as t,r as p,c as B,E as W,f as q,d as m,u as v,h as J,w as F,i as u,j as A,m as b,t as n,v as x,x as L,F as g,l as w,G as D,z as T,g as V,p as N}from"./app-0RB-mjiy.js";import{_ as K}from"./AuthenticatedLayout-C-A3rByx.js";import{_ as Q}from"./PrimaryButton-CXujG8WJ.js";import{_ as X}from"./SecondaryButton-DKeLgF1R.js";import{_ as Y}from"./MultiSelectDropdown-CS-WvKhg.js";import{r as ee,a as te}from"./PlusCircleIcon-DBbPRgKJ.js";import{r as se}from"./ListBulletIcon-DWVoBJ5i.js";import{r as le}from"./UsersIcon-BngYQDcg.js";import"./Modal-D75_tpbt.js";import"./InputLabel-Cnr1QJ2p.js";import"./InputError-Bqxa1dAi.js";import"./index-CR0gQosK.js";import"./BaseFormModal-DG7n4WFK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-uOLgIx2M.js";import"./SelectDropdown-C-wL0wKL.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-CJ-4N-zK.js";import"./createLucideIcon-DLYYpXvw.js";import"./plus-DLR0uAml.js";import"./DangerButton-EWKhv4Gy.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-Bp0vH6r0.js";function ae(C,c){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M15.75 2.25H21a.75.75 0 0 1 .75.75v5.25a.75.75 0 0 1-1.5 0V4.81L8.03 17.03a.75.75 0 0 1-1.06-1.06L19.19 3.75h-3.44a.75.75 0 0 1 0-1.5Zm-10.5 4.5a1.5 1.5 0 0 0-1.5 1.5v10.5a1.5 1.5 0 0 0 1.5 1.5h10.5a1.5 1.5 0 0 0 1.5-1.5V10.5a.75.75 0 0 1 1.5 0v8.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V8.25a3 3 0 0 1 3-3h8.25a.75.75 0 0 1 0 1.5H5.25Z","clip-rule":"evenodd"})])}function oe(C,c){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M5.85 3.5a.75.75 0 0 0-1.117-1 9.719 9.719 0 0 0-2.348 4.876.75.75 0 0 0 1.479.248A8.219 8.219 0 0 1 5.85 3.5ZM19.267 2.5a.75.75 0 1 0-1.118 1 8.22 8.22 0 0 1 1.987 4.124.75.75 0 0 0 1.48-.248A9.72 9.72 0 0 0 19.266 2.5Z"}),t("path",{"fill-rule":"evenodd",d:"M12 2.25A6.75 6.75 0 0 0 5.25 9v.75a8.217 8.217 0 0 1-2.119 5.52.75.75 0 0 0 .298 1.206c1.544.57 3.16.99 4.831 1.243a3.75 3.75 0 1 0 7.48 0 24.583 24.583 0 0 0 4.83-1.244.75.75 0 0 0 .298-1.205 8.217 8.217 0 0 1-2.118-5.52V9A6.75 6.75 0 0 0 12 2.25ZM9.75 18c0-.034 0-.067.002-.1a25.05 25.05 0 0 0 4.496 0l.002.1a2.25 2.25 0 1 1-4.5 0Z","clip-rule":"evenodd"})])}function ie(C,c){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0 1 12 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 0 1 3.498 1.307 4.491 4.491 0 0 1 1.307 3.497A4.49 4.49 0 0 1 21.75 12a4.49 4.49 0 0 1-1.549 3.397 4.491 4.491 0 0 1-1.307 3.497 4.491 4.491 0 0 1-3.497 1.307A4.49 4.49 0 0 1 12 21.75a4.49 4.49 0 0 1-3.397-1.549 4.49 4.49 0 0 1-3.498-1.306 4.491 4.491 0 0 1-1.307-3.498A4.49 4.49 0 0 1 2.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 0 1 1.307-3.497 4.49 4.49 0 0 1 3.497-1.307Zm7.007 6.387a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function Z(C,c){return l(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M16.881 4.345A23.112 23.112 0 0 1 8.25 6H7.5a5.25 5.25 0 0 0-.88 10.427 21.593 21.593 0 0 0 1.378 3.94c.464 1.004 1.674 1.32 2.582.796l.657-.379c.88-.508 1.165-1.593.772-2.468a17.116 17.116 0 0 1-.628-1.607c1.918.258 3.76.75 5.5 1.446A21.727 21.727 0 0 0 18 11.25c0-2.414-.393-4.735-1.119-6.905ZM18.26 3.74a23.22 23.22 0 0 1 1.24 7.51 23.22 23.22 0 0 1-1.41 7.992.75.75 0 1 0 1.409.516 24.555 24.555 0 0 0 1.415-6.43 2.992 2.992 0 0 0 .836-2.078c0-.807-.319-1.54-.836-2.078a24.65 24.65 0 0 0-1.415-6.43.75.75 0 1 0-1.409.516c.059.16.116.321.17.483Z"})])}const re={class:"py-12"},ne={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},de={class:"bg-white shadow-xl sm:rounded-2xl p-6"},ue={class:"flex items-center justify-between border-b pb-4 mb-8"},ce={class:"flex space-x-2"},pe={key:1,class:"space-y-6"},me={key:0,class:"text-red-600 text-sm mt-1"},ve={key:0,class:"text-red-600 text-sm mt-1"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ge=["value"],fe={key:0,class:"text-red-600 text-sm mt-1"},ye={key:0,class:"text-red-600 text-sm mt-1"},be={key:0,class:"text-red-600 text-sm mt-1"},we={class:"flex items-center"},_e={class:"flex flex-wrap gap-4"},he={class:"inline-flex items-center gap-2 cursor-pointer transition-transform duration-100 hover:scale-105"},ke={class:"inline-flex items-center gap-2 cursor-pointer transition-transform duration-100 hover:scale-105"},Ce={key:0,class:"text-red-600 text-sm mt-1"},je={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ae={key:0,class:"text-red-600 text-sm"},Ve=["value"],Ne={key:0,class:"text-red-600 text-sm"},Ue={class:"mt-6"},$e={key:0,class:"flex items-center"},Me={key:1},Be={key:2},Fe={class:"flex items-center justify-between gap-2 mb-4"},Le={class:"flex items-center space-x-2"},De=["value"],Te={key:0,class:"text-center p-8"},Se={key:1,class:"space-y-4"},Ze={class:"flex items-start justify-between"},Ee={class:"flex-1 min-w-0"},Pe={class:"flex items-center gap-2 mb-1"},ze={class:"text-lg font-bold text-gray-900 truncate"},He={class:"text-xs text-gray-500 mb-2"},Ie={class:"mr-2"},Ge={class:"text-sm text-gray-700 mt-2 whitespace-pre-line leading-relaxed"},Re={key:0,class:"mt-4 pt-3 border-t border-gray-200"},Oe={class:"flex items-center gap-2 mb-2 text-xs font-semibold text-gray-600"},We={class:"space-y-2"},qe={class:"text-sm font-medium text-gray-800"},Je={class:"flex flex-wrap gap-2 mt-1"},Ke={key:0,class:"flex-shrink-0 ml-4 text-right"},Qe=["href"],Xe={key:0,class:"text-center text-gray-500 p-8"},kt={__name:"Index",setup(C){const c=p("create"),a=p({title:"",description:"",url:"",type:"General",visible_to_client:!1,channels:["push"],user_ids:[],project_id:null,file:null}),S=["General","Warning","Updates","Final Notice"],j=p(!1),d=p({}),f=p(""),U=p([]),$=p([]),_=p(""),h=p([]),M=p(!1);B(()=>W().props.auth.user);const E=async()=>{var i;try{const[e,s]=await Promise.all([N.get("/api/users",{params:{per_page:200}}),N.get("/api/projects-simplified")]),r=((i=e.data)==null?void 0:i.data)??e.data;U.value=Array.isArray(r)?r:[],$.value=Array.isArray(s.data)?s.data:[]}catch(e){console.error("Failed to load users or projects",e),U.value=[],$.value=[]}},P=async()=>{var i;d.value={},f.value="";try{j.value=!0;let e={},s;if(a.value.file){const r=new FormData;r.append("title",a.value.title||""),a.value.description&&r.append("description",a.value.description),a.value.url&&r.append("url",a.value.url),r.append("type",a.value.type),r.append("visible_to_client",a.value.visible_to_client?"1":"0"),(a.value.channels||[]).forEach(y=>r.append("channels[]",y)),(a.value.user_ids||[]).forEach(y=>r.append("user_ids[]",y)),a.value.project_id&&r.append("project_id",a.value.project_id),r.append("file",a.value.file),s=r,e.headers={"Content-Type":"multipart/form-data"}}else s={...a.value},s.project_id||delete s.project_id,(!s.user_ids||s.user_ids.length===0)&&delete s.user_ids,delete s.file;await N.post("/api/notices",s,e),f.value="Notice created and notifications sent.",a.value={title:"",description:"",url:"",type:"General",visible_to_client:!1,channels:["push"],user_ids:[],project_id:null,file:null},c.value==="list"&&await k()}catch(e){((i=e.response)==null?void 0:i.status)===422?d.value=e.response.data.errors||{}:f.value="Failed to create notice."}finally{j.value=!1}},z=B(()=>["All",...S]),k=async()=>{var i;M.value=!0;try{const e={};_.value&&_.value!=="All"&&(e.type=_.value);const s=await N.get("/api/notices",{params:e}),r=((i=s.data)==null?void 0:i.data)??s.data;h.value=Array.isArray(r)?r:Array.isArray(s.data)?s.data:[]}catch(e){console.error("Failed to load notices",e),h.value=[]}finally{M.value=!1}},H=i=>{switch(i){case"Warning":return"bg-red-100 text-red-800";case"Updates":return"bg-blue-100 text-blue-800";case"Final Notice":return"bg-yellow-100 text-yellow-800";case"General":default:return"bg-indigo-100 text-indigo-800"}},I=i=>{if(!i)return"";try{return new Date(i).toLocaleString()}catch{return String(i)}},G=i=>{switch(i){case"read":return"Read";case"click":return"Click";case"email_open":return"Email Open";default:return i}},R=B(()=>U.value.map(i=>({value:i.id,label:`${i.name} (${i.email})`})));return q(async()=>{await E(),c.value==="list"&&await k()}),(i,e)=>(l(),o(g,null,[m(v(J),{title:"Notice Board"}),m(K,null,{default:F(()=>[t("div",re,[t("div",ne,[t("div",de,[t("div",ue,[e[15]||(e[15]=t("h2",{class:"text-3xl font-extrabold text-gray-900"},"Notice Board",-1)),t("div",ce,[t("button",{class:A(["flex items-center px-4 py-2 rounded-xl transition-colors duration-200",c.value==="create"?"bg-indigo-500 text-white shadow-md":"text-gray-600 hover:bg-gray-100"]),onClick:e[0]||(e[0]=s=>c.value="create")},[m(v(ee),{class:"h-5 w-5 mr-2"}),e[13]||(e[13]=b(" Create Notice ",-1))],2),t("button",{class:A(["flex items-center px-4 py-2 rounded-xl transition-colors duration-200",c.value==="list"?"bg-indigo-500 text-white shadow-md":"text-gray-600 hover:bg-gray-100"]),onClick:e[1]||(e[1]=s=>(c.value="list",k()))},[m(v(se),{class:"h-5 w-5 mr-2"}),e[14]||(e[14]=b(" Existing Notices ",-1))],2)])]),f.value?(l(),o("div",{key:0,class:A(["mb-6 px-4 py-3 rounded-xl",f.value.includes("Failed")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"])},n(f.value),3)):u("",!0),c.value==="create"?(l(),o("div",pe,[t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Title",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.title=s),type:"text",class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[L,a.value.title]]),d.value.title?(l(),o("div",me,n(d.value.title[0]),1)):u("",!0)]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700"},"Description",-1)),x(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.description=s),rows:"4",class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[L,a.value.description]]),d.value.description?(l(),o("div",ve,n(d.value.description[0]),1)):u("",!0)]),t("div",xe,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700"},"Type",-1)),x(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.type=s),class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},[(l(),o(g,null,w(S,s=>t("option",{key:s,value:s},n(s),9,ge)),64))],512),[[D,a.value.type]]),d.value.type?(l(),o("div",fe,n(d.value.type[0]),1)):u("",!0)]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700"},"URL (optional)",-1)),x(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.url=s),type:"url",class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[L,a.value.url]]),d.value.url?(l(),o("div",ye,n(d.value.url[0]),1)):u("",!0)])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Upload Image or Document (optional)",-1)),t("input",{type:"file",accept:"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",class:"mt-1 block w-full text-sm text-gray-700",onChange:e[6]||(e[6]=s=>a.value.file=s.target.files&&s.target.files[0]?s.target.files[0]:null)},null,32),e[21]||(e[21]=t("p",{class:"text-xs text-gray-500 mt-1"},"If an image is uploaded, a thumbnail will be generated and shown on the notice.",-1)),d.value.file?(l(),o("div",be,n(d.value.file[0]),1)):u("",!0)]),t("div",we,[x(t("input",{id:"visible_to_client",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>a.value.visible_to_client=s),class:"h-5 w-5 text-indigo-600 rounded-lg border-gray-300 focus:ring-indigo-500"},null,512),[[T,a.value.visible_to_client]]),e[22]||(e[22]=t("label",{for:"visible_to_client",class:"ml-2 block text-sm text-gray-700"},"Visible to Client",-1))]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notification Channels",-1)),t("div",_e,[t("label",he,[x(t("input",{type:"checkbox",value:"push","onUpdate:modelValue":e[8]||(e[8]=s=>a.value.channels=s),class:"h-5 w-5 rounded-lg border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[T,a.value.channels]]),e[23]||(e[23]=t("span",{class:"text-gray-700"},"Push",-1))]),t("label",ke,[x(t("input",{type:"checkbox",value:"email","onUpdate:modelValue":e[9]||(e[9]=s=>a.value.channels=s),class:"h-5 w-5 rounded-lg border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[T,a.value.channels]]),e[24]||(e[24]=t("span",{class:"text-gray-700"},"Email",-1))])]),d.value.channels?(l(),o("div",Ce,n(d.value.channels[0]),1)):u("",!0)]),t("div",je,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Users (optional)",-1)),m(Y,{options:R.value,"is-multi":!0,modelValue:a.value.user_ids,"onUpdate:modelValue":e[10]||(e[10]=s=>a.value.user_ids=s),placeholder:"Select users to notify..."},null,8,["options","modelValue"]),e[27]||(e[27]=t("p",{class:"text-xs text-gray-500 mt-1"},"If users are selected, notification will be sent only to them.",-1)),d.value["user_ids.*"]?(l(),o("div",Ae,n(d.value["user_ids.*"][0]),1)):u("",!0)]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Project (optional)",-1)),x(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>a.value.project_id=s),class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},[e[28]||(e[28]=t("option",{value:null},"-- None --",-1)),(l(!0),o(g,null,w($.value,s=>(l(),o("option",{key:s.id,value:s.id},n(s.name),9,Ve))),128))],512),[[D,a.value.project_id]]),e[30]||(e[30]=t("p",{class:"text-xs text-gray-500 mt-1"},"If no users are selected and a project is selected, all users on that project will be notified.",-1)),d.value.project_id?(l(),o("div",Ne,n(d.value.project_id[0]),1)):u("",!0)])]),t("div",Ue,[m(Q,{onClick:P,disabled:j.value},{default:F(()=>[j.value?(l(),o("span",$e,e[31]||(e[31]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),b(" Saving... ",-1)]))):(l(),o("span",Me,"Create Notice"))]),_:1},8,["disabled"])])])):(l(),o("div",Be,[t("div",Fe,[t("div",Le,[e[32]||(e[32]=t("label",{class:"text-sm font-medium text-gray-700"},"Filter by Type:",-1)),x(t("select",{"onUpdate:modelValue":e[12]||(e[12]=s=>_.value=s),onChange:k,class:"border-gray-300 rounded-xl shadow-sm"},[(l(!0),o(g,null,w(z.value,s=>(l(),o("option",{key:s,value:s},n(s),9,De))),128))],544),[[D,_.value]])]),m(X,{onClick:k,class:"flex items-center gap-1"},{default:F(()=>[m(v(te),{class:"w-4 h-4"}),e[33]||(e[33]=b(" Refresh ",-1))]),_:1,__:[33]})]),M.value?(l(),o("div",Te,e[34]||(e[34]=[t("svg",{class:"animate-spin h-8 w-8 text-indigo-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),t("p",{class:"text-gray-500 text-sm mt-2"},"Loading notices...",-1)]))):(l(),o("div",Se,[(l(!0),o(g,null,w(h.value,s=>(l(),o("div",{key:s.id,class:"bg-gray-50 p-6 rounded-2xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow"},[t("div",Ze,[t("div",Ee,[t("div",Pe,[t("span",{class:A(["inline-flex items-center px-3 py-0.5 rounded-full text-xs font-medium",H(s.type)])},[s.type==="Warning"?(l(),V(v(oe),{key:0,class:"w-3 h-3 mr-1"})):s.type==="Updates"?(l(),V(v(Z),{key:1,class:"w-3 h-3 mr-1"})):s.type==="Final Notice"?(l(),V(v(ie),{key:2,class:"w-3 h-3 mr-1"})):(l(),V(v(Z),{key:3,class:"w-3 h-3 mr-1"})),b(" "+n(s.type),1)],2),t("h4",ze,n(s.title),1)]),t("div",He,[t("span",Ie,"Posted on: "+n(new Date(s.created_at).toLocaleDateString())+" at "+n(new Date(s.created_at).toLocaleTimeString()),1)]),t("div",Ge,n(s.description||"No description provided."),1),s.users_with_interactions&&s.users_with_interactions.length?(l(),o("div",Re,[t("div",Oe,[m(v(le),{class:"w-4 h-4"}),e[35]||(e[35]=t("span",null,"Interactions",-1))]),t("div",We,[(l(!0),o(g,null,w(s.users_with_interactions,r=>(l(),o("div",{key:r.user.id,class:""},[t("div",qe,n(r.user.name),1),t("div",Je,[(l(!0),o(g,null,w(r.interactions,(y,O)=>(l(),o("span",{key:O,class:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-700"},n(G(y.type))+" • "+n(I(y.created_at)),1))),128))])]))),128))])])):u("",!0)]),s.url?(l(),o("div",Ke,[t("a",{href:`/notices/${s.id}/redirect`,target:"_blank",class:"flex items-center text-indigo-600 hover:text-indigo-800 text-sm font-medium"},[e[36]||(e[36]=b(" Open Link ",-1)),m(v(ae),{class:"h-4 w-4 ml-1"})],8,Qe)])):u("",!0)])]))),128)),!h.value||h.value.length===0?(l(),o("div",Xe,"No notices found.")):u("",!0)]))]))])])])]),_:1})],64))}};export{kt as default};
