import{_ as j}from"./AuthenticatedLayout-BM_zJI8M.js";import{u as S,r as p,c as A,a as Y,o as s,w,b as c,d as e,e as k,h as E,f as o,g as v,t as n,F as b,i as y,n as J,j as K}from"./app-CwLjNXT3.js";import{P as O}from"./PrimaryButton-Bn1p3q-j.js";import{_ as B}from"./InputLabel-BSEjZJ95.js";import{S as C}from"./SelectDropdown-DGCykHln.js";import"./Modal-uBVvV53I.js";import"./InputError-BZ-n7H_N.js";import"./SecondaryButton-C1H9a7MO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-C-mFm0N_.js";import"./Checkbox-C0IliKwo.js";import"./ApplicationLogo-B9jAedvC.js";import"./DangerButton-CBIP4jF7.js";import"./moment-BLMuvzoS.js";const $={class:"py-6 bg-gray-50"},I={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},R={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},U={class:"p-6 text-gray-900"},z={key:0,class:"text-red-600"},L={key:1},T={class:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end"},q={class:"md:col-span-2 flex items-end"},G={key:0},H={key:1},Q={key:0,class:"mt-6 p-3 bg-red-50 text-red-700 rounded"},W={key:1,class:"mt-6 space-y-8"},X={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Z={class:"bg-gray-100 p-4 rounded-lg shadow-sm"},ee={class:"text-xl font-bold text-gray-800"},te={class:"bg-gray-100 p-4 rounded-lg shadow-sm"},se={class:"text-xl font-bold text-gray-800"},oe={class:"bg-gray-100 p-4 rounded-lg shadow-sm"},le={class:"text-xl font-bold text-gray-800"},ae={class:"bg-gray-100 p-4 rounded-lg shadow-sm lg:col-span-1 md:col-span-1"},ne={class:"text-xl font-bold text-gray-800"},re={key:0,class:"text-gray-600 p-4 border rounded-lg bg-gray-50"},de={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"flex justify-between items-center mb-4"},ue={class:"text-xl font-bold text-gray-800"},ce={key:0,class:"text-lg font-bold text-gray-600"},me={class:"space-y-3"},ge={class:"flex justify-between items-center text-sm"},pe={class:"font-medium text-gray-700"},_e={class:"font-bold text-green-600"},ve={key:0,class:"text-gray-600 p-4 border rounded-lg bg-gray-50"},be={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye={class:"flex justify-between items-center mb-4"},xe={class:"text-xl font-bold text-gray-800"},he={key:0,class:"text-lg font-bold text-gray-600"},fe={class:"space-y-3"},we={class:"flex justify-between items-center text-sm"},ke={class:"font-medium text-gray-700"},Be={class:"font-bold text-green-600"},$e={__name:"Index",setup(Ce){const{canDo:V}=S(),P=V("view_monthly_budgets"),x=new Date().getFullYear(),F=new Date().getMonth()+1,h=p(x),f=p(F),_=p(!1),u=p(""),r=p(null),N=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],D=A(()=>{const d=x-3,t=x+3,a=[];for(let i=t;i>=d;i--)a.push({value:i,label:String(i)});return a}),m=d=>{if(d==null)return"-";try{return new Intl.NumberFormat("en-PK",{style:"currency",currency:"PKR",maximumFractionDigits:0}).format(d)}catch{return`PKR ${Number(d).toFixed(0)}`}},M=async()=>{var d,t;_.value=!0,u.value="",r.value=null;try{const{data:a}=await K.get("/admin/bonus-calculator/calculate",{params:{year:h.value,month:f.value}});a&&a.error?u.value=a.error:r.value=a}catch(a){u.value=((t=(d=a==null?void 0:a.response)==null?void 0:d.data)==null?void 0:t.message)||"Failed to calculate bonuses."}finally{_.value=!1}};return(d,t)=>(s(),Y(j,null,{header:w(()=>t[2]||(t[2]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Bonus Calculator",-1)])),default:w(()=>{var a,i;return[c(k(E),{title:"Bonus Calculator"}),e("div",$,[e("div",I,[e("div",R,[e("div",U,[k(P)?(s(),o("div",L,[e("div",T,[e("div",null,[c(B,{value:"Year"}),c(C,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=l=>h.value=l),options:D.value,class:"mt-1 w-full"},null,8,["modelValue","options"])]),e("div",null,[c(B,{value:"Month"}),c(C,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),options:N,class:"mt-1 w-full"},null,8,["modelValue"])]),e("div",q,[c(O,{onClick:M,disabled:_.value,class:"mt-4"},{default:w(()=>[_.value?(s(),o("span",G,"Calculating...")):(s(),o("span",H,"Calculate"))]),_:1},8,["disabled"])])]),u.value?(s(),o("div",Q,n(u.value),1)):v("",!0),r.value&&!u.value?(s(),o("div",W,[e("div",X,[e("div",Z,[t[3]||(t[3]=e("p",{class:"text-sm font-medium text-gray-500"},"Period",-1)),e("p",ee,n(r.value.period),1)]),e("div",te,[t[4]||(t[4]=e("p",{class:"text-sm font-medium text-gray-500"},"Total Monthly Budget",-1)),e("p",se,n(m(r.value.total_budget)),1)]),e("div",oe,[t[5]||(t[5]=e("p",{class:"text-sm font-medium text-gray-500"},"Employee Pool Allocated",-1)),e("p",le,n(m(r.value.employee_pool_allocated)),1)]),e("div",ae,[t[6]||(t[6]=e("p",{class:"text-sm font-medium text-gray-500"},"Contractor Pool Allocated",-1)),e("p",ne,n(m(r.value.contractor_pool_allocated)),1)])]),e("div",null,[t[7]||(t[7]=e("h3",{class:"text-2xl font-bold mb-4"},"Employee Bonuses",-1)),((a=r.value.employees)==null?void 0:a.length)===0?(s(),o("div",re,"No employee bonuses were calculated for this period.")):(s(),o("div",de,[(s(!0),o(b,null,y(r.value.employees,l=>(s(),o("div",{key:l.user_id,class:J(["bg-white p-6 rounded-lg shadow-md border-t-4 border-blue-500",{"border-purple-500":l.user_id===null}])},[e("div",ie,[e("h4",ue,n(l.name),1),l.points?(s(),o("span",ce,n(l.points)+" pts",1)):v("",!0)]),e("div",me,[(s(!0),o(b,null,y(l.awards,g=>(s(),o("div",ge,[e("span",pe,n(g.award),1),e("span",_e,n(m(g.amount)),1)]))),256))])],2))),128))]))]),e("div",null,[t[8]||(t[8]=e("h3",{class:"text-2xl font-bold mb-4"},"Contractor Bonuses",-1)),((i=r.value.contractors)==null?void 0:i.length)===0?(s(),o("div",ve,"No contractor bonuses were calculated for this period.")):(s(),o("div",be,[(s(!0),o(b,null,y(r.value.contractors,l=>(s(),o("div",{key:l.user_id,class:"bg-white p-6 rounded-lg shadow-md border-t-4 border-teal-500"},[e("div",ye,[e("h4",xe,n(l.name),1),l.points?(s(),o("span",he,n(l.points)+" pts",1)):v("",!0)]),e("div",fe,[(s(!0),o(b,null,y(l.awards,g=>(s(),o("div",we,[e("span",ke,n(g.award),1),e("span",Be,n(m(g.amount)),1)]))),256))])]))),128))]))])])):v("",!0)])):(s(),o("div",z,"You do not have permission to view this page."))])])])])]}),_:1}))}};export{$e as default};
