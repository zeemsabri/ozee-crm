import x from"./StepCard-DlJNTpND.js";import h from"./DataTokenInserter-zRX7CJNa.js";import{T as k}from"./trash-ao73WNeN.js";import{P as w}from"./plus-DaGPOpMo.js";import{b as V,q as _,o as u,w as C,a as o,c,F as B,j as D,l as I,f as d,u as v,i as N}from"./app-DTsjYMjF.js";import"./createLucideIcon-CdumglnZ.js";import"./x-BF9xoPW-.js";import"./workflowStore-8KSTYeq-.js";const S={class:"space-y-4 p-2"},T=["onClick"],j={class:"grid grid-cols-1 gap-3"},A=["value","onInput"],F={class:"relative"},$=["value","onInput"],q={class:"absolute inset-y-0 right-0 flex items-center pr-2"},J={__name:"DefineVariableStep",props:{step:{type:Object,required:!0},allStepsBefore:{type:Array,default:()=>[]},loopContextSchema:{type:Object,default:null},onDelete:{type:Function,default:null}},emits:["update:step","delete"],setup(n,{emit:b}){const i=n,m=b,a=V({get:()=>{const t=i.step.step_config||{};return Array.isArray(t.variables)||(t.variables=[{name:"",value:""}]),t},set:t=>m("update:step",{...i.step,step_config:t})});function f(){a.value={...a.value,variables:[...a.value.variables,{name:"",value:""}]}}function g(t){const e=a.value.variables.filter((l,s)=>s!==t);a.value={...a.value,variables:e}}function p(t,e,l){const s=[...a.value.variables];s[t]={...s[t],[e]:l},a.value={...a.value,variables:s}}function y(t,e){const l=a.value.variables[t].value||"";p(t,"value",l+e)}return(t,e)=>(u(),_(x,{icon:"ðŸ“",title:i.step.name||"Define Variables",onDelete:n.onDelete,"onUpdate:title":e[0]||(e[0]=l=>m("update:step",{...i.step,name:l}))},{default:C(()=>[o("div",S,[e[4]||(e[4]=o("p",{class:"text-sm text-gray-500"}," Extract data into named variables for use in later steps. ",-1)),(u(!0),c(B,null,D(a.value.variables,(l,s)=>(u(),c("div",{key:s,class:"space-y-2 p-3 border rounded-lg bg-gray-50 relative group"},[a.value.variables.length>1?(u(),c("button",{key:0,onClick:r=>g(s),class:"absolute -top-2 -right-2 p-1 bg-white border rounded-full text-gray-400 hover:text-red-500 shadow-sm opacity-0 group-hover:opacity-100 transition-opacity"},[d(v(k),{class:"w-3 h-3"})],8,T)):I("",!0),o("div",j,[o("div",null,[e[1]||(e[1]=o("label",{class:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1"},"Variable Name",-1)),o("input",{type:"text",value:l.name,onInput:r=>p(s,"name",r.target.value),placeholder:"e.g. project_id",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,40,A)]),o("div",null,[e[2]||(e[2]=o("label",{class:"block text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1"},"Value / Token",-1)),o("div",F,[o("input",{type:"text",value:l.value,onInput:r=>p(s,"value",r.target.value),placeholder:"{{loop.item.id}}",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm pr-10"},null,40,$),o("div",q,[d(h,{"all-steps-before":n.allStepsBefore,"loop-context-schema":n.loopContextSchema,onInsert:r=>y(s,r)},null,8,["all-steps-before","loop-context-schema","onInsert"])])])])])]))),128)),o("button",{onClick:f,class:"inline-flex items-center gap-1 text-sm font-medium text-indigo-600 hover:text-indigo-500"},[d(v(w),{class:"w-4 h-4"}),e[3]||(e[3]=N(" Add another variable ",-1))])])]),_:1},8,["title","onDelete"]))}};export{J as default};
