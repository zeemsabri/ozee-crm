import{_ as M,r as m,E as S,i,g as d,o as r,b as t,d as j,f as v,k as w,n as g,t as p,v as F,m as b}from"./app-BiQ7j4uU.js";const P={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[100] p-4 font-inter"},B={class:"bg-white rounded-xl shadow-2xl w-full max-w-md p-8 relative transform transition-all duration-300 scale-100 opacity-100"},V={class:"mb-5"},z={key:0,class:"text-red-500 text-xs italic mt-1"},A={class:"mb-5"},D={key:0,class:"text-red-500 text-xs italic mt-1"},E={class:"mb-5"},N={key:0,class:"text-red-500 text-xs italic mt-1"},O={class:"mb-6"},q={key:0,class:"text-gray-600 text-sm mt-2"},I={class:"font-medium"},U={key:1,class:"text-red-500 text-xs italic mt-1"},G={class:"flex items-center justify-end space-x-4"},H=["disabled"],L=["disabled"],J={key:0,class:"flex items-center"},R={key:1},W={__name:"CreateTaskModal",props:{isOpen:{type:Boolean,required:!0},initialAuthToken:{type:String,required:!0},projectId:{type:[String,Number],required:!0}},emits:["update:isOpen","task-created-success"],setup(y,{emit:k}){const h=y,x=k,l=m({title:"",description:"",urgency:"medium",attachment:null}),c=m(!1),o=m({}),n=m(null),{showModal:u}=S("modalService"),f=()=>{x("update:isOpen",!1),_(),o.value={}},_=()=>{l.value={title:"",description:"",urgency:"medium",attachment:null},n.value=null,o.value={}},C=s=>{const e=s.target.files?s.target.files[0]:null;if(e){if(e.size>5*1024*1024){u("File Too Large","Please select a file smaller than 5MB.","alert"),n.value=null,l.value.attachment=null;return}if(!["application/pdf","image/jpeg","image/png","image/gif","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(e.type)){u("Unsupported File Type","Please upload a PDF, image (JPG, PNG, GIF), or Word document.","alert"),n.value=null,l.value.attachment=null;return}n.value=e.name,l.value.attachment=e}else n.value=null,l.value.attachment=null},T=async()=>{if(o.value={},!l.value.title.trim()){o.value.title="Title is required.";return}c.value=!0;try{const s=new FormData;s.append("title",l.value.title),s.append("description",l.value.description||""),s.append("urgency",l.value.urgency),s.append("project_id",h.projectId),l.value.attachment&&s.append("attachment",l.value.attachment);const e=await fetch("/api/client-api/tasks",{method:"POST",headers:{Authorization:`Bearer ${h.initialAuthToken}`,Accept:"application/json"},body:s}),a=await e.json();if(!e.ok)throw e.status===422&&a.errors?(o.value=a.errors,u("Validation Error","Please correct the highlighted fields.","alert")):u("Error",a.message||"Failed to create task.","alert"),new Error(a.message||"API request failed.");u("Success","New task created successfully!","alert"),x("task-created-success",a.task),f()}catch(s){console.error("Error creating task:",s)}finally{c.value=!1}};return(s,e)=>y.isOpen?(r(),i("div",P,[t("div",B,[t("button",{onClick:f,class:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-4xl leading-none transition-colors duration-200","aria-label":"Close"},"Ã—"),e[11]||(e[11]=t("h3",{class:"text-2xl font-bold text-gray-900 mb-6 text-center"},"Create New Task",-1)),t("form",{onSubmit:j(T,["prevent"])},[t("div",V,[e[3]||(e[3]=t("label",{for:"title",class:"block text-gray-800 text-sm font-semibold mb-2"},"Task Title:",-1)),v(t("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=a=>l.value.title=a),class:g(["w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200",{"border-red-500":o.value.title}]),placeholder:"e.g., Review website copy"},null,2),[[w,l.value.title]]),o.value.title?(r(),i("p",z,p(o.value.title[0]),1)):d("",!0)]),t("div",A,[e[4]||(e[4]=t("label",{for:"description",class:"block text-gray-800 text-sm font-semibold mb-2"},"Description (Optional):",-1)),v(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=a=>l.value.description=a),rows:"4",class:g(["w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200 resize-y",{"border-red-500":o.value.description}]),placeholder:"Provide more details about the task..."},null,2),[[w,l.value.description]]),o.value.description?(r(),i("p",D,p(o.value.description[0]),1)):d("",!0)]),t("div",E,[e[6]||(e[6]=t("label",{for:"urgency",class:"block text-gray-800 text-sm font-semibold mb-2"},"Urgency:",-1)),v(t("select",{id:"urgency","onUpdate:modelValue":e[2]||(e[2]=a=>l.value.urgency=a),class:g(["w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200",{"border-red-500":o.value.urgency}])},e[5]||(e[5]=[t("option",{value:"low"},"Low",-1),t("option",{value:"medium"},"Medium",-1),t("option",{value:"high"},"High",-1),t("option",{value:"critical"},"Critical",-1)]),2),[[F,l.value.urgency]]),o.value.urgency?(r(),i("p",N,p(o.value.urgency[0]),1)):d("",!0)]),t("div",O,[e[8]||(e[8]=t("label",{for:"attachment",class:"block text-gray-800 text-sm font-semibold mb-2"},"Attach Document (Optional):",-1)),t("input",{type:"file",id:"attachment",onChange:C,class:g(["block w-full text-sm text-gray-700 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 transition-colors duration-200",{"border-red-500":o.value.attachment}])},null,34),n.value?(r(),i("p",q,[e[7]||(e[7]=b("Selected file: ",-1)),t("span",I,p(n.value),1)])):d("",!0),o.value.attachment?(r(),i("p",U,p(o.value.attachment[0]),1)):d("",!0)]),t("div",G,[t("button",{type:"button",onClick:f,class:"px-6 py-3 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c.value}," Cancel ",8,H),t("button",{type:"submit",class:"px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-all duration-200 ease-in-out transform hover:scale-105 shadow-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:c.value},[c.value?(r(),i("span",J,e[9]||(e[9]=[t("svg",{class:"animate-spin h-5 w-5 text-white mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),b(" Creating... ",-1)]))):(r(),i("span",R,e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-plus-circle mr-2 inline-block"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("path",{d:"M8 12h8"}),t("path",{d:"M12 8v8"})],-1),b(" Create Task ",-1)])))],8,L)])],32)])])):d("",!0)}},K=M(W,[["__scopeId","data-v-606ccb13"]]);export{K as default};
