import{c as p,r as f,e as x,f as U,a as r,o as i,b as t,d as v,v as _,x as y,m as A,u as b,F as w,l as M}from"./app-DbT8OS6U.js";import{u as T}from"./workflowStore-DZJsW282.js";import{S as h}from"./SelectDropdown-CHW2wT9H.js";import{P as N}from"./plus-Cqbd8Y22.js";import{T as j}from"./trash-2-TxAo_pPz.js";/* empty css                                                                       */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-CcTmroC8.js";const B={class:"space-y-4"},D={class:"flex items-center justify-between"},R={key:0,class:"mt-2 space-y-2"},S={class:"flex items-center gap-2"},I=["onUpdate:modelValue"],K={class:"text-right"},P=["onClick"],E={key:1,class:"text-center text-xs text-gray-500 py-4 border-2 border-dashed rounded-lg mt-2"},Q={__name:"UpdateRecordConfig",setup(L){const c=T(),s=p(()=>c.selectedStep),V=p(()=>c.automationSchema),g=p(()=>{var l;return((l=V.value)==null?void 0:l.models)||[]}),a=f([]),d=f(null),n=f(""),k=p(()=>{if(!d.value)return[];const l=g.value.find(e=>e.name===d.value);return l?l.columns.map(e=>({value:e,label:e})):[]}),C=()=>{a.value.push({selectedColumn:null,value:""})},F=l=>{a.value.splice(l,1)};return x(s,l=>{l&&l.step_config?(d.value=l.step_config.target_model||null,n.value=l.step_config.record_id||"",l.step_config.fields&&Array.isArray(l.step_config.fields)?a.value=l.step_config.fields.map(e=>({selectedColumn:e.field||null,value:e.value||""})):a.value=[]):(d.value=null,n.value="",a.value=[])},{immediate:!0}),x([d,n,a],([l,e,o])=>{s.value&&((!s.value.step_config||typeof s.value.step_config!="object"||Array.isArray(s.value.step_config))&&(s.value.step_config={}),s.value.step_config.target_model=l,s.value.step_config.record_id=e,s.value.step_config.fields=o.filter(u=>u.selectedColumn).map(u=>({field:u.selectedColumn,value:u.value})))},{deep:!0}),U(()=>{Object.keys(c.automationSchema).length||c.fetchAutomationSchema()}),(l,e)=>(i(),r("div",B,[t("div",null,[e[2]||(e[2]=t("label",{class:"block text-xs font-medium text-gray-700"},"Target Model",-1)),v(h,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),options:g.value,valueKey:"name",labelKey:"name",placeholder:"Select a module...",class:"w-full mt-1"},null,8,["modelValue","options"])]),t("div",null,[e[3]||(e[3]=t("label",{class:"block text-xs font-medium text-gray-700"},"Record ID to Update",-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>n.value=o),type:"text",class:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:"e.g., {{ lead.id }}"},null,512),[[y,n.value]])]),t("div",null,[t("div",D,[e[5]||(e[5]=t("label",{class:"text-xs font-medium text-gray-700"},"Fields to update",-1)),t("button",{onClick:C,class:"flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-gray-100 hover:bg-gray-200"},[v(b(N),{class:"w-3 h-3"}),e[4]||(e[4]=A(" Add Field ",-1))])]),a.value.length>0?(i(),r("div",R,[(i(!0),r(w,null,M(a.value,(o,u)=>(i(),r("div",{key:u,class:"p-2 border rounded-md bg-gray-50/50 space-y-2"},[t("div",S,[v(h,{modelValue:o.selectedColumn,"onUpdate:modelValue":m=>o.selectedColumn=m,options:k.value,placeholder:"Select a field...",class:"w-full",disabled:!d.value},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),t("div",null,[_(t("input",{"onUpdate:modelValue":m=>o.value=m,type:"text",class:"w-full border rounded px-2 py-1 text-sm",placeholder:"Value"},null,8,I),[[y,o.value]])]),t("div",K,[t("button",{onClick:m=>F(u),class:"text-red-500 hover:text-red-700 p-1",title:"Remove Field"},[v(b(j),{class:"w-3 h-3"})],8,P)])]))),128))])):(i(),r("div",E," No fields defined. "))])]))}};export{Q as default};
