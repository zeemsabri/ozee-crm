import{D as $,d as p,w as x,q as P,o as m,g as F,a as d,c as E,m as _,t as y,f as h,i as N,v as B,ac as c,s as r,N as i,M as o,a2 as a}from"./app-D7QPKPE4.js";import{B as D}from"./BaseFormModal-BHwhVhPM.js";import{_ as C}from"./InputLabel-CWCGwrcM.js";import{_ as j}from"./InputError-DbYTA_wQ.js";const A={class:"space-y-4"},M={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},O={class:"text-sm font-medium text-gray-900"},S={class:"text-xs text-gray-500 mt-1"},I={class:"mb-4"},q="post",V="Add Note",U="Note added successfully!",J={__name:"TaskNoteModal",props:{show:Boolean,taskForNote:Object},emits:["close","note-added"],setup(e,{emit:s}){const t=e,l=s,u=$({note:""}),f=p(()=>{var n;return`Add Note to Task: "${(n=t.taskForNote)==null?void 0:n.name}"`}),b=p(()=>{var n;return`/api/tasks/${(n=t.taskForNote)==null?void 0:n.id}/notes`});x(()=>t.show,n=>{n&&Object.assign(u,{note:""})},{immediate:!0});const w=n=>{l("note-added",n),l("close")},T=()=>{l("close")};return(n,k)=>(m(),P(D,{show:e.show,title:f.value,"api-endpoint":b.value,"http-method":q,"form-data":u,"submit-button-text":V,"success-message":U,onClose:T,onSubmitted:w},{default:F(({errors:g})=>[d("div",A,[e.taskForNote?(m(),E("div",M,[d("p",O,y(e.taskForNote.name),1),d("p",S,"Status: "+y(e.taskForNote.status),1)])):_("",!0),d("div",I,[h(C,{for:"task-note-content",value:"Note Content"}),N(d("textarea",{id:"task-note-content","onUpdate:modelValue":k[0]||(k[0]=v=>u.note=v),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your note...",required:""},null,512),[[B,u.note]]),h(j,{message:g.note?g.note[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},K=async()=>{try{return(await r.get("/api/assigned-tasks")).data}catch(e){throw console.error("Error fetching assigned tasks:",e),o("Failed to load assigned tasks"),e}},L=async e=>{try{return(await r.get(`/api/projects/${e}/tasks`)).data}catch(s){throw console.error("Error fetching project tasks:",s),o("Failed to load project tasks"),s}},Q=async e=>{try{return(await r.get(`/api/projects/${e}/due-and-overdue-tasks`)).data}catch(s){throw console.error("Error fetching due and overdue tasks:",s),o("Failed to load due and overdue tasks"),s}},W=async e=>{if(!e||e.status==="In Progress")return e;try{c("Starting task...");const s=await r.post(`/api/tasks/${e.id}/start`);return i("Task started successfully"),s.data}catch(s){throw console.error("Error starting task:",s),o("Failed to start task. Please try again."),s}},X=async e=>{if(!e||e.status!=="In Progress")return a('Task can only be paused from "In Progress" status.'),e;try{c("Pausing task...");const s=await r.post(`/api/tasks/${e.id}/pause`);return i("Task paused successfully"),s.data}catch(s){throw console.error("Error pausing task:",s),o("Failed to pause task. Please try again."),s}},Y=async e=>{if(!e||e.status!=="Paused")return a('Task can only be resumed from "Paused" status.'),e;try{c("Resuming task...");const s=await r.post(`/api/tasks/${e.id}/resume`);return i("Task resumed successfully"),s.data}catch(s){throw console.error("Error resuming task:",s),o("Failed to resume task. Please try again."),s}},Z=async e=>{if(!e||e.status==="Done")return e;if(e.status!=="In Progress")throw a("Task must be started before it can be completed"),new Error("Task must be started before it can be completed");try{c("Completing task...");const s=await r.patch(`/api/tasks/${e.id}/complete`);i("Task completed successfully");const t=s.data;if(t!=null&&t.needs_approval){const l=(t==null?void 0:t.creator_name)||"the creator";c(`This task requires approval. A notification has been sent to ${l}.`)}return t}catch(s){throw console.error("Error completing task:",s),s.response&&s.response.status===422?a(s.response.data.message||"Task must be started before it can be completed"):o("Failed to complete task. Please try again."),s}},ee=async(e,s)=>{if(!e||e.status==="Blocked")return a("Task is already blocked."),e;if(e.status==="Done")return a("Completed tasks cannot be blocked."),e;if(!s)throw a("Please provide a reason for blocking the task"),new Error("Blocking reason is required");try{c("Blocking task...");const t=await r.post(`/api/tasks/${e.id}/block`,{reason:s});return i("Task blocked successfully"),t.data}catch(t){throw console.error("Error blocking task:",t),o("Failed to block task. Please try again."),t}},se=async e=>{if(!e||e.status!=="Blocked")return a("Task is not in a blocked state."),e;try{c("Unblocking task...");const s=await r.post(`/api/tasks/${e.id}/unblock`);return i("Task unblocked successfully"),s.data}catch(s){throw console.error("Error unblocking task:",s),o("Failed to unblock task. Please try again."),s}},te=async e=>{if(!e||e.status!=="Done")return a("Only completed tasks can be revised."),e;try{c("Revising task...");const s=await r.post(`/api/tasks/${e.id}/revise`);return i("Task revised successfully"),s.data}catch(s){throw console.error("Error revising task:",s),s.response&&s.response.status===422?a(s.response.data.message||"Only completed tasks can be revised"):o("Failed to revise task. Please try again."),s}},ae=async e=>{if(!e)return!1;if(e.status!=="To Do")throw a("Only tasks in To Do status can be deleted"),new Error("Only tasks in To Do status can be deleted");if(!confirm("Are you sure you want to delete this task? This action cannot be undone."))return!1;try{return c("Deleting task..."),await r.delete(`/api/tasks/${e.id}`),i("Task deleted successfully"),!0}catch(s){throw console.error("Error deleting task:",s),o("Failed to delete task. Please try again."),s}},re=e=>{switch(e){case"To Do":return"bg-yellow-100 text-yellow-800";case"In Progress":return"bg-blue-100 text-blue-800";case"Paused":return"bg-orange-100 text-orange-800";case"Blocked":return"bg-red-100 text-red-800";case"Done":return"bg-green-100 text-green-800";case"Archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},oe=e=>{switch(e){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},ne=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"Medium";export{J as _,te as a,ee as b,Z as c,ae as d,ne as e,K as f,re as g,oe as h,L as i,Q as j,X as p,Y as r,W as s,se as u};
