import{r as A,c as B,S as je,f as me,v as Pe,a as r,i as h,o as s,F as K,l as J,b as t,t as I,u as M,T as Qe,U as kt,V as Xe,W as et,j as V,e as G,g as N,w,y as Ee,x as Y,D as tt,m as S,d as v,A as le,p as O,B as Me,Q as bt,n as ye,N as ne,M as ae,H as Q,I as Ne,J as be,k as xt,X as st,Y as wt,Z as Oe,z as ce,E as de,_ as at,$ as Re,q as ze,a0 as ve,a1 as te,a2 as ue,a3 as Ue,R as _t,a4 as ot,a5 as $t,a6 as Ct,a7 as He,a8 as Ke,G as St}from"./app-SqGcPtWR.js";import{P as ee}from"./PrimaryButton-ZwHmGBND.js";import{_ as Fe}from"./Modal-D6W0cgKy.js";import{_ as R}from"./InputLabel-Bb8lo1WW.js";import{_ as H}from"./InputError-CNTSKuH2.js";import{_ as Ie}from"./SecondaryButton-CwsDALDU.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as re}from"./TextInput-CXH52_1a.js";import{S as se}from"./SelectDropdown-CqneZTUc.js";import{_ as Tt}from"./Checkbox-B0U4Q9FX.js";import{A as At}from"./ApplicationLogo-CF15OVda.js";import{D as We}from"./DangerButton-BhkV7ftf.js";import{h as jt}from"./moment-BLMuvzoS.js";const It={key:0,class:"fixed bottom-4 right-4 z-50 flex flex-col items-end space-y-2"},Mt={key:0,class:"notification-list w-full max-w-xs space-y-2"},Dt={class:"flex-1 min-w-0"},Nt={class:"flex items-start justify-between gap-2 mb-1"},Pt={class:"flex-1 min-w-0"},Et={key:0,class:"text-base font-semibold text-gray-800 truncate"},Vt={key:1,class:"text-xs text-gray-500"},Ut={key:0,class:"text-xs text-gray-600 mb-2"},Bt={class:"flex items-center justify-between mt-2"},Lt={key:0,class:"text-xs text-gray-500 font-medium"},Rt=["onClick"],zt={key:1,class:"flex justify-end w-full max-w-xs"},Ft={key:0},Wt={key:1},fe="notification_minimized_state",qt=3,Ot={__name:"PushNotificationContainer",props:{sidebarIsOpen:{type:Boolean,default:!1}},setup(a){const o=A(!1),i=A(null),n=A(0),e=A(null),p=B(()=>je.value.notifications.filter(d=>d.isNewPush).slice(0,qt)),c=B(()=>{const d=Math.floor(n.value/60),k=n.value%60;return`${String(d).padStart(2,"0")}:${String(k).padStart(2,"0")}`}),g=d=>{if(!d)return null;const k=d.match(/\/task\/(\d+)/);return k?parseInt(k[1]):null},m=d=>{if(!d)return null;const k=d.match(/\/project\/(\d+)\//);return k?parseInt(k[1]):null},l=()=>{if(o.value=!o.value,clearTimeout(i.value),clearInterval(e.value),o.value){const d=Date.now()+3e5;localStorage.setItem(fe,JSON.stringify({isMinimized:!0,expiryTime:d})),i.value=setTimeout(()=>{o.value=!1,clearInterval(e.value),localStorage.removeItem(fe)},3e5),n.value=300,e.value=setInterval(()=>{n.value>0?n.value--:clearInterval(e.value)},1e3)}else localStorage.removeItem(fe)},y=async d=>{kt(d.id),await Xe(d.view_id);const k=d.task_id||g(d.url),T=d.project_id||m(d.url);k&&T?et(k,T):(console.warn("Could not open task sidebar. Falling back to redirecting."),d.url&&(window.location.href=d.url))};return me(()=>{const d=localStorage.getItem(fe);if(d)try{const{isMinimized:k,expiryTime:T}=JSON.parse(d),j=Date.now(),b=T-j;b>0?(o.value=k,n.value=Math.floor(b/1e3),i.value=setTimeout(()=>{o.value=!1,clearInterval(e.value),localStorage.removeItem(fe)},b),e.value=setInterval(()=>{n.value>0?n.value--:clearInterval(e.value)},1e3)):localStorage.removeItem(fe)}catch(k){console.error("Error restoring notification minimized state:",k),localStorage.removeItem(fe)}}),Pe(()=>{clearTimeout(i.value),clearInterval(e.value)}),(d,k)=>a.sidebarIsOpen?h("",!0):(s(),r("div",It,[!o.value&&p.value.length>0?(s(),r("div",Mt,[(s(!0),r(K,null,J(p.value,T=>(s(),r("div",{key:T.id,class:"bg-white rounded-lg shadow-lg p-3 flex items-start space-x-3 border border-gray-200 transition-opacity duration-300 opacity-60 hover:opacity-100"},[t("div",Dt,[t("div",Nt,[t("div",Pt,[T.title?(s(),r("h3",Et,I(T.title),1)):h("",!0),T.project_name?(s(),r("p",Vt,I(T.project_name),1)):h("",!0)])]),T.message?(s(),r("p",Ut,I(T.message),1)):h("",!0),t("div",Bt,[T.due_date?(s(),r("div",Lt," Due: "+I(M(Qe)(T.due_date)),1)):h("",!0),t("button",{onClick:j=>y(T),class:"px-2.5 py-1 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 transition-colors duration-200 shadow"},I(T.button_label||"View"),9,Rt)])])]))),128))])):h("",!0),p.value.length>0?(s(),r("div",zt,[t("button",{onClick:l,class:"bg-white/80 backdrop-blur-sm text-gray-600 hover:text-gray-900 text-xs font-bold py-1 px-3 rounded-full shadow-md transition-all duration-300"},[o.value?(s(),r("span",Ft,"Show ("+I(c.value)+")",1)):(s(),r("span",Wt,"Minimize"))])])):h("",!0)]))}},Ht={class:"fixed top-4 right-4 z-[9999] flex flex-col items-end space-y-3"},Kt={class:"p-4"},Jt={class:"text-sm font-medium text-white"},Yt={key:0,class:"mt-3 flex gap-2"},Zt=["onClick"],Gt=["onClick"],Qt={__name:"StandardNotificationContainer",setup(a,{expose:o}){const i=A([]),n=(m,l="info",y=5e3)=>{let d;typeof m=="object"&&m!==null?d={...m}:d={message:m,type:l,duration:y};const k=d.id||crypto.randomUUID(),T={id:k,message:d.message||"",type:d.type||"info",duration:typeof d.duration=="number"?d.duration:5e3,sticky:!!d.sticky,confirm:d.confirm||null};return i.value.unshift(T),!T.sticky&&!T.confirm&&setTimeout(()=>{e(k)},T.duration),k},e=m=>{const l=i.value.findIndex(y=>y.id===m);l>-1&&i.value.splice(l,1)},p=m=>{const l=i.value.find(y=>y.id===m);if(l&&l.confirm&&typeof l.confirm.onConfirm=="function")try{l.confirm.onConfirm()}catch{}e(m)},c=m=>{const l=i.value.find(y=>y.id===m);if(l&&l.confirm&&typeof l.confirm.onCancel=="function")try{l.confirm.onCancel()}catch{}e(m)},g=m=>{switch(m){case"success":return"bg-green-500";case"error":return"bg-red-500";case"warning":return"bg-yellow-500";case"info":default:return"bg-blue-500"}};return o({addNotification:n}),(m,l)=>(s(),r("div",Ht,[(s(!0),r(K,null,J(i.value,y=>(s(),r("div",{key:y.id,class:V(["w-full max-w-sm rounded-md shadow-lg pointer-events-auto overflow-hidden",g(y.type)])},[t("div",Kt,[t("p",Jt,I(y.message),1),y.confirm?(s(),r("div",Yt,[t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-white/90 text-slate-800 hover:bg-white",onClick:d=>p(y.id)},I(y.confirm.confirmText||"Confirm"),9,Zt),t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-transparent border border-white/70 text-white hover:bg-white/10",onClick:d=>c(y.id)},I(y.confirm.cancelText||"Cancel"),9,Gt)])):h("",!0)])],2))),128))]))}},Xt={class:"p-6"},es={class:"mt-6"},ts={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},ss={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},as={class:"flex items-center mb-3"},os=["id","onUpdate:modelValue"],ls=["for"],rs={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},ns={key:0},is={class:"mb-4"},ds={class:"flex items-center"},us=["id","checked","onChange"],cs=["for"],ms={key:0,class:"mb-4"},vs=["id","onUpdate:modelValue"],ps={key:1,class:"mb-4"},gs={class:"flex-1"},fs=["id","onUpdate:modelValue"],ys={class:"flex-1"},hs=["id","onUpdate:modelValue"],ks={key:0,class:"flex items-end pb-1"},bs=["onClick"],xs=["onClick"],ws={class:"mt-6 flex justify-end space-x-3"},_s={key:0,class:"flex items-center"},$s={key:1},Cs={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(a,{emit:o}){const i=()=>{const P=localStorage.getItem("authToken");P&&!O.defaults.headers.common.Authorization&&(O.defaults.headers.common.Authorization=`Bearer ${P}`,console.log("Auth headers set in AvailabilityModal"))},n=a,e=o,p=A({}),c=A({}),g=A(!1),m=A(""),l=()=>{const P=[],_=new Date,u=new Date(_);u.setDate(_.getDate()+1);for(let f=0;f<7;f++){const x=new Date(u);x.setDate(u.getDate()+f);const $=x.toISOString().split("T")[0];P.push({value:$,label:x.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),p.value[$]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return P},y=A([]);me(()=>{i(),n.nextWeekDates.length>0?(y.value=n.nextWeekDates,n.nextWeekDates.forEach(P=>{p.value[P.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):y.value=l()});const d=async()=>{try{if(i(),y.value.length===0)return;const P=y.value[0].value,_=y.value[y.value.length-1].value,u=await O.get("/api/availabilities",{params:{start_date:P,end_date:_,user_id:n.userId}});if(u.data&&u.data.availabilities){const f=u.data.availabilities;y.value.forEach(x=>{p.value[x.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),f.forEach(x=>{const $=x.date.split("T")[0];p.value[$]&&(p.value[$].isSelected=!0,p.value[$].isAvailable=x.is_available,x.is_available?p.value[$].timeSlots=x.time_slots&&x.time_slots.length>0?[...x.time_slots]:[{start_time:"",end_time:""}]:p.value[$].reason=x.reason||"")})}}catch(P){console.error("Error fetching existing availabilities:",P),y.value.forEach(_=>{p.value[_.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};G(()=>n.show,async P=>{P&&(c.value={},m.value="",await d())},{immediate:!0});const k=P=>{p.value[P].timeSlots.push({start_time:"",end_time:""})},T=(P,_)=>{p.value[P].timeSlots.length>1&&p.value[P].timeSlots.splice(_,1)},j=(P,_)=>{p.value[P].isAvailable=_,_?p.value[P].reason="":p.value[P].timeSlots=[{start_time:"",end_time:""}]},b=async()=>{g.value=!0,c.value={},m.value="";const P=[];let _=!1;for(const u of y.value){const f=u.value,x=p.value[f];if(x.isSelected){let $={};if(x.isAvailable)if(x.timeSlots.some(D=>!D.start_time||!D.end_time))$.timeSlots="Please fill in all time slots.",_=!0;else for(const D of x.timeSlots){const L=D.start_time.split(":").map(Number),ie=D.end_time.split(":").map(Number);if(L.length!==2||ie.length!==2||isNaN(L[0])||isNaN(L[1])||isNaN(ie[0])||isNaN(ie[1])){$.timeSlots="Invalid time format. Please use HH:MM format.",_=!0;break}const q=L[0]*60+L[1],U=ie[0]*60+ie[1];if(q>=U){$.timeSlots="End time must be after start time.",_=!0;break}}else x.reason.trim()||($.reason="Please provide a reason for unavailability.",_=!0);Object.keys($).length>0&&(c.value[f]=$),Object.keys($).length===0&&P.push({date:f,is_available:x.isAvailable,reason:x.isAvailable?null:x.reason,time_slots:x.isAvailable?x.timeSlots:null})}}if(_){g.value=!1,c.value.general="Please correct the errors in the highlighted dates.";return}if(P.length===0){c.value.general="Please select at least one day to set availability for.",g.value=!1;return}try{i();const u=await O.post("/api/availabilities/batch",{availabilities:P});m.value="Availability saved successfully!";try{const f=await O.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",f.data.should_block_user),localStorage.setItem("allWeekdaysCovered",f.data.all_weekdays_covered);const x=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:f.data.should_block_user,allWeekdaysCovered:f.data.all_weekdays_covered}});window.dispatchEvent(x),console.log("Availability status updated from modal:",{shouldBlockUser:f.data.should_block_user,allWeekdaysCovered:f.data.all_weekdays_covered})}catch(f){console.error("Error updating availability status:",f)}e("availability-saved",u.data.availabilities),setTimeout(()=>{e("close")},1500)}catch(u){console.error("Error saving availability:",u),u.response&&u.response.data&&u.response.data.errors?c.value.general=u.response.data.message||"An error occurred while saving your availability.":u.response&&u.response.status===409?(m.value=u.response.data.message,setTimeout(()=>{e("close")},1500)):c.value.general="An unexpected error occurred while saving your availability."}finally{g.value=!1}};return(P,_)=>(s(),N(Fe,{show:a.show,onClose:_[1]||(_[1]=u=>P.$emit("close")),"max-width":"xl"},{default:w(()=>[t("div",Xt,[_[6]||(_[6]=t("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),_[7]||(_[7]=t("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),t("div",es,[t("form",{onSubmit:Ee(b,["prevent"])},[m.value?(s(),r("div",ts,I(m.value),1)):h("",!0),c.value.general?(s(),r("div",ss,I(c.value.general),1)):h("",!0),(s(!0),r(K,null,J(y.value,u=>{var f,x;return s(),r("div",{key:u.value,class:V(["mb-6 p-4 border rounded-lg shadow-sm",[p.value[u.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",p.value[u.value].isSelected&&!c.value[u.value]?"border-l-4 border-l-indigo-500":""]])},[t("div",as,[Y(t("input",{type:"checkbox",id:`select_date_${u.value}`,"onUpdate:modelValue":$=>p.value[u.value].isSelected=$,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,os),[[tt,p.value[u.value].isSelected]]),t("label",{for:`select_date_${u.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[S(I(u.label)+" ",1),p.value[u.value].isSelected?(s(),r("span",rs," Saved ")):h("",!0)],8,ls)]),p.value[u.value].isSelected?(s(),r("div",ns,[t("div",is,[t("div",ds,[t("input",{type:"checkbox",id:`isAvailableToggle_${u.value}`,checked:p.value[u.value].isAvailable,onChange:$=>j(u.value,$.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,us),t("label",{for:`isAvailableToggle_${u.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,cs)])]),p.value[u.value].isAvailable?h("",!0):(s(),r("div",ms,[v(R,{for:`reason_${u.value}`,value:"Reason for Not Available"},null,8,["for"]),Y(t("textarea",{id:`reason_${u.value}`,"onUpdate:modelValue":$=>p.value[u.value].reason=$,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,vs),[[le,p.value[u.value].reason]]),v(H,{message:(f=c.value[u.value])==null?void 0:f.reason,class:"mt-2"},null,8,["message"])])),p.value[u.value].isAvailable?(s(),r("div",ps,[v(R,{value:"Available Time Slots"}),v(H,{message:(x=c.value[u.value])==null?void 0:x.timeSlots,class:"mt-2"},null,8,["message"]),(s(!0),r(K,null,J(p.value[u.value].timeSlots,($,D)=>(s(),r("div",{key:D,class:"flex items-center space-x-2 mt-2"},[t("div",gs,[v(R,{for:`start_time_${u.value}_${D}`,value:"Start Time",class:"text-xs"},null,8,["for"]),Y(t("input",{id:`start_time_${u.value}_${D}`,type:"time","onUpdate:modelValue":L=>$.start_time=L,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,fs),[[le,$.start_time]])]),t("div",ys,[v(R,{for:`end_time_${u.value}_${D}`,value:"End Time",class:"text-xs"},null,8,["for"]),Y(t("input",{id:`end_time_${u.value}_${D}`,type:"time","onUpdate:modelValue":L=>$.end_time=L,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,hs),[[le,$.end_time]])]),p.value[u.value].timeSlots.length>1?(s(),r("div",ks,[t("button",{type:"button",onClick:L=>T(u.value,D),class:"p-2 text-red-600 hover:text-red-800"},_[2]||(_[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,bs)])):h("",!0)]))),128)),t("button",{type:"button",onClick:$=>k(u.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},_[3]||(_[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),S(" Add Another Time Slot ",-1)]),8,xs)])):h("",!0)])):h("",!0)],2)}),128)),t("div",ws,[v(Ie,{onClick:_[0]||(_[0]=u=>P.$emit("close"))},{default:w(()=>_[4]||(_[4]=[S(" Cancel ",-1)])),_:1,__:[4]}),v(ee,{disabled:g.value,class:V({"opacity-50":g.value})},{default:w(()=>[g.value?(s(),r("span",_s,_[5]||(_[5]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),S(" Saving... ",-1)]))):(s(),r("span",$s,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},Ss={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},Ts={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},As={class:"flex justify-center"},js={__name:"AvailabilityBlocker",setup(a){const o=A(!1),i=A(!0),n=A(!1),e=A([]),p=B(()=>{var b;return((b=Me().props.auth.user)==null?void 0:b.id)||null}),c=()=>{const b=localStorage.getItem("authToken");b&&!O.defaults.headers.common.Authorization&&(O.defaults.headers.common.Authorization=`Bearer ${b}`)},g=async()=>{i.value=!0;const b=localStorage.getItem("shouldBlockUser"),P=localStorage.getItem("allWeekdaysCovered");if(b==="true"&&P==="false")o.value=!0,await m();else try{c();const _=await O.get("/api/availability-prompt");o.value=_.data.should_block_user&&!_.data.all_weekdays_covered,o.value&&await m()}catch(_){console.error("Error checking if user should be blocked:",_),o.value=!1}i.value=!1},m=async()=>{try{c();const b=await O.get("/api/availability-prompt");l(b.data.next_week_start,b.data.next_week_end)}catch(b){console.error("Error fetching next week dates:",b)}},l=(b,P)=>{const _=[],u=new Date(b),f=new Date(P),x=new Date(u);for(;x<=f;)_.push({value:x.toISOString().split("T")[0],label:x.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),x.setDate(x.getDate()+1);e.value=_},y=()=>{n.value=!0},d=()=>{g()},k=b=>{o.value=b.detail.shouldBlockUser&&!b.detail.allWeekdaysCovered},T=()=>{document.visibilityState==="visible"&&ye(()=>{g()})},j=b=>{(b.key==="shouldBlockUser"||b.key==="allWeekdaysCovered")&&ye(()=>{g()})};return me(()=>{g(),window.addEventListener("availability-status-updated",k),document.addEventListener("visibilitychange",T),window.addEventListener("storage",j)}),Pe(()=>{window.removeEventListener("availability-status-updated",k),document.removeEventListener("visibilitychange",T),window.removeEventListener("storage",j)}),(b,P)=>o.value&&!i.value?(s(),r("div",Ss,[t("div",Ts,[P[2]||(P[2]=bt('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),t("div",As,[v(ee,{onClick:y,class:"bg-red-600 hover:bg-red-700"},{default:w(()=>P[1]||(P[1]=[S(" Submit Availability Now ",-1)])),_:1,__:[1]})]),v(Cs,{show:n.value,"next-week-dates":e.value,date:e.value.length>0?e.value[0].value:"",userId:p.value,onClose:P[0]||(P[0]=_=>n.value=!1),onAvailabilitySaved:d},null,8,["show","next-week-dates","date","userId"])])])):h("",!0)}},Is={class:"p-6"},Ms={class:"flex justify-between items-center mb-4"},Ds={class:"text-lg font-medium text-gray-900"},Ns={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Ps={class:"block sm:inline"},Es={key:0,class:"mt-6 flex justify-end space-x-3"},Vs={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:a=>["post","put","patch","delete"].includes(a.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:a=>a},beforeSubmit:{type:Function,default:()=>!0},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(a,{emit:o}){const i=a,n=o,e=A(!1),p=A({}),c=A("");G(()=>i.show,l=>{l&&(p.value={},c.value="",e.value=!1)});const g=async()=>{var l;e.value=!0,p.value={},c.value="";try{if(await i.beforeSubmit()===!1){e.value=!1;return}const d=i.formatDataForApi(i.formData);let k;const T=i.httpMethod.toLowerCase();if(T==="post")k=await window.axios.post(i.apiEndpoint,d);else if(T==="put")k=await window.axios.put(i.apiEndpoint,d);else if(T==="patch")k=await window.axios.patch(i.apiEndpoint,d);else if(T==="delete")k=await window.axios.delete(i.apiEndpoint,{data:d});else throw new Error(`Unsupported HTTP method: ${i.httpMethod}`);ae(i.successMessage),n("submitted",k.data),n("close")}catch(y){console.error("API submission error:",y);let d="An unexpected error occurred.";y.response?y.response.status===422?(p.value=y.response.data.errors||{},d=y.response.data.message||"Please correct the errors in the form."):(d=y.response.data.message||"An unexpected error occurred.",c.value=d):(d="A network error occurred or the server is unreachable.",c.value=d),Object.keys(p.value).length>0?c.value="Please correct the errors in the form.":((l=y.response)==null?void 0:l.status)!==422&&(c.value=d),Q(d),n("error",y)}finally{e.value=!1}},m=()=>{n("close")};return(l,y)=>(s(),N(Fe,{show:a.show,onClose:m},{default:w(()=>[t("div",Is,[t("div",Ms,[t("h2",Ds,I(a.title),1),t("button",{onClick:m,class:"text-gray-400 hover:text-gray-500"},y[0]||(y[0]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),c.value?(s(),r("div",Ns,[t("span",Ps,I(c.value),1)])):h("",!0),t("form",{onSubmit:Ee(g,["prevent"])},[ne(l.$slots,"default",{errors:p.value},void 0,!0),a.showFooter?(s(),r("div",Es,[v(Ie,{onClick:m,type:"button",disabled:e.value},{default:w(()=>y[1]||(y[1]=[S(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),v(ee,{type:"submit",disabled:e.value,class:V({"opacity-75 cursor-not-allowed":e.value})},{default:w(()=>[S(I(e.value?"Submitting...":a.submitButtonText),1)]),_:1},8,["disabled","class"])])):h("",!0)],32)])]),_:3},8,["show"]))}},De=xe(Vs,[["__scopeId","data-v-5ed3c88d"]]),Us=(a,o)=>{let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>a(...n),o)}},Bs={class:"relative"},Ls={class:"flex flex-wrap items-center gap-2 mb-2 p-2 border border-gray-300 rounded-lg bg-white min-h-[44px] focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 transition-all duration-150"},Rs=["onClick"],zs={key:0,class:"absolute z-20 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto mt-1 transform-gpu"},Fs=["onClick"],Ws={key:1,class:"px-4 py-2 text-sm text-gray-500"},qs={key:2,class:"px-4 py-2 text-sm text-gray-500"},Os={__name:"TagInput",props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:"Tags"},placeholder:{type:String,default:"Add tags..."},error:{type:String,default:""},initialTags:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(a,{emit:o}){const i=a,n=o,e=A(""),p=A([]),c=A([]),g=A(!1),m=A(null);function l(){n("update:modelValue",c.value.map(_=>_.id))}G(()=>i.initialTags,_=>{if(c.value=[],_&&_.length>0){const $=[],D=new Set;_.forEach(L=>{D.has(L.id)||($.push(L),D.add(L.id))}),c.value.push(...$)}const u=_.map($=>$.id),f=Array.isArray(i.modelValue)?i.modelValue:[];(u.length!==f.length||u.some($=>!f.includes($))||f.some($=>!u.includes($)))&&l()},{immediate:!0});const y=Us(async _=>{if(_.length<2){p.value=[],g.value=!1;return}try{const u=await O.get(`/api/tags/search?query=${_}`);p.value=u.data,g.value=!0}catch(u){console.error("Error fetching tags:",u),p.value=[],g.value=!1}},300);G(e,_=>{i.disabled||y(_)});const d=_=>{c.value.some(u=>u.id===_.id)||(c.value.push(_),e.value="",p.value=[],g.value=!1,l()),ye(()=>m.value.focus())},k=()=>{if(i.disabled)return;const _=e.value.trim();if(!_)return;const u=p.value.find(x=>x.name.toLowerCase()===_.toLowerCase()),f=c.value.some(x=>x.name.toLowerCase()===_.toLowerCase());if(u)d(u);else if(f)e.value="",p.value=[],g.value=!1;else{const x={id:`new_${_.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:_};c.value.push(x),e.value="",p.value=[],g.value=!1,l()}ye(()=>m.value.focus())},T=_=>{i.disabled||(c.value=c.value.filter(u=>u.id!==_.id),l(),ye(()=>m.value.focus()))},j=()=>{i.disabled||e.value===""&&c.value.length>0&&T(c.value[c.value.length-1])},b=B(()=>p.value.filter(_=>!c.value.some(u=>u.id===_.id))),P=_=>{m.value&&!m.value.$el.contains(_.target)&&(g.value=!1,e.value="")};return me(()=>{document.addEventListener("click",P)}),Pe(()=>{document.removeEventListener("click",P)}),(_,u)=>(s(),r("div",Bs,[v(R,{value:a.label,class:"mb-1"},null,8,["value"]),t("div",Ls,[(s(!0),r(K,null,J(c.value,f=>(s(),r("span",{key:f.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},[S(I(f.name)+" ",1),a.disabled?h("",!0):(s(),r("button",{key:0,type:"button",onClick:x=>T(f),class:"ml-2 -mr-1 text-indigo-500 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-full p-0.5"},u[3]||(u[3]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Rs))]))),128)),v(re,{ref_key:"inputRef",ref:m,type:"text",placeholder:c.value.length===0?a.placeholder:"",modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=f=>e.value=f),onFocus:u[1]||(u[1]=f=>g.value=!0),onKeydown:[Ne(Ee(k,["prevent"]),["enter"]),u[2]||(u[2]=Ne(f=>g.value=!1,["tab"])),Ne(j,["delete"])],class:"flex-grow min-w-[100px] border-none focus:ring-0 shadow-none p-0 bg-transparent text-gray-900",disabled:a.disabled},null,8,["placeholder","modelValue","onKeydown","disabled"])]),g.value&&(b.value.length>0||e.value.length>=2||b.value.length===0&&e.value.length<2)&&!a.disabled?(s(),r("div",zs,[(s(!0),r(K,null,J(b.value,f=>(s(),r("div",{key:f.id,onClick:x=>d(f),class:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer transition-colors duration-100"},I(f.name),9,Fs))),128)),!p.value.some(f=>f.name.toLowerCase()===e.value.toLowerCase())&&e.value.length>=2?(s(),r("div",{key:0,onClick:k,class:"px-4 py-2 text-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 cursor-pointer border-t border-indigo-200 font-semibold transition-colors duration-100"},' Add new tag: "'+I(e.value)+'" ',1)):h("",!0),b.value.length===0&&e.value.length<2?(s(),r("div",Ws," Type at least 2 characters to search for tags. ")):h("",!0),b.value.length===0&&e.value.length>=2&&!p.value.some(f=>f.name.toLowerCase()===e.value.toLowerCase())?(s(),r("div",qs,[u[4]||(u[4]=S(" No matching tags found. Press ",-1)),u[5]||(u[5]=t("span",{class:"font-semibold text-indigo-600"},"Enter",-1)),S(' to add "'+I(e.value)+'" as a new tag. ',1)])):h("",!0)])):h("",!0),v(H,{message:a.error,class:"mt-2"},null,8,["message"])]))}},lt=xe(Os,[["__scopeId","data-v-4d528a4c"]]),Hs={class:"space-y-4"},Ks="Add New Milestone",Js="/api/milestones",Ys="post",Zs="Create Milestone",Gs="Milestone created successfully!",Qs={__name:"MilestoneFormModal",props:{show:Boolean,projectId:Number},emits:["close","saved"],setup(a,{emit:o}){const i=a,n=o,e=be({name:"",description:"",completion_date:null,status:"Not Started",project_id:i.projectId}),p=be({completion_date:null}),c=["Not Started","In Progress","Completed","Overdue"];G(()=>i.show,y=>{y&&(Object.assign(e,{name:"",description:"",completion_date:null,status:"Not Started",project_id:i.projectId}),p.completion_date=null)},{immediate:!0});const g=()=>(p.completion_date=null,e.completion_date?!0:(p.completion_date=["Completion date is required."],!1)),m=y=>{n("saved",y),n("close")},l=()=>{n("close")};return(y,d)=>(s(),N(De,{show:a.show,title:Ks,"api-endpoint":Js,"http-method":Ys,"form-data":e,"submit-button-text":Zs,"success-message":Gs,"before-submit":g,onClose:l,onSubmitted:m},{default:w(({errors:k})=>[t("div",Hs,[t("div",null,[v(R,{for:"milestone-name",value:"Milestone Name"}),v(re,{id:"milestone-name",modelValue:e.name,"onUpdate:modelValue":d[0]||(d[0]=T=>e.name=T),type:"text",class:"mt-1 block w-full",placeholder:"Enter milestone name",required:""},null,8,["modelValue"]),v(H,{message:k.name?k.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"milestone-description",value:"Description"}),Y(t("textarea",{id:"milestone-description","onUpdate:modelValue":d[1]||(d[1]=T=>e.description=T),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter milestone description"},null,512),[[le,e.description]]),v(H,{message:k.description?k.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"milestone-completion-date",value:"Completion Date"}),v(re,{id:"milestone-completion-date",modelValue:e.completion_date,"onUpdate:modelValue":d[2]||(d[2]=T=>e.completion_date=T),type:"date",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(H,{message:k.completion_date?k.completion_date[0]:p.completion_date?p.completion_date[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"milestone-status",value:"Status"}),v(se,{id:"milestone-status",modelValue:e.status,"onUpdate:modelValue":d[3]||(d[3]=T=>e.status=T),options:c.map(T=>({value:T,label:T})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),v(H,{message:k.status?k.status[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]))}},Xs={class:"space-y-4"},ea={key:0},ta={key:0,class:"text-sm text-gray-500"},sa={key:0,class:"text-sm text-gray-500"},aa={key:0,class:"text-sm text-gray-500"},oa={class:"flex items-center gap-2 mt-1"},la={key:0,class:"text-sm text-gray-500"},ra=["disabled"],na="Create New Task",ia="/api/tasks",da="post",ua="Create Task",ca="Task created successfully!",ma={__name:"CreateTaskModal",props:{show:Boolean,projectId:{type:Number,default:null}},emits:["close","saved"],setup(a,{emit:o}){const i=a,n=o,e=be({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:i.projectId,priority:"medium",tags:[],tags_data:[]}),p=["To Do","In Progress","Done","Blocked","Archived"],c=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],g=A([]),m=A([]),l=A([]),y=A([]),d=A(!0),k=A(!1),T=A(!1),j=A(!1),b=A(!1);G(()=>i.show,async q=>{q&&(Object.assign(e,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:i.projectId,priority:"medium",tags:[],tags_data:[]}),i.projectId?await _(i.projectId):await P())},{immediate:!0}),G(()=>e.project_id,async q=>{q?await _(q):(m.value=[],l.value=[],y.value=[])});const P=async()=>{d.value=!0;try{const q=await window.axios.get("/api/projects-simplified");g.value=q.data.map(U=>({value:U.id,label:U.name}))}catch(q){console.error("Error fetching projects:",q),g.value=[]}finally{d.value=!1}},_=async q=>{if(q){k.value=!0,T.value=!0,j.value=!0;try{const[U,F,W]=await Promise.all([window.axios.get(`/api/projects/${q}/users`),window.axios.get("/api/task-types"),window.axios.get(`/api/projects/${q}/milestones`)]);m.value=U.data.map(oe=>({value:oe.id,label:oe.name})),l.value=F.data.map(oe=>({value:oe.id,label:oe.name})),y.value=W.data.map(oe=>({value:oe.id,label:oe.name}))}catch(U){console.error("Error fetching associated task data:",U),m.value=[],l.value=[],y.value=[]}finally{k.value=!1,T.value=!1,j.value=!1}}},u=q=>{n("saved",q),n("close")},f=()=>{n("close")},x=()=>{e.project_id?b.value=!0:alert("Please select a project before adding a milestone.")},$=q=>{if(b.value=!1,q&&q.id&&q.name){const U={value:q.id,label:q.name};y.value.some(F=>F.value===U.value)||y.value.push(U),e.milestone_id=U.value}},D=B(()=>m.value),L=B(()=>l.value),ie=B(()=>y.value);return(q,U)=>(s(),r(K,null,[v(De,{show:a.show,title:na,"api-endpoint":ia,"http-method":da,"form-data":e,"submit-button-text":ua,"success-message":ca,onClose:f,onSubmitted:u},{default:w(({errors:F})=>[t("div",Xs,[a.projectId?h("",!0):(s(),r("div",ea,[v(R,{for:"task-project",value:"Project"}),d.value?(s(),r("div",ta,"Loading projects...")):(s(),N(se,{key:1,id:"task-project",modelValue:e.project_id,"onUpdate:modelValue":U[0]||(U[0]=W=>e.project_id=W),options:g.value,"value-key":"value","label-key":"label",placeholder:"Select a project",class:"mt-1",required:!0},null,8,["modelValue","options"])),v(H,{message:F.project_id?F.project_id[0]:"",class:"mt-2"},null,8,["message"])])),t("div",null,[v(R,{for:"task-name",value:"Task Name"}),v(re,{id:"task-name",modelValue:e.name,"onUpdate:modelValue":U[1]||(U[1]=W=>e.name=W),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),v(H,{message:F.name?F.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"task-description",value:"Description"}),Y(t("textarea",{id:"task-description","onUpdate:modelValue":U[2]||(U[2]=W=>e.description=W),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[le,e.description]]),v(H,{message:F.description?F.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"task-status",value:"Status"}),v(se,{id:"task-status",modelValue:e.status,"onUpdate:modelValue":U[3]||(U[3]=W=>e.status=W),options:p.map(W=>({value:W,label:W})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),v(H,{message:F.status?F.status[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"task-priority",value:"Priority"}),v(se,{id:"task-priority",modelValue:e.priority,"onUpdate:modelValue":U[4]||(U[4]=W=>e.priority=W),options:c,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),v(H,{message:F.priority?F.priority[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"task-due-date",value:"Due Date"}),v(re,{id:"task-due-date",modelValue:e.due_date,"onUpdate:modelValue":U[5]||(U[5]=W=>e.due_date=W),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),v(H,{message:F.due_date?F.due_date[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"task-assigned-to",value:"Assigned To"}),k.value?(s(),r("div",sa,"Loading users...")):(s(),N(se,{key:1,id:"task-assigned-to",modelValue:e.assigned_to_user_id,"onUpdate:modelValue":U[6]||(U[6]=W=>e.assigned_to_user_id=W),options:D.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(H,{message:F.assigned_to_user_id?F.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"task-type",value:"Task Type"}),T.value?(s(),r("div",aa,"Loading task types...")):(s(),N(se,{key:1,id:"task-type",modelValue:e.task_type_id,"onUpdate:modelValue":U[7]||(U[7]=W=>e.task_type_id=W),options:L.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(H,{message:F.task_type_id?F.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"task-milestone",value:"Milestone"}),t("div",oa,[j.value?(s(),r("div",la,"Loading milestones...")):(s(),N(se,{key:1,id:"task-milestone",modelValue:e.milestone_id,"onUpdate:modelValue":U[8]||(U[8]=W=>e.milestone_id=W),options:ie.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"flex-grow","allow-empty":!0,disabled:!e.project_id},null,8,["modelValue","options","disabled"])),t("button",{type:"button",onClick:x,disabled:!e.project_id||j.value,class:"px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Add New Milestone"},U[11]||(U[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1)]),8,ra)]),v(H,{message:F.milestone_id?F.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(lt,{modelValue:e.tags,"onUpdate:modelValue":U[9]||(U[9]=W=>e.tags=W),initialTags:e.tags_data,label:"Tags",placeholder:"Search or add tags",error:F.tags?F.tags[0]:"",disabled:!e.project_id},null,8,["modelValue","initialTags","error","disabled"])])])]),_:1},8,["show","form-data"]),v(Qs,{show:b.value,"project-id":e.project_id,onClose:U[10]||(U[10]=F=>b.value=!1),onSaved:$},null,8,["show","project-id"])],64))}},va={class:"space-y-4"},pa={class:"flex items-center mt-4"},ga={__name:"CreateForm",props:{show:{type:Boolean,default:!1},apiEndpoint:{type:String,required:!0}},emits:["close","resourceCreated"],setup(a,{emit:o}){const i=a,n=o,e=be({title:"",description:"",url:"",type:"website",thumbnail_url:"",visible_to_client:!0,tags:[]}),p=B(()=>[{value:"website",label:"Website"},{value:"youtube",label:"YouTube Video"},{value:"document",label:"Document"},{value:"image",label:"Image"},{value:"other",label:"Other"}]),c=l=>l,g=l=>{n("resourceCreated",l),m()},m=()=>{e.title="",e.description="",e.url="",e.type="website",e.thumbnail_url="",e.visible_to_client=!0,e.tags=[],n("close")};return(l,y)=>(s(),N(De,{show:i.show,title:"Add New Shareable Resource",apiEndpoint:i.apiEndpoint,httpMethod:"post",formData:e,submitButtonText:"Create Resource",successMessage:"Shareable resource created successfully!",formatDataForApi:c,onSubmitted:g,onClose:m},{default:w(({errors:d})=>[t("div",va,[t("div",null,[v(R,{for:"title",value:"Title",class:"mb-1"}),v(re,{id:"title",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.title,"onUpdate:modelValue":y[0]||(y[0]=k=>e.title=k),required:""},null,8,["modelValue"]),v(H,{message:d.title?d.title[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"url",value:"Resource URL",class:"mb-1"}),v(re,{id:"url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.url,"onUpdate:modelValue":y[1]||(y[1]=k=>e.url=k),required:""},null,8,["modelValue"]),v(H,{message:d.url?d.url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"type",value:"Resource Type",class:"mb-1"}),v(se,{id:"type",modelValue:e.type,"onUpdate:modelValue":y[2]||(y[2]=k=>e.type=k),options:p.value,valueKey:"value",labelKey:"label",placeholder:"Select Resource Type",required:"",class:"mt-1 block w-full"},null,8,["modelValue","options"]),v(H,{message:d.type?d.type[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"thumbnail_url",value:"Thumbnail URL (Optional)",class:"mb-1"}),v(re,{id:"thumbnail_url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.thumbnail_url,"onUpdate:modelValue":y[3]||(y[3]=k=>e.thumbnail_url=k)},null,8,["modelValue"]),v(H,{message:d.thumbnail_url?d.thumbnail_url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(R,{for:"description",value:"Description (Optional)",class:"mb-1"}),Y(t("textarea",{id:"description",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm mt-1 block w-full","onUpdate:modelValue":y[4]||(y[4]=k=>e.description=k),rows:"3"},null,512),[[le,e.description]]),v(H,{message:d.description?d.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(lt,{modelValue:e.tags,"onUpdate:modelValue":y[5]||(y[5]=k=>e.tags=k),label:"Associated Tags",placeholder:"Search or add tags",error:d.tags?d.tags[0]:""},null,8,["modelValue","error"])]),t("div",pa,[v(Tt,{id:"visible_to_client",checked:e.visible_to_client,"onUpdate:checked":y[6]||(y[6]=k=>e.visible_to_client=k)},null,8,["checked"]),v(R,{for:"visible_to_client",value:"Visible to Client",class:"ml-2"}),v(H,{message:d.visible_to_client?d.visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","apiEndpoint","formData"]))}},fa=xe(ga,[["__scopeId","data-v-3e3a6a9f"]]),ya={key:0,class:"sidebar-wrapper"},ha={class:"fixed inset-0 z-[100] flex pointer-events-none"},ka={class:"flex items-center justify-between p-4 border-b border-gray-200 bg-white rounded-tl-xl sticky top-0 z-20"},ba={class:"text-xl font-semibold text-gray-900"},xa={class:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-gray-300 scrollbar-track-gray-100"},wa={key:1,class:"p-4 border-t border-gray-200 bg-white sticky bottom-0 z-20"},_a={__name:"RightSidebar",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Details"},initialWidth:{type:Number,default:50},minWidth:{type:Number,default:30},maxWidth:{type:Number,default:90}},emits:["close","update:show"],setup(a,{emit:o}){const i=a,n=o,e=A(i.initialWidth),p=A(!1),c=d=>{p.value=!0,document.addEventListener("pointermove",g),document.addEventListener("pointerup",m)},g=d=>{if(!p.value)return;const k=window.innerWidth,j=(k-d.clientX)/k*100,b=Math.max(i.minWidth,Math.min(i.maxWidth,j));e.value=b},m=()=>{p.value=!1,document.removeEventListener("pointermove",g),document.removeEventListener("pointerup",m)};G(()=>i.show,d=>{d?document.body.style.overflow="hidden":document.body.style.overflow=""},{immediate:!0});const l=()=>{n("update:show",!1),n("close")},y=B(()=>window.innerWidth<768);return G(y,d=>{d&&i.show?e.value=100:!d&&i.show&&(e.value=i.initialWidth)},{immediate:!0}),G(()=>i.show,d=>{d&&(y.value?e.value=100:e.value=i.initialWidth)}),(d,k)=>(s(),N(wt,{to:"body"},[v(st,{"enter-active-class":"transition ease-out duration-300 transform","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"transition ease-in duration-200 transform","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:w(()=>[a.show?(s(),r("div",ya,[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity z-[99]",onClick:l}),t("div",ha,[t("div",{class:"relative ml-auto h-full bg-white shadow-xl flex flex-col rounded-l-xl pointer-events-auto",style:xt({width:y.value?"100%":`${e.value}vw`})},[y.value?h("",!0):(s(),r("div",{key:0,class:"absolute left-0 top-0 h-full w-2 cursor-col-resize -ml-1 z-10",onPointerdown:c,title:"Drag to resize"},null,32)),t("div",ka,[t("h3",ba,I(a.title),1),t("button",{onClick:l,class:"text-gray-400 hover:text-gray-600 transition-colors"},k[0]||(k[0]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",xa,[ne(d.$slots,"content",{},void 0,!0)]),d.$slots.footer?(s(),r("div",wa,[ne(d.$slots,"footer",{},void 0,!0)])):h("",!0)],4)])])):h("",!0)]),_:3})]))}},rt=xe(_a,[["__scopeId","data-v-2d864577"]]),$a={class:"flex border-b border-gray-200"},Ca={key:0,class:"ml-2 px-2 py-1 text-xs font-bold bg-red-600 text-white rounded-full"},Sa={class:"p-4 space-y-2 overflow-y-auto"},Ta={key:0,class:"p-6 text-center text-gray-500"},Aa={key:0},ja={key:1},Ia=["onClick"],Ma={class:"flex-1 min-w-0"},Da={class:"flex items-start justify-between gap-2 mb-1"},Na={class:"flex-1 min-w-0"},Pa={key:0,class:"text-base font-semibold text-gray-900 truncate"},Ea={key:1,class:"text-xs text-gray-500"},Va={key:0,class:"text-sm text-gray-600 mt-1 mb-2"},Ua={class:"flex items-center text-xs text-gray-500 font-medium"},Ba={key:0},La={key:1,class:"mx-2"},Ra={key:2},za={__name:"NotificationsSidebar",setup(a){const o=B(()=>je.value.notifications),i=A("New"),n=B(()=>i.value==="New"?o.value.filter(g=>!g.isRead):o.value),e=async g=>{await Xe(g.view_id);const m=g.task_id||p(g.url),l=g.project_id||c(g.url);m&&l?(et(m,l),Oe()):(console.warn("Could not open task sidebar. Falling back to opening URL in new tab."),g.url&&window.open(g.url,"_blank"))},p=g=>{const m=g.match(/\/task\/(\d+)/);return m?parseInt(m[1]):null},c=g=>{const m=g.match(/\/project\/(\d+)\//);return m?parseInt(m[1]):null};return(g,m)=>(s(),N(rt,{show:M(je).show,"onUpdate:show":M(Oe),title:"Notifications","initial-width":35,class:"z-[100]"},{content:w(()=>[t("div",$a,[t("button",{onClick:m[0]||(m[0]=l=>i.value="New"),class:V([{"border-blue-600 text-blue-600 font-semibold":i.value==="New","border-transparent text-gray-500 hover:text-gray-700":i.value!=="New"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])},[m[2]||(m[2]=S(" New ",-1)),o.value.filter(l=>!l.isRead).length>0?(s(),r("span",Ca,I(o.value.filter(l=>!l.isRead).length),1)):h("",!0)],2),t("button",{onClick:m[1]||(m[1]=l=>i.value="All"),class:V([{"border-blue-600 text-blue-600 font-semibold":i.value==="All","border-transparent text-gray-500 hover:text-gray-700":i.value!=="All"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])}," All ",2)]),t("div",Sa,[n.value.length===0?(s(),r("div",Ta,[i.value==="New"?(s(),r("span",Aa,"You have no new notifications.")):(s(),r("span",ja,"You have no notifications."))])):h("",!0),(s(!0),r(K,null,J(n.value,l=>(s(),r("div",{key:l.id,class:V(["bg-white rounded-xl shadow-sm p-4 flex items-start space-x-4 border border-gray-200 transition-all duration-200 hover:shadow-md cursor-pointer",{"bg-gray-50":l.isRead}]),onClick:y=>e(l)},[t("div",Ma,[t("div",Da,[t("div",Na,[l.title?(s(),r("h3",Pa,I(l.title),1)):h("",!0),l.project_name?(s(),r("p",Ea,I(l.project_name),1)):h("",!0)])]),l.message?(s(),r("p",Va,I(l.message),1)):h("",!0),t("div",Ua,[l.due_date?(s(),r("span",Ba,"Due: "+I(M(Qe)(l.due_date)),1)):h("",!0),l.due_date&&l.priority?(s(),r("span",La,"•")):h("",!0),l.priority?(s(),r("span",Ra,"Priority: "+I(l.priority),1)):h("",!0)])])],10,Ia))),128))])]),_:1},8,["show","onUpdate:show"]))}},Fa={class:"space-y-4"},Wa={key:0,class:"text-red-600 text-xs mt-1"},qa={key:0,class:"text-red-600 text-xs mt-1"},Oa={key:0,class:"text-red-600 text-xs mt-1"},Ha={__name:"KudoModal",props:{show:{type:Boolean,default:!1}},emits:["close","submitted"],setup(a,{emit:o}){const i=o,n=A([]),e=A([]),p=be({recipient_id:"",project_id:"",comment:""}),c=A({}),g=async()=>{try{const{data:d}=await window.axios.get("/api/projects-simplified");n.value=(d||[]).map(k=>({value:k.id,label:k.name}))}catch{n.value=[]}},m=async d=>{if(e.value=[],!!d)try{const{data:k}=await window.axios.get(`/api/projects/${d}/users`);e.value=(k||[]).map(T=>({value:T.id,label:`${T.name} (${T.email})`}))}catch{e.value=[]}};G(()=>p.project_id,d=>{d&&m(d)}),me(()=>{g()});const l=()=>{p.recipient_id="",p.project_id="",p.comment="",c.value={}},y=d=>{l(),i("submitted",d)};return(d,k)=>(s(),N(De,{show:a.show,title:"Give a Kudo ✨","api-endpoint":"/api/kudos","http-method":"post","form-data":p,"submit-button-text":"Submit Kudo","success-message":"Kudo submitted! Pending approval.",onClose:k[3]||(k[3]=T=>d.$emit("close")),onSubmitted:y},{default:w(({errors:T})=>[t("div",Fa,[t("div",null,[k[4]||(k[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Project",-1)),v(se,{options:n.value,modelValue:p.project_id,"onUpdate:modelValue":k[0]||(k[0]=j=>p.project_id=j),placeholder:"Select a project..."},null,8,["options","modelValue"]),T.project_id?(s(),r("p",Wa,I(T.project_id[0]),1)):h("",!0)]),t("div",null,[k[5]||(k[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Recipient",-1)),v(se,{options:e.value,modelValue:p.recipient_id,"onUpdate:modelValue":k[1]||(k[1]=j=>p.recipient_id=j),placeholder:"Select a teammate..."},null,8,["options","modelValue"]),T.recipient_id?(s(),r("p",qa,I(T.recipient_id[0]),1)):h("",!0)]),t("div",null,[k[6]||(k[6]=t("label",{class:"block text-sm font-medium text-gray-700"},"Comment",-1)),Y(t("textarea",{"onUpdate:modelValue":k[2]||(k[2]=j=>p.comment=j),rows:"4",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"e.g., Thank you for helping with the last-minute changes!"},null,512),[[le,p.comment]]),T.comment?(s(),r("p",Oa,I(T.comment[0]),1)):h("",!0)])])]),_:1},8,["show","form-data"]))}},Ka={class:"flex items-center p-4 h-16 border-b border-gray-700"},Ja={key:0,class:"text-xl font-semibold flex-1 truncate"},Ya=["title"],Za={key:0,class:"p-4 border-b border-gray-700"},Ga={class:"relative"},Qa={key:1,class:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-500 scrollbar-track-gray-700 p-4"},Xa={key:0,class:"mb-4"},eo={class:"ml-2 mt-2 space-y-1"},to=["onClick"],so={class:"text-sm font-medium text-gray-300 truncate"},ao={class:"ml-4 mt-1 space-y-1"},oo={class:"truncate"},lo={key:1,class:"mb-4"},ro={class:"ml-2 mt-2 space-y-1"},no=["onClick"],io={class:"text-sm font-medium text-gray-300 truncate"},uo={class:"ml-4 mt-1 space-y-1"},co={class:"truncate"},mo={key:2,class:"mb-4"},vo={class:"ml-2 mt-2 space-y-1"},po={class:"truncate"},go={key:3,class:"mb-4"},fo={class:"ml-2 mt-2 space-y-1"},yo={class:"truncate"},ho={key:4,class:"text-gray-400 text-sm text-center py-4"},ko={key:5,class:"text-gray-400 text-sm text-center py-4"},bo={key:2,class:"flex flex-col items-center pt-4 space-y-4"},xo={key:0,class:"text-gray-400 text-xs text-center px-2"},wo={__name:"LeftSidebar",props:{allProjects:{type:Array,default:()=>[]},activeProjectId:{type:Number,default:null}},emits:["project-selected"],setup(a,{emit:o}){const i=a,n=o,e=A(localStorage.getItem("leftSidebarCollapsed")!=="false"),p=A(""),c=A({}),g=B(()=>{const u=new Set;return i.allProjects.forEach(f=>{f.project_type&&u.add(f.project_type)}),Array.from(u).sort()}),m=B(()=>{const u=new Set;return i.allProjects.forEach(f=>{Array.isArray(f.tags)&&f.tags.forEach(x=>u.add(x))}),Array.from(u).sort()}),l=B(()=>{if(!p.value)return i.allProjects;const u=p.value.toLowerCase();return i.allProjects.filter(f=>{var x,$,D;return f.name.toLowerCase().includes(u)||((x=f.description)==null?void 0:x.toLowerCase().includes(u))||(($=f.project_type)==null?void 0:$.toLowerCase().includes(u))||Array.isArray(f.tags)&&f.tags.some(L=>L.toLowerCase().includes(u))||((D=f.status)==null?void 0:D.toLowerCase().includes(u))})}),y=B(()=>{const u={};l.value.forEach(f=>{f.project_type&&f.status==="active"&&(u[f.project_type]||(u[f.project_type]=[]),u[f.project_type].push(f))});for(const f in u)u[f].sort((x,$)=>x.name.localeCompare($.name));return u}),d=B(()=>{const u={};l.value.forEach(f=>{Array.isArray(f.tags)&&f.tags.length>0&&f.tags.forEach(x=>{u[x]||(u[x]=[]),u[x].push(f)})});for(const f in u)u[f]=[...new Set(u[f])].sort((x,$)=>x.name.localeCompare($.name));return u}),k=B(()=>l.value.filter(u=>u.status!=="active").sort((u,f)=>u.name.localeCompare(f.name))),T=B(()=>l.value.filter(u=>!u.project_type&&(!Array.isArray(u.tags)||u.tags.length===0)).sort((u,f)=>u.name.localeCompare(f.name)));G(()=>i.allProjects,()=>{g.value.forEach(u=>{const f=`type-${u}`;c.value[f]===void 0&&(c.value[f]=!0)}),m.value.forEach(u=>{const f=`tag-${u}`;c.value[f]===void 0&&(c.value[f]=!0)}),c.value["main-types"]===void 0&&(c.value["main-types"]=!1),c.value["main-tags"]===void 0&&(c.value["main-tags"]=!1),c.value["inactive-projects"]===void 0&&(c.value["inactive-projects"]=!1),c.value.uncategorized===void 0&&(c.value.uncategorized=!1)},{immediate:!0}),G(e,u=>{localStorage.setItem("leftSidebarCollapsed",u)});const j=()=>{e.value=!e.value},b=u=>{c.value[u]=!c.value[u]},P=u=>{n("project-selected",u)},_=()=>{p.value=""};return(u,f)=>(s(),r("div",{class:V({"w-64":!e.value,"w-16":e.value,"min-w-16":!0,"bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out shrink-0 h-screen overflow-hidden":!0})},[t("div",Ka,[e.value?h("",!0):(s(),r("h2",Ja,"Projects")),t("button",{onClick:j,class:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:e.value?"Expand Sidebar":"Collapse Sidebar"},[(s(),r("svg",{class:V(["w-6 h-6 text-gray-400 transform transition-transform duration-300",{"rotate-180":e.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},f[5]||(f[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],8,Ya)]),e.value?h("",!0):(s(),r("div",Za,[t("div",Ga,[Y(t("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=x=>p.value=x),placeholder:"Search all projects...",class:"w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 text-sm"},null,512),[[le,p.value]]),p.value?(s(),r("button",{key:0,onClick:_,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200",title:"Clear search"},f[6]||(f[6]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):h("",!0)])])),e.value?(s(),r("div",bo,[(s(!0),r(K,null,J(i.allProjects,x=>(s(),N(M(de),{key:x.id,href:u.route("projects.show",x.id),onClick:$=>P(x.id),class:V({"w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-200":!0,"bg-indigo-600 text-white":x.id===a.activeProjectId,"bg-gray-700 text-gray-300 hover:bg-gray-600":x.id!==a.activeProjectId}),title:x.name},{default:w(()=>[S(I(x.name.charAt(0).toUpperCase()),1)]),_:2},1032,["href","onClick","class","title"]))),128)),a.allProjects.length===0?(s(),r("div",xo," No Projects ")):h("",!0)])):(s(),r("div",Qa,[Object.keys(y.value).length>0?(s(),r("div",Xa,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:f[1]||(f[1]=x=>b("main-types"))},[f[8]||(f[8]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Active Projects by Type",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!c.value["main-types"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f[7]||(f[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Y(t("div",eo,[(s(!0),r(K,null,J(y.value,(x,$)=>(s(),r("div",{key:$},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:D=>b(`type-${$}`)},[t("h4",so,I($),1),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!c.value[`type-${$}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f[9]||(f[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,to),Y(t("ul",ao,[(s(!0),r(K,null,J(x,D=>(s(),r("li",{key:D.id},[v(M(de),{href:u.route("projects.show",D.id),onClick:L=>P(D.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":D.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":D.id!==a.activeProjectId,"font-bold":D.id===a.activeProjectId})},{default:w(()=>[t("span",oo,I(D.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!c.value[`type-${$}`]]])]))),128))],512),[[ce,!c.value["main-types"]]])])):h("",!0),Object.keys(d.value).length>0?(s(),r("div",lo,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:f[2]||(f[2]=x=>b("main-tags"))},[f[11]||(f[11]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Projects by Tag",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!c.value["main-tags"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f[10]||(f[10]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Y(t("div",ro,[(s(!0),r(K,null,J(d.value,(x,$)=>(s(),r("div",{key:$},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:D=>b(`tag-${$}`)},[t("h4",io,I($),1),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!c.value[`tag-${$}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f[12]||(f[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,no),Y(t("ul",uo,[(s(!0),r(K,null,J(x,D=>(s(),r("li",{key:D.id},[v(M(de),{href:u.route("projects.show",D.id),onClick:L=>P(D.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":D.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":D.id!==a.activeProjectId,"font-bold":D.id===a.activeProjectId})},{default:w(()=>[t("span",co,I(D.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!c.value[`tag-${$}`]]])]))),128))],512),[[ce,!c.value["main-tags"]]])])):h("",!0),k.value.length>0?(s(),r("div",mo,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:f[3]||(f[3]=x=>b("inactive-projects"))},[f[14]||(f[14]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Inactive Projects",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!c.value["inactive-projects"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f[13]||(f[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Y(t("ul",vo,[(s(!0),r(K,null,J(k.value,x=>(s(),r("li",{key:x.id},[v(M(de),{href:u.route("projects.show",x.id),onClick:$=>P(x.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":x.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":x.id!==a.activeProjectId,"font-bold":x.id===a.activeProjectId})},{default:w(()=>[t("span",po,I(x.name)+" ("+I(x.status.replace("_"," "))+")",1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!c.value["inactive-projects"]]])])):h("",!0),T.value.length>0?(s(),r("div",go,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:f[4]||(f[4]=x=>b("uncategorized"))},[f[16]||(f[16]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Uncategorized",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!c.value.uncategorized}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},f[15]||(f[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Y(t("ul",fo,[(s(!0),r(K,null,J(T.value,x=>(s(),r("li",{key:x.id},[v(M(de),{href:u.route("projects.show",x.id),onClick:$=>P(x.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":x.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":x.id!==a.activeProjectId,"font-bold":x.id===a.activeProjectId})},{default:w(()=>[t("span",yo,I(x.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!c.value.uncategorized]])])):h("",!0),l.value.length===0?(s(),r("div",ho," No projects found matching your search. ")):a.allProjects.length===0&&!p.value?(s(),r("div",ko," No projects available. ")):h("",!0)]))],2))}},_o=xe(wo,[["__scopeId","data-v-417d431f"]]),$o={class:"relative"},nt={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(a){const o=a,i=g=>{c.value&&g.key==="Escape"&&(c.value=!1)};me(()=>document.addEventListener("keydown",i)),Pe(()=>document.removeEventListener("keydown",i));const n=B(()=>{const g={48:"w-48",64:"w-64",72:"w-72",80:"w-80",96:"w-96",full:"w-full",screen:"w-screen",auto:""},m=o.width.toString();return g[m]??g[48]}),e=B(()=>o.width.toString()==="screen"),p=B(()=>o.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":o.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),c=A(!1);return(g,m)=>(s(),r("div",$o,[t("div",{onClick:m[0]||(m[0]=l=>c.value=!c.value)},[ne(g.$slots,"trigger")]),Y(t("div",{class:"fixed inset-0 z-40",onClick:m[1]||(m[1]=l=>c.value=!1)},null,512),[[ce,c.value]]),v(st,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:w(()=>[Y(t("div",{class:V(["z-50 mt-2 rounded-md shadow-lg",e.value?"fixed left-0 right-0":"absolute",p.value,n.value]),style:{display:"none"},onClick:m[2]||(m[2]=l=>c.value=!1)},[t("div",{class:V(["rounded-md ring-1 ring-black ring-opacity-5",a.contentClasses])},[ne(g.$slots,"content")],2)],2),[[ce,c.value]])]),_:3})]))}},X={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){return(o,i)=>(s(),N(M(de),at({href:a.href,method:a.method,as:a.as},o.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:w(()=>[ne(o.$slots,"default")]),_:3},16,["href","method","as"]))}},ke={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(a){const o=a,i=B(()=>o.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(n,e)=>(s(),N(M(de),{href:a.href,class:V(i.value)},{default:w(()=>[ne(n.$slots,"default")]),_:3},8,["href","class"]))}};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Co=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(o,i,n)=>n?n.toUpperCase():i.toLowerCase()),So=a=>{const o=Co(a);return o.charAt(0).toUpperCase()+o.slice(1)},To=(...a)=>a.filter((o,i,n)=>!!o&&o.trim()!==""&&n.indexOf(o)===i).join(" ").trim(),Ye=a=>a==="";/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Te={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=({name:a,iconNode:o,absoluteStrokeWidth:i,"absolute-stroke-width":n,strokeWidth:e,"stroke-width":p,size:c=Te.width,color:g=Te.stroke,...m},{slots:l})=>Re("svg",{...Te,...m,width:c,height:c,stroke:g,"stroke-width":Ye(i)||Ye(n)||i===!0||n===!0?Number(e||p||Te["stroke-width"])*24/Number(c):e||p||Te["stroke-width"],class:To("lucide",m.class,...a?[`lucide-${Je(So(a))}-icon`,`lucide-${Je(a)}`]:["lucide-icon"])},[...o.map(y=>Re(...y)),...l.default?[l.default()]:[]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=(a,o)=>(i,{slots:n,attrs:e})=>Re(Ao,{...e,...i,iconNode:o,name:a},n);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=it("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=it("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Mo={class:"hidden sm:flex sm:items-center"},Do={class:"mx-auto w-full max-w-6xl"},No={class:"grid grid-cols-2 md:grid-cols-4 gap-8"},Po={class:"space-y-1"},Eo={class:"space-y-1"},Vo={class:"space-y-1"},Uo={class:"space-y-1"},Bo={__name:"AdminDropdown",setup(a){const{canDo:o}=ze(),i=o("manage_projects"),n=o("create_users"),e=o("manage_roles"),p=o("manage_task_types"),c=o("create_clients"),g=o("manage_project_tiers")||o("view_project_tiers");return(m,l)=>(s(),r("div",Mo,[v(nt,{align:"left",width:"screen","content-classes":"py-6 bg-white p-6 w-full shadow-lg"},{trigger:w(()=>l[0]||(l[0]=[t("span",{class:"inline-flex rounded-md"},[t("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-700 hover:text-gray-900 focus:outline-none"},[S(" Admin "),t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:w(()=>[t("div",Do,[t("div",No,[t("div",null,[l[4]||(l[4]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Management",-1)),t("div",Po,[M(i)?(s(),N(X,{key:0,href:m.route("projects.index"),active:m.route().current("projects.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[1]||(l[1]=[S("Projects",-1)])),_:1,__:[1]},8,["href","active"])):h("",!0),M(c)?(s(),N(X,{key:1,href:m.route("clients.index"),active:m.route().current("clients.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[2]||(l[2]=[S("Clients",-1)])),_:1,__:[2]},8,["href","active"])):h("",!0),M(n)?(s(),N(X,{key:2,href:m.route("users.index"),active:m.route().current("users.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[3]||(l[3]=[S("Users",-1)])),_:1,__:[3]},8,["href","active"])):h("",!0)])]),t("div",null,[l[8]||(l[8]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Planning / Sharing",-1)),t("div",Eo,[M(n)?(s(),N(X,{key:0,href:m.route("availability.index"),active:m.route().current("availability.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[5]||(l[5]=[S("Weekly Availability",-1)])),_:1,__:[5]},8,["href","active"])):h("",!0),M(o)("manage_notices")?(s(),N(X,{key:1,href:m.route("admin.notice-board.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[6]||(l[6]=[S("Notice Board",-1)])),_:1,__:[6]},8,["href"])):h("",!0),M(o)("manage_notices")?(s(),N(X,{key:2,href:m.route("shareable-resources.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[7]||(l[7]=[S("Shareable Resources",-1)])),_:1,__:[7]},8,["href"])):h("",!0)])]),t("div",null,[l[13]||(l[13]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Configuration",-1)),t("div",Vo,[M(p)?(s(),N(X,{key:0,href:m.route("task-types.index"),active:m.route().current("task-types.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[9]||(l[9]=[S("Task Types",-1)])),_:1,__:[9]},8,["href","active"])):h("",!0),M(g)||M(o)("create_project_tiers")||M(o)("edit_project_tiers")?(s(),N(X,{key:1,href:"/admin/project-tiers",class:"!px-2 !py-1.5"},{default:w(()=>l[10]||(l[10]=[S("Project Tiers",-1)])),_:1,__:[10]})):h("",!0),M(o)("manage_email_templates")?(s(),N(X,{key:2,href:m.route("email-templates.index"),active:m.route().current("email-templates.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[11]||(l[11]=[S("Email Templates",-1)])),_:1,__:[11]},8,["href","active"])):h("",!0),M(o)("manage_placeholder_definitions")?(s(),N(X,{key:3,href:m.route("placeholder-definitions.index"),active:m.route().current("placeholder-definitions.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[12]||(l[12]=[S("Placeholder Definitions",-1)])),_:1,__:[12]},8,["href","active"])):h("",!0)])]),t("div",null,[l[18]||(l[18]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Access & Finance",-1)),t("div",Uo,[M(e)?(s(),N(X,{key:0,href:m.route("admin.roles.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[14]||(l[14]=[S("Manage Roles",-1)])),_:1,__:[14]},8,["href"])):h("",!0),M(o)("manage_permissions")?(s(),N(X,{key:1,href:m.route("admin.permissions.index"),class:"!px-2 !py-1.5"},{default:w(()=>l[15]||(l[15]=[S("Manage Permissions",-1)])),_:1,__:[15]},8,["href"])):h("",!0),M(o)("manage_monthly_budgets")?(s(),N(X,{key:2,href:"/admin/monthly-budgets",class:"!px-2 !py-1.5"},{default:w(()=>l[16]||(l[16]=[S("Monthly Budgets",-1)])),_:1,__:[16]})):h("",!0),M(o)("view_monthly_budgets")?(s(),N(X,{key:3,href:"/admin/bonus-calculator",class:"!px-2 !py-1.5"},{default:w(()=>l[17]||(l[17]=[S("Bonus Calculator",-1)])),_:1,__:[17]})):h("",!0)])])])])]),_:1})]))}},Lo={class:"relative ms-3"},Ro={class:"inline-flex rounded-md"},zo={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},Fo={__name:"UserDropdown",emits:["logoutSuccess","logoutError"],setup(a,{emit:o}){const i=B(()=>Me().props.auth.user),n=o,e=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,n("logoutSuccess")},p=c=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",n("logoutError",c)};return(c,g)=>(s(),r("div",Lo,[v(nt,{align:"right",width:"48"},{trigger:w(()=>{var m;return[t("span",Ro,[t("button",zo,[S(I(i.value.name)+" ("+I((m=i.value.role_data)==null?void 0:m.name)+") ",1),g[0]||(g[0]=t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:w(()=>[v(X,{href:c.route("profile.edit")},{default:w(()=>g[1]||(g[1]=[S(" Profile ",-1)])),_:1,__:[1]},8,["href"]),v(X,{href:c.route("logout"),method:"post",as:"button",onSuccess:e,onError:p},{default:w(()=>g[2]||(g[2]=[S(" Log Out ",-1)])),_:1,__:[2]},8,["href"])]),_:1})]))}},Wo={class:"border-b border-gray-100 bg-white z-10 relative w-full"},qo={class:"w-full px-4 sm:px-6 lg:px-8"},Oo={class:"flex h-16 justify-between"},Ho={class:"flex flex-1 min-w-0"},Ko={class:"flex shrink-0 items-center"},Jo={class:"hidden sm:-my-px sm:ms-10 sm:flex sm:flex-wrap sm:gap-4 overflow-x-auto no-scrollbar"},Yo={class:"hidden sm:ms-6 sm:flex sm:items-center"},Zo={key:0,class:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-100 transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full"},Go={class:"-me-2 flex items-center sm:hidden"},Qo={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},Xo={__name:"TopNavigation",props:{unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar","open-kudo-modal"],setup(a,{emit:o}){const i=o,n=A(!1);B(()=>Me().props.auth.user);const{canDo:e}=ze(),p=e("manage_roles");return(c,g)=>(s(),r("nav",Wo,[t("div",qo,[t("div",Oo,[t("div",Ho,[t("div",Ko,[v(M(de),{href:c.route("dashboard")},{default:w(()=>[v(At,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),t("div",Jo,[v(ke,{href:c.route("dashboard"),active:c.route().current("dashboard")},{default:w(()=>g[5]||(g[5]=[S(" Dashboard ",-1)])),_:1,__:[5]},8,["href","active"]),v(ke,{href:c.route("inbox"),active:c.route().current("inbox")},{default:w(()=>g[6]||(g[6]=[S(" Inbox ",-1)])),_:1,__:[6]},8,["href","active"]),v(ke,{href:c.route("bonus-system.index"),active:c.route().current("bonus-system.index")},{default:w(()=>g[7]||(g[7]=[S(" Bonus System ",-1)])),_:1,__:[7]},8,["href","active"]),v(ke,{href:c.route("leaderboard.index"),active:c.route().current("leaderboard.index")},{default:w(()=>g[8]||(g[8]=[S(" Leaderboard ",-1)])),_:1,__:[8]},8,["href","active"]),v(ke,{href:c.route("kudos.index"),active:c.route().current("kudos.index")},{default:w(()=>g[9]||(g[9]=[S(" Kudos ",-1)])),_:1,__:[9]},8,["href","active"]),M(e)("add_expendables").value?(s(),N(ke,{key:0,href:c.route("project-expendables.index"),class:"!px-2 !py-1.5"},{default:w(()=>g[10]||(g[10]=[S("Project Expendables",-1)])),_:1,__:[10]},8,["href"])):h("",!0),M(p)?(s(),N(Bo,{key:1})):h("",!0)])]),t("div",Yo,[v(ee,{type:"button",onClick:g[0]||(g[0]=m=>i("openCreateTaskModal")),class:"mr-2 px-4 py-2 text-sm"},{default:w(()=>g[11]||(g[11]=[S(" Add Task ",-1)])),_:1,__:[11]}),v(ee,{type:"button",onClick:g[1]||(g[1]=m=>i("openAddResource")),class:"mr-2 px-4 py-2 text-sm"},{default:w(()=>g[12]||(g[12]=[S(" Add Resource ",-1)])),_:1,__:[12]}),M(e)("create_kudos")?(s(),N(ee,{key:0,type:"button",onClick:g[2]||(g[2]=m=>c.$emit("open-kudo-modal")),class:"mr-2 px-4 py-2 text-sm bg-orange-500 hover:bg-orange-600"},{default:w(()=>g[13]||(g[13]=[S(" ✨ Give Kudo ",-1)])),_:1,__:[13]})):h("",!0),t("button",{onClick:g[3]||(g[3]=m=>i("openNotificationsSidebar")),class:"relative flex-shrink-0 text-gray-400 hover:text-gray-600 p-1 rounded-full transition-colors duration-200 mr-4","aria-label":"View all notifications"},[v(M(jo),{class:"h-6 w-6"}),a.unreadNotificationCount>0?(s(),r("span",Zo,I(a.unreadNotificationCount),1)):h("",!0)]),v(Fo)]),t("div",Go,[t("button",{onClick:g[4]||(g[4]=m=>n.value=!n.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(s(),r("svg",Qo,[t("path",{class:V({hidden:n.value,"inline-flex":!n.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),t("path",{class:V({hidden:!n.value,"inline-flex":n.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])])]))}},Z={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){const o=a,i=B(()=>o.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(n,e)=>(s(),N(M(de),at({href:a.href,method:a.method,as:a.as},n.$attrs,{class:i.value}),{default:w(()=>[ne(n.$slots,"default")]),_:3},16,["href","method","as","class"]))}},el={class:"space-y-1 pb-3 pt-2"},tl={key:0,class:"mt-3 space-y-1"},sl={class:"border-t border-gray-200 pb-1 pt-4"},al={class:"px-4"},ol={class:"text-base font-medium text-gray-800"},ll={class:"text-sm font-medium text-gray-500"},rl={class:"text-sm font-medium text-gray-500 capitalize"},nl={class:"mt-3 space-y-1"},il={__name:"MobileNavigation",props:{showingNavigationDropdown:{type:Boolean,required:!0},unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar","logoutSuccess","logoutError"],setup(a,{emit:o}){const i=o,n=B(()=>Me().props.auth.user),{canDo:e}=ze(),p=e("manage_projects"),c=e("compose_emails"),g=e("approve_emails"),m=e("create_users"),l=e("manage_roles"),y=e("manage_task_types"),d=e("create_clients"),k=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,i("logoutSuccess")},T=j=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",i("logoutError",j)};return(j,b)=>{var P;return s(),r("div",{class:V([{block:a.showingNavigationDropdown,hidden:!a.showingNavigationDropdown},"sm:hidden"])},[t("div",el,[M(l)?(s(),r("div",tl,[b[17]||(b[17]=t("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),v(Z,{href:j.route("dashboard"),active:j.route().current("dashboard")},{default:w(()=>b[3]||(b[3]=[S(" Dashboard ",-1)])),_:1,__:[3]},8,["href","active"]),M(e)("view_emails")?(s(),N(Z,{key:0,href:j.route("inbox"),active:j.route().current("inbox")},{default:w(()=>b[4]||(b[4]=[S(" Inbox ",-1)])),_:1,__:[4]},8,["href","active"])):h("",!0),M(d)?(s(),N(Z,{key:1,href:j.route("clients.index"),active:j.route().current("clients.index")},{default:w(()=>b[5]||(b[5]=[S(" Clients ",-1)])),_:1,__:[5]},8,["href","active"])):h("",!0),M(p)?(s(),N(Z,{key:2,href:j.route("projects.index"),active:j.route().current("projects.index")},{default:w(()=>b[6]||(b[6]=[S(" Projects ",-1)])),_:1,__:[6]},8,["href","active"])):h("",!0),M(m)?(s(),N(Z,{key:3,href:j.route("users.index"),active:j.route().current("users.index")},{default:w(()=>b[7]||(b[7]=[S(" Users ",-1)])),_:1,__:[7]},8,["href","active"])):h("",!0),M(c)?(s(),N(Z,{key:4,href:j.route("emails.compose"),active:j.route().current("emails.compose")},{default:w(()=>b[8]||(b[8]=[S(" Compose Email ",-1)])),_:1,__:[8]},8,["href","active"])):h("",!0),M(g)?(s(),N(Z,{key:5,href:j.route("emails.pending"),active:j.route().current("emails.pending")},{default:w(()=>b[9]||(b[9]=[S(" Approve Emails ",-1)])),_:1,__:[9]},8,["href","active"])):h("",!0),M(c)?(s(),N(Z,{key:6,href:j.route("emails.rejected"),active:j.route().current("emails.rejected")},{default:w(()=>b[10]||(b[10]=[S(" Rejected Emails ",-1)])),_:1,__:[10]},8,["href","active"])):h("",!0),M(m)?(s(),N(Z,{key:7,href:j.route("availability.index"),active:j.route().current("availability.index")},{default:w(()=>b[11]||(b[11]=[S(" Weekly Availability ",-1)])),_:1,__:[11]},8,["href","active"])):h("",!0),M(e)("manage_roles")?(s(),N(Z,{key:8,href:j.route("admin.roles.index"),active:j.route().current("admin.roles.index")},{default:w(()=>b[12]||(b[12]=[S(" Manage Roles ",-1)])),_:1,__:[12]},8,["href","active"])):h("",!0),M(e)("manage_permissions")?(s(),N(Z,{key:9,href:j.route("admin.permissions.index"),active:j.route().current("admin.permissions.index")},{default:w(()=>b[13]||(b[13]=[S(" Manage Permissions ",-1)])),_:1,__:[13]},8,["href","active"])):h("",!0),M(y)?(s(),N(Z,{key:10,href:j.route("task-types.index"),active:j.route().current("task-types.index")},{default:w(()=>b[14]||(b[14]=[S(" Task Types ",-1)])),_:1,__:[14]},8,["href","active"])):h("",!0),M(e)("manage_email_templates")?(s(),N(Z,{key:11,href:j.route("email-templates.index"),active:j.route().current("email-templates.index")},{default:w(()=>b[15]||(b[15]=[S(" Email Templates ",-1)])),_:1,__:[15]},8,["href","active"])):h("",!0),M(e)("manage_placeholder_definitions")?(s(),N(Z,{key:12,href:j.route("placeholder-definitions.index"),active:j.route().current("placeholder-definitions.index")},{default:w(()=>b[16]||(b[16]=[S(" Placeholder Definitions ",-1)])),_:1,__:[16]},8,["href","active"])):h("",!0)])):h("",!0)]),t("div",sl,[t("div",al,[t("div",ol,I(n.value.name),1),t("div",ll,I(n.value.email),1),t("div",rl,I((P=n.value.role_data)==null?void 0:P.name),1)]),t("div",nl,[v(Z,{as:"button",onClick:b[0]||(b[0]=_=>i("openCreateTaskModal"))},{default:w(()=>b[18]||(b[18]=[S(" Add Task ",-1)])),_:1,__:[18]}),v(Z,{as:"button",onClick:b[1]||(b[1]=_=>i("openAddResource"))},{default:w(()=>b[19]||(b[19]=[S(" Add Resource ",-1)])),_:1,__:[19]}),v(Z,{as:"button",onClick:b[2]||(b[2]=_=>i("openNotificationsSidebar"))},{default:w(()=>[S(" Notifications ("+I(a.unreadNotificationCount)+") ",1)]),_:1}),v(Z,{href:j.route("profile.edit")},{default:w(()=>b[20]||(b[20]=[S(" Profile ",-1)])),_:1,__:[20]},8,["href"]),v(Z,{href:j.route("logout"),method:"post",as:"button",onSuccess:k,onError:T},{default:w(()=>b[21]||(b[21]=[S(" Log Out ",-1)])),_:1,__:[21]},8,["href"])])])],2)}}},dl={class:"space-y-4"},ul={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},cl={class:"text-sm font-medium text-gray-900"},ml={class:"text-xs text-gray-500 mt-1"},vl={class:"mb-4"},pl="post",gl="Add Note",fl="Note added successfully!",yl={__name:"TaskNoteModal",props:{show:Boolean,taskForNote:Object},emits:["close","note-added"],setup(a,{emit:o}){const i=a,n=o,e=be({note:""}),p=B(()=>{var l;return`Add Note to Task: "${(l=i.taskForNote)==null?void 0:l.name}"`}),c=B(()=>{var l;return`/api/tasks/${(l=i.taskForNote)==null?void 0:l.id}/notes`});G(()=>i.show,l=>{l&&Object.assign(e,{note:""})},{immediate:!0});const g=l=>{n("note-added",l),n("close")},m=()=>{n("close")};return(l,y)=>(s(),N(De,{show:a.show,title:p.value,"api-endpoint":c.value,"http-method":pl,"form-data":e,"submit-button-text":gl,"success-message":fl,onClose:m,onSubmitted:g},{default:w(({errors:d})=>[t("div",dl,[a.taskForNote?(s(),r("div",ul,[t("p",cl,I(a.taskForNote.name),1),t("p",ml,"Status: "+I(a.taskForNote.status),1)])):h("",!0),t("div",vl,[v(R,{for:"task-note-content",value:"Note Content"}),Y(t("textarea",{id:"task-note-content","onUpdate:modelValue":y[0]||(y[0]=k=>e.note=k),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your note...",required:""},null,512),[[le,e.note]]),v(H,{message:d.note?d.note[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},hl={class:"task-history-list"},kl={key:0,class:"text-center py-4"},bl={key:1,class:"text-gray-500 text-sm py-2"},xl={key:2,class:"space-y-3"},wl={class:"flex items-start"},_l={class:"text-xl mr-2"},$l={class:"text-sm text-gray-700"},Cl={class:"text-xs text-gray-500 mt-1"},Sl={__name:"TaskHistoryList",props:{activities:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(a){const o=n=>n?new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",i=n=>(console.log(n),n.includes("created")?"🆕":n.includes("started")?"🚀":n.includes("paused")?"⏸️":n.includes("resumed")?"▶️":n.includes("unblocked")?"🔓":n.includes("blocked")?"⛔":n.includes("completed")?"✅":n.includes("revised")?"🔄":n.includes("deleted")?"🗑️":n.includes("assigned")?"👤":n.includes("updated")?"📝":n.includes("added note")?"🗒️":n.includes("commented")?"💬":"📋");return(n,e)=>(s(),r("div",hl,[a.loading?(s(),r("div",kl,e[0]||(e[0]=[t("div",{class:"inline-block animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-indigo-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"Loading activity history...",-1)]))):a.activities.length===0?(s(),r("div",bl," No activity history available for this task. ")):(s(),r("div",xl,[(s(!0),r(K,null,J(a.activities,p=>{var c;return s(),r("div",{key:p.id,class:"p-3 bg-gray-50 rounded-md"},[t("div",wl,[t("span",_l,I(i(p.description)),1),t("div",null,[t("p",$l,I(p.description),1),t("p",Cl," By "+I(((c=p.causer)==null?void 0:c.name)||"System")+" on "+I(o(p.created_at)),1)])])])}),128))]))]))}},Tl=xe(Sl,[["__scopeId","data-v-423d54af"]]),Nn=async()=>{try{return(await O.get("/api/assigned-tasks")).data}catch(a){throw console.error("Error fetching assigned tasks:",a),Q("Failed to load assigned tasks"),a}},Pn=async a=>{try{return(await O.get(`/api/projects/${a}/tasks`)).data}catch(o){throw console.error("Error fetching project tasks:",o),Q("Failed to load project tasks"),o}},En=async a=>{try{return(await O.get(`/api/projects/${a}/due-and-overdue-tasks`)).data}catch(o){throw console.error("Error fetching due and overdue tasks:",o),Q("Failed to load due and overdue tasks"),o}},Al=async a=>{if(!a||a.status==="In Progress")return a;try{ve("Starting task...");const o=await O.post(`/api/tasks/${a.id}/start`);return ae("Task started successfully"),o.data}catch(o){throw console.error("Error starting task:",o),Q("Failed to start task. Please try again."),o}},jl=async a=>{if(!a||a.status!=="In Progress")return te('Task can only be paused from "In Progress" status.'),a;try{ve("Pausing task...");const o=await O.post(`/api/tasks/${a.id}/pause`);return ae("Task paused successfully"),o.data}catch(o){throw console.error("Error pausing task:",o),Q("Failed to pause task. Please try again."),o}},Il=async a=>{if(!a||a.status!=="Paused")return te('Task can only be resumed from "Paused" status.'),a;try{ve("Resuming task...");const o=await O.post(`/api/tasks/${a.id}/resume`);return ae("Task resumed successfully"),o.data}catch(o){throw console.error("Error resuming task:",o),Q("Failed to resume task. Please try again."),o}},Ml=async a=>{if(!a||a.status==="Done")return a;if(a.status!=="In Progress")throw te("Task must be started before it can be completed"),new Error("Task must be started before it can be completed");try{ve("Completing task...");const o=await O.patch(`/api/tasks/${a.id}/complete`);return ae("Task completed successfully"),o.data}catch(o){throw console.error("Error completing task:",o),o.response&&o.response.status===422?te(o.response.data.message||"Task must be started before it can be completed"):Q("Failed to complete task. Please try again."),o}},Dl=async(a,o)=>{if(!a||a.status==="Blocked")return te("Task is already blocked."),a;if(a.status==="Done")return te("Completed tasks cannot be blocked."),a;if(!o)throw te("Please provide a reason for blocking the task"),new Error("Blocking reason is required");try{ve("Blocking task...");const i=await O.post(`/api/tasks/${a.id}/block`,{reason:o});return ae("Task blocked successfully"),i.data}catch(i){throw console.error("Error blocking task:",i),Q("Failed to block task. Please try again."),i}},Nl=async a=>{if(!a||a.status!=="Blocked")return te("Task is not in a blocked state."),a;try{ve("Unblocking task...");const o=await O.post(`/api/tasks/${a.id}/unblock`);return ae("Task unblocked successfully"),o.data}catch(o){throw console.error("Error unblocking task:",o),Q("Failed to unblock task. Please try again."),o}},Pl=async a=>{if(!a||a.status!=="Done")return te("Only completed tasks can be revised."),a;try{ve("Revising task...");const o=await O.post(`/api/tasks/${a.id}/revise`);return ae("Task revised successfully"),o.data}catch(o){throw console.error("Error revising task:",o),o.response&&o.response.status===422?te(o.response.data.message||"Only completed tasks can be revised"):Q("Failed to revise task. Please try again."),o}},El=async a=>{if(!a)return!1;if(a.status!=="To Do")throw te("Only tasks in To Do status can be deleted"),new Error("Only tasks in To Do status can be deleted");if(!confirm("Are you sure you want to delete this task? This action cannot be undone."))return!1;try{return ve("Deleting task..."),await O.delete(`/api/tasks/${a.id}`),ae("Task deleted successfully"),!0}catch(o){throw console.error("Error deleting task:",o),Q("Failed to delete task. Please try again."),o}},Vl=a=>{switch(a){case"To Do":return"bg-yellow-100 text-yellow-800";case"In Progress":return"bg-blue-100 text-blue-800";case"Paused":return"bg-orange-100 text-orange-800";case"Blocked":return"bg-red-100 text-red-800";case"Done":return"bg-green-100 text-green-800";case"Archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Vn=a=>{switch(a){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Un=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"Medium",Ul=["checked","onChange"],Bl={__name:"ChecklistComponent",props:{items:{type:Array,required:!0},apiEndpoint:{type:String,required:!0},title:{type:String,default:"Checklist"},containerClass:{type:String,default:"mt-4 p-3 bg-gray-100 rounded-lg text-sm text-gray-700 border border-gray-200"},titleClass:{type:String,default:"font-semibold text-gray-900 mb-2"},itemsContainerClass:{type:String,default:"space-y-1"},itemClass:{type:String,default:"flex items-center space-x-2"},checkboxClass:{type:String,default:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},completedItemClass:{type:String,default:"line-through text-gray-500"},successMessage:{type:String,default:"Checklist item updated!"},errorMessage:{type:String,default:"Failed to update checklist item"},payloadTransformer:{type:Function,default:null},checkListStyle:{type:String,default:"checklist"}},emits:["update:items","item-toggled"],setup(a,{emit:o}){const i=a,n=o,e=A(JSON.parse(JSON.stringify(i.items)));G(()=>i.items,c=>{e.value=JSON.parse(JSON.stringify(c))},{deep:!0});async function p(c){const g=e.value[c],m=!g.completed;g.completed=m;try{let l;i.payloadTransformer?l=i.payloadTransformer(e.value,c):l={items:e.value},await O.put(i.apiEndpoint,l),n("update:items",e.value),n("item-toggled",{index:c,item:g,completed:m}),ae(i.successMessage)}catch(l){console.error("Error updating checklist item:",l),g.completed=!m,Q(i.errorMessage)}}return(c,g)=>e.value&&e.value.length>0?(s(),r("div",{key:0,class:V(a.containerClass)},[t("p",{class:V(a.titleClass)},I(a.title),3),t("ul",{class:V(a.itemsContainerClass)},[(s(!0),r(K,null,J(e.value,(m,l)=>(s(),r("li",{key:l,class:V(a.itemClass)},[a.checkListStyle==="checklist"?(s(),r("input",{key:0,type:"checkbox",checked:m.completed,onChange:y=>p(l),class:V(a.checkboxClass)},null,42,Ul)):h("",!0),t("span",{class:V({[a.completedItemClass]:m.completed})},I(m.name),3)],2))),128))],2)],2)):h("",!0)}};function Ze(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z","clip-rule":"evenodd"})])}const Ll={class:"mt-4"},Rl={__name:"ChecklistCreator",props:{modelValue:{type:Array,required:!0},placeholder:{type:String,default:"e.g., Task 1, Task 2, Task 3"},label:{type:String,default:"Checklist Items"},density:{type:String,default:"spacious",validator:a=>["spacious","tight","notes"].includes(a)}},emits:["update:modelValue"],setup(a,{emit:o}){const i=a,n=o,e=A([]),p=A([]),c=A(!1);G(()=>i.modelValue,d=>{c.value=!0,e.value=JSON.parse(JSON.stringify(d)),(e.value.length===0||e.value[e.value.length-1].name.trim()!=="")&&e.value.push({name:"",completed:!1}),ye(()=>{c.value=!1})},{immediate:!0,deep:!0}),G(()=>e.value,d=>{c.value||n("update:modelValue",d)},{deep:!0});function g(d){e.value.splice(d,1),e.value.length===0&&e.value.push({name:"",completed:!1})}function m(d){d===e.value.length-1&&e.value[d].name.trim()!==""&&e.value.push({name:"",completed:!1})}function l(d){d<e.value.length-1&&ye(()=>{var k;(k=p.value[d+1])==null||k.focus()})}const y=B(()=>i.density==="tight"?{listClass:"space-y-1",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-1 text-sm"}:i.density==="notes"?{listClass:"space-y-0.5",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-0.5 text-sm border-transparent focus:border-transparent focus:ring-0 bg-transparent"}:{listClass:"space-y-2",itemClass:"flex items-center space-x-2",inputClass:""});return(d,k)=>(s(),r("div",Ll,[a.label?(s(),N(R,{key:0,value:a.label},null,8,["value"])):h("",!0),t("ul",{class:V(y.value.listClass)},[(s(!0),r(K,null,J(e.value,(T,j)=>(s(),r("li",{key:j,class:V(y.value.itemClass)},[a.density==="notes"?(s(),N(M(Ze),{key:0,class:"h4 w-4",onClick:b=>g(j)},null,8,["onClick"])):h("",!0),v(re,{modelValue:T.name,"onUpdate:modelValue":b=>T.name=b,type:"text",class:V(["flex-1",y.value.inputClass]),placeholder:j===e.value.length-1?a.placeholder:"",onInput:b=>m(j),onKeyup:Ne(Ee(b=>l(j),["prevent"]),["enter"]),ref_for:!0,ref:b=>{b&&(p.value[j]=b)}},null,8,["modelValue","onUpdate:modelValue","class","placeholder","onInput","onKeyup"]),e.value.length>1&&a.density!=="notes"?(s(),N(We,{key:1,type:"button",onClick:b=>g(j)},{default:w(()=>[v(M(Ze),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):h("",!0)],2))),128))],2)]))}},zl={key:0,class:"text-center py-8 text-gray-500"},Fl={key:1,class:"text-center py-8 text-red-600"},Wl={key:2,class:"space-y-6"},ql={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Ol={class:"text-xl font-bold text-gray-900 mb-2"},Hl={class:"flex items-center space-x-2 text-sm text-gray-600 mb-4"},Kl={key:0,class:"text-indigo-600 font-medium"},Jl={key:1,class:"text-purple-600 font-medium"},Yl={class:"text-gray-700 leading-relaxed"},Zl={class:"mt-4 flex flex-wrap gap-2"},Gl={key:0,class:"text-xs text-gray-500 mt-1"},Ql={key:0,class:"bg-yellow-50 border-l-4 border-red-400 p-4 rounded-lg shadow-sm"},Xl={class:"flex items-center"},er={class:"ml-3"},tr={class:"mt-2 text-sm text-yellow-700"},sr={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm mb-4"},ar={class:"flex justify-between items-center border-b pb-2 mb-4"},or={key:0},lr={key:1},rr={key:0,class:"mb-4"},nr={class:"flex justify-end mt-4"},ir={key:2,class:"text-gray-500 text-sm py-2"},dr={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm"},ur={class:"flex items-center justify-between py-2 border-b border-gray-100"},cr={class:"flex-1 text-right"},mr={key:0,class:"text-xs text-gray-400 ml-1"},vr={key:1,class:"flex items-center space-x-2"},pr={class:"flex items-center justify-between py-2 border-b border-gray-100"},gr={class:"flex-1 text-right"},fr={key:1,class:"flex items-center space-x-2"},yr={class:"flex items-center justify-between py-2 border-b border-gray-100"},hr={class:"flex-1 text-right"},kr={key:0,class:"text-xs text-gray-400 ml-1"},br={key:1,class:"flex items-center space-x-2"},xr={class:"flex items-center justify-between py-2 border-b border-gray-100"},wr={class:"text-gray-700"},_r={class:"flex items-start py-2 border-b border-gray-100"},$r={class:"flex-1 flex flex-wrap gap-2"},Cr={key:0,class:"text-gray-500 text-sm"},Sr={class:"bg-white p-4 rounded-lg shadow-sm"},Tr={class:"flex justify-between items-center mb-4 border-b pb-2"},Ar={key:0,class:"space-y-3"},jr={class:"text-sm text-gray-700"},Ir={class:"text-xs text-gray-500 mt-1"},Mr={key:1,class:"text-gray-500 text-sm py-2"},Dr={class:"bg-white p-4 rounded-lg shadow-sm"},Nr={key:3,class:"text-center py-8 text-gray-500"},Pr={key:4,class:"mt-4 flex flex-col items-center"},Er={key:0,class:"text-xs text-red-500 mt-1"},Vr={class:"p-6"},Ur={class:"mb-4"},Br={class:"flex justify-end space-x-3"},Lr={__name:"TaskDetailSidebar",props:{taskId:{type:Number,required:!0},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]}},emits:["close","task-updated","task-deleted"],setup(a,{emit:o}){const i=a,n=o,e=A(null),p=A(!0),c=A(""),g=A(!1),m=A(!1),l=A(!1),y=A(null),d=A(null),k=A(null),T=A([]),j=A(!1),b=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],P=A(!1),_=A(!1),u=A([{name:"",completed:!1}]),f=A(!1),x=async()=>{p.value=!0,c.value="";try{const E=await window.axios.get(`/api/tasks/${i.taskId}`);e.value=E.data,y.value=e.value.assigned_to_id||null,d.value=e.value.due_date||null,k.value=e.value.priority||"medium",$()}catch(E){c.value="Failed to load task details.",console.error("Error fetching task details:",E)}finally{p.value=!1}},$=async()=>{j.value=!0;try{const E=await window.axios.get("/api/activities",{params:{subject_type:"App\\Models\\Task",subject_id:i.taskId}});T.value=E.data}catch(E){console.error("Error fetching task activities:",E)}finally{j.value=!1}};G(()=>i.taskId,E=>{E?x():e.value=null},{immediate:!0});const D=B(()=>i.projectUsers.map(E=>({value:E.id,label:E.name}))),L=async()=>{if(!e.value||y.value===e.value.assigned_to_id){g.value=!1;return}try{const E=await window.axios.patch(`/api/tasks/${e.value.id}`,{assigned_to_user_id:y.value});e.value=E.data,n("task-updated",e.value)}catch(E){console.error("Error updating assigned user:",E),y.value=e.value.assigned_to_id,Q("Failed to update assigned user. Please try again.")}finally{g.value=!1}},ie=async()=>{if(!e.value||d.value===e.value.due_date){m.value=!1;return}try{const E=await window.axios.patch(`/api/tasks/${e.value.id}`,{due_date:d.value});e.value=E.data,n("task-updated",e.value)}catch(E){console.error("Error updating due date:",E),d.value=e.value.due_date,Q("Failed to update due date. Please try again.")}finally{m.value=!1}},q=async()=>{if(!e.value||k.value===e.value.priority){l.value=!1;return}try{const E=await window.axios.patch(`/api/tasks/${e.value.id}`,{priority:k.value});e.value=E.data,n("task-updated",e.value)}catch(E){console.error("Error updating priority:",E),k.value=e.value.priority,Q("Failed to update priority. Please try again.")}finally{l.value=!1}},U=()=>{P.value=!0},F=()=>{x(),P.value=!1},W=async()=>{try{await El(e.value),n("task-deleted",e.value.id),n("close")}catch(E){console.error("Error deleting task:",E)}},oe=async()=>{try{e.value=await Al(e.value),n("task-updated",e.value),$()}catch(E){console.error("Error starting task:",E)}},dt=async()=>{try{e.value=await jl(e.value),n("task-updated",e.value),$()}catch(E){console.error("Error pausing task:",E)}},ut=async()=>{try{e.value=await Il(e.value),n("task-updated",e.value),$()}catch(E){console.error("Error resuming task:",E)}},ct=async()=>{try{e.value=await Ml(e.value),n("task-updated",e.value),$()}catch(E){console.error("Error completing task:",E)}},mt=async()=>{try{e.value=await Pl(e.value),n("task-updated",e.value),$()}catch(E){console.error("Error revising task:",E)}},vt=()=>{var E;_.value=!_.value,_.value&&((E=e.value.details)!=null&&E.checklist&&e.value.details.checklist.length>0?(u.value=JSON.parse(JSON.stringify(e.value.details.checklist)),u.value[u.value.length-1].name!==""&&u.value.push({name:"",completed:!1})):u.value=[{name:"",completed:!1}])},pt=async()=>{if(!f.value){f.value=!0;try{const E=u.value.filter(ge=>ge.name.trim()!==""),C={details:{...e.value.details,checklist:E}},pe=await window.axios.patch(`/api/tasks/${e.value.id}`,C);e.value=pe.data,_.value=!1,ae("Checklist saved successfully"),n("task-updated",e.value)}catch(E){console.error("Error saving checklist:",E),Q("Failed to save checklist")}finally{f.value=!1}}},we=A(!1),he=A(""),gt=()=>{he.value="",we.value=!0},ft=async()=>{if(!he.value.trim()){te("Please provide a reason for blocking the task");return}try{e.value=await Dl(e.value,he.value),ae("Task blocked successfully"),n("task-updated",e.value),$(),we.value=!1}catch(E){console.error("Error blocking task:",E)}},yt=async()=>{try{e.value=await Nl(e.value),n("task-updated",e.value),$()}catch(E){console.error("Error unblocking task:",E)}},ht=B(()=>e.value?Vl(e.value.status):""),Ve=B(()=>{var C,pe,ge,_e;if(!T.value||((C=e.value)==null?void 0:C.status)!=="Blocked")return null;const E=T.value.find($e=>{var Ce,Se;return $e.event==="updated"&&((Se=(Ce=$e.properties)==null?void 0:Ce.attributes)==null?void 0:Se.status)==="Blocked"});return E?(console.log(E.properties),{causer:((pe=E.causer)==null?void 0:pe.name)||"Unknown",reason:((_e=(ge=E.properties)==null?void 0:ge.attributes)==null?void 0:_e.block_reason)||"No reason provided."}):null});return(E,C)=>{var pe,ge,_e,$e,Ce,Se,qe;return s(),r("div",null,[p.value?(s(),r("div",zl," Loading task details... ")):c.value?(s(),r("div",Fl,I(c.value),1)):e.value?(s(),r("div",Wl,[t("div",ql,[t("h4",Ol,I(e.value.name),1),t("div",Hl,[t("span",{class:V(["px-2 py-1 rounded-full text-xs font-medium",ht.value])},I(e.value.status),3),e.value.task_type?(s(),r("span",Kl," | "+I((pe=e.value.task_type)==null?void 0:pe.name)+" | ",1)):h("",!0),C[14]||(C[14]=t("br",null,null,-1)),(ge=e.value.milestone)!=null&&ge.name?(s(),r("span",Jl,I((_e=e.value.milestone)==null?void 0:_e.name),1)):h("",!0)]),t("p",Yl,I(e.value.description||"No description provided."),1),t("div",Zl,[e.value.status==="To Do"?(s(),N(ee,{key:0,onClick:oe,class:"bg-blue-600 hover:bg-blue-700"},{default:w(()=>C[15]||(C[15]=[S(" Start Task ",-1)])),_:1,__:[15]})):e.value.status==="In Progress"?(s(),N(ee,{key:1,onClick:dt,class:"bg-orange-600 hover:bg-orange-700"},{default:w(()=>C[16]||(C[16]=[S(" Pause Task ",-1)])),_:1,__:[16]})):e.value.status==="Paused"?(s(),N(ee,{key:2,onClick:ut,class:"bg-blue-600 hover:bg-blue-700"},{default:w(()=>C[17]||(C[17]=[S(" Resume Task ",-1)])),_:1,__:[17]})):e.value.status==="Blocked"?(s(),N(ee,{key:3,onClick:yt,class:"bg-green-600 hover:bg-green-700"},{default:w(()=>C[18]||(C[18]=[S(" Unblock Task ",-1)])),_:1,__:[18]})):h("",!0),e.value.status==="To Do"||e.value.status==="In Progress"||e.value.status==="Paused"?(s(),N(ee,{key:4,onClick:gt,class:"bg-red-600 hover:bg-red-700"},{default:w(()=>C[19]||(C[19]=[S(" Block Task ",-1)])),_:1,__:[19]})):h("",!0),e.value.status==="In Progress"?(s(),N(ee,{key:5,onClick:ct,class:"bg-green-600 hover:bg-green-700"},{default:w(()=>C[20]||(C[20]=[S(" Complete Task ",-1)])),_:1,__:[20]})):h("",!0),e.value.status==="Done"?(s(),N(ee,{key:6,onClick:mt,class:"bg-yellow-600 hover:bg-yellow-700"},{default:w(()=>C[21]||(C[21]=[S(" Revise Task ",-1)])),_:1,__:[21]})):h("",!0)]),e.value.status==="Done"?(s(),r("div",Gl,' Revising will change the task status back to "To Do" ')):h("",!0)]),e.value.status==="Blocked"&&Ve.value?(s(),r("div",Ql,[t("div",Xl,[C[23]||(C[23]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.487 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11.75 13a.75.75 0 01-1.5 0v-2.25a.75.75 0 011.5 0V13zm-1.5-7.5a.75.75 0 011.5 0v1.5a.75.75 0 01-1.5 0V5.5z","clip-rule":"evenodd"})])],-1)),t("div",er,[C[22]||(C[22]=t("h3",{class:"text-sm font-medium text-yellow-800"},"Task Blocked",-1)),t("div",tr,[t("p",null,"This task was blocked by **"+I(Ve.value.causer)+"** with the following reason:",1),t("p",null,I(Ve.value.reason),1)])])])])):h("",!0),t("div",sr,[t("div",ar,[C[24]||(C[24]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Task Checklist",-1)),t("button",{onClick:vt,class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center"},[_.value?(s(),r("span",lr,"Cancel")):(s(),r("span",or,I(($e=e.value.details)!=null&&$e.checklist&&e.value.details.checklist.length>0?"Edit Checklist":"Add Checklist"),1))])]),_.value?(s(),r("div",rr,[v(Rl,{modelValue:u.value,"onUpdate:modelValue":C[0]||(C[0]=z=>u.value=z),placeholder:"e.g., Review design, Update documentation",label:"Checklist Items",density:"notes"},null,8,["modelValue"]),t("div",nr,[v(ee,{onClick:pt,disabled:f.value,class:"flex items-center space-x-1"},{default:w(()=>[v(M(Io),{class:"h-4 w-4"}),C[25]||(C[25]=t("span",null,"Save Checklist",-1))]),_:1,__:[25]},8,["disabled"])])])):h("",!0),(Ce=e.value.details)!=null&&Ce.checklist&&e.value.details.checklist.length>0&&!_.value?(s(),N(Bl,{key:1,items:e.value.details.checklist,"api-endpoint":`/api/tasks/${e.value.id}`,title:"Items to complete:","payload-transformer":z=>({details:{...e.value.details,checklist:z}})},null,8,["items","api-endpoint","payload-transformer"])):h("",!0),(!((Se=e.value.details)!=null&&Se.checklist)||e.value.details.checklist.length===0)&&!_.value?(s(),r("div",ir,' No checklist items for this task yet. Click "Add Checklist" to create one. ')):h("",!0)]),t("div",dr,[C[32]||(C[32]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Task Attributes",-1)),t("div",ur,[v(R,{class:"min-w-[100px] text-gray-600"},{default:w(()=>C[26]||(C[26]=[S("Assigned To:",-1)])),_:1,__:[26]}),t("div",cr,[g.value?(s(),r("div",vr,[v(se,{id:"edit-assigned-to",modelValue:y.value,"onUpdate:modelValue":C[2]||(C[2]=z=>y.value=z),options:D.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1 flex-1","allow-empty":!0},null,8,["modelValue","options"]),t("button",{onClick:L,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:C[3]||(C[3]=z=>g.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:C[1]||(C[1]=z=>e.value.status!=="Done"?g.value=!0:te("Cannot change assignment for a completed task. Use the Revise button to change the task status first.")),class:V(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[S(I(((qe=e.value.assigned_to)==null?void 0:qe.name)||"Unassigned")+" ",1),e.value.status!=="Done"?(s(),r("span",mr,"(Click to edit)")):h("",!0)],2))])]),t("div",pr,[v(R,{class:"min-w-[100px] text-gray-600"},{default:w(()=>C[27]||(C[27]=[S("Due Date:",-1)])),_:1,__:[27]}),t("div",gr,[m.value?(s(),r("div",fr,[v(re,{id:"edit-due-date",modelValue:d.value,"onUpdate:modelValue":C[5]||(C[5]=z=>d.value=z),type:"date",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:ie,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:C[6]||(C[6]=z=>m.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:C[4]||(C[4]=z=>m.value=!0),class:"cursor-pointer text-indigo-600 hover:text-indigo-800"},[S(I(e.value.due_date?M(jt)(e.value.due_date).format("MMM D, YYYY"):"No Due Date")+" ",1),C[28]||(C[28]=t("span",{class:"text-xs text-gray-400 ml-1"},"(Click to edit)",-1))]))])]),t("div",yr,[v(R,{class:"min-w-[100px] text-gray-600"},{default:w(()=>C[29]||(C[29]=[S("Priority:",-1)])),_:1,__:[29]}),t("div",hr,[l.value?(s(),r("div",br,[v(se,{id:"edit-priority",modelValue:k.value,"onUpdate:modelValue":C[8]||(C[8]=z=>k.value=z),options:b,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:q,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:C[9]||(C[9]=z=>l.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:C[7]||(C[7]=z=>e.value.status!=="Done"?l.value=!0:te("Cannot change priority for a completed task. Use the Revise button to change the task status first.")),class:V(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[t("span",{class:V({"text-red-600 font-medium":e.value.priority==="high","text-yellow-600 font-medium":e.value.priority==="medium","text-green-600 font-medium":e.value.priority==="low"})},I(e.value.priority?e.value.priority.charAt(0).toUpperCase()+e.value.priority.slice(1):"Medium"),3),e.value.status!=="Done"?(s(),r("span",kr,"(Click to edit)")):h("",!0)],2))])]),t("div",xr,[v(R,{class:"min-w-[100px] text-gray-600"},{default:w(()=>C[30]||(C[30]=[S("Created:",-1)])),_:1,__:[30]}),t("span",wr,I(e.value.created_at?new Date(e.value.created_at).toLocaleDateString():"N/A"),1)]),t("div",_r,[v(R,{class:"min-w-[100px] text-gray-600 mt-1"},{default:w(()=>C[31]||(C[31]=[S("Tags:",-1)])),_:1,__:[31]}),t("div",$r,[(s(!0),r(K,null,J(e.value.tags,z=>(s(),r("span",{key:z.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},I(z.name),1))),128)),!e.value.tags||e.value.tags.length===0?(s(),r("span",Cr,"No tags")):h("",!0)])])]),t("div",Sr,[t("div",Tr,[C[34]||(C[34]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Notes",-1)),v(ee,{onClick:U,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:w(()=>C[33]||(C[33]=[S(" Add Note ",-1)])),_:1,__:[33]})]),e.value.notes&&e.value.notes.length>0?(s(),r("div",Ar,[(s(!0),r(K,null,J(e.value.notes,z=>(s(),r("div",{key:z.id,class:"p-3 bg-gray-50 rounded-md"},[t("p",jr,I(z.content),1),t("p",Ir," By "+I(z.creator_name||"Unknown")+" on "+I(new Date(z.created_at).toLocaleDateString()),1)]))),128))])):(s(),r("div",Mr,"No notes for this task yet."))]),t("div",Dr,[C[35]||(C[35]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"History",-1)),v(Tl,{activities:T.value,loading:j.value},null,8,["activities","loading"])])])):(s(),r("div",Nr," Select a task to view details. ")),e.value&&e.value.status!=="Done"?(s(),r("div",Pr,[v(We,{onClick:W,disabled:e.value.status!=="To Do"},{default:w(()=>C[36]||(C[36]=[S(" Delete Task ",-1)])),_:1,__:[36]},8,["disabled"]),e.value.status!=="To Do"?(s(),r("p",Er,"Task can only be deleted in 'To Do' status.")):h("",!0)])):h("",!0),v(yl,{show:P.value,"task-for-note":e.value,onClose:C[10]||(C[10]=z=>P.value=!1),onNoteAdded:F},null,8,["show","task-for-note"]),v(Fe,{show:we.value,onClose:C[13]||(C[13]=z=>we.value=!1)},{default:w(()=>[t("div",Vr,[C[40]||(C[40]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),t("div",Ur,[C[37]||(C[37]=t("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),Y(t("textarea",{"onUpdate:modelValue":C[11]||(C[11]=z=>he.value=z),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[le,he.value]])]),t("div",Br,[v(Ie,{onClick:C[12]||(C[12]=z=>we.value=!1)},{default:w(()=>C[38]||(C[38]=[S(" Cancel ",-1)])),_:1,__:[38]}),v(ee,{onClick:ft,disabled:!he.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:w(()=>C[39]||(C[39]=[S(" Block Task ",-1)])),_:1,__:[39]},8,["disabled"])])])]),_:1},8,["show"])])}}},Rr={key:1,class:"p-4 text-gray-500"},zr={key:0,class:"flex justify-end space-x-3"},Fr={__name:"TaskSidebar",emits:["taskUpdated","taskDeleted"],setup(a){const o=A(null);return(i,n)=>(s(),N(rt,{show:M(ue).show,"onUpdate:show":M(Ue),title:M(ue).taskId?"Task Details":"Details",initialWidth:50},{content:w(()=>[M(ue).taskId?(s(),N(Lr,{key:0,"task-id":M(ue).taskId,"project-id":M(ue).projectId,"project-users":M(ue).projectUsers,ref_key:"taskDetailSidebarRef",ref:o,onClose:M(Ue),onTaskUpdated:n[0]||(n[0]=e=>{i.$emit("taskUpdated",e)}),onTaskDeleted:n[1]||(n[1]=e=>{i.$emit("taskDeleted",e),M(Ue)()})},null,8,["task-id","project-id","project-users","onClose"])):M(ue).show?(s(),r("div",Rr," No task selected or task ID is missing. ")):h("",!0)]),footer:w(()=>[M(ue).taskId?(s(),r("div",zr,[o.value&&o.value.task&&o.value.task.status!=="In Progress"&&o.value.task.status!=="Done"?(s(),N(Ie,{key:0,onClick:o.value.startTask,class:"bg-blue-50 text-blue-700 hover:bg-blue-100"},{default:w(()=>n[2]||(n[2]=[S(" Start Task ",-1)])),_:1,__:[2]},8,["onClick"])):h("",!0),o.value&&o.value.task&&o.value.task.status==="In Progress"?(s(),N(Ie,{key:1,onClick:o.value.completeTask,class:"bg-green-50 text-green-700 hover:bg-green-100"},{default:w(()=>n[3]||(n[3]=[S(" Complete Task ",-1)])),_:1,__:[3]},8,["onClick"])):h("",!0),o.value&&o.value.task?(s(),N(We,{key:2,onClick:o.value.deleteTask,class:"bg-red-50 text-red-700 hover:bg-red-100"},{default:w(()=>n[4]||(n[4]=[S(" Delete Task ",-1)])),_:1,__:[4]},8,["onClick"])):h("",!0)])):h("",!0)]),_:1},8,["show","onUpdate:show","title"]))}};function Wr(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"})])}function Ge(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5"})])}function qr(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})])}function Or(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function Hr(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.34 15.84c-.688-.06-1.386-.09-2.09-.09H7.5a4.5 4.5 0 1 1 0-9h.75c.704 0 1.402-.03 2.09-.09m0 9.18c.253.962.584 1.892.985 2.783.247.55.06 1.21-.463 1.511l-.657.38c-.551.318-1.26.117-1.527-.461a20.845 20.845 0 0 1-1.44-4.282m3.102.069a18.03 18.03 0 0 1-.59-4.59c0-1.586.205-3.124.59-4.59m0 9.18a23.848 23.848 0 0 1 8.835 2.535M10.34 6.66a23.847 23.847 0 0 0 8.835-2.535m0 0A23.74 23.74 0 0 0 18.795 3m.38 1.125a23.91 23.91 0 0 1 1.014 5.395m-1.014 8.855c-.118.38-.245.754-.38 1.125m.38-1.125a23.91 23.91 0 0 0 1.014-5.395m0-3.46c.495.413.811 1.035.811 1.73 0 .695-.316 1.317-.811 1.73m0-3.46a24.347 24.347 0 0 1 0 3.46"})])}function Kr(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const Jr={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4"},Yr={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Zr={class:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2"},Gr={class:"max-h-[70vh] overflow-y-auto p-6 space-y-4"},Qr={key:0,class:"text-center text-gray-500 py-8"},Xr={class:"flex items-start justify-between gap-4"},en={class:"flex-1 min-w-0"},tn={class:"flex items-center gap-2 mb-2"},sn={class:"font-bold text-lg text-gray-900 dark:text-white truncate"},an={class:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-line leading-relaxed"},on={key:0,class:"flex-shrink-0"},ln=["href"],rn={class:"p-6 border-t border-gray-200 dark:border-gray-700 flex flex-col md:flex-row items-center justify-between gap-4"},nn={class:"flex items-center w-full md:w-auto"},dn={class:"flex justify-end gap-3 w-full md:w-auto"},un=["disabled"],cn={key:0},mn={key:1},vn={__name:"NoticeboardModal",props:{show:{type:Boolean,default:!1},unreadNotices:{type:Array,default:()=>[]}},emits:["close"],setup(a,{emit:o}){const i=a,n=o,e=A(!1),p=A(!1),c=async()=>{if(!(!e.value||p.value)){p.value=!0;try{const l=i.unreadNotices.map(y=>y.id);if(l.length===0){n("close");return}await O.post("/api/notices/acknowledge",{notice_ids:l}),e.value=!1,n("close")}catch(l){console.error("Failed to acknowledge notices",l)}finally{p.value=!1}}},g=l=>{switch(l){case"Warning":return Or;case"Updates":return Hr;case"Final Notice":return qr;default:return Ge}},m=l=>{switch(l){case"Warning":return"text-red-500 bg-red-100";case"Updates":return"text-blue-500 bg-blue-100";case"Final Notice":return"text-yellow-500 bg-yellow-100";default:return"text-indigo-500 bg-indigo-100"}};return(l,y)=>a.show?(s(),r("div",Jr,[t("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:y[0]||(y[0]=d=>n("close"))}),t("div",{class:V(["relative bg-white dark:bg-gray-800 rounded-3xl shadow-2xl max-w-2xl w-full mx-auto transform transition-all duration-300 scale-100",{"scale-95 opacity-0":!a.show}])},[t("div",Yr,[t("h3",Zr,[v(M(Ge),{class:"h-7 w-7 text-indigo-500"}),y[4]||(y[4]=S(" Important Notices ",-1))]),t("button",{onClick:y[1]||(y[1]=d=>n("close")),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors rounded-full hover:bg-gray-100 dark:hover:bg-gray-700"},[v(M(Kr),{class:"h-6 w-6"})])]),t("div",Gr,[a.unreadNotices.length===0?(s(),r("div",Qr," All notices have been read. ")):h("",!0),(s(!0),r(K,null,J(a.unreadNotices,d=>(s(),r("div",{key:d.id,class:"bg-gray-50 dark:bg-gray-700 rounded-2xl p-5 shadow-sm border border-gray-200 dark:border-gray-600"},[t("div",Xr,[t("div",en,[t("div",tn,[(s(),N(_t(g(d.type)),{class:V(["h-5 w-5",m(d.type)])},null,8,["class"])),t("div",sn,I(d.title),1)]),t("div",an,I(d.description),1)]),d.url?(s(),r("div",on,[t("a",{href:`/notices/${d.id}/redirect`,target:"_blank",class:"flex items-center text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 transition-colors font-medium text-sm"},[y[5]||(y[5]=S(" Open Link ",-1)),v(M(Wr),{class:"h-4 w-4 ml-1"})],8,ln)])):h("",!0)])]))),128))]),t("div",rn,[t("div",nn,[Y(t("input",{id:"acknowledge",type:"checkbox","onUpdate:modelValue":y[2]||(y[2]=d=>e.value=d),class:"h-5 w-5 text-indigo-600 rounded-lg border-gray-300 dark:border-gray-500 dark:bg-gray-600 focus:ring-indigo-500 focus:ring-offset-0 transition-colors"},null,512),[[tt,e.value]]),y[6]||(y[6]=t("label",{for:"acknowledge",class:"ml-3 text-sm text-gray-700 dark:text-gray-300 select-none"}," I have read and understood this notice. ",-1))]),t("div",dn,[t("button",{onClick:y[3]||(y[3]=d=>n("close")),class:"px-5 py-2.5 rounded-xl border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-sm font-medium"}," Close "),t("button",{onClick:c,disabled:!e.value||p.value,class:"px-5 py-2.5 bg-indigo-600 text-white rounded-xl shadow-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-indigo-700 transition-colors text-sm font-medium"},[p.value?(s(),r("span",cn,"Acknowledging...")):(s(),r("span",mn,"Acknowledge"))],8,un)])])],2)])):h("",!0)}},Be=A(!1),Ae=A([]),Le=A(!1);function pn(){const a=async()=>{var n;try{const e=await O.get("/api/notices/unread");Ae.value=((n=e.data)==null?void 0:n.data)||[],Be.value=Ae.value.length>0}catch(e){console.error("Failed to fetch unread notices",e)}},o=async()=>{if(Le.value)try{const n=Ae.value.map(e=>e.id);if(n.length===0)return;await O.post("/api/notices/acknowledge",{notice_ids:n}),i()}catch(n){console.error("Failed to acknowledge notices",n)}},i=()=>{Be.value=!1,Ae.value=[],Le.value=!1};return me(()=>{a()}),ot(()=>{}),{showNoticeModal:Be,unreadNotices:Ae,acknowledgeChecked:Le,fetchUnreadNotices:a,acknowledgeNotices:o,closeModal:i}}const gn={class:"flex h-screen overflow-hidden"},fn={class:"flex-1 flex flex-col overflow-hidden"},yn={key:0,class:"bg-white shadow"},hn={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},kn={class:"flex-1 overflow-y-auto"},Bn={__name:"AuthenticatedLayout",setup(a){const o=A(!1),i=A(!1),n=A(!1),e=A(!1),p=A([]),c=A(!0),g=B(()=>Me().props.id||null),{showNoticeModal:m,unreadNotices:l,fetchUnreadNotices:y,closeModal:d}=pn(),k=A(null),T=async()=>{const $=localStorage.getItem("authToken");if($){window.axios.defaults.headers.common.Authorization=`Bearer ${$}`;try{await window.axios.get("/api/user")}catch(D){D.response&&D.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},j=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization},b=$=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},P=async()=>{c.value=!0;try{const $=await window.axios.get("/api/projects-simplified");p.value=$.data}catch($){console.error("Error fetching all projects for sidebar:",$),p.value=[]}finally{c.value=!1}},_=$=>{St.visit(route("projects.show",$))},u=B(()=>je.value.notifications.filter($=>!$.isRead).length),f=$=>{console.log("Task updated globally.",$)},x=$=>{console.log("Task deleted globally.",$)};return me(()=>{T(),k.value&&$t(k.value),P(),Ct(),He(y),y()}),ot(()=>{He(null)}),($,D)=>(s(),r("div",gn,[v(Qt,{ref_key:"standardNotificationContainerRef",ref:k},null,512),v(Ot,{"sidebar-is-open":M(je).show},null,8,["sidebar-is-open"]),v(js),v(_o,{"all-projects":p.value,"active-project-id":g.value,onProjectSelected:_},null,8,["all-projects","active-project-id"]),t("div",fn,[v(Xo,{"unread-notification-count":u.value,onOpenCreateTaskModal:D[0]||(D[0]=L=>i.value=!0),onOpenAddResource:D[1]||(D[1]=L=>n.value=!0),onOpenNotificationsSidebar:M(Ke),onOpenKudoModal:D[2]||(D[2]=L=>e.value=!0)},null,8,["unread-notification-count","onOpenNotificationsSidebar"]),v(il,{"showing-navigation-dropdown":o.value,"unread-notification-count":u.value,onOpenCreateTaskModal:D[3]||(D[3]=L=>i.value=!0),onOpenAddResource:D[4]||(D[4]=L=>n.value=!0),onOpenNotificationsSidebar:M(Ke),onLogoutSuccess:j,onLogoutError:b},null,8,["showing-navigation-dropdown","unread-notification-count","onOpenNotificationsSidebar"]),$.$slots.header?(s(),r("header",yn,[t("div",hn,[ne($.$slots,"header")])])):h("",!0),t("main",kn,[ne($.$slots,"default")]),v(ma,{show:i.value,onClose:D[5]||(D[5]=L=>i.value=!1),onSaved:D[6]||(D[6]=L=>i.value=!1)},null,8,["show"]),v(fa,{"api-endpoint":"/api/shareable-resources",show:n.value,onClose:D[7]||(D[7]=L=>n.value=!1)},null,8,["show"]),v(Ha,{show:e.value,onClose:D[8]||(D[8]=L=>e.value=!1),onSubmitted:D[9]||(D[9]=L=>e.value=!1)},null,8,["show"])]),v(Fr,{onTaskUpdated:f,onTaskDeleted:x}),v(za),v(vn,{show:M(m),unreadNotices:M(l),onClose:M(d)},null,8,["show","unreadNotices","onClose"])]))}};export{De as B,fa as C,lt as T,Bn as _,Qs as a,Cs as b,Un as c,Vn as d,Ml as e,Nn as f,Vl as g,El as h,Pl as i,Dl as j,Bl as k,Rl as l,Us as m,Ze as n,yl as o,jl as p,Pn as q,Il as r,Al as s,ma as t,Nl as u,En as v};
