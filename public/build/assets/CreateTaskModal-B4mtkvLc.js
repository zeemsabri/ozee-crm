import{_ as w,r as p,E as C,i as l,g as d,o as i,b as t,d as T,f as b,k as f,n as g,t as m}from"./app-TPbKwKr-.js";const S={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[100] p-4"},j={class:"bg-white rounded-lg shadow-xl w-full max-w-md p-6 relative"},O={class:"mb-4"},E={key:0,class:"text-red-500 text-xs italic mt-1"},M={class:"mb-4"},N={key:0,class:"text-red-500 text-xs italic mt-1"},V={class:"mb-6"},q={key:0,class:"text-red-500 text-xs italic mt-1"},A={class:"flex items-center justify-between"},B=["disabled"],D={key:0},z={key:1},I=["disabled"],F={__name:"CreateTaskModal",props:{isOpen:{type:Boolean,required:!0},initialAuthToken:{type:String,required:!0},projectId:{type:[String,Number],required:!0}},emits:["update:isOpen","task-created-success"],setup(x,{emit:h}){const y=x,v=h,o=p({title:"",description:"",due_date:""}),r=p(!1),s=p({}),{showModal:u}=C("modalService"),c=()=>{v("update:isOpen",!1),_(),s.value={}},_=()=>{o.value={title:"",description:"",due_date:""},s.value={}},k=async()=>{if(s.value={},!o.value.title.trim()){s.value.title="Title is required.";return}r.value=!0;try{const a=await fetch("/api/client-api/tasks",{method:"POST",headers:{Authorization:`Bearer ${y.initialAuthToken}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({...o.value,project_id:y.projectId})}),e=await a.json();if(!a.ok)throw a.status===422&&e.errors?(s.value=e.errors,u("Validation Error","Please correct the highlighted fields.","alert")):u("Error",e.message||"Failed to create task.","alert"),new Error(e.message||"API request failed.");u("Success","New task created successfully!","alert"),v("task-created-success",e.task),c()}catch(a){console.error("Error creating task:",a)}finally{r.value=!1}};return(a,e)=>x.isOpen?(i(),l("div",S,[t("div",j,[t("button",{onClick:c,class:"absolute top-3 right-4 text-gray-500 hover:text-gray-800 text-3xl transition-colors leading-none","aria-label":"Close"},"Ã—"),e[6]||(e[6]=t("h3",{class:"text-2xl font-semibold text-gray-800 mb-6 text-center"},"Create New Task",-1)),t("form",{onSubmit:T(k,["prevent"])},[t("div",O,[e[3]||(e[3]=t("label",{for:"title",class:"block text-gray-700 text-sm font-bold mb-2"},"Title:",-1)),b(t("input",{type:"text",id:"title","onUpdate:modelValue":e[0]||(e[0]=n=>o.value.title=n),class:g(["shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",{"border-red-500":s.value.title}])},null,2),[[f,o.value.title]]),s.value.title?(i(),l("p",E,m(s.value.title[0]),1)):d("",!0)]),t("div",M,[e[4]||(e[4]=t("label",{for:"description",class:"block text-gray-700 text-sm font-bold mb-2"},"Description (Optional):",-1)),b(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=n=>o.value.description=n),rows:"4",class:g(["shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline resize-y",{"border-red-500":s.value.description}])},null,2),[[f,o.value.description]]),s.value.description?(i(),l("p",N,m(s.value.description[0]),1)):d("",!0)]),t("div",V,[e[5]||(e[5]=t("label",{for:"due_date",class:"block text-gray-700 text-sm font-bold mb-2"},"Due Date (Optional):",-1)),b(t("input",{type:"date",id:"due_date","onUpdate:modelValue":e[2]||(e[2]=n=>o.value.due_date=n),class:g(["shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",{"border-red-500":s.value.due_date}])},null,2),[[f,o.value.due_date]]),s.value.due_date?(i(),l("p",q,m(s.value.due_date[0]),1)):d("",!0)]),t("div",A,[t("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:r.value},[r.value?(i(),l("span",D,"Creating...")):(i(),l("span",z,"Create Task"))],8,B),t("button",{type:"button",onClick:c,class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors",disabled:r.value}," Cancel ",8,I)])],32)])])):d("",!0)}},U=w(F,[["__scopeId","data-v-0dcba4f2"]]);export{U as default};
