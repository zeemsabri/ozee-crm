import{j as oe,B as Ve,T as Rt,k as Ft,l as Ht,m as Bt,n as Wt,_ as Yt,o as zt}from"./AuthenticatedLayout-n0IvGKBU.js";import{r as _,B as fe,i as r,o,b as e,F as J,j as Q,g as D,t as g,m as z,ao as Me,e as v,ap as Xe,a as H,A as ie,c as le,aq as rt,X as dt,p as se,D as we,T as Ye,ar as Z,H as qt,S as ze,as as Gt,d as xe,z as Ce,w as ce,s as U,f as ge,k as ke,v as qe,h as G,G as Kt,l as Qe,at as ut,Z as ht,ae as Jt,$ as Zt,_ as Xt,Q as Qt,R as es,a8 as Ie,P as ts,an as ss,a0 as ls,al as as,y as is,ak as ns,O as os,a1 as rs}from"./app-CCIvBE0H.js";import{c as ve,a as Oe,d as Fe,f as je,b as ds,_ as us}from"./ProjectForm-EwHX69fd.js";import{_ as $e}from"./Modal-N--bAL5c.js";import{P as pe}from"./PrimaryButton-CKeyix5K.js";import{b as gt,_ as yt,a as ft}from"./TaskList-BDVmOdI8.js";import{_ as q}from"./InputLabel-D4oa12P3.js";import{_ as me}from"./TextInput-DQOEgA7h.js";import{_ as ae}from"./InputError-B_Om2v21.js";import{O as et,b as cs,u as ms,_ as vs,E as ps,a as hs}from"./ComposeEmailModal-D_JpUY53.js";import{S as he}from"./SelectDropdown-C0DfOAIs.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as _e}from"./SecondaryButton-C9FY9eVA.js";import{_ as gs}from"./EmailEditor-MfaPRWBv.js";import{_ as ys}from"./EmailList-Bert7gDR.js";import"./Checkbox-BWcUN7oK.js";import"./ApplicationLogo-BfKXbvyl.js";import"./DangerButton-BBu2jm3k.js";import"./ProjectTypeInput-Co3uIr1y.js";const fs={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},bs={key:0,class:"text-sm text-gray-500"},ws={key:1,class:"text-sm text-gray-500"},_s={key:2,class:"space-y-3"},xs={class:"flex justify-between items-start"},ks={class:"font-medium text-gray-900"},Ds={class:"text-sm text-gray-600"},Cs={key:0,class:"text-sm text-gray-600 mt-1"},Ts={class:"flex space-x-2"},Es=["href"],Ss=["href"],Ms=["onClick"],js={__name:"ProjectMeetingsList",props:{projectId:{type:Number,required:!0}},setup(l,{expose:t}){const s=l,i=_([]),n=_(!1),a=_(""),u=()=>{try{a.value=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(f){console.error("Error detecting user timezone:",f),a.value="UTC"}},d=(f,y=null,T=!1)=>{if(!f)return"";try{if(T||f.endsWith("Z")){if(y&&y===a.value){const S={dateStyle:"medium",timeStyle:"short"};return new Date(f).toLocaleString(void 0,S)}const C={dateStyle:"medium",timeStyle:"short",timeZone:y||a.value};return new Date(f).toLocaleString(void 0,C)}else{if(y&&y===a.value){const S={dateStyle:"medium",timeStyle:"short"};return new Date(f).toLocaleString(void 0,S)}const C={dateStyle:"medium",timeStyle:"short",timeZone:y||a.value};return new Date(f).toLocaleString(void 0,C)}}catch(C){return console.error("Error formatting meeting time:",C),new Date(f).toLocaleString()}},c=(f,y=null,T=!1)=>{if(!f)return"";try{if(T||f.endsWith("Z")){if(y&&y===a.value){const S={timeStyle:"short"};return new Date(f).toLocaleTimeString(void 0,S)}const C={timeStyle:"short",timeZone:y||a.value};return new Date(f).toLocaleTimeString(void 0,C)}else{if(y&&y===a.value){const S={timeStyle:"short"};return new Date(f).toLocaleTimeString(void 0,S)}const C={timeStyle:"short",timeZone:y||a.value};return new Date(f).toLocaleTimeString(void 0,C)}}catch(C){return console.error("Error formatting meeting time (time only):",C),new Date(f).toLocaleTimeString()}},m=async()=>{n.value=!0;try{const f=await window.axios.get(`/api/projects/${s.projectId}/meetings`);i.value=f.data}catch(f){console.error("Error fetching project meetings:",f)}finally{n.value=!1}},p=async f=>{if(confirm("Are you sure you want to delete this meeting?"))try{await window.axios.delete(`/api/projects/${s.projectId}/meetings/${f}`),await m()}catch(y){console.error("Error deleting meeting:",y),alert("Failed to delete meeting. Please try again.")}};return t({fetchMeetings:m}),fe(()=>{u(),m()}),(f,y)=>(o(),r("div",fs,[y[4]||(y[4]=e("h4",{class:"text-md font-semibold text-gray-900 mb-2"},"Upcoming Meetings",-1)),n.value?(o(),r("div",bs," Loading meetings... ")):i.value.length===0?(o(),r("div",ws," No upcoming meetings scheduled. ")):(o(),r("div",_s,[(o(!0),r(J,null,Q(i.value,T=>(o(),r("div",{key:T.id,class:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[e("div",xs,[e("div",null,[e("h5",ks,g(T.summary),1),e("p",Ds,g(d(T.start_time,T.timezone,T.is_utc))+" - "+g(c(T.end_time,T.timezone,T.is_utc)),1),T.location?(o(),r("p",Cs,[y[0]||(y[0]=e("span",{class:"font-medium"},"Location:",-1)),z(" "+g(T.location),1)])):D("",!0)]),e("div",Ts,[e("a",{href:T.google_event_link,target:"_blank",class:"text-blue-600 hover:text-blue-800",title:"View in Google Calendar"},y[1]||(y[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]),8,Es),T.google_meet_link?(o(),r("a",{key:0,href:T.google_meet_link,target:"_blank",class:"text-green-600 hover:text-green-800",title:"Join Google Meet"},y[2]||(y[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,Ss)):D("",!0),e("button",{onClick:C=>p(T.google_event_id),class:"text-red-600 hover:text-red-800",title:"Delete Meeting"},y[3]||(y[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Ms)])])]))),128))]))]))}};var $s=Object.defineProperty,Vs=(l,t,s)=>t in l?$s(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s,De=(l,t,s)=>Vs(l,typeof t!="symbol"?t+"":t,s);const As=(l,t,s)=>{const i=l[t];return i?typeof i=="function"?i():Promise.resolve(i):new Promise((n,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==s?". Note that variables only represent file names one level deep.":""))))})};let Ue,ct,mt,be,Ne={},Ae={};class Os{constructor(t,s=!1){De(this,"texts",{}),De(this,"dateToMinutes",i=>i.getHours()*60+i.getMinutes()),be=this,this._texts=t,!s&&Date&&!Date.prototype.addDays&&this._initDatePrototypes()}_initDatePrototypes(){Date.prototype.addDays=function(t){return be.addDays(this,t)},Date.prototype.subtractDays=function(t){return be.subtractDays(this,t)},Date.prototype.addHours=function(t){return be.addHours(this,t)},Date.prototype.subtractHours=function(t){return be.subtractHours(this,t)},Date.prototype.addMinutes=function(t){return be.addMinutes(this,t)},Date.prototype.subtractMinutes=function(t){return be.subtractMinutes(this,t)},Date.prototype.getWeek=function(){return be.getWeek(this)},Date.prototype.isToday=function(){return be.isToday(this)},Date.prototype.isLeapYear=function(){return be.isLeapYear(this)},Date.prototype.format=function(t="YYYY-MM-DD"){return be.formatDate(this,t)},Date.prototype.formatTime=function(t="HH:mm"){return be.formatTime(this,t)}}removePrototypes(){delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime}updateTexts(t){this._texts=t}_todayFormatted(){return ct!==new Date().getDate()&&(Ue=new Date,ct=Ue.getDate(),mt=`${Ue.getFullYear()}-${Ue.getMonth()}-${Ue.getDate()}`),mt}addDays(t,s){const i=new Date(t.valueOf());return i.setDate(i.getDate()+s),i}subtractDays(t,s){const i=new Date(t.valueOf());return i.setDate(i.getDate()-s),i}addHours(t,s){const i=new Date(t.valueOf());return i.setHours(i.getHours()+s),i}subtractHours(t,s){const i=new Date(t.valueOf());return i.setHours(i.getHours()-s),i}addMinutes(t,s){const i=new Date(t.valueOf());return i.setMinutes(i.getMinutes()+s),i}subtractMinutes(t,s){const i=new Date(t.valueOf());return i.setMinutes(i.getMinutes()-s),i}getWeek(t){const s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),i=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-i);const n=new Date(Date.UTC(s.getUTCFullYear(),0,1));return Math.ceil(((s-n)/864e5+1)/7)}isToday(t){return`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`===this._todayFormatted()}isLeapYear(t){const s=t.getFullYear();return!(s%400)||s%100&&!(s%4)}getPreviousFirstDayOfWeek(t=null,s){const i=t&&new Date(t.valueOf())||new Date,n=s?7:6;return i.setDate(i.getDate()-(i.getDay()+n)%7),i}stringToDate(t){return t instanceof Date?t:(t.length===10&&(t+=" 00:00"),new Date(t.replace(/-/g,"/")))}countDays(t,s){typeof t=="string"&&(t=t.replace(/-/g,"/")),typeof s=="string"&&(s=s.replace(/-/g,"/")),t=new Date(t).setHours(0,0,0,0),s=new Date(s).setHours(0,0,1,0);const i=(new Date(s).getTimezoneOffset()-new Date(t).getTimezoneOffset())*60*1e3;return Math.ceil((s-t-i)/(24*3600*1e3))}datesInSameTimeStep(t,s,i){return Math.abs(t.getTime()-s.getTime())<=i*60*1e3}formatDate(t,s="YYYY-MM-DD",i=null){if(i||(i=this._texts),s||(s="YYYY-MM-DD"),s==="YYYY-MM-DD")return this.formatDateLite(t);Ne={},Ae={};const n={YYYY:()=>this._hydrateDateObject(t,i).YYYY,YY:()=>this._hydrateDateObject(t,i).YY(),M:()=>this._hydrateDateObject(t,i).M,MM:()=>this._hydrateDateObject(t,i).MM(),MMM:()=>this._hydrateDateObject(t,i).MMM(),MMMM:()=>this._hydrateDateObject(t,i).MMMM(),MMMMG:()=>this._hydrateDateObject(t,i).MMMMG(),D:()=>this._hydrateDateObject(t,i).D,DD:()=>this._hydrateDateObject(t,i).DD(),S:()=>this._hydrateDateObject(t,i).S(),d:()=>this._hydrateDateObject(t,i).d,dd:()=>this._hydrateDateObject(t,i).dd(),ddd:()=>this._hydrateDateObject(t,i).ddd(),dddd:()=>this._hydrateDateObject(t,i).dddd(),HH:()=>this._hydrateTimeObject(t,i).HH,H:()=>this._hydrateTimeObject(t,i).H,hh:()=>this._hydrateTimeObject(t,i).hh,h:()=>this._hydrateTimeObject(t,i).h,am:()=>this._hydrateTimeObject(t,i).am,AM:()=>this._hydrateTimeObject(t,i).AM,mm:()=>this._hydrateTimeObject(t,i).mm,m:()=>this._hydrateTimeObject(t,i).m};return s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(a,u)=>{const d=n[u.replace(/\{|\}/g,"")];return d!==void 0?d():u})}formatDateLite(t){const s=t.getMonth()+1,i=t.getDate();return`${t.getFullYear()}-${s<10?"0":""}${s}-${i<10?"0":""}${i}`}formatTime(t,s="HH:mm",i=null,n=!1){let a=!1;if(n){const[c,m,p]=[t.getHours(),t.getMinutes(),t.getSeconds()];c+m+p===141&&(a=!0)}if(t instanceof Date&&s==="HH:mm")return a?"24:00":this.formatTimeLite(t);Ae={},i||(i=this._texts);const u=this._hydrateTimeObject(t,i),d=s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(c,m)=>{const p=u[m.replace(/\{|\}/g,"")];return p!==void 0?p:m});return a?d.replace("23:59","24:00"):d}formatTimeLite(t){const s=t.getHours(),i=t.getMinutes();return`${(s<10?"0":"")+s}:${(i<10?"0":"")+i}`}_nth(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}_hydrateDateObject(t,s){if(Ne.D)return Ne;const i=t.getFullYear(),n=t.getMonth()+1,a=t.getDate(),d=(t.getDay()-1+7)%7;return Ne={YYYY:i,YY:()=>i.toString().substring(2),M:n,MM:()=>(n<10?"0":"")+n,MMM:()=>s.months[n-1].substring(0,3),MMMM:()=>s.months[n-1],MMMMG:()=>(s.monthsGenitive||s.months)[n-1],D:a,DD:()=>(a<10?"0":"")+a,S:()=>this._nth(a),d:d+1,dd:()=>s.weekDays[d][0],ddd:()=>s.weekDays[d].substr(0,3),dddd:()=>s.weekDays[d]},Ne}_hydrateTimeObject(t,s){if(Ae.am)return Ae;let i,n;t instanceof Date?(i=t.getHours(),n=t.getMinutes()):(i=Math.floor(t/60),n=Math.floor(t%60));const a=i%12?i%12:12,u=(s||{am:"am",pm:"pm"})[i===24||i<12?"am":"pm"];return Ae={H:i,h:a,HH:(i<10?"0":"")+i,hh:(a<10?"0":"")+a,am:u,AM:u.toUpperCase(),m:n,mm:(n<10?"0":"")+n},Ae}}const Is=1440;class Ls{constructor(t){De(this,"_vuecal",null),De(this,"selectCell",(s=!1,i,n)=>{this._vuecal.$emit("cell-click",n?{date:i,split:n}:i),this._vuecal.clickToNavigate||s?this._vuecal.switchToNarrowerView():this._vuecal.dblclickToNavigate&&"ontouchstart"in window&&(this._vuecal.domEvents.dblTapACell.taps++,setTimeout(()=>this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.domEvents.dblTapACell.timeout),this._vuecal.domEvents.dblTapACell.taps>=2&&(this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.switchToNarrowerView(),this._vuecal.$emit("cell-dblclick",n?{date:i,split:n}:i)))}),De(this,"keyPressEnterCell",(s,i)=>{this._vuecal.$emit("cell-keypress-enter",i?{date:s,split:i}:s),this._vuecal.switchToNarrowerView()}),De(this,"getPosition",s=>{const{left:i,top:n}=this._vuecal.cellsEl.getBoundingClientRect(),{clientX:a,clientY:u}="ontouchstart"in window&&s.touches?s.touches[0]:s;return{x:a-i,y:u-n}}),De(this,"minutesAtCursor",s=>{let i=0,n={x:0,y:0};const{timeStep:a,timeCellHeight:u,timeFrom:d}=this._vuecal.$props;return typeof s=="number"?i=s:typeof s=="object"&&(n=this.getPosition(s),i=Math.round(n.y*a/parseInt(u)+d)),{minutes:Math.max(Math.min(i,Is),0),cursorCoords:n}}),this._vuecal=t}}const Ps=2,Je=1440;let de,ue,Ze;class Us{constructor(t,s){De(this,"_vuecal",null),De(this,"eventDefaults",{_eid:null,start:"",startTimeMinutes:0,end:"",endTimeMinutes:0,title:"",content:"",background:!1,allDay:!1,segments:null,repeat:null,daysCount:1,deletable:!0,deleting:!1,titleEditable:!0,resizable:!0,resizing:!1,draggable:!0,dragging:!1,draggingStatic:!1,focused:!1,class:""}),this._vuecal=t,de=s}createAnEvent(t,s,i){if(typeof t=="string"&&(t=de.stringToDate(t)),!(t instanceof Date))return!1;const n=de.dateToMinutes(t);s=s*1||Ps*60;const a=n+s,u=de.addMinutes(new Date(t),s);i.end&&(typeof i.end=="string"&&(i.end=de.stringToDate(i.end)),i.endTimeMinutes=de.dateToMinutes(i.end));const d={...this.eventDefaults,_eid:`${this._vuecal._.uid}_${this._vuecal.eventIdIncrement++}`,start:t,startTimeMinutes:n,end:u,endTimeMinutes:a,segments:null,...i};if(!(typeof this._vuecal.onEventCreate=="function"&&!this._vuecal.onEventCreate(d,()=>this.deleteAnEvent(d))))return d.startDateF!==d.endDateF&&(d.daysCount=de.countDays(d.start,d.end)),this._vuecal.mutableEvents.push(d),this._vuecal.addEventsToView([d]),this._vuecal.emitWithEvent("event-create",d),this._vuecal.$emit("event-change",{event:this._vuecal.cleanupEvent(d),originalEvent:null}),d}addEventSegment(t){t.segments||(t.segments={},t.segments[de.formatDateLite(t.start)]={start:t.start,startTimeMinutes:t.startTimeMinutes,endTimeMinutes:Je,isFirstDay:!0,isLastDay:!1});const s=t.segments[de.formatDateLite(t.end)];s&&(s.isLastDay=!1,s.endTimeMinutes=Je);const i=de.addDays(t.end,1),n=de.formatDateLite(i);return i.setHours(0,0,0,0),t.segments[n]={start:i,startTimeMinutes:0,endTimeMinutes:t.endTimeMinutes,isFirstDay:!1,isLastDay:!0},t.end=de.addMinutes(i,t.endTimeMinutes),t.daysCount=Object.keys(t.segments).length,n}removeEventSegment(t){let s=Object.keys(t.segments).length;if(s<=1)return de.formatDateLite(t.end);delete t.segments[de.formatDateLite(t.end)],s--;const i=de.subtractDays(t.end,1),n=de.formatDateLite(i),a=t.segments[n];return s?a&&(a.isLastDay=!0,a.endTimeMinutes=t.endTimeMinutes):t.segments=null,t.daysCount=s||1,t.end=i,n}createEventSegments(t,s,i){const n=s.getTime(),a=i.getTime();let u=t.start.getTime(),d=t.end.getTime(),c=!1,m,p,f;for(!t.end.getHours()&&!t.end.getMinutes()&&(d-=1e3),t.segments={},t.repeat?(m=n,p=Math.min(a,t.repeat.until?de.stringToDate(t.repeat.until).getTime():a)):(m=Math.max(n,u),p=Math.min(a,d));m<=p;){let y=!1;const T=de.addDays(new Date(m),1).setHours(0,0,0,0);let C,S,h,x;if(t.repeat){const N=new Date(m),A=de.formatDateLite(N);(c||t.occurrences&&t.occurrences[A])&&(c||(u=t.occurrences[A].start,f=new Date(u).setHours(0,0,0,0),d=t.occurrences[A].end),c=!0,y=!0),C=m===f,S=A===de.formatDateLite(new Date(d)),h=new Date(C?u:m),x=de.formatDateLite(h),S&&(c=!1)}else y=!0,C=m===u,S=p===d&&T>p,h=C?t.start:new Date(m),x=de.formatDateLite(C?t.start:h);y&&(t.segments[x]={start:h,startTimeMinutes:C?t.startTimeMinutes:0,endTimeMinutes:S?t.endTimeMinutes:Je,isFirstDay:C,isLastDay:S}),m=T}return t}deleteAnEvent(t){this._vuecal.emitWithEvent("event-delete",t),this._vuecal.mutableEvents=this._vuecal.mutableEvents.filter(s=>s._eid!==t._eid),this._vuecal.view.events=this._vuecal.view.events.filter(s=>s._eid!==t._eid)}checkCellOverlappingEvents(t,s){Ze=t.slice(0),ue={},t.forEach(n=>{Ze.shift(),ue[n._eid]||(ue[n._eid]={overlaps:[],start:n.start,position:0}),ue[n._eid].position=0,Ze.forEach(a=>{ue[a._eid]||(ue[a._eid]={overlaps:[],start:a.start,position:0});const u=this.eventInRange(a,n.start,n.end),d=s.overlapsPerTimeStep?de.datesInSameTimeStep(n.start,a.start,s.timeStep):1;if(!n.background&&!n.allDay&&!a.background&&!a.allDay&&u&&d)ue[n._eid].overlaps.push(a._eid),ue[n._eid].overlaps=[...new Set(ue[n._eid].overlaps)],ue[a._eid].overlaps.push(n._eid),ue[a._eid].overlaps=[...new Set(ue[a._eid].overlaps)],ue[a._eid].position++;else{let c,m;(c=(ue[n._eid]||{overlaps:[]}).overlaps.indexOf(a._eid))>-1&&ue[n._eid].overlaps.splice(c,1),(m=(ue[a._eid]||{overlaps:[]}).overlaps.indexOf(n._eid))>-1&&ue[a._eid].overlaps.splice(m,1),ue[a._eid].position--}})});let i=0;for(const n in ue){const a=ue[n],u=a.overlaps.map(d=>({id:d,start:ue[d].start}));u.push({id:n,start:a.start}),u.sort((d,c)=>d.start<c.start?-1:d.start>c.start?1:d.id>c.id?-1:1),a.position=u.findIndex(d=>d.id===n),i=Math.max(this.getOverlapsStreak(a,ue),i)}return[ue,i]}getOverlapsStreak(t,s={}){let i=t.overlaps.length+1,n=[];return t.overlaps.forEach(a=>{n.includes(a)||t.overlaps.filter(d=>d!==a).forEach(d=>{s[d].overlaps.includes(a)||n.push(d)})}),n=[...new Set(n)],i-=n.length,i}eventInRange(t,s,i){if(t.allDay||!this._vuecal.time){const u=new Date(t.start).setHours(0,0,0,0);return new Date(t.end).setHours(23,59,0,0)>=new Date(s).setHours(0,0,0,0)&&u<=new Date(i).setHours(0,0,0,0)}const n=t.start.getTime(),a=t.end.getTime();return n<i.getTime()&&a>s.getTime()}}const Ns={class:"vuecal__flex vuecal__weekdays-headings"},Rs=["onClick"],Fs={class:"vuecal__flex weekday-label",grow:""},Hs={class:"full"},Bs={class:"small"},Ws={class:"xsmall"},Ys={key:0},zs={key:0,class:"vuecal__flex vuecal__split-days-headers",grow:""};function qs(l,t,s,i,n,a){return o(),r("div",Ns,[(o(!0),r(J,null,Q(a.headings,(u,d)=>(o(),r(J,{key:d},[u.hide?D("",!0):(o(),r("div",{key:0,class:se(["vuecal__flex vuecal__heading",{today:u.today,clickable:a.cellHeadingsClickable}]),style:we(a.weekdayCellStyles),onClick:c=>a.view.id==="week"&&a.selectCell(u.date,c),onDblclick:t[0]||(t[0]=c=>a.view.id==="week"&&a.vuecal.dblclickToNavigate&&s.switchToNarrowerView())},[v(Ye,{name:`slide-fade--${s.transitionDirection}`,appear:a.vuecal.transitions},{default:H(()=>[(o(),r("div",{class:"vuecal__flex",column:"",key:a.vuecal.transitions?`${d}-${u.dayOfMonth}`:!1},[e("div",Fs,[ie(l.$slots,"weekday-heading",{heading:a.cleanupHeading(u),view:a.view},()=>[e("span",Hs,g(u.full),1),e("span",Bs,g(u.small),1),e("span",Ws,g(u.xsmall),1),u.dayOfMonth?(o(),r("span",Ys," "+g(u.dayOfMonth),1)):D("",!0)])]),a.vuecal.hasSplits&&a.vuecal.stickySplitLabels?(o(),r("div",zs,[(o(!0),r(J,null,Q(a.vuecal.daySplits,(c,m)=>(o(),r("div",{class:se(["day-split-header",c.class||!1]),key:m},[ie(l.$slots,"split-label",{split:c,view:a.view},()=>[z(g(c.label),1)])],2))),128))])):D("",!0)]))]),_:2},1032,["name","appear"])],46,Rs))],64))),128))])}const Le=(l,t)=>{const s=l.__vccOpts||l;for(const[i,n]of t)s[i]=n;return s},Gs={inject:["vuecal","utils","view"],props:{transitionDirection:{type:String,default:"right"},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},methods:{selectCell(l,t){l.getTime()!==this.view.selectedDate.getTime()&&(this.view.selectedDate=l),this.utils.cell.selectCell(!1,l,t)},cleanupHeading:l=>({label:l.full,date:l.date,...l.today?{today:l.today}:{}})},computed:{headings(){if(!["month","week"].includes(this.view.id))return[];let l=!1;return this.weekDays.map((s,i)=>{const n=this.utils.date.addDays(this.view.startDate,this.vuecal.startWeekOnSunday&&this.vuecal.hideWeekends?i-1:i);return{hide:s.hide,full:s.label,small:s.short||s.label.substr(0,3),xsmall:s.short||s.label.substr(0,1),...this.view.id==="week"?{dayOfMonth:n.getDate(),date:n,today:!l&&this.utils.date.isToday(n)&&!l++}:{}}})},cellWidth(){return 100/(7-this.weekDays.reduce((l,t)=>l+t.hide,0))},weekdayCellStyles(){return{...this.vuecal.hideWeekdays.length?{width:`${this.cellWidth}%`}:{}}},cellHeadingsClickable(){return this.view.id==="week"&&(this.vuecal.clickToNavigate||this.vuecal.dblclickToNavigate)}}},bt=Le(Gs,[["render",qs]]),Ks={class:"vuecal__header"},Js={key:0,class:"vuecal__flex vuecal__menu",role:"tablist","aria-label":"Calendar views navigation"},Zs=["onDragenter","onDragleave","onClick","aria-label"],Xs={key:1,class:"vuecal__title-bar"},Qs=["aria-label"],el={class:"vuecal__flex vuecal__title",grow:""},tl=["aria-label"],sl={key:0,class:"vuecal__flex vuecal__split-days-headers"};function ll(l,t,s,i,n,a){const u=Me("weekdays-headings");return o(),r("div",Ks,[s.options.hideViewSelector?D("",!0):(o(),r("div",Js,[(o(!0),r(J,null,Q(s.viewProps.views,(d,c)=>(o(),r(J,{key:c},[d.enabled?(o(),r("button",{key:0,class:se(["vuecal__view-btn",{"vuecal__view-btn--active":a.view.id===c,"vuecal__view-btn--highlighted":l.highlightedControl===c}]),type:"button",onDragenter:m=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(m,c,l.$data),onDragleave:m=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(m,c,l.$data),onClick:m=>a.switchView(c,null,!0),"aria-label":`${d.label} view`},g(d.label),43,Zs)):D("",!0)],64))),128))])),s.options.hideTitleBar?D("",!0):(o(),r("div",Xs,[e("button",{class:se(["vuecal__arrow vuecal__arrow--prev",{"vuecal__arrow--highlighted":l.highlightedControl==="previous"}]),type:"button",onClick:t[0]||(t[0]=(...d)=>a.previous&&a.previous(...d)),onDragenter:t[1]||(t[1]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(d,"previous",l.$data)),onDragleave:t[2]||(t[2]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(d,"previous",l.$data)),"aria-label":`Previous ${a.view.id}`},[ie(l.$slots,"arrow-prev")],42,Qs),e("div",el,[v(Ye,{name:s.options.transitions?`slide-fade--${a.transitionDirection}`:""},{default:H(()=>[(o(),le(qt(a.broaderView?"button":"span"),{type:!!a.broaderView&&"button",key:`${a.view.id}${a.view.startDate.toString()}`,onClick:t[3]||(t[3]=d=>!!a.broaderView&&a.switchToBroaderView()),"aria-label":!!a.broaderView&&`Go to ${a.broaderView} view`},{default:H(()=>[ie(l.$slots,"title")]),_:3},8,["type","aria-label"]))]),_:3},8,["name"])]),s.options.todayButton?(o(),r("button",{key:0,class:se(["vuecal__today-btn",{"vuecal__today-btn--highlighted":l.highlightedControl==="today"}]),type:"button",onClick:t[4]||(t[4]=(...d)=>a.goToToday&&a.goToToday(...d)),onDragenter:t[5]||(t[5]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(d,"today",l.$data)),onDragleave:t[6]||(t[6]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(d,"today",l.$data)),"aria-label":"Today"},[ie(l.$slots,"today-button")],34)):D("",!0),e("button",{class:se(["vuecal__arrow vuecal__arrow--next",{"vuecal__arrow--highlighted":l.highlightedControl==="next"}]),type:"button",onClick:t[7]||(t[7]=(...d)=>a.next&&a.next(...d)),onDragenter:t[8]||(t[8]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(d,"next",l.$data)),onDragleave:t[9]||(t[9]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(d,"next",l.$data)),"aria-label":`Next ${a.view.id}`},[ie(l.$slots,"arrow-next")],42,tl)])),s.viewProps.weekDaysInHeader?(o(),le(u,{key:2,"week-days":s.weekDays,"transition-direction":a.transitionDirection,"switch-to-narrower-view":s.switchToNarrowerView},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:H(({heading:d,view:c})=>[ie(l.$slots,"weekday-heading",{heading:d,view:c})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:H(({split:d})=>[ie(l.$slots,"split-label",{split:d,view:a.view})]),key:"1"}:void 0]),1032,["week-days","transition-direction","switch-to-narrower-view"])):D("",!0),v(Ye,{name:`slide-fade--${a.transitionDirection}`},{default:H(()=>[a.showDaySplits?(o(),r("div",sl,[(o(!0),r(J,null,Q(s.daySplits,(d,c)=>(o(),r("div",{class:se(["day-split-header",d.class||!1]),key:c},[ie(l.$slots,"split-label",{split:d,view:a.view.id},()=>[z(g(d.label),1)])],2))),128))])):D("",!0)]),_:3},8,["name"])])}const al={inject:["vuecal","previous","next","switchView","updateSelectedDate","modules","view"],components:{WeekdaysHeadings:bt},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},hasSplits:{type:[Boolean,Number],default:!1},daySplits:{type:Array,default:()=>[]},viewProps:{type:Object,default:()=>({})},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},data:()=>({highlightedControl:null}),methods:{goToToday(){this.updateSelectedDate(new Date(new Date().setHours(0,0,0,0)))},switchToBroaderView(){this.transitionDirection="left",this.broaderView&&this.switchView(this.broaderView)}},computed:{transitionDirection:{get(){return this.vuecal.transitionDirection},set(l){this.vuecal.transitionDirection=l}},broaderView(){const{enabledViews:l}=this.vuecal;return l[l.indexOf(this.view.id)-1]},showDaySplits(){return this.view.id==="day"&&this.hasSplits&&this.options.stickySplitLabels&&!this.options.minSplitWidth},dnd(){return this.modules.dnd}}},il=Le(al,[["render",ll]]),nl=["draggable"];function ol(l,t,s,i,n,a){return o(),r("div",{class:se(["vuecal__event",a.eventClasses]),style:we(a.eventStyles),tabindex:"0",onFocus:t[4]||(t[4]=(...u)=>a.focusEvent&&a.focusEvent(...u)),onKeypress:t[5]||(t[5]=ze(xe((...u)=>a.onEnterKeypress&&a.onEnterKeypress(...u),["stop"]),["enter"])),onMouseenter:t[6]||(t[6]=(...u)=>a.onMouseEnter&&a.onMouseEnter(...u)),onMouseleave:t[7]||(t[7]=(...u)=>a.onMouseLeave&&a.onMouseLeave(...u)),onTouchstart:t[8]||(t[8]=xe((...u)=>a.onTouchStart&&a.onTouchStart(...u),["stop"])),onMousedown:t[9]||(t[9]=u=>a.onMouseDown(u)),onMouseup:t[10]||(t[10]=(...u)=>a.onMouseUp&&a.onMouseUp(...u)),onTouchend:t[11]||(t[11]=(...u)=>a.onMouseUp&&a.onMouseUp(...u)),onTouchmove:t[12]||(t[12]=(...u)=>a.onTouchMove&&a.onTouchMove(...u)),onDblclick:t[13]||(t[13]=(...u)=>a.onDblClick&&a.onDblClick(...u)),draggable:a.draggable,onDragstart:t[14]||(t[14]=u=>a.draggable&&a.onDragStart(u)),onDragend:t[15]||(t[15]=u=>a.draggable&&a.onDragEnd())},[a.vuecal.editEvents.delete&&s.event.deletable?(o(),r("div",{key:0,class:"vuecal__event-delete",onClick:t[0]||(t[0]=xe((...u)=>a.deleteEvent&&a.deleteEvent(...u),["stop"])),onTouchstart:t[1]||(t[1]=xe((...u)=>a.touchDeleteEvent&&a.touchDeleteEvent(...u),["stop"]))},g(a.vuecal.texts.deleteEvent),33)):D("",!0),ie(l.$slots,"event",{event:s.event,view:a.view.id}),a.resizable?(o(),r("div",{key:1,class:"vuecal__event-resize-handle",contenteditable:"false",onMousedown:t[2]||(t[2]=xe((...u)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...u),["stop","prevent"])),onTouchstart:t[3]||(t[3]=xe((...u)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...u),["stop","prevent"]))},null,32)):D("",!0)],46,nl)}const rl={inject:["vuecal","utils","modules","view","domEvents","editEvents"],props:{cellFormattedDate:{type:String,default:""},event:{type:Object,default:()=>({})},cellEvents:{type:Array,default:()=>[]},overlaps:{type:Array,default:()=>[]},eventPosition:{type:Number,default:0},overlapsStreak:{type:Number,default:0},allDay:{type:Boolean,default:!1}},data:()=>({touch:{dragThreshold:30,startX:0,startY:0,dragged:!1}}),methods:{onMouseDown(l,t=!1){if("ontouchstart"in window&&!t)return!1;const{clickHoldAnEvent:s,focusAnEvent:i,resizeAnEvent:n,dragAnEvent:a}=this.domEvents;if(i._eid===this.event._eid&&s._eid===this.event._eid)return!0;this.focusEvent(),s._eid=null,this.vuecal.editEvents.delete&&this.event.deletable&&(s.timeoutId=setTimeout(()=>{!n._eid&&!a._eid&&(s._eid=this.event._eid,this.event.deleting=!0)},s.timeout))},onMouseUp(l){this.domEvents.focusAnEvent._eid===this.event._eid&&!this.touch.dragged&&(this.domEvents.focusAnEvent.mousedUp=!0),this.touch.dragged=!1},onMouseEnter(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-enter",this.event)},onMouseLeave(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-leave",this.event)},onTouchMove(l){if(typeof this.vuecal.onEventClick!="function")return;const{clientX:t,clientY:s}=l.touches[0],{startX:i,startY:n,dragThreshold:a}=this.touch;(Math.abs(t-i)>a||Math.abs(s-n)>a)&&(this.touch.dragged=!0)},onTouchStart(l){this.touch.startX=l.touches[0].clientX,this.touch.startY=l.touches[0].clientY,this.onMouseDown(l,!0)},onEnterKeypress(l){if(typeof this.vuecal.onEventClick=="function")return this.vuecal.onEventClick(this.event,l)},onDblClick(l){if(typeof this.vuecal.onEventDblclick=="function")return this.vuecal.onEventDblclick(this.event,l)},onDragStart(l){this.dnd&&this.dnd.eventDragStart(l,this.event)},onDragEnd(){this.dnd&&this.dnd.eventDragEnd(this.event)},onResizeHandleMouseDown(){this.focusEvent(),this.domEvents.dragAnEvent._eid=null,this.domEvents.resizeAnEvent=Object.assign(this.domEvents.resizeAnEvent,{_eid:this.event._eid,start:(this.segment||this.event).start,split:this.event.split||null,segment:!!this.segment&&this.utils.date.formatDateLite(this.segment.start),originalEnd:new Date((this.segment||this.event).end),originalEndTimeMinutes:this.event.endTimeMinutes}),this.event.resizing=!0},deleteEvent(l=!1){if("ontouchstart"in window&&!l)return!1;this.utils.event.deleteAnEvent(this.event)},touchDeleteEvent(l){this.deleteEvent(!0)},cancelDeleteEvent(){this.event.deleting=!1},focusEvent(){const{focusAnEvent:l}=this.domEvents,t=l._eid;if(t!==this.event._eid){if(t){const s=this.view.events.find(i=>i._eid===t);s&&(s.focused=!1)}this.vuecal.cancelDelete(),this.vuecal.emitWithEvent("event-focus",this.event),l._eid=this.event._eid,this.event.focused=!0}}},computed:{eventDimensions(){const{startTimeMinutes:l,endTimeMinutes:t}=this.segment||this.event;let s=l-this.vuecal.timeFrom;const i=Math.max(Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),0);s=Math.min(t,this.vuecal.timeTo)-this.vuecal.timeFrom;const n=Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),a=Math.max(n-i,5);return{top:i,height:a}},eventStyles(){if(this.event.allDay||!this.vuecal.time||!this.event.endTimeMinutes||this.view.id==="month"||this.allDay)return{};let l=100/Math.min(this.overlaps.length+1,this.overlapsStreak),t=100/(this.overlaps.length+1)*this.eventPosition;this.vuecal.minEventWidth&&l<this.vuecal.minEventWidth&&(l=this.vuecal.minEventWidth,t=(100-this.vuecal.minEventWidth)/this.overlaps.length*this.eventPosition);const{top:s,height:i}=this.eventDimensions;return{top:`${s}px`,height:`${i}px`,width:`${l}%`,left:this.event.left&&`${this.event.left}px`||`${t}%`}},eventClasses(){const{isFirstDay:l,isLastDay:t}=this.segment||{};return{[this.event.class]:!!this.event.class,"vuecal__event--focus":this.event.focused,"vuecal__event--resizing":this.event.resizing,"vuecal__event--background":this.event.background,"vuecal__event--deletable":this.event.deleting,"vuecal__event--all-day":this.event.allDay,"vuecal__event--dragging":!this.event.draggingStatic&&this.event.dragging,"vuecal__event--static":this.event.dragging&&this.event.draggingStatic,"vuecal__event--multiple-days":!!this.segment,"event-start":this.segment&&l&&!t,"event-middle":this.segment&&!l&&!t,"event-end":this.segment&&t&&!l}},segment(){return this.event.segments&&this.event.segments[this.cellFormattedDate]||null},draggable(){const{draggable:l,background:t,daysCount:s}=this.event;return this.vuecal.editEvents.drag&&l&&!t&&s===1},resizable(){const{editEvents:l,time:t}=this.vuecal;return l.resize&&this.event.resizable&&t&&!this.allDay&&(!this.segment||this.segment&&this.segment.isLastDay)&&this.view.id!=="month"},dnd(){return this.modules.dnd}}},dl=Le(rl,[["render",ol]]),ul=["data-split","aria-label","onTouchstart","onMousedown","onDragover","onDrop"],cl={key:0,class:"cell-time-labels"},ml=["innerHTML"],vl={key:2,class:"vuecal__cell-events"},pl=["title"];function hl(l,t,s,i,n,a){const u=Me("event");return o(),le(Gt,{class:se(["vuecal__cell",a.cellClasses]),name:`slide-fade--${a.transitionDirection}`,tag:"div",appear:s.options.transitions,style:we(a.cellStyles)},{default:H(()=>[(o(!0),r(J,null,Q(a.splitsCount?a.splits:1,(d,c)=>(o(),r("div",{class:se(["vuecal__flex vuecal__cell-content",a.splitsCount&&a.splitClasses(d)]),key:s.options.transitions?`${a.view.id}-${s.data.content}-${c}`:c,"data-split":a.splitsCount?d.id:!1,column:"",tabindex:"0","aria-label":s.data.content,onFocus:t[0]||(t[0]=m=>a.onCellFocus(m)),onKeypress:t[1]||(t[1]=ze(m=>a.onCellkeyPressEnter(m),["enter"])),onTouchstart:m=>!a.isDisabled&&a.onCellTouchStart(m,a.splitsCount?d.id:null),onMousedown:m=>!a.isDisabled&&a.onCellMouseDown(m,a.splitsCount?d.id:null),onClick:t[2]||(t[2]=m=>!a.isDisabled&&a.onCellClick(m)),onDblclick:t[3]||(t[3]=m=>!a.isDisabled&&a.onCellDblClick(m)),onContextmenu:t[4]||(t[4]=m=>!a.isDisabled&&s.options.cellContextmenu&&a.onCellContextMenu(m)),onDragenter:t[5]||(t[5]=m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragEnter(m,l.$data,s.data.startDate)),onDragover:m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragOver(m,l.$data,s.data.startDate,a.splitsCount?d.id:null),onDragleave:t[6]||(t[6]=m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragLeave(m,l.$data,s.data.startDate)),onDrop:m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragDrop(m,l.$data,s.data.startDate,a.splitsCount?d.id:null)},[s.options.showTimeInCells&&s.options.time&&a.isWeekOrDayView&&!s.allDay?(o(),r("div",cl,[(o(!0),r(J,null,Q(a.vuecal.timeCells,(m,p)=>(o(),r("span",{class:"cell-time-label",key:p},g(m.label),1))),128))])):D("",!0),a.isWeekOrDayView&&!s.allDay&&a.specialHours.length?(o(!0),r(J,{key:1},Q(a.specialHours,(m,p)=>(o(),r("div",{class:se(["vuecal__special-hours",`vuecal__special-hours--day${m.day} ${m.class}`]),style:we(`height: ${m.height}px;top: ${m.top}px`)},[m.label?(o(),r("div",{key:0,class:"special-hours-label",innerHTML:m.label},null,8,ml)):D("",!0)],6))),256)):D("",!0),ie(l.$slots,"cell-content",{events:a.events,selectCell:m=>a.selectCell(m,!0),split:a.splitsCount?d:!1}),a.eventsCount&&(a.isWeekOrDayView||a.view.id==="month"&&s.options.eventsOnMonthView)?(o(),r("div",vl,[(o(!0),r(J,null,Q(a.splitsCount?d.events:a.events,(m,p)=>(o(),le(u,{key:p,"cell-formatted-date":s.data.formattedDate,event:m,"all-day":s.allDay,"cell-events":a.splitsCount?d.events:a.events,overlaps:((a.splitsCount?d.overlaps[m._eid]:l.cellOverlaps[m._eid])||[]).overlaps,"event-position":((a.splitsCount?d.overlaps[m._eid]:l.cellOverlaps[m._eid])||[]).position,"overlaps-streak":a.splitsCount?d.overlapsStreak:l.cellOverlapsStreak},{event:H(({event:f,view:y})=>[ie(l.$slots,"event",{view:y,event:f})]),_:2},1032,["cell-formatted-date","event","all-day","cell-events","overlaps","event-position","overlaps-streak"]))),128))])):D("",!0)],42,ul))),128)),a.timelineVisible?(o(),r("div",{class:"vuecal__now-line",style:we(`top: ${a.todaysTimePosition}px`),key:s.options.transitions?`${a.view.id}-now-line`:"now-line",title:a.utils.date.formatTime(a.vuecal.now)},null,12,pl)):D("",!0)]),_:3},8,["class","name","appear","style"])}const gl={inject:["vuecal","utils","modules","view","domEvents"],components:{Event:dl},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},data:{type:Object,required:!0},cellSplits:{type:Array,default:()=>[]},minTimestamp:{type:[Number,null],default:null},maxTimestamp:{type:[Number,null],default:null},cellWidth:{type:[Number,Boolean],default:!1},allDay:{type:Boolean,default:!1}},data:()=>({cellOverlaps:{},cellOverlapsStreak:1,timeAtCursor:null,highlighted:!1,highlightedSplit:null}),methods:{getSplitAtCursor({target:l}){let s=l.classList.contains("vuecal__cell-split")?l:this.vuecal.findAncestor(l,"vuecal__cell-split");return s&&(s=s.attributes["data-split"].value,parseInt(s).toString()===s.toString()&&(s=parseInt(s))),s||null},splitClasses(l){return{"vuecal__cell-split":!0,"vuecal__cell-split--highlighted":this.highlightedSplit===l.id,[l.class]:!!l.class}},checkCellOverlappingEvents(){this.options.time&&this.eventsCount&&!this.splitsCount&&(this.eventsCount===1?(this.cellOverlaps=[],this.cellOverlapsStreak=1):[this.cellOverlaps,this.cellOverlapsStreak]=this.utils.event.checkCellOverlappingEvents(this.events,this.options))},isDOMElementAnEvent(l){return this.vuecal.isDOMElementAnEvent(l)},selectCell(l,t=!1){const s=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.selectCell(t,this.timeAtCursor,s),this.timeAtCursor=null},onCellkeyPressEnter(l){this.isSelected||this.onCellFocus(l);const t=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.keyPressEnterCell(this.timeAtCursor,t),this.timeAtCursor=null},onCellFocus(l){if(!this.isSelected&&!this.isDisabled){this.isSelected=this.data.startDate;const t=this.splitsCount?this.getSplitAtCursor(l):null,s=this.timeAtCursor||this.data.startDate;this.vuecal.$emit("cell-focus",t?{date:s,split:t}:s)}},onCellMouseDown(l,t=null,s=!1){if("ontouchstart"in window&&!s)return!1;this.isSelected||this.onCellFocus(l);const{clickHoldACell:i,focusAnEvent:n}=this.domEvents;this.domEvents.cancelClickEventCreation=!1,i.eventCreated=!1,this.timeAtCursor=new Date(this.data.startDate);const{minutes:a,cursorCoords:{y:u}}=this.vuecal.minutesAtCursor(l);this.timeAtCursor.setMinutes(a);const d=this.isDOMElementAnEvent(l.target);!d&&n._eid&&((this.view.events.find(c=>c._eid===n._eid)||{}).focused=!1),this.editEvents.create&&!d&&this.setUpEventCreation(l,u)},setUpEventCreation(l,t){if(this.options.dragToCreateEvent&&["week","day"].includes(this.view.id)){const{dragCreateAnEvent:s}=this.domEvents;if(s.startCursorY=t,s.split=this.splitsCount?this.getSplitAtCursor(l):null,s.start=this.timeAtCursor,this.options.snapToTime){let i=this.timeAtCursor.getHours()*60+this.timeAtCursor.getMinutes();const n=i+this.options.snapToTime/2;i=n-n%this.options.snapToTime,s.start.setHours(0,i,0,0)}}else this.options.cellClickHold&&["month","week","day"].includes(this.view.id)&&this.setUpCellHoldTimer(l)},setUpCellHoldTimer(l){const{clickHoldACell:t}=this.domEvents;t.cellId=`${this.vuecal._.uid}_${this.data.formattedDate}`,t.split=this.splitsCount?this.getSplitAtCursor(l):null,t.timeoutId=setTimeout(()=>{if(t.cellId&&!this.domEvents.cancelClickEventCreation){const{_eid:s}=this.utils.event.createAnEvent(this.timeAtCursor,null,t.split?{split:t.split}:{});t.eventCreated=s}},t.timeout)},onCellTouchStart(l,t=null){this.onCellMouseDown(l,t,!0)},onCellClick(l){this.isDOMElementAnEvent(l.target)||this.selectCell(l)},onCellDblClick(l){const t=new Date(this.data.startDate);t.setMinutes(this.vuecal.minutesAtCursor(l).minutes);const s=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-dblclick",s?{date:t,split:s}:t),this.options.dblclickToNavigate&&this.vuecal.switchToNarrowerView()},onCellContextMenu(l){l.stopPropagation(),l.preventDefault();const t=new Date(this.data.startDate),{cursorCoords:s,minutes:i}=this.vuecal.minutesAtCursor(l);t.setMinutes(i);const n=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-contextmenu",{date:t,...s,...n||{},e:l})}},computed:{dnd(){return this.modules.dnd},nowInMinutes(){return this.utils.date.dateToMinutes(this.vuecal.now)},isBeforeMinDate(){return this.minTimestamp!==null&&this.minTimestamp>this.data.endDate.getTime()},isAfterMaxDate(){return this.maxTimestamp&&this.maxTimestamp<this.data.startDate.getTime()},isDisabled(){const{disableDays:l}=this.options,{isYearsOrYearView:t}=this.vuecal;return l.length&&l.includes(this.data.formattedDate)&&!t?!0:this.isBeforeMinDate||this.isAfterMaxDate},isSelected:{get(){let l=!1;const{selectedDate:t}=this.view;return this.view.id==="years"?l=t.getFullYear()===this.data.startDate.getFullYear():this.view.id==="year"?l=t.getFullYear()===this.data.startDate.getFullYear()&&t.getMonth()===this.data.startDate.getMonth():l=t.getTime()===this.data.startDate.getTime(),l},set(l){this.view.selectedDate=l,this.vuecal.$emit("update:selected-date",this.view.selectedDate)}},isWeekOrDayView(){return["week","day"].includes(this.view.id)},transitionDirection(){return this.vuecal.transitionDirection},specialHours(){return this.data.specialHours.map(l=>{let{from:t,to:s}=l;return t=Math.max(t,this.options.timeFrom),s=Math.min(s,this.options.timeTo),{...l,height:(s-t)*this.timeScale,top:(t-this.options.timeFrom)*this.timeScale}})},events(){const{startDate:l,endDate:t}=this.data;let s=[];if(!(["years","year"].includes(this.view.id)&&!this.options.eventsCountOnYearView)){if(s=this.view.events.slice(0),this.view.id==="month"&&s.push(...this.view.outOfScopeEvents),s=s.filter(i=>this.utils.event.eventInRange(i,l,t)),this.options.showAllDayEvents&&this.view.id!=="month"&&(s=s.filter(i=>!!i.allDay===this.allDay)),this.options.time&&this.isWeekOrDayView&&!this.allDay){const{timeFrom:i,timeTo:n}=this.options;s=s.filter(a=>{const u=a.daysCount>1&&a.segments[this.data.formattedDate]||{},d=a.daysCount===1&&a.startTimeMinutes<n&&a.endTimeMinutes>i,c=a.daysCount>1&&u.startTimeMinutes<n&&u.endTimeMinutes>i;return a.allDay||d||c||!1})}this.options.time&&this.isWeekOrDayView&&!(this.options.showAllDayEvents&&this.allDay)&&s.sort((i,n)=>i.start<n.start?-1:1),this.cellSplits.length||this.$nextTick(this.checkCellOverlappingEvents)}return s},eventsCount(){return this.events.length},splits(){return this.cellSplits.map((l,t)=>{const s=this.events.filter(a=>a.split===l.id),[i,n]=this.utils.event.checkCellOverlappingEvents(s.filter(a=>!a.background&&!a.allDay),this.options);return{...l,overlaps:i,overlapsStreak:n,events:s}})},splitsCount(){return this.splits.length},cellClasses(){return{[this.data.class]:!!this.data.class,"vuecal__cell--current":this.data.current,"vuecal__cell--today":this.data.today,"vuecal__cell--out-of-scope":this.data.outOfScope,"vuecal__cell--before-min":this.isDisabled&&this.isBeforeMinDate,"vuecal__cell--after-max":this.isDisabled&&this.isAfterMaxDate,"vuecal__cell--disabled":this.isDisabled,"vuecal__cell--selected":this.isSelected,"vuecal__cell--highlighted":this.highlighted,"vuecal__cell--has-splits":this.splitsCount,"vuecal__cell--has-events":this.eventsCount}},cellStyles(){return{...this.cellWidth?{width:`${this.cellWidth}%`}:{}}},timelineVisible(){const{time:l,timeTo:t}=this.options;return this.data.today&&this.isWeekOrDayView&&l&&!this.allDay&&this.nowInMinutes<=t},todaysTimePosition(){if(!this.data.today||!this.options.time)return;const l=this.nowInMinutes-this.options.timeFrom;return Math.round(l*this.timeScale)},timeScale(){return this.options.timeCellHeight/this.options.timeStep}}},wt=Le(gl,[["render",hl]]),yl={key:0,class:"vuecal__all-day-text",style:{width:"3em"}};function fl(l,t,s,i,n,a){const u=Me("vuecal-cell");return o(),r("div",{class:"vuecal__flex vuecal__all-day",style:we(s.cellOrSplitMinWidth&&{height:s.height})},[s.cellOrSplitMinWidth?D("",!0):(o(),r("div",yl,[e("span",null,g(s.label),1)])),e("div",{class:se(["vuecal__flex vuecal__cells",`${a.view.id}-view`]),grow:"",style:we(s.cellOrSplitMinWidth?`min-width: ${s.cellOrSplitMinWidth}px`:"")},[(o(!0),r(J,null,Q(s.cells,(d,c)=>(o(),le(u,{key:c,options:s.options,"edit-events":a.editEvents,data:d,"all-day":!0,"cell-width":s.options.hideWeekdays.length&&(a.vuecal.isWeekView||a.vuecal.isMonthView)&&a.vuecal.cellWidth,"min-timestamp":s.options.minTimestamp,"max-timestamp":s.options.maxTimestamp,"cell-splits":s.daySplits},{event:H(({event:m,view:p})=>[ie(l.$slots,"event",{view:p,event:m})]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],6)],4)}const bl={inject:["vuecal","view","editEvents"],components:{"vuecal-cell":wt},props:{options:{type:Object,required:!0},cells:{type:Array,required:!0},label:{type:String,required:!0},daySplits:{type:Array,default:()=>[]},shortEvents:{type:Boolean,default:!0},height:{type:String,default:""},cellOrSplitMinWidth:{type:Number,default:null}},computed:{hasCellOrSplitWidth(){return!!(this.options.minCellWidth||this.daySplits.length&&this.options.minSplitWidth)}}},wl=Le(bl,[["render",fl]]),_l=["lang"],xl={class:"default"},kl={key:0,class:"vuecal__flex vuecal__body",grow:""},Dl=["onBlur","innerHTML"],Cl=["innerHTML"],Tl=["innerHTML"],El={class:"vuecal__flex",row:"",grow:""},Sl={key:0,class:"vuecal__time-column"},Ml={class:"vuecal__time-cell-label"},jl={key:1,class:"vuecal__flex vuecal__week-numbers",column:""},$l=["wrap","column"],Vl=["onBlur","innerHTML"],Al=["innerHTML"],Ol=["innerHTML"],Il=["wrap"],Ll=["innerHTML"],Pl=["innerHTML"],Ul={key:2,class:"vuecal__cell-events-count"},Nl={key:3,class:"vuecal__no-event"},Rl=["onBlur","innerHTML"],Fl=["innerHTML"],Hl={key:2,class:"vuecal__event-time"},Bl={key:0},Wl={key:1,class:"days-to-end"},Yl=["innerHTML"],zl={key:0,class:"vuecal__scrollbar-check"};function ql(l,t,s,i,n,a){const u=Me("vuecal-header"),d=Me("all-day-bar"),c=Me("weekdays-headings"),m=Me("vuecal-cell");return o(),r("div",{class:se(["vuecal__flex vuecal",a.cssClasses]),column:"",ref:"vuecal",lang:s.locale},[v(u,{options:l.$props,"edit-events":a.editEvents,"view-props":{views:a.views,weekDaysInHeader:a.weekDaysInHeader},"week-days":a.weekDays,"has-splits":a.hasSplits,"day-splits":a.daySplits,"switch-to-narrower-view":a.switchToNarrowerView},Xe({"arrow-prev":H(()=>[ie(l.$slots,"arrow-prev",{},()=>[t[0]||(t[0]=z(" ")),t[1]||(t[1]=e("i",{class:"angle"},null,-1)),t[2]||(t[2]=z(" "))])]),"arrow-next":H(()=>[ie(l.$slots,"arrow-next",{},()=>[t[3]||(t[3]=z(" ")),t[4]||(t[4]=e("i",{class:"angle"},null,-1)),t[5]||(t[5]=z(" "))])]),"today-button":H(()=>[ie(l.$slots,"today-button",{},()=>[e("span",xl,g(n.texts.today),1)])]),title:H(()=>[ie(l.$slots,"title",{title:a.viewTitle,view:n.view},()=>[z(g(a.viewTitle),1)])]),_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:H(({heading:p,view:f})=>[ie(l.$slots,"weekday-heading",{heading:p,view:f})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:H(({split:p})=>[ie(l.$slots,"split-label",{split:p,view:n.view.id})]),key:"1"}:void 0]),1032,["options","edit-events","view-props","week-days","has-splits","day-splits","switch-to-narrower-view"]),s.hideBody?D("",!0):(o(),r("div",kl,[v(Ye,{name:`slide-fade--${n.transitionDirection}`,appear:s.transitions},{default:H(()=>[(o(),r("div",{class:"vuecal__flex",style:{"min-width":"100%"},key:s.transitions?n.view.id:!1,column:""},[s.showAllDayEvents&&a.hasTimeColumn&&(!a.cellOrSplitMinWidth||a.isDayView&&!s.minSplitWidth)?(o(),le(d,rt(dt({key:0},a.allDayBar)),{event:H(({event:p,view:f})=>[ie(l.$slots,"event",{view:f,event:p},()=>[a.editEvents.title&&p.titleEditable?(o(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:y=>a.onEventTitleBlur(y,p),innerHTML:p.title},null,40,Dl)):p.title?(o(),r("div",{key:1,class:"vuecal__event-title",innerHTML:p.title},null,8,Cl)):D("",!0),p.content&&!a.hasShortEvents&&!a.isShortMonthView?(o(),r("div",{key:2,class:"vuecal__event-content",innerHTML:p.content},null,8,Tl)):D("",!0)])]),_:3},16)):D("",!0),e("div",{class:se(["vuecal__bg",{vuecal__flex:!a.hasTimeColumn}]),column:""},[e("div",El,[a.hasTimeColumn?(o(),r("div",Sl,[s.showAllDayEvents&&a.cellOrSplitMinWidth&&!(a.isDayView&&!s.minSplitWidth)?(o(),r("div",{key:0,class:"vuecal__all-day-text",style:we({height:a.allDayBar.height})},[e("span",null,g(n.texts.allDay),1)],4)):D("",!0),(o(!0),r(J,null,Q(a.timeCells,(p,f)=>(o(),r("div",{class:"vuecal__time-cell",key:f,style:we(`height: ${s.timeCellHeight}px`)},[ie(l.$slots,"time-cell",{hours:p.hours,minutes:p.minutes},()=>[t[6]||(t[6]=e("span",{class:"vuecal__time-cell-line"},null,-1)),e("span",Ml,g(p.label),1)])],4))),128))])):D("",!0),s.showWeekNumbers&&a.isMonthView?(o(),r("div",jl,[(o(),r(J,null,Q(6,p=>e("div",{class:"vuecal__flex vuecal__week-number-cell",key:p,grow:""},[ie(l.$slots,"week-number-cell",{week:a.getWeekNumber(p-1)},()=>[z(g(a.getWeekNumber(p-1)),1)])])),64))])):D("",!0),e("div",{class:se(["vuecal__flex vuecal__cells",`${n.view.id}-view`]),grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,column:!!a.cellOrSplitMinWidth},[a.cellOrSplitMinWidth&&a.isWeekView?(o(),le(c,{key:0,"transition-direction":n.transitionDirection,"week-days":a.weekDays,"switch-to-narrower-view":a.switchToNarrowerView,style:we(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:H(({heading:p,view:f})=>[ie(l.$slots,"weekday-heading",{heading:p,view:f})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:H(({split:p})=>[ie(l.$slots,"split-label",{split:p,view:n.view.id})]),key:"1"}:void 0]),1032,["transition-direction","week-days","switch-to-narrower-view","style"])):a.hasSplits&&s.stickySplitLabels&&s.minSplitWidth?(o(),r("div",{key:1,class:"vuecal__flex vuecal__split-days-headers",style:we(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(o(!0),r(J,null,Q(a.daySplits,(p,f)=>(o(),r("div",{class:se(["day-split-header",p.class||!1]),key:f},[ie(l.$slots,"split-label",{split:p,view:n.view.id},()=>[z(g(p.label),1)])],2))),128))],4)):D("",!0),s.showAllDayEvents&&a.hasTimeColumn&&(a.isWeekView&&a.cellOrSplitMinWidth||a.isDayView&&a.hasSplits&&s.minSplitWidth)?(o(),le(d,rt(dt({key:2},a.allDayBar)),{event:H(({event:p,view:f})=>[ie(l.$slots,"event",{view:f,event:p},()=>[a.editEvents.title&&p.titleEditable?(o(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:y=>a.onEventTitleBlur(y,p),innerHTML:p.title},null,40,Vl)):p.title?(o(),r("div",{key:1,class:"vuecal__event-title",innerHTML:p.title},null,8,Al)):D("",!0),p.content&&!a.hasShortEvents&&!a.isShortMonthView?(o(),r("div",{key:2,class:"vuecal__event-content",innerHTML:p.content},null,8,Ol)):D("",!0)])]),_:3},16)):D("",!0),e("div",{class:"vuecal__flex",ref:p=>n.cellsEl=p,grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,style:we(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(o(!0),r(J,null,Q(a.viewCells,(p,f)=>(o(),le(m,{key:f,options:l.$props,"edit-events":a.editEvents,data:p,"cell-width":s.hideWeekdays.length&&(a.isWeekView||a.isMonthView)&&a.cellWidth,"min-timestamp":a.minTimestamp,"max-timestamp":a.maxTimestamp,"cell-splits":a.hasSplits&&a.daySplits||[]},{"cell-content":H(({events:y,split:T,selectCell:C})=>[ie(l.$slots,"cell-content",{cell:p,view:n.view,goNarrower:C,events:y},()=>[T&&!s.stickySplitLabels?(o(),r("div",{key:0,class:"split-label",innerHTML:T.label},null,8,Ll)):D("",!0),p.content?(o(),r("div",{key:1,class:"vuecal__cell-date",innerHTML:p.content},null,8,Pl)):D("",!0),(a.isMonthView&&!s.eventsOnMonthView||a.isYearsOrYearView&&s.eventsCountOnYearView)&&y.length?(o(),r("div",Ul,[ie(l.$slots,"events-count",{view:n.view,events:y},()=>[z(g(y.length),1)])])):D("",!0),!a.cellOrSplitHasEvents(y,T)&&a.isWeekOrDayView?(o(),r("div",Nl,[ie(l.$slots,"no-event",{},()=>[z(g(n.texts.noEvent),1)])])):D("",!0)])]),event:H(({event:y,view:T})=>[ie(l.$slots,"event",{view:T,event:y},()=>[a.editEvents.title&&y.titleEditable?(o(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:C=>a.onEventTitleBlur(C,y),innerHTML:y.title},null,40,Rl)):y.title?(o(),r("div",{key:1,class:"vuecal__event-title",innerHTML:y.title},null,8,Fl)):D("",!0),s.time&&!y.allDay&&!(a.isMonthView&&(y.allDay||s.showAllDayEvents==="short"))&&!a.isShortMonthView?(o(),r("div",Hl,[z(g(n.utils.date.formatTime(y.start,a.TimeFormat)),1),y.endTimeMinutes?(o(),r("span",Bl," - "+g(n.utils.date.formatTime(y.end,a.TimeFormat,null,!0)),1)):D("",!0),y.daysCount>1&&(y.segments[p.formattedDate]||{}).isFirstDay?(o(),r("small",Wl," +"+g(y.daysCount-1)+g((n.texts.day[0]||"").toLowerCase()),1)):D("",!0)])):D("",!0),y.content&&!(a.isMonthView&&y.allDay&&s.showAllDayEvents==="short")&&!a.isShortMonthView?(o(),r("div",{key:3,class:"vuecal__event-content",innerHTML:y.content},null,8,Yl)):D("",!0)])]),"no-event":H(()=>[ie(l.$slots,"no-event",{},()=>[z(g(n.texts.noEvent),1)])]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],12,Il)],10,$l)])],2)]))]),_:3},8,["name","appear"]),n.ready?D("",!0):(o(),r("div",zl,t[7]||(t[7]=[e("div",null,null,-1)])))]))],10,_l)}const Re=1440,We={weekDays:Array(7).fill(""),weekDaysShort:[],months:Array(12).fill(""),years:"",year:"",month:"",week:"",day:"",today:"",noEvent:"",allDay:"",deleteEvent:"",createEvent:"",dateFormat:"dddd MMMM D, YYYY",am:"am",pm:"pm"},vt=["years","year","month","week","day"],pt=new Os(We),Gl={name:"vue-cal",components:{"vuecal-cell":wt,"vuecal-header":il,WeekdaysHeadings:bt,AllDayBar:wl},provide(){return{vuecal:this,utils:this.utils,modules:this.modules,previous:this.previous,next:this.next,switchView:this.switchView,updateSelectedDate:this.updateSelectedDate,editEvents:this.editEvents,view:this.view,domEvents:this.domEvents}},props:{activeView:{type:String,default:"week"},allDayBarHeight:{type:[String,Number],default:"25px"},cellClickHold:{type:Boolean,default:!0},cellContextmenu:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:!1},dblclickToNavigate:{type:Boolean,default:!0},disableDatePrototypes:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},disableViews:{type:Array,default:()=>[]},dragToCreateEvent:{type:Boolean,default:!0},dragToCreateThreshold:{type:Number,default:15},editableEvents:{type:[Boolean,Object],default:!1},events:{type:Array,default:()=>[]},eventsCountOnYearView:{type:Boolean,default:!1},eventsOnMonthView:{type:[Boolean,String],default:!1},hideBody:{type:Boolean,default:!1},hideTitleBar:{type:Boolean,default:!1},hideViewSelector:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:[String,Object],default:"en"},maxDate:{type:[String,Date],default:""},minCellWidth:{type:Number,default:0},minDate:{type:[String,Date],default:""},minEventWidth:{type:Number,default:0},minSplitWidth:{type:Number,default:0},onEventClick:{type:[Function,null],default:null},onEventCreate:{type:[Function,null],default:null},onEventDblclick:{type:[Function,null],default:null},overlapsPerTimeStep:{type:Boolean,default:!1},resizeX:{type:Boolean,default:!1},selectedDate:{type:[String,Date],default:""},showAllDayEvents:{type:[Boolean,String],default:!1},showTimeInCells:{type:Boolean,default:!1},showWeekNumbers:{type:[Boolean,String],default:!1},snapToTime:{type:Number,default:0},small:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},splitDays:{type:Array,default:()=>[]},startWeekOnSunday:{type:Boolean,default:!1},stickySplitLabels:{type:Boolean,default:!1},time:{type:Boolean,default:!0},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:Re},todayButton:{type:Boolean,default:!1},transitions:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},watchRealTime:{type:Boolean,default:!1},xsmall:{type:Boolean,default:!1}},data(){return{ready:!1,texts:{...We},utils:{date:(this.disableDatePrototypes?pt.removePrototypes():!1)||pt,cell:null,event:null},modules:{dnd:null},cellsEl:null,view:{id:"",title:"",startDate:null,endDate:null,firstCellDate:null,lastCellDate:null,selectedDate:null,events:[]},eventIdIncrement:1,now:new Date,timeTickerIds:[null,null],domEvents:{resizeAnEvent:{_eid:null,start:null,split:null,segment:null,originalEndTimeMinutes:0,originalEnd:null,end:null,startCell:null,endCell:null},dragAnEvent:{_eid:null},dragCreateAnEvent:{startCursorY:null,start:null,split:null,event:null},focusAnEvent:{_eid:null,mousedUp:!1},clickHoldAnEvent:{_eid:null,timeout:1200,timeoutId:null},dblTapACell:{taps:0,timeout:500},clickHoldACell:{cellId:null,split:null,timeout:1200,timeoutId:null,eventCreated:!1},cancelClickEventCreation:!1},mutableEvents:[],transitionDirection:"right"}},methods:{async loadLocale(l){if(typeof this.locale=="object"){this.texts=Object.assign({},We,l),this.utils.date.updateTexts(this.texts);return}const t=await As(Object.assign({"./i18n/ar.json":()=>Z(()=>import("./ar.es-bitOgb9K.js"),[]),"./i18n/bg.json":()=>Z(()=>import("./bg.es-5tp0KQRo.js"),[]),"./i18n/bn.json":()=>Z(()=>import("./bn.es-C_qR0y0-.js"),[]),"./i18n/bs.json":()=>Z(()=>import("./bs.es-DduooXS8.js"),[]),"./i18n/ca.json":()=>Z(()=>import("./ca.es-DYDNDJFJ.js"),[]),"./i18n/cs.json":()=>Z(()=>import("./cs.es-CvnAvfoI.js"),[]),"./i18n/da.json":()=>Z(()=>import("./da.es-C_eJXDX3.js"),[]),"./i18n/de.json":()=>Z(()=>import("./de.es-Cp-R9E16.js"),[]),"./i18n/el.json":()=>Z(()=>import("./el.es-BZ44a1Tb.js"),[]),"./i18n/en.json":()=>Z(()=>import("./en.es-DwVNOttH.js"),[]),"./i18n/es.json":()=>Z(()=>import("./es.es-DO8PaQ_q.js"),[]),"./i18n/et.json":()=>Z(()=>import("./et.es-DdRIcUrz.js"),[]),"./i18n/fa.json":()=>Z(()=>import("./fa.es-XN0av8Tx.js"),[]),"./i18n/fi.json":()=>Z(()=>import("./fi.es-B0Iy6aas.js"),[]),"./i18n/fr.json":()=>Z(()=>import("./fr.es-B7WXlprl.js"),[]),"./i18n/he.json":()=>Z(()=>import("./he.es-BWEk5prp.js"),[]),"./i18n/hr.json":()=>Z(()=>import("./hr.es-B_iqHQyr.js"),[]),"./i18n/hu.json":()=>Z(()=>import("./hu.es-D_t4Ibxf.js"),[]),"./i18n/id.json":()=>Z(()=>import("./id.es-CzHAK-XV.js"),[]),"./i18n/is.json":()=>Z(()=>import("./is.es-DChRpym4.js"),[]),"./i18n/it.json":()=>Z(()=>import("./it.es-CquQA5xx.js"),[]),"./i18n/ja.json":()=>Z(()=>import("./ja.es-B19gsG6H.js"),[]),"./i18n/ka.json":()=>Z(()=>import("./ka.es-CuOe65jc.js"),[]),"./i18n/ko.json":()=>Z(()=>import("./ko.es-CsMl2USK.js"),[]),"./i18n/lt.json":()=>Z(()=>import("./lt.es-vqgjGyMx.js"),[]),"./i18n/mn.json":()=>Z(()=>import("./mn.es-BmdwFdas.js"),[]),"./i18n/nl.json":()=>Z(()=>import("./nl.es-CFxVMCWy.js"),[]),"./i18n/no.json":()=>Z(()=>import("./no.es-qRcuRMwl.js"),[]),"./i18n/pl.json":()=>Z(()=>import("./pl.es-BQ3a0ltx.js"),[]),"./i18n/pt-br.json":()=>Z(()=>import("./pt-br.es-U9bVHsgs.js"),[]),"./i18n/pt-pt.json":()=>Z(()=>import("./pt-pt.es-U9bVHsgs.js"),[]),"./i18n/ro.json":()=>Z(()=>import("./ro.es-ldjMjt3l.js"),[]),"./i18n/ru.json":()=>Z(()=>import("./ru.es-CS-QKsYL.js"),[]),"./i18n/sk.json":()=>Z(()=>import("./sk.es-CAe8sEvL.js"),[]),"./i18n/sl.json":()=>Z(()=>import("./sl.es-rdzOxu_X.js"),[]),"./i18n/sq.json":()=>Z(()=>import("./sq.es-BY5E06HI.js"),[]),"./i18n/sr.json":()=>Z(()=>import("./sr.es-QPseRVBy.js"),[]),"./i18n/sv.json":()=>Z(()=>import("./sv.es-BfPUYcV1.js"),[]),"./i18n/tr.json":()=>Z(()=>import("./tr.es-Cl6kz_IH.js"),[]),"./i18n/uk.json":()=>Z(()=>import("./uk.es-DBEtNQnZ.js"),[]),"./i18n/vi.json":()=>Z(()=>import("./vi.es-Bx2g_1jx.js"),[]),"./i18n/zh-cn.json":()=>Z(()=>import("./zh-cn.es-BWMmCH-R.js"),[]),"./i18n/zh-hk.json":()=>Z(()=>import("./zh-hk.es-DFZ0bKvi.js"),[])}),`./i18n/${l}.json`,3);this.texts=Object.assign({},We,t),this.utils.date.updateTexts(this.texts)},loadDragAndDrop(){Z(()=>import("./drag-and-drop.es-CbCm7IHa.js"),[]).then(l=>{const{DragAndDrop:t}=l;this.modules.dnd=new t(this)}).catch(()=>console.warn("Vue Cal: Missing drag & drop module."))},validateView(l){return vt.includes(l)||(console.error(`Vue Cal: invalid active-view parameter provided: "${l}".
A valid view must be one of: ${vt.join(", ")}.`),l="week"),this.enabledViews.includes(l)||(console.warn(`Vue Cal: the provided active-view "${l}" is disabled. Using the "${this.enabledViews[0]}" view instead.`),l=this.enabledViews[0]),l},switchToNarrowerView(l=null){this.transitionDirection="right";const t=this.enabledViews[this.enabledViews.indexOf(this.view.id)+1];t&&this.switchView(t,l)},switchView(l,t=null,s=!1){l=this.validateView(l);const i=this.utils.date,n=this.view.startDate&&this.view.startDate.getTime();if(this.transitions&&s){if(this.view.id===l)return;const d=this.enabledViews;this.transitionDirection=d.indexOf(this.view.id)>d.indexOf(l)?"left":"right"}const a=this.view.id;switch(this.view.events=[],this.view.id=l,this.view.firstCellDate=null,this.view.lastCellDate=null,t||(t=this.view.selectedDate||this.view.startDate),l){case"years":{this.view.startDate=new Date(Math.floor(t.getFullYear()/25)*25||2e3,0,1),this.view.endDate=new Date(this.view.startDate.getFullYear()+25,0,1),this.view.endDate.setSeconds(-1);break}case"year":{this.view.startDate=new Date(t.getFullYear(),0,1),this.view.endDate=new Date(t.getFullYear()+1,0,1),this.view.endDate.setSeconds(-1);break}case"month":{this.view.startDate=new Date(t.getFullYear(),t.getMonth(),1),this.view.endDate=new Date(t.getFullYear(),t.getMonth()+1,1),this.view.endDate.setSeconds(-1);let d=new Date(this.view.startDate);if(d.getDay()!==(this.startWeekOnSunday?0:1)&&(d=i.getPreviousFirstDayOfWeek(d,this.startWeekOnSunday)),this.view.firstCellDate=d,this.view.lastCellDate=i.addDays(d,41),this.view.lastCellDate.setHours(23,59,59,0),this.hideWeekends){if([0,6].includes(this.view.firstCellDate.getDay())){const c=this.view.firstCellDate.getDay()===6&&!this.startWeekOnSunday?2:1;this.view.firstCellDate=i.addDays(this.view.firstCellDate,c)}if([0,6].includes(this.view.startDate.getDay())){const c=this.view.startDate.getDay()===6?2:1;this.view.startDate=i.addDays(this.view.startDate,c)}if([0,6].includes(this.view.lastCellDate.getDay())){const c=this.view.lastCellDate.getDay()===0&&!this.startWeekOnSunday?2:1;this.view.lastCellDate=i.subtractDays(this.view.lastCellDate,c)}if([0,6].includes(this.view.endDate.getDay())){const c=this.view.endDate.getDay()===0?2:1;this.view.endDate=i.subtractDays(this.view.endDate,c)}}break}case"week":{t=i.getPreviousFirstDayOfWeek(t,this.startWeekOnSunday);const d=this.hideWeekends?5:7;this.view.startDate=this.hideWeekends&&this.startWeekOnSunday?i.addDays(t,1):t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=i.addDays(t,d),this.view.endDate.setSeconds(-1);break}case"day":{this.view.startDate=t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=new Date(t),this.view.endDate.setHours(23,59,59,0);break}}this.addEventsToView();const u=this.view.startDate&&this.view.startDate.getTime();if(!(a===l&&u===n)&&(this.$emit("update:activeView",l),this.ready)){const d=this.view.startDate,c={view:l,startDate:d,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate,outOfScopeEvents:this.view.outOfScopeEvents.map(this.cleanupEvent)}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:i.getWeek(this.startWeekOnSunday?i.addDays(d,1):d)}:{}};this.$emit("view-change",c)}},previous(){this.previousNext(!1)},next(){this.previousNext()},previousNext(l=!0){const t=this.utils.date;this.transitionDirection=l?"right":"left";const s=l?1:-1;let i=null;const{startDate:n,id:a}=this.view;switch(a){case"years":i=new Date(n.getFullYear()+25*s,0,1);break;case"year":i=new Date(n.getFullYear()+1*s,1,1);break;case"month":i=new Date(n.getFullYear(),n.getMonth()+1*s,1);break;case"week":i=t[l?"addDays":"subtractDays"](t.getPreviousFirstDayOfWeek(n,this.startWeekOnSunday),7);break;case"day":i=t[l?"addDays":"subtractDays"](n,1);const u=i.getDay(),d=this.startWeekOnSunday?u:(u||7)-1;if(this.weekDays[d].hide){const m=this.weekDays.map((f,y)=>({...f,i:y}));let p=0;l?([...m.slice(d),...m].find(f=>(p++,!f.hide)).i,p--):[...m,...m.slice(0,d)].reverse().find(f=>(p++,!f.hide)).i,i=t[l?"addDays":"subtractDays"](i,p)}break}i&&this.switchView(a,i)},addEventsToView(l=[]){const t=this.utils.event,{startDate:s,endDate:i,firstCellDate:n,lastCellDate:a}=this.view;if(l.length||(this.view.events=[]),l=l.length?l:[...this.mutableEvents],!l||this.isYearsOrYearView&&!this.eventsCountOnYearView)return;let u=l.filter(d=>t.eventInRange(d,s,i));!this.isYearsOrYearView&&!(this.isMonthView&&!this.eventsOnMonthView)&&(u=u.map(d=>d.daysCount>1?t.createEventSegments(d,n||s,a||i):d)),this.view.events.push(...u),this.isMonthView&&(this.view.outOfScopeEvents=[],l.forEach(d=>{(t.eventInRange(d,n,s)||t.eventInRange(d,i,a))&&(this.view.events.some(c=>c._eid===d._eid)||this.view.outOfScopeEvents.push(d))}))},findAncestor(l,t){for(;(l=l.parentElement)&&!l.classList.contains(t););return l},isDOMElementAnEvent(l){return l.classList.contains("vuecal__event")||this.findAncestor(l,"vuecal__event")},onMouseMove(l){const{resizeAnEvent:t,dragAnEvent:s,dragCreateAnEvent:i}=this.domEvents;t._eid===null&&s._eid===null&&!i.start||(l.preventDefault(),t._eid?this.eventResizing(l):this.dragToCreateEvent&&i.start&&this.eventDragCreation(l))},onMouseUp(l){const{focusAnEvent:t,resizeAnEvent:s,clickHoldAnEvent:i,clickHoldACell:n,dragCreateAnEvent:a}=this.domEvents,{_eid:u}=i,{_eid:d}=s;let c=!1;const{event:m,start:p}=a,f=this.isDOMElementAnEvent(l.target),y=t.mousedUp;if(t.mousedUp=!1,f&&(this.domEvents.cancelClickEventCreation=!0),n.eventCreated)return;if(d){const{originalEnd:C,originalEndTimeMinutes:S,endTimeMinutes:h}=s,x=this.view.events.find(N=>N._eid===s._eid);if(c=h&&h!==S,x&&x.end.getTime()!==C.getTime()){const N=this.mutableEvents.find(w=>w._eid===s._eid);N.endTimeMinutes=x.endTimeMinutes,N.end=x.end;const A=this.cleanupEvent(x),V={...this.cleanupEvent(x),end:C,endTimeMinutes:x.originalEndTimeMinutes};this.$emit("event-duration-change",{event:A,oldDate:s.originalEnd,originalEvent:V}),this.$emit("event-change",{event:A,originalEvent:V})}x&&(x.resizing=!1),s._eid=null,s.start=null,s.split=null,s.segment=null,s.originalEndTimeMinutes=null,s.originalEnd=null,s.endTimeMinutes=null,s.startCell=null,s.endCell=null}else p&&(m&&(this.emitWithEvent("event-drag-create",m),a.event.resizing=!1),a.start=null,a.split=null,a.event=null);!f&&!d&&this.unfocusEvent(),i.timeoutId&&!u&&(clearTimeout(i.timeoutId),i.timeoutId=null),n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=null);const T=typeof this.onEventClick=="function";if(y&&!c&&!u&&!m&&T){let C=this.view.events.find(S=>S._eid===t._eid);return!C&&this.isMonthView&&(C=this.view.outOfScopeEvents.find(S=>S._eid===t._eid)),C&&this.onEventClick(C,l)}},onKeyUp(l){l.keyCode===27&&this.cancelDelete()},eventResizing(l){const{resizeAnEvent:t}=this.domEvents,s=this.view.events.find(m=>m._eid===t._eid)||{segments:{}},{minutes:i,cursorCoords:n}=this.minutesAtCursor(l),a=s.segments&&s.segments[t.segment],{date:u,event:d}=this.utils,c=Math.max(i,this.timeFrom+1,(a||s).startTimeMinutes+1);if(s.endTimeMinutes=t.endTimeMinutes=c,this.snapToTime){const m=s.endTimeMinutes+this.snapToTime/2;s.endTimeMinutes=m-m%this.snapToTime}if(a&&(a.endTimeMinutes=s.endTimeMinutes),s.end.setHours(0,s.endTimeMinutes,s.endTimeMinutes===Re?-1:0,0),this.resizeX&&this.isWeekView){s.daysCount=u.countDays(s.start,s.end);const m=this.cellsEl,p=m.offsetWidth/m.childElementCount,f=Math.floor(n.x/p);if(t.startCell===null&&(t.startCell=f-(s.daysCount-1)),t.endCell!==f){t.endCell=f;const y=u.addDays(s.start,f-t.startCell),T=Math.max(u.countDays(s.start,y),1);if(T!==s.daysCount){let C=null;T>s.daysCount?C=d.addEventSegment(s):C=d.removeEventSegment(s),t.segment=C,s.endTimeMinutes+=.001}}}this.$emit("event-resizing",{_eid:s._eid,end:s.end,endTimeMinutes:s.endTimeMinutes})},eventDragCreation(l){const{dragCreateAnEvent:t}=this.domEvents,{start:s,startCursorY:i,split:n}=t,a=new Date(s),{minutes:u,cursorCoords:{y:d}}=this.minutesAtCursor(l);if(!(!t.event&&Math.abs(i-d)<this.dragToCreateThreshold))if(t.event){if(a.setHours(0,u,u===Re?-1:0,0),this.snapToTime){let p=a.getHours()*60+a.getMinutes();const f=p+this.snapToTime/2;p=f-f%this.snapToTime,a.setHours(0,p,0,0)}const c=s<a,{event:m}=t;m.start=c?s:a,m.end=c?a:s,m.startTimeMinutes=m.start.getHours()*60+m.start.getMinutes(),m.endTimeMinutes=m.end.getHours()*60+m.end.getMinutes()}else{if(t.event=this.utils.event.createAnEvent(s,1,{split:n}),!t.event){t.start=null,t.split=null,t.event=null;return}t.event.resizing=!0}},unfocusEvent(){const{focusAnEvent:l,clickHoldAnEvent:t}=this.domEvents,s=this.view.events.find(i=>i._eid===(l._eid||t._eid));l._eid=null,t._eid=null,s&&(s.focused=!1,s.deleting=!1)},cancelDelete(){const{clickHoldAnEvent:l}=this.domEvents;if(l._eid){const t=this.view.events.find(s=>s._eid===l._eid);t&&(t.deleting=!1),l._eid=null,l.timeoutId=null}},onEventTitleBlur(l,t){if(t.title===l.target.innerHTML)return;const s=t.title;t.title=l.target.innerHTML;const i=this.cleanupEvent(t);this.$emit("event-title-change",{event:i,oldTitle:s}),this.$emit("event-change",{event:i,originalEvent:{...i,title:s}})},updateMutableEvents(){const l=this.utils.date;this.mutableEvents=[],this.events.forEach(t=>{const s=typeof t.start=="string"?l.stringToDate(t.start):t.start,i=l.formatDateLite(s),n=l.dateToMinutes(s);let a=null;typeof t.end=="string"&&t.end.includes("24:00")?(a=new Date(t.end.replace(" 24:00","")),a.setHours(23,59,59,0)):a=typeof t.end=="string"?l.stringToDate(t.end):t.end;let u=l.formatDateLite(a),d=l.dateToMinutes(a);(!d||d===Re)&&(!this.time||typeof t.end=="string"&&t.end.length===10?a.setHours(23,59,59,0):a.setSeconds(a.getSeconds()-1),u=l.formatDateLite(a),d=Re);const c=i!==u;t=Object.assign({...this.utils.event.eventDefaults},t,{_eid:`${this._.uid}_${this.eventIdIncrement++}`,segments:c?{}:null,start:s,startTimeMinutes:n,end:a,endTimeMinutes:d,daysCount:c?l.countDays(s,a):1,class:t.class}),this.mutableEvents.push(t)})},minutesAtCursor(l){return this.utils.cell.minutesAtCursor(l)},createEvent(l,t,s={}){return this.utils.event.createAnEvent(l,t,s)},cleanupEvent(l){return l={...l},["segments","deletable","deleting","titleEditable","resizable","resizing","draggable","dragging","draggingStatic","focused"].forEach(s=>{s in l&&delete l[s]}),l.repeat||delete l.repeat,l},emitWithEvent(l,t){this.$emit(l,this.cleanupEvent(t))},updateSelectedDate(l){if(l&&typeof l=="string"?l=this.utils.date.stringToDate(l):l=new Date(l),l&&l instanceof Date){const{selectedDate:t}=this.view;t&&(this.transitionDirection=t.getTime()>l.getTime()?"left":"right"),l.setHours(0,0,0,0),(!t||t.getTime()!==l.getTime())&&(this.view.selectedDate=l),this.switchView(this.view.id)}this.$emit("update:selected-date",this.view.selectedDate)},getWeekNumber(l){const t=this.utils.date,i=this.firstCellDateWeekNumber+l,n=this.startWeekOnSunday?1:0;return i>52?t.getWeek(t.addDays(this.view.firstCellDate,7*l+n)):i},timeTick(){this.now=new Date,this.timeTickerIds[1]=setTimeout(this.timeTick,60*1e3)},updateDateTexts(){this.utils.date.updateTexts(this.texts)},alignWithScrollbar(){if(document.getElementById("vuecal-align-with-scrollbar"))return;const l=this.$refs.vuecal.getElementsByClassName("vuecal__scrollbar-check")[0],t=l.offsetWidth-l.children[0].offsetWidth;if(t){const s=document.createElement("style");s.id="vuecal-align-with-scrollbar",s.type="text/css",s.innerHTML=`.vuecal--view-with-time .vuecal__weekdays-headings,.vuecal--view-with-time .vuecal__all-day {padding-right: ${t}px}`,document.head.appendChild(s)}},cellOrSplitHasEvents(l,t=null){return l.length&&(!t&&l.length||t&&l.some(s=>s.split===t.id))}},created(){this.utils.cell=new Ls(this),this.utils.event=new Us(this,this.utils.date),this.loadLocale(this.locale),this.editEvents.drag&&this.loadDragAndDrop(),this.updateMutableEvents(this.events),this.view.id=this.currentView,this.selectedDate?this.updateSelectedDate(this.selectedDate):(this.view.selectedDate=new Date,this.switchView(this.currentView)),this.time&&this.watchRealTime&&(this.timeTickerIds[0]=setTimeout(this.timeTick,(60-this.now.getSeconds())*1e3))},mounted(){const l=this.utils.date,t="ontouchstart"in window,{resize:s,drag:i,create:n,delete:a,title:u}=this.editEvents,d=this.onEventClick&&typeof this.onEventClick=="function";(s||i||n||a||u||d)&&window.addEventListener(t?"touchend":"mouseup",this.onMouseUp),(s||i||n&&this.dragToCreateEvent)&&window.addEventListener(t?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),u&&window.addEventListener("keyup",this.onKeyUp),t&&(this.$refs.vuecal.oncontextmenu=function(p){p.preventDefault(),p.stopPropagation()}),this.hideBody||this.alignWithScrollbar();const c=this.view.startDate,m={view:this.view.id,startDate:c,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:l.getWeek(this.startWeekOnSunday?l.addDays(c,1):c)}:{}};this.$emit("ready",m),this.ready=!0},beforeUnmount(){const l="ontouchstart"in window;window.removeEventListener(l?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),window.removeEventListener(l?"touchend":"mouseup",this.onMouseUp),window.removeEventListener("keyup",this.onKeyUp),this.timeTickerIds[0]&&clearTimeout(this.timeTickerIds[0]),this.timeTickerIds[1]&&clearTimeout(this.timeTickerIds[1]),this.timeTickerIds=[null,null]},computed:{editEvents(){return this.editableEvents&&typeof this.editableEvents=="object"?{title:!!this.editableEvents.title,drag:!!this.editableEvents.drag,resize:!!this.editableEvents.resize,create:!!this.editableEvents.create,delete:!!this.editableEvents.delete}:{title:!!this.editableEvents,drag:!!this.editableEvents,resize:!!this.editableEvents,create:!!this.editableEvents,delete:!!this.editableEvents}},views(){return{years:{label:this.texts.years,enabled:!this.disableViews.includes("years")},year:{label:this.texts.year,enabled:!this.disableViews.includes("year")},month:{label:this.texts.month,enabled:!this.disableViews.includes("month")},week:{label:this.texts.week,enabled:!this.disableViews.includes("week")},day:{label:this.texts.day,enabled:!this.disableViews.includes("day")}}},currentView(){return this.validateView(this.activeView)},enabledViews(){return Object.keys(this.views).filter(l=>this.views[l].enabled)},hasTimeColumn(){return this.time&&this.isWeekOrDayView},isShortMonthView(){return this.isMonthView&&this.eventsOnMonthView==="short"},firstCellDateWeekNumber(){const l=this.utils.date,t=this.view.firstCellDate;return l.getWeek(this.startWeekOnSunday?l.addDays(t,1):t)},timeCells(){const l=[];for(let t=this.timeFrom,s=this.timeTo;t<s;t+=this.timeStep)l.push({hours:Math.floor(t/60),minutes:t%60,label:this.utils.date.formatTime(t,this.TimeFormat),value:t});return l},TimeFormat(){return this.timeFormat||(this.twelveHour?"h:mm{am}":"HH:mm")},daySplits(){return(this.splitDays.filter(l=>!l.hide)||[]).map((l,t)=>({...l,id:l.id||t+1}))},hasSplits(){return this.daySplits.length&&this.isWeekOrDayView},hasShortEvents(){return this.showAllDayEvents==="short"},cellOrSplitMinWidth(){let l=null;return this.hasSplits&&this.minSplitWidth?l=this.visibleDaysCount*this.minSplitWidth*this.daySplits.length:this.minCellWidth&&this.isWeekView&&(l=this.visibleDaysCount*this.minCellWidth),l},allDayBar(){let l=this.allDayBarHeight||null;return l&&!isNaN(l)&&(l+="px"),{cells:this.viewCells,options:this.$props,label:this.texts.allDay,shortEvents:this.hasShortEvents,daySplits:this.hasSplits&&this.daySplits||[],cellOrSplitMinWidth:this.cellOrSplitMinWidth,height:l}},minTimestamp(){let l=null;return this.minDate&&typeof this.minDate=="string"?l=this.utils.date.stringToDate(this.minDate):this.minDate&&this.minDate instanceof Date&&(l=this.minDate),l?l.getTime():null},maxTimestamp(){let l=null;return this.maxDate&&typeof this.maxDate=="string"?l=this.utils.date.stringToDate(this.maxDate):this.maxDate&&this.maxDate instanceof Date&&(l=this.maxDate),l?l.getTime():null},weekDays(){let{weekDays:l,weekDaysShort:t=[]}=this.texts;return l=l.slice(0).map((s,i)=>({label:s,...t.length?{short:t[i]}:{},hide:this.hideWeekends&&i>=5||this.hideWeekdays.length&&this.hideWeekdays.includes(i+1)})),this.startWeekOnSunday&&l.unshift(l.pop()),l},weekDaysInHeader(){return this.isMonthView||this.isWeekView&&!this.minCellWidth&&!(this.hasSplits&&this.minSplitWidth)},months(){return this.texts.months.map(l=>({label:l}))},specialDayHours(){return!this.specialHours||!Object.keys(this.specialHours).length?{}:Array(7).fill("").map((l,t)=>{let s=this.specialHours[t+1]||[];return Array.isArray(s)||(s=[s]),l=[],s.forEach(({from:i,to:n,class:a,label:u},d)=>{l[d]={day:t+1,from:[null,void 0].includes(i)?null:i*1,to:[null,void 0].includes(n)?null:n*1,class:a||"",label:u||""}}),l})},viewTitle(){const l=this.utils.date;let t="";const s=this.view.startDate,i=s.getFullYear(),n=s.getMonth();switch(this.view.id){case"years":{t=this.texts.years;break}case"year":{t=i;break}case"month":{t=`${this.months[n].label} ${i}`;break}case"week":{const a=this.view.endDate,u=s.getFullYear();let d=this.texts.months[s.getMonth()];this.xsmall&&(d=d.substring(0,3));let c=`${d} ${u}`;if(a.getMonth()!==s.getMonth()){const m=a.getFullYear();let p=this.texts.months[a.getMonth()];this.xsmall&&(p=p.substring(0,3)),u===m?c=`${d} - ${p} ${u}`:this.small?c=`${d.substring(0,3)} ${u} - ${p.substring(0,3)} ${m}`:c=`${d} ${u} - ${p} ${m}`}t=`${this.texts.week} ${l.getWeek(this.startWeekOnSunday?l.addDays(s,1):s)} (${c})`;break}case"day":{t=this.utils.date.formatDate(s,this.texts.dateFormat,this.texts);break}}return t},viewCells(){const l=this.utils.date;let t=[],s=null,i=!1;this.watchRealTime||(this.now=new Date);const n=this.now;switch(this.view.id){case"years":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(25)).map((a,u)=>{const d=new Date(s+u,0,1),c=new Date(s+u+1,0,1);return c.setSeconds(-1),{startDate:d,formattedDate:l.formatDateLite(d),endDate:c,content:s+u,current:s+u===n.getFullYear()}});break}case"year":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(12)).map((a,u)=>{const d=new Date(s,u,1),c=new Date(s,u+1,1);return c.setSeconds(-1),{startDate:d,formattedDate:l.formatDateLite(d),endDate:c,content:this.xsmall?this.months[u].label.substr(0,3):this.months[u].label,current:u===n.getMonth()&&s===n.getFullYear()}});break}case"month":{const a=this.view.startDate.getMonth(),u=new Date(this.view.firstCellDate);i=!1,t=Array.apply(null,Array(42)).map((d,c)=>{const m=l.addDays(u,c),p=new Date(m);p.setHours(23,59,59,0);const f=!i&&l.isToday(m)&&!i++;return{startDate:m,formattedDate:l.formatDateLite(m),endDate:p,content:m.getDate(),today:f,outOfScope:m.getMonth()!==a,class:`vuecal__cell--day${m.getDay()||7}`}}),(this.hideWeekends||this.hideWeekdays.length)&&(t=t.filter(d=>{const c=d.startDate.getDay()||7;return!(this.hideWeekends&&c>=6||this.hideWeekdays.length&&this.hideWeekdays.includes(c))}));break}case"week":{i=!1;const a=this.view.startDate,u=this.weekDays;t=u.map((d,c)=>{const m=l.addDays(a,this.startWeekOnSunday&&this.hideWeekends?c-1:c),p=new Date(m);p.setHours(23,59,59,0);const f=(m.getDay()||7)-1;return{startDate:m,formattedDate:l.formatDateLite(m),endDate:p,today:!i&&l.isToday(m)&&!i++,specialHours:this.specialDayHours[f]||[]}}).filter((d,c)=>!u[c].hide);break}case"day":{const a=this.view.startDate,u=new Date(this.view.startDate);u.setHours(23,59,59,0);const d=(a.getDay()||7)-1;t=[{startDate:a,formattedDate:l.formatDateLite(a),endDate:u,today:l.isToday(a),specialHours:this.specialDayHours[d]||[]}];break}}return t},visibleDaysCount(){return this.isDayView?1:7-this.weekDays.reduce((l,t)=>l+t.hide,0)},cellWidth(){return 100/this.visibleDaysCount},cssClasses(){const{resizeAnEvent:l,dragAnEvent:t,dragCreateAnEvent:s}=this.domEvents;return{[`vuecal--${this.view.id}-view`]:!0,[`vuecal--${this.locale}`]:this.locale,"vuecal--no-time":!this.time,"vuecal--view-with-time":this.hasTimeColumn,"vuecal--week-numbers":this.showWeekNumbers&&this.isMonthView,"vuecal--twelve-hour":this.twelveHour,"vuecal--click-to-navigate":this.clickToNavigate,"vuecal--hide-weekends":this.hideWeekends,"vuecal--split-days":this.hasSplits,"vuecal--sticky-split-labels":this.hasSplits&&this.stickySplitLabels,"vuecal--overflow-x":this.minCellWidth&&this.isWeekView||this.hasSplits&&this.minSplitWidth,"vuecal--small":this.small,"vuecal--xsmall":this.xsmall,"vuecal--resizing-event":l._eid,"vuecal--drag-creating-event":s.event,"vuecal--dragging-event":t._eid,"vuecal--events-on-month-view":this.eventsOnMonthView,"vuecal--short-events":this.isMonthView&&this.eventsOnMonthView==="short","vuecal--has-touch":typeof window<"u"&&"ontouchstart"in window}},isYearsOrYearView(){return["years","year"].includes(this.view.id)},isYearsView(){return this.view.id==="years"},isYearView(){return this.view.id==="year"},isMonthView(){return this.view.id==="month"},isWeekOrDayView(){return["week","day"].includes(this.view.id)},isWeekView(){return this.view.id==="week"},isDayView(){return this.view.id==="day"}},watch:{events:{handler(l,t){this.updateMutableEvents(l),this.addEventsToView()},deep:!0},locale(l){this.loadLocale(l)},selectedDate(l){this.updateSelectedDate(l)},activeView(l){this.switchView(l)}}},Kl=Le(Gl,[["render",ql]]),Jl={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Zl={class:"flex justify-between items-center mb-4"},Xl={class:"flex gap-3"},Ql={class:"flex rounded-md shadow-sm mr-3"},ea={key:0,class:"mb-4 bg-gray-50 p-4 rounded-lg"},ta={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},sa=["value"],la={class:"mt-1 relative rounded-md shadow-sm"},aa={key:1,class:"text-center text-gray-600 text-sm animate-pulse py-4"},ia={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md"},na={key:3},oa={key:0,class:"space-y-4"},ra={key:0,class:"flex justify-between"},da={class:"flex-grow"},ua={class:"text-sm text-red-500 italic"},ca={class:"flex items-center mt-1"},ma={class:"text-xs text-gray-500"},va={key:1},pa={class:"flex-grow"},ha={class:"flex justify-between items-center mb-3"},ga={class:"text-sm text-gray-600 bg-blue-100 px-2 py-1 rounded-full"},ya={class:"mb-3"},fa={class:"text-sm text-gray-700 ml-6"},ba={class:"mb-3"},wa={class:"text-sm text-gray-700 ml-6"},_a={class:"mb-2"},xa={class:"text-sm text-gray-700 ml-6"},ka={class:"flex items-center mt-3 pt-2 border-t border-blue-200"},Da={class:"text-xs text-gray-500"},Ca={key:1,class:"text-gray-400 text-sm"},Ta={key:4,class:"mt-4"},Ea={class:"flex justify-between items-center mb-6"},Sa={class:"text-lg font-medium text-gray-900"},Ma=["innerHTML"],ja=["innerHTML"],$a={key:0,class:"mt-1 text-xs p-1 rounded bg-red-50 border-l-2 border-red-500 text-red-700"},Va={class:"mt-6 bg-white rounded-lg shadow p-4"},Aa={key:0},Oa={class:"font-medium text-gray-800 mb-2"},Ia={class:"font-medium text-blue-800"},La={class:"text-sm text-gray-600 mt-1"},Pa={key:1,class:"text-gray-500 text-sm"},Ua={__name:"DailyStandups",props:{projectId:{type:Number,required:!0},users:{type:Array,default:()=>[]}},emits:["standupAdded"],setup(l,{emit:t}){const s=l,i=_("list"),n=_(!1),a=_(!1),u=_(""),d=_([]),c=_(""),m=Ce({startDate:"",endDate:"",search:"",userId:""}),p=E=>{const k=oe(E);return k.isValid()?{start:k.clone().startOf("month").format("YYYY-MM-DD"),end:k.clone().endOf("month").format("YYYY-MM-DD")}:(console.warn("getMonthRange received an invalid input, defaulting to current date:",E),{start:oe().startOf("month").format("YYYY-MM-DD"),end:oe().endOf("month").format("YYYY-MM-DD")})};let f=null;const y=()=>{clearTimeout(f),f=setTimeout(()=>{C()},500)},T=async()=>{a.value=!0,u.value="";try{const E=new URLSearchParams;m.startDate&&E.append("start_date",m.startDate),m.endDate&&E.append("end_date",m.endDate),m.search&&E.append("search",m.search),m.userId&&E.append("user_id",String(m.userId));const k=E.toString(),O=`/api/projects/${s.projectId}/sections/notes?type=standup${k?`&${k}`:""}`,ee=await window.axios.get(O);d.value=ee.data.filter(ne=>ne.type==="standup")}catch(E){console.error("Error fetching project standups:",E),u.value="Failed to load standups. Please try again."}finally{a.value=!1}},C=()=>{T()},S=()=>{m.search="",m.userId="",m.startDate="",m.endDate="",T()},h=()=>{c.value=oe(c.value).subtract(1,"month").format("YYYY-MM-DD")},x=()=>{c.value=oe(c.value).add(1,"month").format("YYYY-MM-DD")};ce(()=>c.value,E=>{if(i.value==="calendar"&&E){const k=p(E);m.startDate=k.start,m.endDate=k.end,T()}}),ce(()=>i.value,E=>{E==="calendar"?(m.search="",m.userId="",c.value=p(new Date).start):(m.startDate="",m.endDate="",T())});const N=U(()=>(d.value||[]).map(E=>{var ee;if(!(E!=null&&E.created_at))return null;const k=oe(E.created_at);if(!k.isValid())return null;const O=R(E.content);return{start:k.format("YYYY-MM-DD HH:mm"),end:k.format("YYYY-MM-DD HH:mm"),title:`${((ee=E.user)==null?void 0:ee.name)||"Unknown"} - Standup`,content:`Yesterday: ${O.yesterday}
Today: ${O.today}
Blockers: ${O.blockers}`,class:"standup-event",standupData:E}}).filter(Boolean));fe(()=>{T()});const A=U(()=>{if(!d.value)return[];let E=[...d.value];if(m.startDate&&(E=E.filter(k=>k.created_at&&oe(k.created_at).isSameOrAfter(m.startDate,"day"))),m.endDate&&(E=E.filter(k=>k.created_at&&oe(k.created_at).isSameOrBefore(m.endDate,"day"))),m.userId&&(E=E.filter(k=>k.user_id===parseInt(m.userId))),m.search){const k=m.search.toLowerCase();E=E.filter(O=>O.content&&O.content!=="[Encrypted content could not be decrypted]"&&O.content.toLowerCase().includes(k))}return E.sort((k,O)=>oe(O.created_at).valueOf()-oe(k.created_at).valueOf())}),V=E=>{const k=oe(E).day();return k>=1&&k<=5},w=E=>oe(E).isBefore(oe(),"day"),B=(E,k)=>oe(E).isSame(k,"day"),R=E=>{var j,b,I,M;if(!E||typeof E!="string"||E==="[Encrypted content could not be decrypted]"||E.trim()==="")return{yesterday:"N/A",today:"N/A",blockers:"N/A",date:"N/A"};const k=((j=E.match(/\*\*Yesterday:\*\* ([^\n]+)/))==null?void 0:j[1].trim())||"Nothing",O=((b=E.match(/\*\*Today:\*\* ([^\n]+)/))==null?void 0:b[1].trim())||"Nothing",ee=((I=E.match(/\*\*Blockers:\*\* ([^\n]+)/))==null?void 0:I[1].trim())||"None",ne=((M=E.match(/\*\*Daily Standup - ([^*]+)\*\*/))==null?void 0:M[1].trim())||oe().format("L");return{yesterday:k,today:O,blockers:ee,date:ne}},$=U(()=>{const E={};return(d.value||[]).forEach(k=>{if(!(k!=null&&k.created_at))return;const O=oe(k.created_at).format("YYYY-MM-DD");E[O]||(E[O]=[]),E[O].push(k)}),E});return(E,k)=>(o(),r("div",Jl,[e("div",Zl,[k[11]||(k[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Daily Standups",-1)),e("div",Xl,[e("div",Ql,[e("button",{type:"button",onClick:k[0]||(k[0]=O=>i.value="list"),class:se([i.value==="list"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-l-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},k[8]||(k[8]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})]),z(" List ")],-1)]),2),e("button",{type:"button",onClick:k[1]||(k[1]=O=>i.value="calendar"),class:se([i.value==="calendar"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-r-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},k[9]||(k[9]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),z(" Calendar ")],-1)]),2)]),v(pe,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:k[2]||(k[2]=O=>n.value=!0)},{default:H(()=>k[10]||(k[10]=[z(" Submit Standup ",-1)])),_:1,__:[10]})])]),i.value==="list"?(o(),r("div",ea,[e("div",ta,[e("div",null,[k[12]||(k[12]=e("label",{for:"standupStartDate",class:"block text-sm font-medium text-gray-700 mb-1"},"From Date",-1)),ge(e("input",{type:"date",id:"standupStartDate","onUpdate:modelValue":k[3]||(k[3]=O=>m.startDate=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:C},null,544),[[ke,m.startDate]])]),e("div",null,[k[13]||(k[13]=e("label",{for:"standupEndDate",class:"block text-sm font-medium text-gray-700 mb-1"},"To Date",-1)),ge(e("input",{type:"date",id:"standupEndDate","onUpdate:modelValue":k[4]||(k[4]=O=>m.endDate=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:C},null,544),[[ke,m.endDate]])]),e("div",null,[k[15]||(k[15]=e("label",{for:"standupUserFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),ge(e("select",{id:"standupUserFilter","onUpdate:modelValue":k[5]||(k[5]=O=>m.userId=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:C},[k[14]||(k[14]=e("option",{value:""},"All Users",-1)),(o(!0),r(J,null,Q(s.users,O=>(o(),r("option",{key:O.id,value:O.id},g(O.name),9,sa))),128))],544),[[qe,m.userId]])]),e("div",null,[k[17]||(k[17]=e("label",{for:"standupSearchFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Search Content",-1)),e("div",la,[ge(e("input",{type:"text",id:"standupSearchFilter","onUpdate:modelValue":k[6]||(k[6]=O=>m.search=O),class:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pr-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search in standup content...",onInput:y},null,544),[[ke,m.search]]),k[16]||(k[16]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:S}," Reset Filters ")])])):D("",!0),a.value?(o(),r("div",aa,"Loading standups...")):u.value?(o(),r("div",ia,g(u.value),1)):i.value==="list"?(o(),r("div",na,[A.value.length?(o(),r("div",oa,[(o(!0),r(J,null,Q(A.value,O=>{var ee,ne;return o(),r("div",{key:O.id,class:"p-4 bg-blue-50 rounded-md shadow-sm hover:bg-blue-100 transition-colors border-l-4 border-blue-500"},[O.content==="[Encrypted content could not be decrypted]"?(o(),r("div",ra,[e("div",da,[e("p",ua,[z(g(O.content),1),k[18]||(k[18]=e("span",{class:"text-xs text-red-400 block mt-1"},"(There was an issue decrypting this standup. Please contact an administrator.)",-1))]),e("div",ca,[e("p",ma,"Submitted by "+g(((ee=O.user)==null?void 0:ee.name)||"Unknown")+" on "+g(G(oe)(O.created_at).format("L")),1)])])])):(o(),r("div",va,[e("div",pa,[e("div",ha,[k[19]||(k[19]=e("h3",{class:"text-md font-bold text-gray-800"},"Daily Standup",-1)),e("span",ga,g(R(O.content).date),1)]),e("div",ya,[k[20]||(k[20]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Yesterday:")],-1)),e("p",fa,g(R(O.content).yesterday),1)]),e("div",ba,[k[21]||(k[21]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-green-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Today:")],-1)),e("p",wa,g(R(O.content).today),1)]),e("div",_a,[k[22]||(k[22]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-red-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Blockers:")],-1)),e("p",xa,g(R(O.content).blockers),1)]),e("div",ka,[e("p",Da,"Submitted by "+g(((ne=O.user)==null?void 0:ne.name)||"Unknown")+" on "+g(G(oe)(O.created_at).format("L")),1)])])]))])}),128))])):(o(),r("p",Ca,"No daily standups found for the selected criteria."))])):i.value==="calendar"?(o(),r("div",Ta,[e("div",Ea,[e("button",{onClick:h,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},k[23]||(k[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("h3",Sa,g(c.value?G(oe)(c.value).format("MMMM YYYY"):"Loading..."),1),e("button",{onClick:x,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},k[24]||(k[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),v(G(Kl),{class:"vuecal--blue-theme","active-view":"month",events:N.value,"selected-date":c.value,"hide-title-bar":"","disable-views":["week","day","years","year"],twelveHour:!0,"time-from":480,"time-to":1200,"time-step":30,"events-on-month-view":"short"},{event:H(({event:O})=>[e("div",{class:"vuecal__event-title",innerHTML:O.title},null,8,Ma),e("div",{class:"vuecal__event-content",innerHTML:O.content},null,8,ja)]),"cell-content":H(({view:O,date:ee})=>[O.id==="month"?(o(),r(J,{key:0},[ee&&V(ee)&&w(ee)&&!N.value.some(ne=>B(ne.start,ee))?(o(),r("div",$a," No standups ")):D("",!0)],64)):D("",!0)]),_:1},8,["events","selected-date"]),k[26]||(k[26]=Kt('<div class="mt-4 flex items-center space-x-4 text-sm"><div class="flex items-center"><span class="inline-block w-3 h-3 bg-blue-50 border-l-2 border-blue-500 mr-1"></span><span>Standup submitted</span></div><div class="flex items-center"><span class="inline-block w-3 h-3 bg-red-50 border-l-2 border-red-500 mr-1"></span><span>Missing standup</span></div></div>',1)),e("div",Va,[k[25]||(k[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Standups Outside Current Month View",-1)),Object.entries($.value).some(([O])=>!G(oe)(O).isSame(c.value,"month"))?(o(),r("div",Aa,[(o(!0),r(J,null,Q(Object.entries($.value).filter(([O])=>!G(oe)(O).isSame(c.value,"month")).sort((O,ee)=>G(oe)(O[0]).valueOf()-G(oe)(ee[0]).valueOf()),([O,ee])=>(o(),r("div",{key:O,class:"mb-4"},[e("div",Oa,g(G(oe)(O).format("dddd, MMMM Do YYYY")),1),(o(!0),r(J,null,Q(ee,ne=>{var j;return o(),r("div",{key:ne.id,class:"p-2 mb-2 rounded bg-blue-50 border-l-2 border-blue-500"},[e("div",Ia,g(((j=ne.user)==null?void 0:j.name)||"Unknown"),1),e("div",La,g(G(oe)(ne.created_at).format("LT")),1)])}),128))]))),128))])):(o(),r("div",Pa,"No standups outside the current month view."))])])):D("",!0),v(gt,{show:n.value,onClose:k[7]||(k[7]=O=>n.value=!1),onStandupAdded:T,projectId:l.projectId},null,8,["show","projectId"])]))}},Na={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-6"},Ra={class:"space-y-6"},Fa={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ha={class:"flex items-center"},Ba={class:"flex items-center"},Wa={class:"space-y-6 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},Ya={class:"space-y-4"},za={class:"text-gray-900 font-medium break-words"},qa={class:"text-gray-900"},Ga={key:0,class:"text-xs text-gray-500 mt-1"},Ka={key:0},Ja={class:"text-gray-900 whitespace-pre-wrap"},Za={key:1},Xa={class:"flex flex-wrap gap-2"},Qa={key:2},ei={class:"text-gray-900"},ti={class:"list-disc list-inside space-y-1 text-gray-900"},si={key:0},li={key:1},ai={key:2},ii={__name:"MeetingModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},projectName:{type:String,default:"Project"}},emits:["close","saved"],setup(l,{emit:t}){const s=l,i=t,n=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,a=["Africa/Cairo","Africa/Johannesburg","Africa/Lagos","America/Anchorage","America/Bogota","America/Chicago","America/Denver","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Dubai","Asia/Hong_Kong","Asia/Jerusalem","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Tokyo","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Berlin","Europe/Dublin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Rome","Pacific/Auckland","Pacific/Honolulu","UTC","GMT","Europe/Belfast","America/Adak","America/Boise","America/Detroit","America/Indianapolis","America/Juneau","America/Louisville","America/Menominee","America/Nome","America/Sitka","America/Yakutat","Asia/Karachi","Asia/Kolkata","Pacific/Auckland","Pacific/Chatham","Europe/Athens","Europe/Brussels","Europe/Budapest","Europe/Copenhagen","Europe/Helsinki","Europe/Lisbon","Europe/Oslo","Europe/Stockholm","Europe/Zurich","Europe/Vienna","Europe/Warsaw","Europe/Zurich","Europe/Sofia","Europe/Prague","Europe/Malta","Europe/Luxembourg","Europe/Kiev","Europe/Rome"].sort(),u=U(()=>a.map(V=>({value:V,label:V}))),d=U(()=>{const V=n(),w=a.includes(V);return console.log("DEBUG: Is detected timezone in list?",w,"Detected:",V),w?V:(console.log("DEBUG: Falling back to UTC for timezone as detected timezone not in list."),"UTC")}),c=Ce({summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0,timezone:d.value,enable_recording:!1}),m=U({get(){return c.summary?`${c.summary} - ${s.projectName}`:""},set(V){const w=` - ${s.projectName}`;V.endsWith(w)?c.summary=V.slice(0,-w.length):c.summary=V}}),p=()=>{c.summary="",c.description="",c.attendee_user_ids=[],c.location="",c.with_google_meet=!0,c.timezone=d.value,c.enable_recording=!1,y(),console.log("DEBUG: Form reset. Current timezone in form:",c.timezone)},f=V=>{const w=new Date(V),B=w.getFullYear(),R=String(w.getMonth()+1).padStart(2,"0"),$=String(w.getDate()).padStart(2,"0"),E=String(w.getHours()).padStart(2,"0"),k=String(w.getMinutes()).padStart(2,"0");return`${B}-${R}-${$}T${E}:${k}`},y=()=>{const V=new Date,w=new Date(V.getTime()+3600*1e3),B=new Date(V.getTime()+7200*1e3);c.start_datetime=f(w),c.end_datetime=f(B),console.log("DEBUG: Default times set. Start:",c.start_datetime,"End:",c.end_datetime)};y(),ce(()=>s.show,V=>{V&&p()},{immediate:!0});const T=V=>V?(console.log(V),V.replace("T"," ")+":00"):"",C=V=>{const w={...V};return w.summary=m.value,w.start_datetime=T(V.start_datetime),w.end_datetime=T(V.end_datetime),console.log(w),w},S=U(()=>`/api/projects/${s.projectId}/meetings`),h=V=>{i("saved",V)},x=V=>{console.error("DEBUG: MeetingModal submission error:",V)},N=U(()=>{if(!c.start_datetime||!c.end_datetime)return"";const V=new Date(c.start_datetime),w=new Date(c.end_datetime),B={weekday:"long",year:"numeric",month:"long",day:"numeric"},R={hour:"2-digit",minute:"2-digit"},$=V.toLocaleDateString(void 0,B),E=V.toLocaleTimeString(void 0,R),k=w.toLocaleTimeString(void 0,R);return V.toDateString()===w.toDateString()?`${$}, ${E} - ${k}`:`${$} ${E} - ${w.toLocaleDateString(void 0,B)} ${k}`}),A=U(()=>s.projectUsers.filter(V=>c.attendee_user_ids.includes(V.id)).map(V=>V.name));return(V,w)=>(o(),le(Ve,{show:l.show,title:"Schedule a Meeting","api-endpoint":S.value,"http-method":"post","form-data":c,"format-data-for-api":C,"submit-button-text":"Schedule Meeting","success-message":"Meeting scheduled successfully!",onClose:w[9]||(w[9]=B=>V.$emit("close")),onSubmitted:h,onError:x},{default:H(({errors:B})=>[e("div",Na,[e("div",Ra,[e("div",null,[v(q,{for:"summary",value:"Meeting Title"}),w[10]||(w[10]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive title for the meeting (e.g., Project Standup). The project name will be added automatically. ",-1)),v(me,{id:"summary",modelValue:c.summary,"onUpdate:modelValue":w[0]||(w[0]=R=>c.summary=R),type:"text",class:"mt-1 block w-full",placeholder:"e.g., Project Standup",required:""},null,8,["modelValue"]),v(ae,{message:B.summary?B.summary[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"description",value:"Description"}),w[11]||(w[11]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive agenda of the meeting. ",-1)),ge(e("textarea",{id:"description","onUpdate:modelValue":w[1]||(w[1]=R=>c.description=R),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Meeting agenda and details..."},null,512),[[ke,c.description]]),v(ae,{message:B.description?B.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Fa,[e("div",null,[v(q,{for:"start_datetime",value:"Start Date & Time"}),v(me,{id:"start_datetime",modelValue:c.start_datetime,"onUpdate:modelValue":w[2]||(w[2]=R=>c.start_datetime=R),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:B.start_datetime?B.start_datetime[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"end_datetime",value:"End Date & Time"}),v(me,{id:"end_datetime",modelValue:c.end_datetime,"onUpdate:modelValue":w[3]||(w[3]=R=>c.end_datetime=R),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:B.end_datetime?B.end_datetime[0]:"",class:"mt-2"},null,8,["message"])])]),e("div",null,[v(q,{for:"attendees",value:"Attendees"}),v(et,{id:"attendees",modelValue:c.attendee_user_ids,"onUpdate:modelValue":w[4]||(w[4]=R=>c.attendee_user_ids=R),options:s.projectUsers,"label-key":"name","track-by":"id",placeholder:"Select attendees",class:"mt-1"},null,8,["modelValue","options"]),w[12]||(w[12]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select project members to invite to this meeting ",-1)),v(ae,{message:B.attendee_user_ids?B.attendee_user_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"location",value:"Location (Optional)"}),v(me,{id:"location",modelValue:c.location,"onUpdate:modelValue":w[5]||(w[5]=R=>c.location=R),type:"text",class:"mt-1 block w-full",placeholder:"Office, Conference Room, etc."},null,8,["modelValue"]),v(ae,{message:B.location?B.location[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"timezone",value:"Timezone"}),v(he,{id:"timezone",modelValue:c.timezone,"onUpdate:modelValue":w[6]||(w[6]=R=>c.timezone=R),options:u.value,"value-key":"value","label-key":"label",placeholder:"Select timezone",class:"mt-1"},null,8,["modelValue","options"]),w[13]||(w[13]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select your timezone for this meeting ",-1)),v(ae,{message:B.timezone?B.timezone[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Ha,[ge(e("input",{id:"with_google_meet","onUpdate:modelValue":w[7]||(w[7]=R=>c.with_google_meet=R),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,c.with_google_meet]]),w[14]||(w[14]=e("label",{for:"with_google_meet",class:"ml-2 block text-sm text-gray-900"}," Create Google Meet video conference ",-1))]),e("div",Ba,[ge(e("input",{id:"enable_recording","onUpdate:modelValue":w[8]||(w[8]=R=>c.enable_recording=R),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,c.enable_recording]]),w[15]||(w[15]=e("label",{for:"enable_recording",class:"ml-2 block text-sm text-gray-900"}," Enable recording and transcript ",-1))])]),e("div",Wa,[w[22]||(w[22]=e("h4",{class:"text-xl font-bold text-gray-800"},"Meeting Preview",-1)),e("div",Ya,[e("div",null,[w[16]||(w[16]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Title",-1)),e("p",za,g(m.value||"Untitled Meeting"),1)]),e("div",null,[w[17]||(w[17]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Date & Time",-1)),e("p",qa,g(N.value||"No date and time selected."),1),c.timezone?(o(),r("p",Ga,"Timezone: "+g(c.timezone),1)):D("",!0)]),c.description?(o(),r("div",Ka,[w[18]||(w[18]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Description",-1)),e("p",Ja,g(c.description),1)])):D("",!0),A.value.length>0?(o(),r("div",Za,[w[19]||(w[19]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Attendees",-1)),e("div",Xa,[(o(!0),r(J,null,Q(A.value,R=>(o(),r("span",{key:R,class:"px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},g(R),1))),128))])])):D("",!0),c.location?(o(),r("div",Qa,[w[20]||(w[20]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Location",-1)),e("p",ei,g(c.location),1)])):D("",!0),e("div",null,[w[21]||(w[21]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Options",-1)),e("ul",ti,[c.with_google_meet?(o(),r("li",si,"Google Meet enabled")):D("",!0),c.enable_recording?(o(),r("li",li,"Recording and transcript enabled")):D("",!0),!c.with_google_meet&&!c.enable_recording?(o(),r("li",ai,"No special options selected.")):D("",!0)])])])])])]),_:1},8,["show","api-endpoint","form-data"]))}},ni=Ee(ii,[["__scopeId","data-v-674b7e2a"]]),oi={class:"p-6"},ri={key:0,class:"mb-4 p-3 bg-green-100 text-green-800 rounded-md"},di={key:1,class:"mb-4 p-3 bg-red-100 text-red-800 rounded-md"},ui={class:"mb-4"},ci=["value"],mi={class:"mt-6 flex justify-end space-x-3"},vi={__name:"ProjectMagicLinkModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectClients:{type:Array,default:()=>[]}},emits:["close"],setup(l,{emit:t}){const s=l,i=t,n=_(!1),a=_(""),u=_(""),d=_(""),c=async()=>{var p,f;if(!a.value){d.value="Please select a client email";return}n.value=!0,u.value="",d.value="";try{const y=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{email:a.value});y.data.success?(u.value=y.data.message,a.value=""):d.value=y.data.message||"Failed to send magic link"}catch(y){console.error("Error sending magic link:",y),d.value=((f=(p=y.response)==null?void 0:p.data)==null?void 0:f.message)||"An error occurred while sending the magic link"}finally{n.value=!1}},m=()=>{a.value="",u.value="",d.value="",i("close")};return(p,f)=>(o(),le($e,{show:l.show,onClose:m},{default:H(()=>[e("div",oi,[e("div",{class:"flex justify-between items-center mb-4"},[f[2]||(f[2]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Send Magic Link to Client",-1)),e("button",{onClick:m,class:"text-gray-400 hover:text-gray-500"},f[1]||(f[1]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u.value?(o(),r("div",ri,g(u.value),1)):D("",!0),d.value?(o(),r("div",di,g(d.value),1)):D("",!0),e("div",ui,[v(q,{for:"client-email",value:"Select Client"}),ge(e("select",{id:"client-email","onUpdate:modelValue":f[0]||(f[0]=y=>a.value=y),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full"},[f[3]||(f[3]=e("option",{value:""},"Select a client",-1)),(o(!0),r(J,null,Q(l.projectClients,y=>(o(),r("option",{key:y.id,value:y.email},g(y.name)+" ("+g(y.email)+") ",9,ci))),128))],512),[[qe,a.value]]),f[4]||(f[4]=e("p",{class:"mt-2 text-sm text-gray-500"}," The magic link will be sent to the selected client's email address. ",-1))]),e("div",mi,[v(_e,{onClick:m,type:"button"},{default:H(()=>f[5]||(f[5]=[z(" Cancel ",-1)])),_:1,__:[5]}),v(pe,{onClick:c,disabled:n.value||!a.value,class:"bg-purple-600 hover:bg-purple-700"},{default:H(()=>[z(g(n.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},pi={class:"mt-6 space-y-6"},hi={class:"mt-2 flex space-x-4"},gi={class:"inline-flex items-center"},yi={class:"inline-flex items-center"},fi={key:0},bi={key:1},wi=["required"],_i={__name:"ResourceModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},resource:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,i=t,n=_({name:"",type:"link",url:"",file:null,description:""}),a=_(null),u=U(()=>s.resource?`/api/projects/${s.projectId}/resources/${s.resource.id}`:`/api/projects/${s.projectId}/resources`),d=U(()=>s.resource?"put":"post"),c=U(()=>s.resource?"Update Resource":"Add Resource"),m=U(()=>s.resource?"Resource updated successfully!":"Resource added successfully!");ce(()=>s.show,C=>{C&&(s.resource?n.value={name:s.resource.name,type:s.resource.type,url:s.resource.type==="link"?s.resource.url:"",file:null,description:s.resource.description||""}:n.value={name:"",type:"link",url:"",file:null,description:""},a.value&&(a.value.value=""))},{immediate:!0});const p=C=>{n.value.file=C.target.files[0]||null},f=C=>{const S=new FormData;return S.append("name",C.name||""),S.append("type",C.type||"link"),S.append("description",C.description||""),C.type==="link"?S.append("url",C.url||""):C.type==="file"&&C.file&&S.append("file",C.file),(d.value==="put"||d.value==="patch")&&S.append("_method","PUT"),S},y=C=>{i("saved",C.resource)},T=()=>{i("close")};return(C,S)=>(o(),le(Ve,{show:l.show,title:l.resource?"Edit Resource":"Add Resource","api-endpoint":u.value,"http-method":d.value,"form-data":n.value,"submit-button-text":c.value,"success-message":m.value,"format-data-for-api":f,onClose:T,onSubmitted:y},{default:H(({errors:h})=>[e("div",pi,[e("div",null,[v(q,{for:"resource-type",value:"Resource Type"}),e("div",hi,[e("label",gi,[ge(e("input",{type:"radio","onUpdate:modelValue":S[0]||(S[0]=x=>n.value.type=x),value:"link",class:"form-radio text-indigo-600"},null,512),[[ut,n.value.type]]),S[5]||(S[5]=e("span",{class:"ml-2 text-gray-700"},"Link",-1))]),e("label",yi,[ge(e("input",{type:"radio","onUpdate:modelValue":S[1]||(S[1]=x=>n.value.type=x),value:"file",class:"form-radio text-indigo-600"},null,512),[[ut,n.value.type]]),S[6]||(S[6]=e("span",{class:"ml-2 text-gray-700"},"File",-1))])])]),e("div",null,[v(q,{for:"resource-name",value:"Name"}),v(me,{id:"resource-name",modelValue:n.value.name,"onUpdate:modelValue":S[2]||(S[2]=x=>n.value.name=x),type:"text",class:"mt-1 block w-full",placeholder:"Enter resource name",required:""},null,8,["modelValue"]),v(ae,{message:h.name?h.name[0]:"",class:"mt-2"},null,8,["message"])]),n.value.type==="link"?(o(),r("div",fi,[v(q,{for:"resource-url",value:"URL"}),v(me,{id:"resource-url",modelValue:n.value.url,"onUpdate:modelValue":S[3]||(S[3]=x=>n.value.url=x),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com",required:""},null,8,["modelValue"]),v(ae,{message:h.url?h.url[0]:"",class:"mt-2"},null,8,["message"])])):D("",!0),n.value.type==="file"?(o(),r("div",bi,[v(q,{for:"resource-file",value:"File"}),e("input",{id:"resource-file",ref_key:"fileInputRef",ref:a,type:"file",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",onChange:p,required:!l.resource||n.value.type==="file"},null,40,wi),v(ae,{message:h.file?h.file[0]:"",class:"mt-2"},null,8,["message"])])):D("",!0),e("div",null,[v(q,{for:"resource-description",value:"Description (Optional)"}),ge(e("textarea",{id:"resource-description","onUpdate:modelValue":S[4]||(S[4]=x=>n.value.description=x),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter a description for this resource"},null,512),[[ke,n.value.description]]),v(ae,{message:h.description?h.description[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},xi=Ee(_i,[["__scopeId","data-v-f508dda8"]]),ki={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Di={class:"flex justify-between items-center mb-4"},Ci={class:"flex gap-3"},Ti={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ei={class:"text-2xl font-bold text-gray-900 tracking-tight mb-2"},Si={class:"text-gray-600 text-base"},Mi={class:"space-y-3 text-sm text-gray-700"},ji={class:"flex flex-wrap gap-2 mt-2 items-center"},$i=["href"],Vi=["href"],Ai=["href"],Oi={key:3,class:"text-gray-500 text-sm"},Ii={class:"relative"},Li=["onClick"],Pi={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ui={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ni={key:0,class:"resource-tooltip absolute left-0 bottom-full mb-2 w-48 z-10"},Ri={class:"bg-white rounded-md shadow-lg p-3 text-sm border border-gray-200"},Fi={class:"flex justify-between items-center mb-2"},Hi={class:"font-medium text-gray-900"},Bi={key:0,class:"text-gray-600 text-xs mb-2"},Wi={class:"flex justify-between mt-2 pt-2 border-t border-gray-100"},Yi=["href"],zi={class:"flex space-x-2"},qi=["onClick"],Gi=["onClick"],Ki={class:"p-6"},Ji={key:0,class:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-md"},Zi={key:1,class:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md"},Xi={class:"mb-4"},Qi={key:0,class:"text-gray-500 text-sm mt-1"},en={key:1,class:"text-red-500 text-sm mt-1"},tn={class:"flex justify-end mt-6"},sn={__name:"ProjectGeneralInfoCard",props:{project:{type:Object,required:!0},projectId:{type:Number,required:!0},canManageProjects:{type:Boolean,required:!0},canEditProjects:{type:Boolean,required:!1},isSuperAdmin:{type:Boolean,required:!0}},emits:["openEditModal","openStandupModal","openMeetingModal","resourceSaved","openComposeModal"],setup(l,{emit:t}){const s=l,i=t,n=_(!1),a=_(null),u=_([]),d=_(!1),c=_(null),m=_(!1),p=_(!1),f=_(!1),y=_({client_ids:[]}),T=_({}),C=_(""),S=_([]),h=_(!1),x=_("");ht(s.projectId);const N=async()=>{d.value=!0;try{const j=await window.axios.get(`/api/projects/${s.projectId}/resources`);j.data.success?u.value=j.data.resources:console.error("Failed to fetch resources:",j.data.message)}catch(j){console.error("Error fetching resources:",j)}finally{d.value=!1}},A=()=>{a.value=null,n.value=!0},V=j=>{a.value=j,n.value=!0},w=async j=>{if(confirm("Are you sure you want to delete this resource?"))try{const b=await window.axios.delete(`/api/projects/${s.projectId}/resources/${j}`);b.data.success?u.value=u.value.filter(I=>I.id!==j):console.error("Failed to delete resource:",b.data.message)}catch(b){console.error("Error deleting resource:",b)}},B=j=>{if(a.value){const b=u.value.findIndex(I=>I.id===j.id);b!==-1&&(u.value[b]=j)}else u.value.push(j);i("resourceSaved",j)},R=j=>{c.value=c.value===j?null:j},$=()=>{c.value=null},E=j=>{if(c.value!==null){const b=j.target.closest(".resource-tooltip"),I=j.target.closest(".resource-button");!b&&!I&&$()}};fe(()=>{N(),document.addEventListener("click",E)}),Jt(()=>{document.removeEventListener("click",E)});const k=async()=>{var j,b;h.value=!0,x.value="";try{const I=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);console.log(I),S.value=I.data}catch(I){console.error("Failed to fetch project clients:",I),x.value=((b=(j=I.response)==null?void 0:j.data)==null?void 0:b.message)||"Failed to load client data."}finally{h.value=!1}},O=()=>{m.value=!0,k()},ee=()=>{p.value=!1},ne=async()=>{if(T.value={},C.value="",f.value=!0,!y.value.client_ids||y.value.client_ids.length===0){T.value={client_ids:["Please select a client."]},f.value=!1;return}try{const j=y.value.client_ids[0];if(!S.value.find(M=>M.id===j)){T.value={client_ids:["Selected client does not have a valid email."]},f.value=!1;return}const I=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{client_id:j});I.data.success&&(C.value=I.data.message,y.value.client_ids=[])}catch(j){j.response&&j.response.status===422?T.value=j.response.data.errors:j.response&&j.response.data.message?T.value={general:[j.response.data.message]}:T.value={general:["An unexpected error occurred. Please try again."]}}finally{f.value=!1}};return(j,b)=>{var I;return o(),r(J,null,[e("div",ki,[e("div",Di,[b[12]||(b[12]=e("h4",{class:"text-lg font-semibold text-gray-900"},"General Information",-1)),e("div",Ci,[v(pe,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:b[0]||(b[0]=M=>i("openStandupModal"))},{default:H(()=>b[8]||(b[8]=[z(" Daily Standup ",-1)])),_:1,__:[8]}),l.canEditProjects||l.isSuperAdmin?(o(),le(pe,{key:0,onClick:b[1]||(b[1]=M=>j.$inertia.visit("/projects/"+l.projectId+"/edit")),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:H(()=>b[9]||(b[9]=[z(" Edit Project ",-1)])),_:1,__:[9]})):D("",!0),l.canManageProjects||l.isSuperAdmin?(o(),le(pe,{key:1,class:"bg-green-600 hover:bg-green-700 transition-colors",onClick:b[2]||(b[2]=M=>i("openMeetingModal"))},{default:H(()=>b[10]||(b[10]=[z(" Schedule Meeting ",-1)])),_:1,__:[10]})):D("",!0),v(pe,{class:"bg-blue-400 hover:bg-blue-600 transition-colors",onClick:O},{default:H(()=>b[11]||(b[11]=[z(" Compose Email ",-1)])),_:1,__:[11]})])]),e("div",Ti,[e("div",null,[e("h3",Ei,g(l.project.name),1),e("p",Si,g(l.project.description||"No description provided"),1)]),e("div",Mi,[e("p",null,[b[13]||(b[13]=e("strong",{class:"text-gray-900"},"Status:",-1)),z(" "+g(((I=l.project.status)==null?void 0:I.replace("_"," ").toUpperCase())||"N/A"),1)]),e("p",null,[b[14]||(b[14]=e("strong",{class:"text-gray-900"},"Project Type:",-1)),z(" "+g(l.project.project_type||"N/A"),1)]),e("p",null,[b[15]||(b[15]=e("strong",{class:"text-gray-900"},"Source:",-1)),z(" "+g(l.project.source||"N/A"),1)]),e("div",ji,[e("button",{onClick:A,class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Add Resource"},b[16]||(b[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])),l.project.website?(o(),r("a",{key:0,href:l.project.website,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Visit Website"},b[17]||(b[17]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})],-1)]),8,$i)):D("",!0),l.project.social_media_link?(o(),r("a",{key:1,href:l.project.social_media_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Social Media"},b[18]||(b[18]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})],-1)]),8,Vi)):D("",!0),l.project.google_drive_link?(o(),r("a",{key:2,href:l.project.google_drive_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Google Drive"},b[19]||(b[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]),8,Ai)):D("",!0),d.value?(o(),r("div",Oi," Loading resources... ")):(o(!0),r(J,{key:4},Q(u.value,M=>(o(),r("div",{key:M.id,class:"relative"},[e("div",Ii,[e("button",{onClick:xe(K=>R(M.id),["prevent"]),class:"resource-button p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors block"},[M.type==="link"?(o(),r("svg",Pi,b[20]||(b[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.172 13.828a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.102 1.101"},null,-1)]))):(o(),r("svg",Ui,b[21]||(b[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])))],8,Li),c.value===M.id?(o(),r("div",Ni,[e("div",Ri,[e("div",Fi,[e("h4",Hi,g(M.name),1),e("button",{onClick:xe($,["prevent"]),class:"text-gray-400 hover:text-gray-600"},b[22]||(b[22]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),M.description?(o(),r("p",Bi,g(M.description),1)):D("",!0),e("div",Wi,[e("a",{href:M.url,target:"_blank",class:"text-xs text-indigo-600 hover:text-indigo-800"}," Open Link ",8,Yi),e("div",zi,[e("button",{onClick:xe(K=>V(M),["prevent"]),class:"p-1 text-gray-500 hover:text-indigo-600",title:"Edit"},b[23]||(b[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,qi),e("button",{onClick:xe(K=>w(M.id),["prevent"]),class:"p-1 text-gray-500 hover:text-red-600",title:"Delete"},b[24]||(b[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Gi)])])]),b[25]||(b[25]=e("div",{class:"absolute left-5 bottom-0 transform translate-y-1/2 rotate-45 w-2 h-2 bg-white border-r border-b border-gray-200"},null,-1))])):D("",!0)])]))),128))])])])]),v(xi,{show:n.value,"project-id":l.projectId,resource:a.value,onClose:b[3]||(b[3]=M=>n.value=!1),onSaved:B},null,8,["show","project-id","resource"]),v($e,{show:p.value,onClose:ee},{default:H(()=>[e("div",Ki,[b[28]||(b[28]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Send Magic Link ",-1)),C.value?(o(),r("div",Ji,g(C.value),1)):D("",!0),T.value.general?(o(),r("div",Zi,g(T.value.general[0]),1)):D("",!0),e("form",{onSubmit:xe(ne,["prevent"])},[e("div",Xi,[v(q,{for:"client",value:"Select Client"}),h.value?(o(),r("div",Qi,"Loading clients...")):x.value?(o(),r("div",en,g(x.value),1)):(o(),le(et,{key:2,id:"client",modelValue:y.value.client_ids,"onUpdate:modelValue":b[4]||(b[4]=M=>y.value.client_ids=M),options:S.value,placeholder:"Select a client","label-key":"name","track-by":"id",class:"mt-1"},null,8,["modelValue","options"])),v(ae,{message:T.value.client_ids?T.value.client_ids[0]:"",class:"mt-2"},null,8,["message"]),b[26]||(b[26]=e("p",{class:"mt-2 text-sm text-gray-500"}," Select a client to send them a magic link for project access. ",-1))]),e("div",tn,[v(_e,{onClick:ee,class:"mr-3"},{default:H(()=>b[27]||(b[27]=[z(" Cancel ",-1)])),_:1,__:[27]}),v(pe,{type:"submit",class:"bg-purple-600 hover:bg-purple-700 transition-colors",disabled:f.value},{default:H(()=>[z(g(f.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),v(cs,{show:m.value,title:"Compose New Email","api-endpoint":"/api/emails/templated","http-method":"post",clients:S.value,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","project-id":l.projectId,onClose:b[5]||(b[5]=M=>m.value=!1),onSubmitted:b[6]||(b[6]=M=>m.value=!1),onError:b[7]||(b[7]=M=>console.error("Email submission error:",M))},null,8,["show","clients","project-id"])],64)}}},ln=Ee(sn,[["__scopeId","data-v-898a4aa1"]]),an={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},nn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},on={class:"text-2xl font-bold text-indigo-600"},rn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},dn={class:"text-2xl font-bold text-indigo-600"},un={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},cn={class:"text-2xl font-bold text-indigo-600"},mn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},vn={class:"text-2xl font-bold text-indigo-600"},pn={__name:"ProjectStatsCards",props:{tasks:{type:Array,required:!0},emails:{type:Array,required:!0}},setup(l){const t=l,s=U(()=>t.tasks.filter(u=>u.status!=="Done").length),i=U(()=>t.emails.filter(u=>u.type==="received").length),n=U(()=>{const u=t.emails.filter(d=>d.status==="received"||d.type==="received");if(u.length>0){const d=[...u].sort((c,m)=>new Date(m.created_at)-new Date(c.created_at));return new Date(d[0].created_at).toLocaleDateString()}return"N/A"}),a=U(()=>{const u=t.tasks.filter(d=>d.status!=="Done");if(u.length>0){const d=u.filter(c=>c.due_date);if(d.length>0)return[...d].sort((m,p)=>new Date(m.due_date)-new Date(p.due_date))[0].due_date}return"N/A"});return(u,d)=>(o(),r("div",an,[e("div",nn,[d[0]||(d[0]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Pending Tasks",-1)),e("p",on,g(s.value),1)]),e("div",rn,[d[1]||(d[1]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Received Emails",-1)),e("p",dn,g(i.value),1)]),e("div",un,[d[2]||(d[2]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Last Email Received",-1)),e("p",cn,g(n.value),1)]),e("div",mn,[d[3]||(d[3]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Next Task Deadline",-1)),e("p",vn,g(a.value),1)])]))}},hn={class:"bg-white p-4 rounded-xl shadow-md mb-6"},gn={class:"border-b border-gray-200"},yn={__name:"ProjectTabsNavigation",props:{selectedTab:{type:String,default:null},canViewEmails:{type:Boolean,required:!0},canViewNotes:{type:Boolean,required:!0},canViewDeliverables:{type:Boolean,required:!0},canViewSeoReports:{type:Boolean,required:!0}},emits:["update:selectedTab"],setup(l,{expose:t,emit:s}){const i=_(null),n=l,a=s,u=U({get:()=>n.selectedTab,set:c=>a("update:selectedTab",c)});return t({scrollIntoView:c=>{i.value&&i.value.scrollIntoView(c)}}),(c,m)=>(o(),r("div",hn,[e("div",gn,[e("nav",{class:"-mb-px flex space-x-8 overflow-x-auto",ref_key:"navElement",ref:i},[e("button",{onClick:m[0]||(m[0]=p=>u.value=null),class:se([u.value===null?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Overview ",2),e("button",{onClick:m[1]||(m[1]=p=>u.value="tasks"),class:se([u.value==="tasks"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Project Tasks ",2),l.canViewEmails?(o(),r("button",{key:0,onClick:m[2]||(m[2]=p=>u.value="emails"),class:se([u.value==="emails"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Email Communication ",2)):D("",!0),l.canViewNotes?(o(),r("button",{key:1,onClick:m[3]||(m[3]=p=>u.value="notes"),class:se([u.value==="notes"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Notes ",2)):D("",!0),l.canViewNotes?(o(),r("button",{key:2,onClick:m[4]||(m[4]=p=>u.value="standups"),class:se([u.value==="standups"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Daily Standups ",2)):D("",!0),l.canViewDeliverables?(o(),r("button",{key:3,onClick:m[5]||(m[5]=p=>u.value="deliverables"),class:se([u.value==="deliverables"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Deliverables ",2)):D("",!0),l.canViewSeoReports?(o(),r("button",{key:4,onClick:m[6]||(m[6]=p=>u.value="seo-reports"),class:se([u.value==="seo-reports"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," SEO Reports ",2)):D("",!0)],512)])]))}},fn={class:"space-y-4"},bn={key:0,class:"text-sm text-gray-500"},wn={class:"flex justify-between items-center"},_n={key:0,class:"text-sm text-gray-500"},xn="put",kn="Update Task",Dn="Task updated successfully!",Cn={__name:"EditTaskModal",props:{show:Boolean,projectId:Number,selectedTask:Object,projectUsers:Array,taskTypes:Array,milestones:Array,loadingTaskTypes:Boolean,loadingMilestones:Boolean},emits:["close","saved","open-add-milestone-modal"],setup(l,{emit:t}){const s=l,i=t,n=Ce({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]}),a=["To Do","In Progress","Done","Blocked","Archived"],u=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],d=U(()=>"Edit Task"),c=U(()=>{var S;return`/api/tasks/${(S=s.selectedTask)==null?void 0:S.id}`});ce(()=>[s.show,s.selectedTask],([S,h],[x,N]=[])=>{var A;if(S&&h){let V=null;if(h.milestone){const $=s.milestones.find(E=>E.name===h.milestone);$&&(V=$.id)}else h.milestone_id&&(V=h.milestone_id);let w=null;if(h.task_type){const $=s.taskTypes.find(E=>E.name===h.task_type);$&&(w=$.id)}else h.task_type_id&&(w=h.task_type_id);let B=null;if(h.assigned_to&&h.assigned_to!=="Unassigned"){const $=(A=s.projectUsers)==null?void 0:A.find(E=>E.name===h.assigned_to);$&&(B=$.id)}else h.assigned_to_id&&(B=h.assigned_to_id);let R=[];h.tags&&Array.isArray(h.tags)&&h.tags.length>0&&(typeof h.tags[0]=="string"?R=h.tags.map($=>({id:`new_${$.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:$})):typeof h.tags[0]=="object"&&(R=h.tags)),Object.assign(n,{name:h.title||"",description:h.description||"",assigned_to_user_id:B,due_date:h.due_date||null,status:h.status||"To Do",task_type_id:w,milestone_id:V,priority:h.priority||"medium",tags:R.map($=>$.id),tags_data:R}),console.log("Task data loaded:",{taskId:h.id,title:h.title,originalTags:h.tags,processedTags:R,formTags:n.tags,formTagsData:n.tags_data})}else S||Object.assign(n,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]})},{immediate:!0});const m=S=>{i("saved",S),i("close")},p=()=>{i("open-add-milestone-modal")},f=()=>{i("close")},y=U(()=>s.projectUsers.map(S=>({value:S.id,label:S.name}))),T=U(()=>s.taskTypes.map(S=>({value:S.id,label:S.name}))),C=U(()=>s.milestones.map(S=>({value:S.id,label:S.name})));return(S,h)=>(o(),le(Ve,{show:l.show,title:d.value,"api-endpoint":c.value,"http-method":xn,"form-data":n,"submit-button-text":kn,"success-message":Dn,onClose:f,onSubmitted:m},{default:H(({errors:x})=>[e("div",fn,[e("div",null,[v(q,{for:"task-name",value:"Task Name"}),v(me,{id:"task-name",modelValue:n.name,"onUpdate:modelValue":h[0]||(h[0]=N=>n.name=N),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),v(ae,{message:x.name?x.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"task-description",value:"Description"}),ge(e("textarea",{id:"task-description","onUpdate:modelValue":h[1]||(h[1]=N=>n.description=N),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[ke,n.description]]),v(ae,{message:x.description?x.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"task-status",value:"Status"}),v(he,{id:"task-status",modelValue:n.status,"onUpdate:modelValue":h[2]||(h[2]=N=>n.status=N),options:a.map(N=>({value:N,label:N})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),v(ae,{message:x.status?x.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"task-priority",value:"Priority"}),v(he,{id:"task-priority",modelValue:n.priority,"onUpdate:modelValue":h[3]||(h[3]=N=>n.priority=N),options:u,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),v(ae,{message:x.priority?x.priority[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"task-due-date",value:"Due Date"}),v(me,{id:"task-due-date",modelValue:n.due_date,"onUpdate:modelValue":h[4]||(h[4]=N=>n.due_date=N),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),v(ae,{message:x.due_date?x.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"task-assigned-to",value:"Assigned To"}),v(he,{id:"task-assigned-to",modelValue:n.assigned_to_user_id,"onUpdate:modelValue":h[5]||(h[5]=N=>n.assigned_to_user_id=N),options:y.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"]),v(ae,{message:x.assigned_to_user_id?x.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"task-type",value:"Task Type"}),l.loadingTaskTypes?(o(),r("div",bn,"Loading task types...")):(o(),le(he,{key:1,id:"task-type",modelValue:n.task_type_id,"onUpdate:modelValue":h[6]||(h[6]=N=>n.task_type_id=N),options:T.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(ae,{message:x.task_type_id?x.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[e("div",wn,[v(q,{for:"task-milestone",value:"Milestone"}),e("button",{type:"button",onClick:p,class:"text-sm text-indigo-600 hover:text-indigo-800"}," + Create New Milestone ")]),l.loadingMilestones?(o(),r("div",_n,"Loading milestones...")):(o(),le(he,{key:1,id:"task-milestone",modelValue:n.milestone_id,"onUpdate:modelValue":h[7]||(h[7]=N=>n.milestone_id=N),options:C.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(ae,{message:x.milestone_id?x.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(Rt,{modelValue:n.tags,"onUpdate:modelValue":h[8]||(h[8]=N=>n.tags=N),initialTags:n.tags_data,label:"Tags",placeholder:"Search or add tags",error:x.tags?x.tags[0]:""},null,8,["modelValue","initialTags","error"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},Tn={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},En={class:"flex justify-between items-center mb-4"},Sn={class:"flex gap-2"},Mn={key:0},jn={key:1},$n={class:"mb-6 overflow-x-auto"},Vn={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},An={key:1,class:"text-center py-4"},On={key:2,class:"relative py-8"},In={class:"relative flex justify-between"},Ln={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pn={key:1,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Un={key:2,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Nn={key:3,class:"w-2 h-2 bg-white rounded-full"},Rn={class:"absolute -top-8 transform -translate-x-1/2 left-1/2 w-32"},Fn=["title"],Hn={class:"absolute top-8 transform -translate-x-1/2 left-1/2"},Bn={class:"text-xs text-gray-500 whitespace-nowrap"},Wn={class:"mb-6 bg-gray-50 p-4 rounded-lg"},Yn={class:"flex flex-wrap items-center gap-4"},zn={class:"flex-1 min-w-[200px]"},qn={class:"flex-1 min-w-[200px]"},Gn={class:"flex-1 min-w-[200px]"},Kn={class:"flex-1 min-w-[200px]"},Jn={key:0,class:"mt-3 text-sm text-gray-600"},Zn={key:0,class:"text-red-600 font-medium"},Xn={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Qn={key:1,class:"text-center py-4"},eo={class:"text-red-600 text-sm font-medium"},to={key:2,class:"overflow-x-auto"},so={key:3,class:"text-center py-4"},lo={class:"p-6"},ao={class:"mb-4"},io={class:"flex justify-end space-x-3"},no={__name:"ProjectTasksTab",props:{projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},canManageProjects:{type:Boolean,required:!0},tasksFilter:{type:String,default:"all"}},emits:["tasksUpdated","openTaskDetailSidebar","open-create-task-modal","filter-changed"],setup(l,{emit:t}){const s=l,i=t,n=_([]),a=_(!0),u=_(""),d=_(!1),c=_(null),m=_(!1),p=_(!1),f=_(null),y=_(!1),T=_(null),C=_(""),S=_([]),h=_([]),x=_(!1),N=_(!1),A=Ce({status:"",assigned_to_user_id:null,milestone_id:null,due_date_range:""}),V=[{value:"",label:"All Statuses"},{value:"To Do",label:"To Do"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Blocked",label:"Blocked"},{value:"Archived",label:"Archived"}],w=U(()=>{const L=[{value:null,label:"All Users"},{value:-1,label:"Unassigned"}];return L.push(...s.projectUsers.map(P=>({value:P.id,label:P.name}))),L}),B=U(()=>{const L=[{value:null,label:"All Milestones"},{value:-1,label:"No Milestone"}];return L.push(...h.value.map(P=>({value:P.id,label:P.name}))),L}),R=[{value:"",label:"All Dates"},{value:"today",label:"Due Today"},{value:"this_week",label:"Due This Week"},{value:"next_week",label:"Due Next Week"},{value:"overdue",label:"Overdue"},{value:"no_date",label:"No Due Date"}],$=U(()=>!h.value||!h.value.length?[]:[...h.value].sort((L,P)=>L.completion_date?P.completion_date?new Date(L.completion_date)-new Date(P.completion_date):-1:1)),E=U(()=>n.value.length?(console.log("ProjectTasksTab: Tasks array:",n.value),n.value.filter(L=>{if(A.status&&L.status!==A.status)return!1;if(A.assigned_to_user_id!==null){const P=parseInt(A.assigned_to_user_id);if(P===-1){if(L.assigned_to!=="Unassigned"&&L.assigned_to_id!==null)return!1}else if(L.assigned_to_id!==P)return!1}if(A.milestone_id!==null){const P=parseInt(A.milestone_id);if(P===-1){if(L.milestone_id)return!1}else if(L.milestone_id!==P)return!1}if(A.due_date_range){const P=new Date;P.setHours(0,0,0,0);const W=L.due_date?new Date(L.due_date):null;switch(A.due_date_range){case"today":if(!W||W.toDateString()!==P.toDateString())return!1;break;case"this_week":{if(!W)return!1;const ye=new Date(P);if(ye.setDate(P.getDate()+(6-P.getDay())),W<P||W>ye)return!1;break}case"next_week":{if(!W)return!1;const ye=new Date(P);ye.setDate(P.getDate()+(7-P.getDay()));const He=new Date(ye);if(He.setDate(ye.getDate()+6),W<ye||W>He)return!1;break}case"overdue":{if(!W||W>=P)return!1;break}case"no_date":{if(W)return!1;break}}}return!0})):[]),k=()=>{A.status="",A.assigned_to_user_id=null,A.milestone_id=null,A.due_date_range=""},O=async()=>{a.value=!0,u.value="";try{const L=await Bt(s.projectId);console.log("ProjectTasksTab: Raw API response from fetchProjectTasks:",L),n.value=L,i("tasksUpdated",n.value)}catch(L){u.value="Failed to load tasks data.",console.error("Error fetching project tasks:",L),L.response&&L.response.data&&L.response.data.message&&(u.value=L.response.data.message)}finally{a.value=!1}},ee=async L=>{await O()},ne=async()=>{x.value=!0;try{const L=await window.axios.get("/api/task-types");S.value=L.data}catch(L){console.error("Error fetching task types:",L)}finally{x.value=!1}},j=async()=>{N.value=!0;try{const L=await window.axios.get(`/api/projects/${s.projectId}/milestones`);h.value=L.data}catch(L){console.error("Error fetching milestones:",L)}finally{N.value=!1}},b=()=>{i("open-create-task-modal")},I=()=>{O()},M=L=>{console.log("ProjectTasksTab: Emitting openTaskDetailSidebar for taskId:",L,"projectId:",s.projectId),i("openTaskDetailSidebar",L,s.projectId,s.projectUsers)},K=()=>{m.value=!0},re=L=>{h.value.push(L),O()},Se=()=>{O()},te=async()=>{if(T.value){if(!C.value.trim()){Zt("Please provide a reason for blocking the task");return}try{Xt("Blocking task..."),await window.axios.post(`/api/tasks/${T.value.id}/block`,{reason:C.value}),Qt("Task blocked successfully"),y.value=!1,await O()}catch(L){console.error("Error blocking task:",L),es("Failed to block task. Please try again.")}}};return fe(()=>{O(),ne(),j()}),ce(()=>s.projectUsers,()=>{}),ce(()=>s.taskTypes,()=>{}),ce(()=>s.milestones,()=>{}),ce(()=>s.tasksFilter,L=>{L==="due-overdue"?(new Date().setHours(0,0,0,0),A.status="",A.assigned_to_user_id=null,A.milestone_id=null,A.due_date_range="overdue"):L==="all"&&(A.status="",A.assigned_to_user_id=null,A.milestone_id=null,A.due_date_range=""),i("filter-changed",L)}),(L,P)=>(o(),r("div",Tn,[e("div",En,[P[11]||(P[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Tasks",-1)),e("div",Sn,[v(_e,{onClick:O,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:H(()=>[a.value?(o(),r("span",jn,"Loading...")):(o(),r("span",Mn,"Refresh"))]),_:1},8,["disabled"]),l.canManageProjects?(o(),le(pe,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:b},{default:H(()=>P[10]||(P[10]=[z(" Add Task ",-1)])),_:1,__:[10]})):D("",!0)])]),e("div",$n,[N.value?(o(),r("div",Vn," Loading milestones... ")):$.value.length?(o(),r("div",On,[P[16]||(P[16]=e("div",{class:"absolute h-1 bg-gray-200 top-1/2 left-0 right-0 transform -translate-y-1/2"},null,-1)),e("div",In,[(o(!0),r(J,null,Q($.value,(W,ye)=>(o(),r("div",{key:W.id,class:se(["flex flex-col items-center relative z-10",{"ml-4":ye===0,"mr-4":ye===$.value.length-1}])},[e("div",{class:se(["w-6 h-6 rounded-full shadow-lg flex items-center justify-center",{"bg-gray-300":W.status==="Not Started","bg-blue-500":W.status==="In Progress","bg-green-500":W.status==="Completed","bg-red-500":W.status==="Overdue"}])},[W.status==="Completed"?(o(),r("svg",Ln,P[13]||(P[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):W.status==="In Progress"?(o(),r("svg",Pn,P[14]||(P[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))):W.status==="Overdue"?(o(),r("svg",Un,P[15]||(P[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(o(),r("span",Nn))],2),e("div",Rn,[e("p",{class:"text-xs font-medium text-gray-700 text-center truncate",title:W.name},g(W.name),9,Fn)]),e("div",Hn,[e("p",Bn,g(W.completion_date?new Date(W.completion_date).toLocaleDateString():"No date"),1)])],2))),128))])])):(o(),r("div",An,P[12]||(P[12]=[e("p",{class:"text-gray-400 text-sm"},"No milestones found for this project.",-1)])))]),e("div",Wn,[e("div",Yn,[e("div",zn,[v(q,{for:"status-filter",value:"Status"}),v(he,{id:"status-filter",modelValue:A.status,"onUpdate:modelValue":P[0]||(P[0]=W=>A.status=W),options:V,"value-key":"value","label-key":"label",placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",qn,[v(q,{for:"assigned-filter",value:"Assigned To"}),v(he,{id:"assigned-filter",modelValue:A.assigned_to_user_id,"onUpdate:modelValue":P[1]||(P[1]=W=>A.assigned_to_user_id=W),options:w.value,"value-key":"value","label-key":"label",placeholder:"All Users",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Gn,[v(q,{for:"milestone-filter",value:"Milestone"}),v(he,{id:"milestone-filter",modelValue:A.milestone_id,"onUpdate:modelValue":P[2]||(P[2]=W=>A.milestone_id=W),options:B.value,"value-key":"value","label-key":"label",placeholder:"All Milestones",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Kn,[v(q,{for:"due-date-filter",value:"Due Date"}),v(he,{id:"due-date-filter",modelValue:A.due_date_range,"onUpdate:modelValue":P[3]||(P[3]=W=>A.due_date_range=W),options:R,"value-key":"value","label-key":"label",placeholder:"All Dates",class:"mt-1"},null,8,["modelValue"])]),e("div",{class:"flex items-end"},[e("button",{type:"button",onClick:k,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")])]),Object.values(A).some(W=>W!==null&&W!=="")?(o(),r("div",Jn,[e("p",null,[z(" Showing "+g(E.value.length)+" of "+g(n.value.length)+" tasks ",1),E.value.length===0?(o(),r("span",Zn," (No tasks match the current filters) ")):D("",!0)])])):D("",!0)]),a.value?(o(),r("div",Xn," Loading tasks... ")):u.value?(o(),r("div",Qn,[e("p",eo,g(u.value),1)])):n.value.length?(o(),r("div",to,[v(yt,{tasks:E.value,"project-id":l.projectId,"show-project-column":!1,onTaskUpdated:ee,onOpenTaskDetail:M},null,8,["tasks","project-id"])])):(o(),r("div",so,P[17]||(P[17]=[e("p",{class:"text-gray-400 text-sm"},"No tasks found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add Task" button to create a new task. ',-1)]))),v(Cn,{show:d.value,"project-id":l.projectId,"selected-task":c.value,"project-users":l.projectUsers,"task-types":S.value,milestones:h.value,"loading-task-types":x.value,"loading-milestones":N.value,onClose:P[4]||(P[4]=W=>d.value=!1),onSaved:I,onOpenAddMilestoneModal:K},null,8,["show","project-id","selected-task","project-users","task-types","milestones","loading-task-types","loading-milestones"]),v(Ft,{show:m.value,"project-id":l.projectId,onClose:P[5]||(P[5]=W=>m.value=!1),onSaved:re},null,8,["show","project-id"]),v(Ht,{show:p.value,"task-for-note":f.value,onClose:P[6]||(P[6]=W=>p.value=!1),onNoteAdded:Se},null,8,["show","task-for-note"]),v($e,{show:y.value,onClose:P[9]||(P[9]=W=>y.value=!1)},{default:H(()=>[e("div",lo,[P[21]||(P[21]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),e("div",ao,[P[18]||(P[18]=e("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),ge(e("textarea",{"onUpdate:modelValue":P[7]||(P[7]=W=>C.value=W),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[ke,C.value]])]),e("div",io,[v(_e,{onClick:P[8]||(P[8]=W=>y.value=!1)},{default:H(()=>P[19]||(P[19]=[z(" Cancel ",-1)])),_:1,__:[19]}),v(pe,{onClick:te,disabled:!C.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:H(()=>P[20]||(P[20]=[z(" Block Task ",-1)])),_:1,__:[20]},8,["disabled"])])])]),_:1},8,["show"])]))}};function oo(l){const t=Ie();return{userSignature:U(()=>{const i=t.value&&t.value.name?t.value.name:"",n=l.name??"",a="+61 456 639 389",u="ozeeweb.com.au",d="#1a73e8",c="#fbbc05",m="#1a202c",p="#4a5568",f="#e5e7eb",y="#f9fafb",T=`${window.location.origin}/logo.png`,C=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/facebook-new.png`,S=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/twitter.png`,h=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/linkedin.png`,x=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/instagram-new.png`;return`
            <div style="font-family: 'Inter', sans-serif; padding: 20px; border: 1px solid ${f}; margin-top: 30px; background-color: ${y}; border-radius: 8px; overflow: hidden; box-shadow: 0 0 0 3px ${c};">
                <table role="presentation" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td style="vertical-align: middle;">
                            <p style="margin: 0; font-size: 18px; color: ${m};">Best Regards</p>
                            <p style="margin: 0; font-size: 18px; font-weight: bold; color: ${m};">${i}</p>
                            <p style="margin: 5px 0 5px 0; font-size: 14px; color: ${p};">${n}</p>
                            <p style="margin: 0 0 15px 0; font-size: 12px; color: ${p};">
                                Your website and social media are like your home, first impressions matter!
                            </p>
                            <table role="presentation" cellspacing="0" cellpadding="0">
                                <tr>
                                    <td style="padding-right: 15px;">
                                        <p style="margin: 0; font-size: 13px; color: ${p};">📞 ${a}</p>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: ${p};">🌐 <a href="https://${u}" target="_blank" style="color: ${d}; text-decoration: none;">${u}</a></p>
                                    </td>
                                </tr>
                            </table>
                            <div style="margin-top: 15px; text-align: left;">
                                <a href="https://www.facebook.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${C}" alt="Facebook" style="vertical-align: middle;">
                                </a>
                                <a href="https://twitter.com/yourhandle" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${S}" alt="Twitter" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.linkedin.com/in/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${h}" alt="LinkedIn" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.instagram.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${x}" alt="Instagram" style="vertical-align: middle;">
                                </a>
                            </div>
                        </td>
                        <td style="padding-left: 20px; vertical-align: middle; width: 120px; text-align: right;">
                            <img src="${T}" alt="Company Logo" width="100" style="display: block; border-radius: 8px; margin-left: auto;">
                        </td>
                    </tr>
                </table>

                <p style="margin-top: 25px; font-size: 12px; color: ${p}; text-align: center;">
                    Powered by MMS IT & Web Solutions PTY Ltd.
                </p>
                <p style="margin-top: 10px; font-style: italic; color: ${p}; text-align: center; font-size: 13px;">
                    Please consider the environment before printing this email.
                </p>
                <p style="margin-top: 10px; text-align: center; font-size: 13px;">
                    How did I do? <a href="https://www.example.com/review" target="_blank" style="color: ${d}; text-decoration: none; font-weight: bold;">Leave a review!</a>
                </p>
            </div>
        `})}}const ro={class:"mb-4"},uo={key:0,class:"text-gray-500 text-sm"},co={key:1,class:"text-red-500 text-sm"},mo={class:"mb-4"},vo={class:"mb-6"},po={class:"mb-2 flex justify-end space-x-2"},ho={class:"mb-4"},go={key:0,class:"mt-2"},yo={class:"text-gray-700 text-base mb-2"},fo=["innerHTML"],bo={class:"p-6"},wo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},_o={class:"block sm:inline"},xo={class:"mb-4"},ko={class:"mb-6"},Do={class:"flex justify-end space-x-3"},Co={class:"p-6"},To={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Eo={class:"block sm:inline"},So={class:"mb-4"},Mo={class:"mb-6"},jo={class:"flex justify-end space-x-3"},$o={__name:"ComponseEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},userProjectRole:{type:Object,required:!0}},emits:["close","submitted","error"],setup(l,{emit:t}){const s=l,i=t,n=Ce({project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),a=_([]),u=_(!0),d=_(""),c=_(!1),m=_(""),p=_(""),f=_(""),y=_(!1),T=_(""),C=_("bullet"),S=_(""),h=_("full_name"),x=_(""),N=_([{value:"full_name",label:"Full Name"},{value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"custom",label:"Custom"}]),{userSignature:A}=oo(U(()=>s.userProjectRole)),V=U(()=>n.body||""),{processedHtmlBody:w}=ms(V),B=U(()=>{if(n.client_ids&&n.client_ids.length>0){const I=n.client_ids[0],M=a.value.find(K=>K.id===I);if(M){const K=M.name.split(" ").filter(te=>te.length>0),re=K.length>0?K[0]:"",Se=K.length>1?K[K.length-1]:"";switch(h.value){case"full_name":return`Hi ${M.name},`;case"first_name":return`Hi ${re},`;case"last_name":return`Hi ${Se},`;case"custom":return`Hi ${x.value.trim()||"there"},`;default:return`Hi ${M.name},`}}}return"Hi there,"});ce(()=>s.show,I=>{I&&(Object.assign(n,{project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),h.value="full_name",x.value="",d.value="",b())},{immediate:!0});const R=I=>{const M={...I};return M.client_ids&&Array.isArray(M.client_ids)&&(M.client_ids=M.client_ids.map(K=>({id:K}))),M.body=w.value,M.greeting_name=B.value,M.custom_greeting_name=x.value.trim(),M.first_client_id=n.client_ids&&n.client_ids.length>0?n.client_ids[0]:null,M},$=()=>{i("close")},E=I=>{i("submitted",I)},k=I=>{i("error",I)},O=()=>{m.value="",p.value="",f.value="",c.value=!0},ee=()=>{if(!m.value.trim()){f.value="Link text cannot be empty.";return}let I=p.value.trim();!I.startsWith("http://")&&!I.startsWith("https://")&&(I="http://"+I);try{new URL(I)}catch{f.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const M=`[${m.value.trim()}] {${I}}`;n.body+=M,c.value=!1,m.value="",p.value="",f.value=""},ne=()=>{T.value="",C.value="bullet",S.value="",y.value=!0},j=()=>{const I=T.value.split(`
`).map(re=>re.trim()).filter(re=>re!=="");if(I.length===0){S.value="Please enter at least one list item.";return}const M=C.value==="bullet"?"ul":"ol";let K=`<${M}>`;I.forEach(re=>{K+=`<li>${re}</li>`}),K+=`</${M}>`,n.body+=K,y.value=!1,T.value="",S.value=""},b=async()=>{var I,M;u.value=!0,d.value=null;try{const K=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);a.value=K.data}catch(K){console.error("Failed to fetch project clients:",K),d.value=((M=(I=K.response)==null?void 0:I.data)==null?void 0:M.message)||"Failed to load client data."}finally{u.value=!1}};return fe(()=>{}),(I,M)=>(o(),r(J,null,[v(Ve,{show:l.show,title:"Compose New Email","api-endpoint":"/api/emails","http-method":"post","form-data":n,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","format-data-for-api":R,onClose:$,onSubmitted:E,onError:k,"max-width":"3xl"},{default:H(({errors:K})=>[e("div",ro,[v(q,{for:"client_ids",value:"To (Clients)"}),u.value?(o(),r("div",uo,"Loading clients...")):d.value?(o(),r("div",co,g(d.value),1)):(o(),le(et,{key:2,modelValue:n.client_ids,"onUpdate:modelValue":M[0]||(M[0]=re=>n.client_ids=re),options:a.value,placeholder:"Select one or more clients","label-key":"name","value-key":"id"},null,8,["modelValue","options"])),v(ae,{message:K.client_ids?K.client_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",mo,[v(q,{for:"subject",value:"Subject"}),v(me,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:n.subject,"onUpdate:modelValue":M[1]||(M[1]=re=>n.subject=re),required:""},null,8,["modelValue"]),v(ae,{message:K.subject?K.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",vo,[e("div",po,[v(_e,{type:"button",onClick:ne},{default:H(()=>M[13]||(M[13]=[z(" Insert List ",-1)])),_:1,__:[13]}),v(_e,{type:"button",onClick:O},{default:H(()=>M[14]||(M[14]=[z(" Insert Link ",-1)])),_:1,__:[14]})]),e("div",ho,[v(q,{for:"greeting_type",value:"Address Client By"}),v(he,{id:"greeting_type",modelValue:h.value,"onUpdate:modelValue":M[2]||(M[2]=re=>h.value=re),options:N.value,"value-key":"value","label-key":"label",class:"mt-1 block w-full"},null,8,["modelValue","options"]),h.value==="custom"?(o(),r("div",go,[v(q,{for:"custom_greeting_name",value:"Custom Name"}),v(me,{id:"custom_greeting_name",type:"text",class:"mt-1 block w-full",modelValue:x.value,"onUpdate:modelValue":M[3]||(M[3]=re=>x.value=re),placeholder:"e.g., Azaan"},null,8,["modelValue"])])):D("",!0)]),e("p",yo,g(B.value),1),v(q,{for:"body",value:"Email Body",class:"sr-only"}),v(gs,{id:"body",modelValue:n.body,"onUpdate:modelValue":M[4]||(M[4]=re=>n.body=re),placeholder:"Compose your email here...",height:"300px"},null,8,["modelValue"]),v(ae,{message:K.body?K.body[0]:"",class:"mt-2"},null,8,["message"])]),G(A)?(o(),r("div",{key:0,class:"unselectable-signature",innerHTML:G(A)},null,8,fo)):D("",!0)]),_:1},8,["show","form-data"]),v($e,{show:c.value,onClose:M[8]||(M[8]=K=>c.value=!1),"max-width":"md"},{default:H(()=>[e("div",bo,[M[17]||(M[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),f.value?(o(),r("div",wo,[e("span",_o,g(f.value),1)])):D("",!0),e("div",xo,[v(q,{for:"link_text",value:"Link Text"}),v(me,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:m.value,"onUpdate:modelValue":M[5]||(M[5]=K=>m.value=K),onKeyup:ze(ee,["enter"])},null,8,["modelValue"])]),e("div",ko,[v(q,{for:"link_url",value:"URL"}),v(me,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:p.value,"onUpdate:modelValue":M[6]||(M[6]=K=>p.value=K),placeholder:"e.g., https://www.example.com",onKeyup:ze(ee,["enter"])},null,8,["modelValue"])]),e("div",Do,[v(_e,{onClick:M[7]||(M[7]=K=>c.value=!1)},{default:H(()=>M[15]||(M[15]=[z("Cancel",-1)])),_:1,__:[15]}),v(pe,{onClick:ee},{default:H(()=>M[16]||(M[16]=[z("Insert",-1)])),_:1,__:[16]})])])]),_:1},8,["show"]),v($e,{show:y.value,onClose:M[12]||(M[12]=K=>y.value=!1),"max-width":"md"},{default:H(()=>[e("div",Co,[M[21]||(M[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),S.value?(o(),r("div",To,[e("span",Eo,g(S.value),1)])):D("",!0),e("div",So,[v(q,{for:"list_items",value:"List Items (one per line)"}),ge(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":M[9]||(M[9]=K=>T.value=K),placeholder:"Enter each list item on a new line"},null,512),[[ke,T.value]])]),e("div",Mo,[v(q,{for:"list_type",value:"List Type"}),ge(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":M[10]||(M[10]=K=>C.value=K)},M[18]||(M[18]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[qe,C.value]])]),e("div",jo,[v(_e,{onClick:M[11]||(M[11]=K=>y.value=!1)},{default:H(()=>M[19]||(M[19]=[z("Cancel",-1)])),_:1,__:[19]}),v(pe,{onClick:j},{default:H(()=>M[20]||(M[20]=[z("Insert List",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])],64))}},_t=Ee($o,[["__scopeId","data-v-70bf1503"]]),Vo={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Ao={class:"flex justify-between items-center mb-4"},Oo={key:0,class:"flex gap-3"},Io={key:1,class:"mt-2 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative",role:"alert"},Lo={class:"block sm:inline"},Po={class:"mb-4 bg-gray-50 p-4 rounded-lg"},Uo={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},No={class:"mt-1 relative rounded-md shadow-sm"},Ro={__name:"ProjectEmailsTab",props:{projectId:{type:Number,required:!0},canViewEmails:{type:Boolean,required:!0},canComposeEmails:{type:Boolean,required:!0},canApproveEmails:{type:Boolean,required:!0},userProjectRole:{type:Object,required:!0},openCompose:{type:Boolean,required:!1,default:!1}},emits:["emailsUpdated","resetOpenCompose"],setup(l,{emit:t}){const s=l,i=t,n=_([]),a=_(!0),u=_(""),d=_(null),c=_(!1),m=_(!1),p=_(""),f=_(""),y=_("post"),T=_(""),C=_(""),S=_(!1),h=_(!1),x=_(null),N=_(""),A=_(""),V=_(""),w=_(null);Ie();const B=Ce({type:"",startDate:"",endDate:"",search:""});let R=null;const $=()=>{O()},E=()=>{B.type="",B.startDate="",B.endDate="",B.search="",O()},k=()=>{clearTimeout(R),R=setTimeout(()=>{$()},500)},O=async()=>{a.value=!0,u.value="";try{const te=new URLSearchParams;B.type&&te.append("type",B.type),B.startDate&&te.append("start_date",B.startDate),B.endDate&&te.append("end_date",B.endDate),B.search&&te.append("search",B.search);const L=te.toString(),P=`/api/projects/${s.projectId}/emails-simplified${L?`?${L}`:""}`,W=await window.axios.get(P);n.value=W.data,i("emailsUpdated",n.value)}catch(te){u.value="Failed to load email data.",console.error("Error fetching project emails:",te)}finally{a.value=!1}},ee=async te=>{d.value=null,c.value=!0;try{const L=await window.axios.get(`/api/emails/${te.id}`);d.value={...te,subject:L.data.subject,body:L.data.body_html}}catch(L){console.error("Failed to fetch full email details:",L),d.value={subject:"Error",body:"Failed to load email content.",created_at:new Date().toISOString(),status:"error",sender:{name:"System"}}}},ne=async te=>{try{console.log("Opening email editor for email ID:",te.id),d.value=te;const P=(await window.axios.get(`/api/emails/${te.id}/edit-content`)).data;P.template_id?(console.log("Opening template-based email editor for email ID:",te.id),x.value=te.id,N.value=`/api/emails/${te.id}/edit-and-approve`,A.value="Approve & Send",V.value="Email updated and approved successfully!",w.value=P.client_id,h.value=!0,c.value=!1):(p.value="Edit and Approve Email",f.value=`/api/emails/${te.id}/edit-and-approve`,y.value="post",T.value="Approve & Send",C.value="Email updated and approved successfully!",m.value=!0,c.value=!1)}catch(L){console.error("Failed to determine email type:",L),u.value="Failed to load email for editing."}},j=te=>{d.value=te,p.value="Reject Email",f.value=`/api/emails/${te.id}/reject`,y.value="post",T.value="Reject Email",C.value="Email rejected successfully!",m.value=!0,c.value=!1},b=async te=>{console.log("Form submitted successfully:",te),await O(),m.value=!1},I=()=>{m.value=!1},M=()=>{S.value=!1,i("resetOpenCompose")},K=async te=>{console.log("Compose email submitted successfully:",te),await O(),S.value=!1,i("resetOpenCompose")},re=()=>{h.value=!1},Se=async te=>{console.log("Template email edited and submitted successfully:",te),await O(),h.value=!1};return ce(()=>s.openCompose,te=>{console.log("Watcher triggered: openCompose changed to",te),te&&(console.log("Opening compose email modal"),S.value=!0)}),fe(()=>{s.canViewEmails&&O(),s.openCompose&&(S.value=!0)}),(te,L)=>{var P;return l.canViewEmails?(o(),r("div",Vo,[e("div",Ao,[L[10]||(L[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Email Communication",-1)),l.canComposeEmails?(o(),r("div",Oo,[v(pe,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:L[0]||(L[0]=W=>S.value=!0)},{default:H(()=>L[9]||(L[9]=[z(" Compose Email ",-1)])),_:1,__:[9]})])):D("",!0),u.value?(o(),r("div",Io,[e("span",Lo,g(u.value),1)])):D("",!0)]),e("div",Po,[e("div",Uo,[e("div",null,[v(q,{for:"typeFilter",value:"Type"}),ge(e("select",{id:"typeFilter","onUpdate:modelValue":L[1]||(L[1]=W=>B.type=W),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:$},L[11]||(L[11]=[e("option",{value:""},"All Types",-1),e("option",{value:"sent"},"Sent",-1),e("option",{value:"received"},"Received",-1)]),544),[[qe,B.type]])]),e("div",null,[v(q,{for:"startDate",value:"From Date"}),v(me,{type:"date",id:"startDate",modelValue:B.startDate,"onUpdate:modelValue":L[2]||(L[2]=W=>B.startDate=W),class:"mt-1 block w-full",onChange:$},null,8,["modelValue"])]),e("div",null,[v(q,{for:"endDate",value:"To Date"}),v(me,{type:"date",id:"endDate",modelValue:B.endDate,"onUpdate:modelValue":L[3]||(L[3]=W=>B.endDate=W),class:"mt-1 block w-full",onChange:$},null,8,["modelValue"])]),e("div",null,[v(q,{for:"searchFilter",value:"Search Content"}),e("div",No,[v(me,{type:"text",id:"searchFilter",modelValue:B.search,"onUpdate:modelValue":L[4]||(L[4]=W=>B.search=W),class:"block w-full pr-10",placeholder:"Search in email content...",onInput:k},null,8,["modelValue"]),L[12]||(L[12]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:E}," Reset Filters ")])]),v(ys,{emails:n.value,loading:a.value,error:u.value,onView:ee},null,8,["emails","loading","error"]),v(vs,{show:c.value,email:d.value,"can-approve-emails":l.canApproveEmails,onClose:L[5]||(L[5]=W=>c.value=!1),onEdit:ne,onReject:j},null,8,["show","email","can-approve-emails"]),v(_t,{show:S.value,"project-id":l.projectId,"user-project-role":l.userProjectRole,onClose:M,onSubmitted:K,onError:L[6]||(L[6]=W=>console.error("ComposeEmailModal error:",W))},null,8,["show","project-id","user-project-role"]),v(ps,{show:m.value,title:p.value,"api-endpoint":f.value,"http-method":y.value,"submit-button-text":T.value,"success-message":C.value,"email-id":(P=d.value)==null?void 0:P.id,"project-id":l.projectId,onClose:I,onSubmitted:b,onError:L[7]||(L[7]=W=>console.error("EmailActionModal error:",W)),onFetchEmails:O},null,8,["show","title","api-endpoint","http-method","submit-button-text","success-message","email-id","project-id"]),v(hs,{show:h.value,title:"Edit Template Email","api-endpoint":N.value,"http-method":"post","submit-button-text":A.value,"success-message":V.value,"email-id":x.value,"project-id":l.projectId,"client-id":w.value,onClose:re,onSubmitted:Se,onError:L[8]||(L[8]=W=>console.error("EditTemplateEmailModal error:",W))},null,8,["show","api-endpoint","submit-button-text","success-message","email-id","project-id","client-id"])])):D("",!0)}}},Fo={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Ho={class:"flex justify-between items-center mb-4"},Bo={class:"flex gap-3"},Wo={class:"mb-4 bg-gray-50 p-4 rounded-lg"},Yo={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},zo={class:"mt-1 relative rounded-md shadow-sm"},qo={class:"mb-8 p-4 bg-blue-50 rounded-md"},Go={class:"flex items-center"},Ko={class:"text-sm text-blue-800"},Jo={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Zo={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},Xo={key:2,class:"space-y-4"},Qo={class:"flex justify-between"},er={class:"flex-grow"},tr={key:0,class:"text-xs text-red-400 block mt-1"},sr={class:"flex items-center mt-1"},lr={class:"text-xs text-gray-500"},ar={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},ir={key:0},nr={key:3,class:"text-gray-400 text-sm"},or={class:"p-6"},rr={class:"flex justify-between items-center mb-4"},dr={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},ur={class:"text-sm text-gray-700"},cr={class:"text-xs text-gray-500 mt-1"},mr={key:1,class:"mb-4"},vr={key:0,class:"text-center py-4"},pr={key:1,class:"space-y-3 max-h-60 overflow-y-auto"},hr={class:"text-sm text-gray-700"},gr={class:"text-xs text-gray-500 mt-1"},yr={key:2,class:"text-center py-3"},fr={key:2,class:"mb-4"},br={key:0,class:"mt-2 text-sm text-red-600"},wr={key:3,class:"mt-6 flex justify-end"},_r={__name:"ProjectNotesTab",props:{projectId:{type:Number,required:!0},googleChatId:{type:String,default:null},canViewNotes:{type:Boolean,required:!0},canAddNotes:{type:Boolean,required:!0}},emits:["notesUpdated"],setup(l,{emit:t}){const s=l,i=t,n=_([]),a=_(!0),u=_(""),d=_(!1),c=_(!1),m=_(null),p=_(""),f=_(""),y=_([]),T=_(!1),C=Ce({startDate:"",endDate:"",search:""});let S=null;const h=async()=>{a.value=!0,u.value="";try{const R=new URLSearchParams;C.startDate&&R.append("start_date",C.startDate),C.endDate&&R.append("end_date",C.endDate),C.search&&R.append("search",C.search);const $=R.toString(),E=`/api/projects/${s.projectId}/notes${$?`?${$}`:""}`,k=await window.axios.get(E);n.value=k.data,i("notesUpdated",n.value)}catch(R){u.value="Failed to load notes data.",console.error("Error fetching project notes:",R)}finally{a.value=!1}},x=()=>{d.value=!0},N=async R=>{m.value=R,p.value="",f.value="",y.value=[],T.value=!0,c.value=!0;try{const $=await window.axios.get(`/api/projects/${s.projectId}/notes/${R.id}/replies`);$.data.success?y.value=$.data.replies:console.error("Failed to fetch replies:",$.data.message)}catch($){console.error("Error fetching replies:",$)}finally{T.value=!1}},A=async()=>{var R,$;if(!m.value||!p.value.trim()){f.value="Reply content is required";return}f.value="";try{const E=await window.axios.post(`/api/projects/${s.projectId}/notes/${m.value.id}/reply`,{content:p.value});if(E.data.success){p.value="",T.value=!0;const k=await window.axios.get(`/api/projects/${s.projectId}/notes/${m.value.id}/replies`);k.data.success&&(y.value=k.data.replies),T.value=!1,await h()}else f.value=E.data.message||"Failed to send reply"}catch(E){console.error("Error sending reply:",E),f.value=(($=(R=E.response)==null?void 0:R.data)==null?void 0:$.message)||"An error occurred while sending the reply"}},V=()=>{h()},w=()=>{C.startDate="",C.endDate="",C.search="",h()},B=()=>{clearTimeout(S),S=setTimeout(()=>{V()},500)};return fe(()=>{s.canViewNotes&&h()}),(R,$)=>l.canViewNotes?(o(),r("div",Fo,[e("div",Ho,[$[10]||($[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Notes",-1)),e("div",Bo,[l.canAddNotes?(o(),le(pe,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:x},{default:H(()=>$[9]||($[9]=[z(" Add Note ",-1)])),_:1,__:[9]})):D("",!0)])]),e("div",Wo,[e("div",Yo,[e("div",null,[v(q,{for:"noteStartDate",value:"From Date"}),v(me,{type:"date",id:"noteStartDate",modelValue:C.startDate,"onUpdate:modelValue":$[0]||($[0]=E=>C.startDate=E),class:"mt-1 block w-full",onChange:V},null,8,["modelValue"])]),e("div",null,[v(q,{for:"noteEndDate",value:"To Date"}),v(me,{type:"date",id:"noteEndDate",modelValue:C.endDate,"onUpdate:modelValue":$[1]||($[1]=E=>C.endDate=E),class:"mt-1 block w-full",onChange:V},null,8,["modelValue"])]),e("div",null,[v(q,{for:"noteSearchFilter",value:"Search Content"}),e("div",zo,[v(me,{type:"text",id:"noteSearchFilter",modelValue:C.search,"onUpdate:modelValue":$[2]||($[2]=E=>C.search=E),class:"block w-full pr-10",placeholder:"Search in note content...",onInput:B},null,8,["modelValue"]),$[11]||($[11]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:w}," Reset Filters ")])]),e("div",qo,[e("div",Go,[$[13]||($[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",Ko,[$[12]||($[12]=z(" Daily Standups are now available in their own dedicated tab. ",-1)),e("button",{onClick:$[3]||($[3]=E=>R.$emit("changeTab","standups")),class:"text-blue-600 hover:text-blue-800 font-medium underline"}," Click here to view Daily Standups ")])])]),e("div",null,[$[15]||($[15]=e("h5",{class:"text-md font-semibold text-gray-900 mb-4 border-b pb-2"},"Notes",-1)),a.value?(o(),r("div",Jo," Loading notes... ")):u.value?(o(),r("div",Zo,g(u.value),1)):n.value.length?(o(),r("div",Xo,[(o(!0),r(J,null,Q(n.value,E=>{var k;return o(),r("div",{key:E.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",Qo,[e("div",er,[e("p",{class:se(["text-sm",{"text-gray-700":E.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":E.content==="[Encrypted content could not be decrypted]"}])},[z(g(E.content)+" ",1),E.content==="[Encrypted content could not be decrypted]"?(o(),r("span",tr," (There was an issue decrypting this note. Please contact an administrator.) ")):D("",!0)],2),e("div",sr,[e("p",lr,"Added by "+g(((k=E.user)==null?void 0:k.name)||"Unknown")+" on "+g(new Date(E.created_at).toLocaleDateString()),1),E.reply_count>0?(o(),r("span",ar,g(E.reply_count)+" "+g(E.reply_count===1?"reply":"replies"),1)):D("",!0)])]),l.googleChatId&&E.chat_message_id?(o(),r("div",ir,[v(_e,{class:"text-sm text-indigo-600 hover:text-indigo-800",onClick:O=>N(E)},{default:H(()=>$[14]||($[14]=[z(" View ",-1)])),_:2,__:[14]},1032,["onClick"])])):D("",!0)])])}),128))])):(o(),r("p",nr,"No notes available."))]),v(ft,{show:d.value,"project-id":l.projectId,onClose:$[4]||($[4]=E=>d.value=!1),onNoteAdded:h},null,8,["show","project-id"]),v($e,{show:c.value,onClose:$[8]||($[8]=E=>c.value=!1)},{default:H(()=>{var E;return[e("div",or,[e("div",rr,[$[17]||($[17]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Reply to Note",-1)),e("button",{onClick:$[5]||($[5]=k=>c.value=!1),class:"text-gray-400 hover:text-gray-500"},$[16]||($[16]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),m.value?(o(),r("div",dr,[e("p",ur,g(m.value.content),1),e("p",cr,"Added by "+g(((E=m.value.user)==null?void 0:E.name)||"Unknown")+" on "+g(new Date(m.value.created_at).toLocaleDateString()),1)])):D("",!0),m.value?(o(),r("div",mr,[$[20]||($[20]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Replies",-1)),T.value?(o(),r("div",vr,$[18]||($[18]=[e("p",{class:"text-gray-500 text-sm"},"Loading replies...",-1)]))):y.value.length?(o(),r("div",pr,[(o(!0),r(J,null,Q(y.value,k=>{var O;return o(),r("div",{key:k.id,class:"p-2 bg-gray-50 rounded border-l-2 border-indigo-300"},[e("p",hr,g(k.content),1),e("p",gr,"Replied by "+g(((O=k.user)==null?void 0:O.name)||"Unknown")+" on "+g(new Date(k.created_at).toLocaleDateString()),1)])}),128))])):(o(),r("div",yr,$[19]||($[19]=[e("p",{class:"text-gray-500 text-sm"},"No replies yet. Be the first to reply!",-1)])))])):D("",!0),l.canAddNotes?(o(),r("div",fr,[v(q,{for:"reply-content",value:"Your Reply"}),ge(e("textarea",{id:"reply-content","onUpdate:modelValue":$[6]||($[6]=k=>p.value=k),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your reply..."},null,512),[[ke,p.value]]),f.value?(o(),r("p",br,g(f.value),1)):D("",!0)])):D("",!0),l.canAddNotes?(o(),r("div",wr,[v(_e,{onClick:$[7]||($[7]=k=>c.value=!1),class:"mr-2"},{default:H(()=>$[21]||($[21]=[z("Cancel",-1)])),_:1,__:[21]}),v(pe,{onClick:A},{default:H(()=>$[22]||($[22]=[z("Send Reply",-1)])),_:1,__:[22]})])):D("",!0)])]}),_:1},8,["show"])])):D("",!0)}},xr={class:"w-full"},kr={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Dr={key:1,class:"text-red-600 text-sm py-2 text-center"},Cr={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Tr={class:"p-4 bg-blue-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Er={class:"text-2xl font-bold text-blue-900 mt-1"},Sr={class:"p-4 bg-green-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Mr={class:"text-2xl font-bold text-green-900 mt-1"},jr={class:"p-4 bg-red-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},$r={class:"text-2xl font-bold mt-1"},Vr={key:3,class:"space-y-2 text-sm text-gray-700 mt-6 pt-4 border-t border-gray-200"},Ar={key:0},Or={class:"text-gray-900 whitespace-pre-wrap"},Ir={key:4,class:"text-gray-400 text-sm mt-4 text-center"},Lr={__name:"ProjectFinancialsCard",props:{projectId:{type:Number,required:!0},canViewProjectServicesAndPayments:{type:Boolean,default:!1},canViewProjectTransactions:{type:Boolean,default:!1}},setup(l){const t=l,s=_(null),i=_([]),n=_(!0),a=_(null),u=Fe,d=U(()=>{var T;if(!ve.value||Object.keys(ve.value).length===0)return 0;const y=parseFloat(((T=s.value)==null?void 0:T.total_amount)||0);return Oe(y,"USD",u.value)}),c=U(()=>!i.value.length||!ve.value||Object.keys(ve.value).length===0?0:i.value.filter(y=>y.type==="expense").reduce((y,T)=>y+Oe(parseFloat(T.amount||0),T.currency,u.value),0)),m=U(()=>!i.value.length||!ve.value||Object.keys(ve.value).length===0?0:i.value.filter(y=>y.type==="income").reduce((y,T)=>y+Oe(parseFloat(T.amount||0),T.currency,u.value),0)),p=U(()=>m.value-c.value),f=async()=>{var y,T;if(n.value=!0,a.value=null,i.value=[],!ve.value||Object.keys(ve.value).length===0){a.value="Currency rates not loaded. Please try again.",n.value=!1;return}if(!t.canViewProjectServicesAndPayments&&!t.canViewProjectTransactions){a.value="You don't have permission to view project financials.",n.value=!1;return}try{if(t.canViewProjectServicesAndPayments){const C=await window.axios.get(`/api/projects/${t.projectId}/sections/services-payment`);s.value=C.data}else s.value=null;if(t.canViewProjectTransactions){const C=await window.axios.get(`/api/projects/${t.projectId}/sections/transactions`);i.value=C.data}else i.value=[]}catch(C){console.error("Failed to fetch project financials:",C),a.value=((T=(y=C.response)==null?void 0:y.data)==null?void 0:T.message)||"Failed to load financial data."}finally{n.value=!1}};return ce([()=>t.canViewProjectServicesAndPayments,()=>t.canViewProjectTransactions,u,ve],(y,T)=>{t.projectId&&ve.value&&Object.keys(ve.value).length>0?f():t.projectId||(n.value=!0,a.value=null)},{immediate:!0,deep:!0}),(y,T)=>{var C,S;return o(),r("div",xr,[n.value?(o(),r("div",kr,[(o(),r(J,null,Q(4,h=>e("div",{key:h,class:"p-4 bg-gray-100 rounded-lg animate-pulse h-24"},T[0]||(T[0]=[e("div",{class:"h-4 bg-gray-200 rounded w-1/2 mb-3"},null,-1),e("div",{class:"h-6 bg-gray-200 rounded w-3/4"},null,-1)]))),64))])):a.value?(o(),r("div",Dr,[e("p",null,g(a.value),1)])):(o(),r("div",Cr,[e("div",Tr,[T[1]||(T[1]=e("p",{class:"text-sm font-medium text-blue-800"},"Contract Value",-1)),e("p",Er,g(G(je)(d.value,G(u).value)),1)]),e("div",Sr,[T[2]||(T[2]=e("p",{class:"text-sm font-medium text-green-800"},"Total Income",-1)),e("p",Mr,g(G(je)(m.value,G(u))),1)]),e("div",jr,[T[3]||(T[3]=e("p",{class:"text-sm font-medium text-red-800"},"Total Expenses",-1)),e("p",$r,g(G(je)(c.value,G(u))),1)]),e("div",{class:se(["p-4 rounded-lg shadow-sm transition-shadow hover:shadow-lg",{"bg-green-100":p.value>=0,"bg-red-100":p.value<0}])},[e("p",{class:se(["text-sm font-medium",{"text-green-800":p.value>=0,"text-red-800":p.value<0}])},"Profit/Loss",2),e("p",{class:se(["text-2xl font-bold mt-1",{"text-green-900":p.value>=0,"text-red-900":p.value<0}])},g(G(je)(p.value,G(u))),3)],2)])),!n.value&&!a.value&&((C=s.value)!=null&&C.contract_details)?(o(),r("dl",Vr,[(S=s.value)!=null&&S.contract_details?(o(),r("div",Ar,[T[4]||(T[4]=e("dt",{class:"font-medium w-full block mt-2"},"Contract Details:",-1)),e("dd",Or,g(s.value.contract_details),1)])):D("",!0)])):D("",!0),!n.value&&!a.value&&!s.value&&!i.value.length?(o(),r("p",Ir," No financial information available. ")):D("",!0)])}}},Pr={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},Ur={key:0},Nr={key:1,class:"text-red-600 text-sm py-2"},Rr={key:2,class:"space-y-1 text-sm text-gray-700"},Fr={key:0},Hr={key:3,class:"text-gray-400 text-sm"},Br={__name:"ProjectClientsCard",props:{projectId:{type:Number,required:!0},canViewClientContacts:{type:Boolean,default:!1}},setup(l){const t=l,s=_([]),i=_(!0),n=_(null),a=async()=>{var u,d;if(i.value=!0,n.value=null,!t.canViewClientContacts){n.value="You don't have permission to view project clients.",i.value=!1;return}try{const c=await window.axios.get(`/api/projects/${t.projectId}/sections/clients?type=clients`);s.value=c.data}catch(c){console.error("Failed to fetch project clients:",c),n.value=((d=(u=c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load client data."}finally{i.value=!1}};return fe(()=>{a()}),ce(()=>t.canViewClientContacts,()=>{a()}),(u,d)=>(o(),r("div",Pr,[d[1]||(d[1]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Clients",-1)),i.value?(o(),r("div",Ur,d[0]||(d[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):n.value?(o(),r("div",Nr,[e("p",null,g(n.value),1)])):s.value.length?(o(),r("ul",Rr,[(o(!0),r(J,null,Q(s.value,c=>(o(),r("li",{key:c.id},[z(g(c.name)+" ",1),c.email?(o(),r("span",Fr,"("+g(c.email)+")",1)):D("",!0)]))),128))])):(o(),r("p",Hr,"No clients assigned."))]))}},Wr={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},Yr={key:0},zr={key:1,class:"text-red-600 text-sm py-2"},qr={key:2},Gr={key:0,class:"space-y-2 text-sm text-gray-700 mb-4"},Kr={class:"font-medium"},Jr={class:"text-xs text-gray-500 mt-1"},Zr={key:1,class:"text-gray-400 text-sm mb-4"},Xr={__name:"ProjectTeamCard",props:{projectId:{type:Number,required:!0},canViewUsers:{type:Boolean,default:!1}},setup(l){const t=l,s=Ie(),i=_([]),n=_(!0),a=_(null),u=async()=>{var c,m;if(n.value=!0,a.value=null,!t.canViewUsers){a.value="You don't have permission to view project team members.",n.value=!1,i.value=[];return}try{const p=await window.axios.get(`/api/projects/${t.projectId}/sections/users`);i.value=p.data.users||[],console.log("Fetched team users:",i.value)}catch(p){console.error("Failed to fetch project users:",p),a.value=((m=(c=p.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load team data."}finally{n.value=!1}},d=c=>{if(!c.availabilities||c.availabilities.length===0)return"No availability submitted for today.";const m=c.availabilities[0];return m.is_available?m.time_slots&&m.time_slots.length>0?`${m.time_slots.map(f=>`${f.start_time}-${f.end_time}`).join(", ")}`:"No specific slots provided.":`Not available today: ${m.reason||"No reason provided"}`};return fe(()=>{u()}),ce([()=>t.canViewUsers,()=>s.value,()=>t.projectId],()=>{u()},{deep:!0}),(c,m)=>(o(),r("div",Wr,[m[3]||(m[3]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Team",-1)),n.value?(o(),r("div",Yr,m[0]||(m[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):a.value?(o(),r("div",zr,[e("p",null,g(a.value),1)])):(o(),r("div",qr,[i.value.length?(o(),r("ul",Gr,[(o(!0),r(J,null,Q(i.value,p=>{var f;return o(),r("li",{key:p.id,class:"border-b pb-2 last:border-b-0"},[e("div",null,[e("strong",null,g(p.name),1),m[1]||(m[1]=z(" (Role: ",-1)),e("span",Kr,g(((f=p.pivot)==null?void 0:f.role)||"N/A"),1),m[2]||(m[2]=z(") ",-1))]),e("div",Jr," Today's Availability: "+g(d(p)),1)])}),128))])):(o(),r("p",Zr,"No team members assigned."))]))]))}},Qr={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},ed={key:0,class:"space-y-3"},td={key:1,class:"text-red-600 text-sm py-2 text-center"},sd={key:2},ld={class:"space-y-1 text-sm text-gray-700"},ad={key:0},id={class:"inline-block text-gray-900"},nd={class:"inline-block text-gray-900"},od={class:"inline-block text-gray-900"},rd={key:1},dd={key:0,class:"text-gray-400 text-sm"},ud={key:1,class:"text-gray-400 text-sm"},cd={key:0,class:"mt-4 text-right"},md={__name:"UserFinancialCard",props:{projectId:{type:Number,required:!0}},emits:["viewUserTransactions"],setup(l,{emit:t}){const s=l,i=t,n=Ie(),a=_(!0),u=_(null),d=_([]),c=Fe,m=async()=>{var S,h;if(a.value=!0,u.value=null,!n.value||!n.value.id||!s.projectId){d.value=[],a.value=!1;return}if(!ve.value||Object.keys(ve.value).length===0){u.value="Currency rates not loaded. Please try again.",a.value=!1;return}try{const x=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${n.value.id}`);d.value=x.data,console.log("User-specific transactions:",d.value)}catch(x){console.error("Failed to fetch user transactions for UserFinancialsCard:",x),u.value=((h=(S=x.response)==null?void 0:S.data)==null?void 0:h.message)||"Failed to load your financial data.",d.value=[]}finally{a.value=!1}},p=U(()=>!n.value||!n.value.id||!d.value.length||!ve.value||Object.keys(ve.value).length===0?0:d.value.filter(h=>h.type==="expense").reduce((h,x)=>h+Oe(parseFloat(x.amount||0),x.currency,c.value),0)),f=U(()=>!n.value||!n.value.id||!d.value.length||!ve.value||Object.keys(ve.value).length===0?0:d.value.filter(h=>h.type==="bonus").reduce((h,x)=>h+Oe(parseFloat(x.amount||0),x.currency,c.value),0)),y=U(()=>!n.value||!n.value.id||!d.value.length||!ve.value||Object.keys(ve.value).length===0?0:d.value.filter(h=>(h.type==="expense"||h.type==="bonus")&&h.is_paid===1).reduce((h,x)=>h+Oe(parseFloat(x.amount||0),x.currency,c.value),0)),T=U(()=>n.value&&(p.value>0||f.value>0||y.value>0));fe(()=>{m()}),ce([()=>n.value,()=>s.projectId,c,ve],()=>{m()},{deep:!0});const C=()=>{i("viewUserTransactions")};return(S,h)=>(o(),r("div",Qr,[h[5]||(h[5]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Your Financials",-1)),a.value?(o(),r("div",ed,h[0]||(h[0]=[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"},null,-1)]))):u.value?(o(),r("div",td,[e("p",null,g(u.value),1)])):(o(),r("div",sd,[e("dl",ld,[T.value?(o(),r("div",ad,[e("div",null,[h[1]||(h[1]=e("dt",{class:"font-medium inline-block w-32"},"Agreed Amount:",-1)),e("dd",id,g(G(je)(p.value,G(c))),1)]),e("div",null,[h[2]||(h[2]=e("dt",{class:"font-medium inline-block w-32"},"Bonus Amount:",-1)),e("dd",nd,g(G(je)(f.value,G(c))),1)]),e("div",null,[h[3]||(h[3]=e("dt",{class:"font-medium inline-block w-32"},"Received Amount:",-1)),e("dd",od,g(G(je)(y.value,G(c))),1)])])):(o(),r("div",rd,[G(n)?(o(),r("p",ud," Your financials for this project are not available or you're not assigned. ")):(o(),r("p",dd," Sign in to view your specific financials. "))]))]),G(n)?(o(),r("div",cd,[v(pe,{onClick:C},{default:H(()=>h[4]||(h[4]=[z(" View Transactions ",-1)])),_:1,__:[4]})])):D("",!0)]))]))}},vd=Ee(md,[["__scopeId","data-v-34bab241"]]),pd={class:"p-4"},hd={key:0,class:"text-center text-gray-600"},gd={key:1,class:"text-red-600 text-sm py-2"},yd={key:2,class:"text-gray-500 text-center py-4"},fd={key:3,class:"overflow-x-auto"},bd={class:"min-w-full divide-y divide-gray-200"},wd={class:"bg-white divide-y divide-gray-200"},_d={class:"px-4 py-3 text-sm text-gray-900"},xd={class:"px-4 py-3 text-sm text-gray-700"},kd={class:"px-4 py-3 text-sm text-right text-gray-900"},Dd={class:"px-4 py-3 text-sm"},Cd={class:"px-4 py-3 text-sm text-gray-700"},Td={__name:"UserTransactionsModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectName:{type:String,required:!1}},emits:["close"],setup(l,{emit:t}){const s=l,i=Ie(),n=_(!0),a=_(null),u=_([]);_("PKR");const d=(m,p="USD")=>isNaN(m)||m==null?"0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:p,minimumFractionDigits:2,maximumFractionDigits:2}).format(m),c=async()=>{var m,p;if(n.value=!0,a.value=null,u.value=[],!i.value||!i.value.id||!s.projectId){a.value="User not authenticated or project ID missing.",n.value=!1;return}try{const f=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${i.value.id}`);u.value=f.data}catch(f){console.error("Failed to fetch user-specific transactions for modal:",f),a.value=((p=(m=f.response)==null?void 0:m.data)==null?void 0:p.message)||"Failed to load transactions."}finally{n.value=!1}};return ce(()=>s.show,m=>{m&&c()},{immediate:!1}),ce([()=>{var m;return(m=i.value)==null?void 0:m.id},()=>s.projectId],(m,p)=>{s.show&&c()},{deep:!0}),U(()=>`Your Transactions for Project ${s.projectId}`),(m,p)=>(o(),le(Ve,{show:l.show,title:"Transactions for: "+l.projectName,"show-footer":!1,onClose:p[0]||(p[0]=f=>m.$emit("close")),"hide-submit-button":!0,"hide-cancel-button":!0,"api-endpoint":null,"form-data":"{}"},{default:H(({errors:f})=>[e("div",pd,[n.value?(o(),r("div",hd,p[1]||(p[1]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"})],-1)]))):a.value?(o(),r("div",gd,[e("p",null,g(a.value),1)])):u.value.length===0?(o(),r("div",yd," No transactions found for you on this project. ")):(o(),r("div",fd,[e("table",bd,[p[2]||(p[2]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date")])],-1)),e("tbody",wd,[(o(!0),r(J,null,Q(u.value,y=>(o(),r("tr",{key:y.id,class:"hover:bg-gray-50 transition-colors"},[e("td",_d,g(y.description),1),e("td",xd,g(y.type),1),e("td",kd,g(d(y.amount,y.currency)),1),e("td",Dd,[e("span",{class:se({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":y.is_paid===1,"bg-yellow-100 text-yellow-800":y.is_paid===0})},g(y.is_paid===1?"Paid":"Unpaid"),3)]),e("td",Cd,g(new Date(y.created_at).toLocaleDateString()),1)]))),128))])])]))])]),_:1},8,["show","title"]))}},Ed={class:"space-y-4"},Sd={key:0},Md=["disabled"],jd={key:0,class:"mt-4"},$d=["src"],Vd={class:"flex items-center"},Ad="Create New Deliverable",Od="post",Id="Create Deliverable",Ld="Deliverable created successfully!",xt={__name:"CreateDeliverableModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0}},emits:["close","saved"],setup(l,{emit:t}){const s=l,i=t,n=Ce({title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),a=[{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],u=[{value:"pending_review",label:"Pending Review (Requires Client Approval)"},{value:"for_information",label:"For Information Only (No Approval Needed)"}],d=[{value:null,label:"Select Type (if providing URL)"},{value:"google_doc",label:"Google Document (Doc, Sheet, Slide)"},{value:"pdf",label:"PDF Document"},{value:"image",label:"Image (JPG, PNG, GIF)"},{value:"video",label:"Video (YouTube, Vimeo, etc.)"},{value:"other",label:"Other Web Link"}],c=_(null),m=_(null);ce(()=>s.show,h=>{h&&(Object.assign(n,{title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),m.value=null,c.value&&(c.value.value=""))});const p=h=>{const x=h.target.files[0];if(x)if(n.attachment_file=x,n.content_url="",n.content_url_type=null,x.type.startsWith("image/")){const N=new FileReader;N.onload=A=>{m.value=A.target.result},N.readAsDataURL(x)}else m.value=null;else n.attachment_file=null,m.value=null},f=()=>{n.content_url?(n.attachment_file=null,m.value=null,c.value&&(c.value.value="")):n.content_url_type=null},y=h=>{const x=new FormData;return x.append("title",h.title),x.append("description",h.description||""),x.append("type",h.type),x.append("is_visible_to_client",h.is_visible_to_client?1:0),x.append("initial_status",h.initial_status),h.attachment_file?x.append("attachment_file",h.attachment_file):h.content_url&&(x.append("content_url",h.content_url),x.append("content_url_type",h.content_url_type||"")),x},T=U(()=>`/api/projects/${s.projectId}/deliverables`),C=h=>{i("saved",h),i("close")},S=()=>{i("close")};return(h,x)=>(o(),le(Ve,{show:l.show,title:Ad,"api-endpoint":T.value,"http-method":Od,"form-data":n,"submit-button-text":Id,"success-message":Ld,"format-data-for-api":y,onClose:S,onSubmitted:C},{default:H(({errors:N})=>[e("div",Ed,[e("div",null,[v(q,{for:"title",value:"Title"}),v(me,{id:"title",modelValue:n.title,"onUpdate:modelValue":x[0]||(x[0]=A=>n.title=A),type:"text",class:"mt-1 block w-full",required:"",autofocus:""},null,8,["modelValue"]),v(ae,{message:N.title?N.title[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"description",value:"Description"}),ge(e("textarea",{id:"description","onUpdate:modelValue":x[1]||(x[1]=A=>n.description=A),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter deliverable description"},null,512),[[ke,n.description]]),v(ae,{message:N.description?N.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"type",value:"Deliverable Type"}),v(he,{id:"type",modelValue:n.type,"onUpdate:modelValue":x[2]||(x[2]=A=>n.type=A),options:a,"value-key":"value","label-key":"label",placeholder:"Select a type",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:N.type?N.type[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"initial_status",value:"Initial Status"}),v(he,{id:"initial_status",modelValue:n.initial_status,"onUpdate:modelValue":x[3]||(x[3]=A=>n.initial_status=A),options:u,"value-key":"value","label-key":"label",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:N.initial_status?N.initial_status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(q,{for:"content_url",value:"Content URL (for Google Docs, external links)"}),v(me,{id:"content_url",modelValue:n.content_url,"onUpdate:modelValue":x[4]||(x[4]=A=>n.content_url=A),type:"url",class:"mt-1 block w-full",disabled:!!n.attachment_file,onInput:f,placeholder:"e.g., https://docs.google.com/document/d/..."},null,8,["modelValue","disabled"]),x[7]||(x[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Leave empty if uploading a file below.",-1)),v(ae,{message:N.content_url?N.content_url[0]:"",class:"mt-2"},null,8,["message"])]),n.content_url&&!n.attachment_file?(o(),r("div",Sd,[v(q,{for:"content_url_type",value:"Type of Content URL"}),v(he,{id:"content_url_type",modelValue:n.content_url_type,"onUpdate:modelValue":x[5]||(x[5]=A=>n.content_url_type=A),options:d,"value-key":"value","label-key":"label",placeholder:"Select the type of content this URL links to",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:N.content_url_type?N.content_url_type[0]:"",class:"mt-2"},null,8,["message"])])):D("",!0),e("div",null,[v(q,{for:"attachment_file",value:"Upload File (PDF, Image)"}),e("input",{id:"attachment_file",ref_key:"fileInput",ref:c,type:"file",onChange:p,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",disabled:!!n.content_url,accept:"application/pdf,image/*"},null,40,Md),x[9]||(x[9]=e("p",{class:"text-xs text-gray-500 mt-1"},"Max 10MB. Leave empty if providing a URL above.",-1)),v(ae,{message:N.attachment_file?N.attachment_file[0]:"",class:"mt-2"},null,8,["message"]),m.value?(o(),r("div",jd,[x[8]||(x[8]=e("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Image Preview:",-1)),e("img",{src:m.value,alt:"File Preview",class:"max-w-full h-auto rounded-lg shadow-md max-h-60 object-contain"},null,8,$d)])):D("",!0)]),e("div",Vd,[ge(e("input",{id:"is_visible_to_client",type:"checkbox","onUpdate:modelValue":x[6]||(x[6]=A=>n.is_visible_to_client=A),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,512),[[Qe,n.is_visible_to_client]]),v(q,{for:"is_visible_to_client",value:"Visible to Client",class:"ml-2"}),v(ae,{message:N.is_visible_to_client?N.is_visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","api-endpoint","form-data"]))}},Pd={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},Ud={class:"flex justify-between items-center mb-4"},Nd={class:"flex gap-2"},Rd={key:0},Fd={key:1},Hd={class:"mb-6 bg-gray-50 p-4 rounded-lg"},Bd={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Wd={key:0,class:"mt-3 text-sm text-gray-600"},Yd={key:0,class:"text-red-600 font-medium"},zd={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},qd={key:1,class:"text-center py-4"},Gd={class:"text-red-600 text-sm font-medium"},Kd={key:2,class:"overflow-x-auto"},Jd={class:"min-w-full divide-y divide-gray-200"},Zd={class:"bg-white divide-y divide-gray-200"},Xd={class:"px-4 py-3 text-sm text-gray-900"},Qd={class:"px-4 py-3 text-sm text-gray-700 capitalize"},eu={class:"px-4 py-3 text-sm text-gray-700"},tu={class:"px-4 py-3 text-sm text-gray-700"},su={class:"px-4 py-3 text-sm text-gray-700"},lu={class:"px-4 py-3 text-sm text-gray-700"},au={class:"px-4 py-3 text-sm text-gray-700"},iu={class:"px-4 py-3 text-right"},nu={class:"flex justify-end space-x-2"},ou=["onClick"],ru={key:3,class:"text-center py-4"},du={__name:"ProjectDeliverableTab",props:{projectId:{type:[String,Number],required:!0},canCreateDeliverables:{type:Boolean,default:!1},canViewDeliverables:{type:Boolean,default:!1}},emits:["deliverablesUpdated","openDeliverableDetailSidebar"],setup(l,{emit:t}){const s=l,i=t,n=_([]),a=_(!0),u=_(null),d=_(!1),c=_({status:"",type:"",visibility:"",clientStatus:""}),m=[{value:"",label:"All Statuses"},{value:"pending_review",label:"Pending Review"},{value:"for_information",label:"For Information"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"},{value:"completed",label:"Completed"}],p=[{value:"",label:"All Types"},{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],f=[{value:"",label:"All Visibility"},{value:"visible_to_client",label:"Visible to Client"},{value:"not_visible_to_client",label:"Not Visible to Client"}],y=[{value:"",label:"All Client Status"},{value:"read",label:"Read"},{value:"unread",label:"Unread"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"}],T=A=>{var w;if(!A.is_visible_to_client)return{status:"N/A",class:"bg-gray-100 text-gray-800"};const V=(w=A.client_interactions)==null?void 0:w[0];return V?V.approved_at?{status:"Approved",class:"bg-green-100 text-green-800"}:V.revisions_requested_at?{status:"Revisions Requested",class:"bg-yellow-100 text-yellow-800"}:V.rejected_at?{status:"Rejected",class:"bg-red-100 text-red-800"}:V.read_at?{status:`Read on ${new Date(V.read_at).toLocaleDateString()}`,class:"bg-blue-100 text-blue-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}},C=U(()=>n.value.length?n.value.filter(A=>{const V=T(A);return!(c.value.status&&A.status!==c.value.status||c.value.type&&A.type!==c.value.type||c.value.visibility&&(c.value.visibility==="visible_to_client"&&!A.is_visible_to_client||c.value.visibility==="not_visible_to_client"&&A.is_visible_to_client)||c.value.clientStatus&&(c.value.clientStatus==="read"&&!V.status.startsWith("Read")||c.value.clientStatus==="unread"&&V.status!=="Unread"||c.value.clientStatus==="approved"&&V.status!=="Approved"||c.value.clientStatus==="revisions_requested"&&V.status!=="Revisions Requested"))}):[]),S=()=>{c.value.status="",c.value.type="",c.value.visibility="",c.value.clientStatus=""},h=async()=>{if(!s.canViewDeliverables){u.value="You do not have permission to view deliverables.",a.value=!1;return}a.value=!0,u.value=null;try{const A=await window.axios.get(route("projects.deliverables.index",s.projectId));n.value=A.data}catch(A){console.error("Error fetching deliverables:",A),u.value="Failed to load deliverables."}finally{a.value=!1}},x=()=>{h(),i("deliverablesUpdated")},N=A=>{i("openDeliverableDetailSidebar",A)};return fe(()=>{h()}),ce(()=>s.projectId,()=>{h()}),(A,V)=>(o(),r("div",Pd,[e("div",Ud,[V[7]||(V[7]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Deliverables & Approvals",-1)),e("div",Nd,[v(_e,{onClick:h,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:H(()=>[a.value?(o(),r("span",Fd,"Loading...")):(o(),r("span",Rd,"Refresh"))]),_:1},8,["disabled"]),l.canCreateDeliverables?(o(),le(pe,{key:0,onClick:V[0]||(V[0]=w=>d.value=!0),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:H(()=>V[6]||(V[6]=[z(" Add New Deliverable ",-1)])),_:1,__:[6]})):D("",!0)])]),e("div",Hd,[e("div",Bd,[e("div",null,[v(q,{for:"deliverable-status-filter",value:"Status"}),v(he,{id:"deliverable-status-filter",modelValue:c.value.status,"onUpdate:modelValue":V[1]||(V[1]=w=>c.value.status=w),options:m,placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[v(q,{for:"deliverable-type-filter",value:"Type"}),v(he,{id:"deliverable-type-filter",modelValue:c.value.type,"onUpdate:modelValue":V[2]||(V[2]=w=>c.value.type=w),options:p,placeholder:"All Types",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[v(q,{for:"deliverable-visibility-filter",value:"Visibility"}),v(he,{id:"deliverable-visibility-filter",modelValue:c.value.visibility,"onUpdate:modelValue":V[3]||(V[3]=w=>c.value.visibility=w),options:f,placeholder:"All Visibility",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[v(q,{for:"deliverable-client-status-filter",value:"Client Status"}),v(he,{id:"deliverable-client-status-filter",modelValue:c.value.clientStatus,"onUpdate:modelValue":V[4]||(V[4]=w=>c.value.clientStatus=w),options:y,placeholder:"All Client Status",class:"mt-1"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end mt-4"},[e("button",{type:"button",onClick:S,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")]),Object.values(c.value).some(w=>w!==null&&w!=="")?(o(),r("div",Wd,[e("p",null,[z(" Showing "+g(C.value.length)+" of "+g(n.value.length)+" deliverables ",1),C.value.length===0?(o(),r("span",Yd," (No deliverables match the current filters) ")):D("",!0)])])):D("",!0)]),a.value?(o(),r("div",zd," Loading deliverables... ")):u.value?(o(),r("div",qd,[e("p",Gd,g(u.value),1)])):C.value.length?(o(),r("div",Kd,[e("table",Jd,[V[8]||(V[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted By"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted On"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Visibility"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client Status"),z(),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Zd,[(o(!0),r(J,null,Q(C.value,w=>{var B;return o(),r("tr",{key:w.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Xd,g(w.title),1),e("td",Qd,g(w.type.replace(/_/g," ")),1),e("td",eu,[e("span",{class:se({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":w.status==="pending_review"||w.status==="revisions_requested","bg-green-100 text-green-800":w.status==="approved","bg-blue-100 text-blue-800":w.status==="completed","bg-gray-100 text-gray-800":w.status==="for_information"})},g(w.status.replace(/_/g," ").replace(/\b\w/g,R=>R.toUpperCase())),3)]),e("td",tu,g(((B=w.team_member)==null?void 0:B.name)||"Unknown"),1),e("td",su,g(new Date(w.submitted_at).toLocaleDateString()),1),e("td",lu,[e("span",{class:se({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":w.is_visible_to_client,"bg-red-100 text-red-800":!w.is_visible_to_client})},g(w.is_visible_to_client?"Visible":"Hidden"),3)]),e("td",au,[e("span",{class:se(["px-2 py-1 rounded-full text-xs font-medium",T(w).class])},g(T(w).status),3)]),e("td",iu,[e("div",nu,[e("button",{onClick:R=>N(w.id),class:"text-purple-600 hover:text-purple-800 text-sm font-medium"}," View Details ",8,ou)])])])}),128))])])])):(o(),r("div",ru,V[9]||(V[9]=[e("p",{class:"text-gray-400 text-sm"},"No deliverables found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add New Deliverable" button to create one. ',-1)]))),v(xt,{show:d.value,"project-id":l.projectId,onClose:V[5]||(V[5]=w=>d.value=!1),onSaved:x},null,8,["show","project-id"])]))}},uu=Ee(du,[["__scopeId","data-v-40d67f52"]]),cu={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},mu={class:"flex justify-between items-center mb-4"},vu={class:"mb-6 bg-gray-50 p-4 rounded-lg"},pu={class:"flex items-center gap-4"},hu={class:"flex-1 min-w-[200px]"},gu={key:0,class:"text-red-600 text-sm mt-2"},yu={key:1,class:"text-gray-600 text-sm mt-2 animate-pulse"},fu={key:2,class:"text-gray-500 text-sm mt-2"},bu={class:"mt-6"},wu={class:"flex justify-between items-center mb-3"},_u={class:"text-md font-medium text-gray-800"},xu={key:0},ku={key:1},Du={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-8"},Cu={key:1,class:"text-center py-8"},Tu={class:"text-red-600 text-sm font-medium"},Eu={key:2,class:"text-center py-8"},Su={class:"text-red-600 text-sm font-medium"},Mu={key:3,class:"space-y-8"},ju={class:"bg-gray-50 p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},$u={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Vu={class:"text-lg font-semibold text-gray-900"},Au={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Ou={class:"text-lg font-semibold text-gray-900"},Iu={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Lu={class:"text-lg font-semibold text-gray-900"},Pu={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Uu={class:"text-lg font-semibold text-gray-900"},Nu={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Ru={class:"text-lg font-semibold text-gray-900"},Fu={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Hu={class:"text-lg font-semibold text-gray-900"},Bu={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Wu={class:"text-lg font-semibold text-gray-900"},Yu={class:"bg-white p-6 rounded-lg shadow-sm"},zu={class:"overflow-x-auto max-h-60"},qu={class:"min-w-full divide-y divide-gray-200"},Gu={class:"bg-white divide-y divide-gray-200"},Ku={class:"px-4 py-3 text-sm text-gray-900"},Ju={class:"px-4 py-3 text-sm text-gray-700"},Zu={class:"px-4 py-3 text-sm text-gray-700"},Xu={key:0,class:"text-gray-500 text-sm py-2"},Qu={class:"bg-white p-6 rounded-lg shadow-sm"},ec={class:"overflow-x-auto max-h-60"},tc={class:"min-w-full divide-y divide-gray-200"},sc={class:"bg-white divide-y divide-gray-200"},lc={class:"px-4 py-3 text-sm text-gray-900"},ac={class:"px-4 py-3 text-sm text-gray-700"},ic={class:"px-4 py-3 text-sm text-gray-700"},nc={class:"px-4 py-3 text-sm text-gray-700"},oc={class:"px-4 py-3 text-sm text-gray-700"},rc={key:0,class:"text-gray-500 text-sm py-2"},dc={class:"bg-white p-6 rounded-lg shadow-sm"},uc={class:"overflow-x-auto max-h-60"},cc={class:"min-w-full divide-y divide-gray-200"},mc={class:"bg-white divide-y divide-gray-200"},vc={class:"px-4 py-3 text-sm text-gray-900"},pc={class:"px-4 py-3 text-sm text-gray-700"},hc={key:0,class:"text-gray-500 text-sm py-2"},gc={class:"bg-white p-6 rounded-lg shadow-sm"},yc={class:"overflow-x-auto"},fc={class:"min-w-full divide-y divide-gray-200"},bc={class:"bg-white divide-y divide-gray-200"},wc={class:"px-4 py-3 text-sm text-gray-900"},_c={class:"px-4 py-3 text-sm text-gray-700"},xc={key:0,class:"text-gray-500 text-sm py-2"},kc={class:"bg-white p-6 rounded-lg shadow-sm"},Dc={class:"overflow-x-auto"},Cc={class:"min-w-full divide-y divide-gray-200"},Tc={class:"bg-white divide-y divide-gray-200"},Ec={class:"px-4 py-3 text-sm text-gray-900"},Sc={class:"px-4 py-3 text-sm text-gray-700"},Mc={key:0,class:"text-gray-500 text-sm py-2"},jc={class:"bg-white p-6 rounded-lg shadow-sm"},$c={class:"overflow-x-auto max-h-60"},Vc={class:"min-w-full divide-y divide-gray-200"},Ac={class:"bg-white divide-y divide-gray-200"},Oc={class:"px-4 py-3 text-sm text-gray-900"},Ic={class:"px-4 py-3 text-sm text-gray-700"},Lc={key:0,class:"text-gray-500 text-sm py-2"},Pc={class:"bg-white p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6"},Uc={key:0,class:"space-y-2"},Nc={class:"font-medium"},Rc={key:1,class:"text-gray-500 text-sm py-2"},Fc={key:0,class:"space-y-2"},Hc={class:"font-medium"},Bc={key:1,class:"text-gray-500 text-sm py-2"},Wc={key:4,class:"text-center py-8 text-gray-500"},Yc={__name:"SeoReportTab",props:{projectId:{type:[String,Number],required:!0},canCreateSeoReports:{type:Boolean,default:!1}},emits:["openCreateSeoReportModal"],setup(l,{emit:t}){const s=l,i=t,n=_([]),a=_(""),u=_(null),d=_(!0),c=_(!1),m=_(null),p=_(null),f=_(null),y=async()=>{d.value=!0,m.value=null;try{const j=await window.axios.get(`/api/projects/${s.projectId}/seo-reports/available-months`);n.value=j.data.map(b=>({value:b,label:new Date(b+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})})),n.value.length>0&&(a.value=n.value[0].value)}catch(j){console.error("Error fetching available months:",j),m.value="Failed to load available report months."}finally{d.value=!1}},T=j=>{const I=["clientName","reportingPeriod","authorityScoreValue","totalClicksValue","totalImpressionsValue","averagePositionValue","totalBacklinksValue","clicksImpressions","trafficSources","deviceUsage","countryPerformance","coreVitals","topQueries","keywordRankings","backlinks","zeroClickKeywords"].filter(M=>!(M in j));return I.length>0?`Report data is missing expected top-level keys: ${I.join(", ")}. Please ensure the JSON structure is correct.`:!j.clicksImpressions||!Array.isArray(j.clicksImpressions.labels)||!Array.isArray(j.clicksImpressions.clicks)?"clicksImpressions data is malformed.":!j.trafficSources||!Array.isArray(j.trafficSources.labels)||!Array.isArray(j.trafficSources.sessions)?"trafficSources data is malformed.":null},C=async()=>{if(!a.value){u.value=null,f.value=null;return}c.value=!0,p.value=null,f.value=null;try{const b=(await window.axios.get(`/api/projects/${s.projectId}/seo-reports/${a.value}`)).data,I=T(b);I?(f.value=I,u.value=null):u.value=b}catch(j){console.error("Error fetching SEO report:",j),p.value="Failed to load SEO report for the selected month.",u.value=null,f.value=null}finally{c.value=!1}},S=(j=null)=>{i("openCreateSeoReportModal",j)},h=U(()=>{var j;return((j=u.value)==null?void 0:j.clientName)||"N/A"}),x=U(()=>{var j;return((j=u.value)==null?void 0:j.reportingPeriod)||"N/A"}),N=U(()=>{var j;return((j=u.value)==null?void 0:j.authorityScoreValue)||"N/A"}),A=U(()=>{var j;return((j=u.value)==null?void 0:j.totalClicksValue)||"N/A"}),V=U(()=>{var j;return((j=u.value)==null?void 0:j.totalImpressionsValue)||"N/A"}),w=U(()=>{var j;return((j=u.value)==null?void 0:j.averagePositionValue)||"N/A"}),B=U(()=>{var j;return((j=u.value)==null?void 0:j.totalBacklinksValue)||"N/A"}),R=U(()=>{var j;return((j=u.value)==null?void 0:j.clicksImpressions)||{labels:[],clicks:[],impressions:[]}}),$=U(()=>{var j;return((j=u.value)==null?void 0:j.trafficSources)||{labels:[],sessions:[],colors:[]}}),E=U(()=>{var j;return((j=u.value)==null?void 0:j.deviceUsage)||{labels:[],clicks:[],colors:[]}}),k=U(()=>{var j;return((j=u.value)==null?void 0:j.countryPerformance)||{labels:[],clicks:[]}}),O=U(()=>{var j;return((j=u.value)==null?void 0:j.coreVitals)||{mobile:{},desktop:{}}}),ee=U(()=>{var j;return((j=u.value)==null?void 0:j.topQueries)||[]}),ne=U(()=>{var j;return((j=u.value)==null?void 0:j.keywordRankings)||[]});return fe(()=>{y()}),ce(()=>s.projectId,()=>{y()}),ce(a,j=>{j?C():(u.value=null,f.value=null)}),(j,b)=>(o(),r("div",cu,[e("div",mu,[b[4]||(b[4]=e("h4",{class:"text-lg font-semibold text-gray-900"},"SEO Reports",-1)),l.canCreateSeoReports?(o(),le(pe,{key:0,onClick:b[0]||(b[0]=I=>S()),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:H(()=>b[3]||(b[3]=[z(" Add New Report ",-1)])),_:1,__:[3]})):D("",!0)]),e("div",vu,[e("div",pu,[e("div",hu,[v(q,{for:"seo-report-month-filter",value:"Select Report Month"}),v(he,{id:"seo-report-month-filter",modelValue:a.value,"onUpdate:modelValue":b[1]||(b[1]=I=>a.value=I),options:n.value,"value-key":"value","label-key":"label",placeholder:"Select a month",disabled:d.value||n.value.length===0,class:"mt-1"},null,8,["modelValue","options","disabled"])])]),m.value?(o(),r("div",gu,g(m.value),1)):D("",!0),d.value?(o(),r("div",yu,"Loading available months...")):D("",!0),!d.value&&n.value.length===0?(o(),r("div",fu,"No SEO reports available for this project.")):D("",!0)]),e("div",bu,[e("div",wu,[e("h5",_u,[a.value?(o(),r("span",xu,"Report for "+g(new Date(a.value+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})),1)):(o(),r("span",ku,"Select a month to view report"))]),l.canCreateSeoReports&&u.value&&a.value?(o(),le(pe,{key:0,onClick:b[2]||(b[2]=I=>S({report_date:a.value,data:JSON.stringify(u.value,null,2)})),class:"bg-blue-500 hover:bg-blue-600 transition-colors text-sm py-1 px-3"},{default:H(()=>b[5]||(b[5]=[z(" Edit Report ",-1)])),_:1,__:[5]})):D("",!0)]),c.value?(o(),r("div",Du," Loading SEO report data... ")):p.value?(o(),r("div",Cu,[e("p",Tu,g(p.value),1)])):f.value?(o(),r("div",Eu,[e("p",Su,"Data Structure Error: "+g(f.value),1),b[6]||(b[6]=e("p",{class:"text-gray-500 text-sm mt-2"},"Please ensure the JSON data conforms to the expected format.",-1))])):u.value?(o(),r("div",Mu,[e("div",ju,[e("div",$u,[b[7]||(b[7]=e("p",{class:"text-sm text-gray-500"},"Client Name",-1)),e("p",Vu,g(h.value),1)]),e("div",Au,[b[8]||(b[8]=e("p",{class:"text-sm text-gray-500"},"Reporting Period",-1)),e("p",Ou,g(x.value),1)]),e("div",Iu,[b[9]||(b[9]=e("p",{class:"text-sm text-gray-500"},"Authority Score",-1)),e("p",Lu,g(N.value),1)]),e("div",Pu,[b[10]||(b[10]=e("p",{class:"text-sm text-gray-500"},"Total Clicks",-1)),e("p",Uu,g(A.value),1)]),e("div",Nu,[b[11]||(b[11]=e("p",{class:"text-sm text-gray-500"},"Total Impressions",-1)),e("p",Ru,g(V.value),1)]),e("div",Fu,[b[12]||(b[12]=e("p",{class:"text-sm text-gray-500"},"Average Position",-1)),e("p",Hu,g(w.value),1)]),e("div",Bu,[b[13]||(b[13]=e("p",{class:"text-sm text-gray-500"},"Total Backlinks",-1)),e("p",Wu,g(B.value),1)])]),e("div",Yu,[b[15]||(b[15]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Clicks & Impressions Trend",-1)),e("div",zu,[e("table",qu,[b[14]||(b[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions")])],-1)),e("tbody",Gu,[(o(!0),r(J,null,Q(R.value.labels,(I,M)=>(o(),r("tr",{key:M},[e("td",Ku,g(I),1),e("td",Ju,g(R.value.clicks[M]),1),e("td",Zu,g(R.value.impressions[M]),1)]))),128))])])]),R.value.labels.length?D("",!0):(o(),r("p",Xu,"No clicks and impressions data available."))]),e("div",Qu,[b[17]||(b[17]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Top Queries",-1)),e("div",ec,[e("table",tc,[b[16]||(b[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Query"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"CTR"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Position")])],-1)),e("tbody",sc,[(o(!0),r(J,null,Q(ee.value,I=>(o(),r("tr",{key:I.query},[e("td",lc,g(I.query),1),e("td",ac,g(I.clicks),1),e("td",ic,g(I.impressions),1),e("td",nc,g(I.ctr)+"%",1),e("td",oc,g(I.position),1)]))),128))])])]),ee.value.length?D("",!0):(o(),r("p",rc,"No top queries data available."))]),e("div",dc,[b[19]||(b[19]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Keyword Rankings",-1)),e("div",uc,[e("table",cc,[b[18]||(b[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Keyword"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ranking")])],-1)),e("tbody",mc,[(o(!0),r(J,null,Q(ne.value,I=>(o(),r("tr",{key:I.keyword},[e("td",vc,g(I.keyword),1),e("td",pc,g(I.ranking),1)]))),128))])])]),ne.value.length?D("",!0):(o(),r("p",hc,"No keyword rankings data available."))]),e("div",gc,[b[21]||(b[21]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Traffic Sources",-1)),e("div",yc,[e("table",fc,[b[20]||(b[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Source"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sessions")])],-1)),e("tbody",bc,[(o(!0),r(J,null,Q($.value.labels,(I,M)=>(o(),r("tr",{key:I},[e("td",wc,g(I),1),e("td",_c,g($.value.sessions[M]),1)]))),128))])])]),$.value.labels.length?D("",!0):(o(),r("p",xc,"No traffic sources data available."))]),e("div",kc,[b[23]||(b[23]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Device Usage",-1)),e("div",Dc,[e("table",Cc,[b[22]||(b[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Device"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",Tc,[(o(!0),r(J,null,Q(E.value.labels,(I,M)=>(o(),r("tr",{key:I},[e("td",Ec,g(I),1),e("td",Sc,g(E.value.clicks[M]),1)]))),128))])])]),E.value.labels.length?D("",!0):(o(),r("p",Mc,"No device usage data available."))]),e("div",jc,[b[25]||(b[25]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Country Performance (Top 10)",-1)),e("div",$c,[e("table",Vc,[b[24]||(b[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Country"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",Ac,[(o(!0),r(J,null,Q(k.value.labels,I=>(o(),r("tr",{key:I},[e("td",Oc,g(I),1),e("td",Ic,g(k.value.clicks[k.value.labels.indexOf(I)]),1)]))),128))])])]),k.value.labels.length?D("",!0):(o(),r("p",Lc,"No country performance data available."))]),e("div",Pc,[e("div",null,[b[26]||(b[26]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Mobile)",-1)),O.value.mobile&&O.value.mobile.labels&&O.value.mobile.labels.length?(o(),r("div",Uc,[(o(!0),r(J,null,Q(O.value.mobile.labels,(I,M)=>(o(),r("div",{key:I,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(I)+":",1),e("span",Nc,g(O.value.mobile.scores[M]),1)]))),128))])):(o(),r("p",Rc,"No mobile core vitals data available."))]),e("div",null,[b[27]||(b[27]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Desktop)",-1)),O.value.desktop&&O.value.desktop.labels&&O.value.desktop.labels.length?(o(),r("div",Fc,[(o(!0),r(J,null,Q(O.value.desktop.labels,(I,M)=>(o(),r("div",{key:I,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(I)+":",1),e("span",Hc,g(O.value.desktop.scores[M]),1)]))),128))])):(o(),r("p",Bc,"No desktop core vitals data available."))])])])):(o(),r("div",Wc," No report data to display. Please select a month from the dropdown. "))])]))}},zc=Ee(Yc,[["__scopeId","data-v-37cb2f02"]]),qc={class:"space-y-4"},Gc={key:0,class:"text-xs text-gray-500 mt-1 text-red-500"},Kc=["onBlur"],Jc={__name:"CreateSeoReportModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0},initialData:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,i=t,n=Ce({report_date:"",data:""}),a=_(null);ce(()=>[s.show,s.initialData],([h,x])=>{h&&(x?Object.assign(n,{report_date:x.report_date||"",data:x.data||""}):Object.assign(n,{report_date:"",data:""}))},{immediate:!0});const u=h=>{let x=h.data;try{x=JSON.stringify(JSON.parse(h.data))}catch{console.warn("Provided data is not valid JSON, sending as plain string. Backend should validate.")}return{report_date:h.report_date,data:x}},d=U(()=>s.initialData?"Edit SEO Report":"Create New SEO Report"),c=U(()=>`/api/projects/${s.projectId}/seo-reports`),m=U(()=>"post"),p=U(()=>s.initialData?"Update Report":"Create Report"),f=U(()=>s.initialData?"SEO Report updated successfully!":"SEO Report created successfully!"),y=h=>{i("saved",h),i("close")},T=()=>{i("close")},C=()=>{try{const h=JSON.parse(n.data);n.data=JSON.stringify(h,null,2)}catch(h){console.error("Invalid JSON for pretty print:",h)}},S=h=>{if(n.data)try{JSON.parse(n.data),h.data&&h.data[0]==="The data field must be a valid JSON string."&&(h.data=[])}catch{(!h.data||h.data.length===0)&&(h.data=["The data field must be a valid JSON string."])}};return(h,x)=>(o(),le(Ve,{show:l.show,title:d.value,"api-endpoint":c.value,"http-method":m.value,"form-data":n,"submit-button-text":p.value,"success-message":f.value,"format-data-for-api":u,onClose:T,onSubmitted:y},{default:H(({errors:N})=>[e("div",qc,[e("div",null,[v(q,{for:"report_date",value:"Report Month (YYYY-MM)"}),v(me,{id:"report_date",modelValue:n.report_date,"onUpdate:modelValue":x[0]||(x[0]=A=>n.report_date=A),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 2025-07",required:"",autofocus:"",pattern:"\\d{4}-\\d{2}",title:"Please enter a date in YYYY-MM format (e.g., 2025-07)",disabled:!!l.initialData},null,8,["modelValue","disabled"]),v(ae,{message:N.report_date?N.report_date[0]:"",class:"mt-2"},null,8,["message"]),x[2]||(x[2]=e("p",{class:"text-xs text-gray-500 mt-1"},"Enter the report month in YYYY-MM format (e.g., 2025-07).",-1)),l.initialData?(o(),r("p",Gc,"Note: Report month cannot be changed when editing.")):D("",!0)]),e("div",null,[v(q,{for:"report_data",value:"Report Data (JSON)"}),ge(e("textarea",{id:"report_data",ref_key:"jsonInputRef",ref:a,"onUpdate:modelValue":x[1]||(x[1]=A=>n.data=A),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 font-mono",rows:"10",placeholder:'Enter JSON data for the report, e.g., {"keywords_ranked": 150, "traffic": 1200, "rankings": {"keyword1": 5, "keyword2": 12}}',required:"",onBlur:A=>S(N)},null,40,Kc),[[ke,n.data]]),v(ae,{message:N.data?N.data[0]:"",class:"mt-2"},null,8,["message"]),e("div",{class:"flex justify-end mt-2"},[e("button",{type:"button",onClick:C,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," Format JSON ")])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},Zc={key:0,class:"bg-amber-50 border-l-4 border-amber-500 p-4 mb-6 rounded-md shadow-md"},Xc={class:"flex items-center justify-between"},Qc={class:"flex items-center"},em={class:"ml-3"},tm={class:"text-sm text-amber-800 font-medium"},sm={key:0},lm={key:1},am={key:2},im={__name:"ProjectTaskNotificationPrompt",props:{overdueTasks:{type:Number,required:!0},dueTodayTasks:{type:Number,required:!0}},emits:["view-tasks"],setup(l,{emit:t}){const s=l,i=t,n=U(()=>s.overdueTasks+s.dueTodayTasks),a=U(()=>n.value>0),u=()=>{i("view-tasks")};return(d,c)=>a.value?(o(),r("div",Zc,[e("div",Xc,[e("div",Qc,[c[0]||(c[0]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-amber-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",em,[e("p",tm,[l.overdueTasks>0&&l.dueTodayTasks>0?(o(),r("span",sm," This project has "+g(l.overdueTasks)+" overdue "+g(l.overdueTasks===1?"task":"tasks")+" and "+g(l.dueTodayTasks)+" "+g(l.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):l.overdueTasks>0?(o(),r("span",lm," This project has "+g(l.overdueTasks)+" overdue "+g(l.overdueTasks===1?"task":"tasks")+" that require attention. ",1)):l.dueTodayTasks>0?(o(),r("span",am," This project has "+g(l.dueTodayTasks)+" "+g(l.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):D("",!0)])])]),e("div",null,[v(pe,{onClick:u,class:"px-4 py-2 text-sm bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"},{default:H(()=>c[1]||(c[1]=[z(" View ",-1)])),_:1,__:[1]})])])])):D("",!0)}},nm={class:"py-8 max-w-full mx-auto px-4 sm:px-6 lg:px-8"},om={key:0,class:"flex items-center justify-center min-h-[50vh]"},rm={key:1,class:"text-center text-red-600 text-lg font-medium"},dm={key:2,class:"space-y-8"},um={class:"flex justify-end items-center mb-5"},cm={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},mm={key:1},vm={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},pm={class:"flex justify-between items-center mb-4"},hm={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},gm={class:"flex justify-between items-center mb-4"},ym={key:2,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},fm={class:"flex justify-between items-center mb-4"},bm={key:0,class:"text-gray-400 text-sm"},wm={key:1,class:"overflow-x-auto"},_m={class:"min-w-full divide-y divide-gray-200"},xm={class:"bg-white divide-y divide-gray-200"},km={class:"px-4 py-3 text-sm text-gray-900"},Dm={class:"px-4 py-3 text-sm text-gray-700"},Cm={class:"px-4 py-3 text-sm text-gray-700"},Tm={class:"px-4 py-3 text-sm text-gray-700"},Em={class:"px-4 py-3 text-sm text-gray-700"},Sm={class:"px-4 py-3 text-right"},Mm={key:3,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},jm={class:"flex justify-between items-center mb-4"},$m={class:"flex items-center gap-4"},Vm={key:0},Am={key:0,class:"space-y-4"},Om={class:"flex justify-between"},Im={class:"flex-grow"},Lm={key:0,class:"text-xs text-red-400 block mt-1"},Pm={class:"flex items-center mt-1"},Um={class:"text-xs text-gray-500"},Nm={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},Rm={key:0},Fm={key:1,class:"text-gray-400 text-sm"},Hm={__name:"Show",setup(l){const t=Ie(),s=ts().props.id,i=_({clients:[],users:[],notes:[],transactions:[],documents:[],meetings:[],tasks:[],emails:[],deliverables:[]}),n=_(!0),a=_(""),u=_(!1),d=_(!1),c=_(!1),m=_(!1),p=_(!1),f=_(!1),y=_(!1),T=_(!1),C=_(!1),S=_(!1),h=_(null),x=[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"on_hold",label:"On Hold"},{value:"archived",label:"Archived"}],N=[{value:"Website Designing",label:"Website Designing"},{value:"SEO",label:"SEO"},{value:"Social Media",label:"Social Media"},{value:"Content Writing",label:"Content Writing"},{value:"Graphic Design",label:"Graphic Design"}],A=[{value:"UpWork",label:"UpWork"},{value:"Direct",label:"Direct Client"},{value:"Wix Marketplace",label:"Wix Marketplace"},{value:"Referral",label:"Referral"}],V=_(null),w=_(null),B=ss(i),{canDo:R,canView:$}=ht(s),E=U(()=>{var X,F;return((F=(X=t.value)==null?void 0:X.role_data)==null?void 0:F.slug)==="super-admin"}),k=U(()=>R("manage_projects").value||E.value),O=U(()=>R("edit_projects").value||E.value),ee=U(()=>$("emails").value),ne=U(()=>R("compose_emails").value),j=U(()=>R("approve_emails").value),b=U(()=>$("project_notes").value),I=U(()=>R("add_project_notes").value),M=U(()=>$("deliverables").value),K=U(()=>R("create_deliverables").value),re=U(()=>$("seo_reports").value),Se=U(()=>R("create_seo_reports").value),te=U(()=>$("client_contacts").value);U(()=>$("users").value);const L=U(()=>$("project_financial",B).value),P=U(()=>$("project_transactions").value);U(()=>$("client_financial").value);const W=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],ye=_([]),He=_(null),Be=_(null),Ge=_("all"),tt=async()=>{try{ye.value=await zt(s)}catch(X){console.error("Error fetching due and overdue tasks:",X)}},kt=()=>{w.value="tasks",Ge.value="due-overdue",setTimeout(()=>{Be.value&&Be.value.scrollIntoView&&Be.value.scrollIntoView({behavior:"smooth"})},100)},Dt=async()=>{await tt()},st=U(()=>i.value.notes?[...i.value.notes].filter(X=>X.type!=="standup").sort((X,F)=>new Date(F.created_at)-new Date(X.created_at)).slice(0,3):[]),lt=_([]),at=async()=>{try{const X=await window.axios.get(`/api/projects/${s}/emails-simplified`,{params:{limit:5}});lt.value=X.data}catch(X){console.error("Error fetching latest emails:",X)}},Te=async()=>{n.value=!0,a.value="";try{const X=await window.axios.get(`/api/projects/${s}`);i.value=X.data,console.log("Full project data received (Show.vue main fetch):",i.value),await tt(),ee.value&&await at()}catch(X){a.value="Failed to load project data.",console.error("Error fetching project data:",X),X.response&&(X.response.status===401||X.response.status===403)&&(a.value="You are not authorized to view this project or your session expired. Please log in.")}finally{n.value=!1}},Ct=X=>{i.value=X,u.value=!1,Te()},Tt=X=>{i.value.tasks=X},Et=X=>{i.value.emails=X,ee.value&&at()},it=X=>{i.value.notes=X},St=()=>{Te()},Mt=()=>{V.value&&V.value.fetchMeetings()},nt=()=>{Te()},jt=X=>{w.value=X,rs()},$t=()=>{f.value=!0},Vt=()=>{y.value=!0,w.value="emails"},At=async()=>{y.value=!1,await Te()},Ot=()=>{y.value=!1},ot=(X,F)=>{os(X,F||s,i.value.users)};ce(ls,(X,F)=>{F.taskId&&!X.taskId&&Te()},{deep:!0});const It=()=>{C.value=!0},Lt=()=>{C.value=!1,Te()},Pt=(X=null)=>{h.value=X,S.value=!0},Ut=()=>{S.value=!1};return fe(async()=>{console.log("Show.vue mounted, fetching initial data...");try{await as(s),console.log("Project permissions fetched (includes global)")}catch(X){console.error(`Error fetching permissions for project ${s}:`,X)}await ds(),await Te()}),(X,F)=>(o(),r(J,null,[v(G(is),{title:i.value.name||"Project Details"},null,8,["title"]),v(Yt,null,{default:H(()=>{var Ke;return[e("div",nm,[n.value?(o(),r("div",om,F[25]||(F[25]=[e("div",{class:"flex flex-col items-center space-y-4"},[e("svg",{class:"animate-spin h-16 w-16 text-indigo-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("p",{class:"text-lg text-gray-600 font-medium"},"Loading project details...")],-1)]))):a.value?(o(),r("div",rm,g(a.value),1)):(o(),r("div",dm,[v(im,{"overdue-tasks":ye.value.filter(Y=>new Date(Y.due_date)<new Date).length,"due-today-tasks":ye.value.filter(Y=>new Date(Y.due_date).toDateString()===new Date().toDateString()).length,onViewTasks:kt},null,8,["overdue-tasks","due-today-tasks"]),v(ln,{project:i.value,"project-id":G(s),"can-manage-projects":k.value,"is-super-admin":E.value,"can-edit-projects":O.value,onOpenEditModal:F[0]||(F[0]=Y=>u.value=!0),onOpenStandupModal:F[1]||(F[1]=Y=>c.value=!0),onOpenMeetingModal:F[2]||(F[2]=Y=>d.value=!0),onOpenMagicLinkModal:F[3]||(F[3]=Y=>p.value=!0),onResourceSaved:Te,onOpenComposeModal:Vt},null,8,["project","project-id","can-manage-projects","is-super-admin","can-edit-projects"]),v(js,{"project-id":G(s),ref_key:"meetingsListComponent",ref:V},null,8,["project-id"]),v(pn,{tasks:i.value.tasks||[],emails:i.value.emails||[]},null,8,["tasks","emails"]),e("div",um,[v(he,{id:"display-currency-switcher",modelValue:G(Fe),"onUpdate:modelValue":F[4]||(F[4]=Y=>ns(Fe)?Fe.value=Y:null),options:W,"value-key":"value","label-key":"label",class:"w-20",containerClasses:"max-w-[150px]"},null,8,["modelValue"])]),L.value&&P.value?(o(),le(Lr,{key:0,"project-id":G(s),"can-view-project-services-and-payments":L.value,"can-view-project-transactions":P.value},null,8,["project-id","can-view-project-services-and-payments","can-view-project-transactions"])):D("",!0),e("div",cm,[te.value?(o(),le(Br,{key:0,"project-id":G(s),"can-view-client-contacts":te.value},null,8,["project-id","can-view-client-contacts"])):D("",!0),v(Xr,{"project-id":G(s),"can-view-users":!0},null,8,["project-id"]),v(vd,{"project-id":G(s),onViewUserTransactions:$t},null,8,["project-id"])]),v(yn,{ref_key:"navigationRef",ref:Be,selectedTab:w.value,"onUpdate:selectedTab":F[5]||(F[5]=Y=>w.value=Y),"can-view-emails":ee.value,"can-view-notes":b.value,"can-view-deliverables":M.value,"can-view-seo-reports":re.value},null,8,["selectedTab","can-view-emails","can-view-notes","can-view-deliverables","can-view-seo-reports"]),w.value===null?(o(),r("div",mm,[ye.value.length>0?(o(),r("div",vm,[e("div",pm,[F[26]||(F[26]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:F[6]||(F[6]=Y=>w.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),v(yt,{tasks:ye.value,"project-id":G(s),"show-project-column":!1,onTaskUpdated:Dt,onOpenTaskDetail:ot},null,8,["tasks","project-id"])])):(o(),r("div",hm,[e("div",gm,[F[27]||(F[27]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:F[7]||(F[7]=Y=>w.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),F[28]||(F[28]=e("p",{class:"text-gray-400 text-sm"},"No due or overdue tasks.",-1))])),ee.value?(o(),r("div",ym,[e("div",fm,[F[29]||(F[29]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Emails",-1)),e("button",{onClick:F[8]||(F[8]=Y=>w.value="emails"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Emails → ")]),(Ke=i.value.emails)!=null&&Ke.length?(o(),r("div",wm,[e("table",_m,[F[31]||(F[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",xm,[(o(!0),r(J,null,Q(lt.value,Y=>{var Pe;return o(),r("tr",{key:Y.id,class:"hover:bg-gray-50 transition-colors"},[e("td",km,g(Y.subject),1),e("td",Dm,g(((Pe=Y.sender)==null?void 0:Pe.name)||"N/A"),1),e("td",Cm,g(new Date(Y.created_at).toLocaleDateString()),1),e("td",Tm,[e("span",{class:se({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":Y.type==="sent","bg-purple-100 text-purple-800":Y.type==="received"})},g(Y.type?Y.type.toUpperCase():"N/A"),3)]),e("td",Em,[e("span",{class:se({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":Y.status==="sent","bg-yellow-100 text-yellow-800":Y.status==="pending_approval","bg-blue-200 text-blue-900":Y.status==="pending_approval_received","bg-red-100 text-red-800":Y.status==="rejected","bg-gray-100 text-gray-800":Y.status==="draft"})},g(Y.status.replace("_"," ").toUpperCase()),3)]),e("td",Sm,[v(_e,{class:"text-indigo-600 hover:text-indigo-800",onClick:Nt=>X.viewEmail(Y)},{default:H(()=>F[30]||(F[30]=[z(" View ",-1)])),_:2,__:[30]},1032,["onClick"])])])}),128))])])])):(o(),r("div",bm,"No email communication found."))])):D("",!0),b.value?(o(),r("div",Mm,[e("div",jm,[F[33]||(F[33]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Notes",-1)),e("div",$m,[e("button",{onClick:F[9]||(F[9]=Y=>w.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Notes → "),I.value?(o(),r("div",Vm,[v(pe,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:F[10]||(F[10]=Y=>m.value=!0)},{default:H(()=>F[32]||(F[32]=[z(" Add Note ",-1)])),_:1,__:[32]})])):D("",!0)])]),st.value.length?(o(),r("div",Am,[(o(!0),r(J,null,Q(st.value,Y=>{var Pe;return o(),r("div",{key:Y.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",Om,[e("div",Im,[e("p",{class:se(["text-sm",{"text-gray-700":Y.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":Y.content==="[Encrypted content could not be decrypted]"}])},[z(g(Y.content)+" ",1),Y.content==="[Encrypted content could not be decrypted]"?(o(),r("span",Lm," (There was an issue decrypting this note. Please contact an administrator.) ")):D("",!0)],2),e("div",Pm,[e("p",Um,"Added by "+g(((Pe=Y.user)==null?void 0:Pe.name)||"Unknown")+" on "+g(new Date(Y.created_at).toLocaleDateString()),1),Y.reply_count>0?(o(),r("span",Nm,g(Y.reply_count)+" "+g(Y.reply_count===1?"reply":"replies"),1)):D("",!0)])]),b.value&&Y.chat_message_id&&i.value.google_chat_id?(o(),r("div",Rm,[e("button",{onClick:F[11]||(F[11]=Nt=>w.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View ")])):D("",!0)])])}),128))])):(o(),r("p",Fm,"No notes available."))])):D("",!0)])):D("",!0),w.value==="tasks"?(o(),le(no,{key:2,ref_key:"tasksTabRef",ref:He,"project-id":G(s),"project-users":i.value.users||[],"can-manage-projects":k.value,"tasks-filter":Ge.value,onTasksUpdated:Tt,onOpenTaskDetailSidebar:ot,onOpenCreateTaskModal:It,onFilterChanged:F[12]||(F[12]=Y=>Ge.value=Y)},null,8,["project-id","project-users","can-manage-projects","tasks-filter"])):D("",!0),w.value==="emails"?(o(),le(Ro,{key:3,"project-id":G(s),"can-view-emails":ee.value,"can-compose-emails":ne.value,"can-approve-emails":j.value,"user-project-role":G(B),"open-compose":y.value,onEmailsUpdated:Et,onResetOpenCompose:F[13]||(F[13]=Y=>y.value=!1)},null,8,["project-id","can-view-emails","can-compose-emails","can-approve-emails","user-project-role","open-compose"])):D("",!0),w.value==="standups"?(o(),le(Ua,{key:4,projectId:G(s),users:i.value.users||[],onStandupAdded:nt},null,8,["projectId","users"])):D("",!0),w.value==="notes"?(o(),le(_r,{key:5,"project-id":G(s),"google-chat-id":i.value.google_chat_id,"can-view-notes":b.value,"can-add-notes":I.value,onNotesUpdated:it,onChangeTab:jt},null,8,["project-id","google-chat-id","can-view-notes","can-add-notes"])):D("",!0),w.value==="deliverables"?(o(),le(uu,{key:6,"project-id":G(s),"can-create-deliverables":K.value,"can-view-deliverables":M.value,onDeliverablesUpdated:St,onOpenDeliverableDetailSidebar:X.handleOpenDeliverableDetailSidebar},null,8,["project-id","can-create-deliverables","can-view-deliverables","onOpenDeliverableDetailSidebar"])):D("",!0),w.value==="seo-reports"?(o(),le(zc,{key:7,"project-id":G(s),"can-create-seo-reports":Se.value,onOpenCreateSeoReportModal:Pt},null,8,["project-id","can-create-seo-reports"])):D("",!0)]))]),v($e,{show:u.value,onClose:F[15]||(F[15]=Y=>u.value=!1)},{default:H(()=>[v(us,{show:u.value,project:i.value,statusOptions:x,departmentOptions:N,sourceOptions:A,clientRoleOptions:[],userRoleOptions:[],paymentTypeOptions:[],onClose:F[14]||(F[14]=Y=>u.value=!1),onSubmit:Ct},null,8,["show","project"])]),_:1},8,["show"]),v(ni,{show:d.value,"project-name":i.value.name,onClose:F[16]||(F[16]=Y=>d.value=!1),onSaved:Mt,projectId:G(s),projectUsers:i.value.users||[]},null,8,["show","project-name","projectId","projectUsers"]),v(gt,{show:c.value,onClose:F[17]||(F[17]=Y=>c.value=!1),onStandupAdded:nt,projectId:G(s)},null,8,["show","projectId"]),v(ft,{show:m.value,"project-id":G(s),onClose:F[18]||(F[18]=Y=>m.value=!1),onNoteAdded:it},null,8,["show","project-id"]),v(vi,{show:p.value,"project-id":G(s),"project-clients":i.value.clients||[],onClose:F[19]||(F[19]=Y=>p.value=!1)},null,8,["show","project-id","project-clients"]),v(Td,{show:f.value,"project-id":G(s),"project-name":i.value.name,onClose:F[20]||(F[20]=Y=>f.value=!1)},null,8,["show","project-id","project-name"]),v(_t,{show:y.value,"project-id":G(s),"user-project-role":G(B),onClose:Ot,onSubmitted:At,onError:F[21]||(F[21]=Y=>console.error("Error composing email:",Y))},null,8,["show","project-id","user-project-role"]),v(Wt,{show:C.value,"project-id":G(s),onClose:F[22]||(F[22]=Y=>C.value=!1),onSaved:Lt},null,8,["show","project-id"]),v(xt,{show:T.value,"project-id":G(s),onClose:F[23]||(F[23]=Y=>T.value=!1),onSaved:X.handleDeliverableSaved},null,8,["show","project-id","onSaved"]),v(Jc,{"project-id":G(s),show:S.value,"initial-data":h.value,onClose:F[24]||(F[24]=Y=>S.value=!1),onSaved:Ut},null,8,["project-id","show","initial-data"])]}),_:1})],64))}},rv=Ee(Hm,[["__scopeId","data-v-6128d7c0"]]);export{rv as default};
