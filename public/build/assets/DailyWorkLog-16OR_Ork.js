import{r as c,G as ks,E as Ys,l as x,b as Qs,m as K,c as l,o,e as j,a,q as Js,k as u,w as U,g as d,_ as R,t as i,f as Ks,v as Xs,F as m,i as B,n as _,j as X,y as Zs,W as st,V as tt}from"./app-ecDjzow_.js";import{_ as et,s as gs,c as fs,r as at,p as ot}from"./taskState-BtocU0GG.js";import{S as hs}from"./SelectDropdown-B0ANJPd7.js";import{_ as lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseFormModal-CFuvA4Pl.js";import"./Modal-Drh2rcDC.js";import"./PrimaryButton-DJS6EVDj.js";import"./SecondaryButton-CS308GJ3.js";import"./InputLabel-PrpbGWGB.js";import"./InputError-FdorQBLH.js";/* empty css                                                                       */const nt={class:"daily-work-log"},rt={key:0,class:"tips-banner"},it={class:"dwl-header"},dt={class:"dwl-date-nav"},ut={class:"dwl-date-label"},ct={class:"dwl-date-main"},pt={key:0,class:"chip chip-today"},vt={key:1,class:"chip chip-future"},yt={key:2,class:"chip chip-past"},kt={key:0,class:"dwl-user-switcher"},gt={class:"dwl-header-right"},ft={key:0,class:"progress-pills"},ht={class:"pill p-pending"},wt={class:"pill p-done"},bt={key:0,class:"pill p-pushed"},mt={key:0,class:"task-picker"},_t={class:"picker-header"},Ct={class:"flex-1 flex gap-2"},Dt={class:"w-48"},xt=["disabled"],Pt={key:0,class:"picker-empty"},St={key:1,class:"picker-empty"},Tt={key:0},$t={key:1},It={key:2,class:"picker-grid"},At=["onClick"],jt={key:0,viewBox:"0 0 20 20",fill:"currentColor",width:"12",height:"12"},Lt={class:"picker-task-body"},Ft={class:"picker-task-name"},Bt={class:"picker-task-meta"},Vt={key:0,class:"tag tag-proj"},Nt={class:"dwl-body"},Mt={key:0,class:"skeleton-wrap"},Ht={key:1,class:"empty-state"},Ot={key:2,class:"task-list"},zt=["onDragstart","onDragover","onDrop"],Ut={key:0,class:"active-ring"},Rt={class:"task-info"},Wt=["onClick"],Et={class:"task-meta"},qt={key:0,class:"tag tag-proj"},Gt={key:1,class:"tag tag-milestone"},Yt={key:0,class:"status-hint"},Qt={class:"task-actions"},Jt={key:0,class:"spinner"},Kt=["disabled","onClick","title"],Xt=["onClick"],Zt=["onClick"],se=["onClick"],te={key:3,class:"dwl-foot"},ee={key:0,class:"foot-note"},ae={key:1,class:"foot-note dim"},oe={class:"warn-modal"},le={class:"warn-modal-body"},ne={key:0,class:"history-panel"},re={key:0,class:"picker-empty"},ie={class:"history-day-header"},de={class:"history-date"},ue={class:"history-day-pills"},ce={class:"pill p-done"},pe={key:0,class:"pill p-pending"},ve={key:1,class:"pill p-pushed"},ye={class:"history-list"},ke={class:"history-task-name"},ge={key:0,class:"tag tag-proj sm"},fe={__name:"DailyWorkLog",setup(he){const Z=s=>{const t=s.getFullYear(),e=String(s.getMonth()+1).padStart(2,"0"),r=String(s.getDate()).padStart(2,"0");return`${t}-${e}-${r}`},ss=s=>{const[t,e,r]=s.split("-");return new Date(t,e-1,r)},ts=s=>ss(s).toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),W=Z(new Date),f=c(W),p=c([]),V=c([]),E=c({}),es=c([]),S=c(ks().props.auth.user.id),{canDo:ws}=Ys(),as=x(()=>ws("view_all_projects").value),q=c(!1),G=c(!1),Y=c(!1),Q=c(new Set),N=c(!1),J=c(null),T=c(""),M=c(null),h=c(!1),$=c(!1),H=c(localStorage.getItem("dwl_tips_dismissed")!=="1"),P=c({show:!1,item:null,mode:""}),L=c(null),O=c(null),bs=x(()=>f.value===W),ms=x(()=>f.value>W),os=x(()=>{const s=T.value.toLowerCase().trim(),t=new Set(p.value.map(e=>e.task_id));return V.value.filter(e=>{var n,y,k,b;return t.has(e.id)||M.value&&((n=e.milestone)==null?void 0:n.project_id)!==M.value||e.status==="Done"||e.status==="Archived"?!1:s?String(e.name||"").toLowerCase().includes(s)||String(((k=(y=e.milestone)==null?void 0:y.project)==null?void 0:k.name)||"").toLowerCase().includes(s)||String(((b=e.milestone)==null?void 0:b.name)||"").toLowerCase().includes(s):!0})}),_s=x(()=>p.value.filter(s=>s.status==="pending").length),Cs=x(()=>p.value.filter(s=>s.status==="completed").length),ls=x(()=>p.value.filter(s=>s.status==="pushed_to_next_day").length),Ds=x(()=>{const s=new Map;return V.value.forEach(t=>{var r;const e=(r=t.milestone)==null?void 0:r.project;e&&!s.has(e.id)&&s.set(e.id,{value:e.id,label:e.name})}),[{value:null,label:"All Projects"},...Array.from(s.values())]}),ns=x(()=>Object.entries(E.value).sort(([s],[t])=>t.localeCompare(s))),v=s=>{var t;return((t=s.task)==null?void 0:t.status)??"To Do"},xs=s=>v(s)==="Paused",Ps=s=>v(s)==="In Progress",rs=s=>v(s)==="In Progress",is=s=>v(s)==="Done",F=s=>is(s)?{label:"âœ“ Done",disabled:!0,type:"done"}:rs(s)?{label:"âœ“ Complete",type:"complete"}:xs(s)?{label:"â–· Resume",type:"resume"}:Ps(s)?{label:"â¸ Pause",type:"pause"}:{label:"â–· Start",type:"start"},Ss=s=>Q.value.has(s.task_id),w=(s,t)=>{const e=new Set(Q.value);t?e.add(s.task_id):e.delete(s.task_id),Q.value=e},Ts=async s=>{w(s,!0);try{const t=await gs(s.task);s.task={...s.task,...t}}catch{}w(s,!1)},$s=async s=>{w(s,!0);try{const t=await at(s.task);s.task={...s.task,...t}}catch{}w(s,!1)},Is=async s=>{w(s,!0);try{const t=await ot(s.task);s.task={...s.task,...t}}catch{}w(s,!1)},As=async s=>{if(!rs(s)){P.value={show:!0,item:s,mode:"complete"};return}w(s,!0);try{const t=await fs(s.task);s.task={...s.task,...t},await window.axios.patch(`/api/daily-tasks/${s.id}`,{status:"completed"}),s.status="completed",h.value&&await I()}catch{}w(s,!1)},js=async()=>{const s=P.value.item;if(P.value={show:!1,item:null,mode:""},!!s){w(s,!0);try{const t=await gs(s.task);s.task={...s.task,...t};const e=await fs(s.task);s.task={...s.task,...e},await window.axios.patch(`/api/daily-tasks/${s.id}`,{status:"completed"}),s.status="completed",h.value&&await I()}catch{}w(s,!1)}},ds=()=>{P.value={show:!1,item:null,mode:""}},Ls=s=>{const t=F(s);t.disabled||(t.type==="start"&&Ts(s),t.type==="resume"&&$s(s),t.type==="pause"&&Is(s),t.type==="complete"&&As(s))},z=async()=>{q.value=!0;try{const{data:s}=await window.axios.get("/api/daily-tasks",{params:{date:f.value,user_id:S.value}});p.value=Array.isArray(s)?s:[]}catch(s){console.error("Failed to load daily log",s)}finally{q.value=!1}},Fs=async()=>{if(as.value)try{const{data:s}=await window.axios.get("/api/users");es.value=(Array.isArray(s)?s:[]).map(t=>({value:t.id,label:t.name}))}catch(s){console.error("Failed to load users",s)}},us=async()=>{if(S.value!==ks().props.auth.user.id){V.value=[];return}G.value=!0;try{const{data:s}=await window.axios.get("/api/tasks",{params:{assigned_to_me:1,statuses:"To Do,In Progress,Paused,Blocked",per_page:200}});V.value=Array.isArray(s)?s:(s==null?void 0:s.data)||[]}catch(s){console.error("Failed to load task pool",s)}finally{G.value=!1}},I=async()=>{try{const{data:s}=await window.axios.get("/api/daily-tasks/history",{params:{days:14,user_id:S.value,today:f.value}});E.value=s||{}}catch(s){console.error("Failed to load history",s)}},Bs=async s=>{try{const{data:t}=await window.axios.post("/api/daily-tasks",{task_ids:s,date:f.value}),e=Array.isArray(t)?t:[],r=new Set(p.value.map(n=>n.id));for(const n of e)r.has(n.id)||p.value.push(n);$.value=!1,T.value="",g.value=new Set}catch(t){console.error("Failed to add tasks",t)}},Vs=async()=>{Y.value=!0;try{await window.axios.post("/api/daily-tasks/reorder",{date:f.value,ordered_ids:p.value.map(s=>s.id)})}catch(s){console.error("Failed to save order",s)}finally{Y.value=!1}},Ns=async s=>{try{await window.axios.post(`/api/daily-tasks/${s.id}/push-to-tomorrow`),s.status="pushed_to_next_day",h.value&&await I()}catch(t){console.error("Failed to push to tomorrow",t)}},Ms=async s=>{try{await window.axios.delete(`/api/daily-tasks/${s.id}`),p.value=p.value.filter(t=>t.id!==s.id)}catch(t){console.error("Failed to remove from log",t)}},Hs=s=>{var t;s&&tt(s.id,(t=s.milestone)==null?void 0:t.project_id,[])},Os=s=>{J.value=s,N.value=!0},zs=s=>{L.value=s.id},Us=(s,t)=>{t.preventDefault(),O.value=s.id},Rs=async(s,t)=>{t.preventDefault();const e=L.value,r=s.id;if(L.value=null,O.value=null,!e||e===r)return;const n=p.value.findIndex(C=>C.id===e),y=p.value.findIndex(C=>C.id===r);if(n===-1||y===-1)return;const k=[...p.value],[b]=k.splice(n,1);k.splice(y,0,b),p.value=k,await Vs()},Ws=()=>{L.value=null,O.value=null},cs=s=>{const t=ss(f.value);t.setDate(t.getDate()+s),f.value=Z(t)},A=s=>({"To Do":{bg:"#eff6ff",color:"#1d4ed8",border:"#bfdbfe"},"In Progress":{bg:"#ecfdf5",color:"#065f46",border:"#6ee7b7"},Paused:{bg:"#fffbeb",color:"#92400e",border:"#fcd34d"},Blocked:{bg:"#fef2f2",color:"#991b1b",border:"#fca5a5"},Done:{bg:"#ede9fe",color:"#5b21b6",border:"#c4b5fd"}})[s]||{bg:"#f3f4f6",color:"#374151",border:"#e5e7eb"},ps=s=>({pending:"Pending",completed:"Completed",pushed_to_next_day:"Pushed"})[s]||s,Es=s=>{const t=F(s);return t.disabled?{background:"#d1fae5",color:"#065f46",border:"#6ee7b7"}:t.type==="complete"?{background:"#6366f1",color:"#fff",border:"#818cf8"}:t.type==="pause"?{background:"#fef3c7",color:"#78350f",border:"#fcd34d"}:{background:"#3b82f6",color:"#fff",border:"#60a5fa"}},vs=()=>{H.value=!1;try{localStorage.setItem("dwl_tips_dismissed","1")}catch{}};Qs(async()=>{await Fs(),await z(),await us()}),K(S,async()=>{await z(),await us(),h.value&&await I()}),K(f,async()=>{await z(),h.value&&await I()}),K(h,async s=>{s&&Object.keys(E.value).length===0&&await I()});const g=c(new Set),qs=s=>{const t=new Set(g.value);t.has(s)?t.delete(s):t.add(s),g.value=t},Gs=()=>{const s=Array.from(g.value);s.length&&Bs(s)};return(s,t)=>(o(),l("div",nt,[j(R,{name:"slide-down"},{default:U(()=>[H.value?(o(),l("div",rt,[a("button",{class:"tips-close",onClick:vs,title:"Dismiss tips"},"âœ•"),t[11]||(t[11]=a("div",{class:"tips-heading"},[a("span",{class:"tips-icon"},"ðŸ’¡"),a("strong",null,"How the Daily Work Log works")],-1)),t[12]||(t[12]=a("div",{class:"tips-grid"},[a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"1"),a("div",{class:"tip-body"},[a("strong",null,"Plan your day"),d(" â€” Pick tasks from your assigned list and add them here. Drag to set the order you'll work on them. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"2"),a("div",{class:"tip-body"},[a("strong",null,"Start each task"),d(" â€” Hit "),a("em",null,"â–· Start"),d(" when you begin. This logs your time and signals to the team you're on it. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"3"),a("div",{class:"tip-body"},[a("strong",null,"Pause when you stop"),d(" â€” If you need to switch or take a break, hit "),a("em",null,"â¸ Pause"),d(". Resume later when you're back. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"4"),a("div",{class:"tip-body"},[a("strong",null,"Complete to finish"),d(" â€” Only available once the task is "),a("em",null,"In Progress"),d(". This marks the task Done and logs your session. ")])]),a("div",{class:"tip-card tip-card-warn"},[a("div",{class:"tip-step warn"},"âš "),a("div",{class:"tip-body"},[a("strong",null,"Don't skip steps"),d(" â€” Avoid starting and immediately completing without actually working on it. Accurate time tracking helps the whole team. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"5"),a("div",{class:"tip-body"},[a("strong",null,"Push unfinished tasks"),d(" â€” Hit "),a("em",null,"â†’ Tomorrow"),d(" to move anything you didn't finish to the next day. It stays in history so nothing gets lost. ")])])],-1)),a("button",{class:"tips-got-it",onClick:vs},"Got it, let's go â†’")])):u("",!0)]),_:1}),a("div",it,[a("div",dt,[a("button",{class:"nav-btn",onClick:t[0]||(t[0]=e=>cs(-1)),title:"Previous day"},"â€¹"),a("div",ut,[a("div",ct,i(ts(f.value)),1),bs.value?(o(),l("div",pt,"Today")):ms.value?(o(),l("div",vt,"Upcoming")):(o(),l("div",yt,"Past"))]),a("button",{class:"nav-btn",onClick:t[1]||(t[1]=e=>cs(1)),title:"Next day"},"â€º")]),as.value?(o(),l("div",kt,[j(hs,{id:"dwl-user-select",modelValue:S.value,"onUpdate:modelValue":t[2]||(t[2]=e=>S.value=e),options:es.value,placeholder:"Viewing log for..."},null,8,["modelValue","options"])])):u("",!0),a("div",gt,[p.value.length?(o(),l("div",ft,[a("span",ht,i(_s.value)+" Pending",1),a("span",wt,i(Cs.value)+" Done",1),ls.value?(o(),l("span",bt,i(ls.value)+" Pushed",1)):u("",!0)])):u("",!0),a("button",{class:"btn-ghost-sm",onClick:t[3]||(t[3]=e=>H.value=!H.value),title:"Show tips"},"ðŸ’¡ Tips"),a("button",{class:"btn-outline",onClick:t[4]||(t[4]=e=>h.value=!h.value)},i(h.value?"Hide History":"ðŸ“… History"),1),a("button",{class:"btn-primary",onClick:t[5]||(t[5]=e=>$.value=!$.value)}," + Add Tasks ")])]),j(R,{name:"slide-down"},{default:U(()=>[$.value?(o(),l("div",mt,[a("div",_t,[a("div",Ct,[Ks(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>T.value=e),class:"picker-search",placeholder:"Search your tasksâ€¦",autofocus:""},null,512),[[Xs,T.value]]),a("div",Dt,[j(hs,{modelValue:M.value,"onUpdate:modelValue":t[7]||(t[7]=e=>M.value=e),options:Ds.value,placeholder:"Filter by project"},null,8,["modelValue","options"])])]),t[13]||(t[13]=a("span",{class:"picker-hint"},"Click to select, then Add",-1)),a("button",{class:"btn-primary btn-sm",disabled:g.value.size===0,onClick:Gs}," Add"+i(g.value.size>0?` (${g.value.size})`:""),9,xt),a("button",{class:"btn-ghost btn-sm",onClick:t[8]||(t[8]=e=>{$.value=!1,g.value=new Set})},"âœ•")]),G.value?(o(),l("div",Pt,"Loading your tasksâ€¦")):os.value.length===0?(o(),l("div",St,[T.value?(o(),l("span",Tt,'No tasks match "'+i(T.value)+'"',1)):(o(),l("span",$t,"All your active tasks are already in today's log! ðŸŽ‰"))])):(o(),l("div",It,[(o(!0),l(m,null,B(os.value,e=>{var r,n;return o(),l("div",{key:e.id,class:_(["picker-task",{selected:g.value.has(e.id)}]),onClick:y=>qs(e.id)},[a("div",{class:_(["picker-check",{checked:g.value.has(e.id)}])},[g.value.has(e.id)?(o(),l("svg",jt,t[14]||(t[14]=[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)]))):u("",!0)],2),a("div",Lt,[a("div",Ft,i(e.name),1),a("div",Bt,[(n=(r=e.milestone)==null?void 0:r.project)!=null&&n.name?(o(),l("span",Vt,i(e.milestone.project.name),1)):u("",!0),e.priority?(o(),l("span",{key:1,class:_(["tag",`prio-${e.priority}`])},i(e.priority),3)):u("",!0),a("span",{class:"tag",style:X({background:A(e.status).bg,color:A(e.status).color,border:`1px solid ${A(e.status).border}`})},i(e.status),5)])])],10,At)}),128))]))])):u("",!0)]),_:1}),a("div",Nt,[q.value?(o(),l("div",Mt,[(o(),l(m,null,B(3,e=>a("div",{class:"skeleton",key:e})),64))])):p.value.length===0?(o(),l("div",Ht,[t[15]||(t[15]=a("div",{class:"empty-icon"},"ðŸ“‹",-1)),t[16]||(t[16]=a("h3",null,"No tasks planned for this day",-1)),t[17]||(t[17]=a("p",null,"Add tasks from your assigned list and drag them into your preferred work order.",-1)),a("button",{class:"btn-primary",onClick:t[9]||(t[9]=e=>$.value=!0)},"+ Plan Your Day")])):(o(),l("ul",Ot,[(o(!0),l(m,null,B(p.value,e=>{var r,n,y,k,b,C,ys;return o(),l("li",{key:e.id,class:_(["task-card",{"is-done":e.status==="completed","is-pushed":e.status==="pushed_to_next_day","is-active":v(e)==="In Progress",dragging:L.value===e.id,"drag-over":O.value===e.id}]),draggable:"true",onDragstart:D=>zs(e),onDragover:D=>Us(e,D),onDrop:D=>Rs(e,D),onDragend:Ws},[t[32]||(t[32]=st('<div class="drag-handle" data-v-72fcb34a><svg viewBox="0 0 16 24" fill="currentColor" width="10" height="16" data-v-72fcb34a><circle cx="5" cy="4" r="2" data-v-72fcb34a></circle><circle cx="11" cy="4" r="2" data-v-72fcb34a></circle><circle cx="5" cy="12" r="2" data-v-72fcb34a></circle><circle cx="11" cy="12" r="2" data-v-72fcb34a></circle><circle cx="5" cy="20" r="2" data-v-72fcb34a></circle><circle cx="11" cy="20" r="2" data-v-72fcb34a></circle></svg></div>',1)),v(e)==="In Progress"?(o(),l("div",Ut,t[18]||(t[18]=[a("span",{class:"pulse-dot"},null,-1)]))):u("",!0),a("div",Rt,[a("div",{class:_(["task-name cursor-pointer hover:text-indigo-600 transition-colors",{"line-through":is(e)}]),onClick:D=>Hs(e.task)},i((r=e.task)==null?void 0:r.name),11,Wt),a("div",Et,[(k=(y=(n=e.task)==null?void 0:n.milestone)==null?void 0:y.project)!=null&&k.name?(o(),l("span",qt,i(e.task.milestone.project.name),1)):u("",!0),(C=(b=e.task)==null?void 0:b.milestone)!=null&&C.name?(o(),l("span",Gt,i(e.task.milestone.name),1)):u("",!0),(ys=e.task)!=null&&ys.priority?(o(),l("span",{key:2,class:_(["tag",`prio-${e.task.priority}`])},i(e.task.priority),3)):u("",!0),a("span",{class:"tag task-status-tag",style:X({background:A(v(e)).bg,color:A(v(e)).color,border:`1px solid ${A(v(e)).border}`})},i(v(e)),5),a("span",{class:_(["tag",`log-${e.status}`])},i(ps(e.status)),3)]),e.status!=="completed"&&e.status!=="pushed_to_next_day"?(o(),l("div",Yt,[v(e)==="To Do"?(o(),l(m,{key:0},[t[19]||(t[19]=d(" â„¹ï¸ Hit ",-1)),t[20]||(t[20]=a("strong",null,"Start",-1)),t[21]||(t[21]=d(" to begin tracking time on this task. ",-1))],64)):v(e)==="In Progress"?(o(),l(m,{key:1},[t[22]||(t[22]=d(" ðŸŸ¢ Task is running â€” hit ",-1)),t[23]||(t[23]=a("strong",null,"Pause",-1)),t[24]||(t[24]=d(" if you're stepping away, or ",-1)),t[25]||(t[25]=a("strong",null,"Complete",-1)),t[26]||(t[26]=d(" when done. ",-1))],64)):v(e)==="Paused"?(o(),l(m,{key:2},[t[27]||(t[27]=d(" â¸ Paused â€” hit ",-1)),t[28]||(t[28]=a("strong",null,"Resume",-1)),t[29]||(t[29]=d(" when you're ready to continue. ",-1))],64)):v(e)==="Blocked"?(o(),l(m,{key:3},[d(" ðŸ”´ This task is blocked. Unblock it in the task detail before starting. ")],64)):u("",!0)])):u("",!0)]),a("div",Qt,[Ss(e)?(o(),l("div",Jt)):(o(),l(m,{key:1},[a("button",{class:"btn-lifecycle",disabled:F(e).disabled||v(e)==="Blocked",style:X(Es(e)),onClick:D=>Ls(e),title:F(e).label},i(F(e).label),13,Kt),e.status==="pending"?(o(),l("button",{key:0,class:"btn-icon push-btn",title:"Push to tomorrow",onClick:D=>Ns(e)},t[30]||(t[30]=[a("svg",{viewBox:"0 0 20 20",fill:"currentColor",width:"14",height:"14"},[a("path",{"fill-rule":"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Xt)):u("",!0),a("button",{class:"btn-icon note-btn",title:"Add Note",onClick:D=>Os(e.task)},t[31]||(t[31]=[a("span",{style:{"font-size":"14px"}},"ðŸ“",-1)]),8,Zt),a("button",{class:"btn-icon remove-btn",title:"Remove from today's log",onClick:D=>Ms(e)},"âœ•",8,se)],64))])],42,zt)}),128))])),p.value.length>0?(o(),l("div",te,[Y.value?(o(),l("span",ee,"Saving orderâ€¦")):(o(),l("span",ae,"Drag to reorder â€¢ Changes are saved automatically"))])):u("",!0)]),j(R,{name:"fade"},{default:U(()=>{var e,r;return[P.value.show?(o(),l("div",{key:0,class:"modal-overlay",onClick:Zs(ds,["self"])},[a("div",oe,[t[35]||(t[35]=a("div",{class:"warn-modal-icon"},"âš ï¸",-1)),t[36]||(t[36]=a("h3",{class:"warn-modal-title"},"Task hasn't been started yet",-1)),a("p",le,[a("strong",null,i((r=(e=P.value.item)==null?void 0:e.task)==null?void 0:r.name),1),t[33]||(t[33]=d(" is currently ",-1)),a("em",null,i(v(P.value.item)),1),t[34]||(t[34]=d(". ",-1))]),t[37]||(t[37]=a("p",{class:"warn-modal-body"},[d(" Our workflow requires you to "),a("strong",null,"start"),d(" a task before marking it complete â€” this helps track time accurately and keeps the team informed. ")],-1)),t[38]||(t[38]=a("div",{class:"warn-tips"},[a("div",{class:"warn-tip"},[d("âœ… "),a("strong",null,"Best practice:"),d(" Start â†’ work on the task â†’ Pause if interrupted â†’ Complete when done.")]),a("div",{class:"warn-tip"},[d("âš¡ "),a("strong",null,"Quick option:"),d(" If you've already finished this task, we can start & complete it now â€” but please use proper start/pause/complete going forward.")])],-1)),a("div",{class:"warn-modal-actions"},[a("button",{class:"btn-outline",onClick:ds},"Go back â€” I'll start it first"),a("button",{class:"btn-warn-ok",onClick:js},"Mark as complete anyway")])])])):u("",!0)]}),_:1}),j(R,{name:"slide-down"},{default:U(()=>[h.value?(o(),l("div",ne,[t[39]||(t[39]=a("h3",{class:"history-title"},"ðŸ“… Past 14 Days â€” Task Log",-1)),t[40]||(t[40]=a("p",{class:"history-sub"},"Track patterns: tasks pushed repeatedly may need re-prioritisation or support.",-1)),ns.value.length===0?(o(),l("div",re,"No history yet â€” come back after your first day!")):u("",!0),(o(!0),l(m,null,B(ns.value,([e,r])=>(o(),l("div",{key:e,class:"history-day"},[a("div",ie,[a("span",de,i(ts(e)),1),a("div",ue,[a("span",ce,i(r.filter(n=>n.status==="completed").length)+" done",1),r.filter(n=>n.status==="pending").length?(o(),l("span",pe,i(r.filter(n=>n.status==="pending").length)+" unfinished ",1)):u("",!0),r.filter(n=>n.status==="pushed_to_next_day").length?(o(),l("span",ve,i(r.filter(n=>n.status==="pushed_to_next_day").length)+" pushed ",1)):u("",!0)])]),a("ul",ye,[(o(!0),l(m,null,B(r,n=>{var y,k,b,C;return o(),l("li",{key:n.id,class:_(["history-item",`his-${n.status}`])},[a("span",{class:_(["h-dot",`hdot-${n.status}`])},null,2),a("span",ke,i((y=n.task)==null?void 0:y.name),1),(C=(b=(k=n.task)==null?void 0:k.milestone)==null?void 0:b.project)!=null&&C.name?(o(),l("span",ge,i(n.task.milestone.project.name),1)):u("",!0),a("span",{class:_(["tag",`log-${n.status}`]),style:{"font-size":".65rem"}},i(ps(n.status)),3)],2)}),128))])]))),128))])):u("",!0)]),_:1}),N.value?(o(),Js(et,{key:0,show:N.value,"task-for-note":J.value,onClose:t[10]||(t[10]=e=>{N.value=!1,J.value=null}),onNoteAdded:z},null,8,["show","task-for-note"])):u("",!0)]))}},Ie=lt(fe,[["__scopeId","data-v-72fcb34a"]]);export{Ie as default};
