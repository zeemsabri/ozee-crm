import{c as a,o,a as e,r as c,b as F,e as l,u as d,h as L,w as $,k as x,f as P,v as T,F as g,i as v,n as _,t as n,g as b,q as U,K as H,L as K}from"./app-B7zt4a3c.js";import{b as O,_ as q}from"./AuthenticatedLayout-BHs-_Akd.js";import{_ as z}from"./MultiSelectDropdown-CmHEl0rc.js";import{R as W}from"./RightSidebar-CciAqVoN.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as I}from"./BriefcaseIcon-9aXyWp_C.js";import{r as Z,a as G}from"./PrinterIcon-DOyzNGGU.js";import{r as J}from"./ChevronDownIcon-D1J_6YGD.js";import{r as Q,a as X}from"./SparklesIcon-BCzMQQjy.js";import{r as ee}from"./ClockIcon-CsMa_l1L.js";import{r as te}from"./ArrowPathIcon-CzbK0bAE.js";import"./PrimaryButton-CLAx9hgG.js";import"./Modal-C-eVHoKX.js";import"./InputLabel-Dv81o_rC.js";import"./InputError-Mt9U77nq.js";import"./SecondaryButton-D-pNohvm.js";import"./index-CRx4duYF.js";import"./BaseFormModal-CyEESeqj.js";import"./TextInput-DQXuiN1m.js";import"./SelectDropdown-DYsx7BC1.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-I-WEemHp.js";import"./createLucideIcon-DU4WP9ew.js";import"./plus-gdCtVgZw.js";import"./DangerButton-g9_bNAYR.js";import"./moment-BLMuvzoS.js";import"./taskState-Ca6C4ycI.js";import"./NoticeboardModal-Dc2LiXKP.js";import"./x-r7k7kXKt.js";function se(S,u){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}function N(S,u){return o(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})])}const oe={class:"flex justify-between items-center print:hidden"},re={class:"flex gap-3"},ae=["disabled"],ie={class:"py-8 bg-gray-50 min-h-screen print:bg-white print:py-0"},ne={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},le={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 print:hidden"},de={class:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end"},ce={class:"col-span-2"},ue={key:0,class:"bg-white p-12 text-center rounded-xl border border-dashed border-gray-300"},pe=["onClick"],me={class:"flex items-center space-x-4"},xe={class:"h-12 w-12 rounded-lg bg-indigo-100 flex items-center justify-center text-indigo-600"},ge={class:"font-bold text-xl text-gray-900"},ve={class:"flex items-center gap-3 mt-1"},be={key:0,class:"text-[10px] text-indigo-600 font-bold uppercase flex items-center"},he={key:1,class:"text-[10px] text-gray-400 font-bold uppercase"},_e={class:"flex items-center gap-6"},fe={class:"flex gap-4"},ye={class:"text-center px-4 py-1.5 rounded-lg bg-blue-50"},we={class:"text-sm font-black text-blue-700"},ke={class:"text-center px-4 py-1.5 rounded-lg bg-purple-50"},je={class:"text-sm font-black text-purple-700"},Ce={class:"p-6 space-y-8 animate-in fade-in slide-in-from-top-2 duration-300"},De={key:0},$e={class:"text-sm font-black text-gray-400 uppercase tracking-widest mb-4 flex items-center"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Se={class:"text-gray-800 text-sm italic mb-3 whitespace-pre-wrap"},Ve={class:"flex items-center justify-between"},Re={class:"flex items-center"},Ae={class:"h-6 w-6 rounded-full bg-blue-200 flex items-center justify-center text-[10px] font-bold text-blue-700 mr-2"},Te={class:"text-[11px] font-bold text-blue-700"},Ue={class:"text-[10px] text-blue-400 font-medium"},Ie={key:1},Ne={class:"text-sm font-black text-gray-400 uppercase tracking-widest mb-4 flex items-center"},Ee={class:"space-y-4"},Me={class:"flex justify-between items-start mb-4"},Be=["onClick"],Fe={class:"text-[10px] text-gray-500 font-medium uppercase mt-1"},Le={key:0,class:"pl-4 border-l-2 border-indigo-200 space-y-3"},He={class:"text-sm text-gray-700 whitespace-pre-wrap"},Ke={class:"flex items-center mt-1 text-[10px] text-gray-400 font-bold"},Oe={class:"text-indigo-500 mr-2"},qe={key:1,class:"text-xs text-gray-400 italic pl-4"},ze={key:2},We={class:"text-sm font-black text-gray-400 uppercase tracking-widest mb-4 flex items-center"},Ye={class:"space-y-4"},Ze={class:"flex justify-between items-start mb-3"},Ge={class:"flex items-center"},Je={class:"font-bold text-gray-900"},Qe={class:"text-[10px] text-gray-500 font-medium uppercase mt-1"},Xe={class:"text-[10px] text-gray-400 font-bold"},et={key:0,class:"mt-3"},tt={class:"flex items-center mb-1"},st={class:"text-sm text-gray-800 leading-relaxed"},ot={key:3,class:"py-12 bg-gray-50 rounded-xl text-center border border-dashed border-gray-200"},rt={__name:"ProjectIndex",setup(S){const u=c([]),V=c([]),h=c(!1),j=c([]),f=c(""),y=c(""),m=c({}),w=c(!1),C=c(null),k=c(null),R=c([]),E=i=>{m.value[i]=!m.value[i]},M=async i=>{if(!(!i||!i.id)){if(C.value=i.id,k.value=i.project_id||0,k.value)try{const t=await window.axios.get(`/api/projects/${k.value}/sections/clients-users`);R.value=t.data.users||[]}catch(t){console.error("Failed to fetch project users",t)}w.value=!0}},A=async()=>{h.value=!0;try{const i=await window.axios.get("/api/productivity/project-report",{params:{project_ids:j.value.join(","),date_start:f.value,date_end:y.value}});u.value=i.data.reportData,V.value=i.data.projects,u.value.length===1?m.value[u.value[0].id]=!0:u.value.forEach(t=>{t.has_activity&&(m.value[t.id]=!0)})}catch(i){console.error(i)}finally{h.value=!1}},D=i=>i?new Date(i).toLocaleDateString("en-AU",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"";F(()=>{const i=new Date,t=new Date(i.getFullYear(),i.getMonth(),1);f.value=t.toISOString().split("T")[0],y.value=i.toISOString().split("T")[0],A()});const B=()=>window.print();return(i,t)=>(o(),a(g,null,[l(d(L),{title:"Project Activity Report"}),l(q,null,{header:$(()=>[e("div",oe,[t[7]||(t[7]=e("h2",{class:"font-bold text-2xl text-gray-900 tracking-tight"},"Project Activity Report",-1)),e("div",re,[e("button",{onClick:A,disabled:h.value,class:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-semibold hover:bg-indigo-700 shadow-sm transition disabled:opacity-50"},[l(d(te),{class:_(["h-4 w-4 mr-2",{"animate-spin":h.value}])},null,8,["class"]),t[5]||(t[5]=b(" Refresh ",-1))],8,ae),e("button",{onClick:B,class:"flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-semibold text-gray-700 hover:bg-gray-50 shadow-sm transition"},[l(d(G),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=b(" Export PDF ",-1))])])])]),default:$(()=>[e("div",ie,[e("div",ne,[e("div",le,[e("div",de,[e("div",ce,[t[8]||(t[8]=e("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Filter Projects",-1)),l(z,{modelValue:j.value,"onUpdate:modelValue":t[0]||(t[0]=s=>j.value=s),options:V.value,"is-multi":!0,placeholder:"All Projects"},null,8,["modelValue","options"])]),e("div",null,[t[9]||(t[9]=e("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Range Start",-1)),P(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-indigo-500"},null,512),[[T,f.value]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Range End",-1)),P(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-indigo-500"},null,512),[[T,y.value]])])])]),u.value.length===0&&!h.value?(o(),a("div",ue,[l(d(I),{class:"h-12 w-12 text-gray-300 mx-auto mb-4"}),t[11]||(t[11]=e("p",{class:"text-gray-500 font-medium"},"No projects found for the selected criteria.",-1))])):x("",!0),(o(!0),a(g,null,v(u.value,s=>(o(),a("div",{key:s.id,class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden mb-6"},[e("div",{onClick:r=>E(s.id),class:_(["p-6 flex items-center justify-between cursor-pointer hover:bg-gray-50 transition print:cursor-default",{"border-b border-gray-100":m.value[s.id]}])},[e("div",me,[e("div",xe,[l(d(I),{class:"h-7 w-7"})]),e("div",null,[e("h4",ge,n(s.name),1),e("div",ve,[e("span",{class:_(["px-2 py-0.5 rounded text-[10px] font-black uppercase",s.status==="Active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"])},n(s.status),3),s.has_activity?(o(),a("span",be,t[12]||(t[12]=[e("div",{class:"h-1.5 w-1.5 rounded-full bg-indigo-600 mr-1.5 animate-pulse"},null,-1),b(" Recent Activity ",-1)]))):(o(),a("span",he,"No Activity"))])])]),e("div",_e,[e("div",fe,[e("div",ye,[e("div",we,n(s.tasks.length),1),t[13]||(t[13]=e("p",{class:"text-[9px] text-blue-500 font-bold uppercase"},"Tasks",-1))]),e("div",ke,[e("div",je,n(s.emails.length),1),t[14]||(t[14]=e("p",{class:"text-[9px] text-purple-500 font-bold uppercase"},"Emails",-1))])]),(o(),U(H(m.value[s.id]?d(Z):d(J)),{class:"h-5 w-5 text-gray-400 print:hidden"}))])],10,pe),P(e("div",Ce,[s.project_notes.length?(o(),a("div",De,[e("h5",$e,[l(d(Q),{class:"h-4 w-4 mr-2"}),t[15]||(t[15]=b(" Project Updates & Notes ",-1))]),e("div",Pe,[(o(!0),a(g,null,v(s.project_notes,r=>(o(),a("div",{key:r.id,class:"bg-blue-50/50 p-4 rounded-xl border border-blue-100 relative"},[e("div",Se,'"'+n(r.content)+'"',1),e("div",Ve,[e("div",Re,[e("div",Ae,n(r.creator_name?r.creator_name.substring(0,2).toUpperCase():"??"),1),e("span",Te,n(r.creator_name||"System"),1)]),e("span",Ue,n(D(r.created_at)),1)])]))),128))])])):x("",!0),s.tasks.length?(o(),a("div",Ie,[e("h5",Ne,[l(d(se),{class:"h-4 w-4 mr-2"}),t[16]||(t[16]=b(" Key Tasks & Updates ",-1))]),e("div",Ee,[(o(!0),a(g,null,v(s.tasks,r=>(o(),a("div",{key:r.id,class:"bg-gray-50 rounded-xl p-5 border border-gray-100"},[e("div",Me,[e("div",null,[e("h6",{onClick:p=>M(r),class:"font-bold text-gray-900 hover:text-indigo-600 cursor-pointer transition"},n(r.name),9,Be),e("p",Fe,n(r.milestone)+" • "+n(r.assigned_to||"Unassigned"),1)]),e("span",{class:_(["px-2 py-0.5 rounded text-[9px] font-black uppercase",r.status==="Done"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"])},n(r.status),3)]),r.notes.length?(o(),a("div",Le,[(o(!0),a(g,null,v(r.notes,p=>(o(),a("div",{key:p.id,class:"relative"},[e("div",He,n(p.content),1),e("div",Ke,[e("span",Oe,n(p.creator_name),1),e("span",null,n(D(p.created_at)),1)])]))),128))])):(o(),a("div",qe,"No specific updates recorded for this task."))]))),128))])])):x("",!0),s.emails.length?(o(),a("div",ze,[e("h5",We,[l(d(N),{class:"h-4 w-4 mr-2"}),t[17]||(t[17]=b(" Communications ",-1))]),e("div",Ye,[(o(!0),a(g,null,v(s.emails,r=>(o(),a("div",{key:r.id,class:"bg-purple-50/30 rounded-xl p-5 border border-purple-100"},[e("div",Ze,[e("div",Ge,[e("div",{class:_([r.type==="Received"?"bg-orange-100 text-orange-600":"bg-green-100 text-green-600","p-2 rounded-lg mr-3"])},[l(d(N),{class:"h-4 w-4"})],2),e("div",null,[e("h6",Je,n(r.subject),1),e("p",Qe,n(r.type)+" • "+n(r.sender),1)])]),e("span",Xe,n(D(r.created_at)),1)]),r.contexts.length?(o(),a("div",et,[(o(!0),a(g,null,v(r.contexts,p=>(o(),a("div",{key:p.id,class:"bg-white/80 p-3 rounded-lg border border-purple-200"},[e("div",tt,[l(d(X),{class:"h-3 w-3 text-purple-600 mr-2"}),t[18]||(t[18]=e("span",{class:"text-[10px] font-black text-purple-600 uppercase tracking-tighter"},"AI Summary",-1))]),e("div",st,n(p.summary),1)]))),128))])):x("",!0)]))),128))])])):x("",!0),s.has_activity?x("",!0):(o(),a("div",ot,[l(d(ee),{class:"h-8 w-8 text-gray-300 mx-auto mb-2"}),t[19]||(t[19]=e("p",{class:"text-xs text-gray-400 font-bold uppercase tracking-widest"},"Minimal Status Change in this Period",-1))]))],512),[[K,m.value[s.id]]])]))),128))])]),l(W,{show:w.value,"onUpdate:show":t[4]||(t[4]=s=>w.value=s),title:"Task Details",initialWidth:45},{content:$(()=>[C.value?(o(),U(O,{key:0,"task-id":C.value,"project-id":k.value,"project-users":R.value,onClose:t[3]||(t[3]=s=>w.value=!1)},null,8,["task-id","project-id","project-users"])):x("",!0)]),_:1},8,["show"])]),_:1})],64))}},It=Y(rt,[["__scopeId","data-v-6c5d36c4"]]);export{It as default};
