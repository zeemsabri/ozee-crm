import{A as le}from"./ApplicationLogo-DHDHjUvD.js";import{z as F,B as te,p as B,r as C,h as k,o as r,b as t,f as H,e as f,y as P,J as Z,a as n,n as L,T as ne,c as $,R as se,u as S,S as Y,t as I,F as K,i as Q,U as de,w as ue,d as ce,g as x,l as ve,k as m,j as J,m as N,V as me,C as j,A as fe,G as ge}from"./app-Cftj8kez.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as ae}from"./PrimaryButton-BNBWD5Jx.js";import{a as pe,_ as ye}from"./SecondaryButton-CVyu_OeR.js";import{_ as G,a as O}from"./InputError-Dysw4GLH.js";const be={class:"relative"},ee={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(u){const d=u,c=i=>{o.value&&i.key==="Escape"&&(o.value=!1)};F(()=>document.addEventListener("keydown",c)),te(()=>document.removeEventListener("keydown",c));const p=B(()=>({48:"w-48"})[d.width.toString()]),_=B(()=>d.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":d.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),o=C(!1);return(i,v)=>(r(),k("div",be,[t("div",{onClick:v[0]||(v[0]=b=>o.value=!o.value)},[P(i.$slots,"trigger")]),H(t("div",{class:"fixed inset-0 z-40",onClick:v[1]||(v[1]=b=>o.value=!1)},null,512),[[Z,o.value]]),f(ne,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:n(()=>[H(t("div",{class:L(["absolute z-50 mt-2 rounded-md shadow-lg",[p.value,_.value]]),style:{display:"none"},onClick:v[2]||(v[2]=b=>o.value=!1)},[t("div",{class:L(["rounded-md ring-1 ring-black ring-opacity-5",u.contentClasses])},[P(i.$slots,"content")],2)],2),[[Z,o.value]])]),_:3})]))}},W={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(u){return(d,c)=>(r(),$(S(Y),se({href:u.href,method:u.method,as:u.as},d.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:n(()=>[P(d.$slots,"default")]),_:3},16,["href","method","as"]))}},R={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(u){const d=u,c=B(()=>d.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(p,_)=>(r(),$(S(Y),{href:u.href,class:L(c.value)},{default:n(()=>[P(p.$slots,"default")]),_:3},8,["href","class"]))}},E={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(u){const d=u,c=B(()=>d.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(p,_)=>(r(),$(S(Y),se({href:u.href,method:u.method,as:u.as},p.$attrs,{class:c.value}),{default:n(()=>[P(p.$slots,"default")]),_:3},16,["href","method","as","class"]))}},_e={class:"p-4 flex items-start"},we={class:"flex-shrink-0"},xe=["d"],ke={class:"ml-3 w-0 flex-1 pt-0.5"},Se={class:"text-sm font-medium"},$e={__name:"Notification",props:{type:{type:String,default:"info",validator:u=>["success","error","info","warning"].includes(u)},message:{type:String,required:!0},duration:{type:Number,default:5e3},id:{type:String,required:!0}},emits:["close"],setup(u,{emit:d}){const c=u,p=d,_=C(!1),o=C(null),i=B(()=>{switch(c.type){case"success":return"bg-green-50 text-green-800 border-green-400";case"error":return"bg-red-50 text-red-800 border-red-400";case"warning":return"bg-yellow-50 text-yellow-800 border-yellow-400";default:return"bg-blue-50 text-blue-800 border-blue-400"}}),v=B(()=>{switch(c.type){case"success":return"text-green-500";case"error":return"text-red-500";case"warning":return"text-yellow-500";default:return"text-blue-500"}}),b=B(()=>{switch(c.type){case"success":return"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z";case"error":return"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z";case"warning":return"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z";default:return"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}),M=()=>{_.value=!1,o.value&&clearTimeout(o.value),setTimeout(()=>{p("close",c.id)},300)};return F(()=>{setTimeout(()=>{_.value=!0},100),c.duration>0&&(o.value=setTimeout(()=>{M()},c.duration))}),(A,z)=>(r(),k("div",{class:L(["fixed z-50 transition-all duration-300 ease-in-out transform",[_.value?"opacity-100 translate-y-0":"opacity-0 translate-y-2","max-w-sm w-full shadow-lg rounded-lg pointer-events-auto border-l-4",i.value]]),role:"alert"},[t("div",_e,[t("div",we,[(r(),k("svg",{class:L(["h-5 w-5",v.value]),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:b.value,"clip-rule":"evenodd"},null,8,xe)],2))]),t("div",ke,[t("p",Se,I(u.message),1)]),t("div",{class:"ml-4 flex-shrink-0 flex"},[t("button",{class:"bg-transparent rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:M},z[0]||(z[0]=[t("span",{class:"sr-only"},"Close",-1),t("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])],2))}},Ae={class:"fixed top-4 right-4 z-50 space-y-4 w-full max-w-sm"},Ce={__name:"NotificationContainer",setup(u,{expose:d}){const c=C([]),p=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),_=(i,v="info",b=5e3)=>{const M=p();return c.value.push({id:M,message:i,type:v,duration:b}),M},o=i=>{const v=c.value.findIndex(b=>b.id===i);v!==-1&&c.value.splice(v,1)};return d({addNotification:_,removeNotification:o,success:(i,v)=>_(i,"success",v),error:(i,v)=>_(i,"error",v),info:(i,v)=>_(i,"info",v),warning:(i,v)=>_(i,"warning",v)}),(i,v)=>(r(),k("div",Ae,[f(de,{name:"notification"},{default:n(()=>[(r(!0),k(K,null,Q(c.value,b=>(r(),$($e,{key:b.id,id:b.id,type:b.type,message:b.message,duration:b.duration,onClose:o},null,8,["id","type","message","duration"]))),128))]),_:1})]))}},De=he(Ce,[["__scopeId","data-v-24b5eed3"]]),Ee={class:"p-6"},Me={class:"mt-6"},Te={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},Le={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},ze={class:"flex items-center mb-3"},Ie=["id","onUpdate:modelValue"],Ne=["for"],Be={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},Ue={key:0},Ve={class:"mb-4"},We={class:"flex items-center"},Pe=["id","checked","onChange"],Re=["for"],He={key:0,class:"mb-4"},qe=["id","onUpdate:modelValue"],Fe={key:1,class:"mb-4"},Ge={class:"flex-1"},Ye=["id","onUpdate:modelValue"],Je={class:"flex-1"},Ke=["id","onUpdate:modelValue"],Qe={key:0,class:"flex items-end pb-1"},Xe=["onClick"],Ze=["onClick"],je={class:"mt-6 flex justify-end space-x-3"},Oe={key:0,class:"flex items-center"},et={key:1},tt={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const u=new Date;return u.setDate(u.getDate()+1),u.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]}},emits:["close","availability-saved"],setup(u,{emit:d}){const c=()=>{const e=localStorage.getItem("authToken");e&&!N.defaults.headers.common.Authorization&&(N.defaults.headers.common.Authorization=`Bearer ${e}`,console.log("Auth headers set in AvailabilityModal"))},p=u,_=d,o=C({}),i=C({}),v=C(!1),b=C(""),M=()=>{const e=[],l=new Date,a=new Date(l);a.setDate(l.getDate()+1);for(let y=0;y<7;y++){const g=new Date(a);g.setDate(a.getDate()+y);const h=g.toISOString().split("T")[0];e.push({value:h,label:g.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),o.value[h]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return e},A=C([]);F(()=>{c(),p.nextWeekDates.length>0?(A.value=p.nextWeekDates,p.nextWeekDates.forEach(e=>{o.value[e.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):A.value=M()});const z=async()=>{try{if(c(),A.value.length===0)return;const e=A.value[0].value,l=A.value[A.value.length-1].value,a=await N.get("/api/availabilities",{params:{start_date:e,end_date:l}});if(a.data&&a.data.availabilities){const y=a.data.availabilities;A.value.forEach(g=>{o.value[g.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),y.forEach(g=>{const h=g.date.split("T")[0];o.value[h]&&(o.value[h].isSelected=!0,o.value[h].isAvailable=g.is_available,g.is_available?o.value[h].timeSlots=g.time_slots&&g.time_slots.length>0?[...g.time_slots]:[{start_time:"",end_time:""}]:o.value[h].reason=g.reason||"")})}}catch(e){console.error("Error fetching existing availabilities:",e),A.value.forEach(l=>{o.value[l.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};ue(()=>p.show,async e=>{e&&(i.value={},b.value="",await z())},{immediate:!0});const U=e=>{o.value[e].timeSlots.push({start_time:"",end_time:""})},V=(e,l)=>{o.value[e].timeSlots.length>1&&o.value[e].timeSlots.splice(l,1)},w=(e,l)=>{o.value[e].isAvailable=l,l?o.value[e].reason="":o.value[e].timeSlots=[{start_time:"",end_time:""}]},s=async()=>{v.value=!0,i.value={},b.value="";const e=[];let l=!1;for(const a of A.value){const y=a.value,g=o.value[y];if(g.isSelected){let h={};if(g.isAvailable)if(g.timeSlots.some(D=>!D.start_time||!D.end_time))h.timeSlots="Please fill in all time slots.",l=!0;else for(const D of g.timeSlots){const T=D.start_time.split(":").map(Number),q=D.end_time.split(":").map(Number);if(T.length!==2||q.length!==2||isNaN(T[0])||isNaN(T[1])||isNaN(q[0])||isNaN(q[1])){h.timeSlots="Invalid time format. Please use HH:MM format.",l=!0;break}const re=T[0]*60+T[1],ie=q[0]*60+q[1];if(re>=ie){h.timeSlots="End time must be after start time.",l=!0;break}}else g.reason.trim()||(h.reason="Please provide a reason for unavailability.",l=!0);Object.keys(h).length>0&&(i.value[y]=h),Object.keys(h).length===0&&e.push({date:y,is_available:g.isAvailable,reason:g.isAvailable?null:g.reason,time_slots:g.isAvailable?g.timeSlots:null})}}if(l){v.value=!1,i.value.general="Please correct the errors in the highlighted dates.";return}if(e.length===0){i.value.general="Please select at least one day to set availability for.",v.value=!1;return}try{c();const a=await N.post("/api/availabilities/batch",{availabilities:e});b.value="Availability saved successfully!";try{const y=await N.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",y.data.should_block_user),localStorage.setItem("allWeekdaysCovered",y.data.all_weekdays_covered);const g=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:y.data.should_block_user,allWeekdaysCovered:y.data.all_weekdays_covered}});window.dispatchEvent(g),console.log("Availability status updated from modal:",{shouldBlockUser:y.data.should_block_user,allWeekdaysCovered:y.data.all_weekdays_covered})}catch(y){console.error("Error updating availability status:",y)}_("availability-saved",a.data.availabilities),setTimeout(()=>{_("close")},1500)}catch(a){console.error("Error saving availability:",a),a.response&&a.response.data&&a.response.data.errors?i.value.general=a.response.data.message||"An error occurred while saving your availability.":a.response&&a.response.status===409?(b.value=a.response.data.message,setTimeout(()=>{_("close")},1500)):i.value.general="An unexpected error occurred while saving your availability."}finally{v.value=!1}};return(e,l)=>(r(),$(ye,{show:u.show,onClose:l[1]||(l[1]=a=>e.$emit("close")),"max-width":"xl"},{default:n(()=>[t("div",Ee,[l[6]||(l[6]=t("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),l[7]||(l[7]=t("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),t("div",Me,[t("form",{onSubmit:ce(s,["prevent"])},[b.value?(r(),k("div",Te,I(b.value),1)):x("",!0),i.value.general?(r(),k("div",Le,I(i.value.general),1)):x("",!0),(r(!0),k(K,null,Q(A.value,a=>{var y,g;return r(),k("div",{key:a.value,class:L(["mb-6 p-4 border rounded-lg shadow-sm",[o.value[a.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",o.value[a.value].isSelected&&!i.value[a.value]?"border-l-4 border-l-indigo-500":""]])},[t("div",ze,[H(t("input",{type:"checkbox",id:`select_date_${a.value}`,"onUpdate:modelValue":h=>o.value[a.value].isSelected=h,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,Ie),[[ve,o.value[a.value].isSelected]]),t("label",{for:`select_date_${a.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[m(I(a.label)+" ",1),o.value[a.value].isSelected?(r(),k("span",Be," Saved ")):x("",!0)],8,Ne)]),o.value[a.value].isSelected?(r(),k("div",Ue,[t("div",Ve,[t("div",We,[t("input",{type:"checkbox",id:`isAvailableToggle_${a.value}`,checked:o.value[a.value].isAvailable,onChange:h=>w(a.value,h.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,Pe),t("label",{for:`isAvailableToggle_${a.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,Re)])]),o.value[a.value].isAvailable?x("",!0):(r(),k("div",He,[f(G,{for:`reason_${a.value}`,value:"Reason for Not Available"},null,8,["for"]),H(t("textarea",{id:`reason_${a.value}`,"onUpdate:modelValue":h=>o.value[a.value].reason=h,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,qe),[[J,o.value[a.value].reason]]),f(O,{message:(y=i.value[a.value])==null?void 0:y.reason,class:"mt-2"},null,8,["message"])])),o.value[a.value].isAvailable?(r(),k("div",Fe,[f(G,{value:"Available Time Slots"}),f(O,{message:(g=i.value[a.value])==null?void 0:g.timeSlots,class:"mt-2"},null,8,["message"]),(r(!0),k(K,null,Q(o.value[a.value].timeSlots,(h,D)=>(r(),k("div",{key:D,class:"flex items-center space-x-2 mt-2"},[t("div",Ge,[f(G,{for:`start_time_${a.value}_${D}`,value:"Start Time",class:"text-xs"},null,8,["for"]),H(t("input",{id:`start_time_${a.value}_${D}`,type:"time","onUpdate:modelValue":T=>h.start_time=T,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Ye),[[J,h.start_time]])]),t("div",Je,[f(G,{for:`end_time_${a.value}_${D}`,value:"End Time",class:"text-xs"},null,8,["for"]),H(t("input",{id:`end_time_${a.value}_${D}`,type:"time","onUpdate:modelValue":T=>h.end_time=T,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Ke),[[J,h.end_time]])]),o.value[a.value].timeSlots.length>1?(r(),k("div",Qe,[t("button",{type:"button",onClick:T=>V(a.value,D),class:"p-2 text-red-600 hover:text-red-800"},l[2]||(l[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,Xe)])):x("",!0)]))),128)),t("button",{type:"button",onClick:h=>U(a.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},l[3]||(l[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),m(" Add Another Time Slot ")]),8,Ze)])):x("",!0)])):x("",!0)],2)}),128)),t("div",je,[f(pe,{onClick:l[0]||(l[0]=a=>e.$emit("close"))},{default:n(()=>l[4]||(l[4]=[m(" Cancel ")])),_:1,__:[4]}),f(ae,{disabled:v.value,class:L({"opacity-50":v.value})},{default:n(()=>[v.value?(r(),k("span",Oe,l[5]||(l[5]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),m(" Saving... ")]))):(r(),k("span",et,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},st={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},at={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},ot={class:"flex justify-center"},rt={__name:"AvailabilityBlocker",setup(u){const d=C(!1),c=C(!0),p=C(!1),_=C([]),o=()=>{const w=localStorage.getItem("authToken");w&&!N.defaults.headers.common.Authorization&&(N.defaults.headers.common.Authorization=`Bearer ${w}`)},i=async()=>{c.value=!0;const w=localStorage.getItem("shouldBlockUser"),s=localStorage.getItem("allWeekdaysCovered");if(w==="true"&&s==="false")d.value=!0,await v();else try{o();const e=await N.get("/api/availability-prompt");d.value=e.data.should_block_user&&!e.data.all_weekdays_covered,d.value&&await v()}catch(e){console.error("Error checking if user should be blocked:",e),d.value=!1}c.value=!1},v=async()=>{try{o();const w=await N.get("/api/availability-prompt");b(w.data.next_week_start,w.data.next_week_end)}catch(w){console.error("Error fetching next week dates:",w)}},b=(w,s)=>{const e=[],l=new Date(w),a=new Date(s),y=new Date(l);for(;y<=a;)e.push({value:y.toISOString().split("T")[0],label:y.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),y.setDate(y.getDate()+1);_.value=e},M=()=>{p.value=!0},A=()=>{i()},z=w=>{d.value=w.detail.shouldBlockUser&&!w.detail.allWeekdaysCovered},U=()=>{document.visibilityState==="visible"&&j(()=>{i()})},V=w=>{(w.key==="shouldBlockUser"||w.key==="allWeekdaysCovered")&&j(()=>{i()})};return F(()=>{i(),window.addEventListener("availability-status-updated",z),document.addEventListener("visibilitychange",U),window.addEventListener("storage",V)}),te(()=>{window.removeEventListener("availability-status-updated",z),document.removeEventListener("visibilitychange",U),window.removeEventListener("storage",V)}),(w,s)=>d.value&&!c.value?(r(),k("div",st,[t("div",at,[s[2]||(s[2]=me('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),t("div",ot,[f(ae,{onClick:M,class:"bg-red-600 hover:bg-red-700"},{default:n(()=>s[1]||(s[1]=[m(" Submit Availability Now ")])),_:1,__:[1]})]),f(tt,{show:p.value,"next-week-dates":_.value,date:_.value.length>0?_.value[0].value:"",onClose:s[0]||(s[0]=e=>p.value=!1),onAvailabilitySaved:A},null,8,["show","next-week-dates","date"])])])):x("",!0)}};let X=null;const it=u=>{X=u},oe=(u,d="info",c=5e3)=>X?X.addNotification(u,d,c):(console.warn("Notification container not set. Call setNotificationContainer first."),null),Ut=(u,d=5e3)=>oe(u,"success",d),Vt=(u,d=5e3)=>oe(u,"error",d),lt={class:"min-h-screen bg-gray-100"},nt={class:"border-b border-gray-100 bg-white"},dt={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},ut={class:"flex h-16 justify-between"},ct={class:"flex"},vt={class:"flex shrink-0 items-center"},mt={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},ft={key:4,class:"hidden sm:flex sm:items-center"},gt={class:"hidden sm:ms-6 sm:flex sm:items-center"},ht={class:"relative ms-3"},pt={class:"inline-flex rounded-md"},yt={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},bt={class:"-me-2 flex items-center sm:hidden"},_t={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},wt={class:"space-y-1 pb-3 pt-2"},xt={key:6,class:"mt-3 space-y-1"},kt={class:"border-t border-gray-200 pb-1 pt-4"},St={class:"px-4"},$t={class:"text-base font-medium text-gray-800"},At={class:"text-sm font-medium text-gray-500"},Ct={class:"text-sm font-medium text-gray-500 capitalize"},Dt={class:"mt-3 space-y-1"},Et={key:0,class:"bg-white shadow"},Mt={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},Wt={__name:"AuthenticatedLayout",setup(u){const d=C(!1),c=B(()=>fe().props.auth.user);B(()=>{var s;return((s=c.value.role_data)==null?void 0:s.name)||""});const{canDo:p}=ge(),_=p("manage_projects"),o=p("compose_emails"),i=p("approve_emails"),v=p("create_users"),b=p("manage_roles"),M=p("manage_task_types"),A=p("create_clients"),z=async()=>{const s=localStorage.getItem("authToken");if(s){window.axios.defaults.headers.common.Authorization=`Bearer ${s}`;try{await window.axios.get("/api/user")}catch(e){e.response&&e.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},U=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization},V=s=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},w=C(null);return F(()=>{z(),w.value&&it(w.value)}),(s,e)=>{var l;return r(),k("div",null,[f(De,{ref_key:"notificationContainerRef",ref:w},null,512),f(rt),t("div",lt,[t("nav",nt,[t("div",dt,[t("div",ut,[t("div",ct,[t("div",vt,[f(S(Y),{href:s.route("dashboard")},{default:n(()=>[f(le,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),t("div",mt,[f(R,{href:s.route("dashboard"),active:s.route().current("dashboard")},{default:n(()=>e[1]||(e[1]=[m(" Dashboard ")])),_:1,__:[1]},8,["href","active"]),S(_)?(r(),$(R,{key:0,href:s.route("projects.index"),active:s.route().current("projects.index")},{default:n(()=>e[2]||(e[2]=[m(" Projects ")])),_:1,__:[2]},8,["href","active"])):x("",!0),S(o)?(r(),$(R,{key:1,href:s.route("emails.compose"),active:s.route().current("emails.compose")},{default:n(()=>e[3]||(e[3]=[m(" Compose Email ")])),_:1,__:[3]},8,["href","active"])):x("",!0),S(i)?(r(),$(R,{key:2,href:s.route("emails.pending"),active:s.route().current("emails.pending")},{default:n(()=>e[4]||(e[4]=[m(" Approve Emails ")])),_:1,__:[4]},8,["href","active"])):x("",!0),S(o)?(r(),$(R,{key:3,href:s.route("emails.rejected"),active:s.route().current("emails.rejected")},{default:n(()=>e[5]||(e[5]=[m(" Rejected Emails ")])),_:1,__:[5]},8,["href","active"])):x("",!0),f(R,{href:s.route("availability.index"),active:s.route().current("availability.index")},{default:n(()=>e[6]||(e[6]=[m(" Weekly Availability ")])),_:1,__:[6]},8,["href","active"]),S(b)?(r(),k("div",ft,[f(ee,{align:"right",width:"48"},{trigger:n(()=>e[7]||(e[7]=[t("span",{class:"inline-flex rounded-md"},[t("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},[m(" Admin "),t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:n(()=>[S(A)?(r(),$(W,{key:0,href:s.route("clients.index"),active:s.route().current("clients.index")},{default:n(()=>e[8]||(e[8]=[m(" Clients ")])),_:1,__:[8]},8,["href","active"])):x("",!0),S(v)?(r(),$(W,{key:1,href:s.route("users.index"),active:s.route().current("users.index")},{default:n(()=>e[9]||(e[9]=[m(" Users ")])),_:1,__:[9]},8,["href","active"])):x("",!0),S(M)?(r(),$(W,{key:2,href:s.route("task-types.index"),active:s.route().current("task-types.index")},{default:n(()=>e[10]||(e[10]=[m(" Task Types ")])),_:1,__:[10]},8,["href","active"])):x("",!0),f(W,{href:s.route("admin.roles.index")},{default:n(()=>e[11]||(e[11]=[m(" Manage Roles ")])),_:1,__:[11]},8,["href"]),f(W,{href:s.route("admin.permissions.index")},{default:n(()=>e[12]||(e[12]=[m(" Manage Permissions ")])),_:1,__:[12]},8,["href"])]),_:1})])):x("",!0)])]),t("div",gt,[t("div",ht,[f(ee,{align:"right",width:"48"},{trigger:n(()=>{var a;return[t("span",pt,[t("button",yt,[m(I(c.value.name)+" ("+I((a=c.value.role_data)==null?void 0:a.name)+") ",1),e[13]||(e[13]=t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:n(()=>[f(W,{href:s.route("profile.edit")},{default:n(()=>e[14]||(e[14]=[m(" Profile ")])),_:1,__:[14]},8,["href"]),f(W,{href:s.route("logout"),method:"post",as:"button",onSuccess:U,onError:V},{default:n(()=>e[15]||(e[15]=[m(" Log Out ")])),_:1,__:[15]},8,["href"])]),_:1})])]),t("div",bt,[t("button",{onClick:e[0]||(e[0]=a=>d.value=!d.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(r(),k("svg",_t,[t("path",{class:L({hidden:d.value,"inline-flex":!d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),t("path",{class:L({hidden:!d.value,"inline-flex":d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])]),t("div",{class:L([{block:d.value,hidden:!d.value},"sm:hidden"])},[t("div",wt,[f(E,{href:s.route("dashboard"),active:s.route().current("dashboard")},{default:n(()=>e[16]||(e[16]=[m(" Dashboard ")])),_:1,__:[16]},8,["href","active"]),S(A)?(r(),$(E,{key:0,href:s.route("clients.index"),active:s.route().current("clients.index")},{default:n(()=>e[17]||(e[17]=[m(" Clients ")])),_:1,__:[17]},8,["href","active"])):x("",!0),S(_)?(r(),$(E,{key:1,href:s.route("projects.index"),active:s.route().current("projects.index")},{default:n(()=>e[18]||(e[18]=[m(" Projects ")])),_:1,__:[18]},8,["href","active"])):x("",!0),S(v)?(r(),$(E,{key:2,href:s.route("users.index"),active:s.route().current("users.index")},{default:n(()=>e[19]||(e[19]=[m(" Users ")])),_:1,__:[19]},8,["href","active"])):x("",!0),S(o)?(r(),$(E,{key:3,href:s.route("emails.compose"),active:s.route().current("emails.compose")},{default:n(()=>e[20]||(e[20]=[m(" Compose Email ")])),_:1,__:[20]},8,["href","active"])):x("",!0),S(i)?(r(),$(E,{key:4,href:s.route("emails.pending"),active:s.route().current("emails.pending")},{default:n(()=>e[21]||(e[21]=[m(" Approve Emails ")])),_:1,__:[21]},8,["href","active"])):x("",!0),S(o)?(r(),$(E,{key:5,href:s.route("emails.rejected"),active:s.route().current("emails.rejected")},{default:n(()=>e[22]||(e[22]=[m(" Rejected Emails ")])),_:1,__:[22]},8,["href","active"])):x("",!0),f(E,{href:s.route("availability.index"),active:s.route().current("availability.index")},{default:n(()=>e[23]||(e[23]=[m(" Weekly Availability ")])),_:1,__:[23]},8,["href","active"]),S(b)?(r(),k("div",xt,[e[26]||(e[26]=t("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),f(E,{href:s.route("admin.roles.index"),active:s.route().current("admin.roles.index")},{default:n(()=>e[24]||(e[24]=[m(" Manage Roles ")])),_:1,__:[24]},8,["href","active"]),f(E,{href:s.route("admin.permissions.index"),active:s.route().current("admin.permissions.index")},{default:n(()=>e[25]||(e[25]=[m(" Manage Permissions ")])),_:1,__:[25]},8,["href","active"])])):x("",!0)]),t("div",kt,[t("div",St,[t("div",$t,I(c.value.name),1),t("div",At,I(c.value.email),1),t("div",Ct,I((l=c.value.role_data)==null?void 0:l.name),1)]),t("div",Dt,[f(E,{href:s.route("profile.edit")},{default:n(()=>e[27]||(e[27]=[m(" Profile ")])),_:1,__:[27]},8,["href"]),f(E,{href:s.route("logout"),method:"post",as:"button",onSuccess:U,onError:V},{default:n(()=>e[28]||(e[28]=[m(" Log Out ")])),_:1,__:[28]},8,["href"])])])],2)]),s.$slots.header?(r(),k("header",Et,[t("div",Mt,[P(s.$slots,"header")])])):x("",!0),t("main",null,[P(s.$slots,"default")])])])}}};export{Wt as _,tt as a,Vt as e,Ut as s};
