import{r as D,s as B,K as Se,B as ye,J as Ie,i as r,g as k,o as s,F as J,j as K,b as t,t as j,h as E,L as Je,M as vt,N as Ye,O as Ke,c as M,p as V,T as Ze,w as Q,a as x,d as De,f as Z,l as pt,m as I,e as v,k as de,x as H,P as Ae,G as ft,I as ge,A as re,Q as se,R as G,S as je,z as Ee,D as gt,U as Ge,V as Re,W as ce,n as ie,X as Qe,Y as Ve,Z as Ue,_ as me,$ as te,a0 as ue,a1 as Ne,a2 as yt,a3 as ht,a4 as Fe,q as kt}from"./app-CYi4MQ32.js";import{P as X}from"./PrimaryButton-CgsxCtKM.js";import{_ as Be}from"./Modal-xDKUeRyr.js";import{_ as L}from"./InputLabel-B71CHPf3.js";import{_ as q}from"./InputError-BoshvKPh.js";import{_ as Te}from"./SecondaryButton-CO3Vqidy.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as le}from"./TextInput-DKat-_6Z.js";import{S as oe}from"./SelectDropdown-DL6JkH7K.js";import{_ as bt}from"./Checkbox-YpyryvHi.js";import{A as wt}from"./ApplicationLogo-nd0z4y_V.js";import{D as Le}from"./DangerButton-BjRlZdzN.js";import{h as xt}from"./moment-BLMuvzoS.js";const _t={key:0,class:"fixed bottom-4 right-4 z-50 flex flex-col items-end space-y-2"},$t={key:0,class:"notification-list w-full max-w-xs space-y-2"},Ct={class:"flex-1 min-w-0"},St={class:"flex items-start justify-between gap-2 mb-1"},Tt={class:"flex-1 min-w-0"},It={key:0,class:"text-base font-semibold text-gray-800 truncate"},At={key:1,class:"text-xs text-gray-500"},jt={key:0,class:"text-xs text-gray-600 mb-2"},Dt={class:"flex items-center justify-between mt-2"},Et={key:0,class:"text-xs text-gray-500 font-medium"},Mt=["onClick"],Pt={key:1,class:"flex justify-end w-full max-w-xs"},Nt={key:0},Vt={key:1},fe="notification_minimized_state",Ut=3,Bt={__name:"PushNotificationContainer",props:{sidebarIsOpen:{type:Boolean,default:!1}},setup(a){const o=D(!1),n=D(null),d=D(0),e=D(null),g=B(()=>Se.value.notifications.filter(c=>c.isNewPush).slice(0,Ut)),u=B(()=>{const c=Math.floor(d.value/60),C=d.value%60;return`${String(c).padStart(2,"0")}:${String(C).padStart(2,"0")}`}),f=c=>{if(!c)return null;const C=c.match(/\/task\/(\d+)/);return C?parseInt(C[1]):null},p=c=>{if(!c)return null;const C=c.match(/\/project\/(\d+)\//);return C?parseInt(C[1]):null},i=()=>{if(o.value=!o.value,clearTimeout(n.value),clearInterval(e.value),o.value){const c=Date.now()+3e5;localStorage.setItem(fe,JSON.stringify({isMinimized:!0,expiryTime:c})),n.value=setTimeout(()=>{o.value=!1,clearInterval(e.value),localStorage.removeItem(fe)},3e5),d.value=300,e.value=setInterval(()=>{d.value>0?d.value--:clearInterval(e.value)},1e3)}else localStorage.removeItem(fe)},w=async c=>{vt(c.id),await Ye(c.view_id);const C=c.task_id||f(c.url),T=c.project_id||p(c.url);C&&T?Ke(C,T):(console.warn("Could not open task sidebar. Falling back to redirecting."),c.url&&(window.location.href=c.url))};return ye(()=>{const c=localStorage.getItem(fe);if(c)try{const{isMinimized:C,expiryTime:T}=JSON.parse(c),S=Date.now(),y=T-S;y>0?(o.value=C,d.value=Math.floor(y/1e3),n.value=setTimeout(()=>{o.value=!1,clearInterval(e.value),localStorage.removeItem(fe)},y),e.value=setInterval(()=>{d.value>0?d.value--:clearInterval(e.value)},1e3)):localStorage.removeItem(fe)}catch(C){console.error("Error restoring notification minimized state:",C),localStorage.removeItem(fe)}}),Ie(()=>{clearTimeout(n.value),clearInterval(e.value)}),(c,C)=>a.sidebarIsOpen?k("",!0):(s(),r("div",_t,[!o.value&&g.value.length>0?(s(),r("div",$t,[(s(!0),r(J,null,K(g.value,T=>(s(),r("div",{key:T.id,class:"bg-white rounded-lg shadow-lg p-3 flex items-start space-x-3 border border-gray-200 transition-opacity duration-300 opacity-60 hover:opacity-100"},[t("div",Ct,[t("div",St,[t("div",Tt,[T.title?(s(),r("h3",It,j(T.title),1)):k("",!0),T.project_name?(s(),r("p",At,j(T.project_name),1)):k("",!0)])]),T.message?(s(),r("p",jt,j(T.message),1)):k("",!0),t("div",Dt,[T.due_date?(s(),r("div",Et," Due: "+j(E(Je)(T.due_date)),1)):k("",!0),t("button",{onClick:S=>w(T),class:"px-2.5 py-1 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 transition-colors duration-200 shadow"},j(T.button_label||"View"),9,Mt)])])]))),128))])):k("",!0),g.value.length>0?(s(),r("div",Pt,[t("button",{onClick:i,class:"bg-white/80 backdrop-blur-sm text-gray-600 hover:text-gray-900 text-xs font-bold py-1 px-3 rounded-full shadow-md transition-all duration-300"},[o.value?(s(),r("span",Nt,"Show ("+j(u.value)+")",1)):(s(),r("span",Vt,"Minimize"))])])):k("",!0)]))}},Lt={class:"fixed top-4 right-4 z-[9999] flex flex-col items-end space-y-3"},zt={class:"p-4"},Rt={class:"text-sm font-medium text-white"},Ft={key:0,class:"mt-3 flex gap-2"},Wt=["onClick"],qt=["onClick"],Ot={key:1,class:"fixed top-4 right-4 z-[9999] flex flex-col items-end space-y-3"},Ht={class:"p-4"},Jt={class:"text-sm font-medium text-white"},Yt={key:0,class:"mt-3 flex gap-2"},Kt=["onClick"],Zt=["onClick"],Gt={__name:"StandardNotificationContainer",setup(a,{expose:o}){const n=D([]),d=D("");let e=null;const g=()=>{const c=document.getElementById("modal-notification-portal");d.value=c?"#modal-notification-portal":""};ye(()=>{g(),e=new MutationObserver(g),e.observe(document.body,{childList:!0,subtree:!0})}),Ie(()=>{e&&e.disconnect()});const u=(c,C="info",T=5e3)=>{let S;typeof c=="object"&&c!==null?S={...c}:S={message:c,type:C,duration:T};const y=S.id||crypto.randomUUID(),$={id:y,message:S.message||"",type:S.type||"info",duration:typeof S.duration=="number"?S.duration:5e3,sticky:!!S.sticky,confirm:S.confirm||null};return n.value.unshift($),!$.sticky&&!$.confirm&&setTimeout(()=>{f(y)},$.duration),y},f=c=>{const C=n.value.findIndex(T=>T.id===c);C>-1&&n.value.splice(C,1)},p=c=>{const C=n.value.find(T=>T.id===c);if(C&&C.confirm&&typeof C.confirm.onConfirm=="function")try{C.confirm.onConfirm()}catch{}f(c)},i=c=>{const C=n.value.find(T=>T.id===c);if(C&&C.confirm&&typeof C.confirm.onCancel=="function")try{C.confirm.onCancel()}catch{}f(c)},w=c=>{switch(c){case"success":return"bg-green-500";case"error":return"bg-red-500";case"warning":return"bg-yellow-500";case"info":default:return"bg-blue-500"}};return o({addNotification:u}),(c,C)=>d.value?(s(),M(Ze,{key:0,to:d.value},[t("div",Lt,[(s(!0),r(J,null,K(n.value,T=>(s(),r("div",{key:T.id,class:V(["w-full max-w-sm rounded-md shadow-lg pointer-events-auto overflow-hidden",w(T.type)])},[t("div",zt,[t("p",Rt,j(T.message),1),T.confirm?(s(),r("div",Ft,[t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-white/90 text-slate-800 hover:bg-white",onClick:S=>p(T.id)},j(T.confirm.confirmText||"Confirm"),9,Wt),t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-transparent border border-white/70 text-white hover:bg-white/10",onClick:S=>i(T.id)},j(T.confirm.cancelText||"Cancel"),9,qt)])):k("",!0)])],2))),128))])],8,["to"])):(s(),r("div",Ot,[(s(!0),r(J,null,K(n.value,T=>(s(),r("div",{key:T.id,class:V(["w-full max-w-sm rounded-md shadow-lg pointer-events-auto overflow-hidden",w(T.type)])},[t("div",Ht,[t("p",Jt,j(T.message),1),T.confirm?(s(),r("div",Yt,[t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-white/90 text-slate-800 hover:bg-white",onClick:S=>p(T.id)},j(T.confirm.confirmText||"Confirm"),9,Kt),t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-transparent border border-white/70 text-white hover:bg-white/10",onClick:S=>i(T.id)},j(T.confirm.cancelText||"Cancel"),9,Zt)])):k("",!0)])],2))),128))]))}},Qt={class:"p-6"},Xt={class:"mt-6"},es={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},ts={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},ss={class:"flex items-center mb-3"},as=["id","onUpdate:modelValue"],os=["for"],ls={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},rs={key:0},ns={class:"mb-4"},is={class:"flex items-center"},ds=["id","checked","onChange"],us=["for"],cs={key:0,class:"mb-4"},ms=["id","onUpdate:modelValue"],vs={key:1,class:"mb-4"},ps={class:"flex-1"},fs=["id","onUpdate:modelValue"],gs={class:"flex-1"},ys=["id","onUpdate:modelValue"],hs={key:0,class:"flex items-end pb-1"},ks=["onClick"],bs=["onClick"],ws={class:"mt-6 flex justify-end space-x-3"},xs={key:0,class:"flex items-center"},_s={key:1},$s={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(a,{emit:o}){const n=()=>{const $=localStorage.getItem("authToken");$&&!H.defaults.headers.common.Authorization&&(H.defaults.headers.common.Authorization=`Bearer ${$}`,console.log("Auth headers set in AvailabilityModal"))},d=a,e=o,g=D({}),u=D({}),f=D(!1),p=D(""),i=()=>{const $=[],h=new Date,l=new Date(h);l.setDate(h.getDate()+1);for(let m=0;m<7;m++){const b=new Date(l);b.setDate(l.getDate()+m);const A=b.toISOString().split("T")[0];$.push({value:A,label:b.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),g.value[A]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return $},w=D([]);ye(()=>{n(),d.nextWeekDates.length>0?(w.value=d.nextWeekDates,d.nextWeekDates.forEach($=>{g.value[$.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):w.value=i()});const c=async()=>{try{if(n(),w.value.length===0)return;const $=w.value[0].value,h=w.value[w.value.length-1].value,l=await H.get("/api/availabilities",{params:{start_date:$,end_date:h,user_id:d.userId}});if(l.data&&l.data.availabilities){const m=l.data.availabilities;w.value.forEach(b=>{g.value[b.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),m.forEach(b=>{const A=b.date.split("T")[0];g.value[A]&&(g.value[A].isSelected=!0,g.value[A].isAvailable=b.is_available,b.is_available?g.value[A].timeSlots=b.time_slots&&b.time_slots.length>0?[...b.time_slots]:[{start_time:"",end_time:""}]:g.value[A].reason=b.reason||"")})}}catch($){console.error("Error fetching existing availabilities:",$),w.value.forEach(h=>{g.value[h.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};Q(()=>d.show,async $=>{$&&(u.value={},p.value="",await c())},{immediate:!0});const C=$=>{g.value[$].timeSlots.push({start_time:"",end_time:""})},T=($,h)=>{g.value[$].timeSlots.length>1&&g.value[$].timeSlots.splice(h,1)},S=($,h)=>{g.value[$].isAvailable=h,h?g.value[$].reason="":g.value[$].timeSlots=[{start_time:"",end_time:""}]},y=async()=>{f.value=!0,u.value={},p.value="";const $=[];let h=!1;for(const l of w.value){const m=l.value,b=g.value[m];if(b.isSelected){let A={};if(b.isAvailable)if(b.timeSlots.some(N=>!N.start_time||!N.end_time))A.timeSlots="Please fill in all time slots.",h=!0;else for(const N of b.timeSlots){const O=N.start_time.split(":").map(Number),ne=N.end_time.split(":").map(Number);if(O.length!==2||ne.length!==2||isNaN(O[0])||isNaN(O[1])||isNaN(ne[0])||isNaN(ne[1])){A.timeSlots="Invalid time format. Please use HH:MM format.",h=!0;break}const W=O[0]*60+O[1],U=ne[0]*60+ne[1];if(W>=U){A.timeSlots="End time must be after start time.",h=!0;break}}else b.reason.trim()||(A.reason="Please provide a reason for unavailability.",h=!0);Object.keys(A).length>0&&(u.value[m]=A),Object.keys(A).length===0&&$.push({date:m,is_available:b.isAvailable,reason:b.isAvailable?null:b.reason,time_slots:b.isAvailable?b.timeSlots:null})}}if(h){f.value=!1,u.value.general="Please correct the errors in the highlighted dates.";return}if($.length===0){u.value.general="Please select at least one day to set availability for.",f.value=!1;return}try{n();const l=await H.post("/api/availabilities/batch",{availabilities:$});p.value="Availability saved successfully!";try{const m=await H.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",m.data.should_block_user),localStorage.setItem("allWeekdaysCovered",m.data.all_weekdays_covered);const b=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:m.data.should_block_user,allWeekdaysCovered:m.data.all_weekdays_covered}});window.dispatchEvent(b),console.log("Availability status updated from modal:",{shouldBlockUser:m.data.should_block_user,allWeekdaysCovered:m.data.all_weekdays_covered})}catch(m){console.error("Error updating availability status:",m)}e("availability-saved",l.data.availabilities),setTimeout(()=>{e("close")},1500)}catch(l){console.error("Error saving availability:",l),l.response&&l.response.data&&l.response.data.errors?u.value.general=l.response.data.message||"An error occurred while saving your availability.":l.response&&l.response.status===409?(p.value=l.response.data.message,setTimeout(()=>{e("close")},1500)):u.value.general="An unexpected error occurred while saving your availability."}finally{f.value=!1}};return($,h)=>(s(),M(Be,{show:a.show,onClose:h[1]||(h[1]=l=>$.$emit("close")),"max-width":"xl"},{default:x(()=>[t("div",Qt,[h[6]||(h[6]=t("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),h[7]||(h[7]=t("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),t("div",Xt,[t("form",{onSubmit:De(y,["prevent"])},[p.value?(s(),r("div",es,j(p.value),1)):k("",!0),u.value.general?(s(),r("div",ts,j(u.value.general),1)):k("",!0),(s(!0),r(J,null,K(w.value,l=>{var m,b;return s(),r("div",{key:l.value,class:V(["mb-6 p-4 border rounded-lg shadow-sm",[g.value[l.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",g.value[l.value].isSelected&&!u.value[l.value]?"border-l-4 border-l-indigo-500":""]])},[t("div",ss,[Z(t("input",{type:"checkbox",id:`select_date_${l.value}`,"onUpdate:modelValue":A=>g.value[l.value].isSelected=A,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,as),[[pt,g.value[l.value].isSelected]]),t("label",{for:`select_date_${l.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[I(j(l.label)+" ",1),g.value[l.value].isSelected?(s(),r("span",ls," Saved ")):k("",!0)],8,os)]),g.value[l.value].isSelected?(s(),r("div",rs,[t("div",ns,[t("div",is,[t("input",{type:"checkbox",id:`isAvailableToggle_${l.value}`,checked:g.value[l.value].isAvailable,onChange:A=>S(l.value,A.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,ds),t("label",{for:`isAvailableToggle_${l.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,us)])]),g.value[l.value].isAvailable?k("",!0):(s(),r("div",cs,[v(L,{for:`reason_${l.value}`,value:"Reason for Not Available"},null,8,["for"]),Z(t("textarea",{id:`reason_${l.value}`,"onUpdate:modelValue":A=>g.value[l.value].reason=A,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,ms),[[de,g.value[l.value].reason]]),v(q,{message:(m=u.value[l.value])==null?void 0:m.reason,class:"mt-2"},null,8,["message"])])),g.value[l.value].isAvailable?(s(),r("div",vs,[v(L,{value:"Available Time Slots"}),v(q,{message:(b=u.value[l.value])==null?void 0:b.timeSlots,class:"mt-2"},null,8,["message"]),(s(!0),r(J,null,K(g.value[l.value].timeSlots,(A,N)=>(s(),r("div",{key:N,class:"flex items-center space-x-2 mt-2"},[t("div",ps,[v(L,{for:`start_time_${l.value}_${N}`,value:"Start Time",class:"text-xs"},null,8,["for"]),Z(t("input",{id:`start_time_${l.value}_${N}`,type:"time","onUpdate:modelValue":O=>A.start_time=O,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,fs),[[de,A.start_time]])]),t("div",gs,[v(L,{for:`end_time_${l.value}_${N}`,value:"End Time",class:"text-xs"},null,8,["for"]),Z(t("input",{id:`end_time_${l.value}_${N}`,type:"time","onUpdate:modelValue":O=>A.end_time=O,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,ys),[[de,A.end_time]])]),g.value[l.value].timeSlots.length>1?(s(),r("div",hs,[t("button",{type:"button",onClick:O=>T(l.value,N),class:"p-2 text-red-600 hover:text-red-800"},h[2]||(h[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,ks)])):k("",!0)]))),128)),t("button",{type:"button",onClick:A=>C(l.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},h[3]||(h[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),I(" Add Another Time Slot ",-1)]),8,bs)])):k("",!0)])):k("",!0)],2)}),128)),t("div",ws,[v(Te,{onClick:h[0]||(h[0]=l=>$.$emit("close"))},{default:x(()=>h[4]||(h[4]=[I(" Cancel ",-1)])),_:1,__:[4]}),v(X,{disabled:f.value,class:V({"opacity-50":f.value})},{default:x(()=>[f.value?(s(),r("span",xs,h[5]||(h[5]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),I(" Saving... ",-1)]))):(s(),r("span",_s,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},Cs={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},Ss={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},Ts={class:"flex justify-center"},Is={__name:"AvailabilityBlocker",setup(a){const o=D(!1),n=D(!0),d=D(!1),e=D([]),g=B(()=>{var y;return((y=Ae().props.auth.user)==null?void 0:y.id)||null}),u=()=>{const y=localStorage.getItem("authToken");y&&!H.defaults.headers.common.Authorization&&(H.defaults.headers.common.Authorization=`Bearer ${y}`)},f=async()=>{n.value=!0;const y=localStorage.getItem("shouldBlockUser"),$=localStorage.getItem("allWeekdaysCovered");if(y==="true"&&$==="false")o.value=!0,await p();else try{u();const h=await H.get("/api/availability-prompt");o.value=h.data.should_block_user&&!h.data.all_weekdays_covered,o.value&&await p()}catch(h){console.error("Error checking if user should be blocked:",h),o.value=!1}n.value=!1},p=async()=>{try{u();const y=await H.get("/api/availability-prompt");i(y.data.next_week_start,y.data.next_week_end)}catch(y){console.error("Error fetching next week dates:",y)}},i=(y,$)=>{const h=[],l=new Date(y),m=new Date($),b=new Date(l);for(;b<=m;)h.push({value:b.toISOString().split("T")[0],label:b.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),b.setDate(b.getDate()+1);e.value=h},w=()=>{d.value=!0},c=()=>{f()},C=y=>{o.value=y.detail.shouldBlockUser&&!y.detail.allWeekdaysCovered},T=()=>{document.visibilityState==="visible"&&ge(()=>{f()})},S=y=>{(y.key==="shouldBlockUser"||y.key==="allWeekdaysCovered")&&ge(()=>{f()})};return ye(()=>{f(),window.addEventListener("availability-status-updated",C),document.addEventListener("visibilitychange",T),window.addEventListener("storage",S)}),Ie(()=>{window.removeEventListener("availability-status-updated",C),document.removeEventListener("visibilitychange",T),window.removeEventListener("storage",S)}),(y,$)=>o.value&&!n.value?(s(),r("div",Cs,[t("div",Ss,[$[2]||($[2]=ft('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),t("div",Ts,[v(X,{onClick:w,class:"bg-red-600 hover:bg-red-700"},{default:x(()=>$[1]||($[1]=[I(" Submit Availability Now ",-1)])),_:1,__:[1]})]),v($s,{show:d.value,"next-week-dates":e.value,date:e.value.length>0?e.value[0].value:"",userId:g.value,onClose:$[0]||($[0]=h=>d.value=!1),onAvailabilitySaved:c},null,8,["show","next-week-dates","date","userId"])])])):k("",!0)}},As={class:"p-6"},js={class:"flex justify-between items-center mb-4"},Ds={class:"text-lg font-medium text-gray-900"},Es={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Ms={class:"block sm:inline"},Ps={key:0,class:"mt-6 flex justify-end space-x-3"},Ns={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:a=>["post","put","patch","delete"].includes(a.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:a=>a},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(a,{emit:o}){const n=a,d=o,e=D(!1),g=D({}),u=D("");Q(()=>n.show,i=>{i&&(g.value={},u.value="",e.value=!1)});const f=async()=>{e.value=!0,g.value={},u.value="";try{const i=n.formatDataForApi(n.formData);let w;const c=n.httpMethod.toLowerCase();if(c==="post")w=await window.axios.post(n.apiEndpoint,i);else if(c==="put")w=await window.axios.put(n.apiEndpoint,i);else if(c==="patch")w=await window.axios.patch(n.apiEndpoint,i);else if(c==="delete")w=await window.axios.delete(n.apiEndpoint,{data:i});else throw new Error(`Unsupported HTTP method: ${n.httpMethod}`);se(n.successMessage),d("submitted",w.data),d("close")}catch(i){console.error("API submission error:",i),i.response?i.response.status===422?(g.value=i.response.data.errors,u.value="Please correct the errors in the form."):u.value=i.response.data.message||"An unexpected error occurred.":u.value="A network error occurred or the server is unreachable.",G(u.value),d("error",i)}finally{e.value=!1}},p=()=>{d("close")};return(i,w)=>(s(),M(Be,{show:a.show,onClose:p},{default:x(()=>[t("div",As,[t("div",js,[t("h2",Ds,j(a.title),1),t("button",{onClick:p,class:"text-gray-400 hover:text-gray-500"},w[0]||(w[0]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u.value?(s(),r("div",Es,[t("span",Ms,j(u.value),1)])):k("",!0),t("form",{onSubmit:De(f,["prevent"])},[re(i.$slots,"default",{errors:g.value},void 0,!0),a.showFooter?(s(),r("div",Ps,[v(Te,{onClick:p,type:"button",disabled:e.value},{default:x(()=>w[1]||(w[1]=[I(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),v(X,{type:"submit",disabled:e.value,class:V({"opacity-75 cursor-not-allowed":e.value})},{default:x(()=>[I(j(e.value?"Submitting...":a.submitButtonText),1)]),_:1},8,["disabled","class"])])):k("",!0)],32)])]),_:3},8,["show"]))}},Me=ke(Ns,[["__scopeId","data-v-380ca613"]]),Vs=(a,o)=>{let n;return(...d)=>{clearTimeout(n),n=setTimeout(()=>a(...d),o)}},Us={class:"relative"},Bs={class:"flex flex-wrap items-center gap-2 mb-2 p-2 border border-gray-300 rounded-lg bg-white min-h-[44px] focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 transition-all duration-150"},Ls=["onClick"],zs={key:0,class:"absolute z-20 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto mt-1 transform-gpu"},Rs=["onClick"],Fs={key:1,class:"px-4 py-2 text-sm text-gray-500"},Ws={key:2,class:"px-4 py-2 text-sm text-gray-500"},qs={__name:"TagInput",props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:"Tags"},placeholder:{type:String,default:"Add tags..."},error:{type:String,default:""},initialTags:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(a,{emit:o}){const n=a,d=o,e=D(""),g=D([]),u=D([]),f=D(!1),p=D(null);function i(){d("update:modelValue",u.value.map(h=>h.id))}Q(()=>n.initialTags,h=>{if(u.value=[],h&&h.length>0){const A=[],N=new Set;h.forEach(O=>{N.has(O.id)||(A.push(O),N.add(O.id))}),u.value.push(...A)}const l=h.map(A=>A.id),m=Array.isArray(n.modelValue)?n.modelValue:[];(l.length!==m.length||l.some(A=>!m.includes(A))||m.some(A=>!l.includes(A)))&&i()},{immediate:!0});const w=Vs(async h=>{if(h.length<2){g.value=[],f.value=!1;return}try{const l=await H.get(`/api/tags/search?query=${h}`);g.value=l.data,f.value=!0}catch(l){console.error("Error fetching tags:",l),g.value=[],f.value=!1}},300);Q(e,h=>{n.disabled||w(h)});const c=h=>{u.value.some(l=>l.id===h.id)||(u.value.push(h),e.value="",g.value=[],f.value=!1,i()),ge(()=>p.value.focus())},C=()=>{if(n.disabled)return;const h=e.value.trim();if(!h)return;const l=g.value.find(b=>b.name.toLowerCase()===h.toLowerCase()),m=u.value.some(b=>b.name.toLowerCase()===h.toLowerCase());if(l)c(l);else if(m)e.value="",g.value=[],f.value=!1;else{const b={id:`new_${h.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:h};u.value.push(b),e.value="",g.value=[],f.value=!1,i()}ge(()=>p.value.focus())},T=h=>{n.disabled||(u.value=u.value.filter(l=>l.id!==h.id),i(),ge(()=>p.value.focus()))},S=()=>{n.disabled||e.value===""&&u.value.length>0&&T(u.value[u.value.length-1])},y=B(()=>g.value.filter(h=>!u.value.some(l=>l.id===h.id))),$=h=>{p.value&&!p.value.$el.contains(h.target)&&(f.value=!1,e.value="")};return ye(()=>{document.addEventListener("click",$)}),Ie(()=>{document.removeEventListener("click",$)}),(h,l)=>(s(),r("div",Us,[v(L,{value:a.label,class:"mb-1"},null,8,["value"]),t("div",Bs,[(s(!0),r(J,null,K(u.value,m=>(s(),r("span",{key:m.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},[I(j(m.name)+" ",1),a.disabled?k("",!0):(s(),r("button",{key:0,type:"button",onClick:b=>T(m),class:"ml-2 -mr-1 text-indigo-500 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-full p-0.5"},l[3]||(l[3]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ls))]))),128)),v(le,{ref_key:"inputRef",ref:p,type:"text",placeholder:u.value.length===0?a.placeholder:"",modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=m=>e.value=m),onFocus:l[1]||(l[1]=m=>f.value=!0),onKeydown:[je(De(C,["prevent"]),["enter"]),l[2]||(l[2]=je(m=>f.value=!1,["tab"])),je(S,["delete"])],class:"flex-grow min-w-[100px] border-none focus:ring-0 shadow-none p-0 bg-transparent text-gray-900",disabled:a.disabled},null,8,["placeholder","modelValue","onKeydown","disabled"])]),f.value&&(y.value.length>0||e.value.length>=2||y.value.length===0&&e.value.length<2)&&!a.disabled?(s(),r("div",zs,[(s(!0),r(J,null,K(y.value,m=>(s(),r("div",{key:m.id,onClick:b=>c(m),class:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer transition-colors duration-100"},j(m.name),9,Rs))),128)),!g.value.some(m=>m.name.toLowerCase()===e.value.toLowerCase())&&e.value.length>=2?(s(),r("div",{key:0,onClick:C,class:"px-4 py-2 text-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 cursor-pointer border-t border-indigo-200 font-semibold transition-colors duration-100"},' Add new tag: "'+j(e.value)+'" ',1)):k("",!0),y.value.length===0&&e.value.length<2?(s(),r("div",Fs," Type at least 2 characters to search for tags. ")):k("",!0),y.value.length===0&&e.value.length>=2&&!g.value.some(m=>m.name.toLowerCase()===e.value.toLowerCase())?(s(),r("div",Ws,[l[4]||(l[4]=I(" No matching tags found. Press ",-1)),l[5]||(l[5]=t("span",{class:"font-semibold text-indigo-600"},"Enter",-1)),I(' to add "'+j(e.value)+'" as a new tag. ',1)])):k("",!0)])):k("",!0),v(q,{message:a.error,class:"mt-2"},null,8,["message"])]))}},Xe=ke(qs,[["__scopeId","data-v-4d528a4c"]]),Os={class:"space-y-4"},Hs="Add New Milestone",Js="/api/milestones",Ys="post",Ks="Create Milestone",Zs="Milestone created successfully!",Gs={__name:"MilestoneFormModal",props:{show:Boolean,projectId:Number},emits:["close","saved"],setup(a,{emit:o}){const n=a,d=o,e=Ee({name:"",description:"",completion_date:null,status:"Not Started",project_id:n.projectId}),g=["Not Started","In Progress","Completed","Overdue"];Q(()=>n.show,p=>{p&&Object.assign(e,{name:"",description:"",completion_date:null,status:"Not Started",project_id:n.projectId})},{immediate:!0});const u=p=>{d("saved",p),d("close")},f=()=>{d("close")};return(p,i)=>(s(),M(Me,{show:a.show,title:Hs,"api-endpoint":Js,"http-method":Ys,"form-data":e,"submit-button-text":Ks,"success-message":Zs,onClose:f,onSubmitted:u},{default:x(({errors:w})=>[t("div",Os,[t("div",null,[v(L,{for:"milestone-name",value:"Milestone Name"}),v(le,{id:"milestone-name",modelValue:e.name,"onUpdate:modelValue":i[0]||(i[0]=c=>e.name=c),type:"text",class:"mt-1 block w-full",placeholder:"Enter milestone name",required:""},null,8,["modelValue"]),v(q,{message:w.name?w.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"milestone-description",value:"Description"}),Z(t("textarea",{id:"milestone-description","onUpdate:modelValue":i[1]||(i[1]=c=>e.description=c),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter milestone description"},null,512),[[de,e.description]]),v(q,{message:w.description?w.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"milestone-completion-date",value:"Completion Date"}),v(le,{id:"milestone-completion-date",modelValue:e.completion_date,"onUpdate:modelValue":i[2]||(i[2]=c=>e.completion_date=c),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),v(q,{message:w.completion_date?w.completion_date[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"milestone-status",value:"Status"}),v(oe,{id:"milestone-status",modelValue:e.status,"onUpdate:modelValue":i[3]||(i[3]=c=>e.status=c),options:g.map(c=>({value:c,label:c})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),v(q,{message:w.status?w.status[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]))}},Qs={class:"space-y-4"},Xs={key:0},ea={key:0,class:"text-sm text-gray-500"},ta={key:0,class:"text-sm text-gray-500"},sa={key:0,class:"text-sm text-gray-500"},aa={class:"flex items-center gap-2 mt-1"},oa={key:0,class:"text-sm text-gray-500"},la=["disabled"],ra="Create New Task",na="/api/tasks",ia="post",da="Create Task",ua="Task created successfully!",ca={__name:"CreateTaskModal",props:{show:Boolean,projectId:{type:Number,default:null}},emits:["close","saved"],setup(a,{emit:o}){const n=a,d=o,e=Ee({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:n.projectId,priority:"medium",tags:[],tags_data:[]}),g=["To Do","In Progress","Done","Blocked","Archived"],u=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],f=D([]),p=D([]),i=D([]),w=D([]),c=D(!0),C=D(!1),T=D(!1),S=D(!1),y=D(!1);Q(()=>n.show,async W=>{W&&(Object.assign(e,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:n.projectId,priority:"medium",tags:[],tags_data:[]}),n.projectId?await h(n.projectId):await $())},{immediate:!0}),Q(()=>e.project_id,async W=>{W?await h(W):(p.value=[],i.value=[],w.value=[])});const $=async()=>{c.value=!0;try{const W=await window.axios.get("/api/projects-simplified");f.value=W.data.map(U=>({value:U.id,label:U.name}))}catch(W){console.error("Error fetching projects:",W),f.value=[]}finally{c.value=!1}},h=async W=>{if(W){C.value=!0,T.value=!0,S.value=!0;try{const[U,R,F]=await Promise.all([window.axios.get(`/api/projects/${W}/users`),window.axios.get("/api/task-types"),window.axios.get(`/api/projects/${W}/milestones`)]);p.value=U.data.map(ae=>({value:ae.id,label:ae.name})),i.value=R.data.map(ae=>({value:ae.id,label:ae.name})),w.value=F.data.map(ae=>({value:ae.id,label:ae.name}))}catch(U){console.error("Error fetching associated task data:",U),p.value=[],i.value=[],w.value=[]}finally{C.value=!1,T.value=!1,S.value=!1}}},l=W=>{d("saved",W),d("close")},m=()=>{d("close")},b=()=>{e.project_id?y.value=!0:alert("Please select a project before adding a milestone.")},A=W=>{if(y.value=!1,W&&W.id&&W.name){const U={value:W.id,label:W.name};w.value.some(R=>R.value===U.value)||w.value.push(U),e.milestone_id=U.value}},N=B(()=>p.value),O=B(()=>i.value),ne=B(()=>w.value);return(W,U)=>(s(),r(J,null,[v(Me,{show:a.show,title:ra,"api-endpoint":na,"http-method":ia,"form-data":e,"submit-button-text":da,"success-message":ua,onClose:m,onSubmitted:l},{default:x(({errors:R})=>[t("div",Qs,[a.projectId?k("",!0):(s(),r("div",Xs,[v(L,{for:"task-project",value:"Project"}),c.value?(s(),r("div",ea,"Loading projects...")):(s(),M(oe,{key:1,id:"task-project",modelValue:e.project_id,"onUpdate:modelValue":U[0]||(U[0]=F=>e.project_id=F),options:f.value,"value-key":"value","label-key":"label",placeholder:"Select a project",class:"mt-1",required:!0},null,8,["modelValue","options"])),v(q,{message:R.project_id?R.project_id[0]:"",class:"mt-2"},null,8,["message"])])),t("div",null,[v(L,{for:"task-name",value:"Task Name"}),v(le,{id:"task-name",modelValue:e.name,"onUpdate:modelValue":U[1]||(U[1]=F=>e.name=F),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),v(q,{message:R.name?R.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"task-description",value:"Description"}),Z(t("textarea",{id:"task-description","onUpdate:modelValue":U[2]||(U[2]=F=>e.description=F),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[de,e.description]]),v(q,{message:R.description?R.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"task-status",value:"Status"}),v(oe,{id:"task-status",modelValue:e.status,"onUpdate:modelValue":U[3]||(U[3]=F=>e.status=F),options:g.map(F=>({value:F,label:F})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),v(q,{message:R.status?R.status[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"task-priority",value:"Priority"}),v(oe,{id:"task-priority",modelValue:e.priority,"onUpdate:modelValue":U[4]||(U[4]=F=>e.priority=F),options:u,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),v(q,{message:R.priority?R.priority[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"task-due-date",value:"Due Date"}),v(le,{id:"task-due-date",modelValue:e.due_date,"onUpdate:modelValue":U[5]||(U[5]=F=>e.due_date=F),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),v(q,{message:R.due_date?R.due_date[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"task-assigned-to",value:"Assigned To"}),C.value?(s(),r("div",ta,"Loading users...")):(s(),M(oe,{key:1,id:"task-assigned-to",modelValue:e.assigned_to_user_id,"onUpdate:modelValue":U[6]||(U[6]=F=>e.assigned_to_user_id=F),options:N.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(q,{message:R.assigned_to_user_id?R.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"task-type",value:"Task Type"}),T.value?(s(),r("div",sa,"Loading task types...")):(s(),M(oe,{key:1,id:"task-type",modelValue:e.task_type_id,"onUpdate:modelValue":U[7]||(U[7]=F=>e.task_type_id=F),options:O.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(q,{message:R.task_type_id?R.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"task-milestone",value:"Milestone"}),t("div",aa,[S.value?(s(),r("div",oa,"Loading milestones...")):(s(),M(oe,{key:1,id:"task-milestone",modelValue:e.milestone_id,"onUpdate:modelValue":U[8]||(U[8]=F=>e.milestone_id=F),options:ne.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"flex-grow","allow-empty":!0,disabled:!e.project_id},null,8,["modelValue","options","disabled"])),t("button",{type:"button",onClick:b,disabled:!e.project_id||S.value,class:"px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Add New Milestone"},U[11]||(U[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1)]),8,la)]),v(q,{message:R.milestone_id?R.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(Xe,{modelValue:e.tags,"onUpdate:modelValue":U[9]||(U[9]=F=>e.tags=F),initialTags:e.tags_data,label:"Tags",placeholder:"Search or add tags",error:R.tags?R.tags[0]:"",disabled:!e.project_id},null,8,["modelValue","initialTags","error","disabled"])])])]),_:1},8,["show","form-data"]),v(Gs,{show:y.value,"project-id":e.project_id,onClose:U[10]||(U[10]=R=>y.value=!1),onSaved:A},null,8,["show","project-id"])],64))}},ma={class:"space-y-4"},va={class:"flex items-center mt-4"},pa={__name:"CreateForm",props:{show:{type:Boolean,default:!1},apiEndpoint:{type:String,required:!0}},emits:["close","resourceCreated"],setup(a,{emit:o}){const n=a,d=o,e=Ee({title:"",description:"",url:"",type:"website",thumbnail_url:"",visible_to_client:!0,tags:[]}),g=B(()=>[{value:"website",label:"Website"},{value:"youtube",label:"YouTube Video"},{value:"document",label:"Document"},{value:"image",label:"Image"},{value:"other",label:"Other"}]),u=i=>i,f=i=>{d("resourceCreated",i),p()},p=()=>{e.title="",e.description="",e.url="",e.type="website",e.thumbnail_url="",e.visible_to_client=!0,e.tags=[],d("close")};return(i,w)=>(s(),M(Me,{show:n.show,title:"Add New Shareable Resource",apiEndpoint:n.apiEndpoint,httpMethod:"post",formData:e,submitButtonText:"Create Resource",successMessage:"Shareable resource created successfully!",formatDataForApi:u,onSubmitted:f,onClose:p},{default:x(({errors:c})=>[t("div",ma,[t("div",null,[v(L,{for:"title",value:"Title",class:"mb-1"}),v(le,{id:"title",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.title,"onUpdate:modelValue":w[0]||(w[0]=C=>e.title=C),required:""},null,8,["modelValue"]),v(q,{message:c.title?c.title[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"url",value:"Resource URL",class:"mb-1"}),v(le,{id:"url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.url,"onUpdate:modelValue":w[1]||(w[1]=C=>e.url=C),required:""},null,8,["modelValue"]),v(q,{message:c.url?c.url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"type",value:"Resource Type",class:"mb-1"}),v(oe,{id:"type",modelValue:e.type,"onUpdate:modelValue":w[2]||(w[2]=C=>e.type=C),options:g.value,valueKey:"value",labelKey:"label",placeholder:"Select Resource Type",required:"",class:"mt-1 block w-full"},null,8,["modelValue","options"]),v(q,{message:c.type?c.type[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"thumbnail_url",value:"Thumbnail URL (Optional)",class:"mb-1"}),v(le,{id:"thumbnail_url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.thumbnail_url,"onUpdate:modelValue":w[3]||(w[3]=C=>e.thumbnail_url=C)},null,8,["modelValue"]),v(q,{message:c.thumbnail_url?c.thumbnail_url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(L,{for:"description",value:"Description (Optional)",class:"mb-1"}),Z(t("textarea",{id:"description",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm mt-1 block w-full","onUpdate:modelValue":w[4]||(w[4]=C=>e.description=C),rows:"3"},null,512),[[de,e.description]]),v(q,{message:c.description?c.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[v(Xe,{modelValue:e.tags,"onUpdate:modelValue":w[5]||(w[5]=C=>e.tags=C),label:"Associated Tags",placeholder:"Search or add tags",error:c.tags?c.tags[0]:""},null,8,["modelValue","error"])]),t("div",va,[v(bt,{id:"visible_to_client",checked:e.visible_to_client,"onUpdate:checked":w[6]||(w[6]=C=>e.visible_to_client=C)},null,8,["checked"]),v(L,{for:"visible_to_client",value:"Visible to Client",class:"ml-2"}),v(q,{message:c.visible_to_client?c.visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","apiEndpoint","formData"]))}},fa=ke(pa,[["__scopeId","data-v-3e3a6a9f"]]),ga={key:0,class:"sidebar-wrapper"},ya={class:"fixed inset-0 z-[100] flex pointer-events-none"},ha={class:"flex items-center justify-between p-4 border-b border-gray-200 bg-white rounded-tl-xl sticky top-0 z-20"},ka={class:"text-xl font-semibold text-gray-900"},ba={class:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-gray-300 scrollbar-track-gray-100"},wa={key:1,class:"p-4 border-t border-gray-200 bg-white sticky bottom-0 z-20"},xa={__name:"RightSidebar",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Details"},initialWidth:{type:Number,default:50},minWidth:{type:Number,default:30},maxWidth:{type:Number,default:90}},emits:["close","update:show"],setup(a,{emit:o}){const n=a,d=o,e=D(n.initialWidth),g=D(!1),u=c=>{g.value=!0,document.addEventListener("pointermove",f),document.addEventListener("pointerup",p)},f=c=>{if(!g.value)return;const C=window.innerWidth,S=(C-c.clientX)/C*100,y=Math.max(n.minWidth,Math.min(n.maxWidth,S));e.value=y},p=()=>{g.value=!1,document.removeEventListener("pointermove",f),document.removeEventListener("pointerup",p)};Q(()=>n.show,c=>{c?document.body.style.overflow="hidden":document.body.style.overflow=""},{immediate:!0});const i=()=>{d("update:show",!1),d("close")},w=B(()=>window.innerWidth<768);return Q(w,c=>{c&&n.show?e.value=100:!c&&n.show&&(e.value=n.initialWidth)},{immediate:!0}),Q(()=>n.show,c=>{c&&(w.value?e.value=100:e.value=n.initialWidth)}),(c,C)=>(s(),M(Ze,{to:"body"},[v(Ge,{"enter-active-class":"transition ease-out duration-300 transform","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"transition ease-in duration-200 transform","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:x(()=>[a.show?(s(),r("div",ga,[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity z-[99]",onClick:i}),t("div",ya,[t("div",{class:"relative ml-auto h-full bg-white shadow-xl flex flex-col rounded-l-xl pointer-events-auto",style:gt({width:w.value?"100%":`${e.value}vw`})},[w.value?k("",!0):(s(),r("div",{key:0,class:"absolute left-0 top-0 h-full w-2 cursor-col-resize -ml-1 z-10",onPointerdown:u,title:"Drag to resize"},null,32)),t("div",ha,[t("h3",ka,j(a.title),1),t("button",{onClick:i,class:"text-gray-400 hover:text-gray-600 transition-colors"},C[0]||(C[0]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",ba,[re(c.$slots,"content",{},void 0,!0)]),c.$slots.footer?(s(),r("div",wa,[re(c.$slots,"footer",{},void 0,!0)])):k("",!0)],4)])])):k("",!0)]),_:3})]))}},et=ke(xa,[["__scopeId","data-v-2d864577"]]),_a={class:"flex border-b border-gray-200"},$a={key:0,class:"ml-2 px-2 py-1 text-xs font-bold bg-red-600 text-white rounded-full"},Ca={class:"p-4 space-y-2 overflow-y-auto"},Sa={key:0,class:"p-6 text-center text-gray-500"},Ta={key:0},Ia={key:1},Aa=["onClick"],ja={class:"flex-1 min-w-0"},Da={class:"flex items-start justify-between gap-2 mb-1"},Ea={class:"flex-1 min-w-0"},Ma={key:0,class:"text-base font-semibold text-gray-900 truncate"},Pa={key:1,class:"text-xs text-gray-500"},Na={key:0,class:"text-sm text-gray-600 mt-1 mb-2"},Va={class:"flex items-center text-xs text-gray-500 font-medium"},Ua={key:0},Ba={key:1,class:"mx-2"},La={key:2},za={__name:"NotificationsSidebar",setup(a){const o=B(()=>Se.value.notifications),n=D("New"),d=B(()=>n.value==="New"?o.value.filter(f=>!f.isRead):o.value),e=async f=>{await Ye(f.view_id);const p=f.task_id||g(f.url),i=f.project_id||u(f.url);p&&i?(Ke(p,i),Re()):(console.warn("Could not open task sidebar. Falling back to opening URL in new tab."),f.url&&window.open(f.url,"_blank"))},g=f=>{const p=f.match(/\/task\/(\d+)/);return p?parseInt(p[1]):null},u=f=>{const p=f.match(/\/project\/(\d+)\//);return p?parseInt(p[1]):null};return(f,p)=>(s(),M(et,{show:E(Se).show,"onUpdate:show":E(Re),title:"Notifications","initial-width":35,class:"z-[100]"},{content:x(()=>[t("div",_a,[t("button",{onClick:p[0]||(p[0]=i=>n.value="New"),class:V([{"border-blue-600 text-blue-600 font-semibold":n.value==="New","border-transparent text-gray-500 hover:text-gray-700":n.value!=="New"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])},[p[2]||(p[2]=I(" New ",-1)),o.value.filter(i=>!i.isRead).length>0?(s(),r("span",$a,j(o.value.filter(i=>!i.isRead).length),1)):k("",!0)],2),t("button",{onClick:p[1]||(p[1]=i=>n.value="All"),class:V([{"border-blue-600 text-blue-600 font-semibold":n.value==="All","border-transparent text-gray-500 hover:text-gray-700":n.value!=="All"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])}," All ",2)]),t("div",Ca,[d.value.length===0?(s(),r("div",Sa,[n.value==="New"?(s(),r("span",Ta,"You have no new notifications.")):(s(),r("span",Ia,"You have no notifications."))])):k("",!0),(s(!0),r(J,null,K(d.value,i=>(s(),r("div",{key:i.id,class:V(["bg-white rounded-xl shadow-sm p-4 flex items-start space-x-4 border border-gray-200 transition-all duration-200 hover:shadow-md cursor-pointer",{"bg-gray-50":i.isRead}]),onClick:w=>e(i)},[t("div",ja,[t("div",Da,[t("div",Ea,[i.title?(s(),r("h3",Ma,j(i.title),1)):k("",!0),i.project_name?(s(),r("p",Pa,j(i.project_name),1)):k("",!0)])]),i.message?(s(),r("p",Na,j(i.message),1)):k("",!0),t("div",Va,[i.due_date?(s(),r("span",Ua,"Due: "+j(E(Je)(i.due_date)),1)):k("",!0),i.due_date&&i.priority?(s(),r("span",Ba,"•")):k("",!0),i.priority?(s(),r("span",La,"Priority: "+j(i.priority),1)):k("",!0)])])],10,Aa))),128))])]),_:1},8,["show","onUpdate:show"]))}},Ra={class:"flex items-center p-4 h-16 border-b border-gray-700"},Fa={key:0,class:"text-xl font-semibold flex-1 truncate"},Wa=["title"],qa={key:0,class:"p-4 border-b border-gray-700"},Oa={class:"relative"},Ha={key:1,class:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-500 scrollbar-track-gray-700 p-4"},Ja={key:0,class:"mb-4"},Ya={class:"ml-2 mt-2 space-y-1"},Ka=["onClick"],Za={class:"text-sm font-medium text-gray-300 truncate"},Ga={class:"ml-4 mt-1 space-y-1"},Qa={class:"truncate"},Xa={key:1,class:"mb-4"},eo={class:"ml-2 mt-2 space-y-1"},to=["onClick"],so={class:"text-sm font-medium text-gray-300 truncate"},ao={class:"ml-4 mt-1 space-y-1"},oo={class:"truncate"},lo={key:2,class:"mb-4"},ro={class:"ml-2 mt-2 space-y-1"},no={class:"truncate"},io={key:3,class:"mb-4"},uo={class:"ml-2 mt-2 space-y-1"},co={class:"truncate"},mo={key:4,class:"text-gray-400 text-sm text-center py-4"},vo={key:5,class:"text-gray-400 text-sm text-center py-4"},po={key:2,class:"flex flex-col items-center pt-4 space-y-4"},fo={key:0,class:"text-gray-400 text-xs text-center px-2"},go={__name:"LeftSidebar",props:{allProjects:{type:Array,default:()=>[]},activeProjectId:{type:Number,default:null}},emits:["project-selected"],setup(a,{emit:o}){const n=a,d=o,e=D(localStorage.getItem("leftSidebarCollapsed")!=="false"),g=D(""),u=D({}),f=B(()=>{const l=new Set;return n.allProjects.forEach(m=>{m.project_type&&l.add(m.project_type)}),Array.from(l).sort()}),p=B(()=>{const l=new Set;return n.allProjects.forEach(m=>{Array.isArray(m.tags)&&m.tags.forEach(b=>l.add(b))}),Array.from(l).sort()}),i=B(()=>{if(!g.value)return n.allProjects;const l=g.value.toLowerCase();return n.allProjects.filter(m=>{var b,A,N;return m.name.toLowerCase().includes(l)||((b=m.description)==null?void 0:b.toLowerCase().includes(l))||((A=m.project_type)==null?void 0:A.toLowerCase().includes(l))||Array.isArray(m.tags)&&m.tags.some(O=>O.toLowerCase().includes(l))||((N=m.status)==null?void 0:N.toLowerCase().includes(l))})}),w=B(()=>{const l={};i.value.forEach(m=>{m.project_type&&m.status==="active"&&(l[m.project_type]||(l[m.project_type]=[]),l[m.project_type].push(m))});for(const m in l)l[m].sort((b,A)=>b.name.localeCompare(A.name));return l}),c=B(()=>{const l={};i.value.forEach(m=>{Array.isArray(m.tags)&&m.tags.length>0&&m.tags.forEach(b=>{l[b]||(l[b]=[]),l[b].push(m)})});for(const m in l)l[m]=[...new Set(l[m])].sort((b,A)=>b.name.localeCompare(A.name));return l}),C=B(()=>i.value.filter(l=>l.status!=="active").sort((l,m)=>l.name.localeCompare(m.name))),T=B(()=>i.value.filter(l=>!l.project_type&&(!Array.isArray(l.tags)||l.tags.length===0)).sort((l,m)=>l.name.localeCompare(m.name)));Q(()=>n.allProjects,()=>{f.value.forEach(l=>{const m=`type-${l}`;u.value[m]===void 0&&(u.value[m]=!0)}),p.value.forEach(l=>{const m=`tag-${l}`;u.value[m]===void 0&&(u.value[m]=!0)}),u.value["main-types"]===void 0&&(u.value["main-types"]=!1),u.value["main-tags"]===void 0&&(u.value["main-tags"]=!1),u.value["inactive-projects"]===void 0&&(u.value["inactive-projects"]=!1),u.value.uncategorized===void 0&&(u.value.uncategorized=!1)},{immediate:!0}),Q(e,l=>{localStorage.setItem("leftSidebarCollapsed",l)});const S=()=>{e.value=!e.value},y=l=>{u.value[l]=!u.value[l]},$=l=>{d("project-selected",l)},h=()=>{g.value=""};return(l,m)=>(s(),r("div",{class:V({"w-64":!e.value,"w-16":e.value,"min-w-16":!0,"bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out shrink-0 h-screen overflow-hidden":!0})},[t("div",Ra,[e.value?k("",!0):(s(),r("h2",Fa,"Projects")),t("button",{onClick:S,class:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:e.value?"Expand Sidebar":"Collapse Sidebar"},[(s(),r("svg",{class:V(["w-6 h-6 text-gray-400 transform transition-transform duration-300",{"rotate-180":e.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},m[5]||(m[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],8,Wa)]),e.value?k("",!0):(s(),r("div",qa,[t("div",Oa,[Z(t("input",{type:"text","onUpdate:modelValue":m[0]||(m[0]=b=>g.value=b),placeholder:"Search all projects...",class:"w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 text-sm"},null,512),[[de,g.value]]),g.value?(s(),r("button",{key:0,onClick:h,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200",title:"Clear search"},m[6]||(m[6]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):k("",!0)])])),e.value?(s(),r("div",po,[(s(!0),r(J,null,K(n.allProjects,b=>(s(),M(E(ie),{key:b.id,href:l.route("projects.show",b.id),onClick:A=>$(b.id),class:V({"w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-200":!0,"bg-indigo-600 text-white":b.id===a.activeProjectId,"bg-gray-700 text-gray-300 hover:bg-gray-600":b.id!==a.activeProjectId}),title:b.name},{default:x(()=>[I(j(b.name.charAt(0).toUpperCase()),1)]),_:2},1032,["href","onClick","class","title"]))),128)),a.allProjects.length===0?(s(),r("div",fo," No Projects ")):k("",!0)])):(s(),r("div",Ha,[Object.keys(w.value).length>0?(s(),r("div",Ja,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:m[1]||(m[1]=b=>y("main-types"))},[m[8]||(m[8]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Active Projects by Type",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["main-types"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},m[7]||(m[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("div",Ya,[(s(!0),r(J,null,K(w.value,(b,A)=>(s(),r("div",{key:A},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:N=>y(`type-${A}`)},[t("h4",Za,j(A),1),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value[`type-${A}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},m[9]||(m[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,Ka),Z(t("ul",Ga,[(s(!0),r(J,null,K(b,N=>(s(),r("li",{key:N.id},[v(E(ie),{href:l.route("projects.show",N.id),onClick:O=>$(N.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":N.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":N.id!==a.activeProjectId,"font-bold":N.id===a.activeProjectId})},{default:x(()=>[t("span",Qa,j(N.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value[`type-${A}`]]])]))),128))],512),[[ce,!u.value["main-types"]]])])):k("",!0),Object.keys(c.value).length>0?(s(),r("div",Xa,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:m[2]||(m[2]=b=>y("main-tags"))},[m[11]||(m[11]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Projects by Tag",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["main-tags"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},m[10]||(m[10]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("div",eo,[(s(!0),r(J,null,K(c.value,(b,A)=>(s(),r("div",{key:A},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:N=>y(`tag-${A}`)},[t("h4",so,j(A),1),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value[`tag-${A}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},m[12]||(m[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,to),Z(t("ul",ao,[(s(!0),r(J,null,K(b,N=>(s(),r("li",{key:N.id},[v(E(ie),{href:l.route("projects.show",N.id),onClick:O=>$(N.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":N.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":N.id!==a.activeProjectId,"font-bold":N.id===a.activeProjectId})},{default:x(()=>[t("span",oo,j(N.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value[`tag-${A}`]]])]))),128))],512),[[ce,!u.value["main-tags"]]])])):k("",!0),C.value.length>0?(s(),r("div",lo,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:m[3]||(m[3]=b=>y("inactive-projects"))},[m[14]||(m[14]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Inactive Projects",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["inactive-projects"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},m[13]||(m[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("ul",ro,[(s(!0),r(J,null,K(C.value,b=>(s(),r("li",{key:b.id},[v(E(ie),{href:l.route("projects.show",b.id),onClick:A=>$(b.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":b.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":b.id!==a.activeProjectId,"font-bold":b.id===a.activeProjectId})},{default:x(()=>[t("span",no,j(b.name)+" ("+j(b.status.replace("_"," "))+")",1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value["inactive-projects"]]])])):k("",!0),T.value.length>0?(s(),r("div",io,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:m[4]||(m[4]=b=>y("uncategorized"))},[m[16]||(m[16]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Uncategorized",-1)),(s(),r("svg",{class:V(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value.uncategorized}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},m[15]||(m[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("ul",uo,[(s(!0),r(J,null,K(T.value,b=>(s(),r("li",{key:b.id},[v(E(ie),{href:l.route("projects.show",b.id),onClick:A=>$(b.id),class:V({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":b.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":b.id!==a.activeProjectId,"font-bold":b.id===a.activeProjectId})},{default:x(()=>[t("span",co,j(b.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value.uncategorized]])])):k("",!0),i.value.length===0?(s(),r("div",mo," No projects found matching your search. ")):a.allProjects.length===0&&!g.value?(s(),r("div",vo," No projects available. ")):k("",!0)]))],2))}},yo=ke(go,[["__scopeId","data-v-417d431f"]]),ho={class:"relative"},tt={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(a){const o=a,n=u=>{g.value&&u.key==="Escape"&&(g.value=!1)};ye(()=>document.addEventListener("keydown",n)),Ie(()=>document.removeEventListener("keydown",n));const d=B(()=>({48:"w-48"})[o.width.toString()]),e=B(()=>o.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":o.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),g=D(!1);return(u,f)=>(s(),r("div",ho,[t("div",{onClick:f[0]||(f[0]=p=>g.value=!g.value)},[re(u.$slots,"trigger")]),Z(t("div",{class:"fixed inset-0 z-40",onClick:f[1]||(f[1]=p=>g.value=!1)},null,512),[[ce,g.value]]),v(Ge,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:x(()=>[Z(t("div",{class:V(["absolute z-50 mt-2 rounded-md shadow-lg",[d.value,e.value]]),style:{display:"none"},onClick:f[2]||(f[2]=p=>g.value=!1)},[t("div",{class:V(["rounded-md ring-1 ring-black ring-opacity-5",a.contentClasses])},[re(u.$slots,"content")],2)],2),[[ce,g.value]])]),_:3})]))}},ee={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){return(o,n)=>(s(),M(E(ie),Qe({href:a.href,method:a.method,as:a.as},o.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:x(()=>[re(o.$slots,"default")]),_:3},16,["href","method","as"]))}},We={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(a){const o=a,n=B(()=>o.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(d,e)=>(s(),M(E(ie),{href:a.href,class:V(n.value)},{default:x(()=>[re(d.$slots,"default")]),_:3},8,["href","class"]))}};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ko=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(o,n,d)=>d?d.toUpperCase():n.toLowerCase()),bo=a=>{const o=ko(a);return o.charAt(0).toUpperCase()+o.slice(1)},wo=(...a)=>a.filter((o,n,d)=>!!o&&o.trim()!==""&&d.indexOf(o)===n).join(" ").trim(),Oe=a=>a==="";/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ce={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=({name:a,iconNode:o,absoluteStrokeWidth:n,"absolute-stroke-width":d,strokeWidth:e,"stroke-width":g,size:u=Ce.width,color:f=Ce.stroke,...p},{slots:i})=>Ve("svg",{...Ce,...p,width:u,height:u,stroke:f,"stroke-width":Oe(n)||Oe(d)||n===!0||d===!0?Number(e||g||Ce["stroke-width"])*24/Number(u):e||g||Ce["stroke-width"],class:wo("lucide",p.class,...a?[`lucide-${qe(bo(a))}-icon`,`lucide-${qe(a)}`]:["lucide-icon"])},[...o.map(w=>Ve(...w)),...i.default?[i.default()]:[]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=(a,o)=>(n,{slots:d,attrs:e})=>Ve(xo,{...e,...n,iconNode:o,name:a},d);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=st("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=st("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Co={class:"hidden sm:flex sm:items-center"},So={__name:"AdminDropdown",setup(a){const{canDo:o}=Ue(),n=o("manage_projects"),d=o("compose_emails"),e=o("approve_emails"),g=o("create_users");o("manage_roles");const u=o("manage_task_types"),f=o("create_clients");return(p,i)=>(s(),r("div",Co,[v(tt,{align:"right",width:"48"},{trigger:x(()=>i[0]||(i[0]=[t("span",{class:"inline-flex rounded-md"},[t("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},[I(" Admin "),t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:x(()=>[E(n)?(s(),M(ee,{key:0,href:p.route("projects.index"),active:p.route().current("projects.index")},{default:x(()=>i[1]||(i[1]=[I(" Projects ",-1)])),_:1,__:[1]},8,["href","active"])):k("",!0),E(e)?(s(),M(ee,{key:1,href:p.route("emails.pending"),active:p.route().current("emails.pending")},{default:x(()=>i[2]||(i[2]=[I(" Approve Emails ",-1)])),_:1,__:[2]},8,["href","active"])):k("",!0),E(d)?(s(),M(ee,{key:2,href:p.route("emails.rejected"),active:p.route().current("emails.rejected")},{default:x(()=>i[3]||(i[3]=[I(" Rejected Emails ",-1)])),_:1,__:[3]},8,["href","active"])):k("",!0),E(g)?(s(),M(ee,{key:3,href:p.route("availability.index"),active:p.route().current("availability.index")},{default:x(()=>i[4]||(i[4]=[I(" Weekly Availability ",-1)])),_:1,__:[4]},8,["href","active"])):k("",!0),E(f)?(s(),M(ee,{key:4,href:p.route("clients.index"),active:p.route().current("clients.index")},{default:x(()=>i[5]||(i[5]=[I(" Clients ",-1)])),_:1,__:[5]},8,["href","active"])):k("",!0),E(g)?(s(),M(ee,{key:5,href:p.route("users.index"),active:p.route().current("users.index")},{default:x(()=>i[6]||(i[6]=[I(" Users ",-1)])),_:1,__:[6]},8,["href","active"])):k("",!0),E(u)?(s(),M(ee,{key:6,href:p.route("task-types.index"),active:p.route().current("task-types.index")},{default:x(()=>i[7]||(i[7]=[I(" Task Types ",-1)])),_:1,__:[7]},8,["href","active"])):k("",!0),E(o)("manage_bonus_configuration")?(s(),M(ee,{key:7,href:p.route("bonus-configuration.index"),active:p.route().current("bonus-configuration.index")},{default:x(()=>i[8]||(i[8]=[I(" Bonus Configuration ",-1)])),_:1,__:[8]},8,["href","active"])):k("",!0),E(o)("manage_email_templates")?(s(),M(ee,{key:8,href:p.route("email-templates.index"),active:p.route().current("email-templates.index")},{default:x(()=>i[9]||(i[9]=[I(" Email Templates ",-1)])),_:1,__:[9]},8,["href","active"])):k("",!0),E(o)("manage_placeholder_definitions")?(s(),M(ee,{key:9,href:p.route("placeholder-definitions.index"),active:p.route().current("placeholder-definitions.index")},{default:x(()=>i[10]||(i[10]=[I(" Placeholder Definitions ",-1)])),_:1,__:[10]},8,["href","active"])):k("",!0),E(o)("manage_roles")?(s(),M(ee,{key:10,href:p.route("admin.roles.index")},{default:x(()=>i[11]||(i[11]=[I(" Manage Roles ",-1)])),_:1,__:[11]},8,["href"])):k("",!0),E(o)("manage_permissions")?(s(),M(ee,{key:11,href:p.route("admin.permissions.index")},{default:x(()=>i[12]||(i[12]=[I(" Manage Permissions ",-1)])),_:1,__:[12]},8,["href"])):k("",!0)]),_:1})]))}},To={class:"relative ms-3"},Io={class:"inline-flex rounded-md"},Ao={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},jo={__name:"UserDropdown",emits:["logoutSuccess","logoutError"],setup(a,{emit:o}){const n=B(()=>Ae().props.auth.user),d=o,e=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,d("logoutSuccess")},g=u=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",d("logoutError",u)};return(u,f)=>(s(),r("div",To,[v(tt,{align:"right",width:"48"},{trigger:x(()=>{var p;return[t("span",Io,[t("button",Ao,[I(j(n.value.name)+" ("+j((p=n.value.role_data)==null?void 0:p.name)+") ",1),f[0]||(f[0]=t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:x(()=>[v(ee,{href:u.route("profile.edit")},{default:x(()=>f[1]||(f[1]=[I(" Profile ",-1)])),_:1,__:[1]},8,["href"]),v(ee,{href:u.route("logout"),method:"post",as:"button",onSuccess:e,onError:g},{default:x(()=>f[2]||(f[2]=[I(" Log Out ",-1)])),_:1,__:[2]},8,["href"])]),_:1})]))}},Do={class:"border-b border-gray-100 bg-white z-10 relative"},Eo={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},Mo={class:"flex h-16 justify-between"},Po={class:"flex"},No={class:"flex shrink-0 items-center"},Vo={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},Uo={class:"hidden sm:ms-6 sm:flex sm:items-center"},Bo={key:0,class:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-100 transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full"},Lo={class:"-me-2 flex items-center sm:hidden"},zo={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},Ro={__name:"TopNavigation",props:{unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar"],setup(a,{emit:o}){const n=o,d=D(!1);B(()=>Ae().props.auth.user);const{canDo:e}=Ue(),g=e("manage_roles");return(u,f)=>(s(),r("nav",Do,[t("div",Eo,[t("div",Mo,[t("div",Po,[t("div",No,[v(E(ie),{href:u.route("dashboard")},{default:x(()=>[v(wt,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),t("div",Vo,[v(We,{href:u.route("dashboard"),active:u.route().current("dashboard")},{default:x(()=>f[4]||(f[4]=[I(" Dashboard ",-1)])),_:1,__:[4]},8,["href","active"]),E(e)("view_emails")?(s(),M(We,{key:0,href:u.route("inbox"),active:u.route().current("inbox")},{default:x(()=>f[5]||(f[5]=[I(" Inbox ",-1)])),_:1,__:[5]},8,["href","active"])):k("",!0),E(g)?(s(),M(So,{key:1})):k("",!0)])]),t("div",Uo,[v(X,{type:"button",onClick:f[0]||(f[0]=p=>n("openCreateTaskModal")),class:"mr-4 px-4 py-2 text-sm"},{default:x(()=>f[6]||(f[6]=[I(" Add Task ",-1)])),_:1,__:[6]}),v(X,{type:"button",onClick:f[1]||(f[1]=p=>n("openAddResource")),class:"mr-4 px-4 py-2 text-sm"},{default:x(()=>f[7]||(f[7]=[I(" Add Resource ",-1)])),_:1,__:[7]}),t("button",{onClick:f[2]||(f[2]=p=>n("openNotificationsSidebar")),class:"relative flex-shrink-0 text-gray-400 hover:text-gray-600 p-1 rounded-full transition-colors duration-200 mr-4","aria-label":"View all notifications"},[v(E(_o),{class:"h-6 w-6"}),a.unreadNotificationCount>0?(s(),r("span",Bo,j(a.unreadNotificationCount),1)):k("",!0)]),v(jo)]),t("div",Lo,[t("button",{onClick:f[3]||(f[3]=p=>d.value=!d.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(s(),r("svg",zo,[t("path",{class:V({hidden:d.value,"inline-flex":!d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),t("path",{class:V({hidden:!d.value,"inline-flex":d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])])]))}},Y={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){const o=a,n=B(()=>o.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(d,e)=>(s(),M(E(ie),Qe({href:a.href,method:a.method,as:a.as},d.$attrs,{class:n.value}),{default:x(()=>[re(d.$slots,"default")]),_:3},16,["href","method","as","class"]))}},Fo={class:"space-y-1 pb-3 pt-2"},Wo={key:0,class:"mt-3 space-y-1"},qo={class:"border-t border-gray-200 pb-1 pt-4"},Oo={class:"px-4"},Ho={class:"text-base font-medium text-gray-800"},Jo={class:"text-sm font-medium text-gray-500"},Yo={class:"text-sm font-medium text-gray-500 capitalize"},Ko={class:"mt-3 space-y-1"},Zo={__name:"MobileNavigation",props:{showingNavigationDropdown:{type:Boolean,required:!0},unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar","logoutSuccess","logoutError"],setup(a,{emit:o}){const n=o,d=B(()=>Ae().props.auth.user),{canDo:e}=Ue(),g=e("manage_projects"),u=e("compose_emails"),f=e("approve_emails"),p=e("create_users"),i=e("manage_roles"),w=e("manage_task_types"),c=e("create_clients"),C=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,n("logoutSuccess")},T=S=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",n("logoutError",S)};return(S,y)=>{var $;return s(),r("div",{class:V([{block:a.showingNavigationDropdown,hidden:!a.showingNavigationDropdown},"sm:hidden"])},[t("div",Fo,[E(i)?(s(),r("div",Wo,[y[18]||(y[18]=t("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),v(Y,{href:S.route("dashboard"),active:S.route().current("dashboard")},{default:x(()=>y[3]||(y[3]=[I(" Dashboard ",-1)])),_:1,__:[3]},8,["href","active"]),E(e)("view_emails")?(s(),M(Y,{key:0,href:S.route("inbox"),active:S.route().current("inbox")},{default:x(()=>y[4]||(y[4]=[I(" Inbox ",-1)])),_:1,__:[4]},8,["href","active"])):k("",!0),E(c)?(s(),M(Y,{key:1,href:S.route("clients.index"),active:S.route().current("clients.index")},{default:x(()=>y[5]||(y[5]=[I(" Clients ",-1)])),_:1,__:[5]},8,["href","active"])):k("",!0),E(g)?(s(),M(Y,{key:2,href:S.route("projects.index"),active:S.route().current("projects.index")},{default:x(()=>y[6]||(y[6]=[I(" Projects ",-1)])),_:1,__:[6]},8,["href","active"])):k("",!0),E(p)?(s(),M(Y,{key:3,href:S.route("users.index"),active:S.route().current("users.index")},{default:x(()=>y[7]||(y[7]=[I(" Users ",-1)])),_:1,__:[7]},8,["href","active"])):k("",!0),E(u)?(s(),M(Y,{key:4,href:S.route("emails.compose"),active:S.route().current("emails.compose")},{default:x(()=>y[8]||(y[8]=[I(" Compose Email ",-1)])),_:1,__:[8]},8,["href","active"])):k("",!0),E(f)?(s(),M(Y,{key:5,href:S.route("emails.pending"),active:S.route().current("emails.pending")},{default:x(()=>y[9]||(y[9]=[I(" Approve Emails ",-1)])),_:1,__:[9]},8,["href","active"])):k("",!0),E(u)?(s(),M(Y,{key:6,href:S.route("emails.rejected"),active:S.route().current("emails.rejected")},{default:x(()=>y[10]||(y[10]=[I(" Rejected Emails ",-1)])),_:1,__:[10]},8,["href","active"])):k("",!0),E(p)?(s(),M(Y,{key:7,href:S.route("availability.index"),active:S.route().current("availability.index")},{default:x(()=>y[11]||(y[11]=[I(" Weekly Availability ",-1)])),_:1,__:[11]},8,["href","active"])):k("",!0),E(e)("manage_roles")?(s(),M(Y,{key:8,href:S.route("admin.roles.index"),active:S.route().current("admin.roles.index")},{default:x(()=>y[12]||(y[12]=[I(" Manage Roles ",-1)])),_:1,__:[12]},8,["href","active"])):k("",!0),E(e)("manage_permissions")?(s(),M(Y,{key:9,href:S.route("admin.permissions.index"),active:S.route().current("admin.permissions.index")},{default:x(()=>y[13]||(y[13]=[I(" Manage Permissions ",-1)])),_:1,__:[13]},8,["href","active"])):k("",!0),E(e)("manage_bonus_configuration")?(s(),M(Y,{key:10,href:S.route("bonus-configuration.index"),active:S.route().current("bonus-configuration.index")},{default:x(()=>y[14]||(y[14]=[I(" Bonus Configuration ",-1)])),_:1,__:[14]},8,["href","active"])):k("",!0),E(w)?(s(),M(Y,{key:11,href:S.route("task-types.index"),active:S.route().current("task-types.index")},{default:x(()=>y[15]||(y[15]=[I(" Task Types ",-1)])),_:1,__:[15]},8,["href","active"])):k("",!0),E(e)("manage_email_templates")?(s(),M(Y,{key:12,href:S.route("email-templates.index"),active:S.route().current("email-templates.index")},{default:x(()=>y[16]||(y[16]=[I(" Email Templates ",-1)])),_:1,__:[16]},8,["href","active"])):k("",!0),E(e)("manage_placeholder_definitions")?(s(),M(Y,{key:13,href:S.route("placeholder-definitions.index"),active:S.route().current("placeholder-definitions.index")},{default:x(()=>y[17]||(y[17]=[I(" Placeholder Definitions ",-1)])),_:1,__:[17]},8,["href","active"])):k("",!0)])):k("",!0)]),t("div",qo,[t("div",Oo,[t("div",Ho,j(d.value.name),1),t("div",Jo,j(d.value.email),1),t("div",Yo,j(($=d.value.role_data)==null?void 0:$.name),1)]),t("div",Ko,[v(Y,{as:"button",onClick:y[0]||(y[0]=h=>n("openCreateTaskModal"))},{default:x(()=>y[19]||(y[19]=[I(" Add Task ",-1)])),_:1,__:[19]}),v(Y,{as:"button",onClick:y[1]||(y[1]=h=>n("openAddResource"))},{default:x(()=>y[20]||(y[20]=[I(" Add Resource ",-1)])),_:1,__:[20]}),v(Y,{as:"button",onClick:y[2]||(y[2]=h=>n("openNotificationsSidebar"))},{default:x(()=>[I(" Notifications ("+j(a.unreadNotificationCount)+") ",1)]),_:1}),v(Y,{href:S.route("profile.edit")},{default:x(()=>y[21]||(y[21]=[I(" Profile ",-1)])),_:1,__:[21]},8,["href"]),v(Y,{href:S.route("logout"),method:"post",as:"button",onSuccess:C,onError:T},{default:x(()=>y[22]||(y[22]=[I(" Log Out ",-1)])),_:1,__:[22]},8,["href"])])])],2)}}},Go={class:"space-y-4"},Qo={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},Xo={class:"text-sm font-medium text-gray-900"},el={class:"text-xs text-gray-500 mt-1"},tl={class:"mb-4"},sl="post",al="Add Note",ol="Note added successfully!",ll={__name:"TaskNoteModal",props:{show:Boolean,taskForNote:Object},emits:["close","note-added"],setup(a,{emit:o}){const n=a,d=o,e=Ee({note:""}),g=B(()=>{var i;return`Add Note to Task: "${(i=n.taskForNote)==null?void 0:i.name}"`}),u=B(()=>{var i;return`/api/tasks/${(i=n.taskForNote)==null?void 0:i.id}/notes`});Q(()=>n.show,i=>{i&&Object.assign(e,{note:""})},{immediate:!0});const f=i=>{d("note-added",i),d("close")},p=()=>{d("close")};return(i,w)=>(s(),M(Me,{show:a.show,title:g.value,"api-endpoint":u.value,"http-method":sl,"form-data":e,"submit-button-text":al,"success-message":ol,onClose:p,onSubmitted:f},{default:x(({errors:c})=>[t("div",Go,[a.taskForNote?(s(),r("div",Qo,[t("p",Xo,j(a.taskForNote.name),1),t("p",el,"Status: "+j(a.taskForNote.status),1)])):k("",!0),t("div",tl,[v(L,{for:"task-note-content",value:"Note Content"}),Z(t("textarea",{id:"task-note-content","onUpdate:modelValue":w[0]||(w[0]=C=>e.note=C),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your note...",required:""},null,512),[[de,e.note]]),v(q,{message:c.note?c.note[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},rl={class:"task-history-list"},nl={key:0,class:"text-center py-4"},il={key:1,class:"text-gray-500 text-sm py-2"},dl={key:2,class:"space-y-3"},ul={class:"flex items-start"},cl={class:"text-xl mr-2"},ml={class:"text-sm text-gray-700"},vl={class:"text-xs text-gray-500 mt-1"},pl={__name:"TaskHistoryList",props:{activities:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(a){const o=d=>d?new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",n=d=>(console.log(d),d.includes("created")?"🆕":d.includes("started")?"🚀":d.includes("paused")?"⏸️":d.includes("resumed")?"▶️":d.includes("unblocked")?"🔓":d.includes("blocked")?"⛔":d.includes("completed")?"✅":d.includes("revised")?"🔄":d.includes("deleted")?"🗑️":d.includes("assigned")?"👤":d.includes("updated")?"📝":d.includes("added note")?"🗒️":d.includes("commented")?"💬":"📋");return(d,e)=>(s(),r("div",rl,[a.loading?(s(),r("div",nl,e[0]||(e[0]=[t("div",{class:"inline-block animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-indigo-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"Loading activity history...",-1)]))):a.activities.length===0?(s(),r("div",il," No activity history available for this task. ")):(s(),r("div",dl,[(s(!0),r(J,null,K(a.activities,g=>{var u;return s(),r("div",{key:g.id,class:"p-3 bg-gray-50 rounded-md"},[t("div",ul,[t("span",cl,j(n(g.description)),1),t("div",null,[t("p",ml,j(g.description),1),t("p",vl," By "+j(((u=g.causer)==null?void 0:u.name)||"System")+" on "+j(o(g.created_at)),1)])])])}),128))]))]))}},fl=ke(pl,[["__scopeId","data-v-423d54af"]]),Kr=async()=>{try{return(await H.get("/api/assigned-tasks")).data}catch(a){throw console.error("Error fetching assigned tasks:",a),G("Failed to load assigned tasks"),a}},Zr=async a=>{try{return(await H.get(`/api/projects/${a}/tasks`)).data}catch(o){throw console.error("Error fetching project tasks:",o),G("Failed to load project tasks"),o}},Gr=async a=>{try{return(await H.get(`/api/projects/${a}/due-and-overdue-tasks`)).data}catch(o){throw console.error("Error fetching due and overdue tasks:",o),G("Failed to load due and overdue tasks"),o}},gl=async a=>{if(!a||a.status==="In Progress")return a;try{me("Starting task...");const o=await H.post(`/api/tasks/${a.id}/start`);return se("Task started successfully"),o.data}catch(o){throw console.error("Error starting task:",o),G("Failed to start task. Please try again."),o}},yl=async a=>{if(!a||a.status!=="In Progress")return te('Task can only be paused from "In Progress" status.'),a;try{me("Pausing task...");const o=await H.post(`/api/tasks/${a.id}/pause`);return se("Task paused successfully"),o.data}catch(o){throw console.error("Error pausing task:",o),G("Failed to pause task. Please try again."),o}},hl=async a=>{if(!a||a.status!=="Paused")return te('Task can only be resumed from "Paused" status.'),a;try{me("Resuming task...");const o=await H.post(`/api/tasks/${a.id}/resume`);return se("Task resumed successfully"),o.data}catch(o){throw console.error("Error resuming task:",o),G("Failed to resume task. Please try again."),o}},kl=async a=>{if(!a||a.status==="Done")return a;if(a.status!=="In Progress")throw te("Task must be started before it can be completed"),new Error("Task must be started before it can be completed");try{me("Completing task...");const o=await H.patch(`/api/tasks/${a.id}/complete`);return se("Task completed successfully"),o.data}catch(o){throw console.error("Error completing task:",o),o.response&&o.response.status===422?te(o.response.data.message||"Task must be started before it can be completed"):G("Failed to complete task. Please try again."),o}},bl=async(a,o)=>{if(!a||a.status==="Blocked")return te("Task is already blocked."),a;if(a.status==="Done")return te("Completed tasks cannot be blocked."),a;if(!o)throw te("Please provide a reason for blocking the task"),new Error("Blocking reason is required");try{me("Blocking task...");const n=await H.post(`/api/tasks/${a.id}/block`,{reason:o});return se("Task blocked successfully"),n.data}catch(n){throw console.error("Error blocking task:",n),G("Failed to block task. Please try again."),n}},wl=async a=>{if(!a||a.status!=="Blocked")return te("Task is not in a blocked state."),a;try{me("Unblocking task...");const o=await H.post(`/api/tasks/${a.id}/unblock`);return se("Task unblocked successfully"),o.data}catch(o){throw console.error("Error unblocking task:",o),G("Failed to unblock task. Please try again."),o}},xl=async a=>{if(!a||a.status!=="Done")return te("Only completed tasks can be revised."),a;try{me("Revising task...");const o=await H.post(`/api/tasks/${a.id}/revise`);return se("Task revised successfully"),o.data}catch(o){throw console.error("Error revising task:",o),o.response&&o.response.status===422?te(o.response.data.message||"Only completed tasks can be revised"):G("Failed to revise task. Please try again."),o}},_l=async a=>{if(!a)return!1;if(a.status!=="To Do")throw te("Only tasks in To Do status can be deleted"),new Error("Only tasks in To Do status can be deleted");if(!confirm("Are you sure you want to delete this task? This action cannot be undone."))return!1;try{return me("Deleting task..."),await H.delete(`/api/tasks/${a.id}`),se("Task deleted successfully"),!0}catch(o){throw console.error("Error deleting task:",o),G("Failed to delete task. Please try again."),o}},$l=a=>{switch(a){case"To Do":return"bg-yellow-100 text-yellow-800";case"In Progress":return"bg-blue-100 text-blue-800";case"Paused":return"bg-orange-100 text-orange-800";case"Blocked":return"bg-red-100 text-red-800";case"Done":return"bg-green-100 text-green-800";case"Archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Qr=a=>{switch(a){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Xr=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"Medium",Cl=["checked","onChange"],Sl={__name:"ChecklistComponent",props:{items:{type:Array,required:!0},apiEndpoint:{type:String,required:!0},title:{type:String,default:"Checklist"},containerClass:{type:String,default:"mt-4 p-3 bg-gray-100 rounded-lg text-sm text-gray-700 border border-gray-200"},titleClass:{type:String,default:"font-semibold text-gray-900 mb-2"},itemsContainerClass:{type:String,default:"space-y-1"},itemClass:{type:String,default:"flex items-center space-x-2"},checkboxClass:{type:String,default:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},completedItemClass:{type:String,default:"line-through text-gray-500"},successMessage:{type:String,default:"Checklist item updated!"},errorMessage:{type:String,default:"Failed to update checklist item"},payloadTransformer:{type:Function,default:null},checkListStyle:{type:String,default:"checklist"}},emits:["update:items","item-toggled"],setup(a,{emit:o}){const n=a,d=o,e=D(JSON.parse(JSON.stringify(n.items)));Q(()=>n.items,u=>{e.value=JSON.parse(JSON.stringify(u))},{deep:!0});async function g(u){const f=e.value[u],p=!f.completed;f.completed=p;try{let i;n.payloadTransformer?i=n.payloadTransformer(e.value,u):i={items:e.value},await H.put(n.apiEndpoint,i),d("update:items",e.value),d("item-toggled",{index:u,item:f,completed:p}),se(n.successMessage)}catch(i){console.error("Error updating checklist item:",i),f.completed=!p,G(n.errorMessage)}}return(u,f)=>e.value&&e.value.length>0?(s(),r("div",{key:0,class:V(a.containerClass)},[t("p",{class:V(a.titleClass)},j(a.title),3),t("ul",{class:V(a.itemsContainerClass)},[(s(!0),r(J,null,K(e.value,(p,i)=>(s(),r("li",{key:i,class:V(a.itemClass)},[a.checkListStyle==="checklist"?(s(),r("input",{key:0,type:"checkbox",checked:p.completed,onChange:w=>g(i),class:V(a.checkboxClass)},null,42,Cl)):k("",!0),t("span",{class:V({[a.completedItemClass]:p.completed})},j(p.name),3)],2))),128))],2)],2)):k("",!0)}};function He(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z","clip-rule":"evenodd"})])}const Tl={class:"mt-4"},Il={__name:"ChecklistCreator",props:{modelValue:{type:Array,required:!0},placeholder:{type:String,default:"e.g., Task 1, Task 2, Task 3"},label:{type:String,default:"Checklist Items"},density:{type:String,default:"spacious",validator:a=>["spacious","tight","notes"].includes(a)}},emits:["update:modelValue"],setup(a,{emit:o}){const n=a,d=o,e=D([]),g=D([]),u=D(!1);Q(()=>n.modelValue,c=>{u.value=!0,e.value=JSON.parse(JSON.stringify(c)),(e.value.length===0||e.value[e.value.length-1].name.trim()!=="")&&e.value.push({name:"",completed:!1}),ge(()=>{u.value=!1})},{immediate:!0,deep:!0}),Q(()=>e.value,c=>{u.value||d("update:modelValue",c)},{deep:!0});function f(c){e.value.splice(c,1),e.value.length===0&&e.value.push({name:"",completed:!1})}function p(c){c===e.value.length-1&&e.value[c].name.trim()!==""&&e.value.push({name:"",completed:!1})}function i(c){c<e.value.length-1&&ge(()=>{var C;(C=g.value[c+1])==null||C.focus()})}const w=B(()=>n.density==="tight"?{listClass:"space-y-1",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-1 text-sm"}:n.density==="notes"?{listClass:"space-y-0.5",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-0.5 text-sm border-transparent focus:border-transparent focus:ring-0 bg-transparent"}:{listClass:"space-y-2",itemClass:"flex items-center space-x-2",inputClass:""});return(c,C)=>(s(),r("div",Tl,[a.label?(s(),M(L,{key:0,value:a.label},null,8,["value"])):k("",!0),t("ul",{class:V(w.value.listClass)},[(s(!0),r(J,null,K(e.value,(T,S)=>(s(),r("li",{key:S,class:V(w.value.itemClass)},[a.density==="notes"?(s(),M(E(He),{key:0,class:"h4 w-4",onClick:y=>f(S)},null,8,["onClick"])):k("",!0),v(le,{modelValue:T.name,"onUpdate:modelValue":y=>T.name=y,type:"text",class:V(["flex-1",w.value.inputClass]),placeholder:S===e.value.length-1?a.placeholder:"",onInput:y=>p(S),onKeyup:je(De(y=>i(S),["prevent"]),["enter"]),ref_for:!0,ref:y=>{y&&(g.value[S]=y)}},null,8,["modelValue","onUpdate:modelValue","class","placeholder","onInput","onKeyup"]),e.value.length>1&&a.density!=="notes"?(s(),M(Le,{key:1,type:"button",onClick:y=>f(S)},{default:x(()=>[v(E(He),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):k("",!0)],2))),128))],2)]))}},Al={key:0,class:"text-center py-8 text-gray-500"},jl={key:1,class:"text-center py-8 text-red-600"},Dl={key:2,class:"space-y-6"},El={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Ml={class:"text-xl font-bold text-gray-900 mb-2"},Pl={class:"flex items-center space-x-2 text-sm text-gray-600 mb-4"},Nl={key:0,class:"text-indigo-600 font-medium"},Vl={key:1,class:"text-purple-600 font-medium"},Ul={class:"text-gray-700 leading-relaxed"},Bl={class:"mt-4 flex flex-wrap gap-2"},Ll={key:0,class:"text-xs text-gray-500 mt-1"},zl={key:0,class:"bg-yellow-50 border-l-4 border-red-400 p-4 rounded-lg shadow-sm"},Rl={class:"flex items-center"},Fl={class:"ml-3"},Wl={class:"mt-2 text-sm text-yellow-700"},ql={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm mb-4"},Ol={class:"flex justify-between items-center border-b pb-2 mb-4"},Hl={key:0},Jl={key:1},Yl={key:0,class:"mb-4"},Kl={class:"flex justify-end mt-4"},Zl={key:2,class:"text-gray-500 text-sm py-2"},Gl={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm"},Ql={class:"flex items-center justify-between py-2 border-b border-gray-100"},Xl={class:"flex-1 text-right"},er={key:0,class:"text-xs text-gray-400 ml-1"},tr={key:1,class:"flex items-center space-x-2"},sr={class:"flex items-center justify-between py-2 border-b border-gray-100"},ar={class:"flex-1 text-right"},or={key:1,class:"flex items-center space-x-2"},lr={class:"flex items-center justify-between py-2 border-b border-gray-100"},rr={class:"flex-1 text-right"},nr={key:0,class:"text-xs text-gray-400 ml-1"},ir={key:1,class:"flex items-center space-x-2"},dr={class:"flex items-center justify-between py-2 border-b border-gray-100"},ur={class:"text-gray-700"},cr={class:"flex items-start py-2 border-b border-gray-100"},mr={class:"flex-1 flex flex-wrap gap-2"},vr={key:0,class:"text-gray-500 text-sm"},pr={class:"bg-white p-4 rounded-lg shadow-sm"},fr={class:"flex justify-between items-center mb-4 border-b pb-2"},gr={key:0,class:"space-y-3"},yr={class:"text-sm text-gray-700"},hr={class:"text-xs text-gray-500 mt-1"},kr={key:1,class:"text-gray-500 text-sm py-2"},br={class:"bg-white p-4 rounded-lg shadow-sm"},wr={key:3,class:"text-center py-8 text-gray-500"},xr={key:4,class:"mt-4 flex flex-col items-center"},_r={key:0,class:"text-xs text-red-500 mt-1"},$r={class:"p-6"},Cr={class:"mb-4"},Sr={class:"flex justify-end space-x-3"},Tr={__name:"TaskDetailSidebar",props:{taskId:{type:Number,required:!0},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]}},emits:["close","task-updated","task-deleted"],setup(a,{emit:o}){const n=a,d=o,e=D(null),g=D(!0),u=D(""),f=D(!1),p=D(!1),i=D(!1),w=D(null),c=D(null),C=D(null),T=D([]),S=D(!1),y=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],$=D(!1),h=D(!1),l=D([{name:"",completed:!1}]),m=D(!1),b=async()=>{g.value=!0,u.value="";try{const P=await window.axios.get(`/api/tasks/${n.taskId}`);e.value=P.data,w.value=e.value.assigned_to_id||null,c.value=e.value.due_date||null,C.value=e.value.priority||"medium",A()}catch(P){u.value="Failed to load task details.",console.error("Error fetching task details:",P)}finally{g.value=!1}},A=async()=>{S.value=!0;try{const P=await window.axios.get("/api/activities",{params:{subject_type:"App\\Models\\Task",subject_id:n.taskId}});T.value=P.data}catch(P){console.error("Error fetching task activities:",P)}finally{S.value=!1}};Q(()=>n.taskId,P=>{P?b():e.value=null},{immediate:!0});const N=B(()=>n.projectUsers.map(P=>({value:P.id,label:P.name}))),O=async()=>{if(!e.value||w.value===e.value.assigned_to_id){f.value=!1;return}try{const P=await window.axios.patch(`/api/tasks/${e.value.id}`,{assigned_to_user_id:w.value});e.value=P.data,d("task-updated",e.value)}catch(P){console.error("Error updating assigned user:",P),w.value=e.value.assigned_to_id,G("Failed to update assigned user. Please try again.")}finally{f.value=!1}},ne=async()=>{if(!e.value||c.value===e.value.due_date){p.value=!1;return}try{const P=await window.axios.patch(`/api/tasks/${e.value.id}`,{due_date:c.value});e.value=P.data,d("task-updated",e.value)}catch(P){console.error("Error updating due date:",P),c.value=e.value.due_date,G("Failed to update due date. Please try again.")}finally{p.value=!1}},W=async()=>{if(!e.value||C.value===e.value.priority){i.value=!1;return}try{const P=await window.axios.patch(`/api/tasks/${e.value.id}`,{priority:C.value});e.value=P.data,d("task-updated",e.value)}catch(P){console.error("Error updating priority:",P),C.value=e.value.priority,G("Failed to update priority. Please try again.")}finally{i.value=!1}},U=()=>{$.value=!0},R=()=>{b(),$.value=!1},F=async()=>{try{await _l(e.value),d("task-deleted",e.value.id),d("close")}catch(P){console.error("Error deleting task:",P)}},ae=async()=>{try{e.value=await gl(e.value),d("task-updated",e.value),A()}catch(P){console.error("Error starting task:",P)}},at=async()=>{try{e.value=await yl(e.value),d("task-updated",e.value),A()}catch(P){console.error("Error pausing task:",P)}},ot=async()=>{try{e.value=await hl(e.value),d("task-updated",e.value),A()}catch(P){console.error("Error resuming task:",P)}},lt=async()=>{try{e.value=await kl(e.value),d("task-updated",e.value),A()}catch(P){console.error("Error completing task:",P)}},rt=async()=>{try{e.value=await xl(e.value),d("task-updated",e.value),A()}catch(P){console.error("Error revising task:",P)}},nt=()=>{var P;h.value=!h.value,h.value&&((P=e.value.details)!=null&&P.checklist&&e.value.details.checklist.length>0?(l.value=JSON.parse(JSON.stringify(e.value.details.checklist)),l.value[l.value.length-1].name!==""&&l.value.push({name:"",completed:!1})):l.value=[{name:"",completed:!1}])},it=async()=>{if(!m.value){m.value=!0;try{const P=l.value.filter(pe=>pe.name.trim()!==""),_={details:{...e.value.details,checklist:P}},ve=await window.axios.patch(`/api/tasks/${e.value.id}`,_);e.value=ve.data,h.value=!1,se("Checklist saved successfully"),d("task-updated",e.value)}catch(P){console.error("Error saving checklist:",P),G("Failed to save checklist")}finally{m.value=!1}}},be=D(!1),he=D(""),dt=()=>{he.value="",be.value=!0},ut=async()=>{if(!he.value.trim()){te("Please provide a reason for blocking the task");return}try{e.value=await bl(e.value,he.value),se("Task blocked successfully"),d("task-updated",e.value),A(),be.value=!1}catch(P){console.error("Error blocking task:",P)}},ct=async()=>{try{e.value=await wl(e.value),d("task-updated",e.value),A()}catch(P){console.error("Error unblocking task:",P)}},mt=B(()=>e.value?$l(e.value.status):""),Pe=B(()=>{var _,ve,pe,we;if(!T.value||((_=e.value)==null?void 0:_.status)!=="Blocked")return null;const P=T.value.find(xe=>{var _e,$e;return xe.event==="updated"&&(($e=(_e=xe.properties)==null?void 0:_e.attributes)==null?void 0:$e.status)==="Blocked"});return P?(console.log(P.properties),{causer:((ve=P.causer)==null?void 0:ve.name)||"Unknown",reason:((we=(pe=P.properties)==null?void 0:pe.attributes)==null?void 0:we.block_reason)||"No reason provided."}):null});return(P,_)=>{var ve,pe,we,xe,_e,$e,ze;return s(),r("div",null,[g.value?(s(),r("div",Al," Loading task details... ")):u.value?(s(),r("div",jl,j(u.value),1)):e.value?(s(),r("div",Dl,[t("div",El,[t("h4",Ml,j(e.value.name),1),t("div",Pl,[t("span",{class:V(["px-2 py-1 rounded-full text-xs font-medium",mt.value])},j(e.value.status),3),e.value.task_type?(s(),r("span",Nl," | "+j((ve=e.value.task_type)==null?void 0:ve.name)+" | ",1)):k("",!0),_[14]||(_[14]=t("br",null,null,-1)),(pe=e.value.milestone)!=null&&pe.name?(s(),r("span",Vl,j((we=e.value.milestone)==null?void 0:we.name),1)):k("",!0)]),t("p",Ul,j(e.value.description||"No description provided."),1),t("div",Bl,[e.value.status==="To Do"?(s(),M(X,{key:0,onClick:ae,class:"bg-blue-600 hover:bg-blue-700"},{default:x(()=>_[15]||(_[15]=[I(" Start Task ",-1)])),_:1,__:[15]})):e.value.status==="In Progress"?(s(),M(X,{key:1,onClick:at,class:"bg-orange-600 hover:bg-orange-700"},{default:x(()=>_[16]||(_[16]=[I(" Pause Task ",-1)])),_:1,__:[16]})):e.value.status==="Paused"?(s(),M(X,{key:2,onClick:ot,class:"bg-blue-600 hover:bg-blue-700"},{default:x(()=>_[17]||(_[17]=[I(" Resume Task ",-1)])),_:1,__:[17]})):e.value.status==="Blocked"?(s(),M(X,{key:3,onClick:ct,class:"bg-green-600 hover:bg-green-700"},{default:x(()=>_[18]||(_[18]=[I(" Unblock Task ",-1)])),_:1,__:[18]})):k("",!0),e.value.status==="To Do"||e.value.status==="In Progress"||e.value.status==="Paused"?(s(),M(X,{key:4,onClick:dt,class:"bg-red-600 hover:bg-red-700"},{default:x(()=>_[19]||(_[19]=[I(" Block Task ",-1)])),_:1,__:[19]})):k("",!0),e.value.status==="In Progress"?(s(),M(X,{key:5,onClick:lt,class:"bg-green-600 hover:bg-green-700"},{default:x(()=>_[20]||(_[20]=[I(" Complete Task ",-1)])),_:1,__:[20]})):k("",!0),e.value.status==="Done"?(s(),M(X,{key:6,onClick:rt,class:"bg-yellow-600 hover:bg-yellow-700"},{default:x(()=>_[21]||(_[21]=[I(" Revise Task ",-1)])),_:1,__:[21]})):k("",!0)]),e.value.status==="Done"?(s(),r("div",Ll,' Revising will change the task status back to "To Do" ')):k("",!0)]),e.value.status==="Blocked"&&Pe.value?(s(),r("div",zl,[t("div",Rl,[_[23]||(_[23]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.487 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11.75 13a.75.75 0 01-1.5 0v-2.25a.75.75 0 011.5 0V13zm-1.5-7.5a.75.75 0 011.5 0v1.5a.75.75 0 01-1.5 0V5.5z","clip-rule":"evenodd"})])],-1)),t("div",Fl,[_[22]||(_[22]=t("h3",{class:"text-sm font-medium text-yellow-800"},"Task Blocked",-1)),t("div",Wl,[t("p",null,"This task was blocked by **"+j(Pe.value.causer)+"** with the following reason:",1),t("p",null,j(Pe.value.reason),1)])])])])):k("",!0),t("div",ql,[t("div",Ol,[_[24]||(_[24]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Task Checklist",-1)),t("button",{onClick:nt,class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center"},[h.value?(s(),r("span",Jl,"Cancel")):(s(),r("span",Hl,j((xe=e.value.details)!=null&&xe.checklist&&e.value.details.checklist.length>0?"Edit Checklist":"Add Checklist"),1))])]),h.value?(s(),r("div",Yl,[v(Il,{modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=z=>l.value=z),placeholder:"e.g., Review design, Update documentation",label:"Checklist Items",density:"notes"},null,8,["modelValue"]),t("div",Kl,[v(X,{onClick:it,disabled:m.value,class:"flex items-center space-x-1"},{default:x(()=>[v(E($o),{class:"h-4 w-4"}),_[25]||(_[25]=t("span",null,"Save Checklist",-1))]),_:1,__:[25]},8,["disabled"])])])):k("",!0),(_e=e.value.details)!=null&&_e.checklist&&e.value.details.checklist.length>0&&!h.value?(s(),M(Sl,{key:1,items:e.value.details.checklist,"api-endpoint":`/api/tasks/${e.value.id}`,title:"Items to complete:","payload-transformer":z=>({details:{...e.value.details,checklist:z}})},null,8,["items","api-endpoint","payload-transformer"])):k("",!0),(!(($e=e.value.details)!=null&&$e.checklist)||e.value.details.checklist.length===0)&&!h.value?(s(),r("div",Zl,' No checklist items for this task yet. Click "Add Checklist" to create one. ')):k("",!0)]),t("div",Gl,[_[32]||(_[32]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Task Attributes",-1)),t("div",Ql,[v(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[26]||(_[26]=[I("Assigned To:",-1)])),_:1,__:[26]}),t("div",Xl,[f.value?(s(),r("div",tr,[v(oe,{id:"edit-assigned-to",modelValue:w.value,"onUpdate:modelValue":_[2]||(_[2]=z=>w.value=z),options:N.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1 flex-1","allow-empty":!0},null,8,["modelValue","options"]),t("button",{onClick:O,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:_[3]||(_[3]=z=>f.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:_[1]||(_[1]=z=>e.value.status!=="Done"?f.value=!0:te("Cannot change assignment for a completed task. Use the Revise button to change the task status first.")),class:V(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[I(j(((ze=e.value.assigned_to)==null?void 0:ze.name)||"Unassigned")+" ",1),e.value.status!=="Done"?(s(),r("span",er,"(Click to edit)")):k("",!0)],2))])]),t("div",sr,[v(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[27]||(_[27]=[I("Due Date:",-1)])),_:1,__:[27]}),t("div",ar,[p.value?(s(),r("div",or,[v(le,{id:"edit-due-date",modelValue:c.value,"onUpdate:modelValue":_[5]||(_[5]=z=>c.value=z),type:"date",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:ne,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:_[6]||(_[6]=z=>p.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:_[4]||(_[4]=z=>p.value=!0),class:"cursor-pointer text-indigo-600 hover:text-indigo-800"},[I(j(e.value.due_date?E(xt)(e.value.due_date).format("MMM D, YYYY"):"No Due Date")+" ",1),_[28]||(_[28]=t("span",{class:"text-xs text-gray-400 ml-1"},"(Click to edit)",-1))]))])]),t("div",lr,[v(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[29]||(_[29]=[I("Priority:",-1)])),_:1,__:[29]}),t("div",rr,[i.value?(s(),r("div",ir,[v(oe,{id:"edit-priority",modelValue:C.value,"onUpdate:modelValue":_[8]||(_[8]=z=>C.value=z),options:y,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:W,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:_[9]||(_[9]=z=>i.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:_[7]||(_[7]=z=>e.value.status!=="Done"?i.value=!0:te("Cannot change priority for a completed task. Use the Revise button to change the task status first.")),class:V(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[t("span",{class:V({"text-red-600 font-medium":e.value.priority==="high","text-yellow-600 font-medium":e.value.priority==="medium","text-green-600 font-medium":e.value.priority==="low"})},j(e.value.priority?e.value.priority.charAt(0).toUpperCase()+e.value.priority.slice(1):"Medium"),3),e.value.status!=="Done"?(s(),r("span",nr,"(Click to edit)")):k("",!0)],2))])]),t("div",dr,[v(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[30]||(_[30]=[I("Created:",-1)])),_:1,__:[30]}),t("span",ur,j(e.value.created_at?new Date(e.value.created_at).toLocaleDateString():"N/A"),1)]),t("div",cr,[v(L,{class:"min-w-[100px] text-gray-600 mt-1"},{default:x(()=>_[31]||(_[31]=[I("Tags:",-1)])),_:1,__:[31]}),t("div",mr,[(s(!0),r(J,null,K(e.value.tags,z=>(s(),r("span",{key:z.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},j(z.name),1))),128)),!e.value.tags||e.value.tags.length===0?(s(),r("span",vr,"No tags")):k("",!0)])])]),t("div",pr,[t("div",fr,[_[34]||(_[34]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Notes",-1)),v(X,{onClick:U,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:x(()=>_[33]||(_[33]=[I(" Add Note ",-1)])),_:1,__:[33]})]),e.value.notes&&e.value.notes.length>0?(s(),r("div",gr,[(s(!0),r(J,null,K(e.value.notes,z=>(s(),r("div",{key:z.id,class:"p-3 bg-gray-50 rounded-md"},[t("p",yr,j(z.content),1),t("p",hr," By "+j(z.creator_name||"Unknown")+" on "+j(new Date(z.created_at).toLocaleDateString()),1)]))),128))])):(s(),r("div",kr,"No notes for this task yet."))]),t("div",br,[_[35]||(_[35]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"History",-1)),v(fl,{activities:T.value,loading:S.value},null,8,["activities","loading"])])])):(s(),r("div",wr," Select a task to view details. ")),e.value&&e.value.status!=="Done"?(s(),r("div",xr,[v(Le,{onClick:F,disabled:e.value.status!=="To Do"},{default:x(()=>_[36]||(_[36]=[I(" Delete Task ",-1)])),_:1,__:[36]},8,["disabled"]),e.value.status!=="To Do"?(s(),r("p",_r,"Task can only be deleted in 'To Do' status.")):k("",!0)])):k("",!0),v(ll,{show:$.value,"task-for-note":e.value,onClose:_[10]||(_[10]=z=>$.value=!1),onNoteAdded:R},null,8,["show","task-for-note"]),v(Be,{show:be.value,onClose:_[13]||(_[13]=z=>be.value=!1)},{default:x(()=>[t("div",$r,[_[40]||(_[40]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),t("div",Cr,[_[37]||(_[37]=t("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),Z(t("textarea",{"onUpdate:modelValue":_[11]||(_[11]=z=>he.value=z),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[de,he.value]])]),t("div",Sr,[v(Te,{onClick:_[12]||(_[12]=z=>be.value=!1)},{default:x(()=>_[38]||(_[38]=[I(" Cancel ",-1)])),_:1,__:[38]}),v(X,{onClick:ut,disabled:!he.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:x(()=>_[39]||(_[39]=[I(" Block Task ",-1)])),_:1,__:[39]},8,["disabled"])])])]),_:1},8,["show"])])}}},Ir={key:1,class:"p-4 text-gray-500"},Ar={key:0,class:"flex justify-end space-x-3"},jr={__name:"TaskSidebar",emits:["taskUpdated","taskDeleted"],setup(a){const o=D(null);return(n,d)=>(s(),M(et,{show:E(ue).show,"onUpdate:show":E(Ne),title:E(ue).taskId?"Task Details":"Details",initialWidth:50},{content:x(()=>[E(ue).taskId?(s(),M(Tr,{key:0,"task-id":E(ue).taskId,"project-id":E(ue).projectId,"project-users":E(ue).projectUsers,ref_key:"taskDetailSidebarRef",ref:o,onClose:E(Ne),onTaskUpdated:d[0]||(d[0]=e=>{n.$emit("taskUpdated",e)}),onTaskDeleted:d[1]||(d[1]=e=>{n.$emit("taskDeleted",e),E(Ne)()})},null,8,["task-id","project-id","project-users","onClose"])):E(ue).show?(s(),r("div",Ir," No task selected or task ID is missing. ")):k("",!0)]),footer:x(()=>[E(ue).taskId?(s(),r("div",Ar,[o.value&&o.value.task&&o.value.task.status!=="In Progress"&&o.value.task.status!=="Done"?(s(),M(Te,{key:0,onClick:o.value.startTask,class:"bg-blue-50 text-blue-700 hover:bg-blue-100"},{default:x(()=>d[2]||(d[2]=[I(" Start Task ",-1)])),_:1,__:[2]},8,["onClick"])):k("",!0),o.value&&o.value.task&&o.value.task.status==="In Progress"?(s(),M(Te,{key:1,onClick:o.value.completeTask,class:"bg-green-50 text-green-700 hover:bg-green-100"},{default:x(()=>d[3]||(d[3]=[I(" Complete Task ",-1)])),_:1,__:[3]},8,["onClick"])):k("",!0),o.value&&o.value.task?(s(),M(Le,{key:2,onClick:o.value.deleteTask,class:"bg-red-50 text-red-700 hover:bg-red-100"},{default:x(()=>d[4]||(d[4]=[I(" Delete Task ",-1)])),_:1,__:[4]},8,["onClick"])):k("",!0)])):k("",!0)]),_:1},8,["show","onUpdate:show","title"]))}},Dr={class:"flex h-screen overflow-hidden"},Er={class:"flex-1 flex flex-col overflow-hidden"},Mr={key:0,class:"bg-white shadow"},Pr={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},Nr={class:"flex-1 overflow-y-auto"},en={__name:"AuthenticatedLayout",setup(a){const o=D(!1),n=D(!1),d=D(!1),e=D([]),g=D(!0),u=B(()=>Ae().props.id||null),f=D(null),p=async()=>{const $=localStorage.getItem("authToken");if($){window.axios.defaults.headers.common.Authorization=`Bearer ${$}`;try{await window.axios.get("/api/user")}catch(h){h.response&&h.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},i=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization},w=$=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},c=async()=>{g.value=!0;try{const $=await window.axios.get("/api/projects-simplified");e.value=$.data}catch($){console.error("Error fetching all projects for sidebar:",$),e.value=[]}finally{g.value=!1}},C=$=>{kt.visit(route("projects.show",$))},T=B(()=>Se.value.notifications.filter($=>!$.isRead).length),S=$=>{console.log("Task updated globally.",$)},y=$=>{console.log("Task deleted globally.",$)};return ye(()=>{p(),f.value&&yt(f.value),c(),ht()}),($,h)=>(s(),r("div",Dr,[v(Gt,{ref_key:"standardNotificationContainerRef",ref:f},null,512),v(Bt,{"sidebar-is-open":E(Se).show},null,8,["sidebar-is-open"]),v(Is),v(yo,{"all-projects":e.value,"active-project-id":u.value,onProjectSelected:C},null,8,["all-projects","active-project-id"]),t("div",Er,[v(Ro,{"unread-notification-count":T.value,onOpenCreateTaskModal:h[0]||(h[0]=l=>n.value=!0),onOpenAddResource:h[1]||(h[1]=l=>d.value=!0),onOpenNotificationsSidebar:E(Fe)},null,8,["unread-notification-count","onOpenNotificationsSidebar"]),v(Zo,{"showing-navigation-dropdown":o.value,"unread-notification-count":T.value,onOpenCreateTaskModal:h[2]||(h[2]=l=>n.value=!0),onOpenAddResource:h[3]||(h[3]=l=>d.value=!0),onOpenNotificationsSidebar:E(Fe),onLogoutSuccess:i,onLogoutError:w},null,8,["showing-navigation-dropdown","unread-notification-count","onOpenNotificationsSidebar"]),$.$slots.header?(s(),r("header",Mr,[t("div",Pr,[re($.$slots,"header")])])):k("",!0),t("main",Nr,[re($.$slots,"default")]),v(ca,{show:n.value,onClose:h[4]||(h[4]=l=>n.value=!1),onSaved:h[5]||(h[5]=l=>n.value=!1)},null,8,["show"]),v(fa,{"api-endpoint":"/api/shareable-resources",show:d.value,onClose:h[6]||(h[6]=l=>d.value=!1)},null,8,["show"])]),v(jr,{onTaskUpdated:S,onTaskDeleted:y}),v(za)]))}};export{Me as B,fa as C,Xe as T,en as _,$s as a,Xr as b,Qr as c,kl as d,_l as e,Kr as f,$l as g,xl as h,bl as i,Sl as j,Il as k,He as l,Gs as m,ll as n,Zr as o,yl as p,ca as q,hl as r,gl as s,Gr as t,wl as u};
