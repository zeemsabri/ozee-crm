import{q as J,c as h,e as q,a as r,o as i,d as s,u as o,h as B,w as _,b as l,v as u,i as m,x as p,t as c,F as y,l as b,z as L,G as w,A as T,m as D}from"./app-BMAdU9Qd.js";import{_ as j}from"./AuthenticatedLayout-DDA0xL8J.js";import{_ as a}from"./InputLabel-Deo_vuuP.js";import{S as k}from"./SelectDropdown-h9AJnatN.js";import"./PrimaryButton-DgIqnz-l.js";import"./Modal-B9U3CUG2.js";import"./InputError-5P71FzEt.js";import"./SecondaryButton-C6FPdEqg.js";import"./index-DpQ4kyzd.js";import"./BaseFormModal-C24OoyIm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-BpX8G6w1.js";import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-B6byLR9E.js";import"./MultiSelectDropdown-CKPqBbme.js";import"./createLucideIcon-DBuSMijj.js";import"./plus-CWaPdADQ.js";import"./DangerButton-BN_Nq1a_.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-CAftfYCi.js";/* empty css                                                                       */const E={class:"flex items-center justify-between w-full"},Y={class:"py-6"},I={class:"mx-auto max-w-4xl sm:px-6 lg:px-8"},K={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},R={class:"p-6 text-gray-900 space-y-8"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},G={key:0,class:"text-sm text-red-600 mt-1"},H={key:0,class:"text-sm text-red-600 mt-1"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q={key:0},X=["min"],Z={key:0,class:"text-sm text-red-600 mt-1"},ee={key:1},te=["min"],oe={key:0,class:"text-sm text-red-600 mt-1"},le={key:2,class:"md:col-span-2"},de={class:"mt-2 flex flex-wrap gap-2"},ne=["value"],se={class:"ml-2 text-sm"},re={class:"flex gap-2"},ie=["value"],ae=["value"],ue={key:5,class:"md:col-span-2"},me={class:"p-4 rounded-md bg-gray-50 border border-gray-200 text-sm text-gray-800"},ce={class:"flex items-center justify-end gap-3"},pe=["disabled"],We={__name:"Create",props:{prefill:{type:Object,default:()=>({})},schedulableTypes:{type:Array,required:!0},tasks:{type:Array,required:!0},workflows:{type:Array,required:!0}},setup(M){function x(n=new Date){const t=O=>String(O).padStart(2,"0"),d=n.getFullYear(),g=t(n.getMonth()+1),V=t(n.getDate()),$=t(n.getHours()),v=t(n.getMinutes());return`${d}-${g}-${V}T${$}:${v}`}const f=M,e=J({name:"",description:"",scheduled_item_type:f.prefill.scheduled_item_type||"workflow",scheduled_item_id:f.prefill.scheduled_item_id||null,start_at:x(new Date),end_at:"",mode:"once",time:new Date().toTimeString().slice(0,5),days_of_week:[],day_of_month:null,nth:1,dow_for_monthly:1,month:1,cron:""}),F=h(()=>f.schedulableTypes),U=h(()=>String(e.scheduled_item_type).toLowerCase().includes("task")?f.tasks.map(n=>({id:n.id,name:n.name||`Task #${n.id}`})):f.workflows.map(n=>({id:n.id,name:n.name||`Workflow #${n.id}`})));q(()=>e.scheduled_item_type,()=>{e.scheduled_item_id=null});const C=[{value:"once",label:"Once"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"},{value:"cron",label:"Custom cron"}],S=h(()=>x(new Date)),A=h(()=>e.start_at||S.value),N=h(()=>{var t,d;const n=e.time||"00:00";switch(e.mode){case"once":return`One-time at ${(t=e.start_at)==null?void 0:t.replace("T"," ")} (deactivates after run)`;case"daily":return`Daily at ${n}`;case"weekly":if(!((d=e.days_of_week)!=null&&d.length))return`Weekly at ${n}`;const g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return`Weekly on ${e.days_of_week.map(v=>g[v]).join(", ")} at ${n}`;case"monthly":return e.day_of_month?`Monthly on day ${e.day_of_month} at ${n}`:`Monthly on the ${["First","Second","Third","Fourth","Fifth"][e.nth-1]} ${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.dow_for_monthly]} at ${n}`;case"yearly":return`Yearly on ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][(e.month||1)-1]} ${e.day_of_month||1} at ${n}`;case"cron":return`Custom cron: ${e.cron||"* * * * *"}`}});function W(){e.post(route("schedules.store"))}return(n,t)=>(i(),r(y,null,[s(o(B),{title:"Create Schedule"}),s(j,null,{header:_(()=>[l("div",E,[t[16]||(t[16]=l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Create Schedule",-1)),s(o(T),{href:n.route("schedules.index"),class:"text-sm text-indigo-600 hover:underline"},{default:_(()=>t[15]||(t[15]=[D("Back to list",-1)])),_:1,__:[15]},8,["href"])])]),default:_(()=>[l("div",Y,[l("div",I,[l("div",K,[l("div",R,[l("section",null,[t[17]||(t[17]=l("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"1. Basic Details",-1)),l("div",z,[l("div",null,[s(a,{value:"Schedule Name"}),u(l("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>o(e).name=d),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"e.g., Weekly workflow run"},null,512),[[p,o(e).name]]),o(e).errors.name?(i(),r("div",G,c(o(e).errors.name),1)):m("",!0)]),l("div",null,[s(a,{value:"Linked Type"}),s(k,{modelValue:o(e).scheduled_item_type,"onUpdate:modelValue":t[1]||(t[1]=d=>o(e).scheduled_item_type=d),options:F.value,placeholder:"Select type..."},null,8,["modelValue","options"])]),l("div",null,[s(a,{value:"Linked Item"}),s(k,{modelValue:o(e).scheduled_item_id,"onUpdate:modelValue":t[2]||(t[2]=d=>o(e).scheduled_item_id=d),options:U.value,valueKey:"id",labelKey:"name",placeholder:"Select item..."},null,8,["modelValue","options"]),o(e).errors.scheduled_item_id?(i(),r("div",H,c(o(e).errors.scheduled_item_id),1)):m("",!0)]),l("div",null,[s(a,{value:"Description (optional)"}),u(l("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>o(e).description=d),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"What will this schedule do?"},null,512),[[p,o(e).description]])])])]),l("section",null,[t[19]||(t[19]=l("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"2. Recurrence",-1)),l("div",P,[l("div",null,[s(a,{value:"Run"}),s(k,{modelValue:o(e).mode,"onUpdate:modelValue":t[4]||(t[4]=d=>o(e).mode=d),options:C,placeholder:"Select frequency..."},null,8,["modelValue"])]),o(e).mode!=="cron"&&o(e).mode!=="once"?(i(),r("div",Q,[s(a,{value:"Time"}),u(l("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>o(e).time=d),type:"time",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,o(e).time]])])):m("",!0),l("div",null,[s(a,{value:"Start at"}),u(l("input",{"onUpdate:modelValue":t[6]||(t[6]=d=>o(e).start_at=d),type:"datetime-local",min:S.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,8,X),[[p,o(e).start_at]]),o(e).errors.start_at?(i(),r("div",Z,c(o(e).errors.start_at),1)):m("",!0)]),o(e).mode!=="once"?(i(),r("div",ee,[s(a,{value:"End at (optional)"}),u(l("input",{"onUpdate:modelValue":t[7]||(t[7]=d=>o(e).end_at=d),type:"datetime-local",min:A.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,8,te),[[p,o(e).end_at]]),o(e).errors.end_at?(i(),r("div",oe,c(o(e).errors.end_at),1)):m("",!0)])):m("",!0),o(e).mode==="weekly"?(i(),r("div",le,[s(a,{value:"Days of the week"}),l("div",de,[(i(),r(y,null,b(7,d=>l("label",{key:d-1,class:"inline-flex items-center"},[u(l("input",{class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500",type:"checkbox",value:d-1,"onUpdate:modelValue":t[8]||(t[8]=g=>o(e).days_of_week=g)},null,8,ne),[[L,o(e).days_of_week]]),l("span",se,c(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d-1]),1)])),64))])])):m("",!0),o(e).mode==="monthly"?(i(),r(y,{key:3},[l("div",null,[s(a,{value:"Day of month"}),u(l("input",{"onUpdate:modelValue":t[9]||(t[9]=d=>o(e).day_of_month=d),type:"number",min:"1",max:"31",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"e.g., 15"},null,512),[[p,o(e).day_of_month,void 0,{number:!0}]])]),l("div",null,[s(a,{value:"Or: Nth weekday"}),l("div",re,[u(l("select",{"onUpdate:modelValue":t[10]||(t[10]=d=>o(e).nth=d),class:"mt-1 block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},t[18]||(t[18]=[l("option",{value:1},"First",-1),l("option",{value:2},"Second",-1),l("option",{value:3},"Third",-1),l("option",{value:4},"Fourth",-1),l("option",{value:5},"Fifth",-1)]),512),[[w,o(e).nth,void 0,{number:!0}]]),u(l("select",{"onUpdate:modelValue":t[11]||(t[11]=d=>o(e).dow_for_monthly=d),class:"mt-1 block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[(i(),r(y,null,b(7,d=>l("option",{key:d-1,value:d-1},c(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d-1]),9,ie)),64))],512),[[w,o(e).dow_for_monthly,void 0,{number:!0}]])])])],64)):m("",!0),o(e).mode==="yearly"?(i(),r(y,{key:4},[l("div",null,[s(a,{value:"Month"}),u(l("select",{"onUpdate:modelValue":t[12]||(t[12]=d=>o(e).month=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[(i(),r(y,null,b(12,d=>l("option",{key:d,value:d},c(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][d-1]),9,ae)),64))],512),[[w,o(e).month,void 0,{number:!0}]])]),l("div",null,[s(a,{value:"Day of month"}),u(l("input",{"onUpdate:modelValue":t[13]||(t[13]=d=>o(e).day_of_month=d),type:"number",min:"1",max:"31",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,o(e).day_of_month,void 0,{number:!0}]])])],64)):m("",!0),o(e).mode==="cron"?(i(),r("div",ue,[s(a,{value:"Cron expression"}),u(l("input",{"onUpdate:modelValue":t[14]||(t[14]=d=>o(e).cron=d),type:"text",placeholder:"* * * * *",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,o(e).cron]])])):m("",!0)])]),l("section",null,[t[20]||(t[20]=l("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"3. Confirmation",-1)),l("div",me,c(N.value),1)]),l("div",ce,[s(o(T),{href:n.route("schedules.index"),class:"px-4 py-2 rounded-md border border-gray-300 text-gray-700 bg-white hover:bg-gray-50"},{default:_(()=>t[21]||(t[21]=[D("Cancel",-1)])),_:1,__:[21]},8,["href"]),l("button",{onClick:W,disabled:o(e).processing,class:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"},c(o(e).processing?"Savingâ€¦":"Save Schedule"),9,pe)])])])])])]),_:1})],64))}};export{We as default};
