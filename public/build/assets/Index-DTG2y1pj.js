import{c as r,o as i,a as e,r as p,b as G,d as J,e as l,u as c,h as K,w as F,f as I,v as N,t as a,n as _,g as y,F as f,i as $,j as Q,k as D}from"./app-BB49X1tp.js";import{_ as X}from"./AuthenticatedLayout-CJntGdOY.js";import{_ as Y}from"./MultiSelectDropdown-Bhj_tQt_.js";import{r as P,_ as w,a as B}from"./ChartComponent-BCeR_ABL.js";import{r as L}from"./ClockIcon-50LTSSsl.js";import{r as R}from"./GlobeAltIcon-DX_GWknF.js";import{r as Z}from"./ListBulletIcon-BkVV6BCQ.js";import"./PrimaryButton-ByHbGtgS.js";import"./Modal-BhZEOuT6.js";import"./InputLabel-CF6SQJlm.js";import"./InputError-BYAWAWU2.js";import"./SecondaryButton-h9tD_s2q.js";import"./index-DHNLbyBN.js";import"./BaseFormModal-C1rPl9Vb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-B8kjVC_X.js";import"./SelectDropdown-Dd_bXZ8S.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./RightSidebar-D3M15iR-.js";import"./ApplicationLogo-m9x7uzgD.js";import"./createLucideIcon-bK6Z0bQ_.js";import"./plus-D8NgBDXz.js";import"./DangerButton-CmmvETjq.js";import"./moment-BLMuvzoS.js";import"./taskState-Dm-EQCFk.js";import"./NoticeboardModal-C9hb9LrZ.js";import"./x-CMzV8zv1.js";import"./auto-BIBwKD9g.js";import"./chart-DUfl3Dpl.js";function ee(E,g){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"})])}const te={class:"py-8 bg-gray-50 min-h-screen"},se={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},oe={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},ae={class:"grid grid-cols-1 md:grid-cols-5 gap-6 items-end"},le={class:"col-span-2"},re=["disabled"],ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},de={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm transition-all hover:shadow-md"},ne={class:"flex items-center justify-between mb-2"},ce={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm transition-all hover:shadow-md"},ue={class:"flex items-center justify-between mb-2"},pe={class:"text-3xl font-black text-blue-600"},me={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm transition-all hover:shadow-md"},xe={class:"flex items-center justify-between mb-2"},ge={class:"text-3xl font-black text-amber-600"},be={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm transition-all hover:shadow-md"},ve={class:"flex items-center justify-between mb-2"},_e=["title"],he={class:"text-[10px] text-gray-400 mt-2"},ye={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm transition-all hover:shadow-md"},fe={class:"flex items-center justify-between mb-2"},we={class:"text-3xl font-black text-pink-600"},ke={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm transition-all hover:shadow-md"},Ce={class:"flex items-center justify-between mb-2"},Ae={class:"text-3xl font-black text-gray-900"},Te={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},$e={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm"},De={class:"text-sm font-bold text-gray-900 mb-6 flex items-center"},je={class:"h-[300px]"},Me={class:"mt-4 space-y-2"},Ve={class:"flex items-center gap-2"},Se={class:"font-medium"},Ue={class:"text-gray-600"},Fe={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm"},Ie={class:"text-sm font-bold text-gray-900 mb-6 flex items-center"},Ne={class:"h-[300px]"},Pe={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm"},Be={class:"text-sm font-bold text-gray-900 mb-6 flex items-center"},Le={class:"h-[300px]"},Re={class:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm"},Ee={class:"text-sm font-bold text-gray-900 mb-6 flex items-center"},Oe={class:"h-[300px]"},ze={class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},He={class:"overflow-x-auto"},We={class:"w-full text-sm text-left"},qe={class:"divide-y divide-gray-100"},Ge=["title"],Je={class:"px-6 py-4"},Ke={class:"flex items-center space-x-3"},Qe={key:0,class:"h-6 w-6 rounded-full overflow-hidden bg-gray-100"},Xe=["src"],Ye={key:1,class:"h-6 w-6 rounded-full bg-indigo-100 flex items-center justify-center text-[10px] font-bold text-indigo-600 uppercase"},Ze={class:"font-medium text-gray-900 text-xs"},et={class:"px-6 py-4"},tt={class:"bg-blue-50 text-blue-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-tight"},st={class:"px-6 py-4 relative"},ot={class:"relative inline-block"},at=["onClick"],lt={key:1,class:"text-gray-400 text-xs"},rt={key:2,class:"absolute z-50 mt-1 w-40 bg-white border border-gray-200 rounded-lg shadow-lg"},it=["onClick"],dt=["title"],nt={class:"flex items-center gap-2"},ct={key:0,class:"text-gray-400",title:"Incognito Mode"},ut={class:"px-6 py-4 text-center"},pt={class:"px-6 py-4 whitespace-nowrap"},mt={class:"text-emerald-600 font-black text-xs"},xt={key:0},qt={__name:"Index",setup(E){const g=p([]),m=p({total_hours:0,total_minutes:0,total_events:0,top_domain:"-",top_domain_time:0}),d=p({score:0,productive_time:0,unproductive_time:0,idle_time:0,social_media_time:0,active_time:0}),n=p({domain_dist:[],hourly_trend:[],category_breakdown:[],idle_breakdown:[]}),j=p([]),b=p(!1),v=p(null),O=[{value:"productive",label:"Productive"},{value:"development",label:"Development"},{value:"communication",label:"Communication"},{value:"social_media",label:"Social Media"},{value:"neutral",label:"Neutral"},{value:"unproductive",label:"Unproductive"}],k=p([]),C=p(new Date().toISOString().split("T")[0]),A=p(new Date().toISOString().split("T")[0]),T=async()=>{b.value=!0;try{const o=await window.axios.get("/api/activity-report",{params:{user_ids:k.value.join(","),date_start:C.value,date_end:A.value}});g.value=o.data.activities,m.value=o.data.stats,d.value=o.data.productivity||d.value,n.value=o.data.charts,j.value=o.data.users}catch(o){console.error(o)}finally{b.value=!1}},z=o=>{if(!o)return"0s";const s=Math.floor(o/3600),t=Math.floor(o%3600/60),x=o%60;return s>0?`${s}h ${t}m`:t>0?`${t}m ${x}s`:`${x}s`},H=o=>new Date(o).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),W=o=>{v.value=v.value===o?null:o},q=async(o,s)=>{try{const t=await window.axios.patch(`/api/activities/${o}/category`,{category:s}),x=g.value.find(h=>h.id===o);x&&(x.category=s),v.value=null,await T()}catch(t){console.error("Failed to update category:",t),alert("Failed to update category. Please try again.")}},M=o=>{o.target.closest(".relative.inline-block")||(v.value=null)};return G(()=>{T(),document.addEventListener("click",M)}),J(()=>{document.removeEventListener("click",M)}),(o,s)=>(i(),r(f,null,[l(c(K),{title:"Activity Report"}),l(X,null,{header:F(()=>s[3]||(s[3]=[e("div",{class:"flex justify-between items-center"},[e("h2",{class:"font-bold text-2xl text-gray-900 tracking-tight"},"Activity Dashboard"),e("div",{class:"text-sm text-gray-500"},"Productivity telemetry & reporting")],-1)])),default:F(()=>[e("div",te,[e("div",se,[e("div",oe,[e("div",ae,[e("div",le,[s[4]||(s[4]=e("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Team Members",-1)),l(Y,{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=t=>k.value=t),options:j.value,"is-multi":!0,placeholder:"All Users"},null,8,["modelValue","options"])]),e("div",null,[s[5]||(s[5]=e("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"From",-1)),I(e("input",{type:"date","onUpdate:modelValue":s[1]||(s[1]=t=>C.value=t),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-indigo-500"},null,512),[[N,C.value]])]),e("div",null,[s[6]||(s[6]=e("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"To",-1)),I(e("input",{type:"date","onUpdate:modelValue":s[2]||(s[2]=t=>A.value=t),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-indigo-500"},null,512),[[N,A.value]])]),e("button",{onClick:T,disabled:b.value,class:"w-full bg-indigo-600 text-white font-bold py-2.5 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50"},a(b.value?"Filtering...":"Filter"),9,re)])]),e("div",ie,[e("div",de,[e("div",ne,[l(c(P),{class:_(["h-8 w-8 opacity-80",{"text-green-500":d.value.score>=70,"text-yellow-500":d.value.score>=50&&d.value.score<70,"text-red-500":d.value.score<50}])},null,8,["class"]),s[7]||(s[7]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"Productivity Score",-1))]),e("div",{class:_(["text-3xl font-black",{"text-green-600":d.value.score>=70,"text-yellow-600":d.value.score>=50&&d.value.score<70,"text-red-600":d.value.score<50}])},a(d.value.score)+"%",3),s[8]||(s[8]=e("p",{class:"text-[10px] text-gray-400 mt-2"},"Weighted productivity index",-1))]),e("div",ce,[e("div",ue,[l(c(L),{class:"h-8 w-8 text-blue-500 opacity-80"}),s[9]||(s[9]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"Total Active Time",-1))]),e("div",pe,a(m.value.total_hours>0?m.value.total_hours+" hrs":m.value.total_minutes+" mins"),1),s[10]||(s[10]=e("p",{class:"text-[10px] text-gray-400 mt-2"},"Aggregated active sessions",-1))]),e("div",me,[e("div",xe,[l(c(L),{class:"h-8 w-8 text-amber-500 opacity-80"}),s[11]||(s[11]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"Idle Time",-1))]),e("div",ge,a(d.value.idle_time)+" mins",1),s[12]||(s[12]=e("p",{class:"text-[10px] text-gray-400 mt-2"},"Away from keyboard",-1))]),e("div",be,[e("div",ve,[l(c(R),{class:"h-8 w-8 text-indigo-500 opacity-80"}),s[13]||(s[13]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"Top Domain",-1))]),e("div",{class:"text-2xl font-black text-gray-900 truncate",title:m.value.top_domain},a(m.value.top_domain),9,_e),e("p",he,a(m.value.top_domain_time)+" mins total",1)]),e("div",ye,[e("div",fe,[l(c(ee),{class:"h-8 w-8 text-pink-500 opacity-80"}),s[14]||(s[14]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"Social Media",-1))]),e("div",we,a(d.value.social_media_time)+" mins",1),s[15]||(s[15]=e("p",{class:"text-[10px] text-gray-400 mt-2"},"Facebook, Instagram, etc.",-1))]),e("div",ke,[e("div",Ce,[l(c(Z),{class:"h-8 w-8 text-purple-500 opacity-80"}),s[16]||(s[16]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"Activity Sessions",-1))]),e("div",Ae,a(m.value.total_events),1),s[17]||(s[17]=e("p",{class:"text-[10px] text-gray-400 mt-2"},"Continuous domain blocks",-1))])]),e("div",Te,[e("div",$e,[e("h3",De,[l(c(P),{class:"h-4 w-4 mr-2 text-green-600"}),s[18]||(s[18]=y(" Productivity Breakdown ",-1))]),e("div",je,[l(w,{data:{labels:n.value.category_breakdown.map(t=>t.label),datasets:[{data:n.value.category_breakdown.map(t=>t.duration),backgroundColor:n.value.category_breakdown.map(t=>t.color)}]},type:"pie",height:"300"},null,8,["data"])]),e("div",Me,[(i(!0),r(f,null,$(n.value.category_breakdown,t=>(i(),r("div",{key:t.category,class:"flex items-center justify-between text-xs"},[e("div",Ve,[e("div",{class:"w-3 h-3 rounded-full",style:Q({backgroundColor:t.color})},null,4),e("span",Se,a(t.label),1)]),e("span",Ue,a(t.duration)+" mins ("+a(t.percentage)+"%)",1)]))),128))])]),e("div",Fe,[e("h3",Ie,[l(c(B),{class:"h-4 w-4 mr-2 text-blue-600"}),s[19]||(s[19]=y(" Idle vs Active Timeline ",-1))]),e("div",Ne,[l(w,{data:{labels:n.value.idle_breakdown.map(t=>t.hour),datasets:[{label:"Active",data:n.value.idle_breakdown.map(t=>t.active),backgroundColor:"#10b981",borderRadius:4},{label:"Idle",data:n.value.idle_breakdown.map(t=>t.idle),backgroundColor:"#f59e0b",borderRadius:4}]},type:"bar",height:"300","y-label":"Minutes",options:{scales:{x:{stacked:!0},y:{stacked:!0}}}},null,8,["data"])])]),e("div",Pe,[e("h3",Be,[l(c(R),{class:"h-4 w-4 mr-2 text-indigo-600"}),s[20]||(s[20]=y(" Time Spent by Domain (Minutes) ",-1))]),e("div",Le,[l(w,{data:{labels:n.value.domain_dist.map(t=>t.label),datasets:[{data:n.value.domain_dist.map(t=>t.value),backgroundColor:["#3b82f6","#10b981","#f59e0b","#6366f1","#ec4899","#f43f5e","#8b5cf6","#06b6d4","#84cc16","#f97316"]}]},type:"pie",height:"300"},null,8,["data"])])]),e("div",Re,[e("h3",Ee,[l(c(B),{class:"h-4 w-4 mr-2 text-blue-600"}),s[21]||(s[21]=y(" Activity Timeline (Minutes Active) ",-1))]),e("div",Oe,[l(w,{data:{labels:n.value.hourly_trend.map(t=>t.label),datasets:[{label:"Minutes Active",data:n.value.hourly_trend.map(t=>t.value),backgroundColor:"#3b82f6",borderRadius:4}]},type:"bar",height:"300","y-label":"Minutes"},null,8,["data"])])])]),e("div",ze,[s[24]||(s[24]=e("div",{class:"px-6 py-4 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between"},[e("h3",{class:"text-sm font-bold text-gray-900"},"Activity Log & Durations")],-1)),e("div",He,[e("table",We,[s[23]||(s[23]=e("thead",{class:"bg-gray-50 text-[10px] uppercase font-bold text-gray-500 tracking-wider"},[e("tr",null,[e("th",{class:"px-6 py-3"},"Time"),e("th",{class:"px-6 py-3"},"User"),e("th",{class:"px-6 py-3"},"Domain"),e("th",{class:"px-6 py-3"},"Category"),e("th",{class:"px-6 py-3"},"Page Title"),e("th",{class:"px-6 py-3 text-center"},"Status"),e("th",{class:"px-6 py-3"},"Duration")])],-1)),e("tbody",qe,[(i(!0),r(f,null,$(g.value,t=>{var x,h,V,S,U;return i(),r("tr",{key:t.id,class:"hover:bg-gray-50 transition"},[e("td",{class:"px-6 py-4 whitespace-nowrap text-gray-500 font-mono text-xs",title:t.local_time},a(t.local_time_formatted||H(t.recorded_at)),9,Ge),e("td",Je,[e("div",Ke,[(x=t.user)!=null&&x.avatar||(h=t.user)!=null&&h.avatar_url?(i(),r("div",Qe,[e("img",{src:t.user.avatar||t.user.avatar_url,class:"w-full h-full object-cover"},null,8,Xe)])):(i(),r("div",Ye,a(((S=(V=t.user)==null?void 0:V.name)==null?void 0:S.charAt(0))||"?"),1)),e("span",Ze,a(((U=t.user)==null?void 0:U.name)||"Unknown"),1)])]),e("td",et,[e("span",tt,a(t.domain),1)]),e("td",st,[e("div",ot,[t.category?(i(),r("button",{key:0,onClick:u=>W(t.id),class:_(["text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-tight cursor-pointer hover:opacity-80 transition-opacity",{"bg-green-100 text-green-700":t.category==="productive"||t.category==="development","bg-purple-100 text-purple-700":t.category==="communication","bg-pink-100 text-pink-700":t.category==="social_media","bg-gray-100 text-gray-700":t.category==="neutral","bg-red-100 text-red-700":t.category==="unproductive"}])},a(t.category)+" ‚ñæ ",11,at)):(i(),r("span",lt,"-")),v.value===t.id?(i(),r("div",rt,[(i(),r(f,null,$(O,u=>e("button",{key:u.value,onClick:gt=>q(t.id,u.value),class:_(["w-full text-left px-3 py-2 text-xs hover:bg-gray-50 first:rounded-t-lg last:rounded-b-lg transition-colors",{"bg-green-50":u.value==="productive"||u.value==="development","bg-purple-50":u.value==="communication","bg-pink-50":u.value==="social_media","bg-gray-50":u.value==="neutral","bg-red-50":u.value==="unproductive"}])},a(u.label),11,it)),64))])):D("",!0)])]),e("td",{class:"px-6 py-4 max-w-xs truncate text-xs text-gray-600",title:t.title},[e("div",nt,[t.is_incognito?(i(),r("span",ct,"üï∂Ô∏è")):D("",!0),e("span",null,a(t.title),1)])],8,dt),e("td",ut,[e("span",{class:_({"px-2 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-tight":!0,"bg-green-100 text-green-700":t.idle_state==="active","bg-amber-100 text-amber-700":t.idle_state==="idle","bg-gray-100 text-gray-700":!t.idle_state||t.idle_state==="locked"||t.idle_state==="unknown"})},a(t.idle_state||"unknown"),3)]),e("td",pt,[e("span",mt,a(z(t.duration)),1)])])}),128)),g.value.length===0&&!b.value?(i(),r("tr",xt,s[22]||(s[22]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-400 italic"}," No activity data found for the selected filters. ",-1)]))):D("",!0)])])])])])])]),_:1})],64))}};export{qt as default};
