import{l as ne,B as $e,m as Nt,T as Rt,n as Ut,o as Ht,q as Bt,j as Ft,t as Wt,_ as Yt,v as zt}from"./AuthenticatedLayout-mfsQD7_b.js";import{i as r,o as n,b as e,r as b,B as ke,F as J,j as te,g as x,t as h,m as Y,ao as Me,e as v,ap as Ke,a as F,A as le,c as ae,aq as nt,X as ot,p as X,D as we,T as Be,ar as K,H as qt,S as Fe,as as Zt,d as _e,z as Te,w as ce,s as H,f as ve,k as xe,v as We,h as q,G as Gt,l as rt,at as dt,Z as ht,ae as Kt,$ as Jt,_ as Xt,Q as gt,R as Je,a8 as Ye,x as ut,P as Qt,an as es,a0 as ts,al as ss,y as as,ak as ls,O as is,a1 as ns}from"./app-BSeMfoFV.js";import{c as be,a as qe,d as Ue,f as Re,b as os,_ as rs}from"./ProjectForm-Cp12xb3z.js";import{_ as Se}from"./Modal-CzyC_oTL.js";import{P as pe}from"./PrimaryButton-CJ-b3v1B.js";import{b as ft,_ as yt,a as wt}from"./TaskList-a5Axe5G9.js";import{_ as G}from"./InputLabel-MJT-MjwL.js";import{_ as me}from"./TextInput-Dt5gLS55.js";import{_ as oe}from"./InputError-BJQV9eVu.js";import{O as Xe,b as ds,u as us,_ as cs,E as ms,a as vs}from"./ComposeEmailModal-3jCe_RuP.js";import{S as ge}from"./SelectDropdown-DiFWJwfS.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as fe}from"./SecondaryButton-DvCHf0P4.js";import{_ as ps}from"./EmailEditor-D5vcOXOe.js";import{_ as hs}from"./EmailList-D4SeMUYK.js";import"./Checkbox-NkHLObuP.js";import"./ApplicationLogo-Dho8VhDz.js";import"./DangerButton-BGKTdFYZ.js";import"./ProjectTypeInput-ClpWJiHM.js";function gs(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}function fs(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}function ys(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M9.47 6.47a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 1 1-1.06 1.06L10 8.06l-3.72 3.72a.75.75 0 0 1-1.06-1.06l4.25-4.25Z","clip-rule":"evenodd"})])}function ws(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"m2.695 14.762-1.262 3.155a.5.5 0 0 0 .65.65l3.155-1.262a4 4 0 0 0 1.343-.886L17.5 5.501a2.121 2.121 0 0 0-3-3L3.58 13.419a4 4 0 0 0-.885 1.343Z"})])}const bs={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},_s={key:0,class:"text-sm text-gray-500"},xs={key:1,class:"text-sm text-gray-500"},ks={key:2,class:"space-y-3"},Ds={class:"flex justify-between items-start"},Cs={class:"font-medium text-gray-900"},Ts={class:"text-sm text-gray-600"},Es={key:0,class:"text-sm text-gray-600 mt-1"},Ms={class:"flex space-x-2"},Ss=["href"],js=["href"],$s=["onClick"],Vs={__name:"ProjectMeetingsList",props:{projectId:{type:Number,required:!0}},setup(s,{expose:t}){const a=s,i=b([]),o=b(!1),l=b(""),u=()=>{try{l.value=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(w){console.error("Error detecting user timezone:",w),l.value="UTC"}},d=(w,y=null,E=!1)=>{if(!w)return"";try{if(E||w.endsWith("Z")){if(y&&y===l.value){const S={dateStyle:"medium",timeStyle:"short"};return new Date(w).toLocaleString(void 0,S)}const k={dateStyle:"medium",timeStyle:"short",timeZone:y||l.value};return new Date(w).toLocaleString(void 0,k)}else{if(y&&y===l.value){const S={dateStyle:"medium",timeStyle:"short"};return new Date(w).toLocaleString(void 0,S)}const k={dateStyle:"medium",timeStyle:"short",timeZone:y||l.value};return new Date(w).toLocaleString(void 0,k)}}catch(k){return console.error("Error formatting meeting time:",k),new Date(w).toLocaleString()}},m=(w,y=null,E=!1)=>{if(!w)return"";try{if(E||w.endsWith("Z")){if(y&&y===l.value){const S={timeStyle:"short"};return new Date(w).toLocaleTimeString(void 0,S)}const k={timeStyle:"short",timeZone:y||l.value};return new Date(w).toLocaleTimeString(void 0,k)}else{if(y&&y===l.value){const S={timeStyle:"short"};return new Date(w).toLocaleTimeString(void 0,S)}const k={timeStyle:"short",timeZone:y||l.value};return new Date(w).toLocaleTimeString(void 0,k)}}catch(k){return console.error("Error formatting meeting time (time only):",k),new Date(w).toLocaleTimeString()}},c=async()=>{o.value=!0;try{const w=await window.axios.get(`/api/projects/${a.projectId}/meetings`);i.value=w.data}catch(w){console.error("Error fetching project meetings:",w)}finally{o.value=!1}},p=async w=>{if(confirm("Are you sure you want to delete this meeting?"))try{await window.axios.delete(`/api/projects/${a.projectId}/meetings/${w}`),await c()}catch(y){console.error("Error deleting meeting:",y),alert("Failed to delete meeting. Please try again.")}};return t({fetchMeetings:c}),ke(()=>{u(),c()}),(w,y)=>(n(),r("div",bs,[y[4]||(y[4]=e("h4",{class:"text-md font-semibold text-gray-900 mb-2"},"Upcoming Meetings",-1)),o.value?(n(),r("div",_s," Loading meetings... ")):i.value.length===0?(n(),r("div",xs," No upcoming meetings scheduled. ")):(n(),r("div",ks,[(n(!0),r(J,null,te(i.value,E=>(n(),r("div",{key:E.id,class:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[e("div",Ds,[e("div",null,[e("h5",Cs,h(E.summary),1),e("p",Ts,h(d(E.start_time,E.timezone,E.is_utc))+" - "+h(m(E.end_time,E.timezone,E.is_utc)),1),E.location?(n(),r("p",Es,[y[0]||(y[0]=e("span",{class:"font-medium"},"Location:",-1)),Y(" "+h(E.location),1)])):x("",!0)]),e("div",Ms,[e("a",{href:E.google_event_link,target:"_blank",class:"text-blue-600 hover:text-blue-800",title:"View in Google Calendar"},y[1]||(y[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]),8,Ss),E.google_meet_link?(n(),r("a",{key:0,href:E.google_meet_link,target:"_blank",class:"text-green-600 hover:text-green-800",title:"Join Google Meet"},y[2]||(y[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,js)):x("",!0),e("button",{onClick:k=>p(E.google_event_id),class:"text-red-600 hover:text-red-800",title:"Delete Meeting"},y[3]||(y[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,$s)])])]))),128))]))]))}};var As=Object.defineProperty,Os=(s,t,a)=>t in s?As(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,De=(s,t,a)=>Os(s,typeof t!="symbol"?t+"":t,a);const Ls=(s,t,a)=>{const i=s[t];return i?typeof i=="function"?i():Promise.resolve(i):new Promise((o,l)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(l.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==a?". Note that variables only represent file names one level deep.":""))))})};let Ie,ct,mt,ye,Pe={},je={};class Is{constructor(t,a=!1){De(this,"texts",{}),De(this,"dateToMinutes",i=>i.getHours()*60+i.getMinutes()),ye=this,this._texts=t,!a&&Date&&!Date.prototype.addDays&&this._initDatePrototypes()}_initDatePrototypes(){Date.prototype.addDays=function(t){return ye.addDays(this,t)},Date.prototype.subtractDays=function(t){return ye.subtractDays(this,t)},Date.prototype.addHours=function(t){return ye.addHours(this,t)},Date.prototype.subtractHours=function(t){return ye.subtractHours(this,t)},Date.prototype.addMinutes=function(t){return ye.addMinutes(this,t)},Date.prototype.subtractMinutes=function(t){return ye.subtractMinutes(this,t)},Date.prototype.getWeek=function(){return ye.getWeek(this)},Date.prototype.isToday=function(){return ye.isToday(this)},Date.prototype.isLeapYear=function(){return ye.isLeapYear(this)},Date.prototype.format=function(t="YYYY-MM-DD"){return ye.formatDate(this,t)},Date.prototype.formatTime=function(t="HH:mm"){return ye.formatTime(this,t)}}removePrototypes(){delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime}updateTexts(t){this._texts=t}_todayFormatted(){return ct!==new Date().getDate()&&(Ie=new Date,ct=Ie.getDate(),mt=`${Ie.getFullYear()}-${Ie.getMonth()}-${Ie.getDate()}`),mt}addDays(t,a){const i=new Date(t.valueOf());return i.setDate(i.getDate()+a),i}subtractDays(t,a){const i=new Date(t.valueOf());return i.setDate(i.getDate()-a),i}addHours(t,a){const i=new Date(t.valueOf());return i.setHours(i.getHours()+a),i}subtractHours(t,a){const i=new Date(t.valueOf());return i.setHours(i.getHours()-a),i}addMinutes(t,a){const i=new Date(t.valueOf());return i.setMinutes(i.getMinutes()+a),i}subtractMinutes(t,a){const i=new Date(t.valueOf());return i.setMinutes(i.getMinutes()-a),i}getWeek(t){const a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),i=a.getUTCDay()||7;a.setUTCDate(a.getUTCDate()+4-i);const o=new Date(Date.UTC(a.getUTCFullYear(),0,1));return Math.ceil(((a-o)/864e5+1)/7)}isToday(t){return`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`===this._todayFormatted()}isLeapYear(t){const a=t.getFullYear();return!(a%400)||a%100&&!(a%4)}getPreviousFirstDayOfWeek(t=null,a){const i=t&&new Date(t.valueOf())||new Date,o=a?7:6;return i.setDate(i.getDate()-(i.getDay()+o)%7),i}stringToDate(t){return t instanceof Date?t:(t.length===10&&(t+=" 00:00"),new Date(t.replace(/-/g,"/")))}countDays(t,a){typeof t=="string"&&(t=t.replace(/-/g,"/")),typeof a=="string"&&(a=a.replace(/-/g,"/")),t=new Date(t).setHours(0,0,0,0),a=new Date(a).setHours(0,0,1,0);const i=(new Date(a).getTimezoneOffset()-new Date(t).getTimezoneOffset())*60*1e3;return Math.ceil((a-t-i)/(24*3600*1e3))}datesInSameTimeStep(t,a,i){return Math.abs(t.getTime()-a.getTime())<=i*60*1e3}formatDate(t,a="YYYY-MM-DD",i=null){if(i||(i=this._texts),a||(a="YYYY-MM-DD"),a==="YYYY-MM-DD")return this.formatDateLite(t);Pe={},je={};const o={YYYY:()=>this._hydrateDateObject(t,i).YYYY,YY:()=>this._hydrateDateObject(t,i).YY(),M:()=>this._hydrateDateObject(t,i).M,MM:()=>this._hydrateDateObject(t,i).MM(),MMM:()=>this._hydrateDateObject(t,i).MMM(),MMMM:()=>this._hydrateDateObject(t,i).MMMM(),MMMMG:()=>this._hydrateDateObject(t,i).MMMMG(),D:()=>this._hydrateDateObject(t,i).D,DD:()=>this._hydrateDateObject(t,i).DD(),S:()=>this._hydrateDateObject(t,i).S(),d:()=>this._hydrateDateObject(t,i).d,dd:()=>this._hydrateDateObject(t,i).dd(),ddd:()=>this._hydrateDateObject(t,i).ddd(),dddd:()=>this._hydrateDateObject(t,i).dddd(),HH:()=>this._hydrateTimeObject(t,i).HH,H:()=>this._hydrateTimeObject(t,i).H,hh:()=>this._hydrateTimeObject(t,i).hh,h:()=>this._hydrateTimeObject(t,i).h,am:()=>this._hydrateTimeObject(t,i).am,AM:()=>this._hydrateTimeObject(t,i).AM,mm:()=>this._hydrateTimeObject(t,i).mm,m:()=>this._hydrateTimeObject(t,i).m};return a.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(l,u)=>{const d=o[u.replace(/\{|\}/g,"")];return d!==void 0?d():u})}formatDateLite(t){const a=t.getMonth()+1,i=t.getDate();return`${t.getFullYear()}-${a<10?"0":""}${a}-${i<10?"0":""}${i}`}formatTime(t,a="HH:mm",i=null,o=!1){let l=!1;if(o){const[m,c,p]=[t.getHours(),t.getMinutes(),t.getSeconds()];m+c+p===141&&(l=!0)}if(t instanceof Date&&a==="HH:mm")return l?"24:00":this.formatTimeLite(t);je={},i||(i=this._texts);const u=this._hydrateTimeObject(t,i),d=a.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(m,c)=>{const p=u[c.replace(/\{|\}/g,"")];return p!==void 0?p:c});return l?d.replace("23:59","24:00"):d}formatTimeLite(t){const a=t.getHours(),i=t.getMinutes();return`${(a<10?"0":"")+a}:${(i<10?"0":"")+i}`}_nth(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}_hydrateDateObject(t,a){if(Pe.D)return Pe;const i=t.getFullYear(),o=t.getMonth()+1,l=t.getDate(),d=(t.getDay()-1+7)%7;return Pe={YYYY:i,YY:()=>i.toString().substring(2),M:o,MM:()=>(o<10?"0":"")+o,MMM:()=>a.months[o-1].substring(0,3),MMMM:()=>a.months[o-1],MMMMG:()=>(a.monthsGenitive||a.months)[o-1],D:l,DD:()=>(l<10?"0":"")+l,S:()=>this._nth(l),d:d+1,dd:()=>a.weekDays[d][0],ddd:()=>a.weekDays[d].substr(0,3),dddd:()=>a.weekDays[d]},Pe}_hydrateTimeObject(t,a){if(je.am)return je;let i,o;t instanceof Date?(i=t.getHours(),o=t.getMinutes()):(i=Math.floor(t/60),o=Math.floor(t%60));const l=i%12?i%12:12,u=(a||{am:"am",pm:"pm"})[i===24||i<12?"am":"pm"];return je={H:i,h:l,HH:(i<10?"0":"")+i,hh:(l<10?"0":"")+l,am:u,AM:u.toUpperCase(),m:o,mm:(o<10?"0":"")+o},je}}const Ps=1440;class Ns{constructor(t){De(this,"_vuecal",null),De(this,"selectCell",(a=!1,i,o)=>{this._vuecal.$emit("cell-click",o?{date:i,split:o}:i),this._vuecal.clickToNavigate||a?this._vuecal.switchToNarrowerView():this._vuecal.dblclickToNavigate&&"ontouchstart"in window&&(this._vuecal.domEvents.dblTapACell.taps++,setTimeout(()=>this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.domEvents.dblTapACell.timeout),this._vuecal.domEvents.dblTapACell.taps>=2&&(this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.switchToNarrowerView(),this._vuecal.$emit("cell-dblclick",o?{date:i,split:o}:i)))}),De(this,"keyPressEnterCell",(a,i)=>{this._vuecal.$emit("cell-keypress-enter",i?{date:a,split:i}:a),this._vuecal.switchToNarrowerView()}),De(this,"getPosition",a=>{const{left:i,top:o}=this._vuecal.cellsEl.getBoundingClientRect(),{clientX:l,clientY:u}="ontouchstart"in window&&a.touches?a.touches[0]:a;return{x:l-i,y:u-o}}),De(this,"minutesAtCursor",a=>{let i=0,o={x:0,y:0};const{timeStep:l,timeCellHeight:u,timeFrom:d}=this._vuecal.$props;return typeof a=="number"?i=a:typeof a=="object"&&(o=this.getPosition(a),i=Math.round(o.y*l/parseInt(u)+d)),{minutes:Math.max(Math.min(i,Ps),0),cursorCoords:o}}),this._vuecal=t}}const Rs=2,Ze=1440;let de,ue,Ge;class Us{constructor(t,a){De(this,"_vuecal",null),De(this,"eventDefaults",{_eid:null,start:"",startTimeMinutes:0,end:"",endTimeMinutes:0,title:"",content:"",background:!1,allDay:!1,segments:null,repeat:null,daysCount:1,deletable:!0,deleting:!1,titleEditable:!0,resizable:!0,resizing:!1,draggable:!0,dragging:!1,draggingStatic:!1,focused:!1,class:""}),this._vuecal=t,de=a}createAnEvent(t,a,i){if(typeof t=="string"&&(t=de.stringToDate(t)),!(t instanceof Date))return!1;const o=de.dateToMinutes(t);a=a*1||Rs*60;const l=o+a,u=de.addMinutes(new Date(t),a);i.end&&(typeof i.end=="string"&&(i.end=de.stringToDate(i.end)),i.endTimeMinutes=de.dateToMinutes(i.end));const d={...this.eventDefaults,_eid:`${this._vuecal._.uid}_${this._vuecal.eventIdIncrement++}`,start:t,startTimeMinutes:o,end:u,endTimeMinutes:l,segments:null,...i};if(!(typeof this._vuecal.onEventCreate=="function"&&!this._vuecal.onEventCreate(d,()=>this.deleteAnEvent(d))))return d.startDateF!==d.endDateF&&(d.daysCount=de.countDays(d.start,d.end)),this._vuecal.mutableEvents.push(d),this._vuecal.addEventsToView([d]),this._vuecal.emitWithEvent("event-create",d),this._vuecal.$emit("event-change",{event:this._vuecal.cleanupEvent(d),originalEvent:null}),d}addEventSegment(t){t.segments||(t.segments={},t.segments[de.formatDateLite(t.start)]={start:t.start,startTimeMinutes:t.startTimeMinutes,endTimeMinutes:Ze,isFirstDay:!0,isLastDay:!1});const a=t.segments[de.formatDateLite(t.end)];a&&(a.isLastDay=!1,a.endTimeMinutes=Ze);const i=de.addDays(t.end,1),o=de.formatDateLite(i);return i.setHours(0,0,0,0),t.segments[o]={start:i,startTimeMinutes:0,endTimeMinutes:t.endTimeMinutes,isFirstDay:!1,isLastDay:!0},t.end=de.addMinutes(i,t.endTimeMinutes),t.daysCount=Object.keys(t.segments).length,o}removeEventSegment(t){let a=Object.keys(t.segments).length;if(a<=1)return de.formatDateLite(t.end);delete t.segments[de.formatDateLite(t.end)],a--;const i=de.subtractDays(t.end,1),o=de.formatDateLite(i),l=t.segments[o];return a?l&&(l.isLastDay=!0,l.endTimeMinutes=t.endTimeMinutes):t.segments=null,t.daysCount=a||1,t.end=i,o}createEventSegments(t,a,i){const o=a.getTime(),l=i.getTime();let u=t.start.getTime(),d=t.end.getTime(),m=!1,c,p,w;for(!t.end.getHours()&&!t.end.getMinutes()&&(d-=1e3),t.segments={},t.repeat?(c=o,p=Math.min(l,t.repeat.until?de.stringToDate(t.repeat.until).getTime():l)):(c=Math.max(o,u),p=Math.min(l,d));c<=p;){let y=!1;const E=de.addDays(new Date(c),1).setHours(0,0,0,0);let k,S,g,M;if(t.repeat){const O=new Date(c),R=de.formatDateLite(O);(m||t.occurrences&&t.occurrences[R])&&(m||(u=t.occurrences[R].start,w=new Date(u).setHours(0,0,0,0),d=t.occurrences[R].end),m=!0,y=!0),k=c===w,S=R===de.formatDateLite(new Date(d)),g=new Date(k?u:c),M=de.formatDateLite(g),S&&(m=!1)}else y=!0,k=c===u,S=p===d&&E>p,g=k?t.start:new Date(c),M=de.formatDateLite(k?t.start:g);y&&(t.segments[M]={start:g,startTimeMinutes:k?t.startTimeMinutes:0,endTimeMinutes:S?t.endTimeMinutes:Ze,isFirstDay:k,isLastDay:S}),c=E}return t}deleteAnEvent(t){this._vuecal.emitWithEvent("event-delete",t),this._vuecal.mutableEvents=this._vuecal.mutableEvents.filter(a=>a._eid!==t._eid),this._vuecal.view.events=this._vuecal.view.events.filter(a=>a._eid!==t._eid)}checkCellOverlappingEvents(t,a){Ge=t.slice(0),ue={},t.forEach(o=>{Ge.shift(),ue[o._eid]||(ue[o._eid]={overlaps:[],start:o.start,position:0}),ue[o._eid].position=0,Ge.forEach(l=>{ue[l._eid]||(ue[l._eid]={overlaps:[],start:l.start,position:0});const u=this.eventInRange(l,o.start,o.end),d=a.overlapsPerTimeStep?de.datesInSameTimeStep(o.start,l.start,a.timeStep):1;if(!o.background&&!o.allDay&&!l.background&&!l.allDay&&u&&d)ue[o._eid].overlaps.push(l._eid),ue[o._eid].overlaps=[...new Set(ue[o._eid].overlaps)],ue[l._eid].overlaps.push(o._eid),ue[l._eid].overlaps=[...new Set(ue[l._eid].overlaps)],ue[l._eid].position++;else{let m,c;(m=(ue[o._eid]||{overlaps:[]}).overlaps.indexOf(l._eid))>-1&&ue[o._eid].overlaps.splice(m,1),(c=(ue[l._eid]||{overlaps:[]}).overlaps.indexOf(o._eid))>-1&&ue[l._eid].overlaps.splice(c,1),ue[l._eid].position--}})});let i=0;for(const o in ue){const l=ue[o],u=l.overlaps.map(d=>({id:d,start:ue[d].start}));u.push({id:o,start:l.start}),u.sort((d,m)=>d.start<m.start?-1:d.start>m.start?1:d.id>m.id?-1:1),l.position=u.findIndex(d=>d.id===o),i=Math.max(this.getOverlapsStreak(l,ue),i)}return[ue,i]}getOverlapsStreak(t,a={}){let i=t.overlaps.length+1,o=[];return t.overlaps.forEach(l=>{o.includes(l)||t.overlaps.filter(d=>d!==l).forEach(d=>{a[d].overlaps.includes(l)||o.push(d)})}),o=[...new Set(o)],i-=o.length,i}eventInRange(t,a,i){if(t.allDay||!this._vuecal.time){const u=new Date(t.start).setHours(0,0,0,0);return new Date(t.end).setHours(23,59,0,0)>=new Date(a).setHours(0,0,0,0)&&u<=new Date(i).setHours(0,0,0,0)}const o=t.start.getTime(),l=t.end.getTime();return o<i.getTime()&&l>a.getTime()}}const Hs={class:"vuecal__flex vuecal__weekdays-headings"},Bs=["onClick"],Fs={class:"vuecal__flex weekday-label",grow:""},Ws={class:"full"},Ys={class:"small"},zs={class:"xsmall"},qs={key:0},Zs={key:0,class:"vuecal__flex vuecal__split-days-headers",grow:""};function Gs(s,t,a,i,o,l){return n(),r("div",Hs,[(n(!0),r(J,null,te(l.headings,(u,d)=>(n(),r(J,{key:d},[u.hide?x("",!0):(n(),r("div",{key:0,class:X(["vuecal__flex vuecal__heading",{today:u.today,clickable:l.cellHeadingsClickable}]),style:we(l.weekdayCellStyles),onClick:m=>l.view.id==="week"&&l.selectCell(u.date,m),onDblclick:t[0]||(t[0]=m=>l.view.id==="week"&&l.vuecal.dblclickToNavigate&&a.switchToNarrowerView())},[v(Be,{name:`slide-fade--${a.transitionDirection}`,appear:l.vuecal.transitions},{default:F(()=>[(n(),r("div",{class:"vuecal__flex",column:"",key:l.vuecal.transitions?`${d}-${u.dayOfMonth}`:!1},[e("div",Fs,[le(s.$slots,"weekday-heading",{heading:l.cleanupHeading(u),view:l.view},()=>[e("span",Ws,h(u.full),1),e("span",Ys,h(u.small),1),e("span",zs,h(u.xsmall),1),u.dayOfMonth?(n(),r("span",qs," "+h(u.dayOfMonth),1)):x("",!0)])]),l.vuecal.hasSplits&&l.vuecal.stickySplitLabels?(n(),r("div",Zs,[(n(!0),r(J,null,te(l.vuecal.daySplits,(m,c)=>(n(),r("div",{class:X(["day-split-header",m.class||!1]),key:c},[le(s.$slots,"split-label",{split:m,view:l.view},()=>[Y(h(m.label),1)])],2))),128))])):x("",!0)]))]),_:2},1032,["name","appear"])],46,Bs))],64))),128))])}const Ae=(s,t)=>{const a=s.__vccOpts||s;for(const[i,o]of t)a[i]=o;return a},Ks={inject:["vuecal","utils","view"],props:{transitionDirection:{type:String,default:"right"},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},methods:{selectCell(s,t){s.getTime()!==this.view.selectedDate.getTime()&&(this.view.selectedDate=s),this.utils.cell.selectCell(!1,s,t)},cleanupHeading:s=>({label:s.full,date:s.date,...s.today?{today:s.today}:{}})},computed:{headings(){if(!["month","week"].includes(this.view.id))return[];let s=!1;return this.weekDays.map((a,i)=>{const o=this.utils.date.addDays(this.view.startDate,this.vuecal.startWeekOnSunday&&this.vuecal.hideWeekends?i-1:i);return{hide:a.hide,full:a.label,small:a.short||a.label.substr(0,3),xsmall:a.short||a.label.substr(0,1),...this.view.id==="week"?{dayOfMonth:o.getDate(),date:o,today:!s&&this.utils.date.isToday(o)&&!s++}:{}}})},cellWidth(){return 100/(7-this.weekDays.reduce((s,t)=>s+t.hide,0))},weekdayCellStyles(){return{...this.vuecal.hideWeekdays.length?{width:`${this.cellWidth}%`}:{}}},cellHeadingsClickable(){return this.view.id==="week"&&(this.vuecal.clickToNavigate||this.vuecal.dblclickToNavigate)}}},bt=Ae(Ks,[["render",Gs]]),Js={class:"vuecal__header"},Xs={key:0,class:"vuecal__flex vuecal__menu",role:"tablist","aria-label":"Calendar views navigation"},Qs=["onDragenter","onDragleave","onClick","aria-label"],ea={key:1,class:"vuecal__title-bar"},ta=["aria-label"],sa={class:"vuecal__flex vuecal__title",grow:""},aa=["aria-label"],la={key:0,class:"vuecal__flex vuecal__split-days-headers"};function ia(s,t,a,i,o,l){const u=Me("weekdays-headings");return n(),r("div",Js,[a.options.hideViewSelector?x("",!0):(n(),r("div",Xs,[(n(!0),r(J,null,te(a.viewProps.views,(d,m)=>(n(),r(J,{key:m},[d.enabled?(n(),r("button",{key:0,class:X(["vuecal__view-btn",{"vuecal__view-btn--active":l.view.id===m,"vuecal__view-btn--highlighted":s.highlightedControl===m}]),type:"button",onDragenter:c=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragEnter(c,m,s.$data),onDragleave:c=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragLeave(c,m,s.$data),onClick:c=>l.switchView(m,null,!0),"aria-label":`${d.label} view`},h(d.label),43,Qs)):x("",!0)],64))),128))])),a.options.hideTitleBar?x("",!0):(n(),r("div",ea,[e("button",{class:X(["vuecal__arrow vuecal__arrow--prev",{"vuecal__arrow--highlighted":s.highlightedControl==="previous"}]),type:"button",onClick:t[0]||(t[0]=(...d)=>l.previous&&l.previous(...d)),onDragenter:t[1]||(t[1]=d=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragEnter(d,"previous",s.$data)),onDragleave:t[2]||(t[2]=d=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragLeave(d,"previous",s.$data)),"aria-label":`Previous ${l.view.id}`},[le(s.$slots,"arrow-prev")],42,ta),e("div",sa,[v(Be,{name:a.options.transitions?`slide-fade--${l.transitionDirection}`:""},{default:F(()=>[(n(),ae(qt(l.broaderView?"button":"span"),{type:!!l.broaderView&&"button",key:`${l.view.id}${l.view.startDate.toString()}`,onClick:t[3]||(t[3]=d=>!!l.broaderView&&l.switchToBroaderView()),"aria-label":!!l.broaderView&&`Go to ${l.broaderView} view`},{default:F(()=>[le(s.$slots,"title")]),_:3},8,["type","aria-label"]))]),_:3},8,["name"])]),a.options.todayButton?(n(),r("button",{key:0,class:X(["vuecal__today-btn",{"vuecal__today-btn--highlighted":s.highlightedControl==="today"}]),type:"button",onClick:t[4]||(t[4]=(...d)=>l.goToToday&&l.goToToday(...d)),onDragenter:t[5]||(t[5]=d=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragEnter(d,"today",s.$data)),onDragleave:t[6]||(t[6]=d=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragLeave(d,"today",s.$data)),"aria-label":"Today"},[le(s.$slots,"today-button")],34)):x("",!0),e("button",{class:X(["vuecal__arrow vuecal__arrow--next",{"vuecal__arrow--highlighted":s.highlightedControl==="next"}]),type:"button",onClick:t[7]||(t[7]=(...d)=>l.next&&l.next(...d)),onDragenter:t[8]||(t[8]=d=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragEnter(d,"next",s.$data)),onDragleave:t[9]||(t[9]=d=>a.editEvents.drag&&l.dnd&&l.dnd.viewSelectorDragLeave(d,"next",s.$data)),"aria-label":`Next ${l.view.id}`},[le(s.$slots,"arrow-next")],42,aa)])),a.viewProps.weekDaysInHeader?(n(),ae(u,{key:2,"week-days":a.weekDays,"transition-direction":l.transitionDirection,"switch-to-narrower-view":a.switchToNarrowerView},Ke({_:2},[s.$slots["weekday-heading"]?{name:"weekday-heading",fn:F(({heading:d,view:m})=>[le(s.$slots,"weekday-heading",{heading:d,view:m})]),key:"0"}:void 0,s.$slots["split-label"]?{name:"split-label",fn:F(({split:d})=>[le(s.$slots,"split-label",{split:d,view:l.view})]),key:"1"}:void 0]),1032,["week-days","transition-direction","switch-to-narrower-view"])):x("",!0),v(Be,{name:`slide-fade--${l.transitionDirection}`},{default:F(()=>[l.showDaySplits?(n(),r("div",la,[(n(!0),r(J,null,te(a.daySplits,(d,m)=>(n(),r("div",{class:X(["day-split-header",d.class||!1]),key:m},[le(s.$slots,"split-label",{split:d,view:l.view.id},()=>[Y(h(d.label),1)])],2))),128))])):x("",!0)]),_:3},8,["name"])])}const na={inject:["vuecal","previous","next","switchView","updateSelectedDate","modules","view"],components:{WeekdaysHeadings:bt},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},hasSplits:{type:[Boolean,Number],default:!1},daySplits:{type:Array,default:()=>[]},viewProps:{type:Object,default:()=>({})},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},data:()=>({highlightedControl:null}),methods:{goToToday(){this.updateSelectedDate(new Date(new Date().setHours(0,0,0,0)))},switchToBroaderView(){this.transitionDirection="left",this.broaderView&&this.switchView(this.broaderView)}},computed:{transitionDirection:{get(){return this.vuecal.transitionDirection},set(s){this.vuecal.transitionDirection=s}},broaderView(){const{enabledViews:s}=this.vuecal;return s[s.indexOf(this.view.id)-1]},showDaySplits(){return this.view.id==="day"&&this.hasSplits&&this.options.stickySplitLabels&&!this.options.minSplitWidth},dnd(){return this.modules.dnd}}},oa=Ae(na,[["render",ia]]),ra=["draggable"];function da(s,t,a,i,o,l){return n(),r("div",{class:X(["vuecal__event",l.eventClasses]),style:we(l.eventStyles),tabindex:"0",onFocus:t[4]||(t[4]=(...u)=>l.focusEvent&&l.focusEvent(...u)),onKeypress:t[5]||(t[5]=Fe(_e((...u)=>l.onEnterKeypress&&l.onEnterKeypress(...u),["stop"]),["enter"])),onMouseenter:t[6]||(t[6]=(...u)=>l.onMouseEnter&&l.onMouseEnter(...u)),onMouseleave:t[7]||(t[7]=(...u)=>l.onMouseLeave&&l.onMouseLeave(...u)),onTouchstart:t[8]||(t[8]=_e((...u)=>l.onTouchStart&&l.onTouchStart(...u),["stop"])),onMousedown:t[9]||(t[9]=u=>l.onMouseDown(u)),onMouseup:t[10]||(t[10]=(...u)=>l.onMouseUp&&l.onMouseUp(...u)),onTouchend:t[11]||(t[11]=(...u)=>l.onMouseUp&&l.onMouseUp(...u)),onTouchmove:t[12]||(t[12]=(...u)=>l.onTouchMove&&l.onTouchMove(...u)),onDblclick:t[13]||(t[13]=(...u)=>l.onDblClick&&l.onDblClick(...u)),draggable:l.draggable,onDragstart:t[14]||(t[14]=u=>l.draggable&&l.onDragStart(u)),onDragend:t[15]||(t[15]=u=>l.draggable&&l.onDragEnd())},[l.vuecal.editEvents.delete&&a.event.deletable?(n(),r("div",{key:0,class:"vuecal__event-delete",onClick:t[0]||(t[0]=_e((...u)=>l.deleteEvent&&l.deleteEvent(...u),["stop"])),onTouchstart:t[1]||(t[1]=_e((...u)=>l.touchDeleteEvent&&l.touchDeleteEvent(...u),["stop"]))},h(l.vuecal.texts.deleteEvent),33)):x("",!0),le(s.$slots,"event",{event:a.event,view:l.view.id}),l.resizable?(n(),r("div",{key:1,class:"vuecal__event-resize-handle",contenteditable:"false",onMousedown:t[2]||(t[2]=_e((...u)=>l.onResizeHandleMouseDown&&l.onResizeHandleMouseDown(...u),["stop","prevent"])),onTouchstart:t[3]||(t[3]=_e((...u)=>l.onResizeHandleMouseDown&&l.onResizeHandleMouseDown(...u),["stop","prevent"]))},null,32)):x("",!0)],46,ra)}const ua={inject:["vuecal","utils","modules","view","domEvents","editEvents"],props:{cellFormattedDate:{type:String,default:""},event:{type:Object,default:()=>({})},cellEvents:{type:Array,default:()=>[]},overlaps:{type:Array,default:()=>[]},eventPosition:{type:Number,default:0},overlapsStreak:{type:Number,default:0},allDay:{type:Boolean,default:!1}},data:()=>({touch:{dragThreshold:30,startX:0,startY:0,dragged:!1}}),methods:{onMouseDown(s,t=!1){if("ontouchstart"in window&&!t)return!1;const{clickHoldAnEvent:a,focusAnEvent:i,resizeAnEvent:o,dragAnEvent:l}=this.domEvents;if(i._eid===this.event._eid&&a._eid===this.event._eid)return!0;this.focusEvent(),a._eid=null,this.vuecal.editEvents.delete&&this.event.deletable&&(a.timeoutId=setTimeout(()=>{!o._eid&&!l._eid&&(a._eid=this.event._eid,this.event.deleting=!0)},a.timeout))},onMouseUp(s){this.domEvents.focusAnEvent._eid===this.event._eid&&!this.touch.dragged&&(this.domEvents.focusAnEvent.mousedUp=!0),this.touch.dragged=!1},onMouseEnter(s){s.preventDefault(),this.vuecal.emitWithEvent("event-mouse-enter",this.event)},onMouseLeave(s){s.preventDefault(),this.vuecal.emitWithEvent("event-mouse-leave",this.event)},onTouchMove(s){if(typeof this.vuecal.onEventClick!="function")return;const{clientX:t,clientY:a}=s.touches[0],{startX:i,startY:o,dragThreshold:l}=this.touch;(Math.abs(t-i)>l||Math.abs(a-o)>l)&&(this.touch.dragged=!0)},onTouchStart(s){this.touch.startX=s.touches[0].clientX,this.touch.startY=s.touches[0].clientY,this.onMouseDown(s,!0)},onEnterKeypress(s){if(typeof this.vuecal.onEventClick=="function")return this.vuecal.onEventClick(this.event,s)},onDblClick(s){if(typeof this.vuecal.onEventDblclick=="function")return this.vuecal.onEventDblclick(this.event,s)},onDragStart(s){this.dnd&&this.dnd.eventDragStart(s,this.event)},onDragEnd(){this.dnd&&this.dnd.eventDragEnd(this.event)},onResizeHandleMouseDown(){this.focusEvent(),this.domEvents.dragAnEvent._eid=null,this.domEvents.resizeAnEvent=Object.assign(this.domEvents.resizeAnEvent,{_eid:this.event._eid,start:(this.segment||this.event).start,split:this.event.split||null,segment:!!this.segment&&this.utils.date.formatDateLite(this.segment.start),originalEnd:new Date((this.segment||this.event).end),originalEndTimeMinutes:this.event.endTimeMinutes}),this.event.resizing=!0},deleteEvent(s=!1){if("ontouchstart"in window&&!s)return!1;this.utils.event.deleteAnEvent(this.event)},touchDeleteEvent(s){this.deleteEvent(!0)},cancelDeleteEvent(){this.event.deleting=!1},focusEvent(){const{focusAnEvent:s}=this.domEvents,t=s._eid;if(t!==this.event._eid){if(t){const a=this.view.events.find(i=>i._eid===t);a&&(a.focused=!1)}this.vuecal.cancelDelete(),this.vuecal.emitWithEvent("event-focus",this.event),s._eid=this.event._eid,this.event.focused=!0}}},computed:{eventDimensions(){const{startTimeMinutes:s,endTimeMinutes:t}=this.segment||this.event;let a=s-this.vuecal.timeFrom;const i=Math.max(Math.round(a*this.vuecal.timeCellHeight/this.vuecal.timeStep),0);a=Math.min(t,this.vuecal.timeTo)-this.vuecal.timeFrom;const o=Math.round(a*this.vuecal.timeCellHeight/this.vuecal.timeStep),l=Math.max(o-i,5);return{top:i,height:l}},eventStyles(){if(this.event.allDay||!this.vuecal.time||!this.event.endTimeMinutes||this.view.id==="month"||this.allDay)return{};let s=100/Math.min(this.overlaps.length+1,this.overlapsStreak),t=100/(this.overlaps.length+1)*this.eventPosition;this.vuecal.minEventWidth&&s<this.vuecal.minEventWidth&&(s=this.vuecal.minEventWidth,t=(100-this.vuecal.minEventWidth)/this.overlaps.length*this.eventPosition);const{top:a,height:i}=this.eventDimensions;return{top:`${a}px`,height:`${i}px`,width:`${s}%`,left:this.event.left&&`${this.event.left}px`||`${t}%`}},eventClasses(){const{isFirstDay:s,isLastDay:t}=this.segment||{};return{[this.event.class]:!!this.event.class,"vuecal__event--focus":this.event.focused,"vuecal__event--resizing":this.event.resizing,"vuecal__event--background":this.event.background,"vuecal__event--deletable":this.event.deleting,"vuecal__event--all-day":this.event.allDay,"vuecal__event--dragging":!this.event.draggingStatic&&this.event.dragging,"vuecal__event--static":this.event.dragging&&this.event.draggingStatic,"vuecal__event--multiple-days":!!this.segment,"event-start":this.segment&&s&&!t,"event-middle":this.segment&&!s&&!t,"event-end":this.segment&&t&&!s}},segment(){return this.event.segments&&this.event.segments[this.cellFormattedDate]||null},draggable(){const{draggable:s,background:t,daysCount:a}=this.event;return this.vuecal.editEvents.drag&&s&&!t&&a===1},resizable(){const{editEvents:s,time:t}=this.vuecal;return s.resize&&this.event.resizable&&t&&!this.allDay&&(!this.segment||this.segment&&this.segment.isLastDay)&&this.view.id!=="month"},dnd(){return this.modules.dnd}}},ca=Ae(ua,[["render",da]]),ma=["data-split","aria-label","onTouchstart","onMousedown","onDragover","onDrop"],va={key:0,class:"cell-time-labels"},pa=["innerHTML"],ha={key:2,class:"vuecal__cell-events"},ga=["title"];function fa(s,t,a,i,o,l){const u=Me("event");return n(),ae(Zt,{class:X(["vuecal__cell",l.cellClasses]),name:`slide-fade--${l.transitionDirection}`,tag:"div",appear:a.options.transitions,style:we(l.cellStyles)},{default:F(()=>[(n(!0),r(J,null,te(l.splitsCount?l.splits:1,(d,m)=>(n(),r("div",{class:X(["vuecal__flex vuecal__cell-content",l.splitsCount&&l.splitClasses(d)]),key:a.options.transitions?`${l.view.id}-${a.data.content}-${m}`:m,"data-split":l.splitsCount?d.id:!1,column:"",tabindex:"0","aria-label":a.data.content,onFocus:t[0]||(t[0]=c=>l.onCellFocus(c)),onKeypress:t[1]||(t[1]=Fe(c=>l.onCellkeyPressEnter(c),["enter"])),onTouchstart:c=>!l.isDisabled&&l.onCellTouchStart(c,l.splitsCount?d.id:null),onMousedown:c=>!l.isDisabled&&l.onCellMouseDown(c,l.splitsCount?d.id:null),onClick:t[2]||(t[2]=c=>!l.isDisabled&&l.onCellClick(c)),onDblclick:t[3]||(t[3]=c=>!l.isDisabled&&l.onCellDblClick(c)),onContextmenu:t[4]||(t[4]=c=>!l.isDisabled&&a.options.cellContextmenu&&l.onCellContextMenu(c)),onDragenter:t[5]||(t[5]=c=>!l.isDisabled&&a.editEvents.drag&&l.dnd&&l.dnd.cellDragEnter(c,s.$data,a.data.startDate)),onDragover:c=>!l.isDisabled&&a.editEvents.drag&&l.dnd&&l.dnd.cellDragOver(c,s.$data,a.data.startDate,l.splitsCount?d.id:null),onDragleave:t[6]||(t[6]=c=>!l.isDisabled&&a.editEvents.drag&&l.dnd&&l.dnd.cellDragLeave(c,s.$data,a.data.startDate)),onDrop:c=>!l.isDisabled&&a.editEvents.drag&&l.dnd&&l.dnd.cellDragDrop(c,s.$data,a.data.startDate,l.splitsCount?d.id:null)},[a.options.showTimeInCells&&a.options.time&&l.isWeekOrDayView&&!a.allDay?(n(),r("div",va,[(n(!0),r(J,null,te(l.vuecal.timeCells,(c,p)=>(n(),r("span",{class:"cell-time-label",key:p},h(c.label),1))),128))])):x("",!0),l.isWeekOrDayView&&!a.allDay&&l.specialHours.length?(n(!0),r(J,{key:1},te(l.specialHours,(c,p)=>(n(),r("div",{class:X(["vuecal__special-hours",`vuecal__special-hours--day${c.day} ${c.class}`]),style:we(`height: ${c.height}px;top: ${c.top}px`)},[c.label?(n(),r("div",{key:0,class:"special-hours-label",innerHTML:c.label},null,8,pa)):x("",!0)],6))),256)):x("",!0),le(s.$slots,"cell-content",{events:l.events,selectCell:c=>l.selectCell(c,!0),split:l.splitsCount?d:!1}),l.eventsCount&&(l.isWeekOrDayView||l.view.id==="month"&&a.options.eventsOnMonthView)?(n(),r("div",ha,[(n(!0),r(J,null,te(l.splitsCount?d.events:l.events,(c,p)=>(n(),ae(u,{key:p,"cell-formatted-date":a.data.formattedDate,event:c,"all-day":a.allDay,"cell-events":l.splitsCount?d.events:l.events,overlaps:((l.splitsCount?d.overlaps[c._eid]:s.cellOverlaps[c._eid])||[]).overlaps,"event-position":((l.splitsCount?d.overlaps[c._eid]:s.cellOverlaps[c._eid])||[]).position,"overlaps-streak":l.splitsCount?d.overlapsStreak:s.cellOverlapsStreak},{event:F(({event:w,view:y})=>[le(s.$slots,"event",{view:y,event:w})]),_:2},1032,["cell-formatted-date","event","all-day","cell-events","overlaps","event-position","overlaps-streak"]))),128))])):x("",!0)],42,ma))),128)),l.timelineVisible?(n(),r("div",{class:"vuecal__now-line",style:we(`top: ${l.todaysTimePosition}px`),key:a.options.transitions?`${l.view.id}-now-line`:"now-line",title:l.utils.date.formatTime(l.vuecal.now)},null,12,ga)):x("",!0)]),_:3},8,["class","name","appear","style"])}const ya={inject:["vuecal","utils","modules","view","domEvents"],components:{Event:ca},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},data:{type:Object,required:!0},cellSplits:{type:Array,default:()=>[]},minTimestamp:{type:[Number,null],default:null},maxTimestamp:{type:[Number,null],default:null},cellWidth:{type:[Number,Boolean],default:!1},allDay:{type:Boolean,default:!1}},data:()=>({cellOverlaps:{},cellOverlapsStreak:1,timeAtCursor:null,highlighted:!1,highlightedSplit:null}),methods:{getSplitAtCursor({target:s}){let a=s.classList.contains("vuecal__cell-split")?s:this.vuecal.findAncestor(s,"vuecal__cell-split");return a&&(a=a.attributes["data-split"].value,parseInt(a).toString()===a.toString()&&(a=parseInt(a))),a||null},splitClasses(s){return{"vuecal__cell-split":!0,"vuecal__cell-split--highlighted":this.highlightedSplit===s.id,[s.class]:!!s.class}},checkCellOverlappingEvents(){this.options.time&&this.eventsCount&&!this.splitsCount&&(this.eventsCount===1?(this.cellOverlaps=[],this.cellOverlapsStreak=1):[this.cellOverlaps,this.cellOverlapsStreak]=this.utils.event.checkCellOverlappingEvents(this.events,this.options))},isDOMElementAnEvent(s){return this.vuecal.isDOMElementAnEvent(s)},selectCell(s,t=!1){const a=this.splitsCount?this.getSplitAtCursor(s):null;this.utils.cell.selectCell(t,this.timeAtCursor,a),this.timeAtCursor=null},onCellkeyPressEnter(s){this.isSelected||this.onCellFocus(s);const t=this.splitsCount?this.getSplitAtCursor(s):null;this.utils.cell.keyPressEnterCell(this.timeAtCursor,t),this.timeAtCursor=null},onCellFocus(s){if(!this.isSelected&&!this.isDisabled){this.isSelected=this.data.startDate;const t=this.splitsCount?this.getSplitAtCursor(s):null,a=this.timeAtCursor||this.data.startDate;this.vuecal.$emit("cell-focus",t?{date:a,split:t}:a)}},onCellMouseDown(s,t=null,a=!1){if("ontouchstart"in window&&!a)return!1;this.isSelected||this.onCellFocus(s);const{clickHoldACell:i,focusAnEvent:o}=this.domEvents;this.domEvents.cancelClickEventCreation=!1,i.eventCreated=!1,this.timeAtCursor=new Date(this.data.startDate);const{minutes:l,cursorCoords:{y:u}}=this.vuecal.minutesAtCursor(s);this.timeAtCursor.setMinutes(l);const d=this.isDOMElementAnEvent(s.target);!d&&o._eid&&((this.view.events.find(m=>m._eid===o._eid)||{}).focused=!1),this.editEvents.create&&!d&&this.setUpEventCreation(s,u)},setUpEventCreation(s,t){if(this.options.dragToCreateEvent&&["week","day"].includes(this.view.id)){const{dragCreateAnEvent:a}=this.domEvents;if(a.startCursorY=t,a.split=this.splitsCount?this.getSplitAtCursor(s):null,a.start=this.timeAtCursor,this.options.snapToTime){let i=this.timeAtCursor.getHours()*60+this.timeAtCursor.getMinutes();const o=i+this.options.snapToTime/2;i=o-o%this.options.snapToTime,a.start.setHours(0,i,0,0)}}else this.options.cellClickHold&&["month","week","day"].includes(this.view.id)&&this.setUpCellHoldTimer(s)},setUpCellHoldTimer(s){const{clickHoldACell:t}=this.domEvents;t.cellId=`${this.vuecal._.uid}_${this.data.formattedDate}`,t.split=this.splitsCount?this.getSplitAtCursor(s):null,t.timeoutId=setTimeout(()=>{if(t.cellId&&!this.domEvents.cancelClickEventCreation){const{_eid:a}=this.utils.event.createAnEvent(this.timeAtCursor,null,t.split?{split:t.split}:{});t.eventCreated=a}},t.timeout)},onCellTouchStart(s,t=null){this.onCellMouseDown(s,t,!0)},onCellClick(s){this.isDOMElementAnEvent(s.target)||this.selectCell(s)},onCellDblClick(s){const t=new Date(this.data.startDate);t.setMinutes(this.vuecal.minutesAtCursor(s).minutes);const a=this.splitsCount?this.getSplitAtCursor(s):null;this.vuecal.$emit("cell-dblclick",a?{date:t,split:a}:t),this.options.dblclickToNavigate&&this.vuecal.switchToNarrowerView()},onCellContextMenu(s){s.stopPropagation(),s.preventDefault();const t=new Date(this.data.startDate),{cursorCoords:a,minutes:i}=this.vuecal.minutesAtCursor(s);t.setMinutes(i);const o=this.splitsCount?this.getSplitAtCursor(s):null;this.vuecal.$emit("cell-contextmenu",{date:t,...a,...o||{},e:s})}},computed:{dnd(){return this.modules.dnd},nowInMinutes(){return this.utils.date.dateToMinutes(this.vuecal.now)},isBeforeMinDate(){return this.minTimestamp!==null&&this.minTimestamp>this.data.endDate.getTime()},isAfterMaxDate(){return this.maxTimestamp&&this.maxTimestamp<this.data.startDate.getTime()},isDisabled(){const{disableDays:s}=this.options,{isYearsOrYearView:t}=this.vuecal;return s.length&&s.includes(this.data.formattedDate)&&!t?!0:this.isBeforeMinDate||this.isAfterMaxDate},isSelected:{get(){let s=!1;const{selectedDate:t}=this.view;return this.view.id==="years"?s=t.getFullYear()===this.data.startDate.getFullYear():this.view.id==="year"?s=t.getFullYear()===this.data.startDate.getFullYear()&&t.getMonth()===this.data.startDate.getMonth():s=t.getTime()===this.data.startDate.getTime(),s},set(s){this.view.selectedDate=s,this.vuecal.$emit("update:selected-date",this.view.selectedDate)}},isWeekOrDayView(){return["week","day"].includes(this.view.id)},transitionDirection(){return this.vuecal.transitionDirection},specialHours(){return this.data.specialHours.map(s=>{let{from:t,to:a}=s;return t=Math.max(t,this.options.timeFrom),a=Math.min(a,this.options.timeTo),{...s,height:(a-t)*this.timeScale,top:(t-this.options.timeFrom)*this.timeScale}})},events(){const{startDate:s,endDate:t}=this.data;let a=[];if(!(["years","year"].includes(this.view.id)&&!this.options.eventsCountOnYearView)){if(a=this.view.events.slice(0),this.view.id==="month"&&a.push(...this.view.outOfScopeEvents),a=a.filter(i=>this.utils.event.eventInRange(i,s,t)),this.options.showAllDayEvents&&this.view.id!=="month"&&(a=a.filter(i=>!!i.allDay===this.allDay)),this.options.time&&this.isWeekOrDayView&&!this.allDay){const{timeFrom:i,timeTo:o}=this.options;a=a.filter(l=>{const u=l.daysCount>1&&l.segments[this.data.formattedDate]||{},d=l.daysCount===1&&l.startTimeMinutes<o&&l.endTimeMinutes>i,m=l.daysCount>1&&u.startTimeMinutes<o&&u.endTimeMinutes>i;return l.allDay||d||m||!1})}this.options.time&&this.isWeekOrDayView&&!(this.options.showAllDayEvents&&this.allDay)&&a.sort((i,o)=>i.start<o.start?-1:1),this.cellSplits.length||this.$nextTick(this.checkCellOverlappingEvents)}return a},eventsCount(){return this.events.length},splits(){return this.cellSplits.map((s,t)=>{const a=this.events.filter(l=>l.split===s.id),[i,o]=this.utils.event.checkCellOverlappingEvents(a.filter(l=>!l.background&&!l.allDay),this.options);return{...s,overlaps:i,overlapsStreak:o,events:a}})},splitsCount(){return this.splits.length},cellClasses(){return{[this.data.class]:!!this.data.class,"vuecal__cell--current":this.data.current,"vuecal__cell--today":this.data.today,"vuecal__cell--out-of-scope":this.data.outOfScope,"vuecal__cell--before-min":this.isDisabled&&this.isBeforeMinDate,"vuecal__cell--after-max":this.isDisabled&&this.isAfterMaxDate,"vuecal__cell--disabled":this.isDisabled,"vuecal__cell--selected":this.isSelected,"vuecal__cell--highlighted":this.highlighted,"vuecal__cell--has-splits":this.splitsCount,"vuecal__cell--has-events":this.eventsCount}},cellStyles(){return{...this.cellWidth?{width:`${this.cellWidth}%`}:{}}},timelineVisible(){const{time:s,timeTo:t}=this.options;return this.data.today&&this.isWeekOrDayView&&s&&!this.allDay&&this.nowInMinutes<=t},todaysTimePosition(){if(!this.data.today||!this.options.time)return;const s=this.nowInMinutes-this.options.timeFrom;return Math.round(s*this.timeScale)},timeScale(){return this.options.timeCellHeight/this.options.timeStep}}},_t=Ae(ya,[["render",fa]]),wa={key:0,class:"vuecal__all-day-text",style:{width:"3em"}};function ba(s,t,a,i,o,l){const u=Me("vuecal-cell");return n(),r("div",{class:"vuecal__flex vuecal__all-day",style:we(a.cellOrSplitMinWidth&&{height:a.height})},[a.cellOrSplitMinWidth?x("",!0):(n(),r("div",wa,[e("span",null,h(a.label),1)])),e("div",{class:X(["vuecal__flex vuecal__cells",`${l.view.id}-view`]),grow:"",style:we(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(n(!0),r(J,null,te(a.cells,(d,m)=>(n(),ae(u,{key:m,options:a.options,"edit-events":l.editEvents,data:d,"all-day":!0,"cell-width":a.options.hideWeekdays.length&&(l.vuecal.isWeekView||l.vuecal.isMonthView)&&l.vuecal.cellWidth,"min-timestamp":a.options.minTimestamp,"max-timestamp":a.options.maxTimestamp,"cell-splits":a.daySplits},{event:F(({event:c,view:p})=>[le(s.$slots,"event",{view:p,event:c})]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],6)],4)}const _a={inject:["vuecal","view","editEvents"],components:{"vuecal-cell":_t},props:{options:{type:Object,required:!0},cells:{type:Array,required:!0},label:{type:String,required:!0},daySplits:{type:Array,default:()=>[]},shortEvents:{type:Boolean,default:!0},height:{type:String,default:""},cellOrSplitMinWidth:{type:Number,default:null}},computed:{hasCellOrSplitWidth(){return!!(this.options.minCellWidth||this.daySplits.length&&this.options.minSplitWidth)}}},xa=Ae(_a,[["render",ba]]),ka=["lang"],Da={class:"default"},Ca={key:0,class:"vuecal__flex vuecal__body",grow:""},Ta=["onBlur","innerHTML"],Ea=["innerHTML"],Ma=["innerHTML"],Sa={class:"vuecal__flex",row:"",grow:""},ja={key:0,class:"vuecal__time-column"},$a={class:"vuecal__time-cell-label"},Va={key:1,class:"vuecal__flex vuecal__week-numbers",column:""},Aa=["wrap","column"],Oa=["onBlur","innerHTML"],La=["innerHTML"],Ia=["innerHTML"],Pa=["wrap"],Na=["innerHTML"],Ra=["innerHTML"],Ua={key:2,class:"vuecal__cell-events-count"},Ha={key:3,class:"vuecal__no-event"},Ba=["onBlur","innerHTML"],Fa=["innerHTML"],Wa={key:2,class:"vuecal__event-time"},Ya={key:0},za={key:1,class:"days-to-end"},qa=["innerHTML"],Za={key:0,class:"vuecal__scrollbar-check"};function Ga(s,t,a,i,o,l){const u=Me("vuecal-header"),d=Me("all-day-bar"),m=Me("weekdays-headings"),c=Me("vuecal-cell");return n(),r("div",{class:X(["vuecal__flex vuecal",l.cssClasses]),column:"",ref:"vuecal",lang:a.locale},[v(u,{options:s.$props,"edit-events":l.editEvents,"view-props":{views:l.views,weekDaysInHeader:l.weekDaysInHeader},"week-days":l.weekDays,"has-splits":l.hasSplits,"day-splits":l.daySplits,"switch-to-narrower-view":l.switchToNarrowerView},Ke({"arrow-prev":F(()=>[le(s.$slots,"arrow-prev",{},()=>[t[0]||(t[0]=Y(" ")),t[1]||(t[1]=e("i",{class:"angle"},null,-1)),t[2]||(t[2]=Y(" "))])]),"arrow-next":F(()=>[le(s.$slots,"arrow-next",{},()=>[t[3]||(t[3]=Y(" ")),t[4]||(t[4]=e("i",{class:"angle"},null,-1)),t[5]||(t[5]=Y(" "))])]),"today-button":F(()=>[le(s.$slots,"today-button",{},()=>[e("span",Da,h(o.texts.today),1)])]),title:F(()=>[le(s.$slots,"title",{title:l.viewTitle,view:o.view},()=>[Y(h(l.viewTitle),1)])]),_:2},[s.$slots["weekday-heading"]?{name:"weekday-heading",fn:F(({heading:p,view:w})=>[le(s.$slots,"weekday-heading",{heading:p,view:w})]),key:"0"}:void 0,s.$slots["split-label"]?{name:"split-label",fn:F(({split:p})=>[le(s.$slots,"split-label",{split:p,view:o.view.id})]),key:"1"}:void 0]),1032,["options","edit-events","view-props","week-days","has-splits","day-splits","switch-to-narrower-view"]),a.hideBody?x("",!0):(n(),r("div",Ca,[v(Be,{name:`slide-fade--${o.transitionDirection}`,appear:a.transitions},{default:F(()=>[(n(),r("div",{class:"vuecal__flex",style:{"min-width":"100%"},key:a.transitions?o.view.id:!1,column:""},[a.showAllDayEvents&&l.hasTimeColumn&&(!l.cellOrSplitMinWidth||l.isDayView&&!a.minSplitWidth)?(n(),ae(d,nt(ot({key:0},l.allDayBar)),{event:F(({event:p,view:w})=>[le(s.$slots,"event",{view:w,event:p},()=>[l.editEvents.title&&p.titleEditable?(n(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:y=>l.onEventTitleBlur(y,p),innerHTML:p.title},null,40,Ta)):p.title?(n(),r("div",{key:1,class:"vuecal__event-title",innerHTML:p.title},null,8,Ea)):x("",!0),p.content&&!l.hasShortEvents&&!l.isShortMonthView?(n(),r("div",{key:2,class:"vuecal__event-content",innerHTML:p.content},null,8,Ma)):x("",!0)])]),_:3},16)):x("",!0),e("div",{class:X(["vuecal__bg",{vuecal__flex:!l.hasTimeColumn}]),column:""},[e("div",Sa,[l.hasTimeColumn?(n(),r("div",ja,[a.showAllDayEvents&&l.cellOrSplitMinWidth&&!(l.isDayView&&!a.minSplitWidth)?(n(),r("div",{key:0,class:"vuecal__all-day-text",style:we({height:l.allDayBar.height})},[e("span",null,h(o.texts.allDay),1)],4)):x("",!0),(n(!0),r(J,null,te(l.timeCells,(p,w)=>(n(),r("div",{class:"vuecal__time-cell",key:w,style:we(`height: ${a.timeCellHeight}px`)},[le(s.$slots,"time-cell",{hours:p.hours,minutes:p.minutes},()=>[t[6]||(t[6]=e("span",{class:"vuecal__time-cell-line"},null,-1)),e("span",$a,h(p.label),1)])],4))),128))])):x("",!0),a.showWeekNumbers&&l.isMonthView?(n(),r("div",Va,[(n(),r(J,null,te(6,p=>e("div",{class:"vuecal__flex vuecal__week-number-cell",key:p,grow:""},[le(s.$slots,"week-number-cell",{week:l.getWeekNumber(p-1)},()=>[Y(h(l.getWeekNumber(p-1)),1)])])),64))])):x("",!0),e("div",{class:X(["vuecal__flex vuecal__cells",`${o.view.id}-view`]),grow:"",wrap:!l.cellOrSplitMinWidth||!l.isWeekView,column:!!l.cellOrSplitMinWidth},[l.cellOrSplitMinWidth&&l.isWeekView?(n(),ae(m,{key:0,"transition-direction":o.transitionDirection,"week-days":l.weekDays,"switch-to-narrower-view":l.switchToNarrowerView,style:we(l.cellOrSplitMinWidth?`min-width: ${l.cellOrSplitMinWidth}px`:"")},Ke({_:2},[s.$slots["weekday-heading"]?{name:"weekday-heading",fn:F(({heading:p,view:w})=>[le(s.$slots,"weekday-heading",{heading:p,view:w})]),key:"0"}:void 0,s.$slots["split-label"]?{name:"split-label",fn:F(({split:p})=>[le(s.$slots,"split-label",{split:p,view:o.view.id})]),key:"1"}:void 0]),1032,["transition-direction","week-days","switch-to-narrower-view","style"])):l.hasSplits&&a.stickySplitLabels&&a.minSplitWidth?(n(),r("div",{key:1,class:"vuecal__flex vuecal__split-days-headers",style:we(l.cellOrSplitMinWidth?`min-width: ${l.cellOrSplitMinWidth}px`:"")},[(n(!0),r(J,null,te(l.daySplits,(p,w)=>(n(),r("div",{class:X(["day-split-header",p.class||!1]),key:w},[le(s.$slots,"split-label",{split:p,view:o.view.id},()=>[Y(h(p.label),1)])],2))),128))],4)):x("",!0),a.showAllDayEvents&&l.hasTimeColumn&&(l.isWeekView&&l.cellOrSplitMinWidth||l.isDayView&&l.hasSplits&&a.minSplitWidth)?(n(),ae(d,nt(ot({key:2},l.allDayBar)),{event:F(({event:p,view:w})=>[le(s.$slots,"event",{view:w,event:p},()=>[l.editEvents.title&&p.titleEditable?(n(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:y=>l.onEventTitleBlur(y,p),innerHTML:p.title},null,40,Oa)):p.title?(n(),r("div",{key:1,class:"vuecal__event-title",innerHTML:p.title},null,8,La)):x("",!0),p.content&&!l.hasShortEvents&&!l.isShortMonthView?(n(),r("div",{key:2,class:"vuecal__event-content",innerHTML:p.content},null,8,Ia)):x("",!0)])]),_:3},16)):x("",!0),e("div",{class:"vuecal__flex",ref:p=>o.cellsEl=p,grow:"",wrap:!l.cellOrSplitMinWidth||!l.isWeekView,style:we(l.cellOrSplitMinWidth?`min-width: ${l.cellOrSplitMinWidth}px`:"")},[(n(!0),r(J,null,te(l.viewCells,(p,w)=>(n(),ae(c,{key:w,options:s.$props,"edit-events":l.editEvents,data:p,"cell-width":a.hideWeekdays.length&&(l.isWeekView||l.isMonthView)&&l.cellWidth,"min-timestamp":l.minTimestamp,"max-timestamp":l.maxTimestamp,"cell-splits":l.hasSplits&&l.daySplits||[]},{"cell-content":F(({events:y,split:E,selectCell:k})=>[le(s.$slots,"cell-content",{cell:p,view:o.view,goNarrower:k,events:y},()=>[E&&!a.stickySplitLabels?(n(),r("div",{key:0,class:"split-label",innerHTML:E.label},null,8,Na)):x("",!0),p.content?(n(),r("div",{key:1,class:"vuecal__cell-date",innerHTML:p.content},null,8,Ra)):x("",!0),(l.isMonthView&&!a.eventsOnMonthView||l.isYearsOrYearView&&a.eventsCountOnYearView)&&y.length?(n(),r("div",Ua,[le(s.$slots,"events-count",{view:o.view,events:y},()=>[Y(h(y.length),1)])])):x("",!0),!l.cellOrSplitHasEvents(y,E)&&l.isWeekOrDayView?(n(),r("div",Ha,[le(s.$slots,"no-event",{},()=>[Y(h(o.texts.noEvent),1)])])):x("",!0)])]),event:F(({event:y,view:E})=>[le(s.$slots,"event",{view:E,event:y},()=>[l.editEvents.title&&y.titleEditable?(n(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:k=>l.onEventTitleBlur(k,y),innerHTML:y.title},null,40,Ba)):y.title?(n(),r("div",{key:1,class:"vuecal__event-title",innerHTML:y.title},null,8,Fa)):x("",!0),a.time&&!y.allDay&&!(l.isMonthView&&(y.allDay||a.showAllDayEvents==="short"))&&!l.isShortMonthView?(n(),r("div",Wa,[Y(h(o.utils.date.formatTime(y.start,l.TimeFormat)),1),y.endTimeMinutes?(n(),r("span",Ya," - "+h(o.utils.date.formatTime(y.end,l.TimeFormat,null,!0)),1)):x("",!0),y.daysCount>1&&(y.segments[p.formattedDate]||{}).isFirstDay?(n(),r("small",za," +"+h(y.daysCount-1)+h((o.texts.day[0]||"").toLowerCase()),1)):x("",!0)])):x("",!0),y.content&&!(l.isMonthView&&y.allDay&&a.showAllDayEvents==="short")&&!l.isShortMonthView?(n(),r("div",{key:3,class:"vuecal__event-content",innerHTML:y.content},null,8,qa)):x("",!0)])]),"no-event":F(()=>[le(s.$slots,"no-event",{},()=>[Y(h(o.texts.noEvent),1)])]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],12,Pa)],10,Aa)])],2)]))]),_:3},8,["name","appear"]),o.ready?x("",!0):(n(),r("div",Za,t[7]||(t[7]=[e("div",null,null,-1)])))]))],10,ka)}const Ne=1440,He={weekDays:Array(7).fill(""),weekDaysShort:[],months:Array(12).fill(""),years:"",year:"",month:"",week:"",day:"",today:"",noEvent:"",allDay:"",deleteEvent:"",createEvent:"",dateFormat:"dddd MMMM D, YYYY",am:"am",pm:"pm"},vt=["years","year","month","week","day"],pt=new Is(He),Ka={name:"vue-cal",components:{"vuecal-cell":_t,"vuecal-header":oa,WeekdaysHeadings:bt,AllDayBar:xa},provide(){return{vuecal:this,utils:this.utils,modules:this.modules,previous:this.previous,next:this.next,switchView:this.switchView,updateSelectedDate:this.updateSelectedDate,editEvents:this.editEvents,view:this.view,domEvents:this.domEvents}},props:{activeView:{type:String,default:"week"},allDayBarHeight:{type:[String,Number],default:"25px"},cellClickHold:{type:Boolean,default:!0},cellContextmenu:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:!1},dblclickToNavigate:{type:Boolean,default:!0},disableDatePrototypes:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},disableViews:{type:Array,default:()=>[]},dragToCreateEvent:{type:Boolean,default:!0},dragToCreateThreshold:{type:Number,default:15},editableEvents:{type:[Boolean,Object],default:!1},events:{type:Array,default:()=>[]},eventsCountOnYearView:{type:Boolean,default:!1},eventsOnMonthView:{type:[Boolean,String],default:!1},hideBody:{type:Boolean,default:!1},hideTitleBar:{type:Boolean,default:!1},hideViewSelector:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:[String,Object],default:"en"},maxDate:{type:[String,Date],default:""},minCellWidth:{type:Number,default:0},minDate:{type:[String,Date],default:""},minEventWidth:{type:Number,default:0},minSplitWidth:{type:Number,default:0},onEventClick:{type:[Function,null],default:null},onEventCreate:{type:[Function,null],default:null},onEventDblclick:{type:[Function,null],default:null},overlapsPerTimeStep:{type:Boolean,default:!1},resizeX:{type:Boolean,default:!1},selectedDate:{type:[String,Date],default:""},showAllDayEvents:{type:[Boolean,String],default:!1},showTimeInCells:{type:Boolean,default:!1},showWeekNumbers:{type:[Boolean,String],default:!1},snapToTime:{type:Number,default:0},small:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},splitDays:{type:Array,default:()=>[]},startWeekOnSunday:{type:Boolean,default:!1},stickySplitLabels:{type:Boolean,default:!1},time:{type:Boolean,default:!0},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:Ne},todayButton:{type:Boolean,default:!1},transitions:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},watchRealTime:{type:Boolean,default:!1},xsmall:{type:Boolean,default:!1}},data(){return{ready:!1,texts:{...He},utils:{date:(this.disableDatePrototypes?pt.removePrototypes():!1)||pt,cell:null,event:null},modules:{dnd:null},cellsEl:null,view:{id:"",title:"",startDate:null,endDate:null,firstCellDate:null,lastCellDate:null,selectedDate:null,events:[]},eventIdIncrement:1,now:new Date,timeTickerIds:[null,null],domEvents:{resizeAnEvent:{_eid:null,start:null,split:null,segment:null,originalEndTimeMinutes:0,originalEnd:null,end:null,startCell:null,endCell:null},dragAnEvent:{_eid:null},dragCreateAnEvent:{startCursorY:null,start:null,split:null,event:null},focusAnEvent:{_eid:null,mousedUp:!1},clickHoldAnEvent:{_eid:null,timeout:1200,timeoutId:null},dblTapACell:{taps:0,timeout:500},clickHoldACell:{cellId:null,split:null,timeout:1200,timeoutId:null,eventCreated:!1},cancelClickEventCreation:!1},mutableEvents:[],transitionDirection:"right"}},methods:{async loadLocale(s){if(typeof this.locale=="object"){this.texts=Object.assign({},He,s),this.utils.date.updateTexts(this.texts);return}const t=await Ls(Object.assign({"./i18n/ar.json":()=>K(()=>import("./ar.es-bitOgb9K.js"),[]),"./i18n/bg.json":()=>K(()=>import("./bg.es-5tp0KQRo.js"),[]),"./i18n/bn.json":()=>K(()=>import("./bn.es-C_qR0y0-.js"),[]),"./i18n/bs.json":()=>K(()=>import("./bs.es-DduooXS8.js"),[]),"./i18n/ca.json":()=>K(()=>import("./ca.es-DYDNDJFJ.js"),[]),"./i18n/cs.json":()=>K(()=>import("./cs.es-CvnAvfoI.js"),[]),"./i18n/da.json":()=>K(()=>import("./da.es-C_eJXDX3.js"),[]),"./i18n/de.json":()=>K(()=>import("./de.es-Cp-R9E16.js"),[]),"./i18n/el.json":()=>K(()=>import("./el.es-BZ44a1Tb.js"),[]),"./i18n/en.json":()=>K(()=>import("./en.es-DwVNOttH.js"),[]),"./i18n/es.json":()=>K(()=>import("./es.es-DO8PaQ_q.js"),[]),"./i18n/et.json":()=>K(()=>import("./et.es-DdRIcUrz.js"),[]),"./i18n/fa.json":()=>K(()=>import("./fa.es-XN0av8Tx.js"),[]),"./i18n/fi.json":()=>K(()=>import("./fi.es-B0Iy6aas.js"),[]),"./i18n/fr.json":()=>K(()=>import("./fr.es-B7WXlprl.js"),[]),"./i18n/he.json":()=>K(()=>import("./he.es-BWEk5prp.js"),[]),"./i18n/hr.json":()=>K(()=>import("./hr.es-B_iqHQyr.js"),[]),"./i18n/hu.json":()=>K(()=>import("./hu.es-D_t4Ibxf.js"),[]),"./i18n/id.json":()=>K(()=>import("./id.es-CzHAK-XV.js"),[]),"./i18n/is.json":()=>K(()=>import("./is.es-DChRpym4.js"),[]),"./i18n/it.json":()=>K(()=>import("./it.es-CquQA5xx.js"),[]),"./i18n/ja.json":()=>K(()=>import("./ja.es-B19gsG6H.js"),[]),"./i18n/ka.json":()=>K(()=>import("./ka.es-CuOe65jc.js"),[]),"./i18n/ko.json":()=>K(()=>import("./ko.es-CsMl2USK.js"),[]),"./i18n/lt.json":()=>K(()=>import("./lt.es-vqgjGyMx.js"),[]),"./i18n/mn.json":()=>K(()=>import("./mn.es-BmdwFdas.js"),[]),"./i18n/nl.json":()=>K(()=>import("./nl.es-CFxVMCWy.js"),[]),"./i18n/no.json":()=>K(()=>import("./no.es-qRcuRMwl.js"),[]),"./i18n/pl.json":()=>K(()=>import("./pl.es-BQ3a0ltx.js"),[]),"./i18n/pt-br.json":()=>K(()=>import("./pt-br.es-U9bVHsgs.js"),[]),"./i18n/pt-pt.json":()=>K(()=>import("./pt-pt.es-U9bVHsgs.js"),[]),"./i18n/ro.json":()=>K(()=>import("./ro.es-ldjMjt3l.js"),[]),"./i18n/ru.json":()=>K(()=>import("./ru.es-CS-QKsYL.js"),[]),"./i18n/sk.json":()=>K(()=>import("./sk.es-CAe8sEvL.js"),[]),"./i18n/sl.json":()=>K(()=>import("./sl.es-rdzOxu_X.js"),[]),"./i18n/sq.json":()=>K(()=>import("./sq.es-BY5E06HI.js"),[]),"./i18n/sr.json":()=>K(()=>import("./sr.es-QPseRVBy.js"),[]),"./i18n/sv.json":()=>K(()=>import("./sv.es-BfPUYcV1.js"),[]),"./i18n/tr.json":()=>K(()=>import("./tr.es-Cl6kz_IH.js"),[]),"./i18n/uk.json":()=>K(()=>import("./uk.es-DBEtNQnZ.js"),[]),"./i18n/vi.json":()=>K(()=>import("./vi.es-Bx2g_1jx.js"),[]),"./i18n/zh-cn.json":()=>K(()=>import("./zh-cn.es-BWMmCH-R.js"),[]),"./i18n/zh-hk.json":()=>K(()=>import("./zh-hk.es-DFZ0bKvi.js"),[])}),`./i18n/${s}.json`,3);this.texts=Object.assign({},He,t),this.utils.date.updateTexts(this.texts)},loadDragAndDrop(){K(()=>import("./drag-and-drop.es-CbCm7IHa.js"),[]).then(s=>{const{DragAndDrop:t}=s;this.modules.dnd=new t(this)}).catch(()=>console.warn("Vue Cal: Missing drag & drop module."))},validateView(s){return vt.includes(s)||(console.error(`Vue Cal: invalid active-view parameter provided: "${s}".
A valid view must be one of: ${vt.join(", ")}.`),s="week"),this.enabledViews.includes(s)||(console.warn(`Vue Cal: the provided active-view "${s}" is disabled. Using the "${this.enabledViews[0]}" view instead.`),s=this.enabledViews[0]),s},switchToNarrowerView(s=null){this.transitionDirection="right";const t=this.enabledViews[this.enabledViews.indexOf(this.view.id)+1];t&&this.switchView(t,s)},switchView(s,t=null,a=!1){s=this.validateView(s);const i=this.utils.date,o=this.view.startDate&&this.view.startDate.getTime();if(this.transitions&&a){if(this.view.id===s)return;const d=this.enabledViews;this.transitionDirection=d.indexOf(this.view.id)>d.indexOf(s)?"left":"right"}const l=this.view.id;switch(this.view.events=[],this.view.id=s,this.view.firstCellDate=null,this.view.lastCellDate=null,t||(t=this.view.selectedDate||this.view.startDate),s){case"years":{this.view.startDate=new Date(Math.floor(t.getFullYear()/25)*25||2e3,0,1),this.view.endDate=new Date(this.view.startDate.getFullYear()+25,0,1),this.view.endDate.setSeconds(-1);break}case"year":{this.view.startDate=new Date(t.getFullYear(),0,1),this.view.endDate=new Date(t.getFullYear()+1,0,1),this.view.endDate.setSeconds(-1);break}case"month":{this.view.startDate=new Date(t.getFullYear(),t.getMonth(),1),this.view.endDate=new Date(t.getFullYear(),t.getMonth()+1,1),this.view.endDate.setSeconds(-1);let d=new Date(this.view.startDate);if(d.getDay()!==(this.startWeekOnSunday?0:1)&&(d=i.getPreviousFirstDayOfWeek(d,this.startWeekOnSunday)),this.view.firstCellDate=d,this.view.lastCellDate=i.addDays(d,41),this.view.lastCellDate.setHours(23,59,59,0),this.hideWeekends){if([0,6].includes(this.view.firstCellDate.getDay())){const m=this.view.firstCellDate.getDay()===6&&!this.startWeekOnSunday?2:1;this.view.firstCellDate=i.addDays(this.view.firstCellDate,m)}if([0,6].includes(this.view.startDate.getDay())){const m=this.view.startDate.getDay()===6?2:1;this.view.startDate=i.addDays(this.view.startDate,m)}if([0,6].includes(this.view.lastCellDate.getDay())){const m=this.view.lastCellDate.getDay()===0&&!this.startWeekOnSunday?2:1;this.view.lastCellDate=i.subtractDays(this.view.lastCellDate,m)}if([0,6].includes(this.view.endDate.getDay())){const m=this.view.endDate.getDay()===0?2:1;this.view.endDate=i.subtractDays(this.view.endDate,m)}}break}case"week":{t=i.getPreviousFirstDayOfWeek(t,this.startWeekOnSunday);const d=this.hideWeekends?5:7;this.view.startDate=this.hideWeekends&&this.startWeekOnSunday?i.addDays(t,1):t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=i.addDays(t,d),this.view.endDate.setSeconds(-1);break}case"day":{this.view.startDate=t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=new Date(t),this.view.endDate.setHours(23,59,59,0);break}}this.addEventsToView();const u=this.view.startDate&&this.view.startDate.getTime();if(!(l===s&&u===o)&&(this.$emit("update:activeView",s),this.ready)){const d=this.view.startDate,m={view:s,startDate:d,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate,outOfScopeEvents:this.view.outOfScopeEvents.map(this.cleanupEvent)}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:i.getWeek(this.startWeekOnSunday?i.addDays(d,1):d)}:{}};this.$emit("view-change",m)}},previous(){this.previousNext(!1)},next(){this.previousNext()},previousNext(s=!0){const t=this.utils.date;this.transitionDirection=s?"right":"left";const a=s?1:-1;let i=null;const{startDate:o,id:l}=this.view;switch(l){case"years":i=new Date(o.getFullYear()+25*a,0,1);break;case"year":i=new Date(o.getFullYear()+1*a,1,1);break;case"month":i=new Date(o.getFullYear(),o.getMonth()+1*a,1);break;case"week":i=t[s?"addDays":"subtractDays"](t.getPreviousFirstDayOfWeek(o,this.startWeekOnSunday),7);break;case"day":i=t[s?"addDays":"subtractDays"](o,1);const u=i.getDay(),d=this.startWeekOnSunday?u:(u||7)-1;if(this.weekDays[d].hide){const c=this.weekDays.map((w,y)=>({...w,i:y}));let p=0;s?([...c.slice(d),...c].find(w=>(p++,!w.hide)).i,p--):[...c,...c.slice(0,d)].reverse().find(w=>(p++,!w.hide)).i,i=t[s?"addDays":"subtractDays"](i,p)}break}i&&this.switchView(l,i)},addEventsToView(s=[]){const t=this.utils.event,{startDate:a,endDate:i,firstCellDate:o,lastCellDate:l}=this.view;if(s.length||(this.view.events=[]),s=s.length?s:[...this.mutableEvents],!s||this.isYearsOrYearView&&!this.eventsCountOnYearView)return;let u=s.filter(d=>t.eventInRange(d,a,i));!this.isYearsOrYearView&&!(this.isMonthView&&!this.eventsOnMonthView)&&(u=u.map(d=>d.daysCount>1?t.createEventSegments(d,o||a,l||i):d)),this.view.events.push(...u),this.isMonthView&&(this.view.outOfScopeEvents=[],s.forEach(d=>{(t.eventInRange(d,o,a)||t.eventInRange(d,i,l))&&(this.view.events.some(m=>m._eid===d._eid)||this.view.outOfScopeEvents.push(d))}))},findAncestor(s,t){for(;(s=s.parentElement)&&!s.classList.contains(t););return s},isDOMElementAnEvent(s){return s.classList.contains("vuecal__event")||this.findAncestor(s,"vuecal__event")},onMouseMove(s){const{resizeAnEvent:t,dragAnEvent:a,dragCreateAnEvent:i}=this.domEvents;t._eid===null&&a._eid===null&&!i.start||(s.preventDefault(),t._eid?this.eventResizing(s):this.dragToCreateEvent&&i.start&&this.eventDragCreation(s))},onMouseUp(s){const{focusAnEvent:t,resizeAnEvent:a,clickHoldAnEvent:i,clickHoldACell:o,dragCreateAnEvent:l}=this.domEvents,{_eid:u}=i,{_eid:d}=a;let m=!1;const{event:c,start:p}=l,w=this.isDOMElementAnEvent(s.target),y=t.mousedUp;if(t.mousedUp=!1,w&&(this.domEvents.cancelClickEventCreation=!0),o.eventCreated)return;if(d){const{originalEnd:k,originalEndTimeMinutes:S,endTimeMinutes:g}=a,M=this.view.events.find(O=>O._eid===a._eid);if(m=g&&g!==S,M&&M.end.getTime()!==k.getTime()){const O=this.mutableEvents.find(V=>V._eid===a._eid);O.endTimeMinutes=M.endTimeMinutes,O.end=M.end;const R=this.cleanupEvent(M),I={...this.cleanupEvent(M),end:k,endTimeMinutes:M.originalEndTimeMinutes};this.$emit("event-duration-change",{event:R,oldDate:a.originalEnd,originalEvent:I}),this.$emit("event-change",{event:R,originalEvent:I})}M&&(M.resizing=!1),a._eid=null,a.start=null,a.split=null,a.segment=null,a.originalEndTimeMinutes=null,a.originalEnd=null,a.endTimeMinutes=null,a.startCell=null,a.endCell=null}else p&&(c&&(this.emitWithEvent("event-drag-create",c),l.event.resizing=!1),l.start=null,l.split=null,l.event=null);!w&&!d&&this.unfocusEvent(),i.timeoutId&&!u&&(clearTimeout(i.timeoutId),i.timeoutId=null),o.timeoutId&&(clearTimeout(o.timeoutId),o.timeoutId=null);const E=typeof this.onEventClick=="function";if(y&&!m&&!u&&!c&&E){let k=this.view.events.find(S=>S._eid===t._eid);return!k&&this.isMonthView&&(k=this.view.outOfScopeEvents.find(S=>S._eid===t._eid)),k&&this.onEventClick(k,s)}},onKeyUp(s){s.keyCode===27&&this.cancelDelete()},eventResizing(s){const{resizeAnEvent:t}=this.domEvents,a=this.view.events.find(c=>c._eid===t._eid)||{segments:{}},{minutes:i,cursorCoords:o}=this.minutesAtCursor(s),l=a.segments&&a.segments[t.segment],{date:u,event:d}=this.utils,m=Math.max(i,this.timeFrom+1,(l||a).startTimeMinutes+1);if(a.endTimeMinutes=t.endTimeMinutes=m,this.snapToTime){const c=a.endTimeMinutes+this.snapToTime/2;a.endTimeMinutes=c-c%this.snapToTime}if(l&&(l.endTimeMinutes=a.endTimeMinutes),a.end.setHours(0,a.endTimeMinutes,a.endTimeMinutes===Ne?-1:0,0),this.resizeX&&this.isWeekView){a.daysCount=u.countDays(a.start,a.end);const c=this.cellsEl,p=c.offsetWidth/c.childElementCount,w=Math.floor(o.x/p);if(t.startCell===null&&(t.startCell=w-(a.daysCount-1)),t.endCell!==w){t.endCell=w;const y=u.addDays(a.start,w-t.startCell),E=Math.max(u.countDays(a.start,y),1);if(E!==a.daysCount){let k=null;E>a.daysCount?k=d.addEventSegment(a):k=d.removeEventSegment(a),t.segment=k,a.endTimeMinutes+=.001}}}this.$emit("event-resizing",{_eid:a._eid,end:a.end,endTimeMinutes:a.endTimeMinutes})},eventDragCreation(s){const{dragCreateAnEvent:t}=this.domEvents,{start:a,startCursorY:i,split:o}=t,l=new Date(a),{minutes:u,cursorCoords:{y:d}}=this.minutesAtCursor(s);if(!(!t.event&&Math.abs(i-d)<this.dragToCreateThreshold))if(t.event){if(l.setHours(0,u,u===Ne?-1:0,0),this.snapToTime){let p=l.getHours()*60+l.getMinutes();const w=p+this.snapToTime/2;p=w-w%this.snapToTime,l.setHours(0,p,0,0)}const m=a<l,{event:c}=t;c.start=m?a:l,c.end=m?l:a,c.startTimeMinutes=c.start.getHours()*60+c.start.getMinutes(),c.endTimeMinutes=c.end.getHours()*60+c.end.getMinutes()}else{if(t.event=this.utils.event.createAnEvent(a,1,{split:o}),!t.event){t.start=null,t.split=null,t.event=null;return}t.event.resizing=!0}},unfocusEvent(){const{focusAnEvent:s,clickHoldAnEvent:t}=this.domEvents,a=this.view.events.find(i=>i._eid===(s._eid||t._eid));s._eid=null,t._eid=null,a&&(a.focused=!1,a.deleting=!1)},cancelDelete(){const{clickHoldAnEvent:s}=this.domEvents;if(s._eid){const t=this.view.events.find(a=>a._eid===s._eid);t&&(t.deleting=!1),s._eid=null,s.timeoutId=null}},onEventTitleBlur(s,t){if(t.title===s.target.innerHTML)return;const a=t.title;t.title=s.target.innerHTML;const i=this.cleanupEvent(t);this.$emit("event-title-change",{event:i,oldTitle:a}),this.$emit("event-change",{event:i,originalEvent:{...i,title:a}})},updateMutableEvents(){const s=this.utils.date;this.mutableEvents=[],this.events.forEach(t=>{const a=typeof t.start=="string"?s.stringToDate(t.start):t.start,i=s.formatDateLite(a),o=s.dateToMinutes(a);let l=null;typeof t.end=="string"&&t.end.includes("24:00")?(l=new Date(t.end.replace(" 24:00","")),l.setHours(23,59,59,0)):l=typeof t.end=="string"?s.stringToDate(t.end):t.end;let u=s.formatDateLite(l),d=s.dateToMinutes(l);(!d||d===Ne)&&(!this.time||typeof t.end=="string"&&t.end.length===10?l.setHours(23,59,59,0):l.setSeconds(l.getSeconds()-1),u=s.formatDateLite(l),d=Ne);const m=i!==u;t=Object.assign({...this.utils.event.eventDefaults},t,{_eid:`${this._.uid}_${this.eventIdIncrement++}`,segments:m?{}:null,start:a,startTimeMinutes:o,end:l,endTimeMinutes:d,daysCount:m?s.countDays(a,l):1,class:t.class}),this.mutableEvents.push(t)})},minutesAtCursor(s){return this.utils.cell.minutesAtCursor(s)},createEvent(s,t,a={}){return this.utils.event.createAnEvent(s,t,a)},cleanupEvent(s){return s={...s},["segments","deletable","deleting","titleEditable","resizable","resizing","draggable","dragging","draggingStatic","focused"].forEach(a=>{a in s&&delete s[a]}),s.repeat||delete s.repeat,s},emitWithEvent(s,t){this.$emit(s,this.cleanupEvent(t))},updateSelectedDate(s){if(s&&typeof s=="string"?s=this.utils.date.stringToDate(s):s=new Date(s),s&&s instanceof Date){const{selectedDate:t}=this.view;t&&(this.transitionDirection=t.getTime()>s.getTime()?"left":"right"),s.setHours(0,0,0,0),(!t||t.getTime()!==s.getTime())&&(this.view.selectedDate=s),this.switchView(this.view.id)}this.$emit("update:selected-date",this.view.selectedDate)},getWeekNumber(s){const t=this.utils.date,i=this.firstCellDateWeekNumber+s,o=this.startWeekOnSunday?1:0;return i>52?t.getWeek(t.addDays(this.view.firstCellDate,7*s+o)):i},timeTick(){this.now=new Date,this.timeTickerIds[1]=setTimeout(this.timeTick,60*1e3)},updateDateTexts(){this.utils.date.updateTexts(this.texts)},alignWithScrollbar(){if(document.getElementById("vuecal-align-with-scrollbar"))return;const s=this.$refs.vuecal.getElementsByClassName("vuecal__scrollbar-check")[0],t=s.offsetWidth-s.children[0].offsetWidth;if(t){const a=document.createElement("style");a.id="vuecal-align-with-scrollbar",a.type="text/css",a.innerHTML=`.vuecal--view-with-time .vuecal__weekdays-headings,.vuecal--view-with-time .vuecal__all-day {padding-right: ${t}px}`,document.head.appendChild(a)}},cellOrSplitHasEvents(s,t=null){return s.length&&(!t&&s.length||t&&s.some(a=>a.split===t.id))}},created(){this.utils.cell=new Ns(this),this.utils.event=new Us(this,this.utils.date),this.loadLocale(this.locale),this.editEvents.drag&&this.loadDragAndDrop(),this.updateMutableEvents(this.events),this.view.id=this.currentView,this.selectedDate?this.updateSelectedDate(this.selectedDate):(this.view.selectedDate=new Date,this.switchView(this.currentView)),this.time&&this.watchRealTime&&(this.timeTickerIds[0]=setTimeout(this.timeTick,(60-this.now.getSeconds())*1e3))},mounted(){const s=this.utils.date,t="ontouchstart"in window,{resize:a,drag:i,create:o,delete:l,title:u}=this.editEvents,d=this.onEventClick&&typeof this.onEventClick=="function";(a||i||o||l||u||d)&&window.addEventListener(t?"touchend":"mouseup",this.onMouseUp),(a||i||o&&this.dragToCreateEvent)&&window.addEventListener(t?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),u&&window.addEventListener("keyup",this.onKeyUp),t&&(this.$refs.vuecal.oncontextmenu=function(p){p.preventDefault(),p.stopPropagation()}),this.hideBody||this.alignWithScrollbar();const m=this.view.startDate,c={view:this.view.id,startDate:m,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:s.getWeek(this.startWeekOnSunday?s.addDays(m,1):m)}:{}};this.$emit("ready",c),this.ready=!0},beforeUnmount(){const s="ontouchstart"in window;window.removeEventListener(s?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),window.removeEventListener(s?"touchend":"mouseup",this.onMouseUp),window.removeEventListener("keyup",this.onKeyUp),this.timeTickerIds[0]&&clearTimeout(this.timeTickerIds[0]),this.timeTickerIds[1]&&clearTimeout(this.timeTickerIds[1]),this.timeTickerIds=[null,null]},computed:{editEvents(){return this.editableEvents&&typeof this.editableEvents=="object"?{title:!!this.editableEvents.title,drag:!!this.editableEvents.drag,resize:!!this.editableEvents.resize,create:!!this.editableEvents.create,delete:!!this.editableEvents.delete}:{title:!!this.editableEvents,drag:!!this.editableEvents,resize:!!this.editableEvents,create:!!this.editableEvents,delete:!!this.editableEvents}},views(){return{years:{label:this.texts.years,enabled:!this.disableViews.includes("years")},year:{label:this.texts.year,enabled:!this.disableViews.includes("year")},month:{label:this.texts.month,enabled:!this.disableViews.includes("month")},week:{label:this.texts.week,enabled:!this.disableViews.includes("week")},day:{label:this.texts.day,enabled:!this.disableViews.includes("day")}}},currentView(){return this.validateView(this.activeView)},enabledViews(){return Object.keys(this.views).filter(s=>this.views[s].enabled)},hasTimeColumn(){return this.time&&this.isWeekOrDayView},isShortMonthView(){return this.isMonthView&&this.eventsOnMonthView==="short"},firstCellDateWeekNumber(){const s=this.utils.date,t=this.view.firstCellDate;return s.getWeek(this.startWeekOnSunday?s.addDays(t,1):t)},timeCells(){const s=[];for(let t=this.timeFrom,a=this.timeTo;t<a;t+=this.timeStep)s.push({hours:Math.floor(t/60),minutes:t%60,label:this.utils.date.formatTime(t,this.TimeFormat),value:t});return s},TimeFormat(){return this.timeFormat||(this.twelveHour?"h:mm{am}":"HH:mm")},daySplits(){return(this.splitDays.filter(s=>!s.hide)||[]).map((s,t)=>({...s,id:s.id||t+1}))},hasSplits(){return this.daySplits.length&&this.isWeekOrDayView},hasShortEvents(){return this.showAllDayEvents==="short"},cellOrSplitMinWidth(){let s=null;return this.hasSplits&&this.minSplitWidth?s=this.visibleDaysCount*this.minSplitWidth*this.daySplits.length:this.minCellWidth&&this.isWeekView&&(s=this.visibleDaysCount*this.minCellWidth),s},allDayBar(){let s=this.allDayBarHeight||null;return s&&!isNaN(s)&&(s+="px"),{cells:this.viewCells,options:this.$props,label:this.texts.allDay,shortEvents:this.hasShortEvents,daySplits:this.hasSplits&&this.daySplits||[],cellOrSplitMinWidth:this.cellOrSplitMinWidth,height:s}},minTimestamp(){let s=null;return this.minDate&&typeof this.minDate=="string"?s=this.utils.date.stringToDate(this.minDate):this.minDate&&this.minDate instanceof Date&&(s=this.minDate),s?s.getTime():null},maxTimestamp(){let s=null;return this.maxDate&&typeof this.maxDate=="string"?s=this.utils.date.stringToDate(this.maxDate):this.maxDate&&this.maxDate instanceof Date&&(s=this.maxDate),s?s.getTime():null},weekDays(){let{weekDays:s,weekDaysShort:t=[]}=this.texts;return s=s.slice(0).map((a,i)=>({label:a,...t.length?{short:t[i]}:{},hide:this.hideWeekends&&i>=5||this.hideWeekdays.length&&this.hideWeekdays.includes(i+1)})),this.startWeekOnSunday&&s.unshift(s.pop()),s},weekDaysInHeader(){return this.isMonthView||this.isWeekView&&!this.minCellWidth&&!(this.hasSplits&&this.minSplitWidth)},months(){return this.texts.months.map(s=>({label:s}))},specialDayHours(){return!this.specialHours||!Object.keys(this.specialHours).length?{}:Array(7).fill("").map((s,t)=>{let a=this.specialHours[t+1]||[];return Array.isArray(a)||(a=[a]),s=[],a.forEach(({from:i,to:o,class:l,label:u},d)=>{s[d]={day:t+1,from:[null,void 0].includes(i)?null:i*1,to:[null,void 0].includes(o)?null:o*1,class:l||"",label:u||""}}),s})},viewTitle(){const s=this.utils.date;let t="";const a=this.view.startDate,i=a.getFullYear(),o=a.getMonth();switch(this.view.id){case"years":{t=this.texts.years;break}case"year":{t=i;break}case"month":{t=`${this.months[o].label} ${i}`;break}case"week":{const l=this.view.endDate,u=a.getFullYear();let d=this.texts.months[a.getMonth()];this.xsmall&&(d=d.substring(0,3));let m=`${d} ${u}`;if(l.getMonth()!==a.getMonth()){const c=l.getFullYear();let p=this.texts.months[l.getMonth()];this.xsmall&&(p=p.substring(0,3)),u===c?m=`${d} - ${p} ${u}`:this.small?m=`${d.substring(0,3)} ${u} - ${p.substring(0,3)} ${c}`:m=`${d} ${u} - ${p} ${c}`}t=`${this.texts.week} ${s.getWeek(this.startWeekOnSunday?s.addDays(a,1):a)} (${m})`;break}case"day":{t=this.utils.date.formatDate(a,this.texts.dateFormat,this.texts);break}}return t},viewCells(){const s=this.utils.date;let t=[],a=null,i=!1;this.watchRealTime||(this.now=new Date);const o=this.now;switch(this.view.id){case"years":{a=this.view.startDate.getFullYear(),t=Array.apply(null,Array(25)).map((l,u)=>{const d=new Date(a+u,0,1),m=new Date(a+u+1,0,1);return m.setSeconds(-1),{startDate:d,formattedDate:s.formatDateLite(d),endDate:m,content:a+u,current:a+u===o.getFullYear()}});break}case"year":{a=this.view.startDate.getFullYear(),t=Array.apply(null,Array(12)).map((l,u)=>{const d=new Date(a,u,1),m=new Date(a,u+1,1);return m.setSeconds(-1),{startDate:d,formattedDate:s.formatDateLite(d),endDate:m,content:this.xsmall?this.months[u].label.substr(0,3):this.months[u].label,current:u===o.getMonth()&&a===o.getFullYear()}});break}case"month":{const l=this.view.startDate.getMonth(),u=new Date(this.view.firstCellDate);i=!1,t=Array.apply(null,Array(42)).map((d,m)=>{const c=s.addDays(u,m),p=new Date(c);p.setHours(23,59,59,0);const w=!i&&s.isToday(c)&&!i++;return{startDate:c,formattedDate:s.formatDateLite(c),endDate:p,content:c.getDate(),today:w,outOfScope:c.getMonth()!==l,class:`vuecal__cell--day${c.getDay()||7}`}}),(this.hideWeekends||this.hideWeekdays.length)&&(t=t.filter(d=>{const m=d.startDate.getDay()||7;return!(this.hideWeekends&&m>=6||this.hideWeekdays.length&&this.hideWeekdays.includes(m))}));break}case"week":{i=!1;const l=this.view.startDate,u=this.weekDays;t=u.map((d,m)=>{const c=s.addDays(l,this.startWeekOnSunday&&this.hideWeekends?m-1:m),p=new Date(c);p.setHours(23,59,59,0);const w=(c.getDay()||7)-1;return{startDate:c,formattedDate:s.formatDateLite(c),endDate:p,today:!i&&s.isToday(c)&&!i++,specialHours:this.specialDayHours[w]||[]}}).filter((d,m)=>!u[m].hide);break}case"day":{const l=this.view.startDate,u=new Date(this.view.startDate);u.setHours(23,59,59,0);const d=(l.getDay()||7)-1;t=[{startDate:l,formattedDate:s.formatDateLite(l),endDate:u,today:s.isToday(l),specialHours:this.specialDayHours[d]||[]}];break}}return t},visibleDaysCount(){return this.isDayView?1:7-this.weekDays.reduce((s,t)=>s+t.hide,0)},cellWidth(){return 100/this.visibleDaysCount},cssClasses(){const{resizeAnEvent:s,dragAnEvent:t,dragCreateAnEvent:a}=this.domEvents;return{[`vuecal--${this.view.id}-view`]:!0,[`vuecal--${this.locale}`]:this.locale,"vuecal--no-time":!this.time,"vuecal--view-with-time":this.hasTimeColumn,"vuecal--week-numbers":this.showWeekNumbers&&this.isMonthView,"vuecal--twelve-hour":this.twelveHour,"vuecal--click-to-navigate":this.clickToNavigate,"vuecal--hide-weekends":this.hideWeekends,"vuecal--split-days":this.hasSplits,"vuecal--sticky-split-labels":this.hasSplits&&this.stickySplitLabels,"vuecal--overflow-x":this.minCellWidth&&this.isWeekView||this.hasSplits&&this.minSplitWidth,"vuecal--small":this.small,"vuecal--xsmall":this.xsmall,"vuecal--resizing-event":s._eid,"vuecal--drag-creating-event":a.event,"vuecal--dragging-event":t._eid,"vuecal--events-on-month-view":this.eventsOnMonthView,"vuecal--short-events":this.isMonthView&&this.eventsOnMonthView==="short","vuecal--has-touch":typeof window<"u"&&"ontouchstart"in window}},isYearsOrYearView(){return["years","year"].includes(this.view.id)},isYearsView(){return this.view.id==="years"},isYearView(){return this.view.id==="year"},isMonthView(){return this.view.id==="month"},isWeekOrDayView(){return["week","day"].includes(this.view.id)},isWeekView(){return this.view.id==="week"},isDayView(){return this.view.id==="day"}},watch:{events:{handler(s,t){this.updateMutableEvents(s),this.addEventsToView()},deep:!0},locale(s){this.loadLocale(s)},selectedDate(s){this.updateSelectedDate(s)},activeView(s){this.switchView(s)}}},Ja=Ae(Ka,[["render",Ga]]),Xa={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Qa={class:"flex justify-between items-center mb-4"},el={class:"flex gap-3"},tl={class:"flex rounded-md shadow-sm mr-3"},sl={key:0,class:"mb-4 bg-gray-50 p-4 rounded-lg"},al={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ll=["value"],il={class:"mt-1 relative rounded-md shadow-sm"},nl={key:1,class:"text-center text-gray-600 text-sm animate-pulse py-4"},ol={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md"},rl={key:3},dl={key:0,class:"space-y-4"},ul={key:0,class:"flex justify-between"},cl={class:"flex-grow"},ml={class:"text-sm text-red-500 italic"},vl={class:"flex items-center mt-1"},pl={class:"text-xs text-gray-500"},hl={key:1},gl={class:"flex-grow"},fl={class:"flex justify-between items-center mb-3"},yl={class:"text-sm text-gray-600 bg-blue-100 px-2 py-1 rounded-full"},wl={class:"mb-3"},bl={class:"text-sm text-gray-700 ml-6"},_l={class:"mb-3"},xl={class:"text-sm text-gray-700 ml-6"},kl={class:"mb-2"},Dl={class:"text-sm text-gray-700 ml-6"},Cl={class:"flex items-center mt-3 pt-2 border-t border-blue-200"},Tl={class:"text-xs text-gray-500"},El={key:1,class:"text-gray-400 text-sm"},Ml={key:4,class:"mt-4"},Sl={class:"flex justify-between items-center mb-6"},jl={class:"text-lg font-medium text-gray-900"},$l=["innerHTML"],Vl=["innerHTML"],Al={key:0,class:"mt-1 text-xs p-1 rounded bg-red-50 border-l-2 border-red-500 text-red-700"},Ol={class:"mt-6 bg-white rounded-lg shadow p-4"},Ll={key:0},Il={class:"font-medium text-gray-800 mb-2"},Pl={class:"font-medium text-blue-800"},Nl={class:"text-sm text-gray-600 mt-1"},Rl={key:1,class:"text-gray-500 text-sm"},Ul={__name:"DailyStandups",props:{projectId:{type:Number,required:!0},users:{type:Array,default:()=>[]}},emits:["standupAdded"],setup(s,{emit:t}){const a=s,i=b("list"),o=b(!1),l=b(!1),u=b(""),d=b([]),m=b(""),c=Te({startDate:"",endDate:"",search:"",userId:""}),p=D=>{const _=ne(D);return _.isValid()?{start:_.clone().startOf("month").format("YYYY-MM-DD"),end:_.clone().endOf("month").format("YYYY-MM-DD")}:(console.warn("getMonthRange received an invalid input, defaulting to current date:",D),{start:ne().startOf("month").format("YYYY-MM-DD"),end:ne().endOf("month").format("YYYY-MM-DD")})};let w=null;const y=()=>{clearTimeout(w),w=setTimeout(()=>{k()},500)},E=async()=>{l.value=!0,u.value="";try{const D=new URLSearchParams;c.startDate&&D.append("start_date",c.startDate),c.endDate&&D.append("end_date",c.endDate),c.search&&D.append("search",c.search),c.userId&&D.append("user_id",String(c.userId));const _=D.toString(),$=`/api/projects/${a.projectId}/sections/notes?type=standup${_?`&${_}`:""}`,se=await window.axios.get($);d.value=se.data.filter(ie=>ie.type==="standup")}catch(D){console.error("Error fetching project standups:",D),u.value="Failed to load standups. Please try again."}finally{l.value=!1}},k=()=>{E()},S=()=>{c.search="",c.userId="",c.startDate="",c.endDate="",E()},g=()=>{m.value=ne(m.value).subtract(1,"month").format("YYYY-MM-DD")},M=()=>{m.value=ne(m.value).add(1,"month").format("YYYY-MM-DD")};ce(()=>m.value,D=>{if(i.value==="calendar"&&D){const _=p(D);c.startDate=_.start,c.endDate=_.end,E()}}),ce(()=>i.value,D=>{D==="calendar"?(c.search="",c.userId="",m.value=p(new Date).start):(c.startDate="",c.endDate="",E())});const O=H(()=>(d.value||[]).map(D=>{var se;if(!(D!=null&&D.created_at))return null;const _=ne(D.created_at);if(!_.isValid())return null;const $=U(D.content);return{start:_.format("YYYY-MM-DD HH:mm"),end:_.format("YYYY-MM-DD HH:mm"),title:`${((se=D.user)==null?void 0:se.name)||"Unknown"} - Standup`,content:`Yesterday: ${$.yesterday}
Today: ${$.today}
Blockers: ${$.blockers}`,class:"standup-event",standupData:D}}).filter(Boolean));ke(()=>{E()});const R=H(()=>{if(!d.value)return[];let D=[...d.value];if(c.startDate&&(D=D.filter(_=>_.created_at&&ne(_.created_at).isSameOrAfter(c.startDate,"day"))),c.endDate&&(D=D.filter(_=>_.created_at&&ne(_.created_at).isSameOrBefore(c.endDate,"day"))),c.userId&&(D=D.filter(_=>_.user_id===parseInt(c.userId))),c.search){const _=c.search.toLowerCase();D=D.filter($=>$.content&&$.content!=="[Encrypted content could not be decrypted]"&&$.content.toLowerCase().includes(_))}return D.sort((_,$)=>ne($.created_at).valueOf()-ne(_.created_at).valueOf())}),I=D=>{const _=ne(D).day();return _>=1&&_<=5},V=D=>ne(D).isBefore(ne(),"day"),B=(D,_)=>ne(D).isSame(_,"day"),U=D=>{var C,f,L,T;if(!D||typeof D!="string"||D==="[Encrypted content could not be decrypted]"||D.trim()==="")return{yesterday:"N/A",today:"N/A",blockers:"N/A",date:"N/A"};const _=((C=D.match(/\*\*Yesterday:\*\* ([^\n]+)/))==null?void 0:C[1].trim())||"Nothing",$=((f=D.match(/\*\*Today:\*\* ([^\n]+)/))==null?void 0:f[1].trim())||"Nothing",se=((L=D.match(/\*\*Blockers:\*\* ([^\n]+)/))==null?void 0:L[1].trim())||"None",ie=((T=D.match(/\*\*Daily Standup - ([^*]+)\*\*/))==null?void 0:T[1].trim())||ne().format("L");return{yesterday:_,today:$,blockers:se,date:ie}},j=H(()=>{const D={};return(d.value||[]).forEach(_=>{if(!(_!=null&&_.created_at))return;const $=ne(_.created_at).format("YYYY-MM-DD");D[$]||(D[$]=[]),D[$].push(_)}),D});return(D,_)=>(n(),r("div",Xa,[e("div",Qa,[_[11]||(_[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Daily Standups",-1)),e("div",el,[e("div",tl,[e("button",{type:"button",onClick:_[0]||(_[0]=$=>i.value="list"),class:X([i.value==="list"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-l-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},_[8]||(_[8]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})]),Y(" List ")],-1)]),2),e("button",{type:"button",onClick:_[1]||(_[1]=$=>i.value="calendar"),class:X([i.value==="calendar"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-r-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},_[9]||(_[9]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),Y(" Calendar ")],-1)]),2)]),v(pe,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:_[2]||(_[2]=$=>o.value=!0)},{default:F(()=>_[10]||(_[10]=[Y(" Submit Standup ",-1)])),_:1,__:[10]})])]),i.value==="list"?(n(),r("div",sl,[e("div",al,[e("div",null,[_[12]||(_[12]=e("label",{for:"standupStartDate",class:"block text-sm font-medium text-gray-700 mb-1"},"From Date",-1)),ve(e("input",{type:"date",id:"standupStartDate","onUpdate:modelValue":_[3]||(_[3]=$=>c.startDate=$),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:k},null,544),[[xe,c.startDate]])]),e("div",null,[_[13]||(_[13]=e("label",{for:"standupEndDate",class:"block text-sm font-medium text-gray-700 mb-1"},"To Date",-1)),ve(e("input",{type:"date",id:"standupEndDate","onUpdate:modelValue":_[4]||(_[4]=$=>c.endDate=$),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:k},null,544),[[xe,c.endDate]])]),e("div",null,[_[15]||(_[15]=e("label",{for:"standupUserFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),ve(e("select",{id:"standupUserFilter","onUpdate:modelValue":_[5]||(_[5]=$=>c.userId=$),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:k},[_[14]||(_[14]=e("option",{value:""},"All Users",-1)),(n(!0),r(J,null,te(a.users,$=>(n(),r("option",{key:$.id,value:$.id},h($.name),9,ll))),128))],544),[[We,c.userId]])]),e("div",null,[_[17]||(_[17]=e("label",{for:"standupSearchFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Search Content",-1)),e("div",il,[ve(e("input",{type:"text",id:"standupSearchFilter","onUpdate:modelValue":_[6]||(_[6]=$=>c.search=$),class:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pr-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search in standup content...",onInput:y},null,544),[[xe,c.search]]),_[16]||(_[16]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:S}," Reset Filters ")])])):x("",!0),l.value?(n(),r("div",nl,"Loading standups...")):u.value?(n(),r("div",ol,h(u.value),1)):i.value==="list"?(n(),r("div",rl,[R.value.length?(n(),r("div",dl,[(n(!0),r(J,null,te(R.value,$=>{var se,ie;return n(),r("div",{key:$.id,class:"p-4 bg-blue-50 rounded-md shadow-sm hover:bg-blue-100 transition-colors border-l-4 border-blue-500"},[$.content==="[Encrypted content could not be decrypted]"?(n(),r("div",ul,[e("div",cl,[e("p",ml,[Y(h($.content),1),_[18]||(_[18]=e("span",{class:"text-xs text-red-400 block mt-1"},"(There was an issue decrypting this standup. Please contact an administrator.)",-1))]),e("div",vl,[e("p",pl,"Submitted by "+h(((se=$.user)==null?void 0:se.name)||"Unknown")+" on "+h(q(ne)($.created_at).format("L")),1)])])])):(n(),r("div",hl,[e("div",gl,[e("div",fl,[_[19]||(_[19]=e("h3",{class:"text-md font-bold text-gray-800"},"Daily Standup",-1)),e("span",yl,h(U($.content).date),1)]),e("div",wl,[_[20]||(_[20]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Yesterday:")],-1)),e("p",bl,h(U($.content).yesterday),1)]),e("div",_l,[_[21]||(_[21]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-green-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Today:")],-1)),e("p",xl,h(U($.content).today),1)]),e("div",kl,[_[22]||(_[22]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-red-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Blockers:")],-1)),e("p",Dl,h(U($.content).blockers),1)]),e("div",Cl,[e("p",Tl,"Submitted by "+h(((ie=$.user)==null?void 0:ie.name)||"Unknown")+" on "+h(q(ne)($.created_at).format("L")),1)])])]))])}),128))])):(n(),r("p",El,"No daily standups found for the selected criteria."))])):i.value==="calendar"?(n(),r("div",Ml,[e("div",Sl,[e("button",{onClick:g,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},_[23]||(_[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("h3",jl,h(m.value?q(ne)(m.value).format("MMMM YYYY"):"Loading..."),1),e("button",{onClick:M,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},_[24]||(_[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),v(q(Ja),{class:"vuecal--blue-theme","active-view":"month",events:O.value,"selected-date":m.value,"hide-title-bar":"","disable-views":["week","day","years","year"],twelveHour:!0,"time-from":480,"time-to":1200,"time-step":30,"events-on-month-view":"short"},{event:F(({event:$})=>[e("div",{class:"vuecal__event-title",innerHTML:$.title},null,8,$l),e("div",{class:"vuecal__event-content",innerHTML:$.content},null,8,Vl)]),"cell-content":F(({view:$,date:se})=>[$.id==="month"?(n(),r(J,{key:0},[se&&I(se)&&V(se)&&!O.value.some(ie=>B(ie.start,se))?(n(),r("div",Al," No standups ")):x("",!0)],64)):x("",!0)]),_:1},8,["events","selected-date"]),_[26]||(_[26]=Gt('<div class="mt-4 flex items-center space-x-4 text-sm"><div class="flex items-center"><span class="inline-block w-3 h-3 bg-blue-50 border-l-2 border-blue-500 mr-1"></span><span>Standup submitted</span></div><div class="flex items-center"><span class="inline-block w-3 h-3 bg-red-50 border-l-2 border-red-500 mr-1"></span><span>Missing standup</span></div></div>',1)),e("div",Ol,[_[25]||(_[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Standups Outside Current Month View",-1)),Object.entries(j.value).some(([$])=>!q(ne)($).isSame(m.value,"month"))?(n(),r("div",Ll,[(n(!0),r(J,null,te(Object.entries(j.value).filter(([$])=>!q(ne)($).isSame(m.value,"month")).sort(($,se)=>q(ne)($[0]).valueOf()-q(ne)(se[0]).valueOf()),([$,se])=>(n(),r("div",{key:$,class:"mb-4"},[e("div",Il,h(q(ne)($).format("dddd, MMMM Do YYYY")),1),(n(!0),r(J,null,te(se,ie=>{var C;return n(),r("div",{key:ie.id,class:"p-2 mb-2 rounded bg-blue-50 border-l-2 border-blue-500"},[e("div",Pl,h(((C=ie.user)==null?void 0:C.name)||"Unknown"),1),e("div",Nl,h(q(ne)(ie.created_at).format("LT")),1)])}),128))]))),128))])):(n(),r("div",Rl,"No standups outside the current month view."))])])):x("",!0),v(ft,{show:o.value,onClose:_[7]||(_[7]=$=>o.value=!1),onStandupAdded:E,projectId:s.projectId},null,8,["show","projectId"])]))}},Hl={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-6"},Bl={class:"space-y-6"},Fl={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Wl={class:"flex items-center"},Yl={class:"flex items-center"},zl={class:"space-y-6 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},ql={class:"space-y-4"},Zl={class:"text-gray-900 font-medium break-words"},Gl={class:"text-gray-900"},Kl={key:0,class:"text-xs text-gray-500 mt-1"},Jl={key:0},Xl={class:"text-gray-900 whitespace-pre-wrap"},Ql={key:1},ei={class:"flex flex-wrap gap-2"},ti={key:2},si={class:"text-gray-900"},ai={class:"list-disc list-inside space-y-1 text-gray-900"},li={key:0},ii={key:1},ni={key:2},oi={__name:"MeetingModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},projectName:{type:String,default:"Project"}},emits:["close","saved"],setup(s,{emit:t}){const a=s,i=t,o=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,l=["Africa/Cairo","Africa/Johannesburg","Africa/Lagos","America/Anchorage","America/Bogota","America/Chicago","America/Denver","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Dubai","Asia/Hong_Kong","Asia/Jerusalem","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Tokyo","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Berlin","Europe/Dublin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Rome","Pacific/Auckland","Pacific/Honolulu","UTC","GMT","Europe/Belfast","America/Adak","America/Boise","America/Detroit","America/Indianapolis","America/Juneau","America/Louisville","America/Menominee","America/Nome","America/Sitka","America/Yakutat","Asia/Karachi","Asia/Kolkata","Pacific/Auckland","Pacific/Chatham","Europe/Athens","Europe/Brussels","Europe/Budapest","Europe/Copenhagen","Europe/Helsinki","Europe/Lisbon","Europe/Oslo","Europe/Stockholm","Europe/Zurich","Europe/Vienna","Europe/Warsaw","Europe/Zurich","Europe/Sofia","Europe/Prague","Europe/Malta","Europe/Luxembourg","Europe/Kiev","Europe/Rome"].sort(),u=H(()=>l.map(I=>({value:I,label:I}))),d=H(()=>{const I=o(),V=l.includes(I);return console.log("DEBUG: Is detected timezone in list?",V,"Detected:",I),V?I:(console.log("DEBUG: Falling back to UTC for timezone as detected timezone not in list."),"UTC")}),m=Te({summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0,timezone:d.value,enable_recording:!1}),c=H({get(){return m.summary?`${m.summary} - ${a.projectName}`:""},set(I){const V=` - ${a.projectName}`;I.endsWith(V)?m.summary=I.slice(0,-V.length):m.summary=I}}),p=()=>{m.summary="",m.description="",m.attendee_user_ids=[],m.location="",m.with_google_meet=!0,m.timezone=d.value,m.enable_recording=!1,y(),console.log("DEBUG: Form reset. Current timezone in form:",m.timezone)},w=I=>{const V=new Date(I),B=V.getFullYear(),U=String(V.getMonth()+1).padStart(2,"0"),j=String(V.getDate()).padStart(2,"0"),D=String(V.getHours()).padStart(2,"0"),_=String(V.getMinutes()).padStart(2,"0");return`${B}-${U}-${j}T${D}:${_}`},y=()=>{const I=new Date,V=new Date(I.getTime()+3600*1e3),B=new Date(I.getTime()+7200*1e3);m.start_datetime=w(V),m.end_datetime=w(B),console.log("DEBUG: Default times set. Start:",m.start_datetime,"End:",m.end_datetime)};y(),ce(()=>a.show,I=>{I&&p()},{immediate:!0});const E=I=>I?(console.log(I),I.replace("T"," ")+":00"):"",k=I=>{const V={...I};return V.summary=c.value,V.start_datetime=E(I.start_datetime),V.end_datetime=E(I.end_datetime),console.log(V),V},S=H(()=>`/api/projects/${a.projectId}/meetings`),g=I=>{i("saved",I)},M=I=>{console.error("DEBUG: MeetingModal submission error:",I)},O=H(()=>{if(!m.start_datetime||!m.end_datetime)return"";const I=new Date(m.start_datetime),V=new Date(m.end_datetime),B={weekday:"long",year:"numeric",month:"long",day:"numeric"},U={hour:"2-digit",minute:"2-digit"},j=I.toLocaleDateString(void 0,B),D=I.toLocaleTimeString(void 0,U),_=V.toLocaleTimeString(void 0,U);return I.toDateString()===V.toDateString()?`${j}, ${D} - ${_}`:`${j} ${D} - ${V.toLocaleDateString(void 0,B)} ${_}`}),R=H(()=>a.projectUsers.filter(I=>m.attendee_user_ids.includes(I.id)).map(I=>I.name));return(I,V)=>(n(),ae($e,{show:s.show,title:"Schedule a Meeting","api-endpoint":S.value,"http-method":"post","form-data":m,"format-data-for-api":k,"submit-button-text":"Schedule Meeting","success-message":"Meeting scheduled successfully!",onClose:V[9]||(V[9]=B=>I.$emit("close")),onSubmitted:g,onError:M},{default:F(({errors:B})=>[e("div",Hl,[e("div",Bl,[e("div",null,[v(G,{for:"summary",value:"Meeting Title"}),V[10]||(V[10]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive title for the meeting (e.g., Project Standup). The project name will be added automatically. ",-1)),v(me,{id:"summary",modelValue:m.summary,"onUpdate:modelValue":V[0]||(V[0]=U=>m.summary=U),type:"text",class:"mt-1 block w-full",placeholder:"e.g., Project Standup",required:""},null,8,["modelValue"]),v(oe,{message:B.summary?B.summary[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"description",value:"Description"}),V[11]||(V[11]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive agenda of the meeting. ",-1)),ve(e("textarea",{id:"description","onUpdate:modelValue":V[1]||(V[1]=U=>m.description=U),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Meeting agenda and details..."},null,512),[[xe,m.description]]),v(oe,{message:B.description?B.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Fl,[e("div",null,[v(G,{for:"start_datetime",value:"Start Date & Time"}),v(me,{id:"start_datetime",modelValue:m.start_datetime,"onUpdate:modelValue":V[2]||(V[2]=U=>m.start_datetime=U),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(oe,{message:B.start_datetime?B.start_datetime[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"end_datetime",value:"End Date & Time"}),v(me,{id:"end_datetime",modelValue:m.end_datetime,"onUpdate:modelValue":V[3]||(V[3]=U=>m.end_datetime=U),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(oe,{message:B.end_datetime?B.end_datetime[0]:"",class:"mt-2"},null,8,["message"])])]),e("div",null,[v(G,{for:"attendees",value:"Attendees"}),v(Xe,{id:"attendees",modelValue:m.attendee_user_ids,"onUpdate:modelValue":V[4]||(V[4]=U=>m.attendee_user_ids=U),options:a.projectUsers,"label-key":"name","track-by":"id",placeholder:"Select attendees",class:"mt-1"},null,8,["modelValue","options"]),V[12]||(V[12]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select project members to invite to this meeting ",-1)),v(oe,{message:B.attendee_user_ids?B.attendee_user_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"location",value:"Location (Optional)"}),v(me,{id:"location",modelValue:m.location,"onUpdate:modelValue":V[5]||(V[5]=U=>m.location=U),type:"text",class:"mt-1 block w-full",placeholder:"Office, Conference Room, etc."},null,8,["modelValue"]),v(oe,{message:B.location?B.location[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"timezone",value:"Timezone"}),v(ge,{id:"timezone",modelValue:m.timezone,"onUpdate:modelValue":V[6]||(V[6]=U=>m.timezone=U),options:u.value,"value-key":"value","label-key":"label",placeholder:"Select timezone",class:"mt-1"},null,8,["modelValue","options"]),V[13]||(V[13]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select your timezone for this meeting ",-1)),v(oe,{message:B.timezone?B.timezone[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Wl,[ve(e("input",{id:"with_google_meet","onUpdate:modelValue":V[7]||(V[7]=U=>m.with_google_meet=U),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[rt,m.with_google_meet]]),V[14]||(V[14]=e("label",{for:"with_google_meet",class:"ml-2 block text-sm text-gray-900"}," Create Google Meet video conference ",-1))]),e("div",Yl,[ve(e("input",{id:"enable_recording","onUpdate:modelValue":V[8]||(V[8]=U=>m.enable_recording=U),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[rt,m.enable_recording]]),V[15]||(V[15]=e("label",{for:"enable_recording",class:"ml-2 block text-sm text-gray-900"}," Enable recording and transcript ",-1))])]),e("div",zl,[V[22]||(V[22]=e("h4",{class:"text-xl font-bold text-gray-800"},"Meeting Preview",-1)),e("div",ql,[e("div",null,[V[16]||(V[16]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Title",-1)),e("p",Zl,h(c.value||"Untitled Meeting"),1)]),e("div",null,[V[17]||(V[17]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Date & Time",-1)),e("p",Gl,h(O.value||"No date and time selected."),1),m.timezone?(n(),r("p",Kl,"Timezone: "+h(m.timezone),1)):x("",!0)]),m.description?(n(),r("div",Jl,[V[18]||(V[18]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Description",-1)),e("p",Xl,h(m.description),1)])):x("",!0),R.value.length>0?(n(),r("div",Ql,[V[19]||(V[19]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Attendees",-1)),e("div",ei,[(n(!0),r(J,null,te(R.value,U=>(n(),r("span",{key:U,class:"px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},h(U),1))),128))])])):x("",!0),m.location?(n(),r("div",ti,[V[20]||(V[20]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Location",-1)),e("p",si,h(m.location),1)])):x("",!0),e("div",null,[V[21]||(V[21]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Options",-1)),e("ul",ai,[m.with_google_meet?(n(),r("li",li,"Google Meet enabled")):x("",!0),m.enable_recording?(n(),r("li",ii,"Recording and transcript enabled")):x("",!0),!m.with_google_meet&&!m.enable_recording?(n(),r("li",ni,"No special options selected.")):x("",!0)])])])])])]),_:1},8,["show","api-endpoint","form-data"]))}},ri=Ve(oi,[["__scopeId","data-v-674b7e2a"]]),di={class:"p-6"},ui={key:0,class:"mb-4 p-3 bg-green-100 text-green-800 rounded-md"},ci={key:1,class:"mb-4 p-3 bg-red-100 text-red-800 rounded-md"},mi={class:"mb-4"},vi=["value"],pi={class:"mt-6 flex justify-end space-x-3"},hi={__name:"ProjectMagicLinkModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectClients:{type:Array,default:()=>[]}},emits:["close"],setup(s,{emit:t}){const a=s,i=t,o=b(!1),l=b(""),u=b(""),d=b(""),m=async()=>{var p,w;if(!l.value){d.value="Please select a client email";return}o.value=!0,u.value="",d.value="";try{const y=await window.axios.post(`/api/projects/${a.projectId}/magic-link`,{email:l.value});y.data.success?(u.value=y.data.message,l.value=""):d.value=y.data.message||"Failed to send magic link"}catch(y){console.error("Error sending magic link:",y),d.value=((w=(p=y.response)==null?void 0:p.data)==null?void 0:w.message)||"An error occurred while sending the magic link"}finally{o.value=!1}},c=()=>{l.value="",u.value="",d.value="",i("close")};return(p,w)=>(n(),ae(Se,{show:s.show,onClose:c},{default:F(()=>[e("div",di,[e("div",{class:"flex justify-between items-center mb-4"},[w[2]||(w[2]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Send Magic Link to Client",-1)),e("button",{onClick:c,class:"text-gray-400 hover:text-gray-500"},w[1]||(w[1]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u.value?(n(),r("div",ui,h(u.value),1)):x("",!0),d.value?(n(),r("div",ci,h(d.value),1)):x("",!0),e("div",mi,[v(G,{for:"client-email",value:"Select Client"}),ve(e("select",{id:"client-email","onUpdate:modelValue":w[0]||(w[0]=y=>l.value=y),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full"},[w[3]||(w[3]=e("option",{value:""},"Select a client",-1)),(n(!0),r(J,null,te(s.projectClients,y=>(n(),r("option",{key:y.id,value:y.email},h(y.name)+" ("+h(y.email)+") ",9,vi))),128))],512),[[We,l.value]]),w[4]||(w[4]=e("p",{class:"mt-2 text-sm text-gray-500"}," The magic link will be sent to the selected client's email address. ",-1))]),e("div",pi,[v(fe,{onClick:c,type:"button"},{default:F(()=>w[5]||(w[5]=[Y(" Cancel ",-1)])),_:1,__:[5]}),v(pe,{onClick:m,disabled:o.value||!l.value,class:"bg-purple-600 hover:bg-purple-700"},{default:F(()=>[Y(h(o.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},gi={class:"mt-6 space-y-6"},fi={class:"mt-2 flex space-x-4"},yi={class:"inline-flex items-center"},wi={class:"inline-flex items-center"},bi={key:0},_i={key:1},xi=["required"],ki={__name:"ResourceModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},resource:{type:Object,default:null}},emits:["close","saved"],setup(s,{emit:t}){const a=s,i=t,o=b({name:"",type:"link",url:"",file:null,description:""}),l=b(null),u=H(()=>a.resource?`/api/projects/${a.projectId}/resources/${a.resource.id}`:`/api/projects/${a.projectId}/resources`),d=H(()=>a.resource?"put":"post"),m=H(()=>a.resource?"Update Resource":"Add Resource"),c=H(()=>a.resource?"Resource updated successfully!":"Resource added successfully!");ce(()=>a.show,k=>{k&&(a.resource?o.value={name:a.resource.name,type:a.resource.type,url:a.resource.type==="link"?a.resource.url:"",file:null,description:a.resource.description||""}:o.value={name:"",type:"link",url:"",file:null,description:""},l.value&&(l.value.value=""))},{immediate:!0});const p=k=>{o.value.file=k.target.files[0]||null},w=k=>{const S=new FormData;return S.append("name",k.name||""),S.append("type",k.type||"link"),S.append("description",k.description||""),k.type==="link"?S.append("url",k.url||""):k.type==="file"&&k.file&&S.append("file",k.file),(d.value==="put"||d.value==="patch")&&S.append("_method","PUT"),S},y=k=>{i("saved",k.resource)},E=()=>{i("close")};return(k,S)=>(n(),ae($e,{show:s.show,title:s.resource?"Edit Resource":"Add Resource","api-endpoint":u.value,"http-method":d.value,"form-data":o.value,"submit-button-text":m.value,"success-message":c.value,"format-data-for-api":w,onClose:E,onSubmitted:y},{default:F(({errors:g})=>[e("div",gi,[e("div",null,[v(G,{for:"resource-type",value:"Resource Type"}),e("div",fi,[e("label",yi,[ve(e("input",{type:"radio","onUpdate:modelValue":S[0]||(S[0]=M=>o.value.type=M),value:"link",class:"form-radio text-indigo-600"},null,512),[[dt,o.value.type]]),S[5]||(S[5]=e("span",{class:"ml-2 text-gray-700"},"Link",-1))]),e("label",wi,[ve(e("input",{type:"radio","onUpdate:modelValue":S[1]||(S[1]=M=>o.value.type=M),value:"file",class:"form-radio text-indigo-600"},null,512),[[dt,o.value.type]]),S[6]||(S[6]=e("span",{class:"ml-2 text-gray-700"},"File",-1))])])]),e("div",null,[v(G,{for:"resource-name",value:"Name"}),v(me,{id:"resource-name",modelValue:o.value.name,"onUpdate:modelValue":S[2]||(S[2]=M=>o.value.name=M),type:"text",class:"mt-1 block w-full",placeholder:"Enter resource name",required:""},null,8,["modelValue"]),v(oe,{message:g.name?g.name[0]:"",class:"mt-2"},null,8,["message"])]),o.value.type==="link"?(n(),r("div",bi,[v(G,{for:"resource-url",value:"URL"}),v(me,{id:"resource-url",modelValue:o.value.url,"onUpdate:modelValue":S[3]||(S[3]=M=>o.value.url=M),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com",required:""},null,8,["modelValue"]),v(oe,{message:g.url?g.url[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0),o.value.type==="file"?(n(),r("div",_i,[v(G,{for:"resource-file",value:"File"}),e("input",{id:"resource-file",ref_key:"fileInputRef",ref:l,type:"file",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",onChange:p,required:!s.resource||o.value.type==="file"},null,40,xi),v(oe,{message:g.file?g.file[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0),e("div",null,[v(G,{for:"resource-description",value:"Description (Optional)"}),ve(e("textarea",{id:"resource-description","onUpdate:modelValue":S[4]||(S[4]=M=>o.value.description=M),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter a description for this resource"},null,512),[[xe,o.value.description]]),v(oe,{message:g.description?g.description[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},Di=Ve(ki,[["__scopeId","data-v-f508dda8"]]);function Ci(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"})])}function Ti(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"})])}function Ei(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 7.5-2.25-1.313M21 7.5v2.25m0-2.25-2.25 1.313M3 7.5l2.25-1.313M3 7.5l2.25 1.313M3 7.5v2.25m9 3 2.25-1.313M12 12.75l-2.25-1.313M12 12.75V15m0 6.75 2.25-1.313M12 21.75V19.5m0 2.25-2.25-1.313m0-16.875L12 2.25l2.25 1.313M21 14.25v2.25l-2.25 1.313m-13.5 0L3 16.5v-2.25"})])}function Mi(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"})])}function Si(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})])}function ji(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"})])}function $i(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"})])}function Vi(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})])}function Ai(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})])}function Oi(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})])}function Li(s,t){return n(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})])}const Ii={class:"bg-white p-8 rounded-2xl shadow-xl border border-gray-200"},Pi={class:"flex flex-col lg:flex-row justify-between lg:items-center mb-6 border-b pb-4 border-gray-200"},Ni={class:"flex-1"},Ri={class:"text-3xl font-extrabold text-gray-900 tracking-tight"},Ui={class:"mt-2 flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-gray-500"},Hi={class:"text-gray-600 font-medium"},Bi={class:"flex items-center gap-2"},Fi=["href"],Wi=["href"],Yi=["href"],zi={class:"mt-4 lg:mt-0 flex flex-wrap gap-2"},qi={class:"grid grid-cols-1 md:grid-cols-3 gap-8"},Zi={class:"col-span-2"},Gi={class:"text-gray-600 text-base leading-relaxed"},Ki={class:"mt-6 flex flex-wrap gap-2 items-center"},Ji={class:"mt-6"},Xi={key:0,class:"text-gray-500 text-sm"},Qi={key:1,class:"text-gray-400 text-sm"},en={key:2,class:"flex flex-wrap gap-3 items-center"},tn=["onClick"],sn={key:0,class:"resource-tooltip absolute left-1/2 bottom-full mb-2 w-64 z-10 -translate-x-1/2"},an={class:"bg-white rounded-xl shadow-xl p-4 text-sm border border-gray-200"},ln={class:"flex justify-between items-center mb-2"},nn={class:"font-bold text-gray-900"},on={key:0,class:"text-gray-600 text-xs mb-2"},rn=["href"],dn={class:"flex justify-end space-x-2 mt-2 pt-2 border-t border-gray-100"},un=["onClick"],cn=["onClick"],mn={class:"space-y-6 text-sm text-gray-700 md:border-l md:border-gray-200 md:pl-8 hidden"},vn={key:0},pn=["href"],hn={key:1},gn=["href"],fn={key:2},yn=["href"],wn={class:"p-6"},bn={key:0,class:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-md"},_n={key:1,class:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md"},xn={class:"mb-4"},kn={key:0,class:"text-gray-500 text-sm mt-1"},Dn={key:1,class:"text-red-500 text-sm mt-1"},Cn={class:"flex justify-end mt-6"},Tn={__name:"ProjectGeneralInfoCard",props:{project:{type:Object,required:!0},projectId:{type:Number,required:!0},canManageProjects:{type:Boolean,required:!0},canEditProjects:{type:Boolean,required:!1},isSuperAdmin:{type:Boolean,required:!0}},emits:["openEditModal","openStandupModal","openMeetingModal","resourceSaved","openComposeModal"],setup(s,{emit:t}){const a=s,i=t,o=b(!1),l=b(null),u=b([]),d=b(!1),m=b(null),c=b(!1),p=b(!1),w=b(!1),y=b({client_ids:[]}),E=b({}),k=b(""),S=b([]),g=b(!1),M=b("");ht(a.projectId);const O=async()=>{d.value=!0;try{const C=await window.axios.get(`/api/projects/${a.projectId}/resources`);C.data.success?u.value=C.data.resources:console.error("Failed to fetch resources:",C.data.message)}catch(C){console.error("Error fetching resources:",C)}finally{d.value=!1}},R=()=>{l.value=null,o.value=!0},I=C=>{l.value=C,o.value=!0},V=async C=>{if(confirm("Are you sure you want to delete this resource?"))try{const f=await window.axios.delete(`/api/projects/${a.projectId}/resources/${C}`);f.data.success?u.value=u.value.filter(L=>L.id!==C):console.error("Failed to delete resource:",f.data.message)}catch(f){console.error("Error deleting resource:",f)}},B=C=>{if(l.value){const f=u.value.findIndex(L=>L.id===C.id);f!==-1&&(u.value[f]=C)}else u.value.push(C);i("resourceSaved",C)},U=C=>{m.value=m.value===C?null:C},j=()=>{m.value=null},D=C=>{if(m.value!==null){const f=C.target.closest(".resource-tooltip"),L=C.target.closest(".resource-button");!f&&!L&&j()}};ke(()=>{O(),document.addEventListener("click",D)}),Kt(()=>{document.removeEventListener("click",D)});const _=async()=>{var C,f;g.value=!0,M.value="";try{const L=await window.axios.get(`/api/projects/${a.projectId}/sections/clients?type=clients`);S.value=L.data}catch(L){console.error("Failed to fetch project clients:",L),M.value=((f=(C=L.response)==null?void 0:C.data)==null?void 0:f.message)||"Failed to load client data."}finally{g.value=!1}},$=()=>{y.value.client_ids=[],E.value={},k.value="",p.value=!0,_()},se=()=>{p.value=!1},ie=async()=>{if(E.value={},k.value="",w.value=!0,!y.value.client_ids||y.value.client_ids.length===0){E.value={client_ids:["Please select a client."]},w.value=!1;return}try{const C=y.value.client_ids[0];if(!S.value.find(T=>T.id===C)){E.value={client_ids:["Selected client does not have a valid email."]},w.value=!1;return}const L=await window.axios.post(`/api/projects/${a.projectId}/magic-link`,{client_id:C});L.data.success&&(k.value=L.data.message,y.value.client_ids=[])}catch(C){C.response&&C.response.status===422?E.value=C.response.data.errors:C.response&&C.response.data.message?E.value={general:[C.response.data.message]}:E.value={general:["An unexpected error occurred. Please try again."]}}finally{w.value=!1}};return(C,f)=>{var L;return n(),r(J,null,[e("div",Ii,[e("div",Pi,[e("div",Ni,[e("h2",Ri,h(s.project.name),1),e("div",Ui,[e("span",{class:X(["inline-flex items-center rounded-full px-3 py-0.5 text-xs font-semibold",{"bg-green-100 text-green-800":s.project.status==="active","bg-yellow-100 text-yellow-800":s.project.status==="on_hold","bg-blue-100 text-blue-800":s.project.status==="completed","bg-red-100 text-red-800":s.project.status==="archived"}])},h(((L=s.project.status)==null?void 0:L.replace("_"," ").toUpperCase())||"N/A"),3),f[12]||(f[12]=e("span",{class:"text-gray-600"},"|",-1)),e("span",Hi,h(s.project.project_type||"N/A"),1),f[13]||(f[13]=e("span",{class:"text-gray-600"},"|",-1)),e("div",Bi,[s.project.website?(n(),r("a",{key:0,href:s.project.website,target:"_blank",class:"flex items-center text-sm text-indigo-600 hover:text-indigo-800 transition-colors",title:"Visit Website"},[v(q(Si),{class:"h-5 w-5 mr-1"}),f[9]||(f[9]=Y(" Website ",-1))],8,Fi)):x("",!0),s.project.social_media_link?(n(),r("a",{key:1,href:s.project.social_media_link,target:"_blank",class:"flex items-center text-sm text-indigo-600 hover:text-indigo-800 transition-colors",title:"Social Media"},[v(q(Li),{class:"h-5 w-5 mr-1"}),f[10]||(f[10]=Y(" Socials ",-1))],8,Wi)):x("",!0),s.project.google_drive_link?(n(),r("a",{key:2,href:s.project.google_drive_link,target:"_blank",class:"flex items-center text-sm text-indigo-600 hover:text-indigo-800 transition-colors",title:"Google Drive"},[v(q(Ei),{class:"h-5 w-5 mr-1"}),f[11]||(f[11]=Y(" Drive ",-1))],8,Yi)):x("",!0)])])]),e("div",zi,[s.canEditProjects||s.isSuperAdmin?(n(),ae(pe,{key:0,onClick:f[0]||(f[0]=T=>C.$inertia.visit("/projects/"+s.projectId+"/edit")),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:F(()=>[v(q(Vi),{class:"h-5 w-5 mr-2"}),f[14]||(f[14]=Y(" Edit Project ",-1))]),_:1,__:[14]})):x("",!0),s.canManageProjects||s.isSuperAdmin?(n(),ae(fe,{key:1,onClick:f[1]||(f[1]=T=>i("openMeetingModal")),class:"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"},{default:F(()=>[v(q(Ci),{class:"h-5 w-5 mr-2"}),f[15]||(f[15]=Y(" Schedule Meeting ",-1))]),_:1,__:[15]})):x("",!0),v(fe,{onClick:f[2]||(f[2]=T=>i("openStandupModal")),class:"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"},{default:F(()=>[v(q(Ti),{class:"h-5 w-5 mr-2"}),f[16]||(f[16]=Y(" Daily Standup ",-1))]),_:1,__:[16]})])]),e("div",qi,[e("div",Zi,[e("p",Gi,h(s.project.description||"No description provided."),1),e("div",Ki,[e("button",{onClick:R,class:"flex items-center p-2 rounded-full text-indigo-600 bg-indigo-50 hover:bg-indigo-100 transition-colors",title:"Add Resource"},[v(q(Ai),{class:"h-5 w-5"}),f[17]||(f[17]=e("span",{class:"ml-1 text-sm font-medium"},"Add Resource",-1))]),e("button",{onClick:$,class:"flex items-center p-2 rounded-full text-green-600 bg-green-50 hover:bg-green-100 transition-colors",title:"Share Project"},[v(q(Oi),{class:"h-5 w-5"}),f[18]||(f[18]=e("span",{class:"ml-1 text-sm font-medium"},"Share",-1))]),e("button",{onClick:f[3]||(f[3]=T=>i("openComposeModal")),class:"flex items-center p-2 rounded-full text-blue-600 bg-blue-50 hover:bg-blue-100 transition-colors",title:"Compose Email"},[v(q($i),{class:"h-5 w-5"}),f[19]||(f[19]=e("span",{class:"ml-1 text-sm font-medium"},"Compose Email",-1))])]),e("div",Ji,[f[23]||(f[23]=e("h5",{class:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2"},"Dynamic Project Resources",-1)),d.value?(n(),r("div",Xi,"Loading resources...")):u.value.length===0?(n(),r("div",Qi,"No dynamic resources have been added.")):(n(),r("div",en,[(n(!0),r(J,null,te(u.value,T=>(n(),r("div",{key:T.id,class:"relative"},[e("button",{onClick:_e(Z=>U(T.id),["prevent"]),class:"resource-button flex items-center p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors text-sm font-medium text-gray-700"},[v(q(ji),{class:"h-4 w-4 mr-1"}),Y(" "+h(T.name),1)],8,tn),m.value===T.id?(n(),r("div",sn,[e("div",an,[e("div",ln,[e("h4",nn,h(T.name),1),e("button",{onClick:_e(j,["prevent"]),class:"text-gray-400 hover:text-gray-600"},f[20]||(f[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),T.description?(n(),r("p",on,h(T.description),1)):x("",!0),e("a",{href:T.url,target:"_blank",class:"mt-2 text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center"},[v(q(Mi),{class:"h-4 w-4 mr-1"}),f[21]||(f[21]=Y(" Open Resource ",-1))],8,rn),e("div",dn,[e("button",{onClick:_e(Z=>I(T),["prevent"]),class:"p-1 text-gray-500 hover:text-indigo-600 transition-colors",title:"Edit"},[v(q(ws),{class:"h-4 w-4"})],8,un),e("button",{onClick:_e(Z=>V(T.id),["prevent"]),class:"p-1 text-gray-500 hover:text-red-600 transition-colors",title:"Delete"},[v(q(Nt),{class:"h-4 w-4"})],8,cn)])]),f[22]||(f[22]=e("div",{class:"absolute left-1/2 bottom-0 transform translate-y-1/2 -translate-x-1/2 rotate-45 w-4 h-4 bg-white border-r border-b border-gray-200"},null,-1))])):x("",!0)]))),128))]))])]),e("div",mn,[e("p",null,[f[24]||(f[24]=e("strong",{class:"text-gray-900 font-semibold"},"Source:",-1)),Y(" "+h(s.project.source||"N/A"),1)]),s.project.website?(n(),r("p",vn,[f[25]||(f[25]=e("strong",{class:"text-gray-900 font-semibold"},"Website:",-1)),f[26]||(f[26]=Y()),e("a",{href:s.project.website,target:"_blank",class:"text-indigo-600 hover:underline"},h(s.project.website),9,pn)])):x("",!0),s.project.social_media_link?(n(),r("p",hn,[f[27]||(f[27]=e("strong",{class:"text-gray-900 font-semibold"},"Social Media:",-1)),f[28]||(f[28]=Y()),e("a",{href:s.project.social_media_link,target:"_blank",class:"text-indigo-600 hover:underline"},h(s.project.social_media_link),9,gn)])):x("",!0),s.project.google_drive_link?(n(),r("p",fn,[f[29]||(f[29]=e("strong",{class:"text-gray-900 font-semibold"},"Google Drive:",-1)),f[30]||(f[30]=Y()),e("a",{href:s.project.google_drive_link,target:"_blank",class:"text-indigo-600 hover:underline"},"Open Folder",8,yn)])):x("",!0)])])]),v(Di,{show:o.value,"project-id":s.projectId,resource:l.value,onClose:f[4]||(f[4]=T=>o.value=!1),onSaved:B},null,8,["show","project-id","resource"]),v(Se,{show:p.value,onClose:se},{default:F(()=>[e("div",wn,[f[33]||(f[33]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"}," Send Magic Link ",-1)),k.value?(n(),r("div",bn,h(k.value),1)):x("",!0),E.value.general?(n(),r("div",_n,h(E.value.general[0]),1)):x("",!0),e("form",{onSubmit:_e(ie,["prevent"])},[e("div",xn,[v(G,{for:"client",value:"Select Client"}),g.value?(n(),r("div",kn,"Loading clients...")):M.value?(n(),r("div",Dn,h(M.value),1)):(n(),ae(Xe,{key:2,id:"client",modelValue:y.value.client_ids,"onUpdate:modelValue":f[5]||(f[5]=T=>y.value.client_ids=T),options:S.value,placeholder:"Select a client","label-key":"name","track-by":"id",class:"mt-1"},null,8,["modelValue","options"])),v(oe,{message:E.value.client_ids?E.value.client_ids[0]:"",class:"mt-2"},null,8,["message"]),f[31]||(f[31]=e("p",{class:"mt-2 text-sm text-gray-500"}," Select a client to send them a magic link for project access. ",-1))]),e("div",Cn,[v(fe,{onClick:se,class:"mr-3"},{default:F(()=>f[32]||(f[32]=[Y(" Cancel ",-1)])),_:1,__:[32]}),v(pe,{type:"submit",class:"bg-purple-600 hover:bg-purple-700 transition-colors",disabled:w.value},{default:F(()=>[Y(h(w.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),v(ds,{show:c.value,title:"Compose New Email","api-endpoint":"/api/emails/templated","http-method":"post",clients:S.value,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","project-id":s.projectId,onClose:f[6]||(f[6]=T=>c.value=!1),onSubmitted:f[7]||(f[7]=T=>c.value=!1),onError:f[8]||(f[8]=T=>console.error("Email submission error:",T))},null,8,["show","clients","project-id"])],64)}}},En=Ve(Tn,[["__scopeId","data-v-87cc31bc"]]),Mn={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},Sn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},jn={class:"text-2xl font-bold text-indigo-600"},$n={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Vn={class:"text-2xl font-bold text-indigo-600"},An={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},On={class:"text-2xl font-bold text-indigo-600"},Ln={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},In={class:"text-2xl font-bold text-indigo-600"},Pn={__name:"ProjectStatsCards",props:{tasks:{type:Array,required:!0},emails:{type:Array,required:!0}},setup(s){const t=s,a=H(()=>t.tasks.filter(u=>u.status!=="Done").length),i=H(()=>t.emails.filter(u=>u.type==="received").length),o=H(()=>{const u=t.emails.filter(d=>d.status==="received"||d.type==="received");if(u.length>0){const d=[...u].sort((m,c)=>new Date(c.created_at)-new Date(m.created_at));return new Date(d[0].created_at).toLocaleDateString()}return"N/A"}),l=H(()=>{const u=t.tasks.filter(d=>d.status!=="Done");if(u.length>0){const d=u.filter(m=>m.due_date);if(d.length>0)return[...d].sort((c,p)=>new Date(c.due_date)-new Date(p.due_date))[0].due_date}return"N/A"});return(u,d)=>(n(),r("div",Mn,[e("div",Sn,[d[0]||(d[0]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Pending Tasks",-1)),e("p",jn,h(a.value),1)]),e("div",$n,[d[1]||(d[1]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Received Emails",-1)),e("p",Vn,h(i.value),1)]),e("div",An,[d[2]||(d[2]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Last Email Received",-1)),e("p",On,h(o.value),1)]),e("div",Ln,[d[3]||(d[3]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Next Task Deadline",-1)),e("p",In,h(l.value),1)])]))}},Nn={class:"bg-white p-4 rounded-xl shadow-md mb-6"},Rn={class:"border-b border-gray-200"},Un={__name:"ProjectTabsNavigation",props:{selectedTab:{type:String,default:null},canViewEmails:{type:Boolean,required:!0},canViewNotes:{type:Boolean,required:!0},canViewDeliverables:{type:Boolean,required:!0},canViewSeoReports:{type:Boolean,required:!0}},emits:["update:selectedTab"],setup(s,{expose:t,emit:a}){const i=b(null),o=s,l=a,u=H({get:()=>o.selectedTab,set:m=>l("update:selectedTab",m)});return t({scrollIntoView:m=>{i.value&&i.value.scrollIntoView(m)}}),(m,c)=>(n(),r("div",Nn,[e("div",Rn,[e("nav",{class:"-mb-px flex space-x-8 overflow-x-auto",ref_key:"navElement",ref:i},[e("button",{onClick:c[0]||(c[0]=p=>u.value=null),class:X([u.value===null?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Overview ",2),e("button",{onClick:c[1]||(c[1]=p=>u.value="tasks"),class:X([u.value==="tasks"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Project Tasks ",2),s.canViewEmails?(n(),r("button",{key:0,onClick:c[2]||(c[2]=p=>u.value="emails"),class:X([u.value==="emails"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Email Communication ",2)):x("",!0),s.canViewNotes?(n(),r("button",{key:1,onClick:c[3]||(c[3]=p=>u.value="notes"),class:X([u.value==="notes"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Notes ",2)):x("",!0),s.canViewNotes?(n(),r("button",{key:2,onClick:c[4]||(c[4]=p=>u.value="standups"),class:X([u.value==="standups"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Daily Standups ",2)):x("",!0),s.canViewDeliverables?(n(),r("button",{key:3,onClick:c[5]||(c[5]=p=>u.value="deliverables"),class:X([u.value==="deliverables"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Deliverables ",2)):x("",!0),s.canViewSeoReports?(n(),r("button",{key:4,onClick:c[6]||(c[6]=p=>u.value="seo-reports"),class:X([u.value==="seo-reports"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," SEO Reports ",2)):x("",!0)],512)])]))}},Hn={class:"space-y-4"},Bn={key:0,class:"text-sm text-gray-500"},Fn={class:"flex justify-between items-center"},Wn={key:0,class:"text-sm text-gray-500"},Yn="put",zn="Update Task",qn="Task updated successfully!",Zn={__name:"EditTaskModal",props:{show:Boolean,projectId:Number,selectedTask:Object,projectUsers:Array,taskTypes:Array,milestones:Array,loadingTaskTypes:Boolean,loadingMilestones:Boolean},emits:["close","saved","open-add-milestone-modal"],setup(s,{emit:t}){const a=s,i=t,o=Te({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]}),l=["To Do","In Progress","Done","Blocked","Archived"],u=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],d=H(()=>"Edit Task"),m=H(()=>{var S;return`/api/tasks/${(S=a.selectedTask)==null?void 0:S.id}`});ce(()=>[a.show,a.selectedTask],([S,g],[M,O]=[])=>{var R;if(S&&g){let I=null;if(g.milestone){const j=a.milestones.find(D=>D.name===g.milestone);j&&(I=j.id)}else g.milestone_id&&(I=g.milestone_id);let V=null;if(g.task_type){const j=a.taskTypes.find(D=>D.name===g.task_type);j&&(V=j.id)}else g.task_type_id&&(V=g.task_type_id);let B=null;if(g.assigned_to&&g.assigned_to!=="Unassigned"){const j=(R=a.projectUsers)==null?void 0:R.find(D=>D.name===g.assigned_to);j&&(B=j.id)}else g.assigned_to_id&&(B=g.assigned_to_id);let U=[];g.tags&&Array.isArray(g.tags)&&g.tags.length>0&&(typeof g.tags[0]=="string"?U=g.tags.map(j=>({id:`new_${j.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:j})):typeof g.tags[0]=="object"&&(U=g.tags)),Object.assign(o,{name:g.title||"",description:g.description||"",assigned_to_user_id:B,due_date:g.due_date||null,status:g.status||"To Do",task_type_id:V,milestone_id:I,priority:g.priority||"medium",tags:U.map(j=>j.id),tags_data:U}),console.log("Task data loaded:",{taskId:g.id,title:g.title,originalTags:g.tags,processedTags:U,formTags:o.tags,formTagsData:o.tags_data})}else S||Object.assign(o,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]})},{immediate:!0});const c=S=>{i("saved",S),i("close")},p=()=>{i("open-add-milestone-modal")},w=()=>{i("close")},y=H(()=>a.projectUsers.map(S=>({value:S.id,label:S.name}))),E=H(()=>a.taskTypes.map(S=>({value:S.id,label:S.name}))),k=H(()=>a.milestones.map(S=>({value:S.id,label:S.name})));return(S,g)=>(n(),ae($e,{show:s.show,title:d.value,"api-endpoint":m.value,"http-method":Yn,"form-data":o,"submit-button-text":zn,"success-message":qn,onClose:w,onSubmitted:c},{default:F(({errors:M})=>[e("div",Hn,[e("div",null,[v(G,{for:"task-name",value:"Task Name"}),v(me,{id:"task-name",modelValue:o.name,"onUpdate:modelValue":g[0]||(g[0]=O=>o.name=O),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),v(oe,{message:M.name?M.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-description",value:"Description"}),ve(e("textarea",{id:"task-description","onUpdate:modelValue":g[1]||(g[1]=O=>o.description=O),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[xe,o.description]]),v(oe,{message:M.description?M.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-status",value:"Status"}),v(ge,{id:"task-status",modelValue:o.status,"onUpdate:modelValue":g[2]||(g[2]=O=>o.status=O),options:l.map(O=>({value:O,label:O})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),v(oe,{message:M.status?M.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-priority",value:"Priority"}),v(ge,{id:"task-priority",modelValue:o.priority,"onUpdate:modelValue":g[3]||(g[3]=O=>o.priority=O),options:u,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),v(oe,{message:M.priority?M.priority[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-due-date",value:"Due Date"}),v(me,{id:"task-due-date",modelValue:o.due_date,"onUpdate:modelValue":g[4]||(g[4]=O=>o.due_date=O),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),v(oe,{message:M.due_date?M.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-assigned-to",value:"Assigned To"}),v(ge,{id:"task-assigned-to",modelValue:o.assigned_to_user_id,"onUpdate:modelValue":g[5]||(g[5]=O=>o.assigned_to_user_id=O),options:y.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"]),v(oe,{message:M.assigned_to_user_id?M.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-type",value:"Task Type"}),s.loadingTaskTypes?(n(),r("div",Bn,"Loading task types...")):(n(),ae(ge,{key:1,id:"task-type",modelValue:o.task_type_id,"onUpdate:modelValue":g[6]||(g[6]=O=>o.task_type_id=O),options:E.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(oe,{message:M.task_type_id?M.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[e("div",Fn,[v(G,{for:"task-milestone",value:"Milestone"}),e("button",{type:"button",onClick:p,class:"text-sm text-indigo-600 hover:text-indigo-800"}," + Create New Milestone ")]),s.loadingMilestones?(n(),r("div",Wn,"Loading milestones...")):(n(),ae(ge,{key:1,id:"task-milestone",modelValue:o.milestone_id,"onUpdate:modelValue":g[7]||(g[7]=O=>o.milestone_id=O),options:k.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(oe,{message:M.milestone_id?M.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(Rt,{modelValue:o.tags,"onUpdate:modelValue":g[8]||(g[8]=O=>o.tags=O),initialTags:o.tags_data,label:"Tags",placeholder:"Search or add tags",error:M.tags?M.tags[0]:""},null,8,["modelValue","initialTags","error"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},Gn={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Kn={class:"flex justify-between items-center mb-4"},Jn={class:"flex gap-2"},Xn={key:0},Qn={key:1},eo={class:"mb-6 overflow-x-auto"},to={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},so={key:1,class:"text-center py-4"},ao={key:2,class:"relative py-8"},lo={class:"relative flex justify-between"},io={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},no={key:1,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},oo={key:2,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ro={key:3,class:"w-2 h-2 bg-white rounded-full"},uo={class:"absolute -top-8 transform -translate-x-1/2 left-1/2 w-32"},co=["title"],mo={class:"absolute top-8 transform -translate-x-1/2 left-1/2"},vo={class:"text-xs text-gray-500 whitespace-nowrap"},po={class:"mb-6 bg-gray-50 p-4 rounded-lg"},ho={class:"flex flex-wrap items-center gap-4"},go={class:"flex-1 min-w-[200px]"},fo={class:"flex-1 min-w-[200px]"},yo={class:"flex-1 min-w-[200px]"},wo={class:"flex-1 min-w-[200px]"},bo={key:0,class:"mt-3 text-sm text-gray-600"},_o={key:0,class:"text-red-600 font-medium"},xo={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},ko={key:1,class:"text-center py-4"},Do={class:"text-red-600 text-sm font-medium"},Co={key:2,class:"overflow-x-auto"},To={key:3,class:"text-center py-4"},Eo={class:"p-6"},Mo={class:"mb-4"},So={class:"flex justify-end space-x-3"},jo={__name:"ProjectTasksTab",props:{projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},canManageProjects:{type:Boolean,required:!0},tasksFilter:{type:String,default:"all"}},emits:["tasksUpdated","openTaskDetailSidebar","open-create-task-modal","filter-changed"],setup(s,{emit:t}){const a=s,i=t,o=b([]),l=b(!0),u=b(""),d=b(!1),m=b(null),c=b(!1),p=b(!1),w=b(null),y=b(!1),E=b(null),k=b(""),S=b([]),g=b([]),M=b(!1),O=b(!1),R=Te({status:"",assigned_to_user_id:null,milestone_id:null,due_date_range:""}),I=[{value:"",label:"All Statuses"},{value:"To Do",label:"To Do"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Blocked",label:"Blocked"},{value:"Archived",label:"Archived"}],V=H(()=>{const A=[{value:null,label:"All Users"},{value:-1,label:"Unassigned"}];return A.push(...a.projectUsers.map(P=>({value:P.id,label:P.name}))),A}),B=H(()=>{const A=[{value:null,label:"All Milestones"},{value:-1,label:"No Milestone"}];return A.push(...g.value.map(P=>({value:P.id,label:P.name}))),A}),U=[{value:"",label:"All Dates"},{value:"today",label:"Due Today"},{value:"this_week",label:"Due This Week"},{value:"next_week",label:"Due Next Week"},{value:"overdue",label:"Overdue"},{value:"no_date",label:"No Due Date"}],j=H(()=>!g.value||!g.value.length?[]:[...g.value].sort((A,P)=>A.completion_date?P.completion_date?new Date(A.completion_date)-new Date(P.completion_date):-1:1)),D=H(()=>o.value.length?(console.log("ProjectTasksTab: Tasks array:",o.value),o.value.filter(A=>{if(R.status&&A.status!==R.status)return!1;if(R.assigned_to_user_id!==null){const P=parseInt(R.assigned_to_user_id);if(P===-1){if(A.assigned_to!=="Unassigned"&&A.assigned_to_id!==null)return!1}else if(A.assigned_to_id!==P)return!1}if(R.milestone_id!==null){const P=parseInt(R.milestone_id);if(P===-1){if(A.milestone_id)return!1}else if(A.milestone_id!==P)return!1}if(R.due_date_range){const P=new Date;P.setHours(0,0,0,0);const W=A.due_date?new Date(A.due_date):null;switch(R.due_date_range){case"today":if(!W||W.toDateString()!==P.toDateString())return!1;break;case"this_week":{if(!W)return!1;const he=new Date(P);if(he.setDate(P.getDate()+(6-P.getDay())),W<P||W>he)return!1;break}case"next_week":{if(!W)return!1;const he=new Date(P);he.setDate(P.getDate()+(7-P.getDay()));const Oe=new Date(he);if(Oe.setDate(he.getDate()+6),W<he||W>Oe)return!1;break}case"overdue":{if(!W||W>=P)return!1;break}case"no_date":{if(W)return!1;break}}}return!0})):[]),_=()=>{R.status="",R.assigned_to_user_id=null,R.milestone_id=null,R.due_date_range=""},$=async()=>{l.value=!0,u.value="";try{const A=await Bt(a.projectId);console.log("ProjectTasksTab: Raw API response from fetchProjectTasks:",A),o.value=A,i("tasksUpdated",o.value)}catch(A){u.value="Failed to load tasks data.",console.error("Error fetching project tasks:",A),A.response&&A.response.data&&A.response.data.message&&(u.value=A.response.data.message)}finally{l.value=!1}},se=async A=>{await $()},ie=async()=>{M.value=!0;try{const A=await window.axios.get("/api/task-types");S.value=A.data}catch(A){console.error("Error fetching task types:",A)}finally{M.value=!1}},C=async()=>{O.value=!0;try{const A=await window.axios.get(`/api/projects/${a.projectId}/milestones`);g.value=A.data}catch(A){console.error("Error fetching milestones:",A)}finally{O.value=!1}},f=()=>{i("open-create-task-modal")},L=()=>{$()},T=A=>{console.log("ProjectTasksTab: Emitting openTaskDetailSidebar for taskId:",A,"projectId:",a.projectId),i("openTaskDetailSidebar",A,a.projectId,a.projectUsers)},Z=()=>{c.value=!0},re=A=>{g.value.push(A),$()},Ce=()=>{$()},ee=async()=>{if(E.value){if(!k.value.trim()){Jt("Please provide a reason for blocking the task");return}try{Xt("Blocking task..."),await window.axios.post(`/api/tasks/${E.value.id}/block`,{reason:k.value}),gt("Task blocked successfully"),y.value=!1,await $()}catch(A){console.error("Error blocking task:",A),Je("Failed to block task. Please try again.")}}};return ke(()=>{$(),ie(),C()}),ce(()=>a.projectUsers,()=>{}),ce(()=>a.taskTypes,()=>{}),ce(()=>a.milestones,()=>{}),ce(()=>a.tasksFilter,A=>{A==="due-overdue"?(new Date().setHours(0,0,0,0),R.status="",R.assigned_to_user_id=null,R.milestone_id=null,R.due_date_range="overdue"):A==="all"&&(R.status="",R.assigned_to_user_id=null,R.milestone_id=null,R.due_date_range=""),i("filter-changed",A)}),(A,P)=>(n(),r("div",Gn,[e("div",Kn,[P[11]||(P[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Tasks",-1)),e("div",Jn,[v(fe,{onClick:$,disabled:l.value,class:"text-indigo-600 hover:text-indigo-800"},{default:F(()=>[l.value?(n(),r("span",Qn,"Loading...")):(n(),r("span",Xn,"Refresh"))]),_:1},8,["disabled"]),s.canManageProjects?(n(),ae(pe,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:f},{default:F(()=>P[10]||(P[10]=[Y(" Add Task ",-1)])),_:1,__:[10]})):x("",!0)])]),e("div",eo,[O.value?(n(),r("div",to," Loading milestones... ")):j.value.length?(n(),r("div",ao,[P[16]||(P[16]=e("div",{class:"absolute h-1 bg-gray-200 top-1/2 left-0 right-0 transform -translate-y-1/2"},null,-1)),e("div",lo,[(n(!0),r(J,null,te(j.value,(W,he)=>(n(),r("div",{key:W.id,class:X(["flex flex-col items-center relative z-10",{"ml-4":he===0,"mr-4":he===j.value.length-1}])},[e("div",{class:X(["w-6 h-6 rounded-full shadow-lg flex items-center justify-center",{"bg-gray-300":W.status==="Not Started","bg-blue-500":W.status==="In Progress","bg-green-500":W.status==="Completed","bg-red-500":W.status==="Overdue"}])},[W.status==="Completed"?(n(),r("svg",io,P[13]||(P[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):W.status==="In Progress"?(n(),r("svg",no,P[14]||(P[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))):W.status==="Overdue"?(n(),r("svg",oo,P[15]||(P[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(n(),r("span",ro))],2),e("div",uo,[e("p",{class:"text-xs font-medium text-gray-700 text-center truncate",title:W.name},h(W.name),9,co)]),e("div",mo,[e("p",vo,h(W.completion_date?new Date(W.completion_date).toLocaleDateString():"No date"),1)])],2))),128))])])):(n(),r("div",so,P[12]||(P[12]=[e("p",{class:"text-gray-400 text-sm"},"No milestones found for this project.",-1)])))]),e("div",po,[e("div",ho,[e("div",go,[v(G,{for:"status-filter",value:"Status"}),v(ge,{id:"status-filter",modelValue:R.status,"onUpdate:modelValue":P[0]||(P[0]=W=>R.status=W),options:I,"value-key":"value","label-key":"label",placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",fo,[v(G,{for:"assigned-filter",value:"Assigned To"}),v(ge,{id:"assigned-filter",modelValue:R.assigned_to_user_id,"onUpdate:modelValue":P[1]||(P[1]=W=>R.assigned_to_user_id=W),options:V.value,"value-key":"value","label-key":"label",placeholder:"All Users",class:"mt-1"},null,8,["modelValue","options"])]),e("div",yo,[v(G,{for:"milestone-filter",value:"Milestone"}),v(ge,{id:"milestone-filter",modelValue:R.milestone_id,"onUpdate:modelValue":P[2]||(P[2]=W=>R.milestone_id=W),options:B.value,"value-key":"value","label-key":"label",placeholder:"All Milestones",class:"mt-1"},null,8,["modelValue","options"])]),e("div",wo,[v(G,{for:"due-date-filter",value:"Due Date"}),v(ge,{id:"due-date-filter",modelValue:R.due_date_range,"onUpdate:modelValue":P[3]||(P[3]=W=>R.due_date_range=W),options:U,"value-key":"value","label-key":"label",placeholder:"All Dates",class:"mt-1"},null,8,["modelValue"])]),e("div",{class:"flex items-end"},[e("button",{type:"button",onClick:_,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")])]),Object.values(R).some(W=>W!==null&&W!=="")?(n(),r("div",bo,[e("p",null,[Y(" Showing "+h(D.value.length)+" of "+h(o.value.length)+" tasks ",1),D.value.length===0?(n(),r("span",_o," (No tasks match the current filters) ")):x("",!0)])])):x("",!0)]),l.value?(n(),r("div",xo," Loading tasks... ")):u.value?(n(),r("div",ko,[e("p",Do,h(u.value),1)])):o.value.length?(n(),r("div",Co,[v(yt,{tasks:D.value,"project-id":s.projectId,"show-project-column":!1,onTaskUpdated:se,onOpenTaskDetail:T},null,8,["tasks","project-id"])])):(n(),r("div",To,P[17]||(P[17]=[e("p",{class:"text-gray-400 text-sm"},"No tasks found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add Task" button to create a new task. ',-1)]))),v(Zn,{show:d.value,"project-id":s.projectId,"selected-task":m.value,"project-users":s.projectUsers,"task-types":S.value,milestones:g.value,"loading-task-types":M.value,"loading-milestones":O.value,onClose:P[4]||(P[4]=W=>d.value=!1),onSaved:L,onOpenAddMilestoneModal:Z},null,8,["show","project-id","selected-task","project-users","task-types","milestones","loading-task-types","loading-milestones"]),v(Ut,{show:c.value,"project-id":s.projectId,onClose:P[5]||(P[5]=W=>c.value=!1),onSaved:re},null,8,["show","project-id"]),v(Ht,{show:p.value,"task-for-note":w.value,onClose:P[6]||(P[6]=W=>p.value=!1),onNoteAdded:Ce},null,8,["show","task-for-note"]),v(Se,{show:y.value,onClose:P[9]||(P[9]=W=>y.value=!1)},{default:F(()=>[e("div",Eo,[P[21]||(P[21]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),e("div",Mo,[P[18]||(P[18]=e("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),ve(e("textarea",{"onUpdate:modelValue":P[7]||(P[7]=W=>k.value=W),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[xe,k.value]])]),e("div",So,[v(fe,{onClick:P[8]||(P[8]=W=>y.value=!1)},{default:F(()=>P[19]||(P[19]=[Y(" Cancel ",-1)])),_:1,__:[19]}),v(pe,{onClick:ee,disabled:!k.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:F(()=>P[20]||(P[20]=[Y(" Block Task ",-1)])),_:1,__:[20]},8,["disabled"])])])]),_:1},8,["show"])]))}};function $o(s){const t=Ye();return{userSignature:H(()=>{const i=t.value&&t.value.name?t.value.name:"",o=s.name??"",l="+61 456 639 389",u="ozeeweb.com.au",d="#1a73e8",m="#fbbc05",c="#1a202c",p="#4a5568",w="#e5e7eb",y="#f9fafb",E=`${window.location.origin}/logo.png`,k=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/facebook-new.png`,S=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/twitter.png`,g=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/linkedin.png`,M=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/instagram-new.png`;return`
            <div style="font-family: 'Inter', sans-serif; padding: 20px; border: 1px solid ${w}; margin-top: 30px; background-color: ${y}; border-radius: 8px; overflow: hidden; box-shadow: 0 0 0 3px ${m};">
                <table role="presentation" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td style="vertical-align: middle;">
                            <p style="margin: 0; font-size: 18px; color: ${c};">Best Regards</p>
                            <p style="margin: 0; font-size: 18px; font-weight: bold; color: ${c};">${i}</p>
                            <p style="margin: 5px 0 5px 0; font-size: 14px; color: ${p};">${o}</p>
                            <p style="margin: 0 0 15px 0; font-size: 12px; color: ${p};">
                                Your website and social media are like your home, first impressions matter!
                            </p>
                            <table role="presentation" cellspacing="0" cellpadding="0">
                                <tr>
                                    <td style="padding-right: 15px;">
                                        <p style="margin: 0; font-size: 13px; color: ${p};">📞 ${l}</p>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: ${p};">🌐 <a href="https://${u}" target="_blank" style="color: ${d}; text-decoration: none;">${u}</a></p>
                                    </td>
                                </tr>
                            </table>
                            <div style="margin-top: 15px; text-align: left;">
                                <a href="https://www.facebook.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${k}" alt="Facebook" style="vertical-align: middle;">
                                </a>
                                <a href="https://twitter.com/yourhandle" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${S}" alt="Twitter" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.linkedin.com/in/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${g}" alt="LinkedIn" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.instagram.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${M}" alt="Instagram" style="vertical-align: middle;">
                                </a>
                            </div>
                        </td>
                        <td style="padding-left: 20px; vertical-align: middle; width: 120px; text-align: right;">
                            <img src="${E}" alt="Company Logo" width="100" style="display: block; border-radius: 8px; margin-left: auto;">
                        </td>
                    </tr>
                </table>

                <p style="margin-top: 25px; font-size: 12px; color: ${p}; text-align: center;">
                    Powered by MMS IT & Web Solutions PTY Ltd.
                </p>
                <p style="margin-top: 10px; font-style: italic; color: ${p}; text-align: center; font-size: 13px;">
                    Please consider the environment before printing this email.
                </p>
                <p style="margin-top: 10px; text-align: center; font-size: 13px;">
                    How did I do? <a href="https://www.example.com/review" target="_blank" style="color: ${d}; text-decoration: none; font-weight: bold;">Leave a review!</a>
                </p>
            </div>
        `})}}const Vo={class:"mb-4"},Ao={key:0,class:"text-gray-500 text-sm"},Oo={key:1,class:"text-red-500 text-sm"},Lo={class:"mb-4"},Io={class:"mb-6"},Po={class:"mb-2 flex justify-end space-x-2"},No={class:"mb-4"},Ro={key:0,class:"mt-2"},Uo={class:"text-gray-700 text-base mb-2"},Ho=["innerHTML"],Bo={class:"p-6"},Fo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Wo={class:"block sm:inline"},Yo={class:"mb-4"},zo={class:"mb-6"},qo={class:"flex justify-end space-x-3"},Zo={class:"p-6"},Go={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Ko={class:"block sm:inline"},Jo={class:"mb-4"},Xo={class:"mb-6"},Qo={class:"flex justify-end space-x-3"},er={__name:"ComponseEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},userProjectRole:{type:Object,required:!0}},emits:["close","submitted","error"],setup(s,{emit:t}){const a=s,i=t,o=Te({project_id:a.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),l=b([]),u=b(!0),d=b(""),m=b(!1),c=b(""),p=b(""),w=b(""),y=b(!1),E=b(""),k=b("bullet"),S=b(""),g=b("full_name"),M=b(""),O=b([{value:"full_name",label:"Full Name"},{value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"custom",label:"Custom"}]),{userSignature:R}=$o(H(()=>a.userProjectRole)),I=H(()=>o.body||""),{processedHtmlBody:V}=us(I),B=H(()=>{if(o.client_ids&&o.client_ids.length>0){const L=o.client_ids[0],T=l.value.find(Z=>Z.id===L);if(T){const Z=T.name.split(" ").filter(ee=>ee.length>0),re=Z.length>0?Z[0]:"",Ce=Z.length>1?Z[Z.length-1]:"";switch(g.value){case"full_name":return`Hi ${T.name},`;case"first_name":return`Hi ${re},`;case"last_name":return`Hi ${Ce},`;case"custom":return`Hi ${M.value.trim()||"there"},`;default:return`Hi ${T.name},`}}}return"Hi there,"});ce(()=>a.show,L=>{L&&(Object.assign(o,{project_id:a.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),g.value="full_name",M.value="",d.value="",f())},{immediate:!0});const U=L=>{const T={...L};return T.client_ids&&Array.isArray(T.client_ids)&&(T.client_ids=T.client_ids.map(Z=>({id:Z}))),T.body=V.value,T.greeting_name=B.value,T.custom_greeting_name=M.value.trim(),T.first_client_id=o.client_ids&&o.client_ids.length>0?o.client_ids[0]:null,T},j=()=>{i("close")},D=L=>{i("submitted",L)},_=L=>{i("error",L)},$=()=>{c.value="",p.value="",w.value="",m.value=!0},se=()=>{if(!c.value.trim()){w.value="Link text cannot be empty.";return}let L=p.value.trim();!L.startsWith("http://")&&!L.startsWith("https://")&&(L="http://"+L);try{new URL(L)}catch{w.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const T=`[${c.value.trim()}] {${L}}`;o.body+=T,m.value=!1,c.value="",p.value="",w.value=""},ie=()=>{E.value="",k.value="bullet",S.value="",y.value=!0},C=()=>{const L=E.value.split(`
`).map(re=>re.trim()).filter(re=>re!=="");if(L.length===0){S.value="Please enter at least one list item.";return}const T=k.value==="bullet"?"ul":"ol";let Z=`<${T}>`;L.forEach(re=>{Z+=`<li>${re}</li>`}),Z+=`</${T}>`,o.body+=Z,y.value=!1,E.value="",S.value=""},f=async()=>{var L,T;u.value=!0,d.value=null;try{const Z=await window.axios.get(`/api/projects/${a.projectId}/sections/clients?type=clients`);l.value=Z.data}catch(Z){console.error("Failed to fetch project clients:",Z),d.value=((T=(L=Z.response)==null?void 0:L.data)==null?void 0:T.message)||"Failed to load client data."}finally{u.value=!1}};return ke(()=>{}),(L,T)=>(n(),r(J,null,[v($e,{show:s.show,title:"Compose New Email","api-endpoint":"/api/emails","http-method":"post","form-data":o,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","format-data-for-api":U,onClose:j,onSubmitted:D,onError:_,"max-width":"3xl"},{default:F(({errors:Z})=>[e("div",Vo,[v(G,{for:"client_ids",value:"To (Clients)"}),u.value?(n(),r("div",Ao,"Loading clients...")):d.value?(n(),r("div",Oo,h(d.value),1)):(n(),ae(Xe,{key:2,modelValue:o.client_ids,"onUpdate:modelValue":T[0]||(T[0]=re=>o.client_ids=re),options:l.value,placeholder:"Select one or more clients","label-key":"name","value-key":"id"},null,8,["modelValue","options"])),v(oe,{message:Z.client_ids?Z.client_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Lo,[v(G,{for:"subject",value:"Subject"}),v(me,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:o.subject,"onUpdate:modelValue":T[1]||(T[1]=re=>o.subject=re),required:""},null,8,["modelValue"]),v(oe,{message:Z.subject?Z.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Io,[e("div",Po,[v(fe,{type:"button",onClick:ie},{default:F(()=>T[13]||(T[13]=[Y(" Insert List ",-1)])),_:1,__:[13]}),v(fe,{type:"button",onClick:$},{default:F(()=>T[14]||(T[14]=[Y(" Insert Link ",-1)])),_:1,__:[14]})]),e("div",No,[v(G,{for:"greeting_type",value:"Address Client By"}),v(ge,{id:"greeting_type",modelValue:g.value,"onUpdate:modelValue":T[2]||(T[2]=re=>g.value=re),options:O.value,"value-key":"value","label-key":"label",class:"mt-1 block w-full"},null,8,["modelValue","options"]),g.value==="custom"?(n(),r("div",Ro,[v(G,{for:"custom_greeting_name",value:"Custom Name"}),v(me,{id:"custom_greeting_name",type:"text",class:"mt-1 block w-full",modelValue:M.value,"onUpdate:modelValue":T[3]||(T[3]=re=>M.value=re),placeholder:"e.g., Azaan"},null,8,["modelValue"])])):x("",!0)]),e("p",Uo,h(B.value),1),v(G,{for:"body",value:"Email Body",class:"sr-only"}),v(ps,{id:"body",modelValue:o.body,"onUpdate:modelValue":T[4]||(T[4]=re=>o.body=re),placeholder:"Compose your email here...",height:"300px"},null,8,["modelValue"]),v(oe,{message:Z.body?Z.body[0]:"",class:"mt-2"},null,8,["message"])]),q(R)?(n(),r("div",{key:0,class:"unselectable-signature",innerHTML:q(R)},null,8,Ho)):x("",!0)]),_:1},8,["show","form-data"]),v(Se,{show:m.value,onClose:T[8]||(T[8]=Z=>m.value=!1),"max-width":"md"},{default:F(()=>[e("div",Bo,[T[17]||(T[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),w.value?(n(),r("div",Fo,[e("span",Wo,h(w.value),1)])):x("",!0),e("div",Yo,[v(G,{for:"link_text",value:"Link Text"}),v(me,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:c.value,"onUpdate:modelValue":T[5]||(T[5]=Z=>c.value=Z),onKeyup:Fe(se,["enter"])},null,8,["modelValue"])]),e("div",zo,[v(G,{for:"link_url",value:"URL"}),v(me,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:p.value,"onUpdate:modelValue":T[6]||(T[6]=Z=>p.value=Z),placeholder:"e.g., https://www.example.com",onKeyup:Fe(se,["enter"])},null,8,["modelValue"])]),e("div",qo,[v(fe,{onClick:T[7]||(T[7]=Z=>m.value=!1)},{default:F(()=>T[15]||(T[15]=[Y("Cancel",-1)])),_:1,__:[15]}),v(pe,{onClick:se},{default:F(()=>T[16]||(T[16]=[Y("Insert",-1)])),_:1,__:[16]})])])]),_:1},8,["show"]),v(Se,{show:y.value,onClose:T[12]||(T[12]=Z=>y.value=!1),"max-width":"md"},{default:F(()=>[e("div",Zo,[T[21]||(T[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),S.value?(n(),r("div",Go,[e("span",Ko,h(S.value),1)])):x("",!0),e("div",Jo,[v(G,{for:"list_items",value:"List Items (one per line)"}),ve(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":T[9]||(T[9]=Z=>E.value=Z),placeholder:"Enter each list item on a new line"},null,512),[[xe,E.value]])]),e("div",Xo,[v(G,{for:"list_type",value:"List Type"}),ve(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":T[10]||(T[10]=Z=>k.value=Z)},T[18]||(T[18]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[We,k.value]])]),e("div",Qo,[v(fe,{onClick:T[11]||(T[11]=Z=>y.value=!1)},{default:F(()=>T[19]||(T[19]=[Y("Cancel",-1)])),_:1,__:[19]}),v(pe,{onClick:C},{default:F(()=>T[20]||(T[20]=[Y("Insert List",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])],64))}},xt=Ve(er,[["__scopeId","data-v-70bf1503"]]),tr={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},sr={class:"flex justify-between items-center mb-4"},ar={key:0,class:"flex gap-3"},lr={key:1,class:"mt-2 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative",role:"alert"},ir={class:"block sm:inline"},nr={class:"mb-4 bg-gray-50 p-4 rounded-lg"},or={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},rr={class:"mt-1 relative rounded-md shadow-sm"},dr={__name:"ProjectEmailsTab",props:{projectId:{type:Number,required:!0},canViewEmails:{type:Boolean,required:!0},canComposeEmails:{type:Boolean,required:!0},canApproveEmails:{type:Boolean,required:!0},userProjectRole:{type:Object,required:!0},openCompose:{type:Boolean,required:!1,default:!1}},emits:["emailsUpdated","resetOpenCompose"],setup(s,{emit:t}){const a=s,i=t,o=b([]),l=b(!0),u=b(""),d=b(null),m=b(!1),c=b(!1),p=b(""),w=b(""),y=b("post"),E=b(""),k=b(""),S=b(!1),g=b(!1),M=b(null),O=b(""),R=b(""),I=b(""),V=b(null);Ye();const B=Te({type:"",startDate:"",endDate:"",search:""});let U=null;const j=()=>{$()},D=()=>{B.type="",B.startDate="",B.endDate="",B.search="",$()},_=()=>{clearTimeout(U),U=setTimeout(()=>{j()},500)},$=async()=>{l.value=!0,u.value="";try{const ee=new URLSearchParams;B.type&&ee.append("type",B.type),B.startDate&&ee.append("start_date",B.startDate),B.endDate&&ee.append("end_date",B.endDate),B.search&&ee.append("search",B.search);const A=ee.toString(),P=`/api/projects/${a.projectId}/emails-simplified${A?`?${A}`:""}`,W=await window.axios.get(P);o.value=W.data,i("emailsUpdated",o.value)}catch(ee){u.value="Failed to load email data.",console.error("Error fetching project emails:",ee)}finally{l.value=!1}},se=async ee=>{d.value=null,m.value=!0;try{const A=await window.axios.get(`/api/emails/${ee.id}`);d.value={...ee,subject:A.data.subject,body:A.data.body_html}}catch(A){console.error("Failed to fetch full email details:",A),d.value={subject:"Error",body:"Failed to load email content.",created_at:new Date().toISOString(),status:"error",sender:{name:"System"}}}},ie=async ee=>{try{console.log("Opening email editor for email ID:",ee.id),d.value=ee;const P=(await window.axios.get(`/api/emails/${ee.id}/edit-content`)).data;P.template_id?(console.log("Opening template-based email editor for email ID:",ee.id),M.value=ee.id,O.value=`/api/emails/${ee.id}/edit-and-approve`,R.value="Approve & Send",I.value="Email updated and approved successfully!",V.value=P.client_id,g.value=!0,m.value=!1):(p.value="Edit and Approve Email",w.value=`/api/emails/${ee.id}/edit-and-approve`,y.value="post",E.value="Approve & Send",k.value="Email updated and approved successfully!",c.value=!0,m.value=!1)}catch(A){console.error("Failed to determine email type:",A),u.value="Failed to load email for editing."}},C=ee=>{d.value=ee,p.value="Reject Email",w.value=`/api/emails/${ee.id}/reject`,y.value="post",E.value="Reject Email",k.value="Email rejected successfully!",c.value=!0,m.value=!1},f=async ee=>{console.log("Form submitted successfully:",ee),await $(),c.value=!1},L=()=>{c.value=!1},T=()=>{S.value=!1,i("resetOpenCompose")},Z=async ee=>{console.log("Compose email submitted successfully:",ee),await $(),S.value=!1,i("resetOpenCompose")},re=()=>{g.value=!1},Ce=async ee=>{console.log("Template email edited and submitted successfully:",ee),await $(),g.value=!1};return ce(()=>a.openCompose,ee=>{console.log("Watcher triggered: openCompose changed to",ee),ee&&(console.log("Opening compose email modal"),S.value=!0)}),ke(()=>{a.canViewEmails&&$(),a.openCompose&&(S.value=!0)}),(ee,A)=>{var P;return s.canViewEmails?(n(),r("div",tr,[e("div",sr,[A[10]||(A[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Email Communication",-1)),s.canComposeEmails?(n(),r("div",ar,[v(pe,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:A[0]||(A[0]=W=>S.value=!0)},{default:F(()=>A[9]||(A[9]=[Y(" Compose Email ",-1)])),_:1,__:[9]})])):x("",!0),u.value?(n(),r("div",lr,[e("span",ir,h(u.value),1)])):x("",!0)]),e("div",nr,[e("div",or,[e("div",null,[v(G,{for:"typeFilter",value:"Type"}),ve(e("select",{id:"typeFilter","onUpdate:modelValue":A[1]||(A[1]=W=>B.type=W),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:j},A[11]||(A[11]=[e("option",{value:""},"All Types",-1),e("option",{value:"sent"},"Sent",-1),e("option",{value:"received"},"Received",-1)]),544),[[We,B.type]])]),e("div",null,[v(G,{for:"startDate",value:"From Date"}),v(me,{type:"date",id:"startDate",modelValue:B.startDate,"onUpdate:modelValue":A[2]||(A[2]=W=>B.startDate=W),class:"mt-1 block w-full",onChange:j},null,8,["modelValue"])]),e("div",null,[v(G,{for:"endDate",value:"To Date"}),v(me,{type:"date",id:"endDate",modelValue:B.endDate,"onUpdate:modelValue":A[3]||(A[3]=W=>B.endDate=W),class:"mt-1 block w-full",onChange:j},null,8,["modelValue"])]),e("div",null,[v(G,{for:"searchFilter",value:"Search Content"}),e("div",rr,[v(me,{type:"text",id:"searchFilter",modelValue:B.search,"onUpdate:modelValue":A[4]||(A[4]=W=>B.search=W),class:"block w-full pr-10",placeholder:"Search in email content...",onInput:_},null,8,["modelValue"]),A[12]||(A[12]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:D}," Reset Filters ")])]),v(hs,{emails:o.value,loading:l.value,error:u.value,onView:se},null,8,["emails","loading","error"]),v(cs,{show:m.value,email:d.value,"can-approve-emails":s.canApproveEmails,onClose:A[5]||(A[5]=W=>m.value=!1),onEdit:ie,onReject:C},null,8,["show","email","can-approve-emails"]),v(xt,{show:S.value,"project-id":s.projectId,"user-project-role":s.userProjectRole,onClose:T,onSubmitted:Z,onError:A[6]||(A[6]=W=>console.error("ComposeEmailModal error:",W))},null,8,["show","project-id","user-project-role"]),v(ms,{show:c.value,title:p.value,"api-endpoint":w.value,"http-method":y.value,"submit-button-text":E.value,"success-message":k.value,"email-id":(P=d.value)==null?void 0:P.id,"project-id":s.projectId,onClose:L,onSubmitted:f,onError:A[7]||(A[7]=W=>console.error("EmailActionModal error:",W)),onFetchEmails:$},null,8,["show","title","api-endpoint","http-method","submit-button-text","success-message","email-id","project-id"]),v(vs,{show:g.value,title:"Edit Template Email","api-endpoint":O.value,"http-method":"post","submit-button-text":R.value,"success-message":I.value,"email-id":M.value,"project-id":s.projectId,"client-id":V.value,onClose:re,onSubmitted:Ce,onError:A[8]||(A[8]=W=>console.error("EditTemplateEmailModal error:",W))},null,8,["show","api-endpoint","submit-button-text","success-message","email-id","project-id","client-id"])])):x("",!0)}}},ur={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},cr={class:"flex justify-between items-center mb-4"},mr={class:"flex gap-3"},vr={class:"mb-4 bg-gray-50 p-4 rounded-lg"},pr={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},hr={class:"mt-1 relative rounded-md shadow-sm"},gr={class:"mb-8 p-4 bg-blue-50 rounded-md"},fr={class:"flex items-center"},yr={class:"text-sm text-blue-800"},wr={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},br={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},_r={key:2,class:"space-y-4"},xr={class:"flex justify-between"},kr={class:"flex-grow"},Dr={key:0,class:"text-xs text-red-400 block mt-1"},Cr={class:"flex items-center mt-1"},Tr={class:"text-xs text-gray-500"},Er={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},Mr={key:0},Sr={key:3,class:"text-gray-400 text-sm"},jr={class:"p-6"},$r={class:"flex justify-between items-center mb-4"},Vr={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},Ar={class:"text-sm text-gray-700"},Or={class:"text-xs text-gray-500 mt-1"},Lr={key:1,class:"mb-4"},Ir={key:0,class:"text-center py-4"},Pr={key:1,class:"space-y-3 max-h-60 overflow-y-auto"},Nr={class:"text-sm text-gray-700"},Rr={class:"text-xs text-gray-500 mt-1"},Ur={key:2,class:"text-center py-3"},Hr={key:2,class:"mb-4"},Br={key:0,class:"mt-2 text-sm text-red-600"},Fr={key:3,class:"mt-6 flex justify-end"},Wr={__name:"ProjectNotesTab",props:{projectId:{type:Number,required:!0},googleChatId:{type:String,default:null},canViewNotes:{type:Boolean,required:!0},canAddNotes:{type:Boolean,required:!0}},emits:["notesUpdated"],setup(s,{emit:t}){const a=s,i=t,o=b([]),l=b(!0),u=b(""),d=b(!1),m=b(!1),c=b(null),p=b(""),w=b(""),y=b([]),E=b(!1),k=Te({startDate:"",endDate:"",search:""});let S=null;const g=async()=>{l.value=!0,u.value="";try{const U=new URLSearchParams;k.startDate&&U.append("start_date",k.startDate),k.endDate&&U.append("end_date",k.endDate),k.search&&U.append("search",k.search);const j=U.toString(),D=`/api/projects/${a.projectId}/notes${j?`?${j}`:""}`,_=await window.axios.get(D);o.value=_.data,i("notesUpdated",o.value)}catch(U){u.value="Failed to load notes data.",console.error("Error fetching project notes:",U)}finally{l.value=!1}},M=()=>{d.value=!0},O=async U=>{c.value=U,p.value="",w.value="",y.value=[],E.value=!0,m.value=!0;try{const j=await window.axios.get(`/api/projects/${a.projectId}/notes/${U.id}/replies`);j.data.success?y.value=j.data.replies:console.error("Failed to fetch replies:",j.data.message)}catch(j){console.error("Error fetching replies:",j)}finally{E.value=!1}},R=async()=>{var U,j;if(!c.value||!p.value.trim()){w.value="Reply content is required";return}w.value="";try{const D=await window.axios.post(`/api/projects/${a.projectId}/notes/${c.value.id}/reply`,{content:p.value});if(D.data.success){p.value="",E.value=!0;const _=await window.axios.get(`/api/projects/${a.projectId}/notes/${c.value.id}/replies`);_.data.success&&(y.value=_.data.replies),E.value=!1,await g()}else w.value=D.data.message||"Failed to send reply"}catch(D){console.error("Error sending reply:",D),w.value=((j=(U=D.response)==null?void 0:U.data)==null?void 0:j.message)||"An error occurred while sending the reply"}},I=()=>{g()},V=()=>{k.startDate="",k.endDate="",k.search="",g()},B=()=>{clearTimeout(S),S=setTimeout(()=>{I()},500)};return ke(()=>{a.canViewNotes&&g()}),(U,j)=>s.canViewNotes?(n(),r("div",ur,[e("div",cr,[j[10]||(j[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Notes",-1)),e("div",mr,[s.canAddNotes?(n(),ae(pe,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:M},{default:F(()=>j[9]||(j[9]=[Y(" Add Note ",-1)])),_:1,__:[9]})):x("",!0)])]),e("div",vr,[e("div",pr,[e("div",null,[v(G,{for:"noteStartDate",value:"From Date"}),v(me,{type:"date",id:"noteStartDate",modelValue:k.startDate,"onUpdate:modelValue":j[0]||(j[0]=D=>k.startDate=D),class:"mt-1 block w-full",onChange:I},null,8,["modelValue"])]),e("div",null,[v(G,{for:"noteEndDate",value:"To Date"}),v(me,{type:"date",id:"noteEndDate",modelValue:k.endDate,"onUpdate:modelValue":j[1]||(j[1]=D=>k.endDate=D),class:"mt-1 block w-full",onChange:I},null,8,["modelValue"])]),e("div",null,[v(G,{for:"noteSearchFilter",value:"Search Content"}),e("div",hr,[v(me,{type:"text",id:"noteSearchFilter",modelValue:k.search,"onUpdate:modelValue":j[2]||(j[2]=D=>k.search=D),class:"block w-full pr-10",placeholder:"Search in note content...",onInput:B},null,8,["modelValue"]),j[11]||(j[11]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:V}," Reset Filters ")])]),e("div",gr,[e("div",fr,[j[13]||(j[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",yr,[j[12]||(j[12]=Y(" Daily Standups are now available in their own dedicated tab. ",-1)),e("button",{onClick:j[3]||(j[3]=D=>U.$emit("changeTab","standups")),class:"text-blue-600 hover:text-blue-800 font-medium underline"}," Click here to view Daily Standups ")])])]),e("div",null,[j[15]||(j[15]=e("h5",{class:"text-md font-semibold text-gray-900 mb-4 border-b pb-2"},"Notes",-1)),l.value?(n(),r("div",wr," Loading notes... ")):u.value?(n(),r("div",br,h(u.value),1)):o.value.length?(n(),r("div",_r,[(n(!0),r(J,null,te(o.value,D=>{var _;return n(),r("div",{key:D.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",xr,[e("div",kr,[e("p",{class:X(["text-sm",{"text-gray-700":D.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":D.content==="[Encrypted content could not be decrypted]"}])},[Y(h(D.content)+" ",1),D.content==="[Encrypted content could not be decrypted]"?(n(),r("span",Dr," (There was an issue decrypting this note. Please contact an administrator.) ")):x("",!0)],2),e("div",Cr,[e("p",Tr,"Added by "+h(((_=D.user)==null?void 0:_.name)||"Unknown")+" on "+h(new Date(D.created_at).toLocaleDateString()),1),D.reply_count>0?(n(),r("span",Er,h(D.reply_count)+" "+h(D.reply_count===1?"reply":"replies"),1)):x("",!0)])]),s.googleChatId&&D.chat_message_id?(n(),r("div",Mr,[v(fe,{class:"text-sm text-indigo-600 hover:text-indigo-800",onClick:$=>O(D)},{default:F(()=>j[14]||(j[14]=[Y(" View ",-1)])),_:2,__:[14]},1032,["onClick"])])):x("",!0)])])}),128))])):(n(),r("p",Sr,"No notes available."))]),v(wt,{show:d.value,"project-id":s.projectId,onClose:j[4]||(j[4]=D=>d.value=!1),onNoteAdded:g},null,8,["show","project-id"]),v(Se,{show:m.value,onClose:j[8]||(j[8]=D=>m.value=!1)},{default:F(()=>{var D;return[e("div",jr,[e("div",$r,[j[17]||(j[17]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Reply to Note",-1)),e("button",{onClick:j[5]||(j[5]=_=>m.value=!1),class:"text-gray-400 hover:text-gray-500"},j[16]||(j[16]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),c.value?(n(),r("div",Vr,[e("p",Ar,h(c.value.content),1),e("p",Or,"Added by "+h(((D=c.value.user)==null?void 0:D.name)||"Unknown")+" on "+h(new Date(c.value.created_at).toLocaleDateString()),1)])):x("",!0),c.value?(n(),r("div",Lr,[j[20]||(j[20]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Replies",-1)),E.value?(n(),r("div",Ir,j[18]||(j[18]=[e("p",{class:"text-gray-500 text-sm"},"Loading replies...",-1)]))):y.value.length?(n(),r("div",Pr,[(n(!0),r(J,null,te(y.value,_=>{var $;return n(),r("div",{key:_.id,class:"p-2 bg-gray-50 rounded border-l-2 border-indigo-300"},[e("p",Nr,h(_.content),1),e("p",Rr,"Replied by "+h((($=_.user)==null?void 0:$.name)||"Unknown")+" on "+h(new Date(_.created_at).toLocaleDateString()),1)])}),128))])):(n(),r("div",Ur,j[19]||(j[19]=[e("p",{class:"text-gray-500 text-sm"},"No replies yet. Be the first to reply!",-1)])))])):x("",!0),s.canAddNotes?(n(),r("div",Hr,[v(G,{for:"reply-content",value:"Your Reply"}),ve(e("textarea",{id:"reply-content","onUpdate:modelValue":j[6]||(j[6]=_=>p.value=_),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your reply..."},null,512),[[xe,p.value]]),w.value?(n(),r("p",Br,h(w.value),1)):x("",!0)])):x("",!0),s.canAddNotes?(n(),r("div",Fr,[v(fe,{onClick:j[7]||(j[7]=_=>m.value=!1),class:"mr-2"},{default:F(()=>j[21]||(j[21]=[Y("Cancel",-1)])),_:1,__:[21]}),v(pe,{onClick:R},{default:F(()=>j[22]||(j[22]=[Y("Send Reply",-1)])),_:1,__:[22]})])):x("",!0)])]}),_:1},8,["show"])])):x("",!0)}},Yr={class:"w-full"},zr={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},qr={key:1,class:"text-red-600 text-sm py-2 text-center"},Zr={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Gr={class:"p-4 bg-blue-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Kr={class:"text-2xl font-bold text-blue-900 mt-1"},Jr={class:"p-4 bg-green-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Xr={class:"text-2xl font-bold text-green-900 mt-1"},Qr={class:"p-4 bg-red-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},ed={class:"text-2xl font-bold mt-1"},td={key:3,class:"space-y-2 text-sm text-gray-700 mt-6 pt-4 border-t border-gray-200"},sd={key:0},ad={class:"text-gray-900 whitespace-pre-wrap"},ld={key:4,class:"text-gray-400 text-sm mt-4 text-center"},id={__name:"ProjectFinancialsCard",props:{projectId:{type:Number,required:!0},canViewProjectServicesAndPayments:{type:Boolean,default:!1},canViewProjectTransactions:{type:Boolean,default:!1}},setup(s){const t=s,a=b(null),i=b([]),o=b(!0),l=b(null),u=Ue,d=H(()=>{var E;if(!be.value||Object.keys(be.value).length===0)return 0;const y=parseFloat(((E=a.value)==null?void 0:E.total_amount)||0);return qe(y,"USD",u.value)}),m=H(()=>!i.value.length||!be.value||Object.keys(be.value).length===0?0:i.value.filter(y=>y.type==="expense").reduce((y,E)=>y+qe(parseFloat(E.amount||0),E.currency,u.value),0)),c=H(()=>!i.value.length||!be.value||Object.keys(be.value).length===0?0:i.value.filter(y=>y.type==="income").reduce((y,E)=>y+qe(parseFloat(E.amount||0),E.currency,u.value),0)),p=H(()=>c.value-m.value),w=async()=>{var y,E;if(o.value=!0,l.value=null,i.value=[],!be.value||Object.keys(be.value).length===0){l.value="Currency rates not loaded. Please try again.",o.value=!1;return}if(!t.canViewProjectServicesAndPayments&&!t.canViewProjectTransactions){l.value="You don't have permission to view project financials.",o.value=!1;return}try{if(t.canViewProjectServicesAndPayments){const k=await window.axios.get(`/api/projects/${t.projectId}/sections/services-payment`);a.value=k.data}else a.value=null;if(t.canViewProjectTransactions){const k=await window.axios.get(`/api/projects/${t.projectId}/sections/transactions`);i.value=k.data}else i.value=[]}catch(k){console.error("Failed to fetch project financials:",k),l.value=((E=(y=k.response)==null?void 0:y.data)==null?void 0:E.message)||"Failed to load financial data."}finally{o.value=!1}};return ce([()=>t.canViewProjectServicesAndPayments,()=>t.canViewProjectTransactions,u,be],(y,E)=>{t.projectId&&be.value&&Object.keys(be.value).length>0?w():t.projectId||(o.value=!0,l.value=null)},{immediate:!0,deep:!0}),(y,E)=>{var k,S;return n(),r("div",Yr,[o.value?(n(),r("div",zr,[(n(),r(J,null,te(4,g=>e("div",{key:g,class:"p-4 bg-gray-100 rounded-lg animate-pulse h-24"},E[0]||(E[0]=[e("div",{class:"h-4 bg-gray-200 rounded w-1/2 mb-3"},null,-1),e("div",{class:"h-6 bg-gray-200 rounded w-3/4"},null,-1)]))),64))])):l.value?(n(),r("div",qr,[e("p",null,h(l.value),1)])):(n(),r("div",Zr,[e("div",Gr,[E[1]||(E[1]=e("p",{class:"text-sm font-medium text-blue-800"},"Contract Value",-1)),e("p",Kr,h(q(Re)(d.value,q(u).value)),1)]),e("div",Jr,[E[2]||(E[2]=e("p",{class:"text-sm font-medium text-green-800"},"Total Income",-1)),e("p",Xr,h(q(Re)(c.value,q(u))),1)]),e("div",Qr,[E[3]||(E[3]=e("p",{class:"text-sm font-medium text-red-800"},"Total Expenses",-1)),e("p",ed,h(q(Re)(m.value,q(u))),1)]),e("div",{class:X(["p-4 rounded-lg shadow-sm transition-shadow hover:shadow-lg",{"bg-green-100":p.value>=0,"bg-red-100":p.value<0}])},[e("p",{class:X(["text-sm font-medium",{"text-green-800":p.value>=0,"text-red-800":p.value<0}])},"Profit/Loss",2),e("p",{class:X(["text-2xl font-bold mt-1",{"text-green-900":p.value>=0,"text-red-900":p.value<0}])},h(q(Re)(p.value,q(u))),3)],2)])),!o.value&&!l.value&&((k=a.value)!=null&&k.contract_details)?(n(),r("dl",td,[(S=a.value)!=null&&S.contract_details?(n(),r("div",sd,[E[4]||(E[4]=e("dt",{class:"font-medium w-full block mt-2"},"Contract Details:",-1)),e("dd",ad,h(a.value.contract_details),1)])):x("",!0)])):x("",!0),!o.value&&!l.value&&!a.value&&!i.value.length?(n(),r("p",ld," No financial information available. ")):x("",!0)])}}},nd={class:"p-4"},od={key:0,class:"text-center text-gray-600"},rd={key:1,class:"text-red-600 text-sm py-2"},dd={key:2,class:"text-gray-500 text-center py-4"},ud={key:3,class:"overflow-x-auto"},cd={class:"min-w-full divide-y divide-gray-200"},md={class:"bg-white divide-y divide-gray-200"},vd={class:"px-4 py-3 text-sm text-gray-900"},pd={class:"px-4 py-3 text-sm text-gray-700"},hd={class:"px-4 py-3 text-sm text-right text-gray-900"},gd={class:"px-4 py-3 text-sm"},fd={class:"px-4 py-3 text-sm text-gray-700"},yd={__name:"UserTransactionsModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectName:{type:String,required:!1}},emits:["close"],setup(s,{emit:t}){const a=s,i=Ye(),o=b(!0),l=b(null),u=b([]);b("PKR");const d=(c,p="USD")=>isNaN(c)||c==null?"0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:p,minimumFractionDigits:2,maximumFractionDigits:2}).format(c),m=async()=>{var c,p;if(o.value=!0,l.value=null,u.value=[],!i.value||!i.value.id||!a.projectId){l.value="User not authenticated or project ID missing.",o.value=!1;return}try{const w=await window.axios.get(`/api/projects/${a.projectId}/sections/transactions?user_id=${i.value.id}`);u.value=w.data}catch(w){console.error("Failed to fetch user-specific transactions for modal:",w),l.value=((p=(c=w.response)==null?void 0:c.data)==null?void 0:p.message)||"Failed to load transactions."}finally{o.value=!1}};return ce(()=>a.show,c=>{c&&m()},{immediate:!1}),ce([()=>{var c;return(c=i.value)==null?void 0:c.id},()=>a.projectId],(c,p)=>{a.show&&m()},{deep:!0}),H(()=>`Your Transactions for Project ${a.projectId}`),(c,p)=>(n(),ae($e,{show:s.show,title:"Transactions for: "+s.projectName,"show-footer":!1,onClose:p[0]||(p[0]=w=>c.$emit("close")),"hide-submit-button":!0,"hide-cancel-button":!0,"api-endpoint":null,"form-data":"{}"},{default:F(({errors:w})=>[e("div",nd,[o.value?(n(),r("div",od,p[1]||(p[1]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"})],-1)]))):l.value?(n(),r("div",rd,[e("p",null,h(l.value),1)])):u.value.length===0?(n(),r("div",dd," No transactions found for you on this project. ")):(n(),r("div",ud,[e("table",cd,[p[2]||(p[2]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date")])],-1)),e("tbody",md,[(n(!0),r(J,null,te(u.value,y=>(n(),r("tr",{key:y.id,class:"hover:bg-gray-50 transition-colors"},[e("td",vd,h(y.description),1),e("td",pd,h(y.type),1),e("td",hd,h(d(y.amount,y.currency)),1),e("td",gd,[e("span",{class:X({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":y.is_paid===1,"bg-yellow-100 text-yellow-800":y.is_paid===0})},h(y.is_paid===1?"Paid":"Unpaid"),3)]),e("td",fd,h(new Date(y.created_at).toLocaleDateString()),1)]))),128))])])]))])]),_:1},8,["show","title"]))}},wd={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},bd={class:"flex justify-between items-center mb-4"},_d={class:"mb-6 bg-gray-50 p-4 rounded-lg"},xd={class:"flex items-center gap-4"},kd={class:"flex-1 min-w-[200px]"},Dd={key:0,class:"text-red-600 text-sm mt-2"},Cd={key:1,class:"text-gray-600 text-sm mt-2 animate-pulse"},Td={key:2,class:"text-gray-500 text-sm mt-2"},Ed={class:"mt-6"},Md={class:"flex justify-between items-center mb-3"},Sd={class:"text-md font-medium text-gray-800"},jd={key:0},$d={key:1},Vd={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-8"},Ad={key:1,class:"text-center py-8"},Od={class:"text-red-600 text-sm font-medium"},Ld={key:2,class:"text-center py-8"},Id={class:"text-red-600 text-sm font-medium"},Pd={key:3,class:"space-y-8"},Nd={class:"bg-gray-50 p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Rd={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Ud={class:"text-lg font-semibold text-gray-900"},Hd={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Bd={class:"text-lg font-semibold text-gray-900"},Fd={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Wd={class:"text-lg font-semibold text-gray-900"},Yd={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},zd={class:"text-lg font-semibold text-gray-900"},qd={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Zd={class:"text-lg font-semibold text-gray-900"},Gd={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Kd={class:"text-lg font-semibold text-gray-900"},Jd={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Xd={class:"text-lg font-semibold text-gray-900"},Qd={class:"bg-white p-6 rounded-lg shadow-sm"},eu={class:"overflow-x-auto max-h-60"},tu={class:"min-w-full divide-y divide-gray-200"},su={class:"bg-white divide-y divide-gray-200"},au={class:"px-4 py-3 text-sm text-gray-900"},lu={class:"px-4 py-3 text-sm text-gray-700"},iu={class:"px-4 py-3 text-sm text-gray-700"},nu={key:0,class:"text-gray-500 text-sm py-2"},ou={class:"bg-white p-6 rounded-lg shadow-sm"},ru={class:"overflow-x-auto max-h-60"},du={class:"min-w-full divide-y divide-gray-200"},uu={class:"bg-white divide-y divide-gray-200"},cu={class:"px-4 py-3 text-sm text-gray-900"},mu={class:"px-4 py-3 text-sm text-gray-700"},vu={class:"px-4 py-3 text-sm text-gray-700"},pu={class:"px-4 py-3 text-sm text-gray-700"},hu={class:"px-4 py-3 text-sm text-gray-700"},gu={key:0,class:"text-gray-500 text-sm py-2"},fu={class:"bg-white p-6 rounded-lg shadow-sm"},yu={class:"overflow-x-auto max-h-60"},wu={class:"min-w-full divide-y divide-gray-200"},bu={class:"bg-white divide-y divide-gray-200"},_u={class:"px-4 py-3 text-sm text-gray-900"},xu={class:"px-4 py-3 text-sm text-gray-700"},ku={key:0,class:"text-gray-500 text-sm py-2"},Du={class:"bg-white p-6 rounded-lg shadow-sm"},Cu={class:"overflow-x-auto"},Tu={class:"min-w-full divide-y divide-gray-200"},Eu={class:"bg-white divide-y divide-gray-200"},Mu={class:"px-4 py-3 text-sm text-gray-900"},Su={class:"px-4 py-3 text-sm text-gray-700"},ju={key:0,class:"text-gray-500 text-sm py-2"},$u={class:"bg-white p-6 rounded-lg shadow-sm"},Vu={class:"overflow-x-auto"},Au={class:"min-w-full divide-y divide-gray-200"},Ou={class:"bg-white divide-y divide-gray-200"},Lu={class:"px-4 py-3 text-sm text-gray-900"},Iu={class:"px-4 py-3 text-sm text-gray-700"},Pu={key:0,class:"text-gray-500 text-sm py-2"},Nu={class:"bg-white p-6 rounded-lg shadow-sm"},Ru={class:"overflow-x-auto max-h-60"},Uu={class:"min-w-full divide-y divide-gray-200"},Hu={class:"bg-white divide-y divide-gray-200"},Bu={class:"px-4 py-3 text-sm text-gray-900"},Fu={class:"px-4 py-3 text-sm text-gray-700"},Wu={key:0,class:"text-gray-500 text-sm py-2"},Yu={class:"bg-white p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6"},zu={key:0,class:"space-y-2"},qu={class:"font-medium"},Zu={key:1,class:"text-gray-500 text-sm py-2"},Gu={key:0,class:"space-y-2"},Ku={class:"font-medium"},Ju={key:1,class:"text-gray-500 text-sm py-2"},Xu={key:4,class:"text-center py-8 text-gray-500"},Qu={__name:"SeoReportTab",props:{projectId:{type:[String,Number],required:!0},canCreateSeoReports:{type:Boolean,default:!1}},emits:["openCreateSeoReportModal"],setup(s,{emit:t}){const a=s,i=t,o=b([]),l=b(""),u=b(null),d=b(!0),m=b(!1),c=b(null),p=b(null),w=b(null),y=async()=>{d.value=!0,c.value=null;try{const C=await window.axios.get(`/api/projects/${a.projectId}/seo-reports/available-months`);o.value=C.data.map(f=>({value:f,label:new Date(f+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})})),o.value.length>0&&(l.value=o.value[0].value)}catch(C){console.error("Error fetching available months:",C),c.value="Failed to load available report months."}finally{d.value=!1}},E=C=>{const L=["clientName","reportingPeriod","authorityScoreValue","totalClicksValue","totalImpressionsValue","averagePositionValue","totalBacklinksValue","clicksImpressions","trafficSources","deviceUsage","countryPerformance","coreVitals","topQueries","keywordRankings","backlinks","zeroClickKeywords"].filter(T=>!(T in C));return L.length>0?`Report data is missing expected top-level keys: ${L.join(", ")}. Please ensure the JSON structure is correct.`:!C.clicksImpressions||!Array.isArray(C.clicksImpressions.labels)||!Array.isArray(C.clicksImpressions.clicks)?"clicksImpressions data is malformed.":!C.trafficSources||!Array.isArray(C.trafficSources.labels)||!Array.isArray(C.trafficSources.sessions)?"trafficSources data is malformed.":null},k=async()=>{if(!l.value){u.value=null,w.value=null;return}m.value=!0,p.value=null,w.value=null;try{const f=(await window.axios.get(`/api/projects/${a.projectId}/seo-reports/${l.value}`)).data,L=E(f);L?(w.value=L,u.value=null):u.value=f}catch(C){console.error("Error fetching SEO report:",C),p.value="Failed to load SEO report for the selected month.",u.value=null,w.value=null}finally{m.value=!1}},S=(C=null)=>{i("openCreateSeoReportModal",C)},g=H(()=>{var C;return((C=u.value)==null?void 0:C.clientName)||"N/A"}),M=H(()=>{var C;return((C=u.value)==null?void 0:C.reportingPeriod)||"N/A"}),O=H(()=>{var C;return((C=u.value)==null?void 0:C.authorityScoreValue)||"N/A"}),R=H(()=>{var C;return((C=u.value)==null?void 0:C.totalClicksValue)||"N/A"}),I=H(()=>{var C;return((C=u.value)==null?void 0:C.totalImpressionsValue)||"N/A"}),V=H(()=>{var C;return((C=u.value)==null?void 0:C.averagePositionValue)||"N/A"}),B=H(()=>{var C;return((C=u.value)==null?void 0:C.totalBacklinksValue)||"N/A"}),U=H(()=>{var C;return((C=u.value)==null?void 0:C.clicksImpressions)||{labels:[],clicks:[],impressions:[]}}),j=H(()=>{var C;return((C=u.value)==null?void 0:C.trafficSources)||{labels:[],sessions:[],colors:[]}}),D=H(()=>{var C;return((C=u.value)==null?void 0:C.deviceUsage)||{labels:[],clicks:[],colors:[]}}),_=H(()=>{var C;return((C=u.value)==null?void 0:C.countryPerformance)||{labels:[],clicks:[]}}),$=H(()=>{var C;return((C=u.value)==null?void 0:C.coreVitals)||{mobile:{},desktop:{}}}),se=H(()=>{var C;return((C=u.value)==null?void 0:C.topQueries)||[]}),ie=H(()=>{var C;return((C=u.value)==null?void 0:C.keywordRankings)||[]});return ke(()=>{y()}),ce(()=>a.projectId,()=>{y()}),ce(l,C=>{C?k():(u.value=null,w.value=null)}),(C,f)=>(n(),r("div",wd,[e("div",bd,[f[4]||(f[4]=e("h4",{class:"text-lg font-semibold text-gray-900"},"SEO Reports",-1)),s.canCreateSeoReports?(n(),ae(pe,{key:0,onClick:f[0]||(f[0]=L=>S()),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:F(()=>f[3]||(f[3]=[Y(" Add New Report ",-1)])),_:1,__:[3]})):x("",!0)]),e("div",_d,[e("div",xd,[e("div",kd,[v(G,{for:"seo-report-month-filter",value:"Select Report Month"}),v(ge,{id:"seo-report-month-filter",modelValue:l.value,"onUpdate:modelValue":f[1]||(f[1]=L=>l.value=L),options:o.value,"value-key":"value","label-key":"label",placeholder:"Select a month",disabled:d.value||o.value.length===0,class:"mt-1"},null,8,["modelValue","options","disabled"])])]),c.value?(n(),r("div",Dd,h(c.value),1)):x("",!0),d.value?(n(),r("div",Cd,"Loading available months...")):x("",!0),!d.value&&o.value.length===0?(n(),r("div",Td,"No SEO reports available for this project.")):x("",!0)]),e("div",Ed,[e("div",Md,[e("h5",Sd,[l.value?(n(),r("span",jd,"Report for "+h(new Date(l.value+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})),1)):(n(),r("span",$d,"Select a month to view report"))]),s.canCreateSeoReports&&u.value&&l.value?(n(),ae(pe,{key:0,onClick:f[2]||(f[2]=L=>S({report_date:l.value,data:JSON.stringify(u.value,null,2)})),class:"bg-blue-500 hover:bg-blue-600 transition-colors text-sm py-1 px-3"},{default:F(()=>f[5]||(f[5]=[Y(" Edit Report ",-1)])),_:1,__:[5]})):x("",!0)]),m.value?(n(),r("div",Vd," Loading SEO report data... ")):p.value?(n(),r("div",Ad,[e("p",Od,h(p.value),1)])):w.value?(n(),r("div",Ld,[e("p",Id,"Data Structure Error: "+h(w.value),1),f[6]||(f[6]=e("p",{class:"text-gray-500 text-sm mt-2"},"Please ensure the JSON data conforms to the expected format.",-1))])):u.value?(n(),r("div",Pd,[e("div",Nd,[e("div",Rd,[f[7]||(f[7]=e("p",{class:"text-sm text-gray-500"},"Client Name",-1)),e("p",Ud,h(g.value),1)]),e("div",Hd,[f[8]||(f[8]=e("p",{class:"text-sm text-gray-500"},"Reporting Period",-1)),e("p",Bd,h(M.value),1)]),e("div",Fd,[f[9]||(f[9]=e("p",{class:"text-sm text-gray-500"},"Authority Score",-1)),e("p",Wd,h(O.value),1)]),e("div",Yd,[f[10]||(f[10]=e("p",{class:"text-sm text-gray-500"},"Total Clicks",-1)),e("p",zd,h(R.value),1)]),e("div",qd,[f[11]||(f[11]=e("p",{class:"text-sm text-gray-500"},"Total Impressions",-1)),e("p",Zd,h(I.value),1)]),e("div",Gd,[f[12]||(f[12]=e("p",{class:"text-sm text-gray-500"},"Average Position",-1)),e("p",Kd,h(V.value),1)]),e("div",Jd,[f[13]||(f[13]=e("p",{class:"text-sm text-gray-500"},"Total Backlinks",-1)),e("p",Xd,h(B.value),1)])]),e("div",Qd,[f[15]||(f[15]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Clicks & Impressions Trend",-1)),e("div",eu,[e("table",tu,[f[14]||(f[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions")])],-1)),e("tbody",su,[(n(!0),r(J,null,te(U.value.labels,(L,T)=>(n(),r("tr",{key:T},[e("td",au,h(L),1),e("td",lu,h(U.value.clicks[T]),1),e("td",iu,h(U.value.impressions[T]),1)]))),128))])])]),U.value.labels.length?x("",!0):(n(),r("p",nu,"No clicks and impressions data available."))]),e("div",ou,[f[17]||(f[17]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Top Queries",-1)),e("div",ru,[e("table",du,[f[16]||(f[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Query"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"CTR"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Position")])],-1)),e("tbody",uu,[(n(!0),r(J,null,te(se.value,L=>(n(),r("tr",{key:L.query},[e("td",cu,h(L.query),1),e("td",mu,h(L.clicks),1),e("td",vu,h(L.impressions),1),e("td",pu,h(L.ctr)+"%",1),e("td",hu,h(L.position),1)]))),128))])])]),se.value.length?x("",!0):(n(),r("p",gu,"No top queries data available."))]),e("div",fu,[f[19]||(f[19]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Keyword Rankings",-1)),e("div",yu,[e("table",wu,[f[18]||(f[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Keyword"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ranking")])],-1)),e("tbody",bu,[(n(!0),r(J,null,te(ie.value,L=>(n(),r("tr",{key:L.keyword},[e("td",_u,h(L.keyword),1),e("td",xu,h(L.ranking),1)]))),128))])])]),ie.value.length?x("",!0):(n(),r("p",ku,"No keyword rankings data available."))]),e("div",Du,[f[21]||(f[21]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Traffic Sources",-1)),e("div",Cu,[e("table",Tu,[f[20]||(f[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Source"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sessions")])],-1)),e("tbody",Eu,[(n(!0),r(J,null,te(j.value.labels,(L,T)=>(n(),r("tr",{key:L},[e("td",Mu,h(L),1),e("td",Su,h(j.value.sessions[T]),1)]))),128))])])]),j.value.labels.length?x("",!0):(n(),r("p",ju,"No traffic sources data available."))]),e("div",$u,[f[23]||(f[23]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Device Usage",-1)),e("div",Vu,[e("table",Au,[f[22]||(f[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Device"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",Ou,[(n(!0),r(J,null,te(D.value.labels,(L,T)=>(n(),r("tr",{key:L},[e("td",Lu,h(L),1),e("td",Iu,h(D.value.clicks[T]),1)]))),128))])])]),D.value.labels.length?x("",!0):(n(),r("p",Pu,"No device usage data available."))]),e("div",Nu,[f[25]||(f[25]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Country Performance (Top 10)",-1)),e("div",Ru,[e("table",Uu,[f[24]||(f[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Country"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",Hu,[(n(!0),r(J,null,te(_.value.labels,L=>(n(),r("tr",{key:L},[e("td",Bu,h(L),1),e("td",Fu,h(_.value.clicks[_.value.labels.indexOf(L)]),1)]))),128))])])]),_.value.labels.length?x("",!0):(n(),r("p",Wu,"No country performance data available."))]),e("div",Yu,[e("div",null,[f[26]||(f[26]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Mobile)",-1)),$.value.mobile&&$.value.mobile.labels&&$.value.mobile.labels.length?(n(),r("div",zu,[(n(!0),r(J,null,te($.value.mobile.labels,(L,T)=>(n(),r("div",{key:L,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,h(L)+":",1),e("span",qu,h($.value.mobile.scores[T]),1)]))),128))])):(n(),r("p",Zu,"No mobile core vitals data available."))]),e("div",null,[f[27]||(f[27]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Desktop)",-1)),$.value.desktop&&$.value.desktop.labels&&$.value.desktop.labels.length?(n(),r("div",Gu,[(n(!0),r(J,null,te($.value.desktop.labels,(L,T)=>(n(),r("div",{key:L,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,h(L)+":",1),e("span",Ku,h($.value.desktop.scores[T]),1)]))),128))])):(n(),r("p",Ju,"No desktop core vitals data available."))])])])):(n(),r("div",Xu," No report data to display. Please select a month from the dropdown. "))])]))}},ec=Ve(Qu,[["__scopeId","data-v-37cb2f02"]]),tc={class:"space-y-4"},sc={key:0,class:"text-xs text-gray-500 mt-1 text-red-500"},ac=["onBlur"],lc={__name:"CreateSeoReportModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0},initialData:{type:Object,default:null}},emits:["close","saved"],setup(s,{emit:t}){const a=s,i=t,o=Te({report_date:"",data:""}),l=b(null);ce(()=>[a.show,a.initialData],([g,M])=>{g&&(M?Object.assign(o,{report_date:M.report_date||"",data:M.data||""}):Object.assign(o,{report_date:"",data:""}))},{immediate:!0});const u=g=>{let M=g.data;try{M=JSON.stringify(JSON.parse(g.data))}catch{console.warn("Provided data is not valid JSON, sending as plain string. Backend should validate.")}return{report_date:g.report_date,data:M}},d=H(()=>a.initialData?"Edit SEO Report":"Create New SEO Report"),m=H(()=>`/api/projects/${a.projectId}/seo-reports`),c=H(()=>"post"),p=H(()=>a.initialData?"Update Report":"Create Report"),w=H(()=>a.initialData?"SEO Report updated successfully!":"SEO Report created successfully!"),y=g=>{i("saved",g),i("close")},E=()=>{i("close")},k=()=>{try{const g=JSON.parse(o.data);o.data=JSON.stringify(g,null,2)}catch(g){console.error("Invalid JSON for pretty print:",g)}},S=g=>{if(o.data)try{JSON.parse(o.data),g.data&&g.data[0]==="The data field must be a valid JSON string."&&(g.data=[])}catch{(!g.data||g.data.length===0)&&(g.data=["The data field must be a valid JSON string."])}};return(g,M)=>(n(),ae($e,{show:s.show,title:d.value,"api-endpoint":m.value,"http-method":c.value,"form-data":o,"submit-button-text":p.value,"success-message":w.value,"format-data-for-api":u,onClose:E,onSubmitted:y},{default:F(({errors:O})=>[e("div",tc,[e("div",null,[v(G,{for:"report_date",value:"Report Month (YYYY-MM)"}),v(me,{id:"report_date",modelValue:o.report_date,"onUpdate:modelValue":M[0]||(M[0]=R=>o.report_date=R),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 2025-07",required:"",autofocus:"",pattern:"\\d{4}-\\d{2}",title:"Please enter a date in YYYY-MM format (e.g., 2025-07)",disabled:!!s.initialData},null,8,["modelValue","disabled"]),v(oe,{message:O.report_date?O.report_date[0]:"",class:"mt-2"},null,8,["message"]),M[2]||(M[2]=e("p",{class:"text-xs text-gray-500 mt-1"},"Enter the report month in YYYY-MM format (e.g., 2025-07).",-1)),s.initialData?(n(),r("p",sc,"Note: Report month cannot be changed when editing.")):x("",!0)]),e("div",null,[v(G,{for:"report_data",value:"Report Data (JSON)"}),ve(e("textarea",{id:"report_data",ref_key:"jsonInputRef",ref:l,"onUpdate:modelValue":M[1]||(M[1]=R=>o.data=R),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 font-mono",rows:"10",placeholder:'Enter JSON data for the report, e.g., {"keywords_ranked": 150, "traffic": 1200, "rankings": {"keyword1": 5, "keyword2": 12}}',required:"",onBlur:R=>S(O)},null,40,ac),[[xe,o.data]]),v(oe,{message:O.data?O.data[0]:"",class:"mt-2"},null,8,["message"]),e("div",{class:"flex justify-end mt-2"},[e("button",{type:"button",onClick:k,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," Format JSON ")])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},ic={key:0,class:"bg-amber-50 border-l-4 border-amber-500 p-4 mb-6 rounded-md shadow-md"},nc={class:"flex items-center justify-between"},oc={class:"flex items-center"},rc={class:"ml-3"},dc={class:"text-sm text-amber-800 font-medium"},uc={key:0},cc={key:1},mc={key:2},vc={__name:"ProjectTaskNotificationPrompt",props:{overdueTasks:{type:Number,required:!0},dueTodayTasks:{type:Number,required:!0}},emits:["view-tasks"],setup(s,{emit:t}){const a=s,i=t,o=H(()=>a.overdueTasks+a.dueTodayTasks),l=H(()=>o.value>0),u=()=>{i("view-tasks")};return(d,m)=>l.value?(n(),r("div",ic,[e("div",nc,[e("div",oc,[m[0]||(m[0]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-amber-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",rc,[e("p",dc,[s.overdueTasks>0&&s.dueTodayTasks>0?(n(),r("span",uc," This project has "+h(s.overdueTasks)+" overdue "+h(s.overdueTasks===1?"task":"tasks")+" and "+h(s.dueTodayTasks)+" "+h(s.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):s.overdueTasks>0?(n(),r("span",cc," This project has "+h(s.overdueTasks)+" overdue "+h(s.overdueTasks===1?"task":"tasks")+" that require attention. ",1)):s.dueTodayTasks>0?(n(),r("span",mc," This project has "+h(s.dueTodayTasks)+" "+h(s.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):x("",!0)])])]),e("div",null,[v(pe,{onClick:u,class:"px-4 py-2 text-sm bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"},{default:F(()=>m[1]||(m[1]=[Y(" View ",-1)])),_:1,__:[1]})])])])):x("",!0)}},pc={key:0,class:"bg-white rounded-xl shadow-lg border border-gray-200 h-full flex flex-col relative"},hc={key:1,class:"h-full flex flex-col"},gc={class:"p-1 rounded-full text-gray-500 hover:bg-gray-200 transition-colors"},fc={class:"px-6"},yc={class:"flex border-b border-gray-200 mt-4"},wc={class:"flex-1 overflow-y-auto px-6 pb-6 mt-4"},bc={key:0,class:"flex justify-center py-8"},_c={key:1,class:"bg-gray-50 p-6 rounded-lg text-center"},xc={class:"text-gray-600"},kc={key:2,class:"space-y-4"},Dc=["onClick"],Cc={class:"flex items-center space-x-3"},Tc={class:"p-1 rounded-full text-gray-500 hover:bg-gray-200 transition-colors"},Ec={class:"text-sm font-medium text-gray-900"},Mc={class:"mt-1 flex items-center space-x-2 text-xs text-gray-500"},Sc={key:0,class:"text-gray-700"},jc={key:1,class:"text-gray-700"},$c={class:"flex items-center space-x-2"},Vc={key:0,class:"text-xs font-medium text-gray-600"},Ac={key:0,class:"mt-4 pl-8"},Oc={__name:"ProjectDeliverablesOverviewCard",props:{projectId:{type:[Number,String],required:!0},canViewProjectDeliverables:{type:Boolean,default:!0},isCollapsed:{type:Boolean,default:!1}},emits:["update:isCollapsed"],setup(s,{emit:t}){const a=s,i=t,o=b(a.isCollapsed);ce(()=>a.isCollapsed,g=>{o.value=g});const l=b([]),u=b(!0),d=b("in-progress"),m=b({}),c=H(()=>d.value==="in-progress"?l.value.filter(g=>g.status!=="completed"&&g.status!=="cancelled"):l.value.filter(g=>g.status==="completed"||g.status==="cancelled")),p=async()=>{if(a.canViewProjectDeliverables){u.value=!0;try{const g=await ut.get(`/api/projects/${a.projectId}/project-deliverables`);l.value=g.data}catch(g){console.error("Error fetching deliverables:",g),Je("Failed to load project deliverables.")}finally{u.value=!1}}};ke(()=>{p()});const w=g=>{m.value[g]=!m.value[g]},y=g=>g?new Date(g).toLocaleDateString():"N/A",E=g=>!g||g.length===0?0:g.filter(M=>M.completed).length,k=async(g,M)=>{const O=l.value.find(R=>R.id===g.id);O&&(O.details.checklist[M.index].completed=M.completed);try{const R={...g,details:{...g.details,checklist:O.details.checklist}};await ut.put(`/api/project-deliverables/${g.id}`,R),gt("Checklist item updated!")}catch(R){console.error("Error updating checklist item:",R),Je("Failed to update checklist item"),O&&(O.details.checklist[M.index].completed=!M.completed)}},S=()=>{o.value=!o.value,i("update:isCollapsed",o.value)};return(g,M)=>s.canViewProjectDeliverables?(n(),r("div",pc,[o.value?(n(),r("div",{key:0,onClick:S,class:"flex items-center justify-center cursor-pointer p-2 h-full"},M[2]||(M[2]=[e("span",{class:"text-gray-600 font-bold text-lg",style:{"writing-mode":"vertical-rl","text-orientation":"mixed"}}," Project Deliverables ",-1)]))):(n(),r("div",hc,[e("div",{class:"p-6 flex justify-between items-center cursor-pointer",onClick:S},[M[3]||(M[3]=e("h3",{class:"text-xl font-bold text-gray-900"},"Project Deliverables",-1)),e("button",gc,[v(q(fs),{class:"h-5 w-5"})])]),e("div",fc,[e("div",yc,[e("button",{onClick:M[0]||(M[0]=O=>d.value="in-progress"),class:X({"py-2 px-4 text-sm font-medium":!0,"text-indigo-600 border-b-2 border-indigo-600":d.value==="in-progress","text-gray-500 hover:text-gray-700":d.value!=="in-progress"})}," In Progress ",2),e("button",{onClick:M[1]||(M[1]=O=>d.value="completed"),class:X({"py-2 px-4 text-sm font-medium":!0,"text-indigo-600 border-b-2 border-indigo-600":d.value==="completed","text-gray-500 hover:text-gray-700":d.value!=="completed"})}," Completed ",2)])]),e("div",wc,[u.value?(n(),r("div",bc,M[4]||(M[4]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600"},null,-1)]))):c.value.length===0?(n(),r("div",_c,[e("p",xc,"No "+h(d.value)+" deliverables found.",1)])):(n(),r("div",kc,[(n(!0),r(J,null,te(c.value,O=>{var R,I,V;return n(),r("div",{key:O.id,class:"bg-gray-50 border border-gray-200 rounded-xl p-4 shadow-sm"},[e("div",{class:"flex items-center justify-between cursor-pointer",onClick:B=>w(O.id)},[e("div",Cc,[e("button",Tc,[m.value[O.id]?(n(),ae(q(ys),{key:1,class:"h-5 w-5"})):(n(),ae(q(gs),{key:0,class:"h-5 w-5"}))]),e("div",null,[e("h4",Ec,h(O.name),1),e("div",Mc,[O.milestone?(n(),r("span",Sc,[M[5]||(M[5]=e("span",{class:"font-semibold"},"Milestone:",-1)),Y(" "+h(O.milestone.name),1)])):x("",!0),O.due_date?(n(),r("span",jc,[M[6]||(M[6]=e("span",{class:"font-semibold"},"Due:",-1)),Y(" "+h(y(O.due_date)),1)])):x("",!0)])])]),e("div",$c,[((I=(R=O.details)==null?void 0:R.checklist)==null?void 0:I.length)>0?(n(),r("span",Vc,h(E(O.details.checklist))+" / "+h(O.details.checklist.length),1)):x("",!0),e("span",{class:X({"font-medium py-1 px-3 rounded-full text-white text-xs":!0,"bg-yellow-500":O.status==="pending","bg-blue-500":O.status==="in_progress","bg-green-500":O.status==="completed","bg-red-500":O.status==="cancelled"})},h(O.status.replace("_"," ").toUpperCase()),3)])],8,Dc),m.value[O.id]?(n(),r("div",Ac,[(V=O.details)!=null&&V.checklist&&O.details.checklist.length>0?(n(),ae(Ft,{key:0,checkListStyle:"list",items:O.details.checklist,"api-endpoint":`/api/project-deliverables/${O.id}`,title:"Deliverable Checklist:","payload-transformer":B=>({details:{...O.details,checklist:B}}),onItemToggled:B=>k(O,B)},null,8,["items","api-endpoint","payload-transformer","onItemToggled"])):x("",!0)])):x("",!0)])}),128))]))])]))])):x("",!0)}},Lc={class:"py-8 max-w-full mx-auto px-4 sm:px-6 lg:px-8"},Ic={key:0,class:"flex items-center justify-center min-h-[50vh]"},Pc={key:1,class:"text-center text-red-600 text-lg font-medium"},Nc={key:2,class:"space-y-8"},Rc={class:"flex flex-col lg:flex-row gap-6"},Uc={class:"flex-1 space-y-6"},Hc={class:"flex justify-end items-center"},Bc={class:"flex h-full w-full"},Fc={key:1,class:"transition-all duration-300 w-full"},Wc={key:0},Yc={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},zc={class:"flex justify-between items-center mb-4"},qc={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Zc={class:"flex justify-between items-center mb-4"},Gc={key:2,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Kc={class:"flex justify-between items-center mb-4"},Jc={key:0,class:"text-gray-400 text-sm"},Xc={key:1,class:"overflow-x-auto"},Qc={class:"min-w-full divide-y divide-gray-200"},em={class:"bg-white divide-y divide-gray-200"},tm={class:"px-4 py-3 text-sm text-gray-900"},sm={class:"px-4 py-3 text-sm text-gray-700"},am={class:"px-4 py-3 text-sm text-gray-700"},lm={class:"px-4 py-3 text-sm text-gray-700"},im={class:"px-4 py-3 text-sm text-gray-700"},nm={class:"px-4 py-3 text-right"},om={key:3,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},rm={class:"flex justify-between items-center mb-4"},dm={class:"flex items-center gap-4"},um={key:0},cm={key:0,class:"space-y-4"},mm={class:"flex justify-between"},vm={class:"flex-grow"},pm={key:0,class:"text-xs text-red-400 block mt-1"},hm={class:"flex items-center mt-1"},gm={class:"text-xs text-gray-500"},fm={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},ym={key:0},wm={key:1,class:"text-gray-400 text-sm"},bm={__name:"Show",setup(s){const t=Ye(),a=Qt().props.id,i=b({clients:[],users:[],notes:[],transactions:[],documents:[],meetings:[],tasks:[],emails:[],deliverables:[]}),o=b(!1),l=b(!1),u=b(!0),d=b(""),m=b(!1),c=b(!1),p=b(!1),w=b(!1),y=b(!1),E=b(!1),k=b(!1),S=b(!1),g=b(!1),M=b(null),O=[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"on_hold",label:"On Hold"},{value:"archived",label:"Archived"}],R=b(null),I=b(null),V=es(i),{canDo:B,canView:U}=ht(a),j=H(()=>{var Q,N;return((N=(Q=t.value)==null?void 0:Q.role_data)==null?void 0:N.slug)==="super-admin"}),D=H(()=>B("manage_projects").value||j.value),_=H(()=>B("edit_projects").value||j.value),$=H(()=>U("emails").value),se=H(()=>B("compose_emails").value),ie=H(()=>B("approve_emails").value),C=H(()=>U("project_notes").value),f=H(()=>B("add_project_notes").value),L=H(()=>U("deliverables").value);H(()=>B("create_deliverables").value);const T=H(()=>U("seo_reports").value),Z=H(()=>B("create_seo_reports").value);H(()=>U("client_contacts").value),H(()=>U("users").value);const re=H(()=>U("project_financial",V).value),Ce=H(()=>U("project_transactions").value);H(()=>U("client_financial").value);const ee=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],A=b([]),P=b(null),W=b(null),he=b("all"),Oe=async()=>{try{A.value=await zt(a)}catch(Q){console.error("Error fetching due and overdue tasks:",Q)}},kt=()=>{I.value="tasks",he.value="due-overdue",setTimeout(()=>{W.value&&W.value.scrollIntoView&&W.value.scrollIntoView({behavior:"smooth"})},100)},Dt=async()=>{await Oe()},Qe=H(()=>i.value.notes?[...i.value.notes].filter(Q=>Q.type!=="standup").sort((Q,N)=>new Date(N.created_at)-new Date(Q.created_at)).slice(0,3):[]),et=b([]),tt=async()=>{try{const Q=await window.axios.get(`/api/projects/${a}/emails-simplified`,{params:{limit:5}});et.value=Q.data}catch(Q){console.error("Error fetching latest emails:",Q)}},Ee=async()=>{u.value=!0,d.value="";try{const Q=await window.axios.get(`/api/projects/${a}`);i.value=Q.data,console.log("Full project data received (Show.vue main fetch):",i.value),o.value=i.value.deliverables&&i.value.deliverables.length>0,l.value=!o.value,await Oe(),$.value&&await tt()}catch(Q){d.value="Failed to load project data.",console.error("Error fetching project data:",Q),Q.response&&(Q.response.status===401||Q.response.status===403)&&(d.value="You are not authorized to view this project or your session expired. Please log in.")}finally{u.value=!1}},Ct=Q=>{i.value=Q,m.value=!1,Ee()},Tt=Q=>{i.value.tasks=Q},Et=Q=>{i.value.emails=Q,$.value&&tt()},st=Q=>{i.value.notes=Q},Mt=()=>{R.value&&R.value.fetchMeetings()},at=()=>{Ee()},St=Q=>{I.value=Q,ns()},jt=()=>{k.value=!0,I.value="emails"},$t=async()=>{k.value=!1,await Ee()},Vt=()=>{k.value=!1},lt=()=>{l.value=!l.value},it=(Q,N)=>{is(Q,N||a,i.value.users)};ce(ts,(Q,N)=>{N.taskId&&!Q.taskId&&Ee()},{deep:!0});const At=()=>{S.value=!0},Ot=()=>{S.value=!1,Ee()},Lt=(Q=null)=>{M.value=Q,g.value=!0},It=()=>{g.value=!1};return ke(async()=>{console.log("Show.vue mounted, fetching initial data...");try{await ss(a),console.log("Project permissions fetched (includes global)")}catch(Q){console.error(`Error fetching permissions for project ${a}:`,Q)}await os(),await Ee()}),(Q,N)=>(n(),r(J,null,[v(q(as),{title:i.value.name||"Project Details"},null,8,["title"]),v(Yt,null,{default:F(()=>{var ze;return[e("div",Lc,[u.value?(n(),r("div",Ic,N[24]||(N[24]=[e("div",{class:"flex flex-col items-center space-y-4"},[e("svg",{class:"animate-spin h-16 w-16 text-indigo-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("p",{class:"text-lg text-gray-600 font-medium"},"Loading project details...")],-1)]))):d.value?(n(),r("div",Pc,h(d.value),1)):(n(),r("div",Nc,[e("div",Rc,[e("div",Uc,[v(En,{project:i.value,"project-id":q(a),"can-manage-projects":D.value,"is-super-admin":j.value,"can-edit-projects":_.value,onOpenEditModal:N[0]||(N[0]=z=>m.value=!0),onOpenStandupModal:N[1]||(N[1]=z=>p.value=!0),onOpenMeetingModal:N[2]||(N[2]=z=>c.value=!0),onOpenMagicLinkModal:N[3]||(N[3]=z=>y.value=!0),onResourceSaved:Ee,onOpenComposeModal:jt},null,8,["project","project-id","can-manage-projects","is-super-admin","can-edit-projects"]),v(Vs,{"project-id":q(a),ref_key:"meetingsListComponent",ref:R},null,8,["project-id"]),v(Pn,{tasks:i.value.tasks||[],emails:i.value.emails||[]},null,8,["tasks","emails"]),e("div",Hc,[v(ge,{id:"display-currency-switcher",modelValue:q(Ue),"onUpdate:modelValue":N[4]||(N[4]=z=>ls(Ue)?Ue.value=z:null),options:ee,"value-key":"value","label-key":"label",class:"w-20",containerClasses:"max-w-[150px]"},null,8,["modelValue"])]),re.value&&Ce.value?(n(),ae(id,{key:0,"project-id":q(a),"can-view-project-services-and-payments":re.value,"can-view-project-transactions":Ce.value},null,8,["project-id","can-view-project-services-and-payments","can-view-project-transactions"])):x("",!0)]),L.value?(n(),r("div",{key:0,class:X(["relative transition-all duration-300",{"w-full lg:w-1/3":!l.value,"w-16":l.value}])},[e("div",Bc,[l.value?(n(),r("div",{key:0,class:"w-16 h-full flex items-center justify-center bg-white rounded-xl shadow-lg border border-gray-200 cursor-pointer transition-all duration-300 transform hover:scale-105",onClick:lt},N[25]||(N[25]=[e("span",{class:"font-bold text-gray-500 text-sm",style:{"writing-mode":"vertical-rl","text-orientation":"sideways"}},"Project Deliverables",-1)]))):(n(),r("div",Fc,[v(Oc,{"project-id":q(a),"can-view-project-deliverables":L.value,"is-collapsed":l.value,"onUpdate:isCollapsed":lt},null,8,["project-id","can-view-project-deliverables","is-collapsed"])]))])],2)):x("",!0)]),v(Un,{ref_key:"navigationRef",ref:W,selectedTab:I.value,"onUpdate:selectedTab":N[5]||(N[5]=z=>I.value=z),"can-view-emails":$.value,"can-view-notes":C.value,"can-view-deliverables":L.value,"can-view-seo-reports":T.value},null,8,["selectedTab","can-view-emails","can-view-notes","can-view-deliverables","can-view-seo-reports"]),I.value===null?(n(),r("div",Wc,[v(vc,{"overdue-tasks":A.value.filter(z=>new Date(z.due_date)<new Date).length,"due-today-tasks":A.value.filter(z=>new Date(z.due_date).toDateString()===new Date().toDateString()).length,onViewTasks:kt},null,8,["overdue-tasks","due-today-tasks"]),A.value.length>0?(n(),r("div",Yc,[e("div",zc,[N[26]||(N[26]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:N[6]||(N[6]=z=>I.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),v(yt,{tasks:A.value,"project-id":q(a),"show-project-column":!1,onTaskUpdated:Dt,onOpenTaskDetail:it},null,8,["tasks","project-id"])])):(n(),r("div",qc,[e("div",Zc,[N[27]||(N[27]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:N[7]||(N[7]=z=>I.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),N[28]||(N[28]=e("p",{class:"text-gray-400 text-sm"},"No due or overdue tasks.",-1))])),$.value?(n(),r("div",Gc,[e("div",Kc,[N[29]||(N[29]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Emails",-1)),e("button",{onClick:N[8]||(N[8]=z=>I.value="emails"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Emails → ")]),(ze=i.value.emails)!=null&&ze.length?(n(),r("div",Xc,[e("table",Qc,[N[31]||(N[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",em,[(n(!0),r(J,null,te(et.value,z=>{var Le;return n(),r("tr",{key:z.id,class:"hover:bg-gray-50 transition-colors"},[e("td",tm,h(z.subject),1),e("td",sm,h(((Le=z.sender)==null?void 0:Le.name)||"N/A"),1),e("td",am,h(new Date(z.created_at).toLocaleDateString()),1),e("td",lm,[e("span",{class:X({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":z.type==="sent","bg-purple-100 text-purple-800":z.type==="received"})},h(z.type?z.type.toUpperCase():"N/A"),3)]),e("td",im,[e("span",{class:X({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":z.status==="sent","bg-yellow-100 text-yellow-800":z.status==="pending_approval","bg-blue-200 text-blue-900":z.status==="pending_approval_received","bg-red-100 text-red-800":z.status==="rejected","bg-gray-100 text-gray-800":z.status==="draft"})},h(z.status.replace("_"," ").toUpperCase()),3)]),e("td",nm,[v(fe,{class:"text-indigo-600 hover:text-indigo-800",onClick:Pt=>Q.viewEmail(z)},{default:F(()=>N[30]||(N[30]=[Y(" View ",-1)])),_:2,__:[30]},1032,["onClick"])])])}),128))])])])):(n(),r("div",Jc,"No email communication found."))])):x("",!0),C.value?(n(),r("div",om,[e("div",rm,[N[33]||(N[33]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Notes",-1)),e("div",dm,[e("button",{onClick:N[9]||(N[9]=z=>I.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Notes → "),f.value?(n(),r("div",um,[v(pe,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:N[10]||(N[10]=z=>w.value=!0)},{default:F(()=>N[32]||(N[32]=[Y(" Add Note ",-1)])),_:1,__:[32]})])):x("",!0)])]),Qe.value.length?(n(),r("div",cm,[(n(!0),r(J,null,te(Qe.value,z=>{var Le;return n(),r("div",{key:z.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",mm,[e("div",vm,[e("p",{class:X(["text-sm",{"text-gray-700":z.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":z.content==="[Encrypted content could not be decrypted]"}])},[Y(h(z.content)+" ",1),z.content==="[Encrypted content could not be decrypted]"?(n(),r("span",pm," (There was an issue decrypting this note. Please contact an administrator.) ")):x("",!0)],2),e("div",hm,[e("p",gm,"Added by "+h(((Le=z.user)==null?void 0:Le.name)||"Unknown")+" on "+h(new Date(z.created_at).toLocaleDateString()),1),z.reply_count>0?(n(),r("span",fm,h(z.reply_count)+" "+h(z.reply_count===1?"reply":"replies"),1)):x("",!0)])]),C.value&&z.chat_message_id&&i.value.google_chat_id?(n(),r("div",ym,[e("button",{onClick:N[11]||(N[11]=Pt=>I.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View ")])):x("",!0)])])}),128))])):(n(),r("p",wm,"No notes available."))])):x("",!0)])):x("",!0),I.value==="tasks"?(n(),ae(jo,{key:1,ref_key:"tasksTabRef",ref:P,"project-id":q(a),"project-users":i.value.users||[],"can-manage-projects":D.value,"tasks-filter":he.value,onTasksUpdated:Tt,onOpenTaskDetailSidebar:it,onOpenCreateTaskModal:At,onFilterChanged:N[12]||(N[12]=z=>he.value=z)},null,8,["project-id","project-users","can-manage-projects","tasks-filter"])):x("",!0),I.value==="emails"?(n(),ae(dr,{key:2,"project-id":q(a),"can-view-emails":$.value,"can-compose-emails":se.value,"can-approve-emails":ie.value,"user-project-role":q(V),"open-compose":k.value,onEmailsUpdated:Et,onResetOpenCompose:N[13]||(N[13]=z=>k.value=!1)},null,8,["project-id","can-view-emails","can-compose-emails","can-approve-emails","user-project-role","open-compose"])):x("",!0),I.value==="standups"?(n(),ae(Ul,{key:3,projectId:q(a),users:i.value.users||[],onStandupAdded:at},null,8,["projectId","users"])):x("",!0),I.value==="notes"?(n(),ae(Wr,{key:4,"project-id":q(a),"google-chat-id":i.value.google_chat_id,"can-view-notes":C.value,"can-add-notes":f.value,onNotesUpdated:st,onChangeTab:St},null,8,["project-id","google-chat-id","can-view-notes","can-add-notes"])):x("",!0),I.value==="seo-reports"?(n(),ae(ec,{key:5,"project-id":q(a),"can-create-seo-reports":Z.value,onOpenCreateSeoReportModal:Lt},null,8,["project-id","can-create-seo-reports"])):x("",!0)]))]),v(Se,{show:m.value,onClose:N[15]||(N[15]=z=>m.value=!1)},{default:F(()=>[v(rs,{show:m.value,project:i.value,statusOptions:O,clientRoleOptions:[],userRoleOptions:[],paymentTypeOptions:[],onClose:N[14]||(N[14]=z=>m.value=!1),onSubmit:Ct},null,8,["show","project"])]),_:1},8,["show"]),v(ri,{show:c.value,"project-name":i.value.name,onClose:N[16]||(N[16]=z=>c.value=!1),onSaved:Mt,projectId:q(a),projectUsers:i.value.users||[]},null,8,["show","project-name","projectId","projectUsers"]),v(ft,{show:p.value,onClose:N[17]||(N[17]=z=>p.value=!1),onStandupAdded:at,projectId:q(a)},null,8,["show","projectId"]),v(wt,{show:w.value,"project-id":q(a),onClose:N[18]||(N[18]=z=>w.value=!1),onNoteAdded:st},null,8,["show","project-id"]),v(hi,{show:y.value,"project-id":q(a),"project-clients":i.value.clients||[],onClose:N[19]||(N[19]=z=>y.value=!1)},null,8,["show","project-id","project-clients"]),v(yd,{show:E.value,"project-id":q(a),"project-name":i.value.name,onClose:N[20]||(N[20]=z=>E.value=!1)},null,8,["show","project-id","project-name"]),v(xt,{show:k.value,"project-id":q(a),"user-project-role":q(V),onClose:Vt,onSubmitted:$t,onError:N[21]||(N[21]=z=>console.error("Error composing email:",z))},null,8,["show","project-id","user-project-role"]),v(Wt,{show:S.value,"project-id":q(a),onClose:N[22]||(N[22]=z=>S.value=!1),onSaved:Ot},null,8,["show","project-id"]),v(lc,{"project-id":q(a),show:g.value,"initial-data":M.value,onClose:N[23]||(N[23]=z=>g.value=!1),onSaved:It},null,8,["project-id","show","initial-data"])]}),_:1})],64))}},Um=Ve(bm,[["__scopeId","data-v-ad64c440"]]);export{Um as default};
