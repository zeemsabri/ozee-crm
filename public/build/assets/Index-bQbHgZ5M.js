import{a,o as l,b as t,r as c,c as B,v as W,f as q,d as m,u as p,h as J,w as M,i as u,j as A,m as f,t as i,x,y as L,F as g,l as b,z as F,A as S,g as V,p as j}from"./app-C2DlCbPA.js";import{_ as K}from"./AuthenticatedLayout-DtPFdL7J.js";import{P as Q}from"./PrimaryButton-CtPDHjVD.js";import{_ as X}from"./SecondaryButton-HKy0ku5i.js";import{_ as Y}from"./MultiSelectDropdown-BuORU0Ot.js";import{r as ee,a as te}from"./PlusCircleIcon-BJu0k_Em.js";import{r as se}from"./ListBulletIcon-BJ91q2Im.js";import{r as le}from"./UsersIcon-ChacB2mj.js";import"./Modal-GlQUaNvM.js";import"./InputLabel-BV05Qh7X.js";import"./InputError-DiP-pdvV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-DufyISud.js";import"./SelectDropdown-DtxiXNW7.js";/* empty css                                                                       */import"./Checkbox-DtaKYHdn.js";import"./ApplicationLogo-Bgsz_lH1.js";import"./DangerButton-CuooJuNp.js";import"./moment-BLMuvzoS.js";import"./ChevronDownIcon-BCMAe56x.js";function ae(k,d){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M15.75 2.25H21a.75.75 0 0 1 .75.75v5.25a.75.75 0 0 1-1.5 0V4.81L8.03 17.03a.75.75 0 0 1-1.06-1.06L19.19 3.75h-3.44a.75.75 0 0 1 0-1.5Zm-10.5 4.5a1.5 1.5 0 0 0-1.5 1.5v10.5a1.5 1.5 0 0 0 1.5 1.5h10.5a1.5 1.5 0 0 0 1.5-1.5V10.5a.75.75 0 0 1 1.5 0v8.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V8.25a3 3 0 0 1 3-3h8.25a.75.75 0 0 1 0 1.5H5.25Z","clip-rule":"evenodd"})])}function oe(k,d){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M5.85 3.5a.75.75 0 0 0-1.117-1 9.719 9.719 0 0 0-2.348 4.876.75.75 0 0 0 1.479.248A8.219 8.219 0 0 1 5.85 3.5ZM19.267 2.5a.75.75 0 1 0-1.118 1 8.22 8.22 0 0 1 1.987 4.124.75.75 0 0 0 1.48-.248A9.72 9.72 0 0 0 19.266 2.5Z"}),t("path",{"fill-rule":"evenodd",d:"M12 2.25A6.75 6.75 0 0 0 5.25 9v.75a8.217 8.217 0 0 1-2.119 5.52.75.75 0 0 0 .298 1.206c1.544.57 3.16.99 4.831 1.243a3.75 3.75 0 1 0 7.48 0 24.583 24.583 0 0 0 4.83-1.244.75.75 0 0 0 .298-1.205 8.217 8.217 0 0 1-2.118-5.52V9A6.75 6.75 0 0 0 12 2.25ZM9.75 18c0-.034 0-.067.002-.1a25.05 25.05 0 0 0 4.496 0l.002.1a2.25 2.25 0 1 1-4.5 0Z","clip-rule":"evenodd"})])}function re(k,d){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M8.603 3.799A4.49 4.49 0 0 1 12 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 0 1 3.498 1.307 4.491 4.491 0 0 1 1.307 3.497A4.49 4.49 0 0 1 21.75 12a4.49 4.49 0 0 1-1.549 3.397 4.491 4.491 0 0 1-1.307 3.497 4.491 4.491 0 0 1-3.497 1.307A4.49 4.49 0 0 1 12 21.75a4.49 4.49 0 0 1-3.397-1.549 4.49 4.49 0 0 1-3.498-1.306 4.491 4.491 0 0 1-1.307-3.498A4.49 4.49 0 0 1 2.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 0 1 1.307-3.497 4.49 4.49 0 0 1 3.497-1.307Zm7.007 6.387a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z","clip-rule":"evenodd"})])}function D(k,d){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M16.881 4.345A23.112 23.112 0 0 1 8.25 6H7.5a5.25 5.25 0 0 0-.88 10.427 21.593 21.593 0 0 0 1.378 3.94c.464 1.004 1.674 1.32 2.582.796l.657-.379c.88-.508 1.165-1.593.772-2.468a17.116 17.116 0 0 1-.628-1.607c1.918.258 3.76.75 5.5 1.446A21.727 21.727 0 0 0 18 11.25c0-2.414-.393-4.735-1.119-6.905ZM18.26 3.74a23.22 23.22 0 0 1 1.24 7.51 23.22 23.22 0 0 1-1.41 7.992.75.75 0 1 0 1.409.516 24.555 24.555 0 0 0 1.415-6.43 2.992 2.992 0 0 0 .836-2.078c0-.807-.319-1.54-.836-2.078a24.65 24.65 0 0 0-1.415-6.43.75.75 0 1 0-1.409.516c.059.16.116.321.17.483Z"})])}const ie={class:"py-12"},ne={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},de={class:"bg-white shadow-xl sm:rounded-2xl p-6"},ue={class:"flex items-center justify-between border-b pb-4 mb-8"},ce={class:"flex space-x-2"},me={key:1,class:"space-y-6"},pe={key:0,class:"text-red-600 text-sm mt-1"},ve={key:0,class:"text-red-600 text-sm mt-1"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ge=["value"],ye={key:0,class:"text-red-600 text-sm mt-1"},fe={key:0,class:"text-red-600 text-sm mt-1"},be={class:"flex items-center"},we={class:"flex flex-wrap gap-4"},_e={class:"inline-flex items-center gap-2 cursor-pointer transition-transform duration-100 hover:scale-105"},he={class:"inline-flex items-center gap-2 cursor-pointer transition-transform duration-100 hover:scale-105"},ke={key:0,class:"text-red-600 text-sm mt-1"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ae={key:0,class:"text-red-600 text-sm"},Ve=["value"],je={key:0,class:"text-red-600 text-sm"},Ne={class:"mt-6"},Ue={key:0,class:"flex items-center"},$e={key:1},Be={key:2},Me={class:"flex items-center justify-between gap-2 mb-4"},Le={class:"flex items-center space-x-2"},Fe=["value"],Se={key:0,class:"text-center p-8"},Te={key:1,class:"space-y-4"},Ze={class:"flex items-start justify-between"},De={class:"flex-1 min-w-0"},Pe={class:"flex items-center gap-2 mb-1"},ze={class:"text-lg font-bold text-gray-900 truncate"},He={class:"text-xs text-gray-500 mb-2"},Re={class:"mr-2"},Ee={class:"text-sm text-gray-700 mt-2 whitespace-pre-line leading-relaxed"},Ge={key:0,class:"mt-4 pt-3 border-t border-gray-200"},Ie={class:"flex items-center gap-2 mb-2 text-xs font-semibold text-gray-600"},Oe={class:"space-y-2"},We={class:"text-sm font-medium text-gray-800"},qe={class:"flex flex-wrap gap-2 mt-1"},Je={key:0,class:"flex-shrink-0 ml-4 text-right"},Ke=["href"],Qe={key:0,class:"text-center text-gray-500 p-8"},ft={__name:"Index",setup(k){const d=c("create"),r=c({title:"",description:"",url:"",type:"General",visible_to_client:!1,channels:["push"],user_ids:[],project_id:null}),T=["General","Warning","Updates","Final Notice"],C=c(!1),n=c({}),y=c(""),N=c([]),U=c([]),w=c(""),_=c([]),$=c(!1);B(()=>W().props.auth.user);const P=async()=>{var o;try{const[e,s]=await Promise.all([j.get("/api/users",{params:{per_page:200}}),j.get("/api/projects-simplified")]),v=((o=e.data)==null?void 0:o.data)??e.data;N.value=Array.isArray(v)?v:[],U.value=Array.isArray(s.data)?s.data:[]}catch(e){console.error("Failed to load users or projects",e),N.value=[],U.value=[]}},z=async()=>{var o;n.value={},y.value="";try{C.value=!0;const e={...r.value};e.project_id||delete e.project_id,(!e.user_ids||e.user_ids.length===0)&&delete e.user_ids,await j.post("/api/notices",e),y.value="Notice created and notifications sent.",r.value={title:"",description:"",url:"",type:"General",visible_to_client:!1,channels:["push","email"],user_ids:[],project_id:null},d.value==="list"&&await h()}catch(e){((o=e.response)==null?void 0:o.status)===422?n.value=e.response.data.errors||{}:y.value="Failed to create notice."}finally{C.value=!1}},H=B(()=>["All",...T]),h=async()=>{var o;$.value=!0;try{const e={};w.value&&w.value!=="All"&&(e.type=w.value);const s=await j.get("/api/notices",{params:e}),v=((o=s.data)==null?void 0:o.data)??s.data;_.value=Array.isArray(v)?v:Array.isArray(s.data)?s.data:[]}catch(e){console.error("Failed to load notices",e),_.value=[]}finally{$.value=!1}},R=o=>{switch(o){case"Warning":return"bg-red-100 text-red-800";case"Updates":return"bg-blue-100 text-blue-800";case"Final Notice":return"bg-yellow-100 text-yellow-800";case"General":default:return"bg-indigo-100 text-indigo-800"}},E=o=>{if(!o)return"";try{return new Date(o).toLocaleString()}catch{return String(o)}},G=o=>{switch(o){case"read":return"Read";case"click":return"Click";case"email_open":return"Email Open";default:return o}},I=B(()=>N.value.map(o=>({value:o.id,label:`${o.name} (${o.email})`})));return q(async()=>{await P(),d.value==="list"&&await h()}),(o,e)=>(l(),a(g,null,[m(p(J),{title:"Notice Board"}),m(K,null,{default:M(()=>[t("div",ie,[t("div",ne,[t("div",de,[t("div",ue,[e[14]||(e[14]=t("h2",{class:"text-3xl font-extrabold text-gray-900"},"Notice Board",-1)),t("div",ce,[t("button",{class:A(["flex items-center px-4 py-2 rounded-xl transition-colors duration-200",d.value==="create"?"bg-indigo-500 text-white shadow-md":"text-gray-600 hover:bg-gray-100"]),onClick:e[0]||(e[0]=s=>d.value="create")},[m(p(ee),{class:"h-5 w-5 mr-2"}),e[12]||(e[12]=f(" Create Notice ",-1))],2),t("button",{class:A(["flex items-center px-4 py-2 rounded-xl transition-colors duration-200",d.value==="list"?"bg-indigo-500 text-white shadow-md":"text-gray-600 hover:bg-gray-100"]),onClick:e[1]||(e[1]=s=>(d.value="list",h()))},[m(p(se),{class:"h-5 w-5 mr-2"}),e[13]||(e[13]=f(" Existing Notices ",-1))],2)])]),y.value?(l(),a("div",{key:0,class:A(["mb-6 px-4 py-3 rounded-xl",y.value.includes("Failed")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"])},i(y.value),3)):u("",!0),d.value==="create"?(l(),a("div",me,[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700"},"Title",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.title=s),type:"text",class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[L,r.value.title]]),n.value.title?(l(),a("div",pe,i(n.value.title[0]),1)):u("",!0)]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700"},"Description",-1)),x(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>r.value.description=s),rows:"4",class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[L,r.value.description]]),n.value.description?(l(),a("div",ve,i(n.value.description[0]),1)):u("",!0)]),t("div",xe,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700"},"Type",-1)),x(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>r.value.type=s),class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},[(l(),a(g,null,b(T,s=>t("option",{key:s,value:s},i(s),9,ge)),64))],512),[[F,r.value.type]]),n.value.type?(l(),a("div",ye,i(n.value.type[0]),1)):u("",!0)]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700"},"URL (optional)",-1)),x(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>r.value.url=s),type:"url",class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[L,r.value.url]]),n.value.url?(l(),a("div",fe,i(n.value.url[0]),1)):u("",!0)])]),t("div",be,[x(t("input",{id:"visible_to_client",type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>r.value.visible_to_client=s),class:"h-5 w-5 text-indigo-600 rounded-lg border-gray-300 focus:ring-indigo-500"},null,512),[[S,r.value.visible_to_client]]),e[19]||(e[19]=t("label",{for:"visible_to_client",class:"ml-2 block text-sm text-gray-700"},"Visible to Client",-1))]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notification Channels",-1)),t("div",we,[t("label",_e,[x(t("input",{type:"checkbox",value:"push","onUpdate:modelValue":e[7]||(e[7]=s=>r.value.channels=s),class:"h-5 w-5 rounded-lg border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[S,r.value.channels]]),e[20]||(e[20]=t("span",{class:"text-gray-700"},"Push",-1))]),t("label",he,[x(t("input",{type:"checkbox",value:"email","onUpdate:modelValue":e[8]||(e[8]=s=>r.value.channels=s),class:"h-5 w-5 rounded-lg border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[S,r.value.channels]]),e[21]||(e[21]=t("span",{class:"text-gray-700"},"Email",-1))])]),n.value.channels?(l(),a("div",ke,i(n.value.channels[0]),1)):u("",!0)]),t("div",Ce,[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Users (optional)",-1)),m(Y,{options:I.value,"is-multi":!0,modelValue:r.value.user_ids,"onUpdate:modelValue":e[9]||(e[9]=s=>r.value.user_ids=s),placeholder:"Select users to notify..."},null,8,["options","modelValue"]),e[24]||(e[24]=t("p",{class:"text-xs text-gray-500 mt-1"},"If users are selected, notification will be sent only to them.",-1)),n.value["user_ids.*"]?(l(),a("div",Ae,i(n.value["user_ids.*"][0]),1)):u("",!0)]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Project (optional)",-1)),x(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>r.value.project_id=s),class:"mt-1 block w-full rounded-xl shadow-sm border-gray-300 focus:ring-indigo-500 focus:border-indigo-500"},[e[25]||(e[25]=t("option",{value:null},"-- None --",-1)),(l(!0),a(g,null,b(U.value,s=>(l(),a("option",{key:s.id,value:s.id},i(s.name),9,Ve))),128))],512),[[F,r.value.project_id]]),e[27]||(e[27]=t("p",{class:"text-xs text-gray-500 mt-1"},"If no users are selected and a project is selected, all users on that project will be notified.",-1)),n.value.project_id?(l(),a("div",je,i(n.value.project_id[0]),1)):u("",!0)])]),t("div",Ne,[m(Q,{onClick:z,disabled:C.value},{default:M(()=>[C.value?(l(),a("span",Ue,e[28]||(e[28]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),f(" Saving... ",-1)]))):(l(),a("span",$e,"Create Notice"))]),_:1},8,["disabled"])])])):(l(),a("div",Be,[t("div",Me,[t("div",Le,[e[29]||(e[29]=t("label",{class:"text-sm font-medium text-gray-700"},"Filter by Type:",-1)),x(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>w.value=s),onChange:h,class:"border-gray-300 rounded-xl shadow-sm"},[(l(!0),a(g,null,b(H.value,s=>(l(),a("option",{key:s,value:s},i(s),9,Fe))),128))],544),[[F,w.value]])]),m(X,{onClick:h,class:"flex items-center gap-1"},{default:M(()=>[m(p(te),{class:"w-4 h-4"}),e[30]||(e[30]=f(" Refresh ",-1))]),_:1,__:[30]})]),$.value?(l(),a("div",Se,e[31]||(e[31]=[t("svg",{class:"animate-spin h-8 w-8 text-indigo-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),t("p",{class:"text-gray-500 text-sm mt-2"},"Loading notices...",-1)]))):(l(),a("div",Te,[(l(!0),a(g,null,b(_.value,s=>(l(),a("div",{key:s.id,class:"bg-gray-50 p-6 rounded-2xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow"},[t("div",Ze,[t("div",De,[t("div",Pe,[t("span",{class:A(["inline-flex items-center px-3 py-0.5 rounded-full text-xs font-medium",R(s.type)])},[s.type==="Warning"?(l(),V(p(oe),{key:0,class:"w-3 h-3 mr-1"})):s.type==="Updates"?(l(),V(p(D),{key:1,class:"w-3 h-3 mr-1"})):s.type==="Final Notice"?(l(),V(p(re),{key:2,class:"w-3 h-3 mr-1"})):(l(),V(p(D),{key:3,class:"w-3 h-3 mr-1"})),f(" "+i(s.type),1)],2),t("h4",ze,i(s.title),1)]),t("div",He,[t("span",Re,"Posted on: "+i(new Date(s.created_at).toLocaleDateString())+" at "+i(new Date(s.created_at).toLocaleTimeString()),1)]),t("div",Ee,i(s.description||"No description provided."),1),s.users_with_interactions&&s.users_with_interactions.length?(l(),a("div",Ge,[t("div",Ie,[m(p(le),{class:"w-4 h-4"}),e[32]||(e[32]=t("span",null,"Interactions",-1))]),t("div",Oe,[(l(!0),a(g,null,b(s.users_with_interactions,v=>(l(),a("div",{key:v.user.id,class:""},[t("div",We,i(v.user.name),1),t("div",qe,[(l(!0),a(g,null,b(v.interactions,(Z,O)=>(l(),a("span",{key:O,class:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-700"},i(G(Z.type))+" • "+i(E(Z.created_at)),1))),128))])]))),128))])])):u("",!0)]),s.url?(l(),a("div",Je,[t("a",{href:`/notices/${s.id}/redirect`,target:"_blank",class:"flex items-center text-indigo-600 hover:text-indigo-800 text-sm font-medium"},[e[33]||(e[33]=f(" Open Link ",-1)),m(p(ae),{class:"h-4 w-4 ml-1"})],8,Ke)])):u("",!0)])]))),128)),!_.value||_.value.length===0?(l(),a("div",Qe,"No notices found.")):u("",!0)]))]))])])])]),_:1})],64))}};export{ft as default};
