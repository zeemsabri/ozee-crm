import{r as f,m as k,q as S,o as m,w as h,a as i,c as w,k as b,t as v,y as M,Z as B,e as y,g as _,n as C,N as E,M as F}from"./app-DdN7Mxvn.js";import{_ as T}from"./Modal-BcCWKK72.js";import{_ as A}from"./PrimaryButton-DXqku6c5.js";import{_ as N}from"./SecondaryButton-B7cHuvDb.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"p-6"},$={class:"flex justify-between items-center mb-4"},P={class:"text-lg font-medium text-gray-900"},V={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},q={class:"block sm:inline"},L={key:0,class:"mt-6 flex justify-end space-x-3"},O={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:o=>["post","put","patch","delete"].includes(o.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:o=>o},beforeSubmit:{type:Function,default:()=>!0},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(o,{emit:g}){const s=o,u=g,a=f(!1),n=f({}),r=f("");k(()=>s.show,l=>{l&&(n.value={},r.value="",a.value=!1)});const x=async()=>{var l;a.value=!0,n.value={},r.value="";try{if(await s.beforeSubmit()===!1){a.value=!1;return}const t=s.formatDataForApi(s.formData);let d;const c=s.httpMethod.toLowerCase();if(c==="post")d=await window.axios.post(s.apiEndpoint,t);else if(c==="put")d=await window.axios.put(s.apiEndpoint,t);else if(c==="patch")d=await window.axios.patch(s.apiEndpoint,t);else if(c==="delete")d=await window.axios.delete(s.apiEndpoint,{data:t});else throw new Error(`Unsupported HTTP method: ${s.httpMethod}`);E(s.successMessage),u("submitted",d.data),u("close")}catch(e){console.error("API submission error:",e);let t="An unexpected error occurred.";e.response?e.response.status===422?(n.value=e.response.data.errors||{},t=e.response.data.message||"Please correct the errors in the form."):(t=e.response.data.message||"An unexpected error occurred.",r.value=t):(t="A network error occurred or the server is unreachable.",r.value=t),Object.keys(n.value).length>0?r.value="Please correct the errors in the form.":((l=e.response)==null?void 0:l.status)!==422&&(r.value=t),F(t),u("error",e)}finally{a.value=!1}},p=()=>{u("close")};return(l,e)=>(m(),S(T,{show:o.show,onClose:p},{default:h(()=>[i("div",D,[i("div",$,[i("h2",P,v(o.title),1),i("button",{onClick:p,class:"text-gray-400 hover:text-gray-500"},e[0]||(e[0]=[i("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),r.value?(m(),w("div",V,[i("span",q,v(r.value),1)])):b("",!0),i("form",{onSubmit:M(x,["prevent"])},[B(l.$slots,"default",{errors:n.value},void 0,!0),o.showFooter?(m(),w("div",L,[y(N,{onClick:p,type:"button",disabled:a.value},{default:h(()=>e[1]||(e[1]=[_(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),y(A,{type:"submit",disabled:a.value,class:C({"opacity-75 cursor-not-allowed":a.value})},{default:h(()=>[_(v(a.value?"Submitting...":o.submitButtonText),1)]),_:1},8,["disabled","class"])])):b("",!0)],32)])]),_:3},8,["show"]))}},G=j(O,[["__scopeId","data-v-5ed3c88d"]]);export{G as B};
