import{p as v,aH as T,C as M,_ as P,aI as It,aB as Y,n as ct,c as w,d as m,f as pt,Q as mt,F as Nt,r as B,aa as z,aJ as yt,aK as Tt,aL as G,aM as Ot}from"./app-CUg9I8P6.js";const S="/api",kt=async(t={})=>{const{data:e}=await v.get(`${S}/workflows`,{params:t});return e},Lt=async t=>{const{data:e}=await v.get(`${S}/workflows/${t}`);return e},bt=async t=>{const{data:e}=await v.post(`${S}/workflows`,t);return e},Pt=async(t,e)=>{const{data:o}=await v.put(`${S}/workflows/${t}`,e);return o},$t=async t=>{await v.delete(`${S}/workflows/${t}`)},Mt=async t=>{const{data:e}=await v.post(`${S}/workflow-steps`,t);return e},Ft=async(t,e)=>{const{data:o}=await v.put(`${S}/workflow-steps/${t}`,e);return o},qt=async t=>{await v.delete(`${S}/workflow-steps/${t}`)},Bt=async(t={})=>{const{data:e}=await v.get(`${S}/prompts`,{params:t});return e},Rt=async t=>{const{data:e}=await v.post(`${S}/prompts`,t);return e},Wt=async(t,e)=>{const{data:o}=await v.put(`${S}/prompts/${t}`,e);return o},Dt=async t=>{await v.delete(`${S}/prompts/${t}`)},xt=async(t,e={})=>{const{data:o}=await v.get(`${S}/workflows/${t}/logs`,{params:e});return o},Ut=async()=>{const{data:t}=await v.get(`${S}/automation/schema`);return t},j={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},W={LIGHT:"light",DARK:"dark",COLORED:"colored",AUTO:"auto"},A={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},Ht={BOUNCE:"bounce",SLIDE:"slide",FLIP:"flip",ZOOM:"zoom",NONE:"none"},jt={dangerouslyHTMLString:!1,multiple:!0,position:j.TOP_RIGHT,autoClose:5e3,transition:"bounce",hideProgressBar:!1,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,className:"",bodyClassName:"",style:{},progressClassName:"",progressStyle:{},role:"alert",theme:"light"},zt={rtl:!1,newestOnTop:!1,toastClassName:""},ht={...jt,...zt};A.DEFAULT;var c=(t=>(t[t.COLLAPSE_DURATION=300]="COLLAPSE_DURATION",t[t.DEBOUNCE_DURATION=50]="DEBOUNCE_DURATION",t.CSS_NAMESPACE="Toastify",t))(c||{}),st=(t=>(t.ENTRANCE_ANIMATION_END="d",t))(st||{});const Gt={enter:"Toastify--animate Toastify__bounce-enter",exit:"Toastify--animate Toastify__bounce-exit",appendPosition:!0},Vt={enter:"Toastify--animate Toastify__slide-enter",exit:"Toastify--animate Toastify__slide-exit",appendPosition:!0},Kt={enter:"Toastify--animate Toastify__zoom-enter",exit:"Toastify--animate Toastify__zoom-exit"},Jt={enter:"Toastify--animate Toastify__flip-enter",exit:"Toastify--animate Toastify__flip-exit"},ut="Toastify--animate Toastify__none-enter";function gt(t,e=!1){var o;let s=Gt;if(!t||typeof t=="string")switch(t){case"flip":s=Jt;break;case"zoom":s=Kt;break;case"slide":s=Vt;break}else s=t;if(e)s.enter=ut;else if(s.enter===ut){const n=(o=s.exit.split("__")[1])==null?void 0:o.split("-")[0];s.enter=`Toastify--animate Toastify__${n}-enter`}return s}function Qt(t){return t.containerId||String(t.position)}const Z="will-unmount";function Xt(t=j.TOP_RIGHT){return!!document.querySelector(`.${c.CSS_NAMESPACE}__toast-container--${t}`)}function Yt(t=j.TOP_RIGHT){return`${c.CSS_NAMESPACE}__toast-container--${t}`}function Zt(t,e,o=!1){const s=[`${c.CSS_NAMESPACE}__toast-container`,`${c.CSS_NAMESPACE}__toast-container--${t}`,o?`${c.CSS_NAMESPACE}__toast-container--rtl`:null].filter(Boolean).join(" ");return R(e)?e({position:t,rtl:o,defaultClassName:s}):`${s} ${e||""}`}function te(t){var e;const{position:o,containerClassName:s,rtl:n=!1,style:a={}}=t,r=c.CSS_NAMESPACE,l=Yt(o),u=document.querySelector(`.${r}`),y=document.querySelector(`.${l}`),h=!!y&&!((e=y.className)!=null&&e.includes(Z)),i=u||document.createElement("div"),f=document.createElement("div");f.className=Zt(o,s,n),f.dataset.testid=`${c.CSS_NAMESPACE}__toast-container--${o}`,f.id=Qt(t);for(const p in a)if(Object.prototype.hasOwnProperty.call(a,p)){const I=a[p];f.style[p]=I}return u||(i.className=c.CSS_NAMESPACE,document.body.appendChild(i)),h||i.appendChild(f),f}function nt(t){var e,o,s;const n=typeof t=="string"?t:((e=t.currentTarget)==null?void 0:e.id)||((o=t.target)==null?void 0:o.id),a=document.getElementById(n);a&&a.removeEventListener("animationend",nt,!1);try{H[n].unmount(),(s=document.getElementById(n))==null||s.remove(),delete H[n],delete g[n]}catch{}}const H=M({});function ee(t,e){const o=document.getElementById(String(e));o&&(H[o.id]=t)}function at(t,e=!0){const o=String(t);if(!H[o])return;const s=document.getElementById(o);s&&s.classList.add(Z),e?(se(t),s&&s.addEventListener("animationend",nt,!1)):nt(o),O.items=O.items.filter(n=>n.containerId!==t)}function oe(t){for(const e in H)at(e,t);O.items=[]}function _t(t,e){const o=document.getElementById(t.toastId);if(o){let s=t;s={...s,...gt(s.transition)};const n=s.appendPosition?`${s.exit}--${s.position}`:s.exit;o.className+=` ${n}`,e&&e(o)}}function se(t){for(const e in g)if(e===t)for(const o of g[e]||[])_t(o)}function ne(t){const e=D().find(o=>o.toastId===t);return e==null?void 0:e.containerId}function dt(t){return document.getElementById(t)}function ae(t){const e=dt(t.containerId);return e&&e.classList.contains(Z)}function ft(t){var e;const o=yt(t.content)?T(t.content.props):null;return o??T((e=t.data)!=null?e:{})}function re(t){return t?O.items.filter(e=>e.containerId===t).length>0:O.items.length>0}function ie(){if(O.items.length>0){const t=O.items.shift();V(t==null?void 0:t.toastContent,t==null?void 0:t.toastProps)}}const g=M({}),O=M({items:[]});function D(){const t=T(g);return Object.values(t).reduce((e,o)=>[...e,...o],[])}function le(t){return D().find(e=>e.toastId===t)}function V(t,e={}){if(ae(e)){const o=dt(e.containerId);o&&o.addEventListener("animationend",rt.bind(null,t,e),!1)}else rt(t,e)}function rt(t,e={}){const o=dt(e.containerId);o&&o.removeEventListener("animationend",rt.bind(null,t,e),!1);const s=g[e.containerId]||[],n=s.length>0;if(!n&&!Xt(e.position)){const a=te(e),r=It(Oe,e);e.useHandler&&e.useHandler(r),r.mount(a),ee(r,a.id)}n&&!e.updateId&&(e.position=s[0].position),ct(()=>{e.updateId?C.update(e):C.add(t,e)})}const C={add(t,e){const{containerId:o=""}=e;o&&(g[o]=g[o]||[],g[o].find(s=>s.toastId===e.toastId)||setTimeout(()=>{var s,n;e.newestOnTop?(s=g[o])==null||s.unshift(e):(n=g[o])==null||n.push(e),e.onOpen&&e.onOpen(ft(e))},e.delay||0))},remove(t){if(t){const e=ne(t);if(e){const o=g[e];let s=o.find(n=>n.toastId===t);g[e]=o.filter(n=>n.toastId!==t),!g[e].length&&!re(e)&&at(e,!1),ie(),ct(()=>{s!=null&&s.onClose&&(s.onClose(ft(s)),s=void 0)})}}},update(t={}){const{containerId:e=""}=t;if(e&&t.updateId){g[e]=g[e]||[];const o=g[e].find(a=>a.toastId===t.toastId),s=(o==null?void 0:o.position)!==t.position||(o==null?void 0:o.transition)!==t.transition,n={...t,disabledEnterTransition:!s,updateId:void 0};C.dismissForce(t==null?void 0:t.toastId),setTimeout(()=>{d(n.content,n)},t.delay||0)}},clear(t,e=!0){t?at(t,e):oe(e)},dismissCallback(t){var e;const o=(e=t.currentTarget)==null?void 0:e.id,s=document.getElementById(o);s&&(s.removeEventListener("animationend",C.dismissCallback,!1),setTimeout(()=>{C.remove(o)}))},dismiss(t){if(t){const e=D();for(const o of e)if(o.toastId===t){_t(o,s=>{s.addEventListener("animationend",C.dismissCallback,!1)});break}}},dismissForce(t){if(t){const e=D();for(const o of e)if(o.toastId===t){const s=document.getElementById(t);s&&(s.remove(),s.removeEventListener("animationend",C.dismissCallback,!1),C.remove(t));break}}}},ce=M({useHandler:void 0}),wt=M({}),X=M({});function At(){return Math.random().toString(36).substring(2,9)}function de(t){return typeof t=="number"&&!isNaN(t)}function it(t){return typeof t=="string"}function R(t){return typeof t=="function"}function tt(...t){return P(...t)}function K(t){return typeof t=="object"&&(!!(t!=null&&t.render)||!!(t!=null&&t.setup)||typeof(t==null?void 0:t.type)=="object")}function ue(t={}){wt[`${c.CSS_NAMESPACE}-default-options`]=t}function fe(){return wt[`${c.CSS_NAMESPACE}-default-options`]||ht}function pe(){const t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;return document.documentElement.classList.contains("dark")||t?"dark":"light"}var J=(t=>(t[t.Enter=0]="Enter",t[t.Exit=1]="Exit",t))(J||{});const vt={containerId:{type:[String,Number],required:!1,default:""},clearOnUrlChange:{type:Boolean,required:!1,default:!0},disabledEnterTransition:{type:Boolean,required:!1,default:!1},dangerouslyHTMLString:{type:Boolean,required:!1,default:!1},multiple:{type:Boolean,required:!1,default:!0},limit:{type:Number,required:!1,default:void 0},position:{type:String,required:!1,default:j.TOP_LEFT},bodyClassName:{type:String,required:!1,default:""},autoClose:{type:[Number,Boolean],required:!1,default:!1},closeButton:{type:[Boolean,Function,Object],required:!1,default:void 0},transition:{type:[String,Object],required:!1,default:"bounce"},hideProgressBar:{type:Boolean,required:!1,default:!1},pauseOnHover:{type:Boolean,required:!1,default:!0},pauseOnFocusLoss:{type:Boolean,required:!1,default:!0},closeOnClick:{type:Boolean,required:!1,default:!0},progress:{type:Number,required:!1,default:void 0},progressClassName:{type:String,required:!1,default:""},toastStyle:{type:Object,required:!1,default(){return{}}},progressStyle:{type:Object,required:!1,default(){return{}}},role:{type:String,required:!1,default:"alert"},theme:{type:String,required:!1,default:W.AUTO},content:{type:[String,Object,Function],required:!1,default:""},toastId:{type:[String,Number],required:!1,default:""},data:{type:[Object,String],required:!1,default(){return{}}},type:{type:String,required:!1,default:A.DEFAULT},icon:{type:[Boolean,String,Number,Object,Function],required:!1,default:void 0},delay:{type:Number,required:!1,default:void 0},onOpen:{type:Function,required:!1,default:void 0},onClose:{type:Function,required:!1,default:void 0},onClick:{type:Function,required:!1,default:void 0},isLoading:{type:Boolean,required:!1,default:void 0},rtl:{type:Boolean,required:!1,default:!1},toastClassName:{type:String,required:!1,default:""},updateId:{type:[String,Number],required:!1,default:""},contentProps:{type:Object,required:!1,default:null},expandCustomProps:{type:Boolean,required:!1,default:!1}},me={autoClose:{type:[Number,Boolean],required:!0},isRunning:{type:Boolean,required:!1,default:void 0},type:{type:String,required:!1,default:A.DEFAULT},theme:{type:String,required:!1,default:W.AUTO},hide:{type:Boolean,required:!1,default:void 0},className:{type:[String,Function],required:!1,default:""},controlledProgress:{type:Boolean,required:!1,default:void 0},rtl:{type:Boolean,required:!1,default:void 0},isIn:{type:Boolean,required:!1,default:void 0},progress:{type:Number,required:!1,default:void 0},closeToast:{type:Function,required:!1,default:void 0}},ye=Y({name:"ProgressBar",props:me,setup(t,{attrs:e}){const o=B(),s=w(()=>t.hide?"true":"false"),n=w(()=>({...e.style||{},animationDuration:`${t.autoClose===!0?5e3:t.autoClose}ms`,animationPlayState:t.isRunning?"running":"paused",opacity:t.hide||t.autoClose===!1?0:1,transform:t.controlledProgress?`scaleX(${t.progress})`:"none"})),a=w(()=>[`${c.CSS_NAMESPACE}__progress-bar`,t.controlledProgress?`${c.CSS_NAMESPACE}__progress-bar--controlled`:`${c.CSS_NAMESPACE}__progress-bar--animated`,`${c.CSS_NAMESPACE}__progress-bar-theme--${t.theme}`,`${c.CSS_NAMESPACE}__progress-bar--${t.type}`,t.rtl?`${c.CSS_NAMESPACE}__progress-bar--rtl`:null].filter(Boolean).join(" ")),r=w(()=>`${a.value} ${(e==null?void 0:e.class)||""}`),l=()=>{o.value&&(o.value.onanimationend=null,o.value.ontransitionend=null)},u=()=>{t.isIn&&t.closeToast&&t.autoClose!==!1&&(t.closeToast(),l())},y=w(()=>t.controlledProgress?null:u),h=w(()=>t.controlledProgress?u:null);return G(()=>{o.value&&(l(),o.value.onanimationend=y.value,o.value.ontransitionend=h.value)}),()=>m("div",{ref:o,role:"progressbar","aria-hidden":s.value,"aria-label":"notification timer",class:r.value,style:n.value},null)}}),he=Y({name:"CloseButton",inheritAttrs:!1,props:{theme:{type:String,required:!1,default:W.AUTO},type:{type:String,required:!1,default:W.LIGHT},ariaLabel:{type:String,required:!1,default:"close"},closeToast:{type:Function,required:!1,default:void 0}},setup(t){return()=>m("button",{class:`${c.CSS_NAMESPACE}__close-button ${c.CSS_NAMESPACE}__close-button--${t.theme}`,type:"button",onClick:e=>{e.stopPropagation(),t.closeToast&&t.closeToast(e)},"aria-label":t.ariaLabel},[m("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},[m("path",{"fill-rule":"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"},null)])])}}),et=({theme:t,type:e,path:o,...s})=>m("svg",P({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`},s),[m("path",{d:o},null)]);function ge(t){return m(et,P(t,{path:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}),null)}function _e(t){return m(et,P(t,{path:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}),null)}function we(t){return m(et,P(t,{path:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}),null)}function Ae(t){return m(et,P(t,{path:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}),null)}function ve(){return m("div",{class:`${c.CSS_NAMESPACE}__spinner`},null)}const Q={info:_e,warning:ge,success:we,error:Ae,spinner:ve},Se=t=>t in Q;function Ce({theme:t,type:e,isLoading:o,icon:s}){let n;const a=!!o||e==="loading",r={theme:t,type:e};if(a&&(s===void 0||typeof s=="boolean"))return Q.spinner();if(s!==!1){if(K(s))n=T(s);else if(R(s)){const l=s;r.type=a?"loading":e,n=l(r),n=!n&&a?Q.spinner():n}else yt(s)?n=Tt(s,r):it(s)||de(s)?n=s:Se(e)&&(n=Q[e](r));return n}}const Ee=()=>{};function Ie(t,e,o=c.COLLAPSE_DURATION){const{scrollHeight:s,style:n}=t,a=o;requestAnimationFrame(()=>{n.minHeight="initial",n.height=s+"px",n.transition=`all ${a}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(e,a)})})}function Ne(t){const e=B(!1),o=B(!1),s=B(!1),n=B(J.Enter),a=M({...t,appendPosition:t.appendPosition||!1,collapse:typeof t.collapse>"u"?!0:t.collapse,collapseDuration:t.collapseDuration||c.COLLAPSE_DURATION}),r=a.done||Ee,l=w(()=>a.appendPosition?`${a.enter}--${a.position}`:a.enter),u=w(()=>a.appendPosition?`${a.exit}--${a.position}`:a.exit),y=w(()=>t.pauseOnHover?{onMouseenter:_,onMouseleave:N}:{});function h(){const E=l.value.split(" ");f().addEventListener(st.ENTRANCE_ANIMATION_END,N,{once:!0});const L=q=>{const x=f();q.target===x&&(x.dispatchEvent(new Event(st.ENTRANCE_ANIMATION_END)),x.removeEventListener("animationend",L),x.removeEventListener("animationcancel",L),n.value===J.Enter&&q.type!=="animationcancel"&&x.classList.remove(...E))},b=()=>{const q=f();q.classList.add(...E),q.addEventListener("animationend",L),q.addEventListener("animationcancel",L)};t.pauseOnFocusLoss&&p(),b()}function i(){if(!f())return;const E=()=>{const b=f();b.removeEventListener("animationend",E),a.collapse?Ie(b,r,a.collapseDuration):r()},L=()=>{const b=f();n.value=J.Exit,b&&(b.className+=` ${u.value}`,b.addEventListener("animationend",E))};o.value||(s.value?E():setTimeout(L))}function f(){return t.toastRef.value}function p(){document.hasFocus()||_(),window.addEventListener("focus",N),window.addEventListener("blur",_)}function I(){window.removeEventListener("focus",N),window.removeEventListener("blur",_)}function N(){(!t.loading.value||t.isLoading===void 0)&&(e.value=!0)}function _(){e.value=!1}function F(E){E&&(E.stopPropagation(),E.preventDefault()),o.value=!1}return G(i),G(()=>{const E=D();o.value=E.findIndex(L=>L.toastId===a.toastId)>-1}),G(()=>{t.isLoading!==void 0&&(t.loading.value?_():N())}),pt(h),mt(()=>{t.pauseOnFocusLoss&&I()}),{isIn:o,isRunning:e,hideToast:F,eventHandlers:y}}const Te=Y({name:"ToastItem",inheritAttrs:!1,props:vt,setup(t){const e=B(),o=w(()=>!!t.isLoading),s=w(()=>t.progress!==void 0&&t.progress!==null),n=w(()=>Ce(t)),a=w(()=>[`${c.CSS_NAMESPACE}__toast`,`${c.CSS_NAMESPACE}__toast-theme--${t.theme}`,`${c.CSS_NAMESPACE}__toast--${t.type}`,t.rtl?`${c.CSS_NAMESPACE}__toast--rtl`:void 0,t.toastClassName||""].filter(Boolean).join(" ")),{isRunning:r,isIn:l,hideToast:u,eventHandlers:y}=Ne({toastRef:e,loading:o,done:()=>{C.remove(t.toastId)},...gt(t.transition,t.disabledEnterTransition),...t});return()=>m("div",P({id:t.toastId,class:a.value,style:t.toastStyle||{},ref:e,"data-testid":`toast-item-${t.toastId}`,onClick:h=>{t.closeOnClick&&u(),t.onClick&&t.onClick(h)}},y.value),[m("div",{role:t.role,"data-testid":"toast-body",class:`${c.CSS_NAMESPACE}__toast-body ${t.bodyClassName||""}`},[n.value!=null&&m("div",{"data-testid":`toast-icon-${t.type}`,class:[`${c.CSS_NAMESPACE}__toast-icon`,t.isLoading?"":`${c.CSS_NAMESPACE}--animate-icon ${c.CSS_NAMESPACE}__zoom-enter`].join(" ")},[K(n.value)?z(T(n.value),{theme:t.theme,type:t.type}):R(n.value)?n.value({theme:t.theme,type:t.type}):n.value]),m("div",{"data-testid":"toast-content"},[K(t.content)?z(T(t.content),{toastProps:T(t),closeToast:u,data:t.data,...t.expandCustomProps?t.contentProps:{contentProps:t.contentProps||{}}}):R(t.content)?t.content({toastProps:T(t),closeToast:u,data:t.data}):t.dangerouslyHTMLString?z("div",{innerHTML:t.content}):t.content])]),(t.closeButton===void 0||t.closeButton===!0)&&m(he,{theme:t.theme,closeToast:h=>{h.stopPropagation(),h.preventDefault(),u()}},null),K(t.closeButton)?z(T(t.closeButton),{closeToast:u,type:t.type,theme:t.theme}):R(t.closeButton)?t.closeButton({closeToast:u,type:t.type,theme:t.theme}):null,m(ye,{className:t.progressClassName,style:t.progressStyle,rtl:t.rtl,theme:t.theme,isIn:l.value,type:t.type,hide:t.hideProgressBar,isRunning:r.value,autoClose:t.autoClose,controlledProgress:s.value,progress:t.progress,closeToast:t.isLoading?void 0:u},null)])}});let U=0;function St(){typeof window>"u"||(U&&window.cancelAnimationFrame(U),U=window.requestAnimationFrame(St),X.lastUrl!==window.location.href&&(X.lastUrl=window.location.href,C.clear()))}const Oe=Y({name:"ToastifyContainer",inheritAttrs:!1,props:vt,setup(t){const e=w(()=>t.containerId),o=w(()=>g[e.value]||[]),s=w(()=>o.value.filter(n=>n.position===t.position));return pt(()=>{typeof window<"u"&&t.clearOnUrlChange&&window.requestAnimationFrame(St)}),mt(()=>{typeof window<"u"&&U&&(window.cancelAnimationFrame(U),X.lastUrl="")}),()=>m(Nt,null,[s.value.map(n=>{const{toastId:a=""}=n;return m(Te,P({key:a},n),null)})])}});let ot=!1;const Ct={isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1};function Et(){const t=[];return D().forEach(e=>{const o=document.getElementById(e.containerId);o&&!o.classList.contains(Z)&&t.push(e)}),t}function ke(t){const e=Et().length,o=t??0;return o>0&&e+O.items.length>=o}function Le(t){ke(t.limit)&&!t.updateId&&O.items.push({toastId:t.toastId,containerId:t.containerId,toastContent:t.content,toastProps:t})}function $(t,e,o={}){if(ot)return;o=tt(fe(),{type:e},T(o)),(!o.toastId||typeof o.toastId!="string"&&typeof o.toastId!="number")&&(o.toastId=At()),o={...o,...o.type==="loading"?Ct:{},content:t,containerId:o.containerId||String(o.position)};const s=Number(o==null?void 0:o.progress);return!isNaN(s)&&s<0&&(o.progress=0),s>1&&(o.progress=1),o.theme==="auto"&&(o.theme=pe()),Le(o),X.lastUrl=window.location.href,o.multiple?O.items.length?o.updateId&&V(t,o):V(t,o):(ot=!0,d.clearAll(void 0,!1),setTimeout(()=>{V(t,o)},0),setTimeout(()=>{ot=!1},390)),o.toastId}const d=(t,e)=>$(t,A.DEFAULT,e);d.info=(t,e)=>$(t,A.DEFAULT,{...e,type:A.INFO});d.error=(t,e)=>$(t,A.DEFAULT,{...e,type:A.ERROR});d.warning=(t,e)=>$(t,A.DEFAULT,{...e,type:A.WARNING});d.warn=d.warning;d.success=(t,e)=>$(t,A.DEFAULT,{...e,type:A.SUCCESS});d.loading=(t,e)=>$(t,A.DEFAULT,tt(e,Ct));d.dark=(t,e)=>$(t,A.DEFAULT,tt(e,{theme:W.DARK}));d.remove=t=>{t?C.dismiss(t):C.clear()};d.clearAll=(t,e)=>{ct(()=>{C.clear(t,e)})};d.isActive=t=>{let e=!1;return e=Et().findIndex(o=>o.toastId===t)>-1,e};d.update=(t,e={})=>{setTimeout(()=>{const o=le(t);if(o){const s=T(o),{content:n}=s,a={...s,...e,toastId:e.toastId||t,updateId:At()},r=a.render||n;delete a.render,$(r,a.type,a)}},0)};d.done=t=>{d.update(t,{isLoading:!1,progress:1})};d.promise=be;function be(t,{pending:e,error:o,success:s},n){var a,r,l;let u;const y={...n||{},autoClose:!1};e&&(u=it(e)?d.loading(e,y):d.loading(e.render,{...y,...e}));const h={autoClose:(a=n==null?void 0:n.autoClose)!=null?a:!0,closeOnClick:(r=n==null?void 0:n.closeOnClick)!=null?r:!0,closeButton:(l=n==null?void 0:n.autoClose)!=null?l:null,isLoading:void 0,draggable:null,delay:100},i=(p,I,N)=>{if(I==null){d.remove(u);return}const _={type:p,...h,...n,data:N},F=it(I)?{render:I}:I;return u?d.update(u,{..._,...F,isLoading:!1}):d(F.render,{..._,...F,isLoading:!1}),N},f=R(t)?t():t;return f.then(p=>{i("success",s,p)}).catch(p=>{i("error",o,p)}),f}d.POSITION=j;d.THEME=W;d.TYPE=A;d.TRANSITIONS=Ht;const Pe={install(t,e={}){ce.useHandler=e.useHandler||(()=>{}),$e(e)}};typeof window<"u"&&(window.Vue3Toastify=Pe);function $e(t={}){const e=tt(ht,t);ue(e)}const k=t=>t&&t.data?t.data:t,lt=(t,e,o)=>{if(!t)return!1;const s=t.findIndex(n=>n.id===e);if(s>-1)return t.splice(s,1,o),!0;for(const n of t)if(n.step_type==="CONDITION"&&(lt(n.yes_steps,e,o)||lt(n.no_steps,e,o)))return!0;return!1},Fe=Ot("workflow",{state:()=>({workflows:[],prompts:[],automationSchema:[],campaigns:[],morphMap:[],activeWorkflow:null,selectedStep:null,isLoading:!1,modalState:{show:!1,title:"",message:"",onConfirm:null,onCancel:null,type:"alert"},logsModal:{show:!1,isLoading:!1,workflow:null,items:[],meta:null,params:{per_page:20,page:1,status:null,step_id:null}}}),actions:{showAlert(t,e){this.modalState={show:!0,title:t,message:e,onConfirm:null,onCancel:null,type:"alert"}},showConfirm(t,e,o,s){this.modalState={show:!0,title:t,message:e,onConfirm:o,onCancel:s,type:"confirm"}},hideModal(){this.modalState={show:!1,title:"",message:"",onConfirm:null,onCancel:null,type:"alert"}},showLogs(t){this.logsModal.show=!0,this.logsModal.workflow=t,this.logsModal.items=[],this.logsModal.meta=null,this.logsModal.params.page=1,this.fetchWorkflowLogs(t.id)},hideLogs(){this.logsModal={show:!1,isLoading:!1,workflow:null,items:[],meta:null,params:{per_page:20,page:1,status:null,step_id:null}}},async fetchWorkflowLogs(t,e={}){this.logsModal.isLoading=!0;try{const o={...this.logsModal.params,...e},s=await xt(t,o);if(s&&typeof s=="object"){const n=Array.isArray(s.data)?s.data:[];this.logsModal.items=n,this.logsModal.meta=s.meta||null,s.meta&&typeof s.meta.current_page=="number"&&(this.logsModal.params.page=s.meta.current_page)}else Array.isArray(s)?(this.logsModal.items=s,this.logsModal.meta=null):(this.logsModal.items=[],this.logsModal.meta=null)}catch(o){console.error("Failed to fetch workflow logs",o),this.showAlert("Failed to load logs","Could not load execution logs for this workflow.")}finally{this.logsModal.isLoading=!1}},async goToLogsPage(t){this.logsModal.workflow&&(this.logsModal.params.page=t,await this.fetchWorkflowLogs(this.logsModal.workflow.id,{page:t}))},async fetchAutomationSchema(){try{const t=await Ut();if(Array.isArray(t))this.automationSchema=t,this.campaigns=[];else if(t&&typeof t=="object"){const e=Array.isArray(t.models)?t.models:[];this.automationSchema=e,this.campaigns=Array.isArray(t.campaigns)?t.campaigns:[],this.morphMap=Array.isArray(t.morph_map)?t.morph_map:[]}else this.automationSchema=[],this.campaigns=[]}catch(t){console.error("Failed to fetch automation schema:",t),this.automationSchema=[],this.campaigns=[]}},async fetchWorkflows(){this.isLoading=!0;try{const t=await kt();this.workflows=k(t)||[]}catch(t){console.error("Failed to fetch workflows:",t)}finally{this.isLoading=!1}},async fetchWorkflow(t){this.isLoading=!0;try{const e=await Lt(t),o=k(e),s=a=>{Array.isArray(a)&&a.forEach(r=>{(!r.step_config||typeof r.step_config!="object"||Array.isArray(r.step_config))&&(r.step_config={}),r.step_type==="CONDITION"&&(Array.isArray(r.yes_steps)||(r.yes_steps=[]),Array.isArray(r.no_steps)||(r.no_steps=[]),s(r.yes_steps),s(r.no_steps)),r.step_type==="FOR_EACH"&&(Array.isArray(r.children)||(r.children=[]),s(r.children))})},n=a=>{const r=Array.isArray(a.steps)?a.steps:[];if(!r.length)return;const l=r.some(i=>i?i.step_type==="CONDITION"?Array.isArray(i.yes_steps)&&i.yes_steps.length||Array.isArray(i.no_steps)&&i.no_steps.length:i.step_type==="FOR_EACH"?Array.isArray(i.children)&&i.children.length>0:!1:!1);if(r.forEach(i=>{(!i.step_config||typeof i.step_config!="object"||Array.isArray(i.step_config))&&(i.step_config={})}),l){s(r);return}const u=new Map;r.forEach(i=>u.set(String(i.id),i)),r.forEach(i=>{i.step_type==="CONDITION"&&(Array.isArray(i.yes_steps)||(i.yes_steps=[]),Array.isArray(i.no_steps)||(i.no_steps=[])),i.step_type==="FOR_EACH"&&(Array.isArray(i.children)||(i.children=[]))});const y=[];r.forEach(i=>{var I,N;const f=(I=i.step_config)==null?void 0:I._parent_id,p=(N=i.step_config)==null?void 0:N._branch;if(f&&u.has(String(f))){const _=u.get(String(f));if(_&&_.step_type==="CONDITION"&&p){(String(p).toLowerCase()==="no"?_.no_steps:_.yes_steps).push(i);return}if(_&&_.step_type==="FOR_EACH"&&(p==null||p==="")){_.children.push(i);return}}y.push(i)});const h=i=>i.sort((f,p)=>(f.step_order??0)-(p.step_order??0));r.forEach(i=>{i.step_type==="CONDITION"&&(h(i.yes_steps),h(i.no_steps)),i.step_type==="FOR_EACH"&&h(i.children)}),a.steps=h(y)};if(o&&typeof o=="object"&&Array.isArray(o.steps)){n(o);const a=r=>{Array.isArray(r)&&r.forEach((l,u)=>{var y;!l||typeof l!="object"||((!l.step_config||typeof l.step_config!="object"||Array.isArray(l.step_config))&&(l.step_config={}),u===0&&l.step_type==="TRIGGER"&&((y=l.step_config)==null?void 0:y.trigger_event)==="schedule.run"&&(l.step_type="SCHEDULE_TRIGGER"),l.step_type==="CONDITION"&&(Array.isArray(l.if_true)||(l.if_true=Array.isArray(l.yes_steps)?l.yes_steps:[]),Array.isArray(l.if_false)||(l.if_false=Array.isArray(l.no_steps)?l.no_steps:[]),l.yes_steps=l.if_true,l.no_steps=l.if_false,a(l.if_true),a(l.if_false)),l.step_type==="FOR_EACH"&&(Array.isArray(l.children)||(l.children=[]),a(l.children)))})};a(o.steps),this.activeWorkflow=o}else console.error(`Received invalid data structure for workflow ${t}:`,e),this.activeWorkflow=null,this.selectedStep=null}catch(e){console.error(`Failed to fetch workflow ${t}:`,e),this.activeWorkflow=null,this.selectedStep=null}finally{this.isLoading=!1}},async createWorkflow(t){const e=await bt(t),o=k(e);return o&&typeof o=="object"&&o.id?(this.workflows.unshift(o),await this.fetchWorkflow(o.id),o):(console.error("Received invalid data structure after creating workflow:",e),this.showAlert("Failed to create workflow.","An unknown error occurred while creating the workflow."),null)},async updateWorkflow(t,e){const o=await Pt(t,e),s=k(o);if(s&&s.id){const n=this.workflows.findIndex(a=>a.id===t);n!==-1&&this.workflows.splice(n,1,s),this.activeWorkflow&&this.activeWorkflow.id===t&&(this.activeWorkflow={...this.activeWorkflow,...s})}return s},async toggleWorkflowActive(t){if(!t)return;const e=t.id||t,o=typeof t=="object"?t:this.workflows.find(n=>n.id===e),s=!((o==null?void 0:o.is_active)??!0);return await this.updateWorkflow(e,{is_active:s})},async deleteWorkflow(t){try{await $t(t);const e=this.workflows.findIndex(o=>o.id===t);e!==-1&&this.workflows.splice(e,1),this.activeWorkflow&&this.activeWorkflow.id===t&&(this.activeWorkflow=null,this.selectedStep=null),d.success("Workflow deleted")}catch(e){console.error("Failed to delete workflow",e),this.showAlert("Delete failed","Could not delete workflow.")}},addStep({type:t,insertAfter:e,parentArray:o,parentStep:s=null,branch:n=null}){if(!this.activeWorkflow)return;const a={id:`temp_${Date.now()}`,workflow_id:this.activeWorkflow.id,name:`New ${t.replace("ACTION_","")}`,step_type:t,step_order:e+1,step_config:{},condition_rules:t==="CONDITION"?[]:null};s&&n&&(a.step_config._parent_id=s.id,a.step_config._branch=n),t==="CONDITION"&&(a.yes_steps=[],a.no_steps=[]),(o||this.activeWorkflow.steps).splice(e+1,0,a),this.selectStep(a)},selectStep(t){this.selectedStep=t},async deleteStep(t){if(!this.activeWorkflow)return;const e=(o,s)=>{const n=o.findIndex(a=>a.id===s);if(n>-1)return o.splice(n,1),!0;for(const a of o)if(a.step_type==="CONDITION"&&(e(a.yes_steps,s)||e(a.no_steps,s)))return!0;return!1};if(e(this.activeWorkflow.steps,t.id)&&(this.selectedStep&&this.selectedStep.id===t.id&&(this.selectedStep=null),!String(t.id).startsWith("temp_")))try{await qt(t.id),d.success("Step deleted!")}catch(o){console.error("Failed to delete step:",o),this.showAlert("Could not delete step.","An error occurred while deleting the step.")}},async persistStep(t){if(!t||!t.workflow_id)return;const e=t.id;try{let o;if(String(e).startsWith("temp_")){const{id:n,...a}=t,r=await Mt(a);o=k(r)}else{const n=await Ft(e,t);o=k(n)}o&&(o.step_type==="CONDITION"&&(Array.isArray(o.yes_steps)||(o.yes_steps=[]),Array.isArray(o.no_steps)||(o.no_steps=[])),lt(this.activeWorkflow.steps,e,o)?this.selectStep(o):await this.fetchWorkflow(t.workflow_id))}catch(o){console.error("Failed to save step:",o),this.showAlert("Failed to save step.","An error occurred while saving the step.")}},async fetchPrompts(){try{const t=await Bt({per_page:100}),e=k(t);if(Array.isArray(e))this.prompts=e;else if(e&&typeof e=="object"){const o=Array.isArray(e.data)?e.data:[];this.prompts=o}else this.prompts=[]}catch(t){console.error("Failed to fetch prompts:",t),this.prompts=[]}},async createPrompt(t){const e=await Rt(t),o=k(e);return Array.isArray(this.prompts)||(this.prompts=[]),o&&this.prompts.unshift(o),o},async updatePrompt(t,e){const o=await Wt(t,e),s=k(o);Array.isArray(this.prompts)||(this.prompts=[]);const n=this.prompts.findIndex(a=>a.id===t);return n!==-1&&s?this.prompts.splice(n,1,s):s&&this.prompts.unshift(s),s},async deletePrompt(t){await Dt(t);const e=this.prompts.findIndex(o=>o.id===t);e!==-1&&this.prompts.splice(e,1)}}});export{Fe as u};
