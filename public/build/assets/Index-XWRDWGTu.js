import{l as V,G as K,r as _,D as O,b as Q,c as u,o as r,e as l,u as R,h as W,w as i,a as s,k as y,g as m,t as c,F,i as X,q,y as B,f as $,v as E,s as N}from"./app-nAqQJsbR.js";import{_ as Z}from"./AuthenticatedLayout-xY_DmKWf.js";import{_ as k}from"./PrimaryButton-yJM6lm_0.js";import{D as j}from"./DangerButton-BoUJgTYa.js";import{_ as M}from"./Modal-DhbO6a4Q.js";import{_ as v}from"./InputLabel-D-9b_EvI.js";import{_ as w}from"./TextInput-CQd22ZsB.js";import{_ as p}from"./InputError-Dtq2oRc3.js";import{_ as A}from"./SecondaryButton-CWcCkJJP.js";import"./index-CEM64rK8.js";import"./BaseFormModal-D6fLUGFx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SelectDropdown-C_0VCa5k.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./RightSidebar-CP9mncM7.js";import"./ApplicationLogo-tQZvHTWH.js";import"./MultiSelectDropdown-BvFQZe28.js";import"./createLucideIcon-5puRqNY3.js";import"./plus-Djkg5stV.js";import"./moment-BLMuvzoS.js";import"./taskState-DGvI4lqK.js";import"./NoticeboardModal-BqMQX20H.js";import"./x-P1eR8_mO.js";const ee={class:"py-12"},se={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},le={class:"p-6 text-gray-900"},ae={key:0,class:"mb-6"},oe={key:1,class:"text-gray-600"},ne={key:2,class:"text-red-600"},de={key:3,class:"text-gray-600"},ie={key:4},re={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap"},ve={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4 whitespace-nowrap"},fe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ce={class:"flex items-center space-x-2"},ge={class:"p-6"},_e={key:0,class:"text-red-600 text-sm mb-4"},xe={class:"mb-4"},ye={class:"mb-4"},we={class:"mb-4"},be={class:"mb-4"},he={class:"mb-4"},Ce={class:"mt-6 flex justify-end"},ke={class:"p-6"},Ve={key:0,class:"text-red-600 text-sm mb-4"},$e={class:"mb-4"},Ee={class:"mb-4"},Ne={class:"mb-4"},Ue={class:"mb-4"},De={class:"mb-4"},Me={class:"mt-6 flex justify-end"},Ae={class:"p-6"},Fe={key:0,class:"mt-4 text-gray-800"},qe={key:1,class:"text-red-600 text-sm mb-4"},Be={class:"mt-6 flex justify-end"},ds={__name:"Index",setup(je){const f=V(()=>K().props.auth.user),g=_([]),U=_(!0),n=_({}),d=_(""),b=_(!1),h=_(!1),C=_(!1),a=O({id:null,name:"",email:"",phone:"",address:"",notes:""}),x=_(null),P=V(()=>{var t;return f.value?((t=f.value.role_data)==null?void 0:t.slug)==="super-admin"||f.value.role==="super_admin"||f.value.role==="super-admin":!1}),S=V(()=>{var t;return f.value?((t=f.value.role_data)==null?void 0:t.slug)==="manager"||f.value.role==="manager"||f.value.role==="manager-role"||f.value.role==="manager_role":!1}),D=V(()=>P.value||S.value),T=async()=>{U.value=!0,d.value="";try{const t=await N.get("/api/clients");g.value=t.data.data}catch(t){d.value="Failed to fetch clients.",console.error("Error fetching clients:",t),t.response&&t.response.status===403&&(d.value="You do not have permission to view clients.")}finally{U.value=!1}},L=()=>{a.id=null,a.name="",a.email="",a.phone="",a.address="",a.notes="",n.value={},d.value="",b.value=!0},I=async()=>{n.value={},d.value="";try{const t=await N.post("/api/clients",a);g.value.push(t.data.data),b.value=!1,alert("Client created successfully!")}catch(t){t.response&&t.response.status===422?n.value=t.response.data.errors:t.response&&t.response.data.message?d.value=t.response.data.message:(d.value="Failed to create client.",console.error("Error creating client:",t))}},G=t=>{a.id=t.id,a.name=t.name,a.email=t.email,a.phone=t.phone,a.address=t.address,a.notes=t.notes,n.value={},d.value="",h.value=!0},Y=async()=>{n.value={},d.value="";try{const t=await N.put(`/api/clients/${a.id}`,a),e=g.value.findIndex(o=>o.id===a.id);e!==-1&&(g.value[e]=t.data.data),h.value=!1,alert("Client updated successfully!")}catch(t){t.response&&t.response.status===422?n.value=t.response.data.errors:t.response&&t.response.data.message?d.value=t.response.data.message:(d.value="Failed to update client.",console.error("Error updating client:",t))}},z=t=>{x.value=t,C.value=!0},H=async()=>{d.value="";try{await N.delete(`/api/clients/${x.value.id}`),g.value=g.value.filter(t=>t.id!==x.value.id),C.value=!1,x.value=null,alert("Client deleted successfully!")}catch(t){d.value="Failed to delete client.",console.error("Error deleting client:",t)}};return Q(()=>{T()}),(t,e)=>(r(),u(F,null,[l(R(W),{title:"Clients"}),l(Z,null,{header:i(()=>e[16]||(e[16]=[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Clients",-1)])),default:i(()=>[s("div",ee,[s("div",se,[s("div",te,[s("div",le,[e[22]||(e[22]=s("h3",{class:"text-2xl font-bold mb-4"},"Client List",-1)),D.value?(r(),u("div",ae,[l(k,{onClick:L},{default:i(()=>e[17]||(e[17]=[m(" Create New Client ",-1)])),_:1,__:[17]})])):y("",!0),U.value?(r(),u("div",oe,"Loading clients...")):d.value?(r(),u("div",ne,c(d.value),1)):g.value.length===0?(r(),u("div",de,"No clients found.")):(r(),u("div",ie,[s("table",re,[e[21]||(e[21]=s("thead",{class:"bg-gray-50"},[s("tr",null,[s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Phone"),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),s("tbody",ue,[(r(!0),u(F,null,X(g.value,o=>(r(),u("tr",{key:o.id},[s("td",me,c(o.name),1),s("td",ve,c(o.email),1),s("td",pe,c(o.phone||"N/A"),1),s("td",fe,[s("div",ce,[l(k,{as:"a",href:`/clients/${o.id}`},{default:i(()=>e[18]||(e[18]=[m("View",-1)])),_:2,__:[18]},1032,["href"]),D.value?(r(),q(k,{key:0,onClick:J=>G(o)},{default:i(()=>e[19]||(e[19]=[m("Edit",-1)])),_:2,__:[19]},1032,["onClick"])):y("",!0),D.value?(r(),q(j,{key:1,onClick:J=>z(o)},{default:i(()=>e[20]||(e[20]=[m("Delete",-1)])),_:2,__:[20]},1032,["onClick"])):y("",!0)])])]))),128))])])]))])])])]),l(M,{show:b.value,onClose:e[6]||(e[6]=o=>b.value=!1)},{default:i(()=>[s("div",ge,[e[25]||(e[25]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Create New Client",-1)),d.value?(r(),u("div",_e,c(d.value),1)):y("",!0),s("form",{onSubmit:B(I,["prevent"])},[s("div",xe,[l(v,{for:"name",value:"Name"}),l(w,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.name=o),required:"",autofocus:""},null,8,["modelValue"]),l(p,{message:n.value.name?n.value.name[0]:"",class:"mt-2"},null,8,["message"])]),s("div",ye,[l(v,{for:"email",value:"Email"}),l(w,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:a.email,"onUpdate:modelValue":e[1]||(e[1]=o=>a.email=o),required:""},null,8,["modelValue"]),l(p,{message:n.value.email?n.value.email[0]:"",class:"mt-2"},null,8,["message"])]),s("div",we,[l(v,{for:"phone",value:"Phone"}),l(w,{id:"phone",type:"text",class:"mt-1 block w-full",modelValue:a.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>a.phone=o)},null,8,["modelValue"]),l(p,{message:n.value.phone?n.value.phone[0]:"",class:"mt-2"},null,8,["message"])]),s("div",be,[l(v,{for:"address",value:"Address"}),$(s("textarea",{id:"address",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[3]||(e[3]=o=>a.address=o)},null,512),[[E,a.address]]),l(p,{message:n.value.address?n.value.address[0]:"",class:"mt-2"},null,8,["message"])]),s("div",he,[l(v,{for:"notes",value:"Notes"}),$(s("textarea",{id:"notes",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[4]||(e[4]=o=>a.notes=o)},null,512),[[E,a.notes]]),l(p,{message:n.value.notes?n.value.notes[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ce,[l(A,{onClick:e[5]||(e[5]=o=>b.value=!1)},{default:i(()=>e[23]||(e[23]=[m("Cancel",-1)])),_:1,__:[23]}),l(k,{class:"ms-3",type:"submit"},{default:i(()=>e[24]||(e[24]=[m("Create Client",-1)])),_:1,__:[24]})])],32)])]),_:1},8,["show"]),l(M,{show:h.value,onClose:e[13]||(e[13]=o=>h.value=!1)},{default:i(()=>[s("div",ke,[e[28]||(e[28]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Client",-1)),d.value?(r(),u("div",Ve,c(d.value),1)):y("",!0),s("form",{onSubmit:B(Y,["prevent"])},[s("div",$e,[l(v,{for:"edit_name",value:"Name"}),l(w,{id:"edit_name",type:"text",class:"mt-1 block w-full",modelValue:a.name,"onUpdate:modelValue":e[7]||(e[7]=o=>a.name=o),required:"",autofocus:""},null,8,["modelValue"]),l(p,{message:n.value.name?n.value.name[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ee,[l(v,{for:"edit_email",value:"Email"}),l(w,{id:"edit_email",type:"email",class:"mt-1 block w-full",modelValue:a.email,"onUpdate:modelValue":e[8]||(e[8]=o=>a.email=o),required:""},null,8,["modelValue"]),l(p,{message:n.value.email?n.value.email[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ne,[l(v,{for:"edit_phone",value:"Phone"}),l(w,{id:"edit_phone",type:"text",class:"mt-1 block w-full",modelValue:a.phone,"onUpdate:modelValue":e[9]||(e[9]=o=>a.phone=o)},null,8,["modelValue"]),l(p,{message:n.value.phone?n.value.phone[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ue,[l(v,{for:"edit_address",value:"Address"}),$(s("textarea",{id:"edit_address",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[10]||(e[10]=o=>a.address=o)},null,512),[[E,a.address]]),l(p,{message:n.value.address?n.value.address[0]:"",class:"mt-2"},null,8,["message"])]),s("div",De,[l(v,{for:"edit_notes",value:"Notes"}),$(s("textarea",{id:"edit_notes",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[11]||(e[11]=o=>a.notes=o)},null,512),[[E,a.notes]]),l(p,{message:n.value.notes?n.value.notes[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Me,[l(A,{onClick:e[12]||(e[12]=o=>h.value=!1)},{default:i(()=>e[26]||(e[26]=[m("Cancel",-1)])),_:1,__:[26]}),l(k,{class:"ms-3",type:"submit"},{default:i(()=>e[27]||(e[27]=[m("Update Client",-1)])),_:1,__:[27]})])],32)])]),_:1},8,["show"]),l(M,{show:C.value,onClose:e[15]||(e[15]=o=>C.value=!1)},{default:i(()=>[s("div",Ae,[e[32]||(e[32]=s("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this client? ",-1)),e[33]||(e[33]=s("p",{class:"mt-1 text-sm text-gray-600"}," This action cannot be undone. All associated projects and conversations will also be deleted. ",-1)),x.value?(r(),u("div",Fe,[e[29]||(e[29]=s("strong",null,"Client:",-1)),m(" "+c(x.value.name)+" ("+c(x.value.email)+") ",1)])):y("",!0),d.value?(r(),u("div",qe,c(d.value),1)):y("",!0),s("div",Be,[l(A,{onClick:e[14]||(e[14]=o=>C.value=!1)},{default:i(()=>e[30]||(e[30]=[m("Cancel",-1)])),_:1,__:[30]}),l(j,{class:"ms-3",onClick:H},{default:i(()=>e[31]||(e[31]=[m("Delete Client",-1)])),_:1,__:[31]})])])]),_:1},8,["show"])]),_:1})],64))}};export{ds as default};
