import{A as ne}from"./ApplicationLogo-BIVD-15S.js";import{B as F,E as te,s as T,r as A,i as w,o as i,b as s,f as R,e as g,A as P,L as Z,a as n,n as I,T as de,c as S,V as se,h as k,l as Y,t as L,F as X,j as K,X as ue,w as ce,d as ve,g as _,q as me,m as f,k as J,x as N,D as ae,C as fe,G as j,J as ge}from"./app-DUWzY8YR.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as oe}from"./PrimaryButton-fQzw-Loh.js";import{a as pe,_ as ye}from"./SecondaryButton-CmFBMLHL.js";import{_ as G,a as O}from"./InputError-BfJroPLl.js";const be={class:"relative"},ee={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(c){const d=c,v=u=>{o.value&&u.key==="Escape"&&(o.value=!1)};F(()=>document.addEventListener("keydown",v)),te(()=>document.removeEventListener("keydown",v));const h=T(()=>({48:"w-48"})[d.width.toString()]),b=T(()=>d.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":d.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),o=A(!1);return(u,l)=>(i(),w("div",be,[s("div",{onClick:l[0]||(l[0]=y=>o.value=!o.value)},[P(u.$slots,"trigger")]),R(s("div",{class:"fixed inset-0 z-40",onClick:l[1]||(l[1]=y=>o.value=!1)},null,512),[[Z,o.value]]),g(de,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:n(()=>[R(s("div",{class:I(["absolute z-50 mt-2 rounded-md shadow-lg",[h.value,b.value]]),style:{display:"none"},onClick:l[2]||(l[2]=y=>o.value=!1)},[s("div",{class:I(["rounded-md ring-1 ring-black ring-opacity-5",c.contentClasses])},[P(u.$slots,"content")],2)],2),[[Z,o.value]])]),_:3})]))}},U={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(c){return(d,v)=>(i(),S(k(Y),se({href:c.href,method:c.method,as:c.as},d.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:n(()=>[P(d.$slots,"default")]),_:3},16,["href","method","as"]))}},q={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(c){const d=c,v=T(()=>d.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(h,b)=>(i(),S(k(Y),{href:c.href,class:I(v.value)},{default:n(()=>[P(h.$slots,"default")]),_:3},8,["href","class"]))}},D={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(c){const d=c,v=T(()=>d.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(h,b)=>(i(),S(k(Y),se({href:c.href,method:c.method,as:c.as},h.$attrs,{class:v.value}),{default:n(()=>[P(h.$slots,"default")]),_:3},16,["href","method","as","class"]))}},_e={class:"p-4 flex items-start"},we={class:"flex-shrink-0"},xe=["d"],ke={class:"ml-3 w-0 flex-1 pt-0.5"},Se={class:"text-sm font-medium"},$e={__name:"Notification",props:{type:{type:String,default:"info",validator:c=>["success","error","info","warning"].includes(c)},message:{type:String,required:!0},duration:{type:Number,default:5e3},id:{type:String,required:!0}},emits:["close"],setup(c,{emit:d}){const v=c,h=d,b=A(!1),o=A(null),u=T(()=>{switch(v.type){case"success":return"bg-green-50 text-green-800 border-green-400";case"error":return"bg-red-50 text-red-800 border-red-400";case"warning":return"bg-yellow-50 text-yellow-800 border-yellow-400";default:return"bg-blue-50 text-blue-800 border-blue-400"}}),l=T(()=>{switch(v.type){case"success":return"text-green-500";case"error":return"text-red-500";case"warning":return"text-yellow-500";default:return"text-blue-500"}}),y=T(()=>{switch(v.type){case"success":return"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z";case"error":return"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z";case"warning":return"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z";default:return"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}),E=()=>{b.value=!1,o.value&&clearTimeout(o.value),setTimeout(()=>{h("close",v.id)},300)};return F(()=>{setTimeout(()=>{b.value=!0},100),v.duration>0&&(o.value=setTimeout(()=>{E()},v.duration))}),($,z)=>(i(),w("div",{class:I(["fixed z-50 transition-all duration-300 ease-in-out transform",[b.value?"opacity-100 translate-y-0":"opacity-0 translate-y-2","max-w-sm w-full shadow-lg rounded-lg pointer-events-auto border-l-4",u.value]]),role:"alert"},[s("div",_e,[s("div",we,[(i(),w("svg",{class:I(["h-5 w-5",l.value]),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:y.value,"clip-rule":"evenodd"},null,8,xe)],2))]),s("div",ke,[s("p",Se,L(c.message),1)]),s("div",{class:"ml-4 flex-shrink-0 flex"},[s("button",{class:"bg-transparent rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:E},z[0]||(z[0]=[s("span",{class:"sr-only"},"Close",-1),s("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])],2))}},Ae={class:"fixed top-4 right-4 z-50 space-y-4 w-full max-w-sm"},Ce={__name:"NotificationContainer",setup(c,{expose:d}){const v=A([]),h=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),b=(u,l="info",y=5e3)=>{const E=h();return v.value.push({id:E,message:u,type:l,duration:y}),E},o=u=>{const l=v.value.findIndex(y=>y.id===u);l!==-1&&v.value.splice(l,1)};return d({addNotification:b,removeNotification:o,success:(u,l)=>b(u,"success",l),error:(u,l)=>b(u,"error",l),info:(u,l)=>b(u,"info",l),warning:(u,l)=>b(u,"warning",l)}),(u,l)=>(i(),w("div",Ae,[g(ue,{name:"notification"},{default:n(()=>[(i(!0),w(X,null,K(v.value,y=>(i(),S($e,{key:y.id,id:y.id,type:y.type,message:y.message,duration:y.duration,onClose:o},null,8,["id","type","message","duration"]))),128))]),_:1})]))}},De=he(Ce,[["__scopeId","data-v-24b5eed3"]]),Ee={class:"p-6"},Me={class:"mt-6"},Te={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},Ie={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Le={class:"flex items-center mb-3"},Ne=["id","onUpdate:modelValue"],ze=["for"],Be={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},Ue={key:0},Ve={class:"mb-4"},We={class:"flex items-center"},Pe=["id","checked","onChange"],Re=["for"],He={key:0,class:"mb-4"},qe=["id","onUpdate:modelValue"],Fe={key:1,class:"mb-4"},Ge={class:"flex-1"},Ye=["id","onUpdate:modelValue"],Je={class:"flex-1"},Xe=["id","onUpdate:modelValue"],Ke={key:0,class:"flex items-end pb-1"},Qe=["onClick"],Ze=["onClick"],je={class:"mt-6 flex justify-end space-x-3"},Oe={key:0,class:"flex items-center"},et={key:1},tt={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const c=new Date;return c.setDate(c.getDate()+1),c.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(c,{emit:d}){const v=()=>{const e=localStorage.getItem("authToken");e&&!N.defaults.headers.common.Authorization&&(N.defaults.headers.common.Authorization=`Bearer ${e}`,console.log("Auth headers set in AvailabilityModal"))},h=c,b=d,o=A({}),u=A({}),l=A(!1),y=A(""),E=()=>{const e=[],r=new Date,a=new Date(r);a.setDate(r.getDate()+1);for(let x=0;x<7;x++){const m=new Date(a);m.setDate(a.getDate()+x);const p=m.toISOString().split("T")[0];e.push({value:p,label:m.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),o.value[p]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return e},$=A([]);F(()=>{v(),h.nextWeekDates.length>0?($.value=h.nextWeekDates,h.nextWeekDates.forEach(e=>{o.value[e.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):$.value=E()});const z=async()=>{try{if(v(),$.value.length===0)return;const e=$.value[0].value,r=$.value[$.value.length-1].value,a=await N.get("/api/availabilities",{params:{start_date:e,end_date:r,user_id:h.userId}});if(a.data&&a.data.availabilities){const x=a.data.availabilities;$.value.forEach(m=>{o.value[m.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),x.forEach(m=>{const p=m.date.split("T")[0];o.value[p]&&(o.value[p].isSelected=!0,o.value[p].isAvailable=m.is_available,m.is_available?o.value[p].timeSlots=m.time_slots&&m.time_slots.length>0?[...m.time_slots]:[{start_time:"",end_time:""}]:o.value[p].reason=m.reason||"")})}}catch(e){console.error("Error fetching existing availabilities:",e),$.value.forEach(r=>{o.value[r.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};ce(()=>h.show,async e=>{e&&(u.value={},y.value="",await z())},{immediate:!0});const V=e=>{o.value[e].timeSlots.push({start_time:"",end_time:""})},W=(e,r)=>{o.value[e].timeSlots.length>1&&o.value[e].timeSlots.splice(r,1)},B=(e,r)=>{o.value[e].isAvailable=r,r?o.value[e].reason="":o.value[e].timeSlots=[{start_time:"",end_time:""}]},t=async()=>{l.value=!0,u.value={},y.value="";const e=[];let r=!1;for(const a of $.value){const x=a.value,m=o.value[x];if(m.isSelected){let p={};if(m.isAvailable)if(m.timeSlots.some(C=>!C.start_time||!C.end_time))p.timeSlots="Please fill in all time slots.",r=!0;else for(const C of m.timeSlots){const M=C.start_time.split(":").map(Number),H=C.end_time.split(":").map(Number);if(M.length!==2||H.length!==2||isNaN(M[0])||isNaN(M[1])||isNaN(H[0])||isNaN(H[1])){p.timeSlots="Invalid time format. Please use HH:MM format.",r=!0;break}const ie=M[0]*60+M[1],le=H[0]*60+H[1];if(ie>=le){p.timeSlots="End time must be after start time.",r=!0;break}}else m.reason.trim()||(p.reason="Please provide a reason for unavailability.",r=!0);Object.keys(p).length>0&&(u.value[x]=p),Object.keys(p).length===0&&e.push({date:x,is_available:m.isAvailable,reason:m.isAvailable?null:m.reason,time_slots:m.isAvailable?m.timeSlots:null})}}if(r){l.value=!1,u.value.general="Please correct the errors in the highlighted dates.";return}if(e.length===0){u.value.general="Please select at least one day to set availability for.",l.value=!1;return}try{v();const a=await N.post("/api/availabilities/batch",{availabilities:e});y.value="Availability saved successfully!";try{const x=await N.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",x.data.should_block_user),localStorage.setItem("allWeekdaysCovered",x.data.all_weekdays_covered);const m=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:x.data.should_block_user,allWeekdaysCovered:x.data.all_weekdays_covered}});window.dispatchEvent(m),console.log("Availability status updated from modal:",{shouldBlockUser:x.data.should_block_user,allWeekdaysCovered:x.data.all_weekdays_covered})}catch(x){console.error("Error updating availability status:",x)}b("availability-saved",a.data.availabilities),setTimeout(()=>{b("close")},1500)}catch(a){console.error("Error saving availability:",a),a.response&&a.response.data&&a.response.data.errors?u.value.general=a.response.data.message||"An error occurred while saving your availability.":a.response&&a.response.status===409?(y.value=a.response.data.message,setTimeout(()=>{b("close")},1500)):u.value.general="An unexpected error occurred while saving your availability."}finally{l.value=!1}};return(e,r)=>(i(),S(ye,{show:c.show,onClose:r[1]||(r[1]=a=>e.$emit("close")),"max-width":"xl"},{default:n(()=>[s("div",Ee,[r[6]||(r[6]=s("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),r[7]||(r[7]=s("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),s("div",Me,[s("form",{onSubmit:ve(t,["prevent"])},[y.value?(i(),w("div",Te,L(y.value),1)):_("",!0),u.value.general?(i(),w("div",Ie,L(u.value.general),1)):_("",!0),(i(!0),w(X,null,K($.value,a=>{var x,m;return i(),w("div",{key:a.value,class:I(["mb-6 p-4 border rounded-lg shadow-sm",[o.value[a.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",o.value[a.value].isSelected&&!u.value[a.value]?"border-l-4 border-l-indigo-500":""]])},[s("div",Le,[R(s("input",{type:"checkbox",id:`select_date_${a.value}`,"onUpdate:modelValue":p=>o.value[a.value].isSelected=p,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,Ne),[[me,o.value[a.value].isSelected]]),s("label",{for:`select_date_${a.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[f(L(a.label)+" ",1),o.value[a.value].isSelected?(i(),w("span",Be," Saved ")):_("",!0)],8,ze)]),o.value[a.value].isSelected?(i(),w("div",Ue,[s("div",Ve,[s("div",We,[s("input",{type:"checkbox",id:`isAvailableToggle_${a.value}`,checked:o.value[a.value].isAvailable,onChange:p=>B(a.value,p.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,Pe),s("label",{for:`isAvailableToggle_${a.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,Re)])]),o.value[a.value].isAvailable?_("",!0):(i(),w("div",He,[g(G,{for:`reason_${a.value}`,value:"Reason for Not Available"},null,8,["for"]),R(s("textarea",{id:`reason_${a.value}`,"onUpdate:modelValue":p=>o.value[a.value].reason=p,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,qe),[[J,o.value[a.value].reason]]),g(O,{message:(x=u.value[a.value])==null?void 0:x.reason,class:"mt-2"},null,8,["message"])])),o.value[a.value].isAvailable?(i(),w("div",Fe,[g(G,{value:"Available Time Slots"}),g(O,{message:(m=u.value[a.value])==null?void 0:m.timeSlots,class:"mt-2"},null,8,["message"]),(i(!0),w(X,null,K(o.value[a.value].timeSlots,(p,C)=>(i(),w("div",{key:C,class:"flex items-center space-x-2 mt-2"},[s("div",Ge,[g(G,{for:`start_time_${a.value}_${C}`,value:"Start Time",class:"text-xs"},null,8,["for"]),R(s("input",{id:`start_time_${a.value}_${C}`,type:"time","onUpdate:modelValue":M=>p.start_time=M,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Ye),[[J,p.start_time]])]),s("div",Je,[g(G,{for:`end_time_${a.value}_${C}`,value:"End Time",class:"text-xs"},null,8,["for"]),R(s("input",{id:`end_time_${a.value}_${C}`,type:"time","onUpdate:modelValue":M=>p.end_time=M,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Xe),[[J,p.end_time]])]),o.value[a.value].timeSlots.length>1?(i(),w("div",Ke,[s("button",{type:"button",onClick:M=>W(a.value,C),class:"p-2 text-red-600 hover:text-red-800"},r[2]||(r[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,Qe)])):_("",!0)]))),128)),s("button",{type:"button",onClick:p=>V(a.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},r[3]||(r[3]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),f(" Add Another Time Slot ",-1)]),8,Ze)])):_("",!0)])):_("",!0)],2)}),128)),s("div",je,[g(pe,{onClick:r[0]||(r[0]=a=>e.$emit("close"))},{default:n(()=>r[4]||(r[4]=[f(" Cancel ",-1)])),_:1,__:[4]}),g(oe,{disabled:l.value,class:I({"opacity-50":l.value})},{default:n(()=>[l.value?(i(),w("span",Oe,r[5]||(r[5]=[s("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),f(" Saving... ",-1)]))):(i(),w("span",et,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},st={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},at={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},ot={class:"flex justify-center"},rt={__name:"AvailabilityBlocker",setup(c){const d=A(!1),v=A(!0),h=A(!1),b=A([]),o=T(()=>{var t;return((t=ae().props.auth.user)==null?void 0:t.id)||null}),u=()=>{const t=localStorage.getItem("authToken");t&&!N.defaults.headers.common.Authorization&&(N.defaults.headers.common.Authorization=`Bearer ${t}`)},l=async()=>{v.value=!0;const t=localStorage.getItem("shouldBlockUser"),e=localStorage.getItem("allWeekdaysCovered");if(t==="true"&&e==="false")d.value=!0,await y();else try{u();const r=await N.get("/api/availability-prompt");d.value=r.data.should_block_user&&!r.data.all_weekdays_covered,d.value&&await y()}catch(r){console.error("Error checking if user should be blocked:",r),d.value=!1}v.value=!1},y=async()=>{try{u();const t=await N.get("/api/availability-prompt");E(t.data.next_week_start,t.data.next_week_end)}catch(t){console.error("Error fetching next week dates:",t)}},E=(t,e)=>{const r=[],a=new Date(t),x=new Date(e),m=new Date(a);for(;m<=x;)r.push({value:m.toISOString().split("T")[0],label:m.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),m.setDate(m.getDate()+1);b.value=r},$=()=>{h.value=!0},z=()=>{l()},V=t=>{d.value=t.detail.shouldBlockUser&&!t.detail.allWeekdaysCovered},W=()=>{document.visibilityState==="visible"&&j(()=>{l()})},B=t=>{(t.key==="shouldBlockUser"||t.key==="allWeekdaysCovered")&&j(()=>{l()})};return F(()=>{l(),window.addEventListener("availability-status-updated",V),document.addEventListener("visibilitychange",W),window.addEventListener("storage",B)}),te(()=>{window.removeEventListener("availability-status-updated",V),document.removeEventListener("visibilitychange",W),window.removeEventListener("storage",B)}),(t,e)=>d.value&&!v.value?(i(),w("div",st,[s("div",at,[e[2]||(e[2]=fe('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),s("div",ot,[g(oe,{onClick:$,class:"bg-red-600 hover:bg-red-700"},{default:n(()=>e[1]||(e[1]=[f(" Submit Availability Now ",-1)])),_:1,__:[1]})]),g(tt,{show:h.value,"next-week-dates":b.value,date:b.value.length>0?b.value[0].value:"",userId:o.value,onClose:e[0]||(e[0]=r=>h.value=!1),onAvailabilitySaved:z},null,8,["show","next-week-dates","date","userId"])])])):_("",!0)}};let Q=null;const it=c=>{Q=c},re=(c,d="info",v=5e3)=>Q?Q.addNotification(c,d,v):(console.warn("Notification container not set. Call setNotificationContainer first."),null),Ut=(c,d=5e3)=>re(c,"success",d),Vt=(c,d=5e3)=>re(c,"error",d),lt={class:"min-h-screen bg-gray-100"},nt={class:"border-b border-gray-100 bg-white"},dt={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},ut={class:"flex h-16 justify-between"},ct={class:"flex"},vt={class:"flex shrink-0 items-center"},mt={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},ft={key:4,class:"hidden sm:flex sm:items-center"},gt={class:"hidden sm:ms-6 sm:flex sm:items-center"},ht={class:"relative ms-3"},pt={class:"inline-flex rounded-md"},yt={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},bt={class:"-me-2 flex items-center sm:hidden"},_t={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},wt={class:"space-y-1 pb-3 pt-2"},xt={key:6,class:"mt-3 space-y-1"},kt={class:"border-t border-gray-200 pb-1 pt-4"},St={class:"px-4"},$t={class:"text-base font-medium text-gray-800"},At={class:"text-sm font-medium text-gray-500"},Ct={class:"text-sm font-medium text-gray-500 capitalize"},Dt={class:"mt-3 space-y-1"},Et={key:0,class:"bg-white shadow"},Mt={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},Wt={__name:"AuthenticatedLayout",setup(c){const d=A(!1),v=T(()=>ae().props.auth.user);T(()=>{var t;return((t=v.value.role_data)==null?void 0:t.name)||""});const{canDo:h}=ge(),b=h("manage_projects"),o=h("compose_emails"),u=h("approve_emails"),l=h("create_users"),y=h("manage_roles"),E=h("manage_task_types"),$=h("create_clients"),z=async()=>{const t=localStorage.getItem("authToken");if(t){window.axios.defaults.headers.common.Authorization=`Bearer ${t}`;try{await window.axios.get("/api/user")}catch(e){e.response&&e.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},V=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization},W=t=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},B=A(null);return F(()=>{z(),B.value&&it(B.value)}),(t,e)=>{var r;return i(),w("div",null,[g(De,{ref_key:"notificationContainerRef",ref:B},null,512),g(rt),s("div",lt,[s("nav",nt,[s("div",dt,[s("div",ut,[s("div",ct,[s("div",vt,[g(k(Y),{href:t.route("dashboard")},{default:n(()=>[g(ne,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),s("div",mt,[g(q,{href:t.route("dashboard"),active:t.route().current("dashboard")},{default:n(()=>e[1]||(e[1]=[f(" Dashboard ",-1)])),_:1,__:[1]},8,["href","active"]),k(b)?(i(),S(q,{key:0,href:t.route("projects.index"),active:t.route().current("projects.index")},{default:n(()=>e[2]||(e[2]=[f(" Projects ",-1)])),_:1,__:[2]},8,["href","active"])):_("",!0),k(u)?(i(),S(q,{key:1,href:t.route("emails.pending"),active:t.route().current("emails.pending")},{default:n(()=>e[3]||(e[3]=[f(" Approve Emails ",-1)])),_:1,__:[3]},8,["href","active"])):_("",!0),k(o)?(i(),S(q,{key:2,href:t.route("emails.rejected"),active:t.route().current("emails.rejected")},{default:n(()=>e[4]||(e[4]=[f(" Rejected Emails ",-1)])),_:1,__:[4]},8,["href","active"])):_("",!0),k(l)?(i(),S(q,{key:3,href:t.route("availability.index"),active:t.route().current("availability.index")},{default:n(()=>e[5]||(e[5]=[f(" Weekly Availability ",-1)])),_:1,__:[5]},8,["href","active"])):_("",!0),k(y)?(i(),w("div",ft,[g(ee,{align:"right",width:"48"},{trigger:n(()=>e[6]||(e[6]=[s("span",{class:"inline-flex rounded-md"},[s("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},[f(" Admin "),s("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:n(()=>[k($)?(i(),S(U,{key:0,href:t.route("clients.index"),active:t.route().current("clients.index")},{default:n(()=>e[7]||(e[7]=[f(" Clients ",-1)])),_:1,__:[7]},8,["href","active"])):_("",!0),k(l)?(i(),S(U,{key:1,href:t.route("users.index"),active:t.route().current("users.index")},{default:n(()=>e[8]||(e[8]=[f(" Users ",-1)])),_:1,__:[8]},8,["href","active"])):_("",!0),k(E)?(i(),S(U,{key:2,href:t.route("task-types.index"),active:t.route().current("task-types.index")},{default:n(()=>e[9]||(e[9]=[f(" Task Types ",-1)])),_:1,__:[9]},8,["href","active"])):_("",!0),g(U,{href:t.route("bonus-configuration.index"),active:t.route().current("bonus-configuration.index")},{default:n(()=>e[10]||(e[10]=[f(" Bonus Configuration ",-1)])),_:1,__:[10]},8,["href","active"]),g(U,{href:t.route("admin.roles.index")},{default:n(()=>e[11]||(e[11]=[f(" Manage Roles ",-1)])),_:1,__:[11]},8,["href"]),g(U,{href:t.route("admin.permissions.index")},{default:n(()=>e[12]||(e[12]=[f(" Manage Permissions ",-1)])),_:1,__:[12]},8,["href"])]),_:1})])):_("",!0)])]),s("div",gt,[s("div",ht,[g(ee,{align:"right",width:"48"},{trigger:n(()=>{var a;return[s("span",pt,[s("button",yt,[f(L(v.value.name)+" ("+L((a=v.value.role_data)==null?void 0:a.name)+") ",1),e[13]||(e[13]=s("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:n(()=>[g(U,{href:t.route("profile.edit")},{default:n(()=>e[14]||(e[14]=[f(" Profile ",-1)])),_:1,__:[14]},8,["href"]),g(U,{href:t.route("logout"),method:"post",as:"button",onSuccess:V,onError:W},{default:n(()=>e[15]||(e[15]=[f(" Log Out ",-1)])),_:1,__:[15]},8,["href"])]),_:1})])]),s("div",bt,[s("button",{onClick:e[0]||(e[0]=a=>d.value=!d.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(i(),w("svg",_t,[s("path",{class:I({hidden:d.value,"inline-flex":!d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),s("path",{class:I({hidden:!d.value,"inline-flex":d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])]),s("div",{class:I([{block:d.value,hidden:!d.value},"sm:hidden"])},[s("div",wt,[g(D,{href:t.route("dashboard"),active:t.route().current("dashboard")},{default:n(()=>e[16]||(e[16]=[f(" Dashboard ",-1)])),_:1,__:[16]},8,["href","active"]),k($)?(i(),S(D,{key:0,href:t.route("clients.index"),active:t.route().current("clients.index")},{default:n(()=>e[17]||(e[17]=[f(" Clients ",-1)])),_:1,__:[17]},8,["href","active"])):_("",!0),k(b)?(i(),S(D,{key:1,href:t.route("projects.index"),active:t.route().current("projects.index")},{default:n(()=>e[18]||(e[18]=[f(" Projects ",-1)])),_:1,__:[18]},8,["href","active"])):_("",!0),k(l)?(i(),S(D,{key:2,href:t.route("users.index"),active:t.route().current("users.index")},{default:n(()=>e[19]||(e[19]=[f(" Users ",-1)])),_:1,__:[19]},8,["href","active"])):_("",!0),k(o)?(i(),S(D,{key:3,href:t.route("emails.compose"),active:t.route().current("emails.compose")},{default:n(()=>e[20]||(e[20]=[f(" Compose Email ",-1)])),_:1,__:[20]},8,["href","active"])):_("",!0),k(u)?(i(),S(D,{key:4,href:t.route("emails.pending"),active:t.route().current("emails.pending")},{default:n(()=>e[21]||(e[21]=[f(" Approve Emails ",-1)])),_:1,__:[21]},8,["href","active"])):_("",!0),k(o)?(i(),S(D,{key:5,href:t.route("emails.rejected"),active:t.route().current("emails.rejected")},{default:n(()=>e[22]||(e[22]=[f(" Rejected Emails ",-1)])),_:1,__:[22]},8,["href","active"])):_("",!0),g(D,{href:t.route("availability.index"),active:t.route().current("availability.index")},{default:n(()=>e[23]||(e[23]=[f(" Weekly Availability ",-1)])),_:1,__:[23]},8,["href","active"]),k(y)?(i(),w("div",xt,[e[26]||(e[26]=s("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),g(D,{href:t.route("admin.roles.index"),active:t.route().current("admin.roles.index")},{default:n(()=>e[24]||(e[24]=[f(" Manage Roles ",-1)])),_:1,__:[24]},8,["href","active"]),g(D,{href:t.route("admin.permissions.index"),active:t.route().current("admin.permissions.index")},{default:n(()=>e[25]||(e[25]=[f(" Manage Permissions ",-1)])),_:1,__:[25]},8,["href","active"])])):_("",!0)]),s("div",kt,[s("div",St,[s("div",$t,L(v.value.name),1),s("div",At,L(v.value.email),1),s("div",Ct,L((r=v.value.role_data)==null?void 0:r.name),1)]),s("div",Dt,[g(D,{href:t.route("profile.edit")},{default:n(()=>e[27]||(e[27]=[f(" Profile ",-1)])),_:1,__:[27]},8,["href"]),g(D,{href:t.route("logout"),method:"post",as:"button",onSuccess:V,onError:W},{default:n(()=>e[28]||(e[28]=[f(" Log Out ",-1)])),_:1,__:[28]},8,["href"])])])],2)]),t.$slots.header?(i(),w("header",Et,[s("div",Mt,[P(t.$slots,"header")])])):_("",!0),s("main",null,[P(t.$slots,"default")])])])}}};export{Wt as _,tt as a,Vt as e,Ut as s};
