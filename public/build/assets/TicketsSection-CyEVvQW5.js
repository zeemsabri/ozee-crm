import A from"./TicketNotesSidebar-DRWymb-a.js";import N from"./CreateTaskModal-CGRYyWKy.js";import{_ as S,r,E as C,B as I,i as a,o as n,b as e,e as m,t as d,F as z,j as M,n as O}from"./app-DcG5Qsxo.js";const B={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)] relative"},D={key:0,class:"text-center text-gray-600 py-8"},E={key:1,class:"text-center text-red-600 py-8"},V={key:2,class:"text-center text-gray-500 py-8"},F={key:3,class:"overflow-x-auto"},H={class:"min-w-full bg-white border border-gray-200 rounded-lg"},L={class:"text-gray-700 text-sm font-light"},$={class:"py-3 px-6 text-left whitespace-nowrap"},U={class:"py-3 px-6 text-left"},q={class:"py-3 px-6 text-left"},G={class:"py-3 px-6 text-left"},J={class:"py-3 px-6 text-center"},K={class:"flex item-center justify-center"},P=["onClick"],Q={__name:"TicketsSection",props:{initialAuthToken:{type:String,required:!0},projectId:{type:[String,Number],required:!0}},emits:["add-activity"],setup(i,{emit:b}){const x=i,v=b,u=r(!0),c=r([]),l=r(null),g=r(null),p=r(!1),h=r(!1),{showModal:k}=C("modalService"),f=async()=>{u.value=!0,l.value=null;try{const o=await fetch(`/api/client-api/project/${x.projectId}/tasks`,{headers:{Authorization:`Bearer ${x.initialAuthToken}`,"Content-Type":"application/json",Accept:"application/json"}}),s=await o.json();if(!o.ok){const t=s.errors?Object.values(s.errors).flat().join(`
`):s.message||"Failed to fetch tasks.";throw new Error(t)}c.value=s}catch(o){console.error("Error fetching tasks:",o),l.value=o.message||"An unexpected error occurred while fetching tasks.",k("Error",l.value,"alert")}finally{u.value=!1}},w=o=>{g.value=o,p.value=!0},_=()=>{f(),v("add-activity","A new note was added to a task.")},T=()=>{h.value=!0},j=o=>{c.value.unshift(o),v("add-activity",`New task "${o.title}" created.`)};return I(()=>{f()}),(o,s)=>(n(),a("div",B,[e("div",{class:"flex justify-between items-center mb-6"},[s[2]||(s[2]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Tickets",-1)),e("button",{onClick:T,class:"bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 transition-colors shadow-md"}," Add New Ticket ")]),u.value?(n(),a("div",D,"Loading tasks...")):l.value?(n(),a("div",E,d(l.value),1)):c.value.length===0?(n(),a("div",V,"No tasks found for this project.")):(n(),a("div",F,[e("table",H,[s[4]||(s[4]=e("thead",null,[e("tr",{class:"bg-gray-100 text-gray-600 uppercase text-sm leading-normal"},[e("th",{class:"py-3 px-6 text-left"},"Title"),e("th",{class:"py-3 px-6 text-left"},"Description"),e("th",{class:"py-3 px-6 text-left"},"Status"),e("th",{class:"py-3 px-6 text-left"},"Due Date"),e("th",{class:"py-3 px-6 text-center"},"Actions")])],-1)),e("tbody",L,[(n(!0),a(z,null,M(c.value,t=>(n(),a("tr",{key:t.id,class:"border-b border-gray-200 hover:bg-gray-50"},[e("td",$,d(t.name),1),e("td",U,d(t.description),1),e("td",q,[e("span",{class:O({"px-3 py-1 rounded-full text-xs font-semibold":!0,"bg-green-200 text-green-800":t.status==="completed","bg-yellow-200 text-yellow-800":t.status==="pending","bg-blue-200 text-blue-800":t.status==="in_progress","bg-red-200 text-red-800":t.status==="blocked"})},d(t.status.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase())),3)]),e("td",G,d(t.due_date?new Date(t.due_date).toLocaleDateString():"N/A"),1),e("td",J,[e("div",K,[e("button",{onClick:y=>w(t),class:"w-8 h-8 rounded-full bg-blue-500 hover:bg-blue-600 text-white flex items-center justify-center text-xs font-bold transition-colors shadow-md mr-2",title:"View Notes"},s[3]||(s[3]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 2v2h8V6H6zm0 4v2h4v-2H6zm0 4v2h4v-2H6zm5-4v6h3v-6h-3z"})],-1)]),8,P)])])]))),128))])])])),m(A,{isOpen:p.value,"onUpdate:isOpen":s[0]||(s[0]=t=>p.value=t),"note-for":"tasks","selected-item":g.value,initialAuthToken:i.initialAuthToken,projectId:i.projectId,onNoteAddedSuccess:_},null,8,["isOpen","selected-item","initialAuthToken","projectId"]),m(N,{isOpen:h.value,"onUpdate:isOpen":s[1]||(s[1]=t=>h.value=t),initialAuthToken:i.initialAuthToken,projectId:i.projectId,onTaskCreatedSuccess:j},null,8,["isOpen","initialAuthToken","projectId"])]))}},Y=S(Q,[["__scopeId","data-v-3eae519e"]]);export{Y as default};
