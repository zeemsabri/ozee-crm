import{A as ge}from"./ApplicationLogo-CKogwxzA.js";import{B as ee,I as le,s as B,r as A,i as v,o as r,b as s,f as U,e as f,A as Q,J as q,a as p,n as E,T as pe,c as I,K as ce,h as P,l as K,w as G,d as re,g as k,t as D,F as H,j as F,q as ye,m as w,k as X,x as Y,L as se,M as he,H as ae,_ as ie,D as be,z as we,N as ke,O as xe,p as _e}from"./app-Cq-9Sd9S.js";import{P as te}from"./PrimaryButton-BBqXbcCF.js";import{a as ve,_ as me}from"./SecondaryButton-DWQoqzNC.js";import{_ as N,b as W,a as de}from"./InputError-Dde0kbHd.js";let oe=null;const $e=i=>{oe=i},ne=(i,h="info",u=5e3)=>oe?oe.addNotification(i,h,u):(console.warn("Notification container not set. Call setNotificationContainer first."),null),Se=(i,h=5e3)=>ne(i,"success",h),Ce=(i,h=5e3)=>ne(i,"error",h),Us=(i,h=5e3)=>ne(i,"warning",h),Ae={class:"relative"},ue={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(i){const h=i,u=d=>{n.value&&d.key==="Escape"&&(n.value=!1)};ee(()=>document.addEventListener("keydown",u)),le(()=>document.removeEventListener("keydown",u));const b=B(()=>({48:"w-48"})[h.width.toString()]),c=B(()=>h.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":h.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),n=A(!1);return(d,x)=>(r(),v("div",Ae,[s("div",{onClick:x[0]||(x[0]=j=>n.value=!n.value)},[Q(d.$slots,"trigger")]),U(s("div",{class:"fixed inset-0 z-40",onClick:x[1]||(x[1]=j=>n.value=!1)},null,512),[[q,n.value]]),f(pe,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:p(()=>[U(s("div",{class:E(["absolute z-50 mt-2 rounded-md shadow-lg",[b.value,c.value]]),style:{display:"none"},onClick:x[2]||(x[2]=j=>n.value=!1)},[s("div",{class:E(["rounded-md ring-1 ring-black ring-opacity-5",i.contentClasses])},[Q(d.$slots,"content")],2)],2),[[q,n.value]])]),_:3})]))}},J={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(i){return(h,u)=>(r(),I(P(K),ce({href:i.href,method:i.method,as:i.as},h.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:p(()=>[Q(h.$slots,"default")]),_:3},16,["href","method","as"]))}},Z={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(i){const h=i,u=B(()=>h.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(b,c)=>(r(),I(P(K),{href:i.href,class:E(u.value)},{default:p(()=>[Q(b.$slots,"default")]),_:3},8,["href","class"]))}},z={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(i){const h=i,u=B(()=>h.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(b,c)=>(r(),I(P(K),ce({href:i.href,method:i.method,as:i.as},b.$attrs,{class:u.value}),{default:p(()=>[Q(b.$slots,"default")]),_:3},16,["href","method","as","class"]))}},je={class:"p-6"},Te={class:"mt-6"},Ee={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},Pe={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Ie={class:"flex items-center mb-3"},Me=["id","onUpdate:modelValue"],De=["for"],Be={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},Ve={key:0},Le={class:"mb-4"},Ue={class:"flex items-center"},ze=["id","checked","onChange"],Ne=["for"],Re={key:0,class:"mb-4"},We=["id","onUpdate:modelValue"],He={key:1,class:"mb-4"},Fe={class:"flex-1"},qe=["id","onUpdate:modelValue"],Ke={class:"flex-1"},Ye=["id","onUpdate:modelValue"],Je={key:0,class:"flex items-end pb-1"},Qe=["onClick"],Ge=["onClick"],Xe={class:"mt-6 flex justify-end space-x-3"},Ze={key:0,class:"flex items-center"},Oe={key:1},et={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const i=new Date;return i.setDate(i.getDate()+1),i.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(i,{emit:h}){const u=()=>{const m=localStorage.getItem("authToken");m&&!Y.defaults.headers.common.Authorization&&(Y.defaults.headers.common.Authorization=`Bearer ${m}`,console.log("Auth headers set in AvailabilityModal"))},b=i,c=h,n=A({}),d=A({}),x=A(!1),j=A(""),_=()=>{const m=[],g=new Date,a=new Date(g);a.setDate(g.getDate()+1);for(let o=0;o<7;o++){const l=new Date(a);l.setDate(a.getDate()+o);const t=l.toISOString().split("T")[0];m.push({value:t,label:l.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),n.value[t]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return m},$=A([]);ee(()=>{u(),b.nextWeekDates.length>0?($.value=b.nextWeekDates,b.nextWeekDates.forEach(m=>{n.value[m.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):$.value=_()});const M=async()=>{try{if(u(),$.value.length===0)return;const m=$.value[0].value,g=$.value[$.value.length-1].value,a=await Y.get("/api/availabilities",{params:{start_date:m,end_date:g,user_id:b.userId}});if(a.data&&a.data.availabilities){const o=a.data.availabilities;$.value.forEach(l=>{n.value[l.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),o.forEach(l=>{const t=l.date.split("T")[0];n.value[t]&&(n.value[t].isSelected=!0,n.value[t].isAvailable=l.is_available,l.is_available?n.value[t].timeSlots=l.time_slots&&l.time_slots.length>0?[...l.time_slots]:[{start_time:"",end_time:""}]:n.value[t].reason=l.reason||"")})}}catch(m){console.error("Error fetching existing availabilities:",m),$.value.forEach(g=>{n.value[g.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};G(()=>b.show,async m=>{m&&(d.value={},j.value="",await M())},{immediate:!0});const V=m=>{n.value[m].timeSlots.push({start_time:"",end_time:""})},L=(m,g)=>{n.value[m].timeSlots.length>1&&n.value[m].timeSlots.splice(g,1)},T=(m,g)=>{n.value[m].isAvailable=g,g?n.value[m].reason="":n.value[m].timeSlots=[{start_time:"",end_time:""}]},y=async()=>{x.value=!0,d.value={},j.value="";const m=[];let g=!1;for(const a of $.value){const o=a.value,l=n.value[o];if(l.isSelected){let t={};if(l.isAvailable)if(l.timeSlots.some(e=>!e.start_time||!e.end_time))t.timeSlots="Please fill in all time slots.",g=!0;else for(const e of l.timeSlots){const S=e.start_time.split(":").map(Number),C=e.end_time.split(":").map(Number);if(S.length!==2||C.length!==2||isNaN(S[0])||isNaN(S[1])||isNaN(C[0])||isNaN(C[1])){t.timeSlots="Invalid time format. Please use HH:MM format.",g=!0;break}const R=S[0]*60+S[1],fe=C[0]*60+C[1];if(R>=fe){t.timeSlots="End time must be after start time.",g=!0;break}}else l.reason.trim()||(t.reason="Please provide a reason for unavailability.",g=!0);Object.keys(t).length>0&&(d.value[o]=t),Object.keys(t).length===0&&m.push({date:o,is_available:l.isAvailable,reason:l.isAvailable?null:l.reason,time_slots:l.isAvailable?l.timeSlots:null})}}if(g){x.value=!1,d.value.general="Please correct the errors in the highlighted dates.";return}if(m.length===0){d.value.general="Please select at least one day to set availability for.",x.value=!1;return}try{u();const a=await Y.post("/api/availabilities/batch",{availabilities:m});j.value="Availability saved successfully!";try{const o=await Y.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",o.data.should_block_user),localStorage.setItem("allWeekdaysCovered",o.data.all_weekdays_covered);const l=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:o.data.should_block_user,allWeekdaysCovered:o.data.all_weekdays_covered}});window.dispatchEvent(l),console.log("Availability status updated from modal:",{shouldBlockUser:o.data.should_block_user,allWeekdaysCovered:o.data.all_weekdays_covered})}catch(o){console.error("Error updating availability status:",o)}c("availability-saved",a.data.availabilities),setTimeout(()=>{c("close")},1500)}catch(a){console.error("Error saving availability:",a),a.response&&a.response.data&&a.response.data.errors?d.value.general=a.response.data.message||"An error occurred while saving your availability.":a.response&&a.response.status===409?(j.value=a.response.data.message,setTimeout(()=>{c("close")},1500)):d.value.general="An unexpected error occurred while saving your availability."}finally{x.value=!1}};return(m,g)=>(r(),I(me,{show:i.show,onClose:g[1]||(g[1]=a=>m.$emit("close")),"max-width":"xl"},{default:p(()=>[s("div",je,[g[6]||(g[6]=s("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),g[7]||(g[7]=s("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),s("div",Te,[s("form",{onSubmit:re(y,["prevent"])},[j.value?(r(),v("div",Ee,D(j.value),1)):k("",!0),d.value.general?(r(),v("div",Pe,D(d.value.general),1)):k("",!0),(r(!0),v(H,null,F($.value,a=>{var o,l;return r(),v("div",{key:a.value,class:E(["mb-6 p-4 border rounded-lg shadow-sm",[n.value[a.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",n.value[a.value].isSelected&&!d.value[a.value]?"border-l-4 border-l-indigo-500":""]])},[s("div",Ie,[U(s("input",{type:"checkbox",id:`select_date_${a.value}`,"onUpdate:modelValue":t=>n.value[a.value].isSelected=t,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,Me),[[ye,n.value[a.value].isSelected]]),s("label",{for:`select_date_${a.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[w(D(a.label)+" ",1),n.value[a.value].isSelected?(r(),v("span",Be," Saved ")):k("",!0)],8,De)]),n.value[a.value].isSelected?(r(),v("div",Ve,[s("div",Le,[s("div",Ue,[s("input",{type:"checkbox",id:`isAvailableToggle_${a.value}`,checked:n.value[a.value].isAvailable,onChange:t=>T(a.value,t.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,ze),s("label",{for:`isAvailableToggle_${a.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,Ne)])]),n.value[a.value].isAvailable?k("",!0):(r(),v("div",Re,[f(N,{for:`reason_${a.value}`,value:"Reason for Not Available"},null,8,["for"]),U(s("textarea",{id:`reason_${a.value}`,"onUpdate:modelValue":t=>n.value[a.value].reason=t,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,We),[[X,n.value[a.value].reason]]),f(W,{message:(o=d.value[a.value])==null?void 0:o.reason,class:"mt-2"},null,8,["message"])])),n.value[a.value].isAvailable?(r(),v("div",He,[f(N,{value:"Available Time Slots"}),f(W,{message:(l=d.value[a.value])==null?void 0:l.timeSlots,class:"mt-2"},null,8,["message"]),(r(!0),v(H,null,F(n.value[a.value].timeSlots,(t,e)=>(r(),v("div",{key:e,class:"flex items-center space-x-2 mt-2"},[s("div",Fe,[f(N,{for:`start_time_${a.value}_${e}`,value:"Start Time",class:"text-xs"},null,8,["for"]),U(s("input",{id:`start_time_${a.value}_${e}`,type:"time","onUpdate:modelValue":S=>t.start_time=S,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,qe),[[X,t.start_time]])]),s("div",Ke,[f(N,{for:`end_time_${a.value}_${e}`,value:"End Time",class:"text-xs"},null,8,["for"]),U(s("input",{id:`end_time_${a.value}_${e}`,type:"time","onUpdate:modelValue":S=>t.end_time=S,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Ye),[[X,t.end_time]])]),n.value[a.value].timeSlots.length>1?(r(),v("div",Je,[s("button",{type:"button",onClick:S=>L(a.value,e),class:"p-2 text-red-600 hover:text-red-800"},g[2]||(g[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,Qe)])):k("",!0)]))),128)),s("button",{type:"button",onClick:t=>V(a.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},g[3]||(g[3]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),w(" Add Another Time Slot ",-1)]),8,Ge)])):k("",!0)])):k("",!0)],2)}),128)),s("div",Xe,[f(ve,{onClick:g[0]||(g[0]=a=>m.$emit("close"))},{default:p(()=>g[4]||(g[4]=[w(" Cancel ",-1)])),_:1,__:[4]}),f(te,{disabled:x.value,class:E({"opacity-50":x.value})},{default:p(()=>[x.value?(r(),v("span",Ze,g[5]||(g[5]=[s("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),w(" Saving... ",-1)]))):(r(),v("span",Oe,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},tt={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},st={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},at={class:"flex justify-center"},ot={__name:"AvailabilityBlocker",setup(i){const h=A(!1),u=A(!0),b=A(!1),c=A([]),n=B(()=>{var y;return((y=se().props.auth.user)==null?void 0:y.id)||null}),d=()=>{const y=localStorage.getItem("authToken");y&&!Y.defaults.headers.common.Authorization&&(Y.defaults.headers.common.Authorization=`Bearer ${y}`)},x=async()=>{u.value=!0;const y=localStorage.getItem("shouldBlockUser"),m=localStorage.getItem("allWeekdaysCovered");if(y==="true"&&m==="false")h.value=!0,await j();else try{d();const g=await Y.get("/api/availability-prompt");h.value=g.data.should_block_user&&!g.data.all_weekdays_covered,h.value&&await j()}catch(g){console.error("Error checking if user should be blocked:",g),h.value=!1}u.value=!1},j=async()=>{try{d();const y=await Y.get("/api/availability-prompt");_(y.data.next_week_start,y.data.next_week_end)}catch(y){console.error("Error fetching next week dates:",y)}},_=(y,m)=>{const g=[],a=new Date(y),o=new Date(m),l=new Date(a);for(;l<=o;)g.push({value:l.toISOString().split("T")[0],label:l.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),l.setDate(l.getDate()+1);c.value=g},$=()=>{b.value=!0},M=()=>{x()},V=y=>{h.value=y.detail.shouldBlockUser&&!y.detail.allWeekdaysCovered},L=()=>{document.visibilityState==="visible"&&ae(()=>{x()})},T=y=>{(y.key==="shouldBlockUser"||y.key==="allWeekdaysCovered")&&ae(()=>{x()})};return ee(()=>{x(),window.addEventListener("availability-status-updated",V),document.addEventListener("visibilitychange",L),window.addEventListener("storage",T)}),le(()=>{window.removeEventListener("availability-status-updated",V),document.removeEventListener("visibilitychange",L),window.removeEventListener("storage",T)}),(y,m)=>h.value&&!u.value?(r(),v("div",tt,[s("div",st,[m[2]||(m[2]=he('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),s("div",at,[f(te,{onClick:$,class:"bg-red-600 hover:bg-red-700"},{default:p(()=>m[1]||(m[1]=[w(" Submit Availability Now ",-1)])),_:1,__:[1]})]),f(et,{show:b.value,"next-week-dates":c.value,date:c.value.length>0?c.value[0].value:"",userId:n.value,onClose:m[0]||(m[0]=g=>b.value=!1),onAvailabilitySaved:M},null,8,["show","next-week-dates","date","userId"])])])):k("",!0)}},lt={class:"p-6"},rt={class:"flex justify-between items-center mb-4"},it={class:"text-lg font-medium text-gray-900"},nt={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},dt={class:"block sm:inline"},ut={key:0,class:"mt-6 flex justify-end space-x-3"},ct={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:i=>["post","put","patch","delete"].includes(i.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:i=>i},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(i,{emit:h}){const u=i,b=h,c=A(!1),n=A({}),d=A("");G(()=>u.show,_=>{_&&(n.value={},d.value="",c.value=!1)});const x=async()=>{c.value=!0,n.value={},d.value="";try{const _=u.formatDataForApi(u.formData);console.log("BaseFormModal: Data being sent to API:",_);let $;const M=u.httpMethod.toLowerCase();if(M==="post")$=await window.axios.post(u.apiEndpoint,_);else if(M==="put")$=await window.axios.put(u.apiEndpoint,_);else if(M==="patch")$=await window.axios.patch(u.apiEndpoint,_);else if(M==="delete")$=await window.axios.delete(u.apiEndpoint,{data:_});else throw new Error(`Unsupported HTTP method: ${u.httpMethod}`);Se(u.successMessage),b("submitted",$.data),b("close")}catch(_){console.error("BaseFormModal: API submission error:",_),_.response?_.response.status===422?(n.value=_.response.data.errors,d.value="Please correct the errors in the form."):d.value=_.response.data.message||"An unexpected error occurred.":d.value="A network error occurred or the server is unreachable.",Ce(d.value),b("error",_)}finally{c.value=!1}},j=()=>{b("close")};return(_,$)=>(r(),I(me,{show:i.show,onClose:j},{default:p(()=>[s("div",lt,[s("div",rt,[s("h2",it,D(i.title),1),s("button",{onClick:j,class:"text-gray-400 hover:text-gray-500"},$[0]||($[0]=[s("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),d.value?(r(),v("div",nt,[s("span",dt,D(d.value),1)])):k("",!0),s("form",{onSubmit:re(x,["prevent"])},[Q(_.$slots,"default",{errors:n.value},void 0,!0),i.showFooter?(r(),v("div",ut,[f(ve,{onClick:j,type:"button",disabled:c.value},{default:p(()=>$[1]||($[1]=[w(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),f(te,{type:"submit",disabled:c.value,class:E({"opacity-75 cursor-not-allowed":c.value})},{default:p(()=>[w(D(c.value?"Submitting...":i.submitButtonText),1)]),_:1},8,["disabled","class"])])):k("",!0)],32)])]),_:3},8,["show"]))}},vt=ie(ct,[["__scopeId","data-v-a2f6d2f8"]]),mt=["disabled"],ft={class:"absolute z-50 mt-1 w-full rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"},gt={class:"p-2 border-b border-gray-200"},pt=["onClick"],yt={key:0,class:"block px-4 py-2 text-sm text-gray-500"},ht={__name:"SelectDropdown",props:{modelValue:{type:[String,Number,Object,null],default:null},options:{type:Array,default:()=>[]},placeholder:{type:String,default:"Select an option"},valueKey:{type:String,default:"value"},labelKey:{type:String,default:"label"},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},maxHeight:{type:String,default:"250px"},width:{type:String,default:"full"},labelClass:{type:String,default:"text-xs"}},emits:["update:modelValue","change"],setup(i,{emit:h}){const u=i,b=h,c=A(!1),n=A(""),d=A(null),x=A(null),j=B(()=>{if(!n.value)return u.options;const T=n.value.toLowerCase();return u.options.filter(y=>y[u.labelKey].toLowerCase().includes(T))}),_=T=>{d.value&&!d.value.contains(T.target)&&(c.value=!1,n.value="")},$=T=>{T.key==="Escape"&&c.value&&(c.value=!1,n.value="")};ee(()=>{document.addEventListener("click",_),document.addEventListener("keydown",$)}),le(()=>{document.removeEventListener("click",_),document.removeEventListener("keydown",$)});const M=B(()=>{if(u.modelValue===null||u.modelValue===void 0||u.modelValue==="")return u.placeholder;const T=u.options.find(y=>y[u.valueKey]===u.modelValue);return T?T[u.labelKey]:u.placeholder}),V=T=>{b("update:modelValue",T[u.valueKey]),b("change",T[u.valueKey]),c.value=!1,n.value=""},L=()=>{u.disabled||(c.value=!c.value,c.value&&ae(()=>{x.value&&x.value.focus()}))};return G(()=>u.modelValue,T=>{(T==null||T==="")&&(n.value="")}),(T,y)=>(r(),v("div",{ref_key:"dropdownRef",ref:d,class:E(["relative",{"w-full":i.width==="full"}])},[s("button",{type:"button",onClick:L,disabled:i.disabled,class:E(["border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full text-left px-3 py-2 text-gray-700 bg-white relative flex items-center justify-between",{"opacity-50 cursor-not-allowed":i.disabled}])},[s("span",{class:E({"text-gray-500":!u.modelValue})},D(M.value),3),y[3]||(y[3]=s("svg",{class:"h-4 w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))],10,mt),U(s("div",ft,[s("div",gt,[U(s("input",{ref_key:"searchInputRef",ref:x,type:"text","onUpdate:modelValue":y[0]||(y[0]=m=>n.value=m),onInput:y[1]||(y[1]=m=>c.value=!0),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm",placeholder:"Search...",onClick:y[2]||(y[2]=re(()=>{},["stop"]))},null,544),[[X,n.value]])]),s("div",{class:"py-1 overflow-y-auto",style:be({maxHeight:i.maxHeight})},[(r(!0),v(H,null,F(j.value,m=>(r(),v("div",{key:m[i.valueKey],onClick:g=>V(m),class:E(["block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",{"bg-gray-100":m[i.valueKey]===i.modelValue}])},D(m[i.labelKey]),11,pt))),128)),j.value.length===0?(r(),v("div",yt," No options available ")):k("",!0)],4)],512),[[q,c.value]])],2))}},O=ie(ht,[["__scopeId","data-v-d2f1cfa0"]]),bt={class:"space-y-4"},wt={key:0},kt={key:0,class:"text-sm text-gray-500"},xt={key:0,class:"text-sm text-gray-500"},_t={key:0,class:"text-sm text-gray-500"},$t={key:0,class:"text-sm text-gray-500"},St="Create New Task",Ct="/api/tasks",At="post",jt="Create Task",Tt="Task created successfully!",Et={__name:"CreateTaskModal",props:{show:Boolean,projectId:{type:Number,default:null}},emits:["close","saved"],setup(i,{emit:h}){const u=i,b=h,c=we({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:u.projectId}),n=["To Do","In Progress","Done","Blocked","Archived"],d=A([]),x=A([]),j=A([]),_=A([]),$=A(!0),M=A(!1),V=A(!1),L=A(!1);G(()=>u.show,async t=>{t&&(Object.assign(c,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:u.projectId}),u.projectId?await y(u.projectId):await T())},{immediate:!0}),G(()=>c.project_id,async t=>{t?await y(t):(x.value=[],j.value=[],_.value=[])});const T=async()=>{$.value=!0;try{const t=await window.axios.get("/api/projects-simplified");d.value=t.data.map(e=>({value:e.id,label:e.name}))}catch(t){console.error("Error fetching projects:",t),d.value=[]}finally{$.value=!1}},y=async t=>{if(t){M.value=!0,V.value=!0,L.value=!0;try{const[e,S,C]=await Promise.all([window.axios.get(`/api/projects/${t}/users`),window.axios.get("/api/task-types"),window.axios.get(`/api/projects/${t}/milestones`)]);x.value=e.data.map(R=>({value:R.id,label:R.name})),j.value=S.data.map(R=>({value:R.id,label:R.name})),_.value=C.data.map(R=>({value:R.id,label:R.name}))}catch(e){console.error("Error fetching associated task data:",e),x.value=[],j.value=[],_.value=[]}finally{M.value=!1,V.value=!1,L.value=!1}}},m=t=>{b("saved",t),b("close")},g=()=>{b("close")},a=B(()=>x.value),o=B(()=>j.value),l=B(()=>_.value);return(t,e)=>(r(),I(vt,{show:i.show,title:St,"api-endpoint":Ct,"http-method":At,"form-data":c,"submit-button-text":jt,"success-message":Tt,onClose:g,onSubmitted:m},{default:p(({errors:S})=>[s("div",bt,[i.projectId?k("",!0):(r(),v("div",wt,[f(N,{for:"task-project",value:"Project"}),$.value?(r(),v("div",kt,"Loading projects...")):(r(),I(O,{key:1,id:"task-project",modelValue:c.project_id,"onUpdate:modelValue":e[0]||(e[0]=C=>c.project_id=C),options:d.value,"value-key":"value","label-key":"label",placeholder:"Select a project",class:"mt-1",required:!0},null,8,["modelValue","options"])),f(W,{message:S.project_id?S.project_id[0]:"",class:"mt-2"},null,8,["message"])])),s("div",null,[f(N,{for:"task-name",value:"Task Name"}),f(de,{id:"task-name",modelValue:c.name,"onUpdate:modelValue":e[1]||(e[1]=C=>c.name=C),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),f(W,{message:S.name?S.name[0]:"",class:"mt-2"},null,8,["message"])]),s("div",null,[f(N,{for:"task-description",value:"Description"}),U(s("textarea",{id:"task-description","onUpdate:modelValue":e[2]||(e[2]=C=>c.description=C),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[X,c.description]]),f(W,{message:S.description?S.description[0]:"",class:"mt-2"},null,8,["message"])]),s("div",null,[f(N,{for:"task-status",value:"Status"}),f(O,{id:"task-status",modelValue:c.status,"onUpdate:modelValue":e[3]||(e[3]=C=>c.status=C),options:n.map(C=>({value:C,label:C})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),f(W,{message:S.status?S.status[0]:"",class:"mt-2"},null,8,["message"])]),s("div",null,[f(N,{for:"task-due-date",value:"Due Date"}),f(de,{id:"task-due-date",modelValue:c.due_date,"onUpdate:modelValue":e[4]||(e[4]=C=>c.due_date=C),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),f(W,{message:S.due_date?S.due_date[0]:"",class:"mt-2"},null,8,["message"])]),s("div",null,[f(N,{for:"task-assigned-to",value:"Assigned To"}),M.value?(r(),v("div",xt,"Loading users...")):(r(),I(O,{key:1,id:"task-assigned-to",modelValue:c.assigned_to_user_id,"onUpdate:modelValue":e[5]||(e[5]=C=>c.assigned_to_user_id=C),options:a.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(W,{message:S.assigned_to_user_id?S.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),s("div",null,[f(N,{for:"task-type",value:"Task Type"}),V.value?(r(),v("div",_t,"Loading task types...")):(r(),I(O,{key:1,id:"task-type",modelValue:c.task_type_id,"onUpdate:modelValue":e[6]||(e[6]=C=>c.task_type_id=C),options:o.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(W,{message:S.task_type_id?S.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),s("div",null,[f(N,{for:"task-milestone",value:"Milestone"}),L.value?(r(),v("div",$t,"Loading milestones...")):(r(),I(O,{key:1,id:"task-milestone",modelValue:c.milestone_id,"onUpdate:modelValue":e[7]||(e[7]=C=>c.milestone_id=C),options:l.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(W,{message:S.milestone_id?S.milestone_id[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]))}},Pt={class:"flex items-center p-4 h-16 border-b border-gray-700"},It={key:0,class:"text-xl font-semibold flex-1 truncate"},Mt=["title"],Dt={key:0,class:"p-4 border-b border-gray-700"},Bt={class:"relative"},Vt={key:1,class:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-500 scrollbar-track-gray-700 p-4"},Lt={key:0,class:"mb-4"},Ut={class:"ml-2 mt-2 space-y-1"},zt=["onClick"],Nt={class:"text-sm font-medium text-gray-300 truncate"},Rt={class:"ml-4 mt-1 space-y-1"},Wt={class:"truncate"},Ht={key:1,class:"mb-4"},Ft={class:"ml-2 mt-2 space-y-1"},qt=["onClick"],Kt={class:"text-sm font-medium text-gray-300 truncate"},Yt={class:"ml-4 mt-1 space-y-1"},Jt={class:"truncate"},Qt={key:2,class:"mb-4"},Gt={class:"ml-2 mt-2 space-y-1"},Xt={class:"truncate"},Zt={key:3,class:"mb-4"},Ot={class:"ml-2 mt-2 space-y-1"},es={class:"truncate"},ts={key:4,class:"text-gray-400 text-sm text-center py-4"},ss={key:5,class:"text-gray-400 text-sm text-center py-4"},as={key:2,class:"flex flex-col items-center pt-4 space-y-4"},os={key:0,class:"text-gray-400 text-xs text-center px-2"},ls={__name:"LeftSidebar",props:{allProjects:{type:Array,default:()=>[]},activeProjectId:{type:Number,default:null}},emits:["project-selected"],setup(i,{emit:h}){const u=i,b=h,c=A(localStorage.getItem("leftSidebarCollapsed")!=="false"),n=A(""),d=A({}),x=B(()=>{const a=new Set;return u.allProjects.forEach(o=>{o.project_type&&a.add(o.project_type)}),Array.from(a).sort()}),j=B(()=>{const a=new Set;return u.allProjects.forEach(o=>{Array.isArray(o.tags)&&o.tags.forEach(l=>a.add(l))}),Array.from(a).sort()}),_=B(()=>{if(!n.value)return u.allProjects;const a=n.value.toLowerCase();return u.allProjects.filter(o=>{var l,t,e;return o.name.toLowerCase().includes(a)||((l=o.description)==null?void 0:l.toLowerCase().includes(a))||((t=o.project_type)==null?void 0:t.toLowerCase().includes(a))||Array.isArray(o.tags)&&o.tags.some(S=>S.toLowerCase().includes(a))||((e=o.status)==null?void 0:e.toLowerCase().includes(a))})}),$=B(()=>{const a={};_.value.forEach(o=>{o.project_type&&o.status==="active"&&(a[o.project_type]||(a[o.project_type]=[]),a[o.project_type].push(o))});for(const o in a)a[o].sort((l,t)=>l.name.localeCompare(t.name));return a}),M=B(()=>{const a={};_.value.forEach(o=>{Array.isArray(o.tags)&&o.tags.length>0&&o.tags.forEach(l=>{a[l]||(a[l]=[]),a[l].push(o)})});for(const o in a)a[o]=[...new Set(a[o])].sort((l,t)=>l.name.localeCompare(t.name));return a}),V=B(()=>_.value.filter(a=>a.status!=="active").sort((a,o)=>a.name.localeCompare(o.name))),L=B(()=>_.value.filter(a=>!a.project_type&&(!Array.isArray(a.tags)||a.tags.length===0)).sort((a,o)=>a.name.localeCompare(o.name)));G(()=>u.allProjects,()=>{x.value.forEach(a=>{const o=`type-${a}`;d.value[o]===void 0&&(d.value[o]=!0)}),j.value.forEach(a=>{const o=`tag-${a}`;d.value[o]===void 0&&(d.value[o]=!0)}),d.value["main-types"]===void 0&&(d.value["main-types"]=!1),d.value["main-tags"]===void 0&&(d.value["main-tags"]=!1),d.value["inactive-projects"]===void 0&&(d.value["inactive-projects"]=!1),d.value.uncategorized===void 0&&(d.value.uncategorized=!1)},{immediate:!0}),G(c,a=>{localStorage.setItem("leftSidebarCollapsed",a)});const T=()=>{c.value=!c.value},y=a=>{d.value[a]=!d.value[a]},m=a=>{b("project-selected",a)},g=()=>{n.value=""};return(a,o)=>(r(),v("div",{class:E({"w-64":!c.value,"w-16":c.value,"min-w-16":!0,"bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out shrink-0 h-screen overflow-hidden":!0})},[s("div",Pt,[c.value?k("",!0):(r(),v("h2",It,"Projects")),s("button",{onClick:T,class:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:c.value?"Expand Sidebar":"Collapse Sidebar"},[(r(),v("svg",{class:E(["w-6 h-6 text-gray-400 transform transition-transform duration-300",{"rotate-180":c.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},o[5]||(o[5]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],8,Mt)]),c.value?k("",!0):(r(),v("div",Dt,[s("div",Bt,[U(s("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>n.value=l),placeholder:"Search all projects...",class:"w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 text-sm"},null,512),[[X,n.value]]),n.value?(r(),v("button",{key:0,onClick:g,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200",title:"Clear search"},o[6]||(o[6]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):k("",!0)])])),c.value?(r(),v("div",as,[(r(!0),v(H,null,F(u.allProjects,l=>(r(),I(P(K),{key:l.id,href:a.route("projects.show",l.id),onClick:t=>m(l.id),class:E({"w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-200":!0,"bg-indigo-600 text-white":l.id===i.activeProjectId,"bg-gray-700 text-gray-300 hover:bg-gray-600":l.id!==i.activeProjectId}),title:l.name},{default:p(()=>[w(D(l.name.charAt(0).toUpperCase()),1)]),_:2},1032,["href","onClick","class","title"]))),128)),i.allProjects.length===0?(r(),v("div",os," No Projects ")):k("",!0)])):(r(),v("div",Vt,[Object.keys($.value).length>0?(r(),v("div",Lt,[s("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[1]||(o[1]=l=>y("main-types"))},[o[8]||(o[8]=s("h3",{class:"text-sm font-semibold text-gray-400"},"Active Projects by Type",-1)),(r(),v("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!d.value["main-types"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[7]||(o[7]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),U(s("div",Ut,[(r(!0),v(H,null,F($.value,(l,t)=>(r(),v("div",{key:t},[s("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:e=>y(`type-${t}`)},[s("h4",Nt,D(t),1),(r(),v("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!d.value[`type-${t}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[9]||(o[9]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,zt),U(s("ul",Rt,[(r(!0),v(H,null,F(l,e=>(r(),v("li",{key:e.id},[f(P(K),{href:a.route("projects.show",e.id),onClick:S=>m(e.id),class:E({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":e.id===i.activeProjectId,"hover:bg-gray-700 text-gray-200":e.id!==i.activeProjectId,"font-bold":e.id===i.activeProjectId})},{default:p(()=>[s("span",Wt,D(e.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[q,!d.value[`type-${t}`]]])]))),128))],512),[[q,!d.value["main-types"]]])])):k("",!0),Object.keys(M.value).length>0?(r(),v("div",Ht,[s("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[2]||(o[2]=l=>y("main-tags"))},[o[11]||(o[11]=s("h3",{class:"text-sm font-semibold text-gray-400"},"Projects by Tag",-1)),(r(),v("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!d.value["main-tags"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[10]||(o[10]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),U(s("div",Ft,[(r(!0),v(H,null,F(M.value,(l,t)=>(r(),v("div",{key:t},[s("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:e=>y(`tag-${t}`)},[s("h4",Kt,D(t),1),(r(),v("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!d.value[`tag-${t}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[12]||(o[12]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,qt),U(s("ul",Yt,[(r(!0),v(H,null,F(l,e=>(r(),v("li",{key:e.id},[f(P(K),{href:a.route("projects.show",e.id),onClick:S=>m(e.id),class:E({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":e.id===i.activeProjectId,"hover:bg-gray-700 text-gray-200":e.id!==i.activeProjectId,"font-bold":e.id===i.activeProjectId})},{default:p(()=>[s("span",Jt,D(e.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[q,!d.value[`tag-${t}`]]])]))),128))],512),[[q,!d.value["main-tags"]]])])):k("",!0),V.value.length>0?(r(),v("div",Qt,[s("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[3]||(o[3]=l=>y("inactive-projects"))},[o[14]||(o[14]=s("h3",{class:"text-sm font-semibold text-gray-400"},"Inactive Projects",-1)),(r(),v("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!d.value["inactive-projects"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[13]||(o[13]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),U(s("ul",Gt,[(r(!0),v(H,null,F(V.value,l=>(r(),v("li",{key:l.id},[f(P(K),{href:a.route("projects.show",l.id),onClick:t=>m(l.id),class:E({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":l.id===i.activeProjectId,"hover:bg-gray-700 text-gray-200":l.id!==i.activeProjectId,"font-bold":l.id===i.activeProjectId})},{default:p(()=>[s("span",Xt,D(l.name)+" ("+D(l.status.replace("_"," "))+")",1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[q,!d.value["inactive-projects"]]])])):k("",!0),L.value.length>0?(r(),v("div",Zt,[s("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[4]||(o[4]=l=>y("uncategorized"))},[o[16]||(o[16]=s("h3",{class:"text-sm font-semibold text-gray-400"},"Uncategorized",-1)),(r(),v("svg",{class:E(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!d.value.uncategorized}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[15]||(o[15]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),U(s("ul",Ot,[(r(!0),v(H,null,F(L.value,l=>(r(),v("li",{key:l.id},[f(P(K),{href:a.route("projects.show",l.id),onClick:t=>m(l.id),class:E({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":l.id===i.activeProjectId,"hover:bg-gray-700 text-gray-200":l.id!==i.activeProjectId,"font-bold":l.id===i.activeProjectId})},{default:p(()=>[s("span",es,D(l.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[q,!d.value.uncategorized]])])):k("",!0),_.value.length===0?(r(),v("div",ts," No projects found matching your search. ")):i.allProjects.length===0&&!n.value?(r(),v("div",ss," No projects available. ")):k("",!0)]))],2))}},rs=ie(ls,[["__scopeId","data-v-417d431f"]]),is={class:"flex h-screen overflow-hidden"},ns={class:"flex-1 flex flex-col overflow-hidden"},ds={class:"border-b border-gray-100 bg-white z-10 relative"},us={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},cs={class:"flex h-16 justify-between"},vs={class:"flex"},ms={class:"flex shrink-0 items-center"},fs={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},gs={key:4,class:"hidden sm:flex sm:items-center"},ps={class:"hidden sm:ms-6 sm:flex sm:items-center"},ys={class:"relative ms-3"},hs={class:"inline-flex rounded-md"},bs={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},ws={class:"-me-2 flex items-center sm:hidden"},ks={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},xs={class:"space-y-1 pb-3 pt-2"},_s={key:6,class:"mt-3 space-y-1"},$s={class:"border-t border-gray-200 pb-1 pt-4"},Ss={class:"px-4"},Cs={class:"text-base font-medium text-gray-800"},As={class:"text-sm font-medium text-gray-500"},js={class:"text-sm font-medium text-gray-500 capitalize"},Ts={class:"mt-3 space-y-1"},Es={key:0,class:"bg-white shadow"},Ps={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},Is={class:"flex-1 overflow-y-auto"},zs={__name:"AuthenticatedLayout",setup(i){const h=A(!1),u=B(()=>se().props.auth.user);B(()=>{var t;return((t=u.value.role_data)==null?void 0:t.name)||""});const{canDo:b}=ke(),c=b("manage_projects"),n=b("compose_emails"),d=b("approve_emails"),x=b("create_users"),j=b("manage_roles"),_=b("manage_task_types"),$=b("create_clients"),M=A(!1),V=A([]),L=A(!0),T=B(()=>se().props.id||null),y=async()=>{const t=localStorage.getItem("authToken");if(t){window.axios.defaults.headers.common.Authorization=`Bearer ${t}`;try{await window.axios.get("/api/user")}catch(e){e.response&&e.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},m=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization},g=t=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},a=async()=>{L.value=!0;try{const t=await window.axios.get("/api/projects-simplified");V.value=t.data}catch(t){console.error("Error fetching all projects for sidebar:",t),V.value=[]}finally{L.value=!1}},o=t=>{_e.visit(route("projects.show",t))},l=A(null);return ee(()=>{y(),l.value&&$e(l.value),a()}),(t,e)=>{var S;return r(),v("div",is,[f(xe,{ref_key:"notificationContainerRef",ref:l},null,512),f(ot),f(rs,{"all-projects":V.value,"active-project-id":T.value,onProjectSelected:o},null,8,["all-projects","active-project-id"]),s("div",ns,[s("nav",ds,[s("div",us,[s("div",cs,[s("div",vs,[s("div",ms,[f(P(K),{href:t.route("dashboard")},{default:p(()=>[f(ge,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),s("div",fs,[f(Z,{href:t.route("dashboard"),active:t.route().current("dashboard")},{default:p(()=>e[5]||(e[5]=[w(" Dashboard ",-1)])),_:1,__:[5]},8,["href","active"]),P(c)?(r(),I(Z,{key:0,href:t.route("projects.index"),active:t.route().current("projects.index")},{default:p(()=>e[6]||(e[6]=[w(" Projects ",-1)])),_:1,__:[6]},8,["href","active"])):k("",!0),P(d)?(r(),I(Z,{key:1,href:t.route("emails.pending"),active:t.route().current("emails.pending")},{default:p(()=>e[7]||(e[7]=[w(" Approve Emails ",-1)])),_:1,__:[7]},8,["href","active"])):k("",!0),P(n)?(r(),I(Z,{key:2,href:t.route("emails.rejected"),active:t.route().current("emails.rejected")},{default:p(()=>e[8]||(e[8]=[w(" Rejected Emails ",-1)])),_:1,__:[8]},8,["href","active"])):k("",!0),P(x)?(r(),I(Z,{key:3,href:t.route("availability.index"),active:t.route().current("availability.index")},{default:p(()=>e[9]||(e[9]=[w(" Weekly Availability ",-1)])),_:1,__:[9]},8,["href","active"])):k("",!0),P(j)?(r(),v("div",gs,[f(ue,{align:"right",width:"48"},{trigger:p(()=>e[10]||(e[10]=[s("span",{class:"inline-flex rounded-md"},[s("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},[w(" Admin "),s("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:p(()=>[P($)?(r(),I(J,{key:0,href:t.route("clients.index"),active:t.route().current("clients.index")},{default:p(()=>e[11]||(e[11]=[w(" Clients ",-1)])),_:1,__:[11]},8,["href","active"])):k("",!0),P(x)?(r(),I(J,{key:1,href:t.route("users.index"),active:t.route().current("users.index")},{default:p(()=>e[12]||(e[12]=[w(" Users ",-1)])),_:1,__:[12]},8,["href","active"])):k("",!0),P(_)?(r(),I(J,{key:2,href:t.route("task-types.index"),active:t.route().current("task-types.index")},{default:p(()=>e[13]||(e[13]=[w(" Task Types ",-1)])),_:1,__:[13]},8,["href","active"])):k("",!0),f(J,{href:t.route("bonus-configuration.index"),active:t.route().current("bonus-configuration.index")},{default:p(()=>e[14]||(e[14]=[w(" Bonus Configuration ",-1)])),_:1,__:[14]},8,["href","active"]),f(J,{href:t.route("admin.roles.index")},{default:p(()=>e[15]||(e[15]=[w(" Manage Roles ",-1)])),_:1,__:[15]},8,["href"]),f(J,{href:t.route("admin.permissions.index")},{default:p(()=>e[16]||(e[16]=[w(" Manage Permissions ",-1)])),_:1,__:[16]},8,["href"])]),_:1})])):k("",!0)])]),s("div",ps,[f(te,{type:"button",onClick:e[0]||(e[0]=C=>M.value=!0),class:"mr-4 px-4 py-2 text-sm"},{default:p(()=>e[17]||(e[17]=[w(" Add Task ",-1)])),_:1,__:[17]}),s("div",ys,[f(ue,{align:"right",width:"48"},{trigger:p(()=>{var C;return[s("span",hs,[s("button",bs,[w(D(u.value.name)+" ("+D((C=u.value.role_data)==null?void 0:C.name)+") ",1),e[18]||(e[18]=s("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:p(()=>[f(J,{href:t.route("profile.edit")},{default:p(()=>e[19]||(e[19]=[w(" Profile ",-1)])),_:1,__:[19]},8,["href"]),f(J,{href:t.route("logout"),method:"post",as:"button",onSuccess:m,onError:g},{default:p(()=>e[20]||(e[20]=[w(" Log Out ",-1)])),_:1,__:[20]},8,["href"])]),_:1})])]),s("div",ws,[s("button",{onClick:e[1]||(e[1]=C=>h.value=!h.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(r(),v("svg",ks,[s("path",{class:E({hidden:h.value,"inline-flex":!h.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),s("path",{class:E({hidden:!h.value,"inline-flex":h.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])]),s("div",{class:E([{block:h.value,hidden:!h.value},"sm:hidden"])},[s("div",xs,[f(z,{href:t.route("dashboard"),active:t.route().current("dashboard")},{default:p(()=>e[21]||(e[21]=[w(" Dashboard ",-1)])),_:1,__:[21]},8,["href","active"]),P($)?(r(),I(z,{key:0,href:t.route("clients.index"),active:t.route().current("clients.index")},{default:p(()=>e[22]||(e[22]=[w(" Clients ",-1)])),_:1,__:[22]},8,["href","active"])):k("",!0),P(c)?(r(),I(z,{key:1,href:t.route("projects.index"),active:t.route().current("projects.index")},{default:p(()=>e[23]||(e[23]=[w(" Projects ",-1)])),_:1,__:[23]},8,["href","active"])):k("",!0),P(x)?(r(),I(z,{key:2,href:t.route("users.index"),active:t.route().current("users.index")},{default:p(()=>e[24]||(e[24]=[w(" Users ",-1)])),_:1,__:[24]},8,["href","active"])):k("",!0),P(n)?(r(),I(z,{key:3,href:t.route("emails.compose"),active:t.route().current("emails.compose")},{default:p(()=>e[25]||(e[25]=[w(" Compose Email ",-1)])),_:1,__:[25]},8,["href","active"])):k("",!0),P(d)?(r(),I(z,{key:4,href:t.route("emails.pending"),active:t.route().current("emails.pending")},{default:p(()=>e[26]||(e[26]=[w(" Approve Emails ",-1)])),_:1,__:[26]},8,["href","active"])):k("",!0),P(n)?(r(),I(z,{key:5,href:t.route("emails.rejected"),active:t.route().current("emails.rejected")},{default:p(()=>e[27]||(e[27]=[w(" Rejected Emails ",-1)])),_:1,__:[27]},8,["href","active"])):k("",!0),f(z,{href:t.route("availability.index"),active:t.route().current("availability.index")},{default:p(()=>e[28]||(e[28]=[w(" Weekly Availability ",-1)])),_:1,__:[28]},8,["href","active"]),P(j)?(r(),v("div",_s,[e[31]||(e[31]=s("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),f(z,{href:t.route("admin.roles.index"),active:t.route().current("admin.roles.index")},{default:p(()=>e[29]||(e[29]=[w(" Manage Roles ",-1)])),_:1,__:[29]},8,["href","active"]),f(z,{href:t.route("admin.permissions.index"),active:t.route().current("admin.permissions.index")},{default:p(()=>e[30]||(e[30]=[w(" Manage Permissions ",-1)])),_:1,__:[30]},8,["href","active"])])):k("",!0)]),s("div",$s,[s("div",Ss,[s("div",Cs,D(u.value.name),1),s("div",As,D(u.value.email),1),s("div",js,D((S=u.value.role_data)==null?void 0:S.name),1)]),s("div",Ts,[f(z,{as:"button",onClick:e[2]||(e[2]=C=>M.value=!0)},{default:p(()=>e[32]||(e[32]=[w(" Add Task ",-1)])),_:1,__:[32]}),f(z,{href:t.route("profile.edit")},{default:p(()=>e[33]||(e[33]=[w(" Profile ",-1)])),_:1,__:[33]},8,["href"]),f(z,{href:t.route("logout"),method:"post",as:"button",onSuccess:m,onError:g},{default:p(()=>e[34]||(e[34]=[w(" Log Out ",-1)])),_:1,__:[34]},8,["href"])])])],2)]),t.$slots.header?(r(),v("header",Es,[s("div",Ps,[Q(t.$slots,"header")])])):k("",!0),s("main",Is,[Q(t.$slots,"default")]),f(Et,{show:M.value,onClose:e[3]||(e[3]=C=>M.value=!1),onSaved:e[4]||(e[4]=C=>M.value=!1)},null,8,["show"])])])}}};export{vt as B,O as S,zs as _,et as a,Et as b,Ce as e,Se as s,Us as w};
