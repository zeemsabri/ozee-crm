import{B as Ve,n as Kt,T as Jt,a as Xt,o as Qt,q as es,k as ts,t as ss,_ as ls,v as as}from"./AuthenticatedLayout-CJG1TZGy.js";import{a as r,o as i,b as e,aP as $e,d as v,i as x,aQ as Xe,w as z,O as ie,m as q,t as g,g as se,aR as mt,an as vt,j as Q,k as ye,F as J,l as te,ak as ze,aS as ee,S as _t,J as qe,aL as is,y as xe,r as b,K as Te,e as de,c as U,f as we,x as he,A as ke,C as Ze,u as W,R as ns,D as Qe,aT as pt,q as xt,E as os,aq as rs,ap as ds,N as kt,I as et,aA as Le,p as ht,B as us,aO as cs,ar as ms,aM as vs,h as ps,L as hs,X as gs,as as fs}from"./app-lWw4l6Yl.js";import{_ as ys}from"./ProjectForm-CoFy3Ukh.js";import{_ as je}from"./Modal-pTY6kbn8.js";import{P as ge}from"./PrimaryButton-DLwlo-r6.js";import{b as Dt,_ as Ct,a as Tt}from"./TaskList-DjMbqXaS.js";import{h as re}from"./moment-BLMuvzoS.js";import{_ as G}from"./InputLabel-DS5QghHD.js";import{_ as me}from"./TextInput-B-5cldYz.js";import{_ as ae}from"./InputError-8cuJFBIo.js";import{O as tt,b as bs,u as ws,_ as _s,E as xs,a as ks}from"./ComposeEmailModal-C4BSlbaW.js";import{S as pe}from"./SelectDropdown-DkFegVXR.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as be}from"./SecondaryButton-w0CvPmjk.js";import{a as Ds,r as Cs}from"./PlusIcon-CXeFuWJM.js";import{r as Ts,_ as Ms}from"./EmailList-CEbo8s6d.js";import{_ as Es}from"./EmailEditor-BWDsuy2t.js";import{a as ve,c as Ie,d as He,f as Se,b as $s}from"./currency-DCQGmjKi.js";import{r as Ss}from"./ChevronDownIcon-Cz0eeKFl.js";import"./Checkbox-DPNdPNVV.js";import"./ApplicationLogo-BsT8fNcS.js";import"./DangerButton-RWV-N8Bu.js";import"./ProjectTypeInput-BrZQB2J7.js";function js(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z","clip-rule":"evenodd"})])}function Vs(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}function As(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}function Os(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M9.47 6.47a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 1 1-1.06 1.06L10 8.06l-3.72 3.72a.75.75 0 0 1-1.06-1.06l4.25-4.25Z","clip-rule":"evenodd"})])}function Is(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M10.75 10.818v2.614A3.13 3.13 0 0 0 11.888 13c.482-.315.612-.648.612-.875 0-.227-.13-.56-.612-.875a3.13 3.13 0 0 0-1.138-.432ZM8.33 8.62c.053.055.115.11.184.164.208.16.46.284.736.363V6.603a2.45 2.45 0 0 0-.35.13c-.14.065-.27.143-.386.233-.377.292-.514.627-.514.909 0 .184.058.39.202.592.037.051.08.102.128.152Z"}),e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-8-6a.75.75 0 0 1 .75.75v.316a3.78 3.78 0 0 1 1.653.713c.426.33.744.74.925 1.2a.75.75 0 0 1-1.395.55 1.35 1.35 0 0 0-.447-.563 2.187 2.187 0 0 0-.736-.363V9.3c.698.093 1.383.32 1.959.696.787.514 1.29 1.27 1.29 2.13 0 .86-.504 1.616-1.29 2.13-.576.377-1.261.603-1.96.696v.299a.75.75 0 1 1-1.5 0v-.3c-.697-.092-1.382-.318-1.958-.695-.482-.315-.857-.717-1.078-1.188a.75.75 0 1 1 1.359-.636c.08.173.245.376.54.569.313.205.706.353 1.138.432v-2.748a3.782 3.782 0 0 1-1.653-.713C6.9 9.433 6.5 8.681 6.5 7.875c0-.805.4-1.558 1.097-2.096a3.78 3.78 0 0 1 1.653-.713V4.75A.75.75 0 0 1 10 4Z","clip-rule":"evenodd"})])}function gt(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M3 4a2 2 0 0 0-2 2v1.161l8.441 4.221a1.25 1.25 0 0 0 1.118 0L19 7.162V6a2 2 0 0 0-2-2H3Z"}),e("path",{d:"m19 8.839-7.77 3.885a2.75 2.75 0 0 1-2.46 0L1 8.839V14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.839Z"})])}function Ls(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M16.555 5.412a8.028 8.028 0 0 0-3.503-2.81 14.899 14.899 0 0 1 1.663 4.472 8.547 8.547 0 0 0 1.84-1.662ZM13.326 7.825a13.43 13.43 0 0 0-2.413-5.773 8.087 8.087 0 0 0-1.826 0 13.43 13.43 0 0 0-2.413 5.773A8.473 8.473 0 0 0 10 8.5c1.18 0 2.304-.24 3.326-.675ZM6.514 9.376A9.98 9.98 0 0 0 10 10c1.226 0 2.4-.22 3.486-.624a13.54 13.54 0 0 1-.351 3.759A13.54 13.54 0 0 1 10 13.5c-1.079 0-2.128-.127-3.134-.366a13.538 13.538 0 0 1-.352-3.758ZM5.285 7.074a14.9 14.9 0 0 1 1.663-4.471 8.028 8.028 0 0 0-3.503 2.81c.529.638 1.149 1.199 1.84 1.66ZM17.334 6.798a7.973 7.973 0 0 1 .614 4.115 13.47 13.47 0 0 1-3.178 1.72 15.093 15.093 0 0 0 .174-3.939 10.043 10.043 0 0 0 2.39-1.896ZM2.666 6.798a10.042 10.042 0 0 0 2.39 1.896 15.196 15.196 0 0 0 .174 3.94 13.472 13.472 0 0 1-3.178-1.72 7.973 7.973 0 0 1 .615-4.115ZM10 15c.898 0 1.778-.079 2.633-.23a13.473 13.473 0 0 1-1.72 3.178 8.099 8.099 0 0 1-1.826 0 13.47 13.47 0 0 1-1.72-3.178c.855.151 1.735.23 2.633.23ZM14.357 14.357a14.912 14.912 0 0 1-1.305 3.04 8.027 8.027 0 0 0 4.345-4.345c-.953.542-1.971.981-3.04 1.305ZM6.948 17.397a8.027 8.027 0 0 1-4.345-4.345c.953.542 1.971.981 3.04 1.305a14.912 14.912 0 0 0 1.305 3.04Z"})])}function Ps(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"m2.695 14.762-1.262 3.155a.5.5 0 0 0 .65.65l3.155-1.262a4 4 0 0 0 1.343-.886L17.5 5.501a2.121 2.121 0 0 0-3-3L3.58 13.419a4 4 0 0 0-.885 1.343Z"})])}function Ns(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M2 3.5A1.5 1.5 0 0 1 3.5 2h1.148a1.5 1.5 0 0 1 1.465 1.175l.716 3.223a1.5 1.5 0 0 1-1.052 1.767l-.933.267c-.41.117-.643.555-.48.95a11.542 11.542 0 0 0 6.254 6.254c.395.163.833-.07.95-.48l.267-.933a1.5 1.5 0 0 1 1.767-1.052l3.223.716A1.5 1.5 0 0 1 18 15.352V16.5a1.5 1.5 0 0 1-1.5 1.5H15c-1.149 0-2.263-.15-3.326-.43A13.022 13.022 0 0 1 2.43 8.326 13.019 13.019 0 0 1 2 5V3.5Z","clip-rule":"evenodd"})])}function Mt(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M7 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM14.5 9a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM1.615 16.428a1.224 1.224 0 0 1-.569-1.175 6.002 6.002 0 0 1 11.908 0c.058.467-.172.92-.57 1.174A9.953 9.953 0 0 1 7 18a9.953 9.953 0 0 1-5.385-1.572ZM14.5 16h-.106c.07-.297.088-.611.048-.933a7.47 7.47 0 0 0-1.588-3.755 4.502 4.502 0 0 1 5.874 2.636.818.818 0 0 1-.36.98A7.465 7.465 0 0 1 14.5 16Z"})])}function Us(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16ZM8.28 7.22a.75.75 0 0 0-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 1 0 1.06 1.06L10 11.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L11.06 10l1.72-1.72a.75.75 0 0 0-1.06-1.06L10 8.94 8.28 7.22Z","clip-rule":"evenodd"})])}function Rs(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"})])}function Fs(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"})])}function Bs(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 7.5-2.25-1.313M21 7.5v2.25m0-2.25-2.25 1.313M3 7.5l2.25-1.313M3 7.5l2.25 1.313M3 7.5v2.25m9 3 2.25-1.313M12 12.75l-2.25-1.313M12 12.75V15m0 6.75 2.25-1.313M12 21.75V19.5m0 2.25-2.25-1.313m0-16.875L12 2.25l2.25 1.313M21 14.25v2.25l-2.25 1.313m-13.5 0L3 16.5v-2.25"})])}function Hs(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 0 0-1.883 2.542l.857 6a2.25 2.25 0 0 0 2.227 1.932H19.05a2.25 2.25 0 0 0 2.227-1.932l.857-6a2.25 2.25 0 0 0-1.883-2.542m-16.5 0V6A2.25 2.25 0 0 1 6 3.75h3.879a1.5 1.5 0 0 1 1.06.44l2.122 2.12a1.5 1.5 0 0 0 1.06.44H18A2.25 2.25 0 0 1 20.25 9v.776"})])}function Ws(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})])}function Ys(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"})])}function zs(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})])}function qs(l,t){return i(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})])}var Zs=Object.defineProperty,Gs=(l,t,s)=>t in l?Zs(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s,Ce=(l,t,s)=>Gs(l,typeof t!="symbol"?t+"":t,s);const Ks=(l,t,s)=>{const o=l[t];return o?typeof o=="function"?o():Promise.resolve(o):new Promise((n,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==s?". Note that variables only represent file names one level deep.":""))))})};let Re,ft,yt,_e,Fe={},Oe={};class Js{constructor(t,s=!1){Ce(this,"texts",{}),Ce(this,"dateToMinutes",o=>o.getHours()*60+o.getMinutes()),_e=this,this._texts=t,!s&&Date&&!Date.prototype.addDays&&this._initDatePrototypes()}_initDatePrototypes(){Date.prototype.addDays=function(t){return _e.addDays(this,t)},Date.prototype.subtractDays=function(t){return _e.subtractDays(this,t)},Date.prototype.addHours=function(t){return _e.addHours(this,t)},Date.prototype.subtractHours=function(t){return _e.subtractHours(this,t)},Date.prototype.addMinutes=function(t){return _e.addMinutes(this,t)},Date.prototype.subtractMinutes=function(t){return _e.subtractMinutes(this,t)},Date.prototype.getWeek=function(){return _e.getWeek(this)},Date.prototype.isToday=function(){return _e.isToday(this)},Date.prototype.isLeapYear=function(){return _e.isLeapYear(this)},Date.prototype.format=function(t="YYYY-MM-DD"){return _e.formatDate(this,t)},Date.prototype.formatTime=function(t="HH:mm"){return _e.formatTime(this,t)}}removePrototypes(){delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime}updateTexts(t){this._texts=t}_todayFormatted(){return ft!==new Date().getDate()&&(Re=new Date,ft=Re.getDate(),yt=`${Re.getFullYear()}-${Re.getMonth()}-${Re.getDate()}`),yt}addDays(t,s){const o=new Date(t.valueOf());return o.setDate(o.getDate()+s),o}subtractDays(t,s){const o=new Date(t.valueOf());return o.setDate(o.getDate()-s),o}addHours(t,s){const o=new Date(t.valueOf());return o.setHours(o.getHours()+s),o}subtractHours(t,s){const o=new Date(t.valueOf());return o.setHours(o.getHours()-s),o}addMinutes(t,s){const o=new Date(t.valueOf());return o.setMinutes(o.getMinutes()+s),o}subtractMinutes(t,s){const o=new Date(t.valueOf());return o.setMinutes(o.getMinutes()-s),o}getWeek(t){const s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),o=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-o);const n=new Date(Date.UTC(s.getUTCFullYear(),0,1));return Math.ceil(((s-n)/864e5+1)/7)}isToday(t){return`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`===this._todayFormatted()}isLeapYear(t){const s=t.getFullYear();return!(s%400)||s%100&&!(s%4)}getPreviousFirstDayOfWeek(t=null,s){const o=t&&new Date(t.valueOf())||new Date,n=s?7:6;return o.setDate(o.getDate()-(o.getDay()+n)%7),o}stringToDate(t){return t instanceof Date?t:(t.length===10&&(t+=" 00:00"),new Date(t.replace(/-/g,"/")))}countDays(t,s){typeof t=="string"&&(t=t.replace(/-/g,"/")),typeof s=="string"&&(s=s.replace(/-/g,"/")),t=new Date(t).setHours(0,0,0,0),s=new Date(s).setHours(0,0,1,0);const o=(new Date(s).getTimezoneOffset()-new Date(t).getTimezoneOffset())*60*1e3;return Math.ceil((s-t-o)/(24*3600*1e3))}datesInSameTimeStep(t,s,o){return Math.abs(t.getTime()-s.getTime())<=o*60*1e3}formatDate(t,s="YYYY-MM-DD",o=null){if(o||(o=this._texts),s||(s="YYYY-MM-DD"),s==="YYYY-MM-DD")return this.formatDateLite(t);Fe={},Oe={};const n={YYYY:()=>this._hydrateDateObject(t,o).YYYY,YY:()=>this._hydrateDateObject(t,o).YY(),M:()=>this._hydrateDateObject(t,o).M,MM:()=>this._hydrateDateObject(t,o).MM(),MMM:()=>this._hydrateDateObject(t,o).MMM(),MMMM:()=>this._hydrateDateObject(t,o).MMMM(),MMMMG:()=>this._hydrateDateObject(t,o).MMMMG(),D:()=>this._hydrateDateObject(t,o).D,DD:()=>this._hydrateDateObject(t,o).DD(),S:()=>this._hydrateDateObject(t,o).S(),d:()=>this._hydrateDateObject(t,o).d,dd:()=>this._hydrateDateObject(t,o).dd(),ddd:()=>this._hydrateDateObject(t,o).ddd(),dddd:()=>this._hydrateDateObject(t,o).dddd(),HH:()=>this._hydrateTimeObject(t,o).HH,H:()=>this._hydrateTimeObject(t,o).H,hh:()=>this._hydrateTimeObject(t,o).hh,h:()=>this._hydrateTimeObject(t,o).h,am:()=>this._hydrateTimeObject(t,o).am,AM:()=>this._hydrateTimeObject(t,o).AM,mm:()=>this._hydrateTimeObject(t,o).mm,m:()=>this._hydrateTimeObject(t,o).m};return s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(a,c)=>{const d=n[c.replace(/\{|\}/g,"")];return d!==void 0?d():c})}formatDateLite(t){const s=t.getMonth()+1,o=t.getDate();return`${t.getFullYear()}-${s<10?"0":""}${s}-${o<10?"0":""}${o}`}formatTime(t,s="HH:mm",o=null,n=!1){let a=!1;if(n){const[u,m,p]=[t.getHours(),t.getMinutes(),t.getSeconds()];u+m+p===141&&(a=!0)}if(t instanceof Date&&s==="HH:mm")return a?"24:00":this.formatTimeLite(t);Oe={},o||(o=this._texts);const c=this._hydrateTimeObject(t,o),d=s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(u,m)=>{const p=c[m.replace(/\{|\}/g,"")];return p!==void 0?p:m});return a?d.replace("23:59","24:00"):d}formatTimeLite(t){const s=t.getHours(),o=t.getMinutes();return`${(s<10?"0":"")+s}:${(o<10?"0":"")+o}`}_nth(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}_hydrateDateObject(t,s){if(Fe.D)return Fe;const o=t.getFullYear(),n=t.getMonth()+1,a=t.getDate(),d=(t.getDay()-1+7)%7;return Fe={YYYY:o,YY:()=>o.toString().substring(2),M:n,MM:()=>(n<10?"0":"")+n,MMM:()=>s.months[n-1].substring(0,3),MMMM:()=>s.months[n-1],MMMMG:()=>(s.monthsGenitive||s.months)[n-1],D:a,DD:()=>(a<10?"0":"")+a,S:()=>this._nth(a),d:d+1,dd:()=>s.weekDays[d][0],ddd:()=>s.weekDays[d].substr(0,3),dddd:()=>s.weekDays[d]},Fe}_hydrateTimeObject(t,s){if(Oe.am)return Oe;let o,n;t instanceof Date?(o=t.getHours(),n=t.getMinutes()):(o=Math.floor(t/60),n=Math.floor(t%60));const a=o%12?o%12:12,c=(s||{am:"am",pm:"pm"})[o===24||o<12?"am":"pm"];return Oe={H:o,h:a,HH:(o<10?"0":"")+o,hh:(a<10?"0":"")+a,am:c,AM:c.toUpperCase(),m:n,mm:(n<10?"0":"")+n},Oe}}const Xs=1440;class Qs{constructor(t){Ce(this,"_vuecal",null),Ce(this,"selectCell",(s=!1,o,n)=>{this._vuecal.$emit("cell-click",n?{date:o,split:n}:o),this._vuecal.clickToNavigate||s?this._vuecal.switchToNarrowerView():this._vuecal.dblclickToNavigate&&"ontouchstart"in window&&(this._vuecal.domEvents.dblTapACell.taps++,setTimeout(()=>this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.domEvents.dblTapACell.timeout),this._vuecal.domEvents.dblTapACell.taps>=2&&(this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.switchToNarrowerView(),this._vuecal.$emit("cell-dblclick",n?{date:o,split:n}:o)))}),Ce(this,"keyPressEnterCell",(s,o)=>{this._vuecal.$emit("cell-keypress-enter",o?{date:s,split:o}:s),this._vuecal.switchToNarrowerView()}),Ce(this,"getPosition",s=>{const{left:o,top:n}=this._vuecal.cellsEl.getBoundingClientRect(),{clientX:a,clientY:c}="ontouchstart"in window&&s.touches?s.touches[0]:s;return{x:a-o,y:c-n}}),Ce(this,"minutesAtCursor",s=>{let o=0,n={x:0,y:0};const{timeStep:a,timeCellHeight:c,timeFrom:d}=this._vuecal.$props;return typeof s=="number"?o=s:typeof s=="object"&&(n=this.getPosition(s),o=Math.round(n.y*a/parseInt(c)+d)),{minutes:Math.max(Math.min(o,Xs),0),cursorCoords:n}}),this._vuecal=t}}const el=2,Ke=1440;let ue,ce,Je;class tl{constructor(t,s){Ce(this,"_vuecal",null),Ce(this,"eventDefaults",{_eid:null,start:"",startTimeMinutes:0,end:"",endTimeMinutes:0,title:"",content:"",background:!1,allDay:!1,segments:null,repeat:null,daysCount:1,deletable:!0,deleting:!1,titleEditable:!0,resizable:!0,resizing:!1,draggable:!0,dragging:!1,draggingStatic:!1,focused:!1,class:""}),this._vuecal=t,ue=s}createAnEvent(t,s,o){if(typeof t=="string"&&(t=ue.stringToDate(t)),!(t instanceof Date))return!1;const n=ue.dateToMinutes(t);s=s*1||el*60;const a=n+s,c=ue.addMinutes(new Date(t),s);o.end&&(typeof o.end=="string"&&(o.end=ue.stringToDate(o.end)),o.endTimeMinutes=ue.dateToMinutes(o.end));const d={...this.eventDefaults,_eid:`${this._vuecal._.uid}_${this._vuecal.eventIdIncrement++}`,start:t,startTimeMinutes:n,end:c,endTimeMinutes:a,segments:null,...o};if(!(typeof this._vuecal.onEventCreate=="function"&&!this._vuecal.onEventCreate(d,()=>this.deleteAnEvent(d))))return d.startDateF!==d.endDateF&&(d.daysCount=ue.countDays(d.start,d.end)),this._vuecal.mutableEvents.push(d),this._vuecal.addEventsToView([d]),this._vuecal.emitWithEvent("event-create",d),this._vuecal.$emit("event-change",{event:this._vuecal.cleanupEvent(d),originalEvent:null}),d}addEventSegment(t){t.segments||(t.segments={},t.segments[ue.formatDateLite(t.start)]={start:t.start,startTimeMinutes:t.startTimeMinutes,endTimeMinutes:Ke,isFirstDay:!0,isLastDay:!1});const s=t.segments[ue.formatDateLite(t.end)];s&&(s.isLastDay=!1,s.endTimeMinutes=Ke);const o=ue.addDays(t.end,1),n=ue.formatDateLite(o);return o.setHours(0,0,0,0),t.segments[n]={start:o,startTimeMinutes:0,endTimeMinutes:t.endTimeMinutes,isFirstDay:!1,isLastDay:!0},t.end=ue.addMinutes(o,t.endTimeMinutes),t.daysCount=Object.keys(t.segments).length,n}removeEventSegment(t){let s=Object.keys(t.segments).length;if(s<=1)return ue.formatDateLite(t.end);delete t.segments[ue.formatDateLite(t.end)],s--;const o=ue.subtractDays(t.end,1),n=ue.formatDateLite(o),a=t.segments[n];return s?a&&(a.isLastDay=!0,a.endTimeMinutes=t.endTimeMinutes):t.segments=null,t.daysCount=s||1,t.end=o,n}createEventSegments(t,s,o){const n=s.getTime(),a=o.getTime();let c=t.start.getTime(),d=t.end.getTime(),u=!1,m,p,w;for(!t.end.getHours()&&!t.end.getMinutes()&&(d-=1e3),t.segments={},t.repeat?(m=n,p=Math.min(a,t.repeat.until?ue.stringToDate(t.repeat.until).getTime():a)):(m=Math.max(n,c),p=Math.min(a,d));m<=p;){let _=!1;const V=ue.addDays(new Date(m),1).setHours(0,0,0,0);let M,S,h,f;if(t.repeat){const k=new Date(m),E=ue.formatDateLite(k);(u||t.occurrences&&t.occurrences[E])&&(u||(c=t.occurrences[E].start,w=new Date(c).setHours(0,0,0,0),d=t.occurrences[E].end),u=!0,_=!0),M=m===w,S=E===ue.formatDateLite(new Date(d)),h=new Date(M?c:m),f=ue.formatDateLite(h),S&&(u=!1)}else _=!0,M=m===c,S=p===d&&V>p,h=M?t.start:new Date(m),f=ue.formatDateLite(M?t.start:h);_&&(t.segments[f]={start:h,startTimeMinutes:M?t.startTimeMinutes:0,endTimeMinutes:S?t.endTimeMinutes:Ke,isFirstDay:M,isLastDay:S}),m=V}return t}deleteAnEvent(t){this._vuecal.emitWithEvent("event-delete",t),this._vuecal.mutableEvents=this._vuecal.mutableEvents.filter(s=>s._eid!==t._eid),this._vuecal.view.events=this._vuecal.view.events.filter(s=>s._eid!==t._eid)}checkCellOverlappingEvents(t,s){Je=t.slice(0),ce={},t.forEach(n=>{Je.shift(),ce[n._eid]||(ce[n._eid]={overlaps:[],start:n.start,position:0}),ce[n._eid].position=0,Je.forEach(a=>{ce[a._eid]||(ce[a._eid]={overlaps:[],start:a.start,position:0});const c=this.eventInRange(a,n.start,n.end),d=s.overlapsPerTimeStep?ue.datesInSameTimeStep(n.start,a.start,s.timeStep):1;if(!n.background&&!n.allDay&&!a.background&&!a.allDay&&c&&d)ce[n._eid].overlaps.push(a._eid),ce[n._eid].overlaps=[...new Set(ce[n._eid].overlaps)],ce[a._eid].overlaps.push(n._eid),ce[a._eid].overlaps=[...new Set(ce[a._eid].overlaps)],ce[a._eid].position++;else{let u,m;(u=(ce[n._eid]||{overlaps:[]}).overlaps.indexOf(a._eid))>-1&&ce[n._eid].overlaps.splice(u,1),(m=(ce[a._eid]||{overlaps:[]}).overlaps.indexOf(n._eid))>-1&&ce[a._eid].overlaps.splice(m,1),ce[a._eid].position--}})});let o=0;for(const n in ce){const a=ce[n],c=a.overlaps.map(d=>({id:d,start:ce[d].start}));c.push({id:n,start:a.start}),c.sort((d,u)=>d.start<u.start?-1:d.start>u.start?1:d.id>u.id?-1:1),a.position=c.findIndex(d=>d.id===n),o=Math.max(this.getOverlapsStreak(a,ce),o)}return[ce,o]}getOverlapsStreak(t,s={}){let o=t.overlaps.length+1,n=[];return t.overlaps.forEach(a=>{n.includes(a)||t.overlaps.filter(d=>d!==a).forEach(d=>{s[d].overlaps.includes(a)||n.push(d)})}),n=[...new Set(n)],o-=n.length,o}eventInRange(t,s,o){if(t.allDay||!this._vuecal.time){const c=new Date(t.start).setHours(0,0,0,0);return new Date(t.end).setHours(23,59,0,0)>=new Date(s).setHours(0,0,0,0)&&c<=new Date(o).setHours(0,0,0,0)}const n=t.start.getTime(),a=t.end.getTime();return n<o.getTime()&&a>s.getTime()}}const sl={class:"vuecal__flex vuecal__weekdays-headings"},ll=["onClick"],al={class:"vuecal__flex weekday-label",grow:""},il={class:"full"},nl={class:"small"},ol={class:"xsmall"},rl={key:0},dl={key:0,class:"vuecal__flex vuecal__split-days-headers",grow:""};function ul(l,t,s,o,n,a){return i(),r("div",sl,[(i(!0),r(J,null,te(a.headings,(c,d)=>(i(),r(J,{key:d},[c.hide?x("",!0):(i(),r("div",{key:0,class:Q(["vuecal__flex vuecal__heading",{today:c.today,clickable:a.cellHeadingsClickable}]),style:ye(a.weekdayCellStyles),onClick:u=>a.view.id==="week"&&a.selectCell(c.date,u),onDblclick:t[0]||(t[0]=u=>a.view.id==="week"&&a.vuecal.dblclickToNavigate&&s.switchToNarrowerView())},[v(ze,{name:`slide-fade--${s.transitionDirection}`,appear:a.vuecal.transitions},{default:z(()=>[(i(),r("div",{class:"vuecal__flex",column:"",key:a.vuecal.transitions?`${d}-${c.dayOfMonth}`:!1},[e("div",al,[ie(l.$slots,"weekday-heading",{heading:a.cleanupHeading(c),view:a.view},()=>[e("span",il,g(c.full),1),e("span",nl,g(c.small),1),e("span",ol,g(c.xsmall),1),c.dayOfMonth?(i(),r("span",rl,"Â "+g(c.dayOfMonth),1)):x("",!0)])]),a.vuecal.hasSplits&&a.vuecal.stickySplitLabels?(i(),r("div",dl,[(i(!0),r(J,null,te(a.vuecal.daySplits,(u,m)=>(i(),r("div",{class:Q(["day-split-header",u.class||!1]),key:m},[ie(l.$slots,"split-label",{split:u,view:a.view},()=>[q(g(u.label),1)])],2))),128))])):x("",!0)]))]),_:2},1032,["name","appear"])],46,ll))],64))),128))])}const Pe=(l,t)=>{const s=l.__vccOpts||l;for(const[o,n]of t)s[o]=n;return s},cl={inject:["vuecal","utils","view"],props:{transitionDirection:{type:String,default:"right"},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},methods:{selectCell(l,t){l.getTime()!==this.view.selectedDate.getTime()&&(this.view.selectedDate=l),this.utils.cell.selectCell(!1,l,t)},cleanupHeading:l=>({label:l.full,date:l.date,...l.today?{today:l.today}:{}})},computed:{headings(){if(!["month","week"].includes(this.view.id))return[];let l=!1;return this.weekDays.map((s,o)=>{const n=this.utils.date.addDays(this.view.startDate,this.vuecal.startWeekOnSunday&&this.vuecal.hideWeekends?o-1:o);return{hide:s.hide,full:s.label,small:s.short||s.label.substr(0,3),xsmall:s.short||s.label.substr(0,1),...this.view.id==="week"?{dayOfMonth:n.getDate(),date:n,today:!l&&this.utils.date.isToday(n)&&!l++}:{}}})},cellWidth(){return 100/(7-this.weekDays.reduce((l,t)=>l+t.hide,0))},weekdayCellStyles(){return{...this.vuecal.hideWeekdays.length?{width:`${this.cellWidth}%`}:{}}},cellHeadingsClickable(){return this.view.id==="week"&&(this.vuecal.clickToNavigate||this.vuecal.dblclickToNavigate)}}},Et=Pe(cl,[["render",ul]]),ml={class:"vuecal__header"},vl={key:0,class:"vuecal__flex vuecal__menu",role:"tablist","aria-label":"Calendar views navigation"},pl=["onDragenter","onDragleave","onClick","aria-label"],hl={key:1,class:"vuecal__title-bar"},gl=["aria-label"],fl={class:"vuecal__flex vuecal__title",grow:""},yl=["aria-label"],bl={key:0,class:"vuecal__flex vuecal__split-days-headers"};function wl(l,t,s,o,n,a){const c=$e("weekdays-headings");return i(),r("div",ml,[s.options.hideViewSelector?x("",!0):(i(),r("div",vl,[(i(!0),r(J,null,te(s.viewProps.views,(d,u)=>(i(),r(J,{key:u},[d.enabled?(i(),r("button",{key:0,class:Q(["vuecal__view-btn",{"vuecal__view-btn--active":a.view.id===u,"vuecal__view-btn--highlighted":l.highlightedControl===u}]),type:"button",onDragenter:m=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(m,u,l.$data),onDragleave:m=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(m,u,l.$data),onClick:m=>a.switchView(u,null,!0),"aria-label":`${d.label} view`},g(d.label),43,pl)):x("",!0)],64))),128))])),s.options.hideTitleBar?x("",!0):(i(),r("div",hl,[e("button",{class:Q(["vuecal__arrow vuecal__arrow--prev",{"vuecal__arrow--highlighted":l.highlightedControl==="previous"}]),type:"button",onClick:t[0]||(t[0]=(...d)=>a.previous&&a.previous(...d)),onDragenter:t[1]||(t[1]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(d,"previous",l.$data)),onDragleave:t[2]||(t[2]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(d,"previous",l.$data)),"aria-label":`Previous ${a.view.id}`},[ie(l.$slots,"arrow-prev")],42,gl),e("div",fl,[v(ze,{name:s.options.transitions?`slide-fade--${a.transitionDirection}`:""},{default:z(()=>[(i(),se(_t(a.broaderView?"button":"span"),{type:!!a.broaderView&&"button",key:`${a.view.id}${a.view.startDate.toString()}`,onClick:t[3]||(t[3]=d=>!!a.broaderView&&a.switchToBroaderView()),"aria-label":!!a.broaderView&&`Go to ${a.broaderView} view`},{default:z(()=>[ie(l.$slots,"title")]),_:3},8,["type","aria-label"]))]),_:3},8,["name"])]),s.options.todayButton?(i(),r("button",{key:0,class:Q(["vuecal__today-btn",{"vuecal__today-btn--highlighted":l.highlightedControl==="today"}]),type:"button",onClick:t[4]||(t[4]=(...d)=>a.goToToday&&a.goToToday(...d)),onDragenter:t[5]||(t[5]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(d,"today",l.$data)),onDragleave:t[6]||(t[6]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(d,"today",l.$data)),"aria-label":"Today"},[ie(l.$slots,"today-button")],34)):x("",!0),e("button",{class:Q(["vuecal__arrow vuecal__arrow--next",{"vuecal__arrow--highlighted":l.highlightedControl==="next"}]),type:"button",onClick:t[7]||(t[7]=(...d)=>a.next&&a.next(...d)),onDragenter:t[8]||(t[8]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(d,"next",l.$data)),onDragleave:t[9]||(t[9]=d=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(d,"next",l.$data)),"aria-label":`Next ${a.view.id}`},[ie(l.$slots,"arrow-next")],42,yl)])),s.viewProps.weekDaysInHeader?(i(),se(c,{key:2,"week-days":s.weekDays,"transition-direction":a.transitionDirection,"switch-to-narrower-view":s.switchToNarrowerView},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:z(({heading:d,view:u})=>[ie(l.$slots,"weekday-heading",{heading:d,view:u})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:z(({split:d})=>[ie(l.$slots,"split-label",{split:d,view:a.view})]),key:"1"}:void 0]),1032,["week-days","transition-direction","switch-to-narrower-view"])):x("",!0),v(ze,{name:`slide-fade--${a.transitionDirection}`},{default:z(()=>[a.showDaySplits?(i(),r("div",bl,[(i(!0),r(J,null,te(s.daySplits,(d,u)=>(i(),r("div",{class:Q(["day-split-header",d.class||!1]),key:u},[ie(l.$slots,"split-label",{split:d,view:a.view.id},()=>[q(g(d.label),1)])],2))),128))])):x("",!0)]),_:3},8,["name"])])}const _l={inject:["vuecal","previous","next","switchView","updateSelectedDate","modules","view"],components:{WeekdaysHeadings:Et},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},hasSplits:{type:[Boolean,Number],default:!1},daySplits:{type:Array,default:()=>[]},viewProps:{type:Object,default:()=>({})},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},data:()=>({highlightedControl:null}),methods:{goToToday(){this.updateSelectedDate(new Date(new Date().setHours(0,0,0,0)))},switchToBroaderView(){this.transitionDirection="left",this.broaderView&&this.switchView(this.broaderView)}},computed:{transitionDirection:{get(){return this.vuecal.transitionDirection},set(l){this.vuecal.transitionDirection=l}},broaderView(){const{enabledViews:l}=this.vuecal;return l[l.indexOf(this.view.id)-1]},showDaySplits(){return this.view.id==="day"&&this.hasSplits&&this.options.stickySplitLabels&&!this.options.minSplitWidth},dnd(){return this.modules.dnd}}},xl=Pe(_l,[["render",wl]]),kl=["draggable"];function Dl(l,t,s,o,n,a){return i(),r("div",{class:Q(["vuecal__event",a.eventClasses]),style:ye(a.eventStyles),tabindex:"0",onFocus:t[4]||(t[4]=(...c)=>a.focusEvent&&a.focusEvent(...c)),onKeypress:t[5]||(t[5]=qe(xe((...c)=>a.onEnterKeypress&&a.onEnterKeypress(...c),["stop"]),["enter"])),onMouseenter:t[6]||(t[6]=(...c)=>a.onMouseEnter&&a.onMouseEnter(...c)),onMouseleave:t[7]||(t[7]=(...c)=>a.onMouseLeave&&a.onMouseLeave(...c)),onTouchstart:t[8]||(t[8]=xe((...c)=>a.onTouchStart&&a.onTouchStart(...c),["stop"])),onMousedown:t[9]||(t[9]=c=>a.onMouseDown(c)),onMouseup:t[10]||(t[10]=(...c)=>a.onMouseUp&&a.onMouseUp(...c)),onTouchend:t[11]||(t[11]=(...c)=>a.onMouseUp&&a.onMouseUp(...c)),onTouchmove:t[12]||(t[12]=(...c)=>a.onTouchMove&&a.onTouchMove(...c)),onDblclick:t[13]||(t[13]=(...c)=>a.onDblClick&&a.onDblClick(...c)),draggable:a.draggable,onDragstart:t[14]||(t[14]=c=>a.draggable&&a.onDragStart(c)),onDragend:t[15]||(t[15]=c=>a.draggable&&a.onDragEnd())},[a.vuecal.editEvents.delete&&s.event.deletable?(i(),r("div",{key:0,class:"vuecal__event-delete",onClick:t[0]||(t[0]=xe((...c)=>a.deleteEvent&&a.deleteEvent(...c),["stop"])),onTouchstart:t[1]||(t[1]=xe((...c)=>a.touchDeleteEvent&&a.touchDeleteEvent(...c),["stop"]))},g(a.vuecal.texts.deleteEvent),33)):x("",!0),ie(l.$slots,"event",{event:s.event,view:a.view.id}),a.resizable?(i(),r("div",{key:1,class:"vuecal__event-resize-handle",contenteditable:"false",onMousedown:t[2]||(t[2]=xe((...c)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...c),["stop","prevent"])),onTouchstart:t[3]||(t[3]=xe((...c)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...c),["stop","prevent"]))},null,32)):x("",!0)],46,kl)}const Cl={inject:["vuecal","utils","modules","view","domEvents","editEvents"],props:{cellFormattedDate:{type:String,default:""},event:{type:Object,default:()=>({})},cellEvents:{type:Array,default:()=>[]},overlaps:{type:Array,default:()=>[]},eventPosition:{type:Number,default:0},overlapsStreak:{type:Number,default:0},allDay:{type:Boolean,default:!1}},data:()=>({touch:{dragThreshold:30,startX:0,startY:0,dragged:!1}}),methods:{onMouseDown(l,t=!1){if("ontouchstart"in window&&!t)return!1;const{clickHoldAnEvent:s,focusAnEvent:o,resizeAnEvent:n,dragAnEvent:a}=this.domEvents;if(o._eid===this.event._eid&&s._eid===this.event._eid)return!0;this.focusEvent(),s._eid=null,this.vuecal.editEvents.delete&&this.event.deletable&&(s.timeoutId=setTimeout(()=>{!n._eid&&!a._eid&&(s._eid=this.event._eid,this.event.deleting=!0)},s.timeout))},onMouseUp(l){this.domEvents.focusAnEvent._eid===this.event._eid&&!this.touch.dragged&&(this.domEvents.focusAnEvent.mousedUp=!0),this.touch.dragged=!1},onMouseEnter(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-enter",this.event)},onMouseLeave(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-leave",this.event)},onTouchMove(l){if(typeof this.vuecal.onEventClick!="function")return;const{clientX:t,clientY:s}=l.touches[0],{startX:o,startY:n,dragThreshold:a}=this.touch;(Math.abs(t-o)>a||Math.abs(s-n)>a)&&(this.touch.dragged=!0)},onTouchStart(l){this.touch.startX=l.touches[0].clientX,this.touch.startY=l.touches[0].clientY,this.onMouseDown(l,!0)},onEnterKeypress(l){if(typeof this.vuecal.onEventClick=="function")return this.vuecal.onEventClick(this.event,l)},onDblClick(l){if(typeof this.vuecal.onEventDblclick=="function")return this.vuecal.onEventDblclick(this.event,l)},onDragStart(l){this.dnd&&this.dnd.eventDragStart(l,this.event)},onDragEnd(){this.dnd&&this.dnd.eventDragEnd(this.event)},onResizeHandleMouseDown(){this.focusEvent(),this.domEvents.dragAnEvent._eid=null,this.domEvents.resizeAnEvent=Object.assign(this.domEvents.resizeAnEvent,{_eid:this.event._eid,start:(this.segment||this.event).start,split:this.event.split||null,segment:!!this.segment&&this.utils.date.formatDateLite(this.segment.start),originalEnd:new Date((this.segment||this.event).end),originalEndTimeMinutes:this.event.endTimeMinutes}),this.event.resizing=!0},deleteEvent(l=!1){if("ontouchstart"in window&&!l)return!1;this.utils.event.deleteAnEvent(this.event)},touchDeleteEvent(l){this.deleteEvent(!0)},cancelDeleteEvent(){this.event.deleting=!1},focusEvent(){const{focusAnEvent:l}=this.domEvents,t=l._eid;if(t!==this.event._eid){if(t){const s=this.view.events.find(o=>o._eid===t);s&&(s.focused=!1)}this.vuecal.cancelDelete(),this.vuecal.emitWithEvent("event-focus",this.event),l._eid=this.event._eid,this.event.focused=!0}}},computed:{eventDimensions(){const{startTimeMinutes:l,endTimeMinutes:t}=this.segment||this.event;let s=l-this.vuecal.timeFrom;const o=Math.max(Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),0);s=Math.min(t,this.vuecal.timeTo)-this.vuecal.timeFrom;const n=Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),a=Math.max(n-o,5);return{top:o,height:a}},eventStyles(){if(this.event.allDay||!this.vuecal.time||!this.event.endTimeMinutes||this.view.id==="month"||this.allDay)return{};let l=100/Math.min(this.overlaps.length+1,this.overlapsStreak),t=100/(this.overlaps.length+1)*this.eventPosition;this.vuecal.minEventWidth&&l<this.vuecal.minEventWidth&&(l=this.vuecal.minEventWidth,t=(100-this.vuecal.minEventWidth)/this.overlaps.length*this.eventPosition);const{top:s,height:o}=this.eventDimensions;return{top:`${s}px`,height:`${o}px`,width:`${l}%`,left:this.event.left&&`${this.event.left}px`||`${t}%`}},eventClasses(){const{isFirstDay:l,isLastDay:t}=this.segment||{};return{[this.event.class]:!!this.event.class,"vuecal__event--focus":this.event.focused,"vuecal__event--resizing":this.event.resizing,"vuecal__event--background":this.event.background,"vuecal__event--deletable":this.event.deleting,"vuecal__event--all-day":this.event.allDay,"vuecal__event--dragging":!this.event.draggingStatic&&this.event.dragging,"vuecal__event--static":this.event.dragging&&this.event.draggingStatic,"vuecal__event--multiple-days":!!this.segment,"event-start":this.segment&&l&&!t,"event-middle":this.segment&&!l&&!t,"event-end":this.segment&&t&&!l}},segment(){return this.event.segments&&this.event.segments[this.cellFormattedDate]||null},draggable(){const{draggable:l,background:t,daysCount:s}=this.event;return this.vuecal.editEvents.drag&&l&&!t&&s===1},resizable(){const{editEvents:l,time:t}=this.vuecal;return l.resize&&this.event.resizable&&t&&!this.allDay&&(!this.segment||this.segment&&this.segment.isLastDay)&&this.view.id!=="month"},dnd(){return this.modules.dnd}}},Tl=Pe(Cl,[["render",Dl]]),Ml=["data-split","aria-label","onTouchstart","onMousedown","onDragover","onDrop"],El={key:0,class:"cell-time-labels"},$l=["innerHTML"],Sl={key:2,class:"vuecal__cell-events"},jl=["title"];function Vl(l,t,s,o,n,a){const c=$e("event");return i(),se(is,{class:Q(["vuecal__cell",a.cellClasses]),name:`slide-fade--${a.transitionDirection}`,tag:"div",appear:s.options.transitions,style:ye(a.cellStyles)},{default:z(()=>[(i(!0),r(J,null,te(a.splitsCount?a.splits:1,(d,u)=>(i(),r("div",{class:Q(["vuecal__flex vuecal__cell-content",a.splitsCount&&a.splitClasses(d)]),key:s.options.transitions?`${a.view.id}-${s.data.content}-${u}`:u,"data-split":a.splitsCount?d.id:!1,column:"",tabindex:"0","aria-label":s.data.content,onFocus:t[0]||(t[0]=m=>a.onCellFocus(m)),onKeypress:t[1]||(t[1]=qe(m=>a.onCellkeyPressEnter(m),["enter"])),onTouchstart:m=>!a.isDisabled&&a.onCellTouchStart(m,a.splitsCount?d.id:null),onMousedown:m=>!a.isDisabled&&a.onCellMouseDown(m,a.splitsCount?d.id:null),onClick:t[2]||(t[2]=m=>!a.isDisabled&&a.onCellClick(m)),onDblclick:t[3]||(t[3]=m=>!a.isDisabled&&a.onCellDblClick(m)),onContextmenu:t[4]||(t[4]=m=>!a.isDisabled&&s.options.cellContextmenu&&a.onCellContextMenu(m)),onDragenter:t[5]||(t[5]=m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragEnter(m,l.$data,s.data.startDate)),onDragover:m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragOver(m,l.$data,s.data.startDate,a.splitsCount?d.id:null),onDragleave:t[6]||(t[6]=m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragLeave(m,l.$data,s.data.startDate)),onDrop:m=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragDrop(m,l.$data,s.data.startDate,a.splitsCount?d.id:null)},[s.options.showTimeInCells&&s.options.time&&a.isWeekOrDayView&&!s.allDay?(i(),r("div",El,[(i(!0),r(J,null,te(a.vuecal.timeCells,(m,p)=>(i(),r("span",{class:"cell-time-label",key:p},g(m.label),1))),128))])):x("",!0),a.isWeekOrDayView&&!s.allDay&&a.specialHours.length?(i(!0),r(J,{key:1},te(a.specialHours,(m,p)=>(i(),r("div",{class:Q(["vuecal__special-hours",`vuecal__special-hours--day${m.day} ${m.class}`]),style:ye(`height: ${m.height}px;top: ${m.top}px`)},[m.label?(i(),r("div",{key:0,class:"special-hours-label",innerHTML:m.label},null,8,$l)):x("",!0)],6))),256)):x("",!0),ie(l.$slots,"cell-content",{events:a.events,selectCell:m=>a.selectCell(m,!0),split:a.splitsCount?d:!1}),a.eventsCount&&(a.isWeekOrDayView||a.view.id==="month"&&s.options.eventsOnMonthView)?(i(),r("div",Sl,[(i(!0),r(J,null,te(a.splitsCount?d.events:a.events,(m,p)=>(i(),se(c,{key:p,"cell-formatted-date":s.data.formattedDate,event:m,"all-day":s.allDay,"cell-events":a.splitsCount?d.events:a.events,overlaps:((a.splitsCount?d.overlaps[m._eid]:l.cellOverlaps[m._eid])||[]).overlaps,"event-position":((a.splitsCount?d.overlaps[m._eid]:l.cellOverlaps[m._eid])||[]).position,"overlaps-streak":a.splitsCount?d.overlapsStreak:l.cellOverlapsStreak},{event:z(({event:w,view:_})=>[ie(l.$slots,"event",{view:_,event:w})]),_:2},1032,["cell-formatted-date","event","all-day","cell-events","overlaps","event-position","overlaps-streak"]))),128))])):x("",!0)],42,Ml))),128)),a.timelineVisible?(i(),r("div",{class:"vuecal__now-line",style:ye(`top: ${a.todaysTimePosition}px`),key:s.options.transitions?`${a.view.id}-now-line`:"now-line",title:a.utils.date.formatTime(a.vuecal.now)},null,12,jl)):x("",!0)]),_:3},8,["class","name","appear","style"])}const Al={inject:["vuecal","utils","modules","view","domEvents"],components:{Event:Tl},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},data:{type:Object,required:!0},cellSplits:{type:Array,default:()=>[]},minTimestamp:{type:[Number,null],default:null},maxTimestamp:{type:[Number,null],default:null},cellWidth:{type:[Number,Boolean],default:!1},allDay:{type:Boolean,default:!1}},data:()=>({cellOverlaps:{},cellOverlapsStreak:1,timeAtCursor:null,highlighted:!1,highlightedSplit:null}),methods:{getSplitAtCursor({target:l}){let s=l.classList.contains("vuecal__cell-split")?l:this.vuecal.findAncestor(l,"vuecal__cell-split");return s&&(s=s.attributes["data-split"].value,parseInt(s).toString()===s.toString()&&(s=parseInt(s))),s||null},splitClasses(l){return{"vuecal__cell-split":!0,"vuecal__cell-split--highlighted":this.highlightedSplit===l.id,[l.class]:!!l.class}},checkCellOverlappingEvents(){this.options.time&&this.eventsCount&&!this.splitsCount&&(this.eventsCount===1?(this.cellOverlaps=[],this.cellOverlapsStreak=1):[this.cellOverlaps,this.cellOverlapsStreak]=this.utils.event.checkCellOverlappingEvents(this.events,this.options))},isDOMElementAnEvent(l){return this.vuecal.isDOMElementAnEvent(l)},selectCell(l,t=!1){const s=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.selectCell(t,this.timeAtCursor,s),this.timeAtCursor=null},onCellkeyPressEnter(l){this.isSelected||this.onCellFocus(l);const t=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.keyPressEnterCell(this.timeAtCursor,t),this.timeAtCursor=null},onCellFocus(l){if(!this.isSelected&&!this.isDisabled){this.isSelected=this.data.startDate;const t=this.splitsCount?this.getSplitAtCursor(l):null,s=this.timeAtCursor||this.data.startDate;this.vuecal.$emit("cell-focus",t?{date:s,split:t}:s)}},onCellMouseDown(l,t=null,s=!1){if("ontouchstart"in window&&!s)return!1;this.isSelected||this.onCellFocus(l);const{clickHoldACell:o,focusAnEvent:n}=this.domEvents;this.domEvents.cancelClickEventCreation=!1,o.eventCreated=!1,this.timeAtCursor=new Date(this.data.startDate);const{minutes:a,cursorCoords:{y:c}}=this.vuecal.minutesAtCursor(l);this.timeAtCursor.setMinutes(a);const d=this.isDOMElementAnEvent(l.target);!d&&n._eid&&((this.view.events.find(u=>u._eid===n._eid)||{}).focused=!1),this.editEvents.create&&!d&&this.setUpEventCreation(l,c)},setUpEventCreation(l,t){if(this.options.dragToCreateEvent&&["week","day"].includes(this.view.id)){const{dragCreateAnEvent:s}=this.domEvents;if(s.startCursorY=t,s.split=this.splitsCount?this.getSplitAtCursor(l):null,s.start=this.timeAtCursor,this.options.snapToTime){let o=this.timeAtCursor.getHours()*60+this.timeAtCursor.getMinutes();const n=o+this.options.snapToTime/2;o=n-n%this.options.snapToTime,s.start.setHours(0,o,0,0)}}else this.options.cellClickHold&&["month","week","day"].includes(this.view.id)&&this.setUpCellHoldTimer(l)},setUpCellHoldTimer(l){const{clickHoldACell:t}=this.domEvents;t.cellId=`${this.vuecal._.uid}_${this.data.formattedDate}`,t.split=this.splitsCount?this.getSplitAtCursor(l):null,t.timeoutId=setTimeout(()=>{if(t.cellId&&!this.domEvents.cancelClickEventCreation){const{_eid:s}=this.utils.event.createAnEvent(this.timeAtCursor,null,t.split?{split:t.split}:{});t.eventCreated=s}},t.timeout)},onCellTouchStart(l,t=null){this.onCellMouseDown(l,t,!0)},onCellClick(l){this.isDOMElementAnEvent(l.target)||this.selectCell(l)},onCellDblClick(l){const t=new Date(this.data.startDate);t.setMinutes(this.vuecal.minutesAtCursor(l).minutes);const s=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-dblclick",s?{date:t,split:s}:t),this.options.dblclickToNavigate&&this.vuecal.switchToNarrowerView()},onCellContextMenu(l){l.stopPropagation(),l.preventDefault();const t=new Date(this.data.startDate),{cursorCoords:s,minutes:o}=this.vuecal.minutesAtCursor(l);t.setMinutes(o);const n=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-contextmenu",{date:t,...s,...n||{},e:l})}},computed:{dnd(){return this.modules.dnd},nowInMinutes(){return this.utils.date.dateToMinutes(this.vuecal.now)},isBeforeMinDate(){return this.minTimestamp!==null&&this.minTimestamp>this.data.endDate.getTime()},isAfterMaxDate(){return this.maxTimestamp&&this.maxTimestamp<this.data.startDate.getTime()},isDisabled(){const{disableDays:l}=this.options,{isYearsOrYearView:t}=this.vuecal;return l.length&&l.includes(this.data.formattedDate)&&!t?!0:this.isBeforeMinDate||this.isAfterMaxDate},isSelected:{get(){let l=!1;const{selectedDate:t}=this.view;return this.view.id==="years"?l=t.getFullYear()===this.data.startDate.getFullYear():this.view.id==="year"?l=t.getFullYear()===this.data.startDate.getFullYear()&&t.getMonth()===this.data.startDate.getMonth():l=t.getTime()===this.data.startDate.getTime(),l},set(l){this.view.selectedDate=l,this.vuecal.$emit("update:selected-date",this.view.selectedDate)}},isWeekOrDayView(){return["week","day"].includes(this.view.id)},transitionDirection(){return this.vuecal.transitionDirection},specialHours(){return this.data.specialHours.map(l=>{let{from:t,to:s}=l;return t=Math.max(t,this.options.timeFrom),s=Math.min(s,this.options.timeTo),{...l,height:(s-t)*this.timeScale,top:(t-this.options.timeFrom)*this.timeScale}})},events(){const{startDate:l,endDate:t}=this.data;let s=[];if(!(["years","year"].includes(this.view.id)&&!this.options.eventsCountOnYearView)){if(s=this.view.events.slice(0),this.view.id==="month"&&s.push(...this.view.outOfScopeEvents),s=s.filter(o=>this.utils.event.eventInRange(o,l,t)),this.options.showAllDayEvents&&this.view.id!=="month"&&(s=s.filter(o=>!!o.allDay===this.allDay)),this.options.time&&this.isWeekOrDayView&&!this.allDay){const{timeFrom:o,timeTo:n}=this.options;s=s.filter(a=>{const c=a.daysCount>1&&a.segments[this.data.formattedDate]||{},d=a.daysCount===1&&a.startTimeMinutes<n&&a.endTimeMinutes>o,u=a.daysCount>1&&c.startTimeMinutes<n&&c.endTimeMinutes>o;return a.allDay||d||u||!1})}this.options.time&&this.isWeekOrDayView&&!(this.options.showAllDayEvents&&this.allDay)&&s.sort((o,n)=>o.start<n.start?-1:1),this.cellSplits.length||this.$nextTick(this.checkCellOverlappingEvents)}return s},eventsCount(){return this.events.length},splits(){return this.cellSplits.map((l,t)=>{const s=this.events.filter(a=>a.split===l.id),[o,n]=this.utils.event.checkCellOverlappingEvents(s.filter(a=>!a.background&&!a.allDay),this.options);return{...l,overlaps:o,overlapsStreak:n,events:s}})},splitsCount(){return this.splits.length},cellClasses(){return{[this.data.class]:!!this.data.class,"vuecal__cell--current":this.data.current,"vuecal__cell--today":this.data.today,"vuecal__cell--out-of-scope":this.data.outOfScope,"vuecal__cell--before-min":this.isDisabled&&this.isBeforeMinDate,"vuecal__cell--after-max":this.isDisabled&&this.isAfterMaxDate,"vuecal__cell--disabled":this.isDisabled,"vuecal__cell--selected":this.isSelected,"vuecal__cell--highlighted":this.highlighted,"vuecal__cell--has-splits":this.splitsCount,"vuecal__cell--has-events":this.eventsCount}},cellStyles(){return{...this.cellWidth?{width:`${this.cellWidth}%`}:{}}},timelineVisible(){const{time:l,timeTo:t}=this.options;return this.data.today&&this.isWeekOrDayView&&l&&!this.allDay&&this.nowInMinutes<=t},todaysTimePosition(){if(!this.data.today||!this.options.time)return;const l=this.nowInMinutes-this.options.timeFrom;return Math.round(l*this.timeScale)},timeScale(){return this.options.timeCellHeight/this.options.timeStep}}},$t=Pe(Al,[["render",Vl]]),Ol={key:0,class:"vuecal__all-day-text",style:{width:"3em"}};function Il(l,t,s,o,n,a){const c=$e("vuecal-cell");return i(),r("div",{class:"vuecal__flex vuecal__all-day",style:ye(s.cellOrSplitMinWidth&&{height:s.height})},[s.cellOrSplitMinWidth?x("",!0):(i(),r("div",Ol,[e("span",null,g(s.label),1)])),e("div",{class:Q(["vuecal__flex vuecal__cells",`${a.view.id}-view`]),grow:"",style:ye(s.cellOrSplitMinWidth?`min-width: ${s.cellOrSplitMinWidth}px`:"")},[(i(!0),r(J,null,te(s.cells,(d,u)=>(i(),se(c,{key:u,options:s.options,"edit-events":a.editEvents,data:d,"all-day":!0,"cell-width":s.options.hideWeekdays.length&&(a.vuecal.isWeekView||a.vuecal.isMonthView)&&a.vuecal.cellWidth,"min-timestamp":s.options.minTimestamp,"max-timestamp":s.options.maxTimestamp,"cell-splits":s.daySplits},{event:z(({event:m,view:p})=>[ie(l.$slots,"event",{view:p,event:m})]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],6)],4)}const Ll={inject:["vuecal","view","editEvents"],components:{"vuecal-cell":$t},props:{options:{type:Object,required:!0},cells:{type:Array,required:!0},label:{type:String,required:!0},daySplits:{type:Array,default:()=>[]},shortEvents:{type:Boolean,default:!0},height:{type:String,default:""},cellOrSplitMinWidth:{type:Number,default:null}},computed:{hasCellOrSplitWidth(){return!!(this.options.minCellWidth||this.daySplits.length&&this.options.minSplitWidth)}}},Pl=Pe(Ll,[["render",Il]]),Nl=["lang"],Ul={class:"default"},Rl={key:0,class:"vuecal__flex vuecal__body",grow:""},Fl=["onBlur","innerHTML"],Bl=["innerHTML"],Hl=["innerHTML"],Wl={class:"vuecal__flex",row:"",grow:""},Yl={key:0,class:"vuecal__time-column"},zl={class:"vuecal__time-cell-label"},ql={key:1,class:"vuecal__flex vuecal__week-numbers",column:""},Zl=["wrap","column"],Gl=["onBlur","innerHTML"],Kl=["innerHTML"],Jl=["innerHTML"],Xl=["wrap"],Ql=["innerHTML"],ea=["innerHTML"],ta={key:2,class:"vuecal__cell-events-count"},sa={key:3,class:"vuecal__no-event"},la=["onBlur","innerHTML"],aa=["innerHTML"],ia={key:2,class:"vuecal__event-time"},na={key:0},oa={key:1,class:"days-to-end"},ra=["innerHTML"],da={key:0,class:"vuecal__scrollbar-check"};function ua(l,t,s,o,n,a){const c=$e("vuecal-header"),d=$e("all-day-bar"),u=$e("weekdays-headings"),m=$e("vuecal-cell");return i(),r("div",{class:Q(["vuecal__flex vuecal",a.cssClasses]),column:"",ref:"vuecal",lang:s.locale},[v(c,{options:l.$props,"edit-events":a.editEvents,"view-props":{views:a.views,weekDaysInHeader:a.weekDaysInHeader},"week-days":a.weekDays,"has-splits":a.hasSplits,"day-splits":a.daySplits,"switch-to-narrower-view":a.switchToNarrowerView},Xe({"arrow-prev":z(()=>[ie(l.$slots,"arrow-prev",{},()=>[t[0]||(t[0]=q("Â ")),t[1]||(t[1]=e("i",{class:"angle"},null,-1)),t[2]||(t[2]=q("Â "))])]),"arrow-next":z(()=>[ie(l.$slots,"arrow-next",{},()=>[t[3]||(t[3]=q("Â ")),t[4]||(t[4]=e("i",{class:"angle"},null,-1)),t[5]||(t[5]=q("Â "))])]),"today-button":z(()=>[ie(l.$slots,"today-button",{},()=>[e("span",Ul,g(n.texts.today),1)])]),title:z(()=>[ie(l.$slots,"title",{title:a.viewTitle,view:n.view},()=>[q(g(a.viewTitle),1)])]),_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:z(({heading:p,view:w})=>[ie(l.$slots,"weekday-heading",{heading:p,view:w})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:z(({split:p})=>[ie(l.$slots,"split-label",{split:p,view:n.view.id})]),key:"1"}:void 0]),1032,["options","edit-events","view-props","week-days","has-splits","day-splits","switch-to-narrower-view"]),s.hideBody?x("",!0):(i(),r("div",Rl,[v(ze,{name:`slide-fade--${n.transitionDirection}`,appear:s.transitions},{default:z(()=>[(i(),r("div",{class:"vuecal__flex",style:{"min-width":"100%"},key:s.transitions?n.view.id:!1,column:""},[s.showAllDayEvents&&a.hasTimeColumn&&(!a.cellOrSplitMinWidth||a.isDayView&&!s.minSplitWidth)?(i(),se(d,mt(vt({key:0},a.allDayBar)),{event:z(({event:p,view:w})=>[ie(l.$slots,"event",{view:w,event:p},()=>[a.editEvents.title&&p.titleEditable?(i(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:_=>a.onEventTitleBlur(_,p),innerHTML:p.title},null,40,Fl)):p.title?(i(),r("div",{key:1,class:"vuecal__event-title",innerHTML:p.title},null,8,Bl)):x("",!0),p.content&&!a.hasShortEvents&&!a.isShortMonthView?(i(),r("div",{key:2,class:"vuecal__event-content",innerHTML:p.content},null,8,Hl)):x("",!0)])]),_:3},16)):x("",!0),e("div",{class:Q(["vuecal__bg",{vuecal__flex:!a.hasTimeColumn}]),column:""},[e("div",Wl,[a.hasTimeColumn?(i(),r("div",Yl,[s.showAllDayEvents&&a.cellOrSplitMinWidth&&!(a.isDayView&&!s.minSplitWidth)?(i(),r("div",{key:0,class:"vuecal__all-day-text",style:ye({height:a.allDayBar.height})},[e("span",null,g(n.texts.allDay),1)],4)):x("",!0),(i(!0),r(J,null,te(a.timeCells,(p,w)=>(i(),r("div",{class:"vuecal__time-cell",key:w,style:ye(`height: ${s.timeCellHeight}px`)},[ie(l.$slots,"time-cell",{hours:p.hours,minutes:p.minutes},()=>[t[6]||(t[6]=e("span",{class:"vuecal__time-cell-line"},null,-1)),e("span",zl,g(p.label),1)])],4))),128))])):x("",!0),s.showWeekNumbers&&a.isMonthView?(i(),r("div",ql,[(i(),r(J,null,te(6,p=>e("div",{class:"vuecal__flex vuecal__week-number-cell",key:p,grow:""},[ie(l.$slots,"week-number-cell",{week:a.getWeekNumber(p-1)},()=>[q(g(a.getWeekNumber(p-1)),1)])])),64))])):x("",!0),e("div",{class:Q(["vuecal__flex vuecal__cells",`${n.view.id}-view`]),grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,column:!!a.cellOrSplitMinWidth},[a.cellOrSplitMinWidth&&a.isWeekView?(i(),se(u,{key:0,"transition-direction":n.transitionDirection,"week-days":a.weekDays,"switch-to-narrower-view":a.switchToNarrowerView,style:ye(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:z(({heading:p,view:w})=>[ie(l.$slots,"weekday-heading",{heading:p,view:w})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:z(({split:p})=>[ie(l.$slots,"split-label",{split:p,view:n.view.id})]),key:"1"}:void 0]),1032,["transition-direction","week-days","switch-to-narrower-view","style"])):a.hasSplits&&s.stickySplitLabels&&s.minSplitWidth?(i(),r("div",{key:1,class:"vuecal__flex vuecal__split-days-headers",style:ye(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(i(!0),r(J,null,te(a.daySplits,(p,w)=>(i(),r("div",{class:Q(["day-split-header",p.class||!1]),key:w},[ie(l.$slots,"split-label",{split:p,view:n.view.id},()=>[q(g(p.label),1)])],2))),128))],4)):x("",!0),s.showAllDayEvents&&a.hasTimeColumn&&(a.isWeekView&&a.cellOrSplitMinWidth||a.isDayView&&a.hasSplits&&s.minSplitWidth)?(i(),se(d,mt(vt({key:2},a.allDayBar)),{event:z(({event:p,view:w})=>[ie(l.$slots,"event",{view:w,event:p},()=>[a.editEvents.title&&p.titleEditable?(i(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:_=>a.onEventTitleBlur(_,p),innerHTML:p.title},null,40,Gl)):p.title?(i(),r("div",{key:1,class:"vuecal__event-title",innerHTML:p.title},null,8,Kl)):x("",!0),p.content&&!a.hasShortEvents&&!a.isShortMonthView?(i(),r("div",{key:2,class:"vuecal__event-content",innerHTML:p.content},null,8,Jl)):x("",!0)])]),_:3},16)):x("",!0),e("div",{class:"vuecal__flex",ref:p=>n.cellsEl=p,grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,style:ye(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(i(!0),r(J,null,te(a.viewCells,(p,w)=>(i(),se(m,{key:w,options:l.$props,"edit-events":a.editEvents,data:p,"cell-width":s.hideWeekdays.length&&(a.isWeekView||a.isMonthView)&&a.cellWidth,"min-timestamp":a.minTimestamp,"max-timestamp":a.maxTimestamp,"cell-splits":a.hasSplits&&a.daySplits||[]},{"cell-content":z(({events:_,split:V,selectCell:M})=>[ie(l.$slots,"cell-content",{cell:p,view:n.view,goNarrower:M,events:_},()=>[V&&!s.stickySplitLabels?(i(),r("div",{key:0,class:"split-label",innerHTML:V.label},null,8,Ql)):x("",!0),p.content?(i(),r("div",{key:1,class:"vuecal__cell-date",innerHTML:p.content},null,8,ea)):x("",!0),(a.isMonthView&&!s.eventsOnMonthView||a.isYearsOrYearView&&s.eventsCountOnYearView)&&_.length?(i(),r("div",ta,[ie(l.$slots,"events-count",{view:n.view,events:_},()=>[q(g(_.length),1)])])):x("",!0),!a.cellOrSplitHasEvents(_,V)&&a.isWeekOrDayView?(i(),r("div",sa,[ie(l.$slots,"no-event",{},()=>[q(g(n.texts.noEvent),1)])])):x("",!0)])]),event:z(({event:_,view:V})=>[ie(l.$slots,"event",{view:V,event:_},()=>[a.editEvents.title&&_.titleEditable?(i(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:M=>a.onEventTitleBlur(M,_),innerHTML:_.title},null,40,la)):_.title?(i(),r("div",{key:1,class:"vuecal__event-title",innerHTML:_.title},null,8,aa)):x("",!0),s.time&&!_.allDay&&!(a.isMonthView&&(_.allDay||s.showAllDayEvents==="short"))&&!a.isShortMonthView?(i(),r("div",ia,[q(g(n.utils.date.formatTime(_.start,a.TimeFormat)),1),_.endTimeMinutes?(i(),r("span",na,"Â - "+g(n.utils.date.formatTime(_.end,a.TimeFormat,null,!0)),1)):x("",!0),_.daysCount>1&&(_.segments[p.formattedDate]||{}).isFirstDay?(i(),r("small",oa,"Â +"+g(_.daysCount-1)+g((n.texts.day[0]||"").toLowerCase()),1)):x("",!0)])):x("",!0),_.content&&!(a.isMonthView&&_.allDay&&s.showAllDayEvents==="short")&&!a.isShortMonthView?(i(),r("div",{key:3,class:"vuecal__event-content",innerHTML:_.content},null,8,ra)):x("",!0)])]),"no-event":z(()=>[ie(l.$slots,"no-event",{},()=>[q(g(n.texts.noEvent),1)])]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],12,Xl)],10,Zl)])],2)]))]),_:3},8,["name","appear"]),n.ready?x("",!0):(i(),r("div",da,t[7]||(t[7]=[e("div",null,null,-1)])))]))],10,Nl)}const Be=1440,Ye={weekDays:Array(7).fill(""),weekDaysShort:[],months:Array(12).fill(""),years:"",year:"",month:"",week:"",day:"",today:"",noEvent:"",allDay:"",deleteEvent:"",createEvent:"",dateFormat:"dddd MMMM D, YYYY",am:"am",pm:"pm"},bt=["years","year","month","week","day"],wt=new Js(Ye),ca={name:"vue-cal",components:{"vuecal-cell":$t,"vuecal-header":xl,WeekdaysHeadings:Et,AllDayBar:Pl},provide(){return{vuecal:this,utils:this.utils,modules:this.modules,previous:this.previous,next:this.next,switchView:this.switchView,updateSelectedDate:this.updateSelectedDate,editEvents:this.editEvents,view:this.view,domEvents:this.domEvents}},props:{activeView:{type:String,default:"week"},allDayBarHeight:{type:[String,Number],default:"25px"},cellClickHold:{type:Boolean,default:!0},cellContextmenu:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:!1},dblclickToNavigate:{type:Boolean,default:!0},disableDatePrototypes:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},disableViews:{type:Array,default:()=>[]},dragToCreateEvent:{type:Boolean,default:!0},dragToCreateThreshold:{type:Number,default:15},editableEvents:{type:[Boolean,Object],default:!1},events:{type:Array,default:()=>[]},eventsCountOnYearView:{type:Boolean,default:!1},eventsOnMonthView:{type:[Boolean,String],default:!1},hideBody:{type:Boolean,default:!1},hideTitleBar:{type:Boolean,default:!1},hideViewSelector:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:[String,Object],default:"en"},maxDate:{type:[String,Date],default:""},minCellWidth:{type:Number,default:0},minDate:{type:[String,Date],default:""},minEventWidth:{type:Number,default:0},minSplitWidth:{type:Number,default:0},onEventClick:{type:[Function,null],default:null},onEventCreate:{type:[Function,null],default:null},onEventDblclick:{type:[Function,null],default:null},overlapsPerTimeStep:{type:Boolean,default:!1},resizeX:{type:Boolean,default:!1},selectedDate:{type:[String,Date],default:""},showAllDayEvents:{type:[Boolean,String],default:!1},showTimeInCells:{type:Boolean,default:!1},showWeekNumbers:{type:[Boolean,String],default:!1},snapToTime:{type:Number,default:0},small:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},splitDays:{type:Array,default:()=>[]},startWeekOnSunday:{type:Boolean,default:!1},stickySplitLabels:{type:Boolean,default:!1},time:{type:Boolean,default:!0},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:Be},todayButton:{type:Boolean,default:!1},transitions:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},watchRealTime:{type:Boolean,default:!1},xsmall:{type:Boolean,default:!1}},data(){return{ready:!1,texts:{...Ye},utils:{date:(this.disableDatePrototypes?wt.removePrototypes():!1)||wt,cell:null,event:null},modules:{dnd:null},cellsEl:null,view:{id:"",title:"",startDate:null,endDate:null,firstCellDate:null,lastCellDate:null,selectedDate:null,events:[]},eventIdIncrement:1,now:new Date,timeTickerIds:[null,null],domEvents:{resizeAnEvent:{_eid:null,start:null,split:null,segment:null,originalEndTimeMinutes:0,originalEnd:null,end:null,startCell:null,endCell:null},dragAnEvent:{_eid:null},dragCreateAnEvent:{startCursorY:null,start:null,split:null,event:null},focusAnEvent:{_eid:null,mousedUp:!1},clickHoldAnEvent:{_eid:null,timeout:1200,timeoutId:null},dblTapACell:{taps:0,timeout:500},clickHoldACell:{cellId:null,split:null,timeout:1200,timeoutId:null,eventCreated:!1},cancelClickEventCreation:!1},mutableEvents:[],transitionDirection:"right"}},methods:{async loadLocale(l){if(typeof this.locale=="object"){this.texts=Object.assign({},Ye,l),this.utils.date.updateTexts(this.texts);return}const t=await Ks(Object.assign({"./i18n/ar.json":()=>ee(()=>import("./ar.es-bitOgb9K.js"),[]),"./i18n/bg.json":()=>ee(()=>import("./bg.es-5tp0KQRo.js"),[]),"./i18n/bn.json":()=>ee(()=>import("./bn.es-C_qR0y0-.js"),[]),"./i18n/bs.json":()=>ee(()=>import("./bs.es-DduooXS8.js"),[]),"./i18n/ca.json":()=>ee(()=>import("./ca.es-DYDNDJFJ.js"),[]),"./i18n/cs.json":()=>ee(()=>import("./cs.es-CvnAvfoI.js"),[]),"./i18n/da.json":()=>ee(()=>import("./da.es-C_eJXDX3.js"),[]),"./i18n/de.json":()=>ee(()=>import("./de.es-Cp-R9E16.js"),[]),"./i18n/el.json":()=>ee(()=>import("./el.es-BZ44a1Tb.js"),[]),"./i18n/en.json":()=>ee(()=>import("./en.es-DwVNOttH.js"),[]),"./i18n/es.json":()=>ee(()=>import("./es.es-DO8PaQ_q.js"),[]),"./i18n/et.json":()=>ee(()=>import("./et.es-DdRIcUrz.js"),[]),"./i18n/fa.json":()=>ee(()=>import("./fa.es-XN0av8Tx.js"),[]),"./i18n/fi.json":()=>ee(()=>import("./fi.es-B0Iy6aas.js"),[]),"./i18n/fr.json":()=>ee(()=>import("./fr.es-B7WXlprl.js"),[]),"./i18n/he.json":()=>ee(()=>import("./he.es-BWEk5prp.js"),[]),"./i18n/hr.json":()=>ee(()=>import("./hr.es-B_iqHQyr.js"),[]),"./i18n/hu.json":()=>ee(()=>import("./hu.es-D_t4Ibxf.js"),[]),"./i18n/id.json":()=>ee(()=>import("./id.es-CzHAK-XV.js"),[]),"./i18n/is.json":()=>ee(()=>import("./is.es-DChRpym4.js"),[]),"./i18n/it.json":()=>ee(()=>import("./it.es-CquQA5xx.js"),[]),"./i18n/ja.json":()=>ee(()=>import("./ja.es-B19gsG6H.js"),[]),"./i18n/ka.json":()=>ee(()=>import("./ka.es-CuOe65jc.js"),[]),"./i18n/ko.json":()=>ee(()=>import("./ko.es-CsMl2USK.js"),[]),"./i18n/lt.json":()=>ee(()=>import("./lt.es-vqgjGyMx.js"),[]),"./i18n/mn.json":()=>ee(()=>import("./mn.es-BmdwFdas.js"),[]),"./i18n/nl.json":()=>ee(()=>import("./nl.es-CFxVMCWy.js"),[]),"./i18n/no.json":()=>ee(()=>import("./no.es-qRcuRMwl.js"),[]),"./i18n/pl.json":()=>ee(()=>import("./pl.es-BQ3a0ltx.js"),[]),"./i18n/pt-br.json":()=>ee(()=>import("./pt-br.es-U9bVHsgs.js"),[]),"./i18n/pt-pt.json":()=>ee(()=>import("./pt-pt.es-U9bVHsgs.js"),[]),"./i18n/ro.json":()=>ee(()=>import("./ro.es-ldjMjt3l.js"),[]),"./i18n/ru.json":()=>ee(()=>import("./ru.es-CS-QKsYL.js"),[]),"./i18n/sk.json":()=>ee(()=>import("./sk.es-CAe8sEvL.js"),[]),"./i18n/sl.json":()=>ee(()=>import("./sl.es-rdzOxu_X.js"),[]),"./i18n/sq.json":()=>ee(()=>import("./sq.es-BY5E06HI.js"),[]),"./i18n/sr.json":()=>ee(()=>import("./sr.es-QPseRVBy.js"),[]),"./i18n/sv.json":()=>ee(()=>import("./sv.es-BfPUYcV1.js"),[]),"./i18n/tr.json":()=>ee(()=>import("./tr.es-Cl6kz_IH.js"),[]),"./i18n/uk.json":()=>ee(()=>import("./uk.es-DBEtNQnZ.js"),[]),"./i18n/vi.json":()=>ee(()=>import("./vi.es-Bx2g_1jx.js"),[]),"./i18n/zh-cn.json":()=>ee(()=>import("./zh-cn.es-BWMmCH-R.js"),[]),"./i18n/zh-hk.json":()=>ee(()=>import("./zh-hk.es-DFZ0bKvi.js"),[])}),`./i18n/${l}.json`,3);this.texts=Object.assign({},Ye,t),this.utils.date.updateTexts(this.texts)},loadDragAndDrop(){ee(()=>import("./drag-and-drop.es-CbCm7IHa.js"),[]).then(l=>{const{DragAndDrop:t}=l;this.modules.dnd=new t(this)}).catch(()=>console.warn("Vue Cal: Missing drag & drop module."))},validateView(l){return bt.includes(l)||(console.error(`Vue Cal: invalid active-view parameter provided: "${l}".
A valid view must be one of: ${bt.join(", ")}.`),l="week"),this.enabledViews.includes(l)||(console.warn(`Vue Cal: the provided active-view "${l}" is disabled. Using the "${this.enabledViews[0]}" view instead.`),l=this.enabledViews[0]),l},switchToNarrowerView(l=null){this.transitionDirection="right";const t=this.enabledViews[this.enabledViews.indexOf(this.view.id)+1];t&&this.switchView(t,l)},switchView(l,t=null,s=!1){l=this.validateView(l);const o=this.utils.date,n=this.view.startDate&&this.view.startDate.getTime();if(this.transitions&&s){if(this.view.id===l)return;const d=this.enabledViews;this.transitionDirection=d.indexOf(this.view.id)>d.indexOf(l)?"left":"right"}const a=this.view.id;switch(this.view.events=[],this.view.id=l,this.view.firstCellDate=null,this.view.lastCellDate=null,t||(t=this.view.selectedDate||this.view.startDate),l){case"years":{this.view.startDate=new Date(Math.floor(t.getFullYear()/25)*25||2e3,0,1),this.view.endDate=new Date(this.view.startDate.getFullYear()+25,0,1),this.view.endDate.setSeconds(-1);break}case"year":{this.view.startDate=new Date(t.getFullYear(),0,1),this.view.endDate=new Date(t.getFullYear()+1,0,1),this.view.endDate.setSeconds(-1);break}case"month":{this.view.startDate=new Date(t.getFullYear(),t.getMonth(),1),this.view.endDate=new Date(t.getFullYear(),t.getMonth()+1,1),this.view.endDate.setSeconds(-1);let d=new Date(this.view.startDate);if(d.getDay()!==(this.startWeekOnSunday?0:1)&&(d=o.getPreviousFirstDayOfWeek(d,this.startWeekOnSunday)),this.view.firstCellDate=d,this.view.lastCellDate=o.addDays(d,41),this.view.lastCellDate.setHours(23,59,59,0),this.hideWeekends){if([0,6].includes(this.view.firstCellDate.getDay())){const u=this.view.firstCellDate.getDay()===6&&!this.startWeekOnSunday?2:1;this.view.firstCellDate=o.addDays(this.view.firstCellDate,u)}if([0,6].includes(this.view.startDate.getDay())){const u=this.view.startDate.getDay()===6?2:1;this.view.startDate=o.addDays(this.view.startDate,u)}if([0,6].includes(this.view.lastCellDate.getDay())){const u=this.view.lastCellDate.getDay()===0&&!this.startWeekOnSunday?2:1;this.view.lastCellDate=o.subtractDays(this.view.lastCellDate,u)}if([0,6].includes(this.view.endDate.getDay())){const u=this.view.endDate.getDay()===0?2:1;this.view.endDate=o.subtractDays(this.view.endDate,u)}}break}case"week":{t=o.getPreviousFirstDayOfWeek(t,this.startWeekOnSunday);const d=this.hideWeekends?5:7;this.view.startDate=this.hideWeekends&&this.startWeekOnSunday?o.addDays(t,1):t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=o.addDays(t,d),this.view.endDate.setSeconds(-1);break}case"day":{this.view.startDate=t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=new Date(t),this.view.endDate.setHours(23,59,59,0);break}}this.addEventsToView();const c=this.view.startDate&&this.view.startDate.getTime();if(!(a===l&&c===n)&&(this.$emit("update:activeView",l),this.ready)){const d=this.view.startDate,u={view:l,startDate:d,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate,outOfScopeEvents:this.view.outOfScopeEvents.map(this.cleanupEvent)}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:o.getWeek(this.startWeekOnSunday?o.addDays(d,1):d)}:{}};this.$emit("view-change",u)}},previous(){this.previousNext(!1)},next(){this.previousNext()},previousNext(l=!0){const t=this.utils.date;this.transitionDirection=l?"right":"left";const s=l?1:-1;let o=null;const{startDate:n,id:a}=this.view;switch(a){case"years":o=new Date(n.getFullYear()+25*s,0,1);break;case"year":o=new Date(n.getFullYear()+1*s,1,1);break;case"month":o=new Date(n.getFullYear(),n.getMonth()+1*s,1);break;case"week":o=t[l?"addDays":"subtractDays"](t.getPreviousFirstDayOfWeek(n,this.startWeekOnSunday),7);break;case"day":o=t[l?"addDays":"subtractDays"](n,1);const c=o.getDay(),d=this.startWeekOnSunday?c:(c||7)-1;if(this.weekDays[d].hide){const m=this.weekDays.map((w,_)=>({...w,i:_}));let p=0;l?([...m.slice(d),...m].find(w=>(p++,!w.hide)).i,p--):[...m,...m.slice(0,d)].reverse().find(w=>(p++,!w.hide)).i,o=t[l?"addDays":"subtractDays"](o,p)}break}o&&this.switchView(a,o)},addEventsToView(l=[]){const t=this.utils.event,{startDate:s,endDate:o,firstCellDate:n,lastCellDate:a}=this.view;if(l.length||(this.view.events=[]),l=l.length?l:[...this.mutableEvents],!l||this.isYearsOrYearView&&!this.eventsCountOnYearView)return;let c=l.filter(d=>t.eventInRange(d,s,o));!this.isYearsOrYearView&&!(this.isMonthView&&!this.eventsOnMonthView)&&(c=c.map(d=>d.daysCount>1?t.createEventSegments(d,n||s,a||o):d)),this.view.events.push(...c),this.isMonthView&&(this.view.outOfScopeEvents=[],l.forEach(d=>{(t.eventInRange(d,n,s)||t.eventInRange(d,o,a))&&(this.view.events.some(u=>u._eid===d._eid)||this.view.outOfScopeEvents.push(d))}))},findAncestor(l,t){for(;(l=l.parentElement)&&!l.classList.contains(t););return l},isDOMElementAnEvent(l){return l.classList.contains("vuecal__event")||this.findAncestor(l,"vuecal__event")},onMouseMove(l){const{resizeAnEvent:t,dragAnEvent:s,dragCreateAnEvent:o}=this.domEvents;t._eid===null&&s._eid===null&&!o.start||(l.preventDefault(),t._eid?this.eventResizing(l):this.dragToCreateEvent&&o.start&&this.eventDragCreation(l))},onMouseUp(l){const{focusAnEvent:t,resizeAnEvent:s,clickHoldAnEvent:o,clickHoldACell:n,dragCreateAnEvent:a}=this.domEvents,{_eid:c}=o,{_eid:d}=s;let u=!1;const{event:m,start:p}=a,w=this.isDOMElementAnEvent(l.target),_=t.mousedUp;if(t.mousedUp=!1,w&&(this.domEvents.cancelClickEventCreation=!0),n.eventCreated)return;if(d){const{originalEnd:M,originalEndTimeMinutes:S,endTimeMinutes:h}=s,f=this.view.events.find(k=>k._eid===s._eid);if(u=h&&h!==S,f&&f.end.getTime()!==M.getTime()){const k=this.mutableEvents.find(C=>C._eid===s._eid);k.endTimeMinutes=f.endTimeMinutes,k.end=f.end;const E=this.cleanupEvent(f),j={...this.cleanupEvent(f),end:M,endTimeMinutes:f.originalEndTimeMinutes};this.$emit("event-duration-change",{event:E,oldDate:s.originalEnd,originalEvent:j}),this.$emit("event-change",{event:E,originalEvent:j})}f&&(f.resizing=!1),s._eid=null,s.start=null,s.split=null,s.segment=null,s.originalEndTimeMinutes=null,s.originalEnd=null,s.endTimeMinutes=null,s.startCell=null,s.endCell=null}else p&&(m&&(this.emitWithEvent("event-drag-create",m),a.event.resizing=!1),a.start=null,a.split=null,a.event=null);!w&&!d&&this.unfocusEvent(),o.timeoutId&&!c&&(clearTimeout(o.timeoutId),o.timeoutId=null),n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=null);const V=typeof this.onEventClick=="function";if(_&&!u&&!c&&!m&&V){let M=this.view.events.find(S=>S._eid===t._eid);return!M&&this.isMonthView&&(M=this.view.outOfScopeEvents.find(S=>S._eid===t._eid)),M&&this.onEventClick(M,l)}},onKeyUp(l){l.keyCode===27&&this.cancelDelete()},eventResizing(l){const{resizeAnEvent:t}=this.domEvents,s=this.view.events.find(m=>m._eid===t._eid)||{segments:{}},{minutes:o,cursorCoords:n}=this.minutesAtCursor(l),a=s.segments&&s.segments[t.segment],{date:c,event:d}=this.utils,u=Math.max(o,this.timeFrom+1,(a||s).startTimeMinutes+1);if(s.endTimeMinutes=t.endTimeMinutes=u,this.snapToTime){const m=s.endTimeMinutes+this.snapToTime/2;s.endTimeMinutes=m-m%this.snapToTime}if(a&&(a.endTimeMinutes=s.endTimeMinutes),s.end.setHours(0,s.endTimeMinutes,s.endTimeMinutes===Be?-1:0,0),this.resizeX&&this.isWeekView){s.daysCount=c.countDays(s.start,s.end);const m=this.cellsEl,p=m.offsetWidth/m.childElementCount,w=Math.floor(n.x/p);if(t.startCell===null&&(t.startCell=w-(s.daysCount-1)),t.endCell!==w){t.endCell=w;const _=c.addDays(s.start,w-t.startCell),V=Math.max(c.countDays(s.start,_),1);if(V!==s.daysCount){let M=null;V>s.daysCount?M=d.addEventSegment(s):M=d.removeEventSegment(s),t.segment=M,s.endTimeMinutes+=.001}}}this.$emit("event-resizing",{_eid:s._eid,end:s.end,endTimeMinutes:s.endTimeMinutes})},eventDragCreation(l){const{dragCreateAnEvent:t}=this.domEvents,{start:s,startCursorY:o,split:n}=t,a=new Date(s),{minutes:c,cursorCoords:{y:d}}=this.minutesAtCursor(l);if(!(!t.event&&Math.abs(o-d)<this.dragToCreateThreshold))if(t.event){if(a.setHours(0,c,c===Be?-1:0,0),this.snapToTime){let p=a.getHours()*60+a.getMinutes();const w=p+this.snapToTime/2;p=w-w%this.snapToTime,a.setHours(0,p,0,0)}const u=s<a,{event:m}=t;m.start=u?s:a,m.end=u?a:s,m.startTimeMinutes=m.start.getHours()*60+m.start.getMinutes(),m.endTimeMinutes=m.end.getHours()*60+m.end.getMinutes()}else{if(t.event=this.utils.event.createAnEvent(s,1,{split:n}),!t.event){t.start=null,t.split=null,t.event=null;return}t.event.resizing=!0}},unfocusEvent(){const{focusAnEvent:l,clickHoldAnEvent:t}=this.domEvents,s=this.view.events.find(o=>o._eid===(l._eid||t._eid));l._eid=null,t._eid=null,s&&(s.focused=!1,s.deleting=!1)},cancelDelete(){const{clickHoldAnEvent:l}=this.domEvents;if(l._eid){const t=this.view.events.find(s=>s._eid===l._eid);t&&(t.deleting=!1),l._eid=null,l.timeoutId=null}},onEventTitleBlur(l,t){if(t.title===l.target.innerHTML)return;const s=t.title;t.title=l.target.innerHTML;const o=this.cleanupEvent(t);this.$emit("event-title-change",{event:o,oldTitle:s}),this.$emit("event-change",{event:o,originalEvent:{...o,title:s}})},updateMutableEvents(){const l=this.utils.date;this.mutableEvents=[],this.events.forEach(t=>{const s=typeof t.start=="string"?l.stringToDate(t.start):t.start,o=l.formatDateLite(s),n=l.dateToMinutes(s);let a=null;typeof t.end=="string"&&t.end.includes("24:00")?(a=new Date(t.end.replace(" 24:00","")),a.setHours(23,59,59,0)):a=typeof t.end=="string"?l.stringToDate(t.end):t.end;let c=l.formatDateLite(a),d=l.dateToMinutes(a);(!d||d===Be)&&(!this.time||typeof t.end=="string"&&t.end.length===10?a.setHours(23,59,59,0):a.setSeconds(a.getSeconds()-1),c=l.formatDateLite(a),d=Be);const u=o!==c;t=Object.assign({...this.utils.event.eventDefaults},t,{_eid:`${this._.uid}_${this.eventIdIncrement++}`,segments:u?{}:null,start:s,startTimeMinutes:n,end:a,endTimeMinutes:d,daysCount:u?l.countDays(s,a):1,class:t.class}),this.mutableEvents.push(t)})},minutesAtCursor(l){return this.utils.cell.minutesAtCursor(l)},createEvent(l,t,s={}){return this.utils.event.createAnEvent(l,t,s)},cleanupEvent(l){return l={...l},["segments","deletable","deleting","titleEditable","resizable","resizing","draggable","dragging","draggingStatic","focused"].forEach(s=>{s in l&&delete l[s]}),l.repeat||delete l.repeat,l},emitWithEvent(l,t){this.$emit(l,this.cleanupEvent(t))},updateSelectedDate(l){if(l&&typeof l=="string"?l=this.utils.date.stringToDate(l):l=new Date(l),l&&l instanceof Date){const{selectedDate:t}=this.view;t&&(this.transitionDirection=t.getTime()>l.getTime()?"left":"right"),l.setHours(0,0,0,0),(!t||t.getTime()!==l.getTime())&&(this.view.selectedDate=l),this.switchView(this.view.id)}this.$emit("update:selected-date",this.view.selectedDate)},getWeekNumber(l){const t=this.utils.date,o=this.firstCellDateWeekNumber+l,n=this.startWeekOnSunday?1:0;return o>52?t.getWeek(t.addDays(this.view.firstCellDate,7*l+n)):o},timeTick(){this.now=new Date,this.timeTickerIds[1]=setTimeout(this.timeTick,60*1e3)},updateDateTexts(){this.utils.date.updateTexts(this.texts)},alignWithScrollbar(){if(document.getElementById("vuecal-align-with-scrollbar"))return;const l=this.$refs.vuecal.getElementsByClassName("vuecal__scrollbar-check")[0],t=l.offsetWidth-l.children[0].offsetWidth;if(t){const s=document.createElement("style");s.id="vuecal-align-with-scrollbar",s.type="text/css",s.innerHTML=`.vuecal--view-with-time .vuecal__weekdays-headings,.vuecal--view-with-time .vuecal__all-day {padding-right: ${t}px}`,document.head.appendChild(s)}},cellOrSplitHasEvents(l,t=null){return l.length&&(!t&&l.length||t&&l.some(s=>s.split===t.id))}},created(){this.utils.cell=new Qs(this),this.utils.event=new tl(this,this.utils.date),this.loadLocale(this.locale),this.editEvents.drag&&this.loadDragAndDrop(),this.updateMutableEvents(this.events),this.view.id=this.currentView,this.selectedDate?this.updateSelectedDate(this.selectedDate):(this.view.selectedDate=new Date,this.switchView(this.currentView)),this.time&&this.watchRealTime&&(this.timeTickerIds[0]=setTimeout(this.timeTick,(60-this.now.getSeconds())*1e3))},mounted(){const l=this.utils.date,t="ontouchstart"in window,{resize:s,drag:o,create:n,delete:a,title:c}=this.editEvents,d=this.onEventClick&&typeof this.onEventClick=="function";(s||o||n||a||c||d)&&window.addEventListener(t?"touchend":"mouseup",this.onMouseUp),(s||o||n&&this.dragToCreateEvent)&&window.addEventListener(t?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),c&&window.addEventListener("keyup",this.onKeyUp),t&&(this.$refs.vuecal.oncontextmenu=function(p){p.preventDefault(),p.stopPropagation()}),this.hideBody||this.alignWithScrollbar();const u=this.view.startDate,m={view:this.view.id,startDate:u,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:l.getWeek(this.startWeekOnSunday?l.addDays(u,1):u)}:{}};this.$emit("ready",m),this.ready=!0},beforeUnmount(){const l="ontouchstart"in window;window.removeEventListener(l?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),window.removeEventListener(l?"touchend":"mouseup",this.onMouseUp),window.removeEventListener("keyup",this.onKeyUp),this.timeTickerIds[0]&&clearTimeout(this.timeTickerIds[0]),this.timeTickerIds[1]&&clearTimeout(this.timeTickerIds[1]),this.timeTickerIds=[null,null]},computed:{editEvents(){return this.editableEvents&&typeof this.editableEvents=="object"?{title:!!this.editableEvents.title,drag:!!this.editableEvents.drag,resize:!!this.editableEvents.resize,create:!!this.editableEvents.create,delete:!!this.editableEvents.delete}:{title:!!this.editableEvents,drag:!!this.editableEvents,resize:!!this.editableEvents,create:!!this.editableEvents,delete:!!this.editableEvents}},views(){return{years:{label:this.texts.years,enabled:!this.disableViews.includes("years")},year:{label:this.texts.year,enabled:!this.disableViews.includes("year")},month:{label:this.texts.month,enabled:!this.disableViews.includes("month")},week:{label:this.texts.week,enabled:!this.disableViews.includes("week")},day:{label:this.texts.day,enabled:!this.disableViews.includes("day")}}},currentView(){return this.validateView(this.activeView)},enabledViews(){return Object.keys(this.views).filter(l=>this.views[l].enabled)},hasTimeColumn(){return this.time&&this.isWeekOrDayView},isShortMonthView(){return this.isMonthView&&this.eventsOnMonthView==="short"},firstCellDateWeekNumber(){const l=this.utils.date,t=this.view.firstCellDate;return l.getWeek(this.startWeekOnSunday?l.addDays(t,1):t)},timeCells(){const l=[];for(let t=this.timeFrom,s=this.timeTo;t<s;t+=this.timeStep)l.push({hours:Math.floor(t/60),minutes:t%60,label:this.utils.date.formatTime(t,this.TimeFormat),value:t});return l},TimeFormat(){return this.timeFormat||(this.twelveHour?"h:mm{am}":"HH:mm")},daySplits(){return(this.splitDays.filter(l=>!l.hide)||[]).map((l,t)=>({...l,id:l.id||t+1}))},hasSplits(){return this.daySplits.length&&this.isWeekOrDayView},hasShortEvents(){return this.showAllDayEvents==="short"},cellOrSplitMinWidth(){let l=null;return this.hasSplits&&this.minSplitWidth?l=this.visibleDaysCount*this.minSplitWidth*this.daySplits.length:this.minCellWidth&&this.isWeekView&&(l=this.visibleDaysCount*this.minCellWidth),l},allDayBar(){let l=this.allDayBarHeight||null;return l&&!isNaN(l)&&(l+="px"),{cells:this.viewCells,options:this.$props,label:this.texts.allDay,shortEvents:this.hasShortEvents,daySplits:this.hasSplits&&this.daySplits||[],cellOrSplitMinWidth:this.cellOrSplitMinWidth,height:l}},minTimestamp(){let l=null;return this.minDate&&typeof this.minDate=="string"?l=this.utils.date.stringToDate(this.minDate):this.minDate&&this.minDate instanceof Date&&(l=this.minDate),l?l.getTime():null},maxTimestamp(){let l=null;return this.maxDate&&typeof this.maxDate=="string"?l=this.utils.date.stringToDate(this.maxDate):this.maxDate&&this.maxDate instanceof Date&&(l=this.maxDate),l?l.getTime():null},weekDays(){let{weekDays:l,weekDaysShort:t=[]}=this.texts;return l=l.slice(0).map((s,o)=>({label:s,...t.length?{short:t[o]}:{},hide:this.hideWeekends&&o>=5||this.hideWeekdays.length&&this.hideWeekdays.includes(o+1)})),this.startWeekOnSunday&&l.unshift(l.pop()),l},weekDaysInHeader(){return this.isMonthView||this.isWeekView&&!this.minCellWidth&&!(this.hasSplits&&this.minSplitWidth)},months(){return this.texts.months.map(l=>({label:l}))},specialDayHours(){return!this.specialHours||!Object.keys(this.specialHours).length?{}:Array(7).fill("").map((l,t)=>{let s=this.specialHours[t+1]||[];return Array.isArray(s)||(s=[s]),l=[],s.forEach(({from:o,to:n,class:a,label:c},d)=>{l[d]={day:t+1,from:[null,void 0].includes(o)?null:o*1,to:[null,void 0].includes(n)?null:n*1,class:a||"",label:c||""}}),l})},viewTitle(){const l=this.utils.date;let t="";const s=this.view.startDate,o=s.getFullYear(),n=s.getMonth();switch(this.view.id){case"years":{t=this.texts.years;break}case"year":{t=o;break}case"month":{t=`${this.months[n].label} ${o}`;break}case"week":{const a=this.view.endDate,c=s.getFullYear();let d=this.texts.months[s.getMonth()];this.xsmall&&(d=d.substring(0,3));let u=`${d} ${c}`;if(a.getMonth()!==s.getMonth()){const m=a.getFullYear();let p=this.texts.months[a.getMonth()];this.xsmall&&(p=p.substring(0,3)),c===m?u=`${d} - ${p} ${c}`:this.small?u=`${d.substring(0,3)} ${c} - ${p.substring(0,3)} ${m}`:u=`${d} ${c} - ${p} ${m}`}t=`${this.texts.week} ${l.getWeek(this.startWeekOnSunday?l.addDays(s,1):s)} (${u})`;break}case"day":{t=this.utils.date.formatDate(s,this.texts.dateFormat,this.texts);break}}return t},viewCells(){const l=this.utils.date;let t=[],s=null,o=!1;this.watchRealTime||(this.now=new Date);const n=this.now;switch(this.view.id){case"years":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(25)).map((a,c)=>{const d=new Date(s+c,0,1),u=new Date(s+c+1,0,1);return u.setSeconds(-1),{startDate:d,formattedDate:l.formatDateLite(d),endDate:u,content:s+c,current:s+c===n.getFullYear()}});break}case"year":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(12)).map((a,c)=>{const d=new Date(s,c,1),u=new Date(s,c+1,1);return u.setSeconds(-1),{startDate:d,formattedDate:l.formatDateLite(d),endDate:u,content:this.xsmall?this.months[c].label.substr(0,3):this.months[c].label,current:c===n.getMonth()&&s===n.getFullYear()}});break}case"month":{const a=this.view.startDate.getMonth(),c=new Date(this.view.firstCellDate);o=!1,t=Array.apply(null,Array(42)).map((d,u)=>{const m=l.addDays(c,u),p=new Date(m);p.setHours(23,59,59,0);const w=!o&&l.isToday(m)&&!o++;return{startDate:m,formattedDate:l.formatDateLite(m),endDate:p,content:m.getDate(),today:w,outOfScope:m.getMonth()!==a,class:`vuecal__cell--day${m.getDay()||7}`}}),(this.hideWeekends||this.hideWeekdays.length)&&(t=t.filter(d=>{const u=d.startDate.getDay()||7;return!(this.hideWeekends&&u>=6||this.hideWeekdays.length&&this.hideWeekdays.includes(u))}));break}case"week":{o=!1;const a=this.view.startDate,c=this.weekDays;t=c.map((d,u)=>{const m=l.addDays(a,this.startWeekOnSunday&&this.hideWeekends?u-1:u),p=new Date(m);p.setHours(23,59,59,0);const w=(m.getDay()||7)-1;return{startDate:m,formattedDate:l.formatDateLite(m),endDate:p,today:!o&&l.isToday(m)&&!o++,specialHours:this.specialDayHours[w]||[]}}).filter((d,u)=>!c[u].hide);break}case"day":{const a=this.view.startDate,c=new Date(this.view.startDate);c.setHours(23,59,59,0);const d=(a.getDay()||7)-1;t=[{startDate:a,formattedDate:l.formatDateLite(a),endDate:c,today:l.isToday(a),specialHours:this.specialDayHours[d]||[]}];break}}return t},visibleDaysCount(){return this.isDayView?1:7-this.weekDays.reduce((l,t)=>l+t.hide,0)},cellWidth(){return 100/this.visibleDaysCount},cssClasses(){const{resizeAnEvent:l,dragAnEvent:t,dragCreateAnEvent:s}=this.domEvents;return{[`vuecal--${this.view.id}-view`]:!0,[`vuecal--${this.locale}`]:this.locale,"vuecal--no-time":!this.time,"vuecal--view-with-time":this.hasTimeColumn,"vuecal--week-numbers":this.showWeekNumbers&&this.isMonthView,"vuecal--twelve-hour":this.twelveHour,"vuecal--click-to-navigate":this.clickToNavigate,"vuecal--hide-weekends":this.hideWeekends,"vuecal--split-days":this.hasSplits,"vuecal--sticky-split-labels":this.hasSplits&&this.stickySplitLabels,"vuecal--overflow-x":this.minCellWidth&&this.isWeekView||this.hasSplits&&this.minSplitWidth,"vuecal--small":this.small,"vuecal--xsmall":this.xsmall,"vuecal--resizing-event":l._eid,"vuecal--drag-creating-event":s.event,"vuecal--dragging-event":t._eid,"vuecal--events-on-month-view":this.eventsOnMonthView,"vuecal--short-events":this.isMonthView&&this.eventsOnMonthView==="short","vuecal--has-touch":typeof window<"u"&&"ontouchstart"in window}},isYearsOrYearView(){return["years","year"].includes(this.view.id)},isYearsView(){return this.view.id==="years"},isYearView(){return this.view.id==="year"},isMonthView(){return this.view.id==="month"},isWeekOrDayView(){return["week","day"].includes(this.view.id)},isWeekView(){return this.view.id==="week"},isDayView(){return this.view.id==="day"}},watch:{events:{handler(l,t){this.updateMutableEvents(l),this.addEventsToView()},deep:!0},locale(l){this.loadLocale(l)},selectedDate(l){this.updateSelectedDate(l)},activeView(l){this.switchView(l)}}},ma=Pe(ca,[["render",ua]]),va={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},pa={class:"flex justify-between items-center mb-4"},ha={class:"flex gap-3"},ga={class:"flex rounded-md shadow-sm mr-3"},fa={key:0,class:"mb-4 bg-gray-50 p-4 rounded-lg"},ya={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ba=["value"],wa={class:"mt-1 relative rounded-md shadow-sm"},_a={key:1,class:"text-center text-gray-600 text-sm animate-pulse py-4"},xa={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md"},ka={key:3},Da={key:0,class:"space-y-4"},Ca={key:0,class:"flex justify-between"},Ta={class:"flex-grow"},Ma={class:"text-sm text-red-500 italic"},Ea={class:"flex items-center mt-1"},$a={class:"text-xs text-gray-500"},Sa={key:1},ja={class:"flex-grow"},Va={class:"flex justify-between items-center mb-3"},Aa={class:"text-sm text-gray-600 bg-blue-100 px-2 py-1 rounded-full"},Oa={class:"mb-3"},Ia={class:"text-sm text-gray-700 ml-6"},La={class:"mb-3"},Pa={class:"text-sm text-gray-700 ml-6"},Na={class:"mb-2"},Ua={class:"text-sm text-gray-700 ml-6"},Ra={class:"flex items-center mt-3 pt-2 border-t border-blue-200"},Fa={class:"text-xs text-gray-500"},Ba={key:1,class:"text-gray-400 text-sm"},Ha={key:4,class:"mt-4"},Wa={class:"flex justify-between items-center mb-6"},Ya={class:"text-lg font-medium text-gray-900"},za=["innerHTML"],qa=["innerHTML"],Za={key:0,class:"mt-1 text-xs p-1 rounded bg-red-50 border-l-2 border-red-500 text-red-700"},Ga={class:"mt-6 bg-white rounded-lg shadow p-4"},Ka={key:0},Ja={class:"font-medium text-gray-800 mb-2"},Xa={class:"font-medium text-blue-800"},Qa={class:"text-sm text-gray-600 mt-1"},ei={key:1,class:"text-gray-500 text-sm"},ti={__name:"DailyStandups",props:{projectId:{type:Number,required:!0},users:{type:Array,default:()=>[]}},emits:["standupAdded"],setup(l,{emit:t}){const s=l,o=b("list"),n=b(!1),a=b(!1),c=b(""),d=b([]),u=b(""),m=Te({startDate:"",endDate:"",search:"",userId:""}),p=T=>{const D=re(T);return D.isValid()?{start:D.clone().startOf("month").format("YYYY-MM-DD"),end:D.clone().endOf("month").format("YYYY-MM-DD")}:(console.warn("getMonthRange received an invalid input, defaulting to current date:",T),{start:re().startOf("month").format("YYYY-MM-DD"),end:re().endOf("month").format("YYYY-MM-DD")})};let w=null;const _=()=>{clearTimeout(w),w=setTimeout(()=>{M()},500)},V=async()=>{a.value=!0,c.value="";try{const T=new URLSearchParams;m.startDate&&T.append("start_date",m.startDate),m.endDate&&T.append("end_date",m.endDate),m.search&&T.append("search",m.search),m.userId&&T.append("user_id",String(m.userId));const D=T.toString(),O=`/api/projects/${s.projectId}/sections/notes?type=standup${D?`&${D}`:""}`,le=await window.axios.get(O);d.value=le.data.filter(ne=>ne.type==="standup")}catch(T){console.error("Error fetching project standups:",T),c.value="Failed to load standups. Please try again."}finally{a.value=!1}},M=()=>{V()},S=()=>{m.search="",m.userId="",m.startDate="",m.endDate="",V()},h=()=>{u.value=re(u.value).subtract(1,"month").format("YYYY-MM-DD")},f=()=>{u.value=re(u.value).add(1,"month").format("YYYY-MM-DD")};de(()=>u.value,T=>{if(o.value==="calendar"&&T){const D=p(T);m.startDate=D.start,m.endDate=D.end,V()}}),de(()=>o.value,T=>{T==="calendar"?(m.search="",m.userId="",u.value=p(new Date).start):(m.startDate="",m.endDate="",V())});const k=U(()=>(d.value||[]).map(T=>{var le;if(!(T!=null&&T.created_at))return null;const D=re(T.created_at);if(!D.isValid())return null;const O=Y(T.content);return{start:D.format("YYYY-MM-DD HH:mm"),end:D.format("YYYY-MM-DD HH:mm"),title:`${((le=T.user)==null?void 0:le.name)||"Unknown"} - Standup`,content:`Yesterday: ${O.yesterday}
Today: ${O.today}
Blockers: ${O.blockers}`,class:"standup-event",standupData:T}}).filter(Boolean));we(()=>{V()});const E=U(()=>{if(!d.value)return[];let T=[...d.value];if(m.startDate&&(T=T.filter(D=>D.created_at&&re(D.created_at).isSameOrAfter(m.startDate,"day"))),m.endDate&&(T=T.filter(D=>D.created_at&&re(D.created_at).isSameOrBefore(m.endDate,"day"))),m.userId&&(T=T.filter(D=>D.user_id===parseInt(m.userId))),m.search){const D=m.search.toLowerCase();T=T.filter(O=>O.content&&O.content!=="[Encrypted content could not be decrypted]"&&O.content.toLowerCase().includes(D))}return T.sort((D,O)=>re(O.created_at).valueOf()-re(D.created_at).valueOf())}),j=T=>{const D=re(T).day();return D>=1&&D<=5},C=T=>re(T).isBefore(re(),"day"),P=(T,D)=>re(T).isSame(D,"day"),Y=T=>{var F,B,H,I;if(!T||typeof T!="string"||T==="[Encrypted content could not be decrypted]"||T.trim()==="")return{yesterday:"N/A",today:"N/A",blockers:"N/A",date:"N/A"};const D=((F=T.match(/\*\*Yesterday:\*\* ([^\n]+)/))==null?void 0:F[1].trim())||"Nothing",O=((B=T.match(/\*\*Today:\*\* ([^\n]+)/))==null?void 0:B[1].trim())||"Nothing",le=((H=T.match(/\*\*Blockers:\*\* ([^\n]+)/))==null?void 0:H[1].trim())||"None",ne=((I=T.match(/\*\*Daily Standup - ([^*]+)\*\*/))==null?void 0:I[1].trim())||re().format("L");return{yesterday:D,today:O,blockers:le,date:ne}},$=U(()=>{const T={};return(d.value||[]).forEach(D=>{if(!(D!=null&&D.created_at))return;const O=re(D.created_at).format("YYYY-MM-DD");T[O]||(T[O]=[]),T[O].push(D)}),T});return(T,D)=>(i(),r("div",va,[e("div",pa,[D[11]||(D[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Daily Standups",-1)),e("div",ha,[e("div",ga,[e("button",{type:"button",onClick:D[0]||(D[0]=O=>o.value="list"),class:Q([o.value==="list"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-l-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},D[8]||(D[8]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})]),q(" List ")],-1)]),2),e("button",{type:"button",onClick:D[1]||(D[1]=O=>o.value="calendar"),class:Q([o.value==="calendar"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-r-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},D[9]||(D[9]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),q(" Calendar ")],-1)]),2)]),v(ge,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:D[2]||(D[2]=O=>n.value=!0)},{default:z(()=>D[10]||(D[10]=[q(" Submit Standup ",-1)])),_:1,__:[10]})])]),o.value==="list"?(i(),r("div",fa,[e("div",ya,[e("div",null,[D[12]||(D[12]=e("label",{for:"standupStartDate",class:"block text-sm font-medium text-gray-700 mb-1"},"From Date",-1)),he(e("input",{type:"date",id:"standupStartDate","onUpdate:modelValue":D[3]||(D[3]=O=>m.startDate=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:M},null,544),[[ke,m.startDate]])]),e("div",null,[D[13]||(D[13]=e("label",{for:"standupEndDate",class:"block text-sm font-medium text-gray-700 mb-1"},"To Date",-1)),he(e("input",{type:"date",id:"standupEndDate","onUpdate:modelValue":D[4]||(D[4]=O=>m.endDate=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:M},null,544),[[ke,m.endDate]])]),e("div",null,[D[15]||(D[15]=e("label",{for:"standupUserFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),he(e("select",{id:"standupUserFilter","onUpdate:modelValue":D[5]||(D[5]=O=>m.userId=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:M},[D[14]||(D[14]=e("option",{value:""},"All Users",-1)),(i(!0),r(J,null,te(s.users,O=>(i(),r("option",{key:O.id,value:O.id},g(O.name),9,ba))),128))],544),[[Ze,m.userId]])]),e("div",null,[D[17]||(D[17]=e("label",{for:"standupSearchFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Search Content",-1)),e("div",wa,[he(e("input",{type:"text",id:"standupSearchFilter","onUpdate:modelValue":D[6]||(D[6]=O=>m.search=O),class:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pr-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search in standup content...",onInput:_},null,544),[[ke,m.search]]),D[16]||(D[16]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:S}," Reset Filters ")])])):x("",!0),a.value?(i(),r("div",_a,"Loading standups...")):c.value?(i(),r("div",xa,g(c.value),1)):o.value==="list"?(i(),r("div",ka,[E.value.length?(i(),r("div",Da,[(i(!0),r(J,null,te(E.value,O=>{var le,ne;return i(),r("div",{key:O.id,class:"p-4 bg-blue-50 rounded-md shadow-sm hover:bg-blue-100 transition-colors border-l-4 border-blue-500"},[O.content==="[Encrypted content could not be decrypted]"?(i(),r("div",Ca,[e("div",Ta,[e("p",Ma,[q(g(O.content),1),D[18]||(D[18]=e("span",{class:"text-xs text-red-400 block mt-1"},"(There was an issue decrypting this standup. Please contact an administrator.)",-1))]),e("div",Ea,[e("p",$a,"Submitted by "+g(((le=O.user)==null?void 0:le.name)||"Unknown")+" on "+g(W(re)(O.created_at).format("L")),1)])])])):(i(),r("div",Sa,[e("div",ja,[e("div",Va,[D[19]||(D[19]=e("h3",{class:"text-md font-bold text-gray-800"},"Daily Standup",-1)),e("span",Aa,g(Y(O.content).date),1)]),e("div",Oa,[D[20]||(D[20]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Yesterday:")],-1)),e("p",Ia,g(Y(O.content).yesterday),1)]),e("div",La,[D[21]||(D[21]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-green-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Today:")],-1)),e("p",Pa,g(Y(O.content).today),1)]),e("div",Na,[D[22]||(D[22]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-red-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Blockers:")],-1)),e("p",Ua,g(Y(O.content).blockers),1)]),e("div",Ra,[e("p",Fa,"Submitted by "+g(((ne=O.user)==null?void 0:ne.name)||"Unknown")+" on "+g(W(re)(O.created_at).format("L")),1)])])]))])}),128))])):(i(),r("p",Ba,"No daily standups found for the selected criteria."))])):o.value==="calendar"?(i(),r("div",Ha,[e("div",Wa,[e("button",{onClick:h,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},D[23]||(D[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("h3",Ya,g(u.value?W(re)(u.value).format("MMMM YYYY"):"Loading..."),1),e("button",{onClick:f,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},D[24]||(D[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),v(W(ma),{class:"vuecal--blue-theme","active-view":"month",events:k.value,"selected-date":u.value,"hide-title-bar":"","disable-views":["week","day","years","year"],twelveHour:!0,"time-from":480,"time-to":1200,"time-step":30,"events-on-month-view":"short"},{event:z(({event:O})=>[e("div",{class:"vuecal__event-title",innerHTML:O.title},null,8,za),e("div",{class:"vuecal__event-content",innerHTML:O.content},null,8,qa)]),"cell-content":z(({view:O,date:le})=>[O.id==="month"?(i(),r(J,{key:0},[le&&j(le)&&C(le)&&!k.value.some(ne=>P(ne.start,le))?(i(),r("div",Za," No standups ")):x("",!0)],64)):x("",!0)]),_:1},8,["events","selected-date"]),D[26]||(D[26]=ns('<div class="mt-4 flex items-center space-x-4 text-sm"><div class="flex items-center"><span class="inline-block w-3 h-3 bg-blue-50 border-l-2 border-blue-500 mr-1"></span><span>Standup submitted</span></div><div class="flex items-center"><span class="inline-block w-3 h-3 bg-red-50 border-l-2 border-red-500 mr-1"></span><span>Missing standup</span></div></div>',1)),e("div",Ga,[D[25]||(D[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Standups Outside Current Month View",-1)),Object.entries($.value).some(([O])=>!W(re)(O).isSame(u.value,"month"))?(i(),r("div",Ka,[(i(!0),r(J,null,te(Object.entries($.value).filter(([O])=>!W(re)(O).isSame(u.value,"month")).sort((O,le)=>W(re)(O[0]).valueOf()-W(re)(le[0]).valueOf()),([O,le])=>(i(),r("div",{key:O,class:"mb-4"},[e("div",Ja,g(W(re)(O).format("dddd, MMMM Do YYYY")),1),(i(!0),r(J,null,te(le,ne=>{var F;return i(),r("div",{key:ne.id,class:"p-2 mb-2 rounded bg-blue-50 border-l-2 border-blue-500"},[e("div",Xa,g(((F=ne.user)==null?void 0:F.name)||"Unknown"),1),e("div",Qa,g(W(re)(ne.created_at).format("LT")),1)])}),128))]))),128))])):(i(),r("div",ei,"No standups outside the current month view."))])])):x("",!0),v(Dt,{show:n.value,onClose:D[7]||(D[7]=O=>n.value=!1),onStandupAdded:V,projectId:l.projectId},null,8,["show","projectId"])]))}},si={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-6"},li={class:"space-y-6"},ai={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ii={class:"flex items-center"},ni={class:"flex items-center"},oi={class:"space-y-6 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},ri={class:"space-y-4"},di={class:"text-gray-900 font-medium break-words"},ui={class:"text-gray-900"},ci={key:0,class:"text-xs text-gray-500 mt-1"},mi={key:0},vi={class:"text-gray-900 whitespace-pre-wrap"},pi={key:1},hi={class:"flex flex-wrap gap-2"},gi={key:2},fi={class:"text-gray-900"},yi={class:"list-disc list-inside space-y-1 text-gray-900"},bi={key:0},wi={key:1},_i={key:2},xi={__name:"MeetingModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},projectName:{type:String,default:"Project"}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,n=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,a=["Africa/Cairo","Africa/Johannesburg","Africa/Lagos","America/Anchorage","America/Bogota","America/Chicago","America/Denver","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Dubai","Asia/Hong_Kong","Asia/Jerusalem","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Tokyo","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Berlin","Europe/Dublin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Rome","Pacific/Auckland","Pacific/Honolulu","UTC","GMT","Europe/Belfast","America/Adak","America/Boise","America/Detroit","America/Indianapolis","America/Juneau","America/Louisville","America/Menominee","America/Nome","America/Sitka","America/Yakutat","Asia/Karachi","Asia/Kolkata","Pacific/Auckland","Pacific/Chatham","Europe/Athens","Europe/Brussels","Europe/Budapest","Europe/Copenhagen","Europe/Helsinki","Europe/Lisbon","Europe/Oslo","Europe/Stockholm","Europe/Zurich","Europe/Vienna","Europe/Warsaw","Europe/Zurich","Europe/Sofia","Europe/Prague","Europe/Malta","Europe/Luxembourg","Europe/Kiev","Europe/Rome"].sort(),c=U(()=>a.map(j=>({value:j,label:j}))),d=U(()=>{const j=n(),C=a.includes(j);return console.log("DEBUG: Is detected timezone in list?",C,"Detected:",j),C?j:(console.log("DEBUG: Falling back to UTC for timezone as detected timezone not in list."),"UTC")}),u=Te({summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0,timezone:d.value,enable_recording:!1}),m=U({get(){return u.summary?`${u.summary} - ${s.projectName}`:""},set(j){const C=` - ${s.projectName}`;j.endsWith(C)?u.summary=j.slice(0,-C.length):u.summary=j}}),p=()=>{u.summary="",u.description="",u.attendee_user_ids=[],u.location="",u.with_google_meet=!0,u.timezone=d.value,u.enable_recording=!1,_(),console.log("DEBUG: Form reset. Current timezone in form:",u.timezone)},w=j=>{const C=new Date(j),P=C.getFullYear(),Y=String(C.getMonth()+1).padStart(2,"0"),$=String(C.getDate()).padStart(2,"0"),T=String(C.getHours()).padStart(2,"0"),D=String(C.getMinutes()).padStart(2,"0");return`${P}-${Y}-${$}T${T}:${D}`},_=()=>{const j=new Date,C=new Date(j.getTime()+3600*1e3),P=new Date(j.getTime()+7200*1e3);u.start_datetime=w(C),u.end_datetime=w(P),console.log("DEBUG: Default times set. Start:",u.start_datetime,"End:",u.end_datetime)};_(),de(()=>s.show,j=>{j&&p()},{immediate:!0});const V=j=>j?(console.log(j),j.replace("T"," ")+":00"):"",M=j=>{const C={...j};return C.summary=m.value,C.start_datetime=V(j.start_datetime),C.end_datetime=V(j.end_datetime),console.log(C),C},S=U(()=>`/api/projects/${s.projectId}/meetings`),h=j=>{o("saved",j)},f=j=>{console.error("DEBUG: MeetingModal submission error:",j)},k=U(()=>{if(!u.start_datetime||!u.end_datetime)return"";const j=new Date(u.start_datetime),C=new Date(u.end_datetime),P={weekday:"long",year:"numeric",month:"long",day:"numeric"},Y={hour:"2-digit",minute:"2-digit"},$=j.toLocaleDateString(void 0,P),T=j.toLocaleTimeString(void 0,Y),D=C.toLocaleTimeString(void 0,Y);return j.toDateString()===C.toDateString()?`${$}, ${T} - ${D}`:`${$} ${T} - ${C.toLocaleDateString(void 0,P)} ${D}`}),E=U(()=>s.projectUsers.filter(j=>u.attendee_user_ids.includes(j.id)).map(j=>j.name));return(j,C)=>(i(),se(Ve,{show:l.show,title:"Schedule a Meeting","api-endpoint":S.value,"http-method":"post","form-data":u,"format-data-for-api":M,"submit-button-text":"Schedule Meeting","success-message":"Meeting scheduled successfully!",onClose:C[9]||(C[9]=P=>j.$emit("close")),onSubmitted:h,onError:f},{default:z(({errors:P})=>[e("div",si,[e("div",li,[e("div",null,[v(G,{for:"summary",value:"Meeting Title"}),C[10]||(C[10]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive title for the meeting (e.g., Project Standup). The project name will be added automatically. ",-1)),v(me,{id:"summary",modelValue:u.summary,"onUpdate:modelValue":C[0]||(C[0]=Y=>u.summary=Y),type:"text",class:"mt-1 block w-full",placeholder:"e.g., Project Standup",required:""},null,8,["modelValue"]),v(ae,{message:P.summary?P.summary[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"description",value:"Description"}),C[11]||(C[11]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive agenda of the meeting. ",-1)),he(e("textarea",{id:"description","onUpdate:modelValue":C[1]||(C[1]=Y=>u.description=Y),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Meeting agenda and details..."},null,512),[[ke,u.description]]),v(ae,{message:P.description?P.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",ai,[e("div",null,[v(G,{for:"start_datetime",value:"Start Date & Time"}),v(me,{id:"start_datetime",modelValue:u.start_datetime,"onUpdate:modelValue":C[2]||(C[2]=Y=>u.start_datetime=Y),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:P.start_datetime?P.start_datetime[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"end_datetime",value:"End Date & Time"}),v(me,{id:"end_datetime",modelValue:u.end_datetime,"onUpdate:modelValue":C[3]||(C[3]=Y=>u.end_datetime=Y),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:P.end_datetime?P.end_datetime[0]:"",class:"mt-2"},null,8,["message"])])]),e("div",null,[v(G,{for:"attendees",value:"Attendees"}),v(tt,{id:"attendees",modelValue:u.attendee_user_ids,"onUpdate:modelValue":C[4]||(C[4]=Y=>u.attendee_user_ids=Y),options:s.projectUsers,"label-key":"name","track-by":"id",placeholder:"Select attendees",class:"mt-1"},null,8,["modelValue","options"]),C[12]||(C[12]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select project members to invite to this meeting ",-1)),v(ae,{message:P.attendee_user_ids?P.attendee_user_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"location",value:"Location (Optional)"}),v(me,{id:"location",modelValue:u.location,"onUpdate:modelValue":C[5]||(C[5]=Y=>u.location=Y),type:"text",class:"mt-1 block w-full",placeholder:"Office, Conference Room, etc."},null,8,["modelValue"]),v(ae,{message:P.location?P.location[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"timezone",value:"Timezone"}),v(pe,{id:"timezone",modelValue:u.timezone,"onUpdate:modelValue":C[6]||(C[6]=Y=>u.timezone=Y),options:c.value,"value-key":"value","label-key":"label",placeholder:"Select timezone",class:"mt-1"},null,8,["modelValue","options"]),C[13]||(C[13]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select your timezone for this meeting ",-1)),v(ae,{message:P.timezone?P.timezone[0]:"",class:"mt-2"},null,8,["message"])]),e("div",ii,[he(e("input",{id:"with_google_meet","onUpdate:modelValue":C[7]||(C[7]=Y=>u.with_google_meet=Y),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,u.with_google_meet]]),C[14]||(C[14]=e("label",{for:"with_google_meet",class:"ml-2 block text-sm text-gray-900"}," Create Google Meet video conference ",-1))]),e("div",ni,[he(e("input",{id:"enable_recording","onUpdate:modelValue":C[8]||(C[8]=Y=>u.enable_recording=Y),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,u.enable_recording]]),C[15]||(C[15]=e("label",{for:"enable_recording",class:"ml-2 block text-sm text-gray-900"}," Enable recording and transcript ",-1))])]),e("div",oi,[C[22]||(C[22]=e("h4",{class:"text-xl font-bold text-gray-800"},"Meeting Preview",-1)),e("div",ri,[e("div",null,[C[16]||(C[16]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Title",-1)),e("p",di,g(m.value||"Untitled Meeting"),1)]),e("div",null,[C[17]||(C[17]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Date & Time",-1)),e("p",ui,g(k.value||"No date and time selected."),1),u.timezone?(i(),r("p",ci,"Timezone: "+g(u.timezone),1)):x("",!0)]),u.description?(i(),r("div",mi,[C[18]||(C[18]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Description",-1)),e("p",vi,g(u.description),1)])):x("",!0),E.value.length>0?(i(),r("div",pi,[C[19]||(C[19]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Attendees",-1)),e("div",hi,[(i(!0),r(J,null,te(E.value,Y=>(i(),r("span",{key:Y,class:"px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},g(Y),1))),128))])])):x("",!0),u.location?(i(),r("div",gi,[C[20]||(C[20]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Location",-1)),e("p",fi,g(u.location),1)])):x("",!0),e("div",null,[C[21]||(C[21]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Options",-1)),e("ul",yi,[u.with_google_meet?(i(),r("li",bi,"Google Meet enabled")):x("",!0),u.enable_recording?(i(),r("li",wi,"Recording and transcript enabled")):x("",!0),!u.with_google_meet&&!u.enable_recording?(i(),r("li",_i,"No special options selected.")):x("",!0)])])])])])]),_:1},8,["show","api-endpoint","form-data"]))}},ki=Ae(xi,[["__scopeId","data-v-674b7e2a"]]),Di={class:"p-6"},Ci={key:0,class:"mb-4 p-3 bg-green-100 text-green-800 rounded-md"},Ti={key:1,class:"mb-4 p-3 bg-red-100 text-red-800 rounded-md"},Mi={class:"mb-4"},Ei=["value"],$i={class:"mt-6 flex justify-end space-x-3"},Si={__name:"ProjectMagicLinkModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectClients:{type:Array,default:()=>[]}},emits:["close"],setup(l,{emit:t}){const s=l,o=t,n=b(!1),a=b(""),c=b(""),d=b(""),u=async()=>{var p,w;if(!a.value){d.value="Please select a client email";return}n.value=!0,c.value="",d.value="";try{const _=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{email:a.value});_.data.success?(c.value=_.data.message,a.value=""):d.value=_.data.message||"Failed to send magic link"}catch(_){console.error("Error sending magic link:",_),d.value=((w=(p=_.response)==null?void 0:p.data)==null?void 0:w.message)||"An error occurred while sending the magic link"}finally{n.value=!1}},m=()=>{a.value="",c.value="",d.value="",o("close")};return(p,w)=>(i(),se(je,{show:l.show,onClose:m},{default:z(()=>[e("div",Di,[e("div",{class:"flex justify-between items-center mb-4"},[w[2]||(w[2]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Send Magic Link to Client",-1)),e("button",{onClick:m,class:"text-gray-400 hover:text-gray-500"},w[1]||(w[1]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),c.value?(i(),r("div",Ci,g(c.value),1)):x("",!0),d.value?(i(),r("div",Ti,g(d.value),1)):x("",!0),e("div",Mi,[v(G,{for:"client-email",value:"Select Client"}),he(e("select",{id:"client-email","onUpdate:modelValue":w[0]||(w[0]=_=>a.value=_),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full"},[w[3]||(w[3]=e("option",{value:""},"Select a client",-1)),(i(!0),r(J,null,te(l.projectClients,_=>(i(),r("option",{key:_.id,value:_.email},g(_.name)+" ("+g(_.email)+") ",9,Ei))),128))],512),[[Ze,a.value]]),w[4]||(w[4]=e("p",{class:"mt-2 text-sm text-gray-500"}," The magic link will be sent to the selected client's email address. ",-1))]),e("div",$i,[v(be,{onClick:m,type:"button"},{default:z(()=>w[5]||(w[5]=[q(" Cancel ",-1)])),_:1,__:[5]}),v(ge,{onClick:u,disabled:n.value||!a.value,class:"bg-purple-600 hover:bg-purple-700"},{default:z(()=>[q(g(n.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},ji={class:"mt-6 space-y-6"},Vi={class:"mt-2 flex space-x-4"},Ai={class:"inline-flex items-center"},Oi={class:"inline-flex items-center"},Ii={key:0},Li={key:1},Pi=["required"],Ni={__name:"ResourceModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},resource:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,n=b({name:"",type:"link",url:"",file:null,description:""}),a=b(null),c=U(()=>s.resource?`/api/projects/${s.projectId}/resources/${s.resource.id}`:`/api/projects/${s.projectId}/resources`),d=U(()=>s.resource?"put":"post"),u=U(()=>s.resource?"Update Resource":"Add Resource"),m=U(()=>s.resource?"Resource updated successfully!":"Resource added successfully!");de(()=>s.show,M=>{M&&(s.resource?n.value={name:s.resource.name,type:s.resource.type,url:s.resource.type==="link"?s.resource.url:"",file:null,description:s.resource.description||""}:n.value={name:"",type:"link",url:"",file:null,description:""},a.value&&(a.value.value=""))},{immediate:!0});const p=M=>{n.value.file=M.target.files[0]||null},w=M=>{const S=new FormData;return S.append("name",M.name||""),S.append("type",M.type||"link"),S.append("description",M.description||""),M.type==="link"?S.append("url",M.url||""):M.type==="file"&&M.file&&S.append("file",M.file),(d.value==="put"||d.value==="patch")&&S.append("_method","PUT"),S},_=M=>{o("saved",M.resource)},V=()=>{o("close")};return(M,S)=>(i(),se(Ve,{show:l.show,title:l.resource?"Edit Resource":"Add Resource","api-endpoint":c.value,"http-method":d.value,"form-data":n.value,"submit-button-text":u.value,"success-message":m.value,"format-data-for-api":w,onClose:V,onSubmitted:_},{default:z(({errors:h})=>[e("div",ji,[e("div",null,[v(G,{for:"resource-type",value:"Resource Type"}),e("div",Vi,[e("label",Ai,[he(e("input",{type:"radio","onUpdate:modelValue":S[0]||(S[0]=f=>n.value.type=f),value:"link",class:"form-radio text-indigo-600"},null,512),[[pt,n.value.type]]),S[5]||(S[5]=e("span",{class:"ml-2 text-gray-700"},"Link",-1))]),e("label",Oi,[he(e("input",{type:"radio","onUpdate:modelValue":S[1]||(S[1]=f=>n.value.type=f),value:"file",class:"form-radio text-indigo-600"},null,512),[[pt,n.value.type]]),S[6]||(S[6]=e("span",{class:"ml-2 text-gray-700"},"File",-1))])])]),e("div",null,[v(G,{for:"resource-name",value:"Name"}),v(me,{id:"resource-name",modelValue:n.value.name,"onUpdate:modelValue":S[2]||(S[2]=f=>n.value.name=f),type:"text",class:"mt-1 block w-full",placeholder:"Enter resource name",required:""},null,8,["modelValue"]),v(ae,{message:h.name?h.name[0]:"",class:"mt-2"},null,8,["message"])]),n.value.type==="link"?(i(),r("div",Ii,[v(G,{for:"resource-url",value:"URL"}),v(me,{id:"resource-url",modelValue:n.value.url,"onUpdate:modelValue":S[3]||(S[3]=f=>n.value.url=f),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com",required:""},null,8,["modelValue"]),v(ae,{message:h.url?h.url[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0),n.value.type==="file"?(i(),r("div",Li,[v(G,{for:"resource-file",value:"File"}),e("input",{id:"resource-file",ref_key:"fileInputRef",ref:a,type:"file",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",onChange:p,required:!l.resource||n.value.type==="file"},null,40,Pi),v(ae,{message:h.file?h.file[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0),e("div",null,[v(G,{for:"resource-description",value:"Description (Optional)"}),he(e("textarea",{id:"resource-description","onUpdate:modelValue":S[4]||(S[4]=f=>n.value.description=f),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter a description for this resource"},null,512),[[ke,n.value.description]]),v(ae,{message:h.description?h.description[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},Ui=Ae(Ni,[["__scopeId","data-v-f508dda8"]]),Ri={class:"bg-white p-8 rounded-2xl shadow-xl border border-gray-200"},Fi={class:"flex flex-col lg:flex-row justify-between lg:items-center mb-6 border-b pb-4 border-gray-200"},Bi={class:"flex-1"},Hi={class:"text-3xl font-extrabold text-gray-900 tracking-tight"},Wi={class:"mt-2 flex flex-wrap items-center gap-x-4 gap-y-2 text-sm text-gray-500"},Yi={class:"text-gray-600 font-medium"},zi={class:"flex items-center gap-2"},qi=["href"],Zi=["href"],Gi=["href"],Ki={class:"mt-4 lg:mt-0 flex flex-wrap gap-2"},Ji={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},Xi={class:"col-span-1 md:col-span-2"},Qi={class:"text-gray-600 text-base leading-relaxed"},en={class:"mt-6 flex flex-wrap gap-2 items-center"},tn={class:"mt-6"},sn={key:0,class:"text-gray-500 text-sm"},ln={key:1,class:"text-gray-400 text-sm"},an={key:2,class:"flex flex-wrap gap-3 items-center"},nn=["onClick"],on={key:0,class:"resource-tooltip absolute left-1/2 bottom-full mb-2 w-64 z-10 -translate-x-1/2"},rn={class:"bg-white rounded-xl shadow-xl p-4 text-sm border border-gray-200"},dn={class:"flex justify-between items-center mb-2"},un={class:"font-bold text-gray-900"},cn={key:0,class:"text-gray-600 text-xs mb-2"},mn=["href"],vn={class:"flex justify-end space-x-2 mt-2 pt-2 border-t border-gray-100"},pn=["onClick"],hn=["onClick"],gn={class:"col-span-1 border-l border-gray-200 pl-8"},fn={key:0,class:"text-gray-500 text-sm"},yn={key:1,class:"text-gray-500 text-sm"},bn={key:2,class:"space-y-3 max-h-[300px] overflow-y-auto"},wn={class:"font-medium text-gray-900 truncate"},_n={class:"text-sm text-gray-600"},xn={class:"flex space-x-2 mt-2"},kn=["href"],Dn=["href"],Cn={class:"p-6"},Tn={key:0,class:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-md"},Mn={key:1,class:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md"},En={class:"mb-4"},$n={key:0,class:"text-gray-500 text-sm mt-1"},Sn={key:1,class:"text-red-500 text-sm mt-1"},jn={class:"flex justify-end mt-6"},Vn={__name:"ProjectGeneralInfoCard",props:{project:{type:Object,required:!0},projectId:{type:Number,required:!0},canManageProjects:{type:Boolean,required:!0},canEditProjects:{type:Boolean,required:!1},isSuperAdmin:{type:Boolean,required:!0}},emits:["openEditModal","openStandupModal","openMeetingModal","resourceSaved","openComposeModal"],setup(l,{emit:t}){const s=l,o=t,n=b(!1),a=b(null),c=b([]),d=b(!1),u=b(null),m=b(!1),p=b(!1),w=b(!1),_=b({client_ids:[]}),V=b({}),M=b(""),S=b([]),h=b(!1),f=b(""),k=b([]),E=b(!1),j=b("");xt(s.projectId);const C=()=>{try{j.value=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(N){console.error("Error detecting user timezone:",N),j.value="UTC"}},P=async()=>{E.value=!0;try{const N=await window.axios.get(`/api/projects/${s.projectId}/meetings`);k.value=N.data}catch(N){console.error("Error fetching project meetings:",N)}finally{E.value=!1}},Y=N=>{if(!N)return"";try{const y={dateStyle:"medium",timeStyle:"short",timeZone:j.value};return new Date(N).toLocaleString(void 0,y)}catch(y){return console.error("Error formatting meeting time:",y),new Date(N).toLocaleString()}},$=async()=>{d.value=!0;try{const N=await window.axios.get(`/api/projects/${s.projectId}/resources`);N.data.success?c.value=N.data.resources:console.error("Failed to fetch resources:",N.data.message)}catch(N){console.error("Error fetching resources:",N)}finally{d.value=!1}},T=()=>{a.value=null,n.value=!0},D=N=>{a.value=N,n.value=!0},O=async N=>{if(confirm("Are you sure you want to delete this resource?"))try{const y=await window.axios.delete(`/api/projects/${s.projectId}/resources/${N}`);y.data.success?c.value=c.value.filter(A=>A.id!==N):console.error("Failed to delete resource:",y.data.message)}catch(y){console.error("Error deleting resource:",y)}},le=N=>{if(a.value){const y=c.value.findIndex(A=>A.id===N.id);y!==-1&&(c.value[y]=N)}else c.value.push(N);o("resourceSaved",N)},ne=N=>{u.value=u.value===N?null:N},F=()=>{u.value=null},B=N=>{if(u.value!==null){const y=N.target.closest(".resource-tooltip"),A=N.target.closest(".resource-button");!y&&!A&&F()}};we(()=>{$(),C(),P(),document.addEventListener("click",B)}),os(()=>{document.removeEventListener("click",B)});const H=async()=>{var N,y;h.value=!0,f.value="";try{const A=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);S.value=A.data}catch(A){console.error("Failed to fetch project clients:",A),f.value=((y=(N=A.response)==null?void 0:N.data)==null?void 0:y.message)||"Failed to load client data."}finally{h.value=!1}},I=()=>{_.value.client_ids=[],V.value={},M.value="",p.value=!0,H()},K=()=>{m.value=!0,H()},oe=()=>{p.value=!1},De=async()=>{if(V.value={},M.value="",w.value=!0,!_.value.client_ids||_.value.client_ids.length===0){V.value={client_ids:["Please select a client."]},w.value=!1;return}try{const N=_.value.client_ids[0];if(!S.value.find(L=>L.id===N)){V.value={client_ids:["Selected client does not have a valid email."]},w.value=!1;return}const A=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{client_id:N});A.data.success&&(M.value=A.data.message,_.value.client_ids=[])}catch(N){N.response&&N.response.status===422?V.value=N.response.data.errors:N.response&&N.response.data.message?V.value={general:[N.response.data.message]}:V.value={general:["An unexpected error occurred. Please try again."]}}finally{w.value=!1}};return(N,y)=>{var A;return i(),r(J,null,[e("div",Ri,[e("div",Fi,[e("div",Bi,[e("h2",Hi,g(l.project.name),1),e("div",Wi,[e("span",{class:Q(["inline-flex items-center rounded-full px-3 py-0.5 text-xs font-semibold",{"bg-green-100 text-green-800":l.project.status==="active","bg-yellow-100 text-yellow-800":l.project.status==="on_hold","bg-blue-100 text-blue-800":l.project.status==="completed","bg-red-100 text-red-800":l.project.status==="archived"}])},g(((A=l.project.status)==null?void 0:A.replace("_"," ").toUpperCase())||"N/A"),3),y[11]||(y[11]=e("span",{class:"text-gray-600"},"|",-1)),e("span",Yi,g(l.project.project_type||"N/A"),1),y[12]||(y[12]=e("span",{class:"text-gray-600"},"|",-1)),e("div",zi,[l.project.website?(i(),r("a",{key:0,href:l.project.website,target:"_blank",class:"flex items-center text-sm text-indigo-600 hover:text-indigo-800 transition-colors",title:"Visit Website"},[v(W(Ws),{class:"h-5 w-5 mr-1"}),y[8]||(y[8]=q(" Website ",-1))],8,qi)):x("",!0),l.project.social_media_link?(i(),r("a",{key:1,href:l.project.social_media_link,target:"_blank",class:"flex items-center text-sm text-indigo-600 hover:text-indigo-800 transition-colors",title:"Social Media"},[v(W(qs),{class:"h-5 w-5 mr-1"}),y[9]||(y[9]=q(" Socials ",-1))],8,Zi)):x("",!0),l.project.google_drive_link?(i(),r("a",{key:2,href:l.project.google_drive_link,target:"_blank",class:"flex items-center text-sm text-indigo-600 hover:text-indigo-800 transition-colors",title:"Google Drive"},[v(W(Bs),{class:"h-5 w-5 mr-1"}),y[10]||(y[10]=q(" Drive ",-1))],8,Gi)):x("",!0)])])]),e("div",Ki,[l.canEditProjects||l.isSuperAdmin?(i(),se(ge,{key:0,onClick:y[0]||(y[0]=L=>N.$inertia.visit("/projects/"+l.projectId+"/edit")),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:z(()=>[v(W(Ds),{class:"h-5 w-5 mr-2"}),y[13]||(y[13]=q(" Edit Project ",-1))]),_:1,__:[13]})):x("",!0),l.canManageProjects||l.isSuperAdmin?(i(),se(be,{key:1,onClick:y[1]||(y[1]=L=>o("openMeetingModal")),class:"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"},{default:z(()=>[v(W(Rs),{class:"h-5 w-5 mr-2"}),y[14]||(y[14]=q(" Schedule Meeting ",-1))]),_:1,__:[14]})):x("",!0),v(be,{onClick:y[2]||(y[2]=L=>o("openStandupModal")),class:"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"},{default:z(()=>[v(W(Fs),{class:"h-5 w-5 mr-2"}),y[15]||(y[15]=q(" Daily Standup ",-1))]),_:1,__:[15]})])]),e("div",Ji,[e("div",Xi,[e("p",Qi,g(l.project.description||"No description provided."),1),e("div",en,[e("button",{onClick:T,class:"flex items-center p-2 rounded-full text-indigo-600 bg-indigo-50 hover:bg-indigo-100 transition-colors",title:"Add Resource"},[v(W(Cs),{class:"h-5 w-5"}),y[16]||(y[16]=e("span",{class:"ml-1 text-sm font-medium"},"Add Resource",-1))]),e("button",{onClick:I,class:"flex items-center p-2 rounded-full text-green-600 bg-green-50 hover:bg-green-100 transition-colors",title:"Share Project"},[v(W(zs),{class:"h-5 w-5"}),y[17]||(y[17]=e("span",{class:"ml-1 text-sm font-medium"},"Share",-1))]),e("button",{onClick:K,class:"flex items-center p-2 rounded-full text-blue-600 bg-blue-50 hover:bg-blue-100 transition-colors",title:"Compose Email"},[v(W(Ts),{class:"h-5 w-5"}),y[18]||(y[18]=e("span",{class:"ml-1 text-sm font-medium"},"Compose Email",-1))])]),e("div",tn,[y[22]||(y[22]=e("h5",{class:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2"},"Dynamic Project Resources",-1)),d.value?(i(),r("div",sn,"Loading resources...")):c.value.length===0?(i(),r("div",ln,"No dynamic resources have been added.")):(i(),r("div",an,[(i(!0),r(J,null,te(c.value,L=>(i(),r("div",{key:L.id,class:"relative"},[e("button",{onClick:xe(fe=>ne(L.id),["prevent"]),class:"resource-button flex items-center p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors text-sm font-medium text-gray-700"},[v(W(Ys),{class:"h-4 w-4 mr-1"}),q(" "+g(L.name),1)],8,nn),u.value===L.id?(i(),r("div",on,[e("div",rn,[e("div",dn,[e("h4",un,g(L.name),1),e("button",{onClick:xe(F,["prevent"]),class:"text-gray-400 hover:text-gray-600"},y[19]||(y[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),L.description?(i(),r("p",cn,g(L.description),1)):x("",!0),e("a",{href:L.url,target:"_blank",class:"mt-2 text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center"},[v(W(Hs),{class:"h-4 w-4 mr-1"}),y[20]||(y[20]=q(" Open Resource ",-1))],8,mn),e("div",vn,[e("button",{onClick:xe(fe=>D(L),["prevent"]),class:"p-1 text-gray-500 hover:text-indigo-600 transition-colors",title:"Edit"},[v(W(Ps),{class:"h-4 w-4"})],8,pn),e("button",{onClick:xe(fe=>O(L.id),["prevent"]),class:"p-1 text-gray-500 hover:text-red-600 transition-colors",title:"Delete"},[v(W(Kt),{class:"h-4 w-4"})],8,hn)])]),y[21]||(y[21]=e("div",{class:"absolute left-1/2 bottom-0 transform translate-y-1/2 -translate-x-1/2 rotate-45 w-4 h-4 bg-white border-r border-b border-gray-200"},null,-1))])):x("",!0)]))),128))]))])]),e("div",gn,[y[25]||(y[25]=e("h5",{class:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2"},"Upcoming Meetings",-1)),E.value?(i(),r("div",fn," Loading meetings... ")):k.value.length===0?(i(),r("div",yn," No upcoming meetings scheduled. ")):(i(),r("div",bn,[(i(!0),r(J,null,te(k.value,L=>(i(),r("div",{key:L.id,class:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[e("h5",wn,g(L.summary),1),e("p",_n,g(Y(L.start_time)),1),e("div",xn,[e("a",{href:L.google_event_link,target:"_blank",class:"text-blue-600 hover:text-blue-800",title:"View in Google Calendar"},y[23]||(y[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]),8,kn),L.google_meet_link?(i(),r("a",{key:0,href:L.google_meet_link,target:"_blank",class:"text-green-600 hover:text-green-800",title:"Join Google Meet"},y[24]||(y[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,Dn)):x("",!0)])]))),128))]))])])]),v(Ui,{show:n.value,"project-id":l.projectId,resource:a.value,onClose:y[3]||(y[3]=L=>n.value=!1),onSaved:le},null,8,["show","project-id","resource"]),v(je,{show:p.value,onClose:oe},{default:z(()=>[e("div",Cn,[y[28]||(y[28]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"}," Send Magic Link ",-1)),M.value?(i(),r("div",Tn,g(M.value),1)):x("",!0),V.value.general?(i(),r("div",Mn,g(V.value.general[0]),1)):x("",!0),e("form",{onSubmit:xe(De,["prevent"])},[e("div",En,[v(G,{for:"client",value:"Select Client"}),h.value?(i(),r("div",$n,"Loading clients...")):f.value?(i(),r("div",Sn,g(f.value),1)):(i(),se(tt,{key:2,id:"client",modelValue:_.value.client_ids,"onUpdate:modelValue":y[4]||(y[4]=L=>_.value.client_ids=L),options:S.value,placeholder:"Select a client","label-key":"name","track-by":"id",class:"mt-1"},null,8,["modelValue","options"])),v(ae,{message:V.value.client_ids?V.value.client_ids[0]:"",class:"mt-2"},null,8,["message"]),y[26]||(y[26]=e("p",{class:"mt-2 text-sm text-gray-500"}," Select a client to send them a magic link for project access. ",-1))]),e("div",jn,[v(be,{onClick:oe,class:"mr-3"},{default:z(()=>y[27]||(y[27]=[q(" Cancel ",-1)])),_:1,__:[27]}),v(ge,{type:"submit",class:"bg-purple-600 hover:bg-purple-700 transition-colors",disabled:w.value},{default:z(()=>[q(g(w.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),v(bs,{show:m.value,title:"Compose New Email","api-endpoint":"/api/emails/templated","http-method":"post",clients:S.value,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","project-id":l.projectId,onClose:y[5]||(y[5]=L=>m.value=!1),onSubmitted:y[6]||(y[6]=L=>m.value=!1),onError:y[7]||(y[7]=L=>console.error("Email submission error:",L))},null,8,["show","clients","project-id"])],64)}}},An=Ae(Vn,[["__scopeId","data-v-daf16b92"]]),On={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},In={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Ln={class:"text-2xl font-bold text-indigo-600"},Pn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Nn={class:"text-2xl font-bold text-indigo-600"},Un={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Rn={class:"text-2xl font-bold text-indigo-600"},Fn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Bn={class:"text-2xl font-bold text-indigo-600"},Hn={__name:"ProjectStatsCards",props:{tasks:{type:Array,required:!0},emails:{type:Array,required:!0}},setup(l){const t=l,s=U(()=>t.tasks.filter(c=>c.status!=="Done").length),o=U(()=>t.emails.filter(c=>c.type==="received").length),n=U(()=>{const c=t.emails.filter(d=>d.status==="received"||d.type==="received");if(c.length>0){const d=[...c].sort((u,m)=>new Date(m.created_at)-new Date(u.created_at));return new Date(d[0].created_at).toLocaleDateString()}return"N/A"}),a=U(()=>{const c=t.tasks.filter(d=>d.status!=="Done");if(c.length>0){const d=c.filter(u=>u.due_date);if(d.length>0)return[...d].sort((m,p)=>new Date(m.due_date)-new Date(p.due_date))[0].due_date}return"N/A"});return(c,d)=>(i(),r("div",On,[e("div",In,[d[0]||(d[0]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Pending Tasks",-1)),e("p",Ln,g(s.value),1)]),e("div",Pn,[d[1]||(d[1]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Received Emails",-1)),e("p",Nn,g(o.value),1)]),e("div",Un,[d[2]||(d[2]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Last Email Received",-1)),e("p",Rn,g(n.value),1)]),e("div",Fn,[d[3]||(d[3]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Next Task Deadline",-1)),e("p",Bn,g(a.value),1)])]))}},Wn={class:"bg-white p-4 rounded-xl shadow-md mb-6"},Yn={class:"border-b border-gray-200"},zn={__name:"ProjectTabsNavigation",props:{selectedTab:{type:String,default:null},canViewEmails:{type:Boolean,required:!0},canViewNotes:{type:Boolean,required:!0},canViewDeliverables:{type:Boolean,required:!0},canViewSeoReports:{type:Boolean,required:!0}},emits:["update:selectedTab"],setup(l,{expose:t,emit:s}){const o=b(null),n=l,a=s,c=U({get:()=>n.selectedTab,set:u=>a("update:selectedTab",u)});return t({scrollIntoView:u=>{o.value&&o.value.scrollIntoView(u)}}),(u,m)=>(i(),r("div",Wn,[e("div",Yn,[e("nav",{class:"-mb-px flex space-x-8 overflow-x-auto",ref_key:"navElement",ref:o},[e("button",{onClick:m[0]||(m[0]=p=>c.value=null),class:Q([c.value===null?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Overview ",2),e("button",{onClick:m[1]||(m[1]=p=>c.value="tasks"),class:Q([c.value==="tasks"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Project Tasks ",2),l.canViewEmails?(i(),r("button",{key:0,onClick:m[2]||(m[2]=p=>c.value="emails"),class:Q([c.value==="emails"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Email Communication ",2)):x("",!0),l.canViewNotes?(i(),r("button",{key:1,onClick:m[3]||(m[3]=p=>c.value="notes"),class:Q([c.value==="notes"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Notes ",2)):x("",!0),l.canViewNotes?(i(),r("button",{key:2,onClick:m[4]||(m[4]=p=>c.value="standups"),class:Q([c.value==="standups"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Daily Standups ",2)):x("",!0),l.canViewDeliverables?(i(),r("button",{key:3,onClick:m[5]||(m[5]=p=>c.value="deliverables"),class:Q([c.value==="deliverables"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Deliverables ",2)):x("",!0),l.canViewSeoReports?(i(),r("button",{key:4,onClick:m[6]||(m[6]=p=>c.value="seo-reports"),class:Q([c.value==="seo-reports"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," SEO Reports ",2)):x("",!0)],512)])]))}},qn={class:"space-y-4"},Zn={key:0,class:"text-sm text-gray-500"},Gn={class:"flex justify-between items-center"},Kn={key:0,class:"text-sm text-gray-500"},Jn="put",Xn="Update Task",Qn="Task updated successfully!",eo={__name:"EditTaskModal",props:{show:Boolean,projectId:Number,selectedTask:Object,projectUsers:Array,taskTypes:Array,milestones:Array,loadingTaskTypes:Boolean,loadingMilestones:Boolean},emits:["close","saved","open-add-milestone-modal"],setup(l,{emit:t}){const s=l,o=t,n=Te({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]}),a=["To Do","In Progress","Done","Blocked","Archived"],c=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],d=U(()=>"Edit Task"),u=U(()=>{var S;return`/api/tasks/${(S=s.selectedTask)==null?void 0:S.id}`});de(()=>[s.show,s.selectedTask],([S,h],[f,k]=[])=>{var E;if(S&&h){let j=null;if(h.milestone){const $=s.milestones.find(T=>T.name===h.milestone);$&&(j=$.id)}else h.milestone_id&&(j=h.milestone_id);let C=null;if(h.task_type){const $=s.taskTypes.find(T=>T.name===h.task_type);$&&(C=$.id)}else h.task_type_id&&(C=h.task_type_id);let P=null;if(h.assigned_to&&h.assigned_to!=="Unassigned"){const $=(E=s.projectUsers)==null?void 0:E.find(T=>T.name===h.assigned_to);$&&(P=$.id)}else h.assigned_to_id&&(P=h.assigned_to_id);let Y=[];h.tags&&Array.isArray(h.tags)&&h.tags.length>0&&(typeof h.tags[0]=="string"?Y=h.tags.map($=>({id:`new_${$.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:$})):typeof h.tags[0]=="object"&&(Y=h.tags)),Object.assign(n,{name:h.title||"",description:h.description||"",assigned_to_user_id:P,due_date:h.due_date||null,status:h.status||"To Do",task_type_id:C,milestone_id:j,priority:h.priority||"medium",tags:Y.map($=>$.id),tags_data:Y}),console.log("Task data loaded:",{taskId:h.id,title:h.title,originalTags:h.tags,processedTags:Y,formTags:n.tags,formTagsData:n.tags_data})}else S||Object.assign(n,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]})},{immediate:!0});const m=S=>{o("saved",S),o("close")},p=()=>{o("open-add-milestone-modal")},w=()=>{o("close")},_=U(()=>s.projectUsers.map(S=>({value:S.id,label:S.name}))),V=U(()=>s.taskTypes.map(S=>({value:S.id,label:S.name}))),M=U(()=>s.milestones.map(S=>({value:S.id,label:S.name})));return(S,h)=>(i(),se(Ve,{show:l.show,title:d.value,"api-endpoint":u.value,"http-method":Jn,"form-data":n,"submit-button-text":Xn,"success-message":Qn,onClose:w,onSubmitted:m},{default:z(({errors:f})=>[e("div",qn,[e("div",null,[v(G,{for:"task-name",value:"Task Name"}),v(me,{id:"task-name",modelValue:n.name,"onUpdate:modelValue":h[0]||(h[0]=k=>n.name=k),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),v(ae,{message:f.name?f.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-description",value:"Description"}),he(e("textarea",{id:"task-description","onUpdate:modelValue":h[1]||(h[1]=k=>n.description=k),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[ke,n.description]]),v(ae,{message:f.description?f.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-status",value:"Status"}),v(pe,{id:"task-status",modelValue:n.status,"onUpdate:modelValue":h[2]||(h[2]=k=>n.status=k),options:a.map(k=>({value:k,label:k})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),v(ae,{message:f.status?f.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-priority",value:"Priority"}),v(pe,{id:"task-priority",modelValue:n.priority,"onUpdate:modelValue":h[3]||(h[3]=k=>n.priority=k),options:c,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),v(ae,{message:f.priority?f.priority[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-due-date",value:"Due Date"}),v(me,{id:"task-due-date",modelValue:n.due_date,"onUpdate:modelValue":h[4]||(h[4]=k=>n.due_date=k),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),v(ae,{message:f.due_date?f.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-assigned-to",value:"Assigned To"}),v(pe,{id:"task-assigned-to",modelValue:n.assigned_to_user_id,"onUpdate:modelValue":h[5]||(h[5]=k=>n.assigned_to_user_id=k),options:_.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"]),v(ae,{message:f.assigned_to_user_id?f.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"task-type",value:"Task Type"}),l.loadingTaskTypes?(i(),r("div",Zn,"Loading task types...")):(i(),se(pe,{key:1,id:"task-type",modelValue:n.task_type_id,"onUpdate:modelValue":h[6]||(h[6]=k=>n.task_type_id=k),options:V.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(ae,{message:f.task_type_id?f.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[e("div",Gn,[v(G,{for:"task-milestone",value:"Milestone"}),e("button",{type:"button",onClick:p,class:"text-sm text-indigo-600 hover:text-indigo-800"}," + Create New Milestone ")]),l.loadingMilestones?(i(),r("div",Kn,"Loading milestones...")):(i(),se(pe,{key:1,id:"task-milestone",modelValue:n.milestone_id,"onUpdate:modelValue":h[7]||(h[7]=k=>n.milestone_id=k),options:M.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),v(ae,{message:f.milestone_id?f.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(Jt,{modelValue:n.tags,"onUpdate:modelValue":h[8]||(h[8]=k=>n.tags=k),initialTags:n.tags_data,label:"Tags",placeholder:"Search or add tags",error:f.tags?f.tags[0]:""},null,8,["modelValue","initialTags","error"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},to={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},so={class:"flex justify-between items-center mb-4"},lo={class:"flex gap-2"},ao={key:0},io={key:1},no={class:"mb-6 overflow-x-auto"},oo={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},ro={key:1,class:"text-center py-4"},uo={key:2,class:"relative py-8"},co={class:"relative flex justify-between"},mo={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vo={key:1,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},po={key:2,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ho={key:3,class:"w-2 h-2 bg-white rounded-full"},go={class:"absolute -top-8 transform -translate-x-1/2 left-1/2 w-32"},fo=["title"],yo={class:"absolute top-8 transform -translate-x-1/2 left-1/2"},bo={class:"text-xs text-gray-500 whitespace-nowrap"},wo={class:"mb-6 bg-gray-50 p-4 rounded-lg"},_o={class:"flex flex-wrap items-center gap-4"},xo={class:"flex-1 min-w-[200px]"},ko={class:"flex-1 min-w-[200px]"},Do={class:"flex-1 min-w-[200px]"},Co={class:"flex-1 min-w-[200px]"},To={key:0,class:"mt-3 text-sm text-gray-600"},Mo={key:0,class:"text-red-600 font-medium"},Eo={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},$o={key:1,class:"text-center py-4"},So={class:"text-red-600 text-sm font-medium"},jo={key:2,class:"overflow-x-auto"},Vo={key:3,class:"text-center py-4"},Ao={class:"p-6"},Oo={class:"mb-4"},Io={class:"flex justify-end space-x-3"},Lo={__name:"ProjectTasksTab",props:{projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},canManageProjects:{type:Boolean,required:!0},tasksFilter:{type:String,default:"all"}},emits:["tasksUpdated","openTaskDetailSidebar","open-create-task-modal","filter-changed"],setup(l,{emit:t}){const s=l,o=t,n=b([]),a=b(!0),c=b(""),d=b(!1),u=b(null),m=b(!1),p=b(!1),w=b(null),_=b(!1),V=b(null),M=b(""),S=b([]),h=b([]),f=b(!1),k=b(!1),E=Te({status:"",assigned_to_user_id:null,milestone_id:null,due_date_range:""}),j=[{value:"",label:"All Statuses"},{value:"To Do",label:"To Do"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Blocked",label:"Blocked"},{value:"Archived",label:"Archived"}],C=U(()=>{const y=[{value:null,label:"All Users"},{value:-1,label:"Unassigned"}];return y.push(...s.projectUsers.map(A=>({value:A.id,label:A.name}))),y}),P=U(()=>{const y=[{value:null,label:"All Milestones"},{value:-1,label:"No Milestone"}];return y.push(...h.value.map(A=>({value:A.id,label:A.name}))),y}),Y=[{value:"",label:"All Dates"},{value:"today",label:"Due Today"},{value:"this_week",label:"Due This Week"},{value:"next_week",label:"Due Next Week"},{value:"overdue",label:"Overdue"},{value:"no_date",label:"No Due Date"}],$=U(()=>!h.value||!h.value.length?[]:[...h.value].sort((y,A)=>y.completion_date?A.completion_date?new Date(y.completion_date)-new Date(A.completion_date):-1:1)),T=U(()=>n.value.length?(console.log("ProjectTasksTab: Tasks array:",n.value),n.value.filter(y=>{if(E.status&&y.status!==E.status)return!1;if(E.assigned_to_user_id!==null){const A=parseInt(E.assigned_to_user_id);if(A===-1){if(y.assigned_to!=="Unassigned"&&y.assigned_to_id!==null)return!1}else if(y.assigned_to_id!==A)return!1}if(E.milestone_id!==null){const A=parseInt(E.milestone_id);if(A===-1){if(y.milestone_id)return!1}else if(y.milestone_id!==A)return!1}if(E.due_date_range){const A=new Date;A.setHours(0,0,0,0);const L=y.due_date?new Date(y.due_date):null;switch(E.due_date_range){case"today":if(!L||L.toDateString()!==A.toDateString())return!1;break;case"this_week":{if(!L)return!1;const fe=new Date(A);if(fe.setDate(A.getDate()+(6-A.getDay())),L<A||L>fe)return!1;break}case"next_week":{if(!L)return!1;const fe=new Date(A);fe.setDate(A.getDate()+(7-A.getDay()));const Me=new Date(fe);if(Me.setDate(fe.getDate()+6),L<fe||L>Me)return!1;break}case"overdue":{if(!L||L>=A)return!1;break}case"no_date":{if(L)return!1;break}}}return!0})):[]),D=()=>{E.status="",E.assigned_to_user_id=null,E.milestone_id=null,E.due_date_range=""},O=async()=>{a.value=!0,c.value="";try{const y=await es(s.projectId);console.log("ProjectTasksTab: Raw API response from fetchProjectTasks:",y),n.value=y,o("tasksUpdated",n.value)}catch(y){c.value="Failed to load tasks data.",console.error("Error fetching project tasks:",y),y.response&&y.response.data&&y.response.data.message&&(c.value=y.response.data.message)}finally{a.value=!1}},le=async y=>{await O()},ne=async()=>{f.value=!0;try{const y=await window.axios.get("/api/task-types");S.value=y.data}catch(y){console.error("Error fetching task types:",y)}finally{f.value=!1}},F=async()=>{k.value=!0;try{const y=await window.axios.get(`/api/projects/${s.projectId}/milestones`);h.value=y.data}catch(y){console.error("Error fetching milestones:",y)}finally{k.value=!1}},B=()=>{o("open-create-task-modal")},H=()=>{O()},I=y=>{console.log("ProjectTasksTab: Emitting openTaskDetailSidebar for taskId:",y,"projectId:",s.projectId),o("openTaskDetailSidebar",y,s.projectId,s.projectUsers)},K=()=>{m.value=!0},oe=y=>{h.value.push(y),O()},De=()=>{O()},N=async()=>{if(V.value){if(!M.value.trim()){rs("Please provide a reason for blocking the task");return}try{ds("Blocking task..."),await window.axios.post(`/api/tasks/${V.value.id}/block`,{reason:M.value}),kt("Task blocked successfully"),_.value=!1,await O()}catch(y){console.error("Error blocking task:",y),et("Failed to block task. Please try again.")}}};return we(()=>{O(),ne(),F()}),de(()=>s.projectUsers,()=>{}),de(()=>s.taskTypes,()=>{}),de(()=>s.milestones,()=>{}),de(()=>s.tasksFilter,y=>{y==="due-overdue"?(new Date().setHours(0,0,0,0),E.status="",E.assigned_to_user_id=null,E.milestone_id=null,E.due_date_range="overdue"):y==="all"&&(E.status="",E.assigned_to_user_id=null,E.milestone_id=null,E.due_date_range=""),o("filter-changed",y)}),(y,A)=>(i(),r("div",to,[e("div",so,[A[11]||(A[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Tasks",-1)),e("div",lo,[v(be,{onClick:O,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:z(()=>[a.value?(i(),r("span",io,"Loading...")):(i(),r("span",ao,"Refresh"))]),_:1},8,["disabled"]),l.canManageProjects?(i(),se(ge,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:B},{default:z(()=>A[10]||(A[10]=[q(" Add Task ",-1)])),_:1,__:[10]})):x("",!0)])]),e("div",no,[k.value?(i(),r("div",oo," Loading milestones... ")):$.value.length?(i(),r("div",uo,[A[16]||(A[16]=e("div",{class:"absolute h-1 bg-gray-200 top-1/2 left-0 right-0 transform -translate-y-1/2"},null,-1)),e("div",co,[(i(!0),r(J,null,te($.value,(L,fe)=>(i(),r("div",{key:L.id,class:Q(["flex flex-col items-center relative z-10",{"ml-4":fe===0,"mr-4":fe===$.value.length-1}])},[e("div",{class:Q(["w-6 h-6 rounded-full shadow-lg flex items-center justify-center",{"bg-gray-300":L.status==="Not Started","bg-blue-500":L.status==="In Progress","bg-green-500":L.status==="Completed","bg-red-500":L.status==="Overdue"}])},[L.status==="Completed"?(i(),r("svg",mo,A[13]||(A[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):L.status==="In Progress"?(i(),r("svg",vo,A[14]||(A[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))):L.status==="Overdue"?(i(),r("svg",po,A[15]||(A[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(i(),r("span",ho))],2),e("div",go,[e("p",{class:"text-xs font-medium text-gray-700 text-center truncate",title:L.name},g(L.name),9,fo)]),e("div",yo,[e("p",bo,g(L.completion_date?new Date(L.completion_date).toLocaleDateString():"No date"),1)])],2))),128))])])):(i(),r("div",ro,A[12]||(A[12]=[e("p",{class:"text-gray-400 text-sm"},"No milestones found for this project.",-1)])))]),e("div",wo,[e("div",_o,[e("div",xo,[v(G,{for:"status-filter",value:"Status"}),v(pe,{id:"status-filter",modelValue:E.status,"onUpdate:modelValue":A[0]||(A[0]=L=>E.status=L),options:j,"value-key":"value","label-key":"label",placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",ko,[v(G,{for:"assigned-filter",value:"Assigned To"}),v(pe,{id:"assigned-filter",modelValue:E.assigned_to_user_id,"onUpdate:modelValue":A[1]||(A[1]=L=>E.assigned_to_user_id=L),options:C.value,"value-key":"value","label-key":"label",placeholder:"All Users",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Do,[v(G,{for:"milestone-filter",value:"Milestone"}),v(pe,{id:"milestone-filter",modelValue:E.milestone_id,"onUpdate:modelValue":A[2]||(A[2]=L=>E.milestone_id=L),options:P.value,"value-key":"value","label-key":"label",placeholder:"All Milestones",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Co,[v(G,{for:"due-date-filter",value:"Due Date"}),v(pe,{id:"due-date-filter",modelValue:E.due_date_range,"onUpdate:modelValue":A[3]||(A[3]=L=>E.due_date_range=L),options:Y,"value-key":"value","label-key":"label",placeholder:"All Dates",class:"mt-1"},null,8,["modelValue"])]),e("div",{class:"flex items-end"},[e("button",{type:"button",onClick:D,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")])]),Object.values(E).some(L=>L!==null&&L!=="")?(i(),r("div",To,[e("p",null,[q(" Showing "+g(T.value.length)+" of "+g(n.value.length)+" tasks ",1),T.value.length===0?(i(),r("span",Mo," (No tasks match the current filters) ")):x("",!0)])])):x("",!0)]),a.value?(i(),r("div",Eo," Loading tasks... ")):c.value?(i(),r("div",$o,[e("p",So,g(c.value),1)])):n.value.length?(i(),r("div",jo,[v(Ct,{tasks:T.value,"project-id":l.projectId,"show-project-column":!1,onTaskUpdated:le,onOpenTaskDetail:I},null,8,["tasks","project-id"])])):(i(),r("div",Vo,A[17]||(A[17]=[e("p",{class:"text-gray-400 text-sm"},"No tasks found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add Task" button to create a new task. ',-1)]))),v(eo,{show:d.value,"project-id":l.projectId,"selected-task":u.value,"project-users":l.projectUsers,"task-types":S.value,milestones:h.value,"loading-task-types":f.value,"loading-milestones":k.value,onClose:A[4]||(A[4]=L=>d.value=!1),onSaved:H,onOpenAddMilestoneModal:K},null,8,["show","project-id","selected-task","project-users","task-types","milestones","loading-task-types","loading-milestones"]),v(Xt,{show:m.value,"project-id":l.projectId,onClose:A[5]||(A[5]=L=>m.value=!1),onSaved:oe},null,8,["show","project-id"]),v(Qt,{show:p.value,"task-for-note":w.value,onClose:A[6]||(A[6]=L=>p.value=!1),onNoteAdded:De},null,8,["show","task-for-note"]),v(je,{show:_.value,onClose:A[9]||(A[9]=L=>_.value=!1)},{default:z(()=>[e("div",Ao,[A[21]||(A[21]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),e("div",Oo,[A[18]||(A[18]=e("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),he(e("textarea",{"onUpdate:modelValue":A[7]||(A[7]=L=>M.value=L),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[ke,M.value]])]),e("div",Io,[v(be,{onClick:A[8]||(A[8]=L=>_.value=!1)},{default:z(()=>A[19]||(A[19]=[q(" Cancel ",-1)])),_:1,__:[19]}),v(ge,{onClick:N,disabled:!M.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:z(()=>A[20]||(A[20]=[q(" Block Task ",-1)])),_:1,__:[20]},8,["disabled"])])])]),_:1},8,["show"])]))}};function Po(l){const t=Le();return{userSignature:U(()=>{const o=t.value&&t.value.name?t.value.name:"",n=l.name??"",a="+61 456 639 389",c="ozeeweb.com.au",d="#1a73e8",u="#fbbc05",m="#1a202c",p="#4a5568",w="#e5e7eb",_="#f9fafb",V=`${window.location.origin}/logo.png`,M=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/facebook-new.png`,S=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/twitter.png`,h=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/linkedin.png`,f=`https://img.icons8.com/ios-filled/20/${d.substring(1)}/instagram-new.png`;return`
            <div style="font-family: 'Inter', sans-serif; padding: 20px; border: 1px solid ${w}; margin-top: 30px; background-color: ${_}; border-radius: 8px; overflow: hidden; box-shadow: 0 0 0 3px ${u};">
                <table role="presentation" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td style="vertical-align: middle;">
                            <p style="margin: 0; font-size: 18px; color: ${m};">Best Regards</p>
                            <p style="margin: 0; font-size: 18px; font-weight: bold; color: ${m};">${o}</p>
                            <p style="margin: 5px 0 5px 0; font-size: 14px; color: ${p};">${n}</p>
                            <p style="margin: 0 0 15px 0; font-size: 12px; color: ${p};">
                                Your website and social media are like your home, first impressions matter!
                            </p>
                            <table role="presentation" cellspacing="0" cellpadding="0">
                                <tr>
                                    <td style="padding-right: 15px;">
                                        <p style="margin: 0; font-size: 13px; color: ${p};">ð ${a}</p>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: ${p};">ð <a href="https://${c}" target="_blank" style="color: ${d}; text-decoration: none;">${c}</a></p>
                                    </td>
                                </tr>
                            </table>
                            <div style="margin-top: 15px; text-align: left;">
                                <a href="https://www.facebook.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${M}" alt="Facebook" style="vertical-align: middle;">
                                </a>
                                <a href="https://twitter.com/yourhandle" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${S}" alt="Twitter" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.linkedin.com/in/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${h}" alt="LinkedIn" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.instagram.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${d}; text-decoration: none;">
                                    <img src="${f}" alt="Instagram" style="vertical-align: middle;">
                                </a>
                            </div>
                        </td>
                        <td style="padding-left: 20px; vertical-align: middle; width: 120px; text-align: right;">
                            <img src="${V}" alt="Company Logo" width="100" style="display: block; border-radius: 8px; margin-left: auto;">
                        </td>
                    </tr>
                </table>

                <p style="margin-top: 25px; font-size: 12px; color: ${p}; text-align: center;">
                    Powered by MMS IT & Web Solutions PTY Ltd.
                </p>
                <p style="margin-top: 10px; font-style: italic; color: ${p}; text-align: center; font-size: 13px;">
                    Please consider the environment before printing this email.
                </p>
                <p style="margin-top: 10px; text-align: center; font-size: 13px;">
                    How did I do? <a href="https://www.example.com/review" target="_blank" style="color: ${d}; text-decoration: none; font-weight: bold;">Leave a review!</a>
                </p>
            </div>
        `})}}const No={class:"mb-4"},Uo={key:0,class:"text-gray-500 text-sm"},Ro={key:1,class:"text-red-500 text-sm"},Fo={class:"mb-4"},Bo={class:"mb-6"},Ho={class:"mb-2 flex justify-end space-x-2"},Wo={class:"mb-4"},Yo={key:0,class:"mt-2"},zo={class:"text-gray-700 text-base mb-2"},qo=["innerHTML"],Zo={class:"p-6"},Go={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Ko={class:"block sm:inline"},Jo={class:"mb-4"},Xo={class:"mb-6"},Qo={class:"flex justify-end space-x-3"},er={class:"p-6"},tr={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},sr={class:"block sm:inline"},lr={class:"mb-4"},ar={class:"mb-6"},ir={class:"flex justify-end space-x-3"},nr={__name:"ComponseEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},userProjectRole:{type:Object,required:!0}},emits:["close","submitted","error"],setup(l,{emit:t}){const s=l,o=t,n=Te({project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),a=b([]),c=b(!0),d=b(""),u=b(!1),m=b(""),p=b(""),w=b(""),_=b(!1),V=b(""),M=b("bullet"),S=b(""),h=b("full_name"),f=b(""),k=b([{value:"full_name",label:"Full Name"},{value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"custom",label:"Custom"}]),{userSignature:E}=Po(U(()=>s.userProjectRole)),j=U(()=>n.body||""),{processedHtmlBody:C}=ws(j),P=U(()=>{if(n.client_ids&&n.client_ids.length>0){const H=n.client_ids[0],I=a.value.find(K=>K.id===H);if(I){const K=I.name.split(" ").filter(N=>N.length>0),oe=K.length>0?K[0]:"",De=K.length>1?K[K.length-1]:"";switch(h.value){case"full_name":return`Hi ${I.name},`;case"first_name":return`Hi ${oe},`;case"last_name":return`Hi ${De},`;case"custom":return`Hi ${f.value.trim()||"there"},`;default:return`Hi ${I.name},`}}}return"Hi there,"});de(()=>s.show,H=>{H&&(Object.assign(n,{project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),h.value="full_name",f.value="",d.value="",B())},{immediate:!0});const Y=H=>{const I={...H};return I.client_ids&&Array.isArray(I.client_ids)&&(I.client_ids=I.client_ids.map(K=>({id:K}))),I.body=C.value,I.greeting_name=P.value,I.custom_greeting_name=f.value.trim(),I.first_client_id=n.client_ids&&n.client_ids.length>0?n.client_ids[0]:null,I},$=()=>{o("close")},T=H=>{o("submitted",H)},D=H=>{o("error",H)},O=()=>{m.value="",p.value="",w.value="",u.value=!0},le=()=>{if(!m.value.trim()){w.value="Link text cannot be empty.";return}let H=p.value.trim();!H.startsWith("http://")&&!H.startsWith("https://")&&(H="http://"+H);try{new URL(H)}catch{w.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const I=`[${m.value.trim()}] {${H}}`;n.body+=I,u.value=!1,m.value="",p.value="",w.value=""},ne=()=>{V.value="",M.value="bullet",S.value="",_.value=!0},F=()=>{const H=V.value.split(`
`).map(oe=>oe.trim()).filter(oe=>oe!=="");if(H.length===0){S.value="Please enter at least one list item.";return}const I=M.value==="bullet"?"ul":"ol";let K=`<${I}>`;H.forEach(oe=>{K+=`<li>${oe}</li>`}),K+=`</${I}>`,n.body+=K,_.value=!1,V.value="",S.value=""},B=async()=>{var H,I;c.value=!0,d.value=null;try{const K=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);a.value=K.data}catch(K){console.error("Failed to fetch project clients:",K),d.value=((I=(H=K.response)==null?void 0:H.data)==null?void 0:I.message)||"Failed to load client data."}finally{c.value=!1}};return we(()=>{}),(H,I)=>(i(),r(J,null,[v(Ve,{show:l.show,title:"Compose New Email","api-endpoint":"/api/emails","http-method":"post","form-data":n,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","format-data-for-api":Y,onClose:$,onSubmitted:T,onError:D,"max-width":"3xl"},{default:z(({errors:K})=>[e("div",No,[v(G,{for:"client_ids",value:"To (Clients)"}),c.value?(i(),r("div",Uo,"Loading clients...")):d.value?(i(),r("div",Ro,g(d.value),1)):(i(),se(tt,{key:2,modelValue:n.client_ids,"onUpdate:modelValue":I[0]||(I[0]=oe=>n.client_ids=oe),options:a.value,placeholder:"Select one or more clients","label-key":"name","value-key":"id"},null,8,["modelValue","options"])),v(ae,{message:K.client_ids?K.client_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Fo,[v(G,{for:"subject",value:"Subject"}),v(me,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:n.subject,"onUpdate:modelValue":I[1]||(I[1]=oe=>n.subject=oe),required:""},null,8,["modelValue"]),v(ae,{message:K.subject?K.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Bo,[e("div",Ho,[v(be,{type:"button",onClick:ne},{default:z(()=>I[13]||(I[13]=[q(" Insert List ",-1)])),_:1,__:[13]}),v(be,{type:"button",onClick:O},{default:z(()=>I[14]||(I[14]=[q(" Insert Link ",-1)])),_:1,__:[14]})]),e("div",Wo,[v(G,{for:"greeting_type",value:"Address Client By"}),v(pe,{id:"greeting_type",modelValue:h.value,"onUpdate:modelValue":I[2]||(I[2]=oe=>h.value=oe),options:k.value,"value-key":"value","label-key":"label",class:"mt-1 block w-full"},null,8,["modelValue","options"]),h.value==="custom"?(i(),r("div",Yo,[v(G,{for:"custom_greeting_name",value:"Custom Name"}),v(me,{id:"custom_greeting_name",type:"text",class:"mt-1 block w-full",modelValue:f.value,"onUpdate:modelValue":I[3]||(I[3]=oe=>f.value=oe),placeholder:"e.g., Azaan"},null,8,["modelValue"])])):x("",!0)]),e("p",zo,g(P.value),1),v(G,{for:"body",value:"Email Body",class:"sr-only"}),v(Es,{id:"body",modelValue:n.body,"onUpdate:modelValue":I[4]||(I[4]=oe=>n.body=oe),placeholder:"Compose your email here...",height:"300px"},null,8,["modelValue"]),v(ae,{message:K.body?K.body[0]:"",class:"mt-2"},null,8,["message"])]),W(E)?(i(),r("div",{key:0,class:"unselectable-signature",innerHTML:W(E)},null,8,qo)):x("",!0)]),_:1},8,["show","form-data"]),v(je,{show:u.value,onClose:I[8]||(I[8]=K=>u.value=!1),"max-width":"md"},{default:z(()=>[e("div",Zo,[I[17]||(I[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),w.value?(i(),r("div",Go,[e("span",Ko,g(w.value),1)])):x("",!0),e("div",Jo,[v(G,{for:"link_text",value:"Link Text"}),v(me,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:m.value,"onUpdate:modelValue":I[5]||(I[5]=K=>m.value=K),onKeyup:qe(le,["enter"])},null,8,["modelValue"])]),e("div",Xo,[v(G,{for:"link_url",value:"URL"}),v(me,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:p.value,"onUpdate:modelValue":I[6]||(I[6]=K=>p.value=K),placeholder:"e.g., https://www.example.com",onKeyup:qe(le,["enter"])},null,8,["modelValue"])]),e("div",Qo,[v(be,{onClick:I[7]||(I[7]=K=>u.value=!1)},{default:z(()=>I[15]||(I[15]=[q("Cancel",-1)])),_:1,__:[15]}),v(ge,{onClick:le},{default:z(()=>I[16]||(I[16]=[q("Insert",-1)])),_:1,__:[16]})])])]),_:1},8,["show"]),v(je,{show:_.value,onClose:I[12]||(I[12]=K=>_.value=!1),"max-width":"md"},{default:z(()=>[e("div",er,[I[21]||(I[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),S.value?(i(),r("div",tr,[e("span",sr,g(S.value),1)])):x("",!0),e("div",lr,[v(G,{for:"list_items",value:"List Items (one per line)"}),he(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":I[9]||(I[9]=K=>V.value=K),placeholder:"Enter each list item on a new line"},null,512),[[ke,V.value]])]),e("div",ar,[v(G,{for:"list_type",value:"List Type"}),he(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":I[10]||(I[10]=K=>M.value=K)},I[18]||(I[18]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[Ze,M.value]])]),e("div",ir,[v(be,{onClick:I[11]||(I[11]=K=>_.value=!1)},{default:z(()=>I[19]||(I[19]=[q("Cancel",-1)])),_:1,__:[19]}),v(ge,{onClick:F},{default:z(()=>I[20]||(I[20]=[q("Insert List",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])],64))}},St=Ae(nr,[["__scopeId","data-v-70bf1503"]]),or={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},rr={class:"flex justify-between items-center mb-4"},dr={key:0,class:"flex gap-3"},ur={key:1,class:"mt-2 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative",role:"alert"},cr={class:"block sm:inline"},mr={class:"mb-4 bg-gray-50 p-4 rounded-lg"},vr={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},pr={class:"mt-1 relative rounded-md shadow-sm"},hr={__name:"ProjectEmailsTab",props:{projectId:{type:Number,required:!0},canViewEmails:{type:Boolean,required:!0},canComposeEmails:{type:Boolean,required:!0},canApproveEmails:{type:Boolean,required:!0},userProjectRole:{type:Object,required:!0},openCompose:{type:Boolean,required:!1,default:!1}},emits:["emailsUpdated","resetOpenCompose"],setup(l,{emit:t}){const s=l,o=t,n=b([]),a=b(!0),c=b(""),d=b(null),u=b(!1),m=b(!1),p=b(""),w=b(""),_=b("post"),V=b(""),M=b(""),S=b(!1),h=b(!1),f=b(null),k=b(""),E=b(""),j=b(""),C=b(null);Le();const P=Te({type:"",startDate:"",endDate:"",search:""});let Y=null;const $=()=>{O()},T=()=>{P.type="",P.startDate="",P.endDate="",P.search="",O()},D=()=>{clearTimeout(Y),Y=setTimeout(()=>{$()},500)},O=async()=>{a.value=!0,c.value="";try{const N=new URLSearchParams;P.type&&N.append("type",P.type),P.startDate&&N.append("start_date",P.startDate),P.endDate&&N.append("end_date",P.endDate),P.search&&N.append("search",P.search);const y=N.toString(),A=`/api/projects/${s.projectId}/emails-simplified${y?`?${y}`:""}`,L=await window.axios.get(A);n.value=L.data,o("emailsUpdated",n.value)}catch(N){c.value="Failed to load email data.",console.error("Error fetching project emails:",N)}finally{a.value=!1}},le=async N=>{d.value=null,u.value=!0;try{const y=await window.axios.get(`/api/emails/${N.id}`);d.value={...N,subject:y.data.subject,body:y.data.body_html}}catch(y){console.error("Failed to fetch full email details:",y),d.value={subject:"Error",body:"Failed to load email content.",created_at:new Date().toISOString(),status:"error",sender:{name:"System"}}}},ne=async N=>{try{console.log("Opening email editor for email ID:",N.id),d.value=N;const A=(await window.axios.get(`/api/emails/${N.id}/edit-content`)).data;A.template_id?(console.log("Opening template-based email editor for email ID:",N.id),f.value=N.id,k.value=`/api/emails/${N.id}/edit-and-approve`,E.value="Approve & Send",j.value="Email updated and approved successfully!",C.value=A.client_id,h.value=!0,u.value=!1):(p.value="Edit and Approve Email",w.value=`/api/emails/${N.id}/edit-and-approve`,_.value="post",V.value="Approve & Send",M.value="Email updated and approved successfully!",m.value=!0,u.value=!1)}catch(y){console.error("Failed to determine email type:",y),c.value="Failed to load email for editing."}},F=N=>{d.value=N,p.value="Reject Email",w.value=`/api/emails/${N.id}/reject`,_.value="post",V.value="Reject Email",M.value="Email rejected successfully!",m.value=!0,u.value=!1},B=async N=>{console.log("Form submitted successfully:",N),await O(),m.value=!1},H=()=>{m.value=!1},I=()=>{S.value=!1,o("resetOpenCompose")},K=async N=>{console.log("Compose email submitted successfully:",N),await O(),S.value=!1,o("resetOpenCompose")},oe=()=>{h.value=!1},De=async N=>{console.log("Template email edited and submitted successfully:",N),await O(),h.value=!1};return de(()=>s.openCompose,N=>{console.log("Watcher triggered: openCompose changed to",N),N&&(console.log("Opening compose email modal"),S.value=!0)}),we(()=>{s.canViewEmails&&O(),s.openCompose&&(S.value=!0)}),(N,y)=>{var A;return l.canViewEmails?(i(),r("div",or,[e("div",rr,[y[10]||(y[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Email Communication",-1)),l.canComposeEmails?(i(),r("div",dr,[v(ge,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:y[0]||(y[0]=L=>S.value=!0)},{default:z(()=>y[9]||(y[9]=[q(" Compose Email ",-1)])),_:1,__:[9]})])):x("",!0),c.value?(i(),r("div",ur,[e("span",cr,g(c.value),1)])):x("",!0)]),e("div",mr,[e("div",vr,[e("div",null,[v(G,{for:"typeFilter",value:"Type"}),he(e("select",{id:"typeFilter","onUpdate:modelValue":y[1]||(y[1]=L=>P.type=L),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:$},y[11]||(y[11]=[e("option",{value:""},"All Types",-1),e("option",{value:"sent"},"Sent",-1),e("option",{value:"received"},"Received",-1)]),544),[[Ze,P.type]])]),e("div",null,[v(G,{for:"startDate",value:"From Date"}),v(me,{type:"date",id:"startDate",modelValue:P.startDate,"onUpdate:modelValue":y[2]||(y[2]=L=>P.startDate=L),class:"mt-1 block w-full",onChange:$},null,8,["modelValue"])]),e("div",null,[v(G,{for:"endDate",value:"To Date"}),v(me,{type:"date",id:"endDate",modelValue:P.endDate,"onUpdate:modelValue":y[3]||(y[3]=L=>P.endDate=L),class:"mt-1 block w-full",onChange:$},null,8,["modelValue"])]),e("div",null,[v(G,{for:"searchFilter",value:"Search Content"}),e("div",pr,[v(me,{type:"text",id:"searchFilter",modelValue:P.search,"onUpdate:modelValue":y[4]||(y[4]=L=>P.search=L),class:"block w-full pr-10",placeholder:"Search in email content...",onInput:D},null,8,["modelValue"]),y[12]||(y[12]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:T}," Reset Filters ")])]),v(Ms,{emails:n.value,loading:a.value,error:c.value,onView:le},null,8,["emails","loading","error"]),v(_s,{show:u.value,email:d.value,"can-approve-emails":l.canApproveEmails,onClose:y[5]||(y[5]=L=>u.value=!1),onEdit:ne,onReject:F},null,8,["show","email","can-approve-emails"]),v(St,{show:S.value,"project-id":l.projectId,"user-project-role":l.userProjectRole,onClose:I,onSubmitted:K,onError:y[6]||(y[6]=L=>console.error("ComposeEmailModal error:",L))},null,8,["show","project-id","user-project-role"]),v(xs,{show:m.value,title:p.value,"api-endpoint":w.value,"http-method":_.value,"submit-button-text":V.value,"success-message":M.value,"email-id":(A=d.value)==null?void 0:A.id,"project-id":l.projectId,onClose:H,onSubmitted:B,onError:y[7]||(y[7]=L=>console.error("EmailActionModal error:",L)),onFetchEmails:O},null,8,["show","title","api-endpoint","http-method","submit-button-text","success-message","email-id","project-id"]),v(ks,{show:h.value,title:"Edit Template Email","api-endpoint":k.value,"http-method":"post","submit-button-text":E.value,"success-message":j.value,"email-id":f.value,"project-id":l.projectId,"client-id":C.value,onClose:oe,onSubmitted:De,onError:y[8]||(y[8]=L=>console.error("EditTemplateEmailModal error:",L))},null,8,["show","api-endpoint","submit-button-text","success-message","email-id","project-id","client-id"])])):x("",!0)}}},gr={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},fr={class:"flex justify-between items-center mb-4"},yr={class:"flex gap-3"},br={class:"mb-4 bg-gray-50 p-4 rounded-lg"},wr={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},_r={class:"mt-1 relative rounded-md shadow-sm"},xr={class:"mb-8 p-4 bg-blue-50 rounded-md"},kr={class:"flex items-center"},Dr={class:"text-sm text-blue-800"},Cr={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Tr={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},Mr={key:2,class:"space-y-4"},Er={class:"flex justify-between"},$r={class:"flex-grow"},Sr={key:0,class:"text-xs text-red-400 block mt-1"},jr={class:"flex items-center mt-1"},Vr={class:"text-xs text-gray-500"},Ar={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},Or={key:0},Ir={key:3,class:"text-gray-400 text-sm"},Lr={class:"p-6"},Pr={class:"flex justify-between items-center mb-4"},Nr={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},Ur={class:"text-sm text-gray-700"},Rr={class:"text-xs text-gray-500 mt-1"},Fr={key:1,class:"mb-4"},Br={key:0,class:"text-center py-4"},Hr={key:1,class:"space-y-3 max-h-60 overflow-y-auto"},Wr={class:"text-sm text-gray-700"},Yr={class:"text-xs text-gray-500 mt-1"},zr={key:2,class:"text-center py-3"},qr={key:2,class:"mb-4"},Zr={key:0,class:"mt-2 text-sm text-red-600"},Gr={key:3,class:"mt-6 flex justify-end"},Kr={__name:"ProjectNotesTab",props:{projectId:{type:Number,required:!0},googleChatId:{type:String,default:null},canViewNotes:{type:Boolean,required:!0},canAddNotes:{type:Boolean,required:!0}},emits:["notesUpdated"],setup(l,{emit:t}){const s=l,o=t,n=b([]),a=b(!0),c=b(""),d=b(!1),u=b(!1),m=b(null),p=b(""),w=b(""),_=b([]),V=b(!1),M=Te({startDate:"",endDate:"",search:""});let S=null;const h=async()=>{a.value=!0,c.value="";try{const Y=new URLSearchParams;M.startDate&&Y.append("start_date",M.startDate),M.endDate&&Y.append("end_date",M.endDate),M.search&&Y.append("search",M.search);const $=Y.toString(),T=`/api/projects/${s.projectId}/notes${$?`?${$}`:""}`,D=await window.axios.get(T);n.value=D.data,o("notesUpdated",n.value)}catch(Y){c.value="Failed to load notes data.",console.error("Error fetching project notes:",Y)}finally{a.value=!1}},f=()=>{d.value=!0},k=async Y=>{m.value=Y,p.value="",w.value="",_.value=[],V.value=!0,u.value=!0;try{const $=await window.axios.get(`/api/projects/${s.projectId}/notes/${Y.id}/replies`);$.data.success?_.value=$.data.replies:console.error("Failed to fetch replies:",$.data.message)}catch($){console.error("Error fetching replies:",$)}finally{V.value=!1}},E=async()=>{var Y,$;if(!m.value||!p.value.trim()){w.value="Reply content is required";return}w.value="";try{const T=await window.axios.post(`/api/projects/${s.projectId}/notes/${m.value.id}/reply`,{content:p.value});if(T.data.success){p.value="",V.value=!0;const D=await window.axios.get(`/api/projects/${s.projectId}/notes/${m.value.id}/replies`);D.data.success&&(_.value=D.data.replies),V.value=!1,await h()}else w.value=T.data.message||"Failed to send reply"}catch(T){console.error("Error sending reply:",T),w.value=(($=(Y=T.response)==null?void 0:Y.data)==null?void 0:$.message)||"An error occurred while sending the reply"}},j=()=>{h()},C=()=>{M.startDate="",M.endDate="",M.search="",h()},P=()=>{clearTimeout(S),S=setTimeout(()=>{j()},500)};return we(()=>{s.canViewNotes&&h()}),(Y,$)=>l.canViewNotes?(i(),r("div",gr,[e("div",fr,[$[10]||($[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Notes",-1)),e("div",yr,[l.canAddNotes?(i(),se(ge,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:f},{default:z(()=>$[9]||($[9]=[q(" Add Note ",-1)])),_:1,__:[9]})):x("",!0)])]),e("div",br,[e("div",wr,[e("div",null,[v(G,{for:"noteStartDate",value:"From Date"}),v(me,{type:"date",id:"noteStartDate",modelValue:M.startDate,"onUpdate:modelValue":$[0]||($[0]=T=>M.startDate=T),class:"mt-1 block w-full",onChange:j},null,8,["modelValue"])]),e("div",null,[v(G,{for:"noteEndDate",value:"To Date"}),v(me,{type:"date",id:"noteEndDate",modelValue:M.endDate,"onUpdate:modelValue":$[1]||($[1]=T=>M.endDate=T),class:"mt-1 block w-full",onChange:j},null,8,["modelValue"])]),e("div",null,[v(G,{for:"noteSearchFilter",value:"Search Content"}),e("div",_r,[v(me,{type:"text",id:"noteSearchFilter",modelValue:M.search,"onUpdate:modelValue":$[2]||($[2]=T=>M.search=T),class:"block w-full pr-10",placeholder:"Search in note content...",onInput:P},null,8,["modelValue"]),$[11]||($[11]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:C}," Reset Filters ")])]),e("div",xr,[e("div",kr,[$[13]||($[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",Dr,[$[12]||($[12]=q(" Daily Standups are now available in their own dedicated tab. ",-1)),e("button",{onClick:$[3]||($[3]=T=>Y.$emit("changeTab","standups")),class:"text-blue-600 hover:text-blue-800 font-medium underline"}," Click here to view Daily Standups ")])])]),e("div",null,[$[15]||($[15]=e("h5",{class:"text-md font-semibold text-gray-900 mb-4 border-b pb-2"},"Notes",-1)),a.value?(i(),r("div",Cr," Loading notes... ")):c.value?(i(),r("div",Tr,g(c.value),1)):n.value.length?(i(),r("div",Mr,[(i(!0),r(J,null,te(n.value,T=>{var D;return i(),r("div",{key:T.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",Er,[e("div",$r,[e("p",{class:Q(["text-sm",{"text-gray-700":T.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":T.content==="[Encrypted content could not be decrypted]"}])},[q(g(T.content)+" ",1),T.content==="[Encrypted content could not be decrypted]"?(i(),r("span",Sr," (There was an issue decrypting this note. Please contact an administrator.) ")):x("",!0)],2),e("div",jr,[e("p",Vr,"Added by "+g(((D=T.user)==null?void 0:D.name)||"Unknown")+" on "+g(new Date(T.created_at).toLocaleDateString()),1),T.reply_count>0?(i(),r("span",Ar,g(T.reply_count)+" "+g(T.reply_count===1?"reply":"replies"),1)):x("",!0)])]),l.googleChatId&&T.chat_message_id?(i(),r("div",Or,[v(be,{class:"text-sm text-indigo-600 hover:text-indigo-800",onClick:O=>k(T)},{default:z(()=>$[14]||($[14]=[q(" View ",-1)])),_:2,__:[14]},1032,["onClick"])])):x("",!0)])])}),128))])):(i(),r("p",Ir,"No notes available."))]),v(Tt,{show:d.value,"project-id":l.projectId,onClose:$[4]||($[4]=T=>d.value=!1),onNoteAdded:h},null,8,["show","project-id"]),v(je,{show:u.value,onClose:$[8]||($[8]=T=>u.value=!1)},{default:z(()=>{var T;return[e("div",Lr,[e("div",Pr,[$[17]||($[17]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Reply to Note",-1)),e("button",{onClick:$[5]||($[5]=D=>u.value=!1),class:"text-gray-400 hover:text-gray-500"},$[16]||($[16]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),m.value?(i(),r("div",Nr,[e("p",Ur,g(m.value.content),1),e("p",Rr,"Added by "+g(((T=m.value.user)==null?void 0:T.name)||"Unknown")+" on "+g(new Date(m.value.created_at).toLocaleDateString()),1)])):x("",!0),m.value?(i(),r("div",Fr,[$[20]||($[20]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Replies",-1)),V.value?(i(),r("div",Br,$[18]||($[18]=[e("p",{class:"text-gray-500 text-sm"},"Loading replies...",-1)]))):_.value.length?(i(),r("div",Hr,[(i(!0),r(J,null,te(_.value,D=>{var O;return i(),r("div",{key:D.id,class:"p-2 bg-gray-50 rounded border-l-2 border-indigo-300"},[e("p",Wr,g(D.content),1),e("p",Yr,"Replied by "+g(((O=D.user)==null?void 0:O.name)||"Unknown")+" on "+g(new Date(D.created_at).toLocaleDateString()),1)])}),128))])):(i(),r("div",zr,$[19]||($[19]=[e("p",{class:"text-gray-500 text-sm"},"No replies yet. Be the first to reply!",-1)])))])):x("",!0),l.canAddNotes?(i(),r("div",qr,[v(G,{for:"reply-content",value:"Your Reply"}),he(e("textarea",{id:"reply-content","onUpdate:modelValue":$[6]||($[6]=D=>p.value=D),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your reply..."},null,512),[[ke,p.value]]),w.value?(i(),r("p",Zr,g(w.value),1)):x("",!0)])):x("",!0),l.canAddNotes?(i(),r("div",Gr,[v(be,{onClick:$[7]||($[7]=D=>u.value=!1),class:"mr-2"},{default:z(()=>$[21]||($[21]=[q("Cancel",-1)])),_:1,__:[21]}),v(ge,{onClick:E},{default:z(()=>$[22]||($[22]=[q("Send Reply",-1)])),_:1,__:[22]})])):x("",!0)])]}),_:1},8,["show"])])):x("",!0)}},Jr={class:"w-full"},Xr={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Qr={key:1,class:"text-red-600 text-sm py-2 text-center"},ed={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},td={class:"p-4 bg-blue-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},sd={class:"text-2xl font-bold text-blue-900 mt-1"},ld={class:"p-4 bg-green-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},ad={class:"text-2xl font-bold text-green-900 mt-1"},id={class:"p-4 bg-red-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},nd={class:"text-2xl font-bold mt-1"},od={key:3,class:"space-y-2 text-sm text-gray-700 mt-6 pt-4 border-t border-gray-200"},rd={key:0},dd={class:"text-gray-900 whitespace-pre-wrap"},ud={key:4,class:"text-gray-400 text-sm mt-4 text-center"},cd={__name:"ProjectFinancialsCard",props:{projectId:{type:Number,required:!0},canViewProjectServicesAndPayments:{type:Boolean,default:!1},canViewProjectTransactions:{type:Boolean,default:!1}},setup(l){const t=l,s=b(null),o=b([]),n=b(!0),a=b(null),c=He,d=U(()=>{var V;if(!ve.value||Object.keys(ve.value).length===0)return 0;const _=parseFloat(((V=s.value)==null?void 0:V.total_amount)||0);return Ie(_,"USD",c.value)}),u=U(()=>!o.value.length||!ve.value||Object.keys(ve.value).length===0?0:o.value.filter(_=>_.type==="expense").reduce((_,V)=>_+Ie(parseFloat(V.amount||0),V.currency,c.value),0)),m=U(()=>!o.value.length||!ve.value||Object.keys(ve.value).length===0?0:o.value.filter(_=>_.type==="income").reduce((_,V)=>_+Ie(parseFloat(V.amount||0),V.currency,c.value),0)),p=U(()=>m.value-u.value),w=async()=>{var _,V;if(n.value=!0,a.value=null,o.value=[],!ve.value||Object.keys(ve.value).length===0){a.value="Currency rates not loaded. Please try again.",n.value=!1;return}if(!t.canViewProjectServicesAndPayments&&!t.canViewProjectTransactions){a.value="You don't have permission to view project financials.",n.value=!1;return}try{if(t.canViewProjectServicesAndPayments){const M=await window.axios.get(`/api/projects/${t.projectId}/sections/services-payment`);s.value=M.data}else s.value=null;if(t.canViewProjectTransactions){const M=await window.axios.get(`/api/projects/${t.projectId}/sections/transactions`);o.value=M.data}else o.value=[]}catch(M){console.error("Failed to fetch project financials:",M),a.value=((V=(_=M.response)==null?void 0:_.data)==null?void 0:V.message)||"Failed to load financial data."}finally{n.value=!1}};return de([()=>t.canViewProjectServicesAndPayments,()=>t.canViewProjectTransactions,c,ve],(_,V)=>{t.projectId&&ve.value&&Object.keys(ve.value).length>0?w():t.projectId||(n.value=!0,a.value=null)},{immediate:!0,deep:!0}),(_,V)=>{var M,S;return i(),r("div",Jr,[n.value?(i(),r("div",Xr,[(i(),r(J,null,te(4,h=>e("div",{key:h,class:"p-4 bg-gray-100 rounded-lg animate-pulse h-24"},V[0]||(V[0]=[e("div",{class:"h-4 bg-gray-200 rounded w-1/2 mb-3"},null,-1),e("div",{class:"h-6 bg-gray-200 rounded w-3/4"},null,-1)]))),64))])):a.value?(i(),r("div",Qr,[e("p",null,g(a.value),1)])):(i(),r("div",ed,[e("div",td,[V[1]||(V[1]=e("p",{class:"text-sm font-medium text-blue-800"},"Contract Value",-1)),e("p",sd,g(W(Se)(d.value,W(c).value)),1)]),e("div",ld,[V[2]||(V[2]=e("p",{class:"text-sm font-medium text-green-800"},"Total Income",-1)),e("p",ad,g(W(Se)(m.value,W(c))),1)]),e("div",id,[V[3]||(V[3]=e("p",{class:"text-sm font-medium text-red-800"},"Total Expenses",-1)),e("p",nd,g(W(Se)(u.value,W(c))),1)]),e("div",{class:Q(["p-4 rounded-lg shadow-sm transition-shadow hover:shadow-lg",{"bg-green-100":p.value>=0,"bg-red-100":p.value<0}])},[e("p",{class:Q(["text-sm font-medium",{"text-green-800":p.value>=0,"text-red-800":p.value<0}])},"Profit/Loss",2),e("p",{class:Q(["text-2xl font-bold mt-1",{"text-green-900":p.value>=0,"text-red-900":p.value<0}])},g(W(Se)(p.value,W(c))),3)],2)])),!n.value&&!a.value&&((M=s.value)!=null&&M.contract_details)?(i(),r("dl",od,[(S=s.value)!=null&&S.contract_details?(i(),r("div",rd,[V[4]||(V[4]=e("dt",{class:"font-medium w-full block mt-2"},"Contract Details:",-1)),e("dd",dd,g(s.value.contract_details),1)])):x("",!0)])):x("",!0),!n.value&&!a.value&&!s.value&&!o.value.length?(i(),r("p",ud," No financial information available. ")):x("",!0)])}}},md={class:"bg-white p-4 rounded-xl shadow-md transition-shadow hover:shadow-lg flex flex-col h-full"},vd={key:0,class:"flex-1 flex items-center justify-center"},pd={key:1,class:"flex-1 flex items-center justify-center text-red-600 text-xs text-center"},hd={key:2,class:"flex-1 flex flex-col overflow-hidden"},gd={key:0,class:"flex-1 overflow-y-auto"},fd={class:"p-2 bg-gray-50 rounded-lg flex items-center space-x-2"},yd={class:"flex-shrink-0 bg-indigo-500 rounded-full h-8 w-8 flex items-center justify-center text-white font-medium text-xs"},bd={class:"flex-1"},wd={class:"text-sm font-semibold text-gray-900 truncate"},_d={class:"text-xs text-gray-500 flex items-center mt-0.5"},xd={key:0,class:"flex items-center space-x-1 mr-2"},kd={key:1,class:"flex items-center space-x-1"},Dd=["href"],Cd={key:0,class:"mt-3"},Td={class:"space-y-1"},Md={class:"flex items-center space-x-2"},Ed={class:"flex-shrink-0 bg-gray-300 rounded-full h-6 w-6 flex items-center justify-center text-white font-medium text-xs"},$d={class:"text-xs font-semibold text-gray-900"},Sd={key:0,class:"text-xs text-gray-500"},jd=["href"],Vd={key:1,class:"text-gray-400 text-xs flex-1 flex items-center justify-center text-center"},Ad={__name:"ProjectClientsCard",props:{projectId:{type:Number,required:!0},canViewClientContacts:{type:Boolean,default:!1}},setup(l){const t=l,s=b([]),o=b(!0),n=b(null),a=async()=>{var c,d;if(o.value=!0,n.value=null,!t.canViewClientContacts){n.value="You don't have permission to view project clients.",o.value=!1;return}try{const u=await window.axios.get(`/api/projects/${t.projectId}/sections/clients?type=clients`);s.value=u.data}catch(u){console.error("Failed to fetch project clients:",u),n.value=((d=(c=u.response)==null?void 0:c.data)==null?void 0:d.message)||"Failed to load client data."}finally{o.value=!1}};return we(()=>{a()}),de(()=>t.canViewClientContacts,()=>{a()}),(c,d)=>(i(),r("div",md,[d[3]||(d[3]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Project Clients",-1)),o.value?(i(),r("div",vd,d[0]||(d[0]=[e("div",{class:"space-y-2 w-full"},[e("div",{class:"h-3 bg-gray-200 rounded animate-pulse w-3/4 mx-auto"}),e("div",{class:"h-3 bg-gray-200 rounded animate-pulse w-2/3 mx-auto"})],-1)]))):n.value?(i(),r("div",pd,[e("p",null,g(n.value),1)])):(i(),r("div",hd,[s.value.length?(i(),r("div",gd,[(i(!0),r(J,null,te(s.value,u=>(i(),r("div",{key:u.id,class:"space-y-3"},[e("div",fd,[e("div",yd,g(u.name.charAt(0).toUpperCase()),1),e("div",bd,[e("p",wd,g(u.name),1),e("p",_d,[u.email?(i(),r("span",xd,[v(W(gt),{class:"h-3 w-3"}),e("span",null,g(u.email),1)])):x("",!0),u.phone?(i(),r("span",kd,[v(W(Ns),{class:"h-3 w-3"}),e("span",null,g(u.phone),1)])):x("",!0)])]),u.website?(i(),r("a",{key:0,href:u.website,target:"_blank",class:"text-indigo-600 hover:text-indigo-800 transition-colors"},[v(W(Ls),{class:"h-5 w-5"})],8,Dd)):x("",!0)]),u.contacts&&u.contacts.length?(i(),r("div",Cd,[d[1]||(d[1]=e("p",{class:"text-xs font-semibold text-gray-500 uppercase mb-2 ml-2"},"Client Contacts",-1)),e("ul",Td,[(i(!0),r(J,null,te(u.contacts,m=>(i(),r("li",{key:m.id,class:"flex items-center justify-between p-2 bg-gray-100 rounded-lg"},[e("div",Md,[e("div",Ed,g(m.name.charAt(0).toUpperCase()),1),e("div",null,[e("p",$d,g(m.name),1),m.role?(i(),r("p",Sd,g(m.role),1)):x("",!0)])]),m.email?(i(),r("a",{key:0,href:"mailto:"+m.email,class:"text-gray-400 hover:text-indigo-600 transition-colors",title:"Email Contact"},[v(W(gt),{class:"h-4 w-4"})],8,jd)):x("",!0)]))),128))])])):x("",!0)]))),128))])):(i(),r("p",Vd,d[2]||(d[2]=[q(" No clients assigned. ",-1),e("br",null,null,-1),q(" To view this card, please assign a client to the project. ",-1)])))]))]))}},Od={class:"bg-white p-4 rounded-xl shadow-md transition-shadow hover:shadow-lg flex flex-col h-full"},Id={key:0,class:"flex-1 flex items-center justify-center"},Ld={key:1,class:"flex-1 flex items-center justify-center text-red-600 text-xs text-center"},Pd={key:2,class:"flex-1 flex flex-col overflow-hidden"},Nd={class:"flex items-center space-x-2 text-gray-500 mb-3"},Ud={class:"text-xs font-semibold"},Rd={key:0,class:"space-y-2 text-sm text-gray-700 flex-1 overflow-y-auto pr-2",style:{"max-height":"250px"}},Fd={class:"flex items-center space-x-2"},Bd={class:"flex-shrink-0 bg-indigo-500 rounded-full h-8 w-8 flex items-center justify-center text-white font-medium text-xs"},Hd={class:"flex-1"},Wd={class:"text-gray-900 text-sm"},Yd={class:"text-xs text-gray-500"},zd={class:"flex-shrink-0 flex items-center space-x-2 ml-auto"},qd={class:"text-xs text-gray-500"},Zd={key:1,class:"text-gray-400 text-xs flex-1 flex items-center justify-center"},Gd={__name:"ProjectTeamCard",props:{projectId:{type:Number,required:!0},canViewUsers:{type:Boolean,default:!1}},setup(l){const t=l,s=Le(),o=b([]),n=b(!0),a=b(null),c=async()=>{var m,p;if(n.value=!0,a.value=null,!t.canViewUsers){a.value="You don't have permission to view project team members.",n.value=!1,o.value=[];return}try{const w=await window.axios.get(`/api/projects/${t.projectId}/sections/users`);o.value=w.data.users||[]}catch(w){console.error("Failed to fetch project users:",w),a.value=((p=(m=w.response)==null?void 0:m.data)==null?void 0:p.message)||"Failed to load team data."}finally{n.value=!1}},d=m=>{if(!m.availabilities||m.availabilities.length===0)return"No availability submitted.";const p=m.availabilities[0];return p.is_available?p.time_slots&&p.time_slots.length>0?`Available: ${p.time_slots.map(_=>`${_.start_time}-${_.end_time}`).join(", ")}`:"Available: No specific slots.":`Not available: ${p.reason||"N/A"}`},u=m=>!m.availabilities||m.availabilities.length===0?null:m.availabilities[0].is_available?js:Us;return we(()=>{c()}),de([()=>t.canViewUsers,()=>s.value,()=>t.projectId],()=>{c()},{deep:!0}),(m,p)=>(i(),r("div",Od,[p[1]||(p[1]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3"},"Project Team",-1)),n.value?(i(),r("div",Id,p[0]||(p[0]=[e("div",{class:"space-y-2 w-full"},[e("div",{class:"h-3 bg-gray-200 rounded animate-pulse w-3/4 mx-auto"}),e("div",{class:"h-3 bg-gray-200 rounded animate-pulse w-2/3 mx-auto"})],-1)]))):a.value?(i(),r("div",Ld,[e("p",null,g(a.value),1)])):(i(),r("div",Pd,[e("div",Nd,[v(W(Mt),{class:"h-5 w-5"}),e("span",Ud,g(o.value.length)+" Member(s)",1)]),o.value.length?(i(),r("ul",Rd,[(i(!0),r(J,null,te(o.value,w=>{var _;return i(),r("li",{key:w.id,class:"p-2 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[e("div",Fd,[e("div",Bd,g(w.name.charAt(0).toUpperCase()),1),e("div",Hd,[e("strong",Wd,g(w.name),1),e("p",Yd,g(((_=w.pivot)==null?void 0:_.role)||"N/A"),1)]),e("div",zd,[e("span",qd,g(d(w)),1),u(w)?(i(),se(_t(u(w)),{key:0,class:Q({"h-5 w-5":!0,"text-green-500":w.availabilities&&w.availabilities.length>0&&w.availabilities[0].is_available,"text-red-500":w.availabilities&&w.availabilities.length>0&&!w.availabilities[0].is_available})},null,8,["class"])):x("",!0)])])])}),128))])):(i(),r("p",Zd,"No team members assigned."))]))]))}},Kd={class:"bg-white p-4 rounded-xl shadow-md transition-shadow hover:shadow-lg flex flex-col h-full"},Jd={class:"flex items-center space-x-2 mb-3"},Xd={key:0,class:"flex-1 flex items-center justify-center"},Qd={key:1,class:"flex-1 flex items-center justify-center text-red-600 text-xs text-center"},eu={key:2,class:"flex-1 flex flex-col overflow-hidden"},tu={key:0,class:"space-y-2 text-xs"},su={class:"flex items-center space-x-2 text-gray-500 mb-3"},lu={class:"text-xs font-semibold"},au={class:"flex flex-col p-2 bg-green-50 rounded-lg"},iu={class:"text-gray-900 font-bold mt-1"},nu={class:"flex flex-col p-2 bg-blue-50 rounded-lg"},ou={class:"text-gray-900 font-bold mt-1"},ru={class:"flex flex-col p-2 bg-indigo-50 rounded-lg"},du={class:"text-gray-900 font-bold mt-1"},uu={class:"mt-4 pt-2 border-t border-gray-200"},cu={class:"flex justify-between items-center text-xs text-gray-500 font-medium mb-1"},mu={class:"w-full bg-gray-200 rounded-full h-1.5"},vu={key:1,class:"flex-1 flex items-center justify-center text-gray-400 text-xs text-center"},pu={key:0},hu={key:1},gu={key:2,class:"mt-4 text-right"},fu={__name:"UserFinancialCard",props:{projectId:{type:Number,required:!0}},emits:["viewUserTransactions"],setup(l,{emit:t}){const s=l,o=t,n=Le(),a=b(!0),c=b(null),d=b([]),u=He,m=async()=>{var h,f;if(a.value=!0,c.value=null,!n.value||!n.value.id||!s.projectId){d.value=[],a.value=!1;return}if(!ve.value||Object.keys(ve.value).length===0){c.value="Currency rates not loaded. Please try again.",a.value=!1;return}try{const k=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${n.value.id}`);d.value=k.data}catch(k){console.error("Failed to fetch user transactions for UserFinancialsCard:",k),c.value=((f=(h=k.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load your financial data.",d.value=[]}finally{a.value=!1}},p=U(()=>!n.value||!n.value.id||!d.value.length||!ve.value||Object.keys(ve.value).length===0?0:d.value.filter(f=>f.type==="expense").reduce((f,k)=>f+Ie(parseFloat(k.amount||0),k.currency,u.value),0)),w=U(()=>!n.value||!n.value.id||!d.value.length||!ve.value||Object.keys(ve.value).length===0?0:d.value.filter(f=>f.type==="bonus").reduce((f,k)=>f+Ie(parseFloat(k.amount||0),k.currency,u.value),0)),_=U(()=>!n.value||!n.value.id||!d.value.length||!ve.value||Object.keys(ve.value).length===0?0:d.value.filter(f=>(f.type==="expense"||f.type==="bonus")&&f.is_paid===1).reduce((f,k)=>f+Ie(parseFloat(k.amount||0),k.currency,u.value),0)),V=U(()=>n.value&&(p.value>0||w.value>0||_.value>0)),M=U(()=>{const h=p.value+w.value;return h===0?0:Math.round(_.value/h*100)});we(()=>{m()}),de([()=>n.value,()=>s.projectId,u,ve],()=>{m()},{deep:!0});const S=()=>{o("viewUserTransactions")};return(h,f)=>(i(),r("div",Kd,[e("div",Jd,[v(W(Is),{class:"h-5 w-5 text-gray-500"}),f[0]||(f[0]=e("h4",{class:"text-sm font-semibold text-gray-900"},"Your Financials",-1))]),a.value?(i(),r("div",Xd,f[1]||(f[1]=[e("div",{class:"space-y-2 w-full"},[e("div",{class:"h-3 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-3 bg-gray-200 rounded animate-pulse w-5/6"})],-1)]))):c.value?(i(),r("div",Qd,[e("p",null,g(c.value),1)])):(i(),r("div",eu,[V.value?(i(),r("div",tu,[e("div",su,[v(W(Mt),{class:"h-5 w-5"}),e("span",lu,g(d.value.length)+" Transactions(s)",1)]),e("div",au,[f[2]||(f[2]=e("span",{class:"font-medium text-green-700"},"Agreed Amount",-1)),e("span",iu,g(W(Se)(p.value,W(u))),1)]),e("div",nu,[f[3]||(f[3]=e("span",{class:"font-medium text-blue-700"},"Bonus Amount",-1)),e("span",ou,g(W(Se)(w.value,W(u))),1)]),e("div",ru,[f[4]||(f[4]=e("span",{class:"font-medium text-indigo-700"},"Received Amount",-1)),e("span",du,g(W(Se)(_.value,W(u))),1)]),e("div",uu,[e("div",cu,[f[5]||(f[5]=e("span",null,"Paid Progress",-1)),e("span",null,g(M.value)+"%",1)]),e("div",mu,[e("div",{class:"bg-indigo-600 h-1.5 rounded-full",style:ye({width:M.value+"%"})},null,4)])])])):(i(),r("div",vu,[W(n)?(i(),r("p",hu," No financial data available for you on this project. ")):(i(),r("p",pu," Sign in to view your financials. "))])),W(n)?(i(),r("div",gu,[v(ge,{onClick:S,class:"text-xs"},{default:z(()=>f[6]||(f[6]=[q(" View Transactions ",-1)])),_:1,__:[6]})])):x("",!0)]))]))}},yu={class:"p-4"},bu={key:0,class:"text-center text-gray-600"},wu={key:1,class:"text-red-600 text-sm py-2"},_u={key:2,class:"text-gray-500 text-center py-4"},xu={key:3,class:"overflow-x-auto"},ku={class:"min-w-full divide-y divide-gray-200"},Du={class:"bg-white divide-y divide-gray-200"},Cu={class:"px-4 py-3 text-sm text-gray-900"},Tu={class:"px-4 py-3 text-sm text-gray-700"},Mu={class:"px-4 py-3 text-sm text-right text-gray-900"},Eu={class:"px-4 py-3 text-sm"},$u={class:"px-4 py-3 text-sm text-gray-700"},Su={__name:"UserTransactionsModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectName:{type:String,required:!1}},emits:["close"],setup(l,{emit:t}){const s=l,o=Le(),n=b(!0),a=b(null),c=b([]);b("PKR");const d=(m,p="USD")=>isNaN(m)||m==null?"0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:p,minimumFractionDigits:2,maximumFractionDigits:2}).format(m),u=async()=>{var m,p;if(n.value=!0,a.value=null,c.value=[],!o.value||!o.value.id||!s.projectId){a.value="User not authenticated or project ID missing.",n.value=!1;return}try{const w=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${o.value.id}`);c.value=w.data}catch(w){console.error("Failed to fetch user-specific transactions for modal:",w),a.value=((p=(m=w.response)==null?void 0:m.data)==null?void 0:p.message)||"Failed to load transactions."}finally{n.value=!1}};return de(()=>s.show,m=>{m&&u()},{immediate:!1}),de([()=>{var m;return(m=o.value)==null?void 0:m.id},()=>s.projectId],(m,p)=>{s.show&&u()},{deep:!0}),U(()=>`Your Transactions for Project ${s.projectId}`),(m,p)=>(i(),se(Ve,{show:l.show,title:"Transactions for: "+l.projectName,"show-footer":!1,onClose:p[0]||(p[0]=w=>m.$emit("close")),"hide-submit-button":!0,"hide-cancel-button":!0,"api-endpoint":null,"form-data":"{}"},{default:z(({errors:w})=>[e("div",yu,[n.value?(i(),r("div",bu,p[1]||(p[1]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"})],-1)]))):a.value?(i(),r("div",wu,[e("p",null,g(a.value),1)])):c.value.length===0?(i(),r("div",_u," No transactions found for you on this project. ")):(i(),r("div",xu,[e("table",ku,[p[2]||(p[2]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date")])],-1)),e("tbody",Du,[(i(!0),r(J,null,te(c.value,_=>(i(),r("tr",{key:_.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Cu,g(_.description),1),e("td",Tu,g(_.type),1),e("td",Mu,g(d(_.amount,_.currency)),1),e("td",Eu,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":_.is_paid===1,"bg-yellow-100 text-yellow-800":_.is_paid===0})},g(_.is_paid===1?"Paid":"Unpaid"),3)]),e("td",$u,g(new Date(_.created_at).toLocaleDateString()),1)]))),128))])])]))])]),_:1},8,["show","title"]))}},ju={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},Vu={class:"flex justify-between items-center mb-4"},Au={class:"mb-6 bg-gray-50 p-4 rounded-lg"},Ou={class:"flex items-center gap-4"},Iu={class:"flex-1 min-w-[200px]"},Lu={key:0,class:"text-red-600 text-sm mt-2"},Pu={key:1,class:"text-gray-600 text-sm mt-2 animate-pulse"},Nu={key:2,class:"text-gray-500 text-sm mt-2"},Uu={class:"mt-6"},Ru={class:"flex justify-between items-center mb-3"},Fu={class:"text-md font-medium text-gray-800"},Bu={key:0},Hu={key:1},Wu={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-8"},Yu={key:1,class:"text-center py-8"},zu={class:"text-red-600 text-sm font-medium"},qu={key:2,class:"text-center py-8"},Zu={class:"text-red-600 text-sm font-medium"},Gu={key:3,class:"space-y-8"},Ku={class:"bg-gray-50 p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Ju={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Xu={class:"text-lg font-semibold text-gray-900"},Qu={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},ec={class:"text-lg font-semibold text-gray-900"},tc={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},sc={class:"text-lg font-semibold text-gray-900"},lc={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},ac={class:"text-lg font-semibold text-gray-900"},ic={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},nc={class:"text-lg font-semibold text-gray-900"},oc={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},rc={class:"text-lg font-semibold text-gray-900"},dc={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},uc={class:"text-lg font-semibold text-gray-900"},cc={class:"bg-white p-6 rounded-lg shadow-sm"},mc={class:"overflow-x-auto max-h-60"},vc={class:"min-w-full divide-y divide-gray-200"},pc={class:"bg-white divide-y divide-gray-200"},hc={class:"px-4 py-3 text-sm text-gray-900"},gc={class:"px-4 py-3 text-sm text-gray-700"},fc={class:"px-4 py-3 text-sm text-gray-700"},yc={key:0,class:"text-gray-500 text-sm py-2"},bc={class:"bg-white p-6 rounded-lg shadow-sm"},wc={class:"overflow-x-auto max-h-60"},_c={class:"min-w-full divide-y divide-gray-200"},xc={class:"bg-white divide-y divide-gray-200"},kc={class:"px-4 py-3 text-sm text-gray-900"},Dc={class:"px-4 py-3 text-sm text-gray-700"},Cc={class:"px-4 py-3 text-sm text-gray-700"},Tc={class:"px-4 py-3 text-sm text-gray-700"},Mc={class:"px-4 py-3 text-sm text-gray-700"},Ec={key:0,class:"text-gray-500 text-sm py-2"},$c={class:"bg-white p-6 rounded-lg shadow-sm"},Sc={class:"overflow-x-auto max-h-60"},jc={class:"min-w-full divide-y divide-gray-200"},Vc={class:"bg-white divide-y divide-gray-200"},Ac={class:"px-4 py-3 text-sm text-gray-900"},Oc={class:"px-4 py-3 text-sm text-gray-700"},Ic={key:0,class:"text-gray-500 text-sm py-2"},Lc={class:"bg-white p-6 rounded-lg shadow-sm"},Pc={class:"overflow-x-auto"},Nc={class:"min-w-full divide-y divide-gray-200"},Uc={class:"bg-white divide-y divide-gray-200"},Rc={class:"px-4 py-3 text-sm text-gray-900"},Fc={class:"px-4 py-3 text-sm text-gray-700"},Bc={key:0,class:"text-gray-500 text-sm py-2"},Hc={class:"bg-white p-6 rounded-lg shadow-sm"},Wc={class:"overflow-x-auto"},Yc={class:"min-w-full divide-y divide-gray-200"},zc={class:"bg-white divide-y divide-gray-200"},qc={class:"px-4 py-3 text-sm text-gray-900"},Zc={class:"px-4 py-3 text-sm text-gray-700"},Gc={key:0,class:"text-gray-500 text-sm py-2"},Kc={class:"bg-white p-6 rounded-lg shadow-sm"},Jc={class:"overflow-x-auto max-h-60"},Xc={class:"min-w-full divide-y divide-gray-200"},Qc={class:"bg-white divide-y divide-gray-200"},em={class:"px-4 py-3 text-sm text-gray-900"},tm={class:"px-4 py-3 text-sm text-gray-700"},sm={key:0,class:"text-gray-500 text-sm py-2"},lm={class:"bg-white p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6"},am={key:0,class:"space-y-2"},im={class:"font-medium"},nm={key:1,class:"text-gray-500 text-sm py-2"},om={key:0,class:"space-y-2"},rm={class:"font-medium"},dm={key:1,class:"text-gray-500 text-sm py-2"},um={key:4,class:"text-center py-8 text-gray-500"},cm={__name:"SeoReportTab",props:{projectId:{type:[String,Number],required:!0},canCreateSeoReports:{type:Boolean,default:!1}},emits:["openCreateSeoReportModal"],setup(l,{emit:t}){const s=l,o=t,n=b([]),a=b(""),c=b(null),d=b(!0),u=b(!1),m=b(null),p=b(null),w=b(null),_=async()=>{d.value=!0,m.value=null;try{const F=await window.axios.get(`/api/projects/${s.projectId}/seo-reports/available-months`);n.value=F.data.map(B=>({value:B,label:new Date(B+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})})),n.value.length>0&&(a.value=n.value[0].value)}catch(F){console.error("Error fetching available months:",F),m.value="Failed to load available report months."}finally{d.value=!1}},V=F=>{const H=["clientName","reportingPeriod","authorityScoreValue","totalClicksValue","totalImpressionsValue","averagePositionValue","totalBacklinksValue","clicksImpressions","trafficSources","deviceUsage","countryPerformance","coreVitals","topQueries","keywordRankings","backlinks","zeroClickKeywords"].filter(I=>!(I in F));return H.length>0?`Report data is missing expected top-level keys: ${H.join(", ")}. Please ensure the JSON structure is correct.`:!F.clicksImpressions||!Array.isArray(F.clicksImpressions.labels)||!Array.isArray(F.clicksImpressions.clicks)?"clicksImpressions data is malformed.":!F.trafficSources||!Array.isArray(F.trafficSources.labels)||!Array.isArray(F.trafficSources.sessions)?"trafficSources data is malformed.":null},M=async()=>{if(!a.value){c.value=null,w.value=null;return}u.value=!0,p.value=null,w.value=null;try{const B=(await window.axios.get(`/api/projects/${s.projectId}/seo-reports/${a.value}`)).data,H=V(B);H?(w.value=H,c.value=null):c.value=B}catch(F){console.error("Error fetching SEO report:",F),p.value="Failed to load SEO report for the selected month.",c.value=null,w.value=null}finally{u.value=!1}},S=(F=null)=>{o("openCreateSeoReportModal",F)},h=U(()=>{var F;return((F=c.value)==null?void 0:F.clientName)||"N/A"}),f=U(()=>{var F;return((F=c.value)==null?void 0:F.reportingPeriod)||"N/A"}),k=U(()=>{var F;return((F=c.value)==null?void 0:F.authorityScoreValue)||"N/A"}),E=U(()=>{var F;return((F=c.value)==null?void 0:F.totalClicksValue)||"N/A"}),j=U(()=>{var F;return((F=c.value)==null?void 0:F.totalImpressionsValue)||"N/A"}),C=U(()=>{var F;return((F=c.value)==null?void 0:F.averagePositionValue)||"N/A"}),P=U(()=>{var F;return((F=c.value)==null?void 0:F.totalBacklinksValue)||"N/A"}),Y=U(()=>{var F;return((F=c.value)==null?void 0:F.clicksImpressions)||{labels:[],clicks:[],impressions:[]}}),$=U(()=>{var F;return((F=c.value)==null?void 0:F.trafficSources)||{labels:[],sessions:[],colors:[]}}),T=U(()=>{var F;return((F=c.value)==null?void 0:F.deviceUsage)||{labels:[],clicks:[],colors:[]}}),D=U(()=>{var F;return((F=c.value)==null?void 0:F.countryPerformance)||{labels:[],clicks:[]}}),O=U(()=>{var F;return((F=c.value)==null?void 0:F.coreVitals)||{mobile:{},desktop:{}}}),le=U(()=>{var F;return((F=c.value)==null?void 0:F.topQueries)||[]}),ne=U(()=>{var F;return((F=c.value)==null?void 0:F.keywordRankings)||[]});return we(()=>{_()}),de(()=>s.projectId,()=>{_()}),de(a,F=>{F?M():(c.value=null,w.value=null)}),(F,B)=>(i(),r("div",ju,[e("div",Vu,[B[4]||(B[4]=e("h4",{class:"text-lg font-semibold text-gray-900"},"SEO Reports",-1)),l.canCreateSeoReports?(i(),se(ge,{key:0,onClick:B[0]||(B[0]=H=>S()),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:z(()=>B[3]||(B[3]=[q(" Add New Report ",-1)])),_:1,__:[3]})):x("",!0)]),e("div",Au,[e("div",Ou,[e("div",Iu,[v(G,{for:"seo-report-month-filter",value:"Select Report Month"}),v(pe,{id:"seo-report-month-filter",modelValue:a.value,"onUpdate:modelValue":B[1]||(B[1]=H=>a.value=H),options:n.value,"value-key":"value","label-key":"label",placeholder:"Select a month",disabled:d.value||n.value.length===0,class:"mt-1"},null,8,["modelValue","options","disabled"])])]),m.value?(i(),r("div",Lu,g(m.value),1)):x("",!0),d.value?(i(),r("div",Pu,"Loading available months...")):x("",!0),!d.value&&n.value.length===0?(i(),r("div",Nu,"No SEO reports available for this project.")):x("",!0)]),e("div",Uu,[e("div",Ru,[e("h5",Fu,[a.value?(i(),r("span",Bu,"Report for "+g(new Date(a.value+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})),1)):(i(),r("span",Hu,"Select a month to view report"))]),l.canCreateSeoReports&&c.value&&a.value?(i(),se(ge,{key:0,onClick:B[2]||(B[2]=H=>S({report_date:a.value,data:JSON.stringify(c.value,null,2)})),class:"bg-blue-500 hover:bg-blue-600 transition-colors text-sm py-1 px-3"},{default:z(()=>B[5]||(B[5]=[q(" Edit Report ",-1)])),_:1,__:[5]})):x("",!0)]),u.value?(i(),r("div",Wu," Loading SEO report data... ")):p.value?(i(),r("div",Yu,[e("p",zu,g(p.value),1)])):w.value?(i(),r("div",qu,[e("p",Zu,"Data Structure Error: "+g(w.value),1),B[6]||(B[6]=e("p",{class:"text-gray-500 text-sm mt-2"},"Please ensure the JSON data conforms to the expected format.",-1))])):c.value?(i(),r("div",Gu,[e("div",Ku,[e("div",Ju,[B[7]||(B[7]=e("p",{class:"text-sm text-gray-500"},"Client Name",-1)),e("p",Xu,g(h.value),1)]),e("div",Qu,[B[8]||(B[8]=e("p",{class:"text-sm text-gray-500"},"Reporting Period",-1)),e("p",ec,g(f.value),1)]),e("div",tc,[B[9]||(B[9]=e("p",{class:"text-sm text-gray-500"},"Authority Score",-1)),e("p",sc,g(k.value),1)]),e("div",lc,[B[10]||(B[10]=e("p",{class:"text-sm text-gray-500"},"Total Clicks",-1)),e("p",ac,g(E.value),1)]),e("div",ic,[B[11]||(B[11]=e("p",{class:"text-sm text-gray-500"},"Total Impressions",-1)),e("p",nc,g(j.value),1)]),e("div",oc,[B[12]||(B[12]=e("p",{class:"text-sm text-gray-500"},"Average Position",-1)),e("p",rc,g(C.value),1)]),e("div",dc,[B[13]||(B[13]=e("p",{class:"text-sm text-gray-500"},"Total Backlinks",-1)),e("p",uc,g(P.value),1)])]),e("div",cc,[B[15]||(B[15]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Clicks & Impressions Trend",-1)),e("div",mc,[e("table",vc,[B[14]||(B[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions")])],-1)),e("tbody",pc,[(i(!0),r(J,null,te(Y.value.labels,(H,I)=>(i(),r("tr",{key:I},[e("td",hc,g(H),1),e("td",gc,g(Y.value.clicks[I]),1),e("td",fc,g(Y.value.impressions[I]),1)]))),128))])])]),Y.value.labels.length?x("",!0):(i(),r("p",yc,"No clicks and impressions data available."))]),e("div",bc,[B[17]||(B[17]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Top Queries",-1)),e("div",wc,[e("table",_c,[B[16]||(B[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Query"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"CTR"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Position")])],-1)),e("tbody",xc,[(i(!0),r(J,null,te(le.value,H=>(i(),r("tr",{key:H.query},[e("td",kc,g(H.query),1),e("td",Dc,g(H.clicks),1),e("td",Cc,g(H.impressions),1),e("td",Tc,g(H.ctr)+"%",1),e("td",Mc,g(H.position),1)]))),128))])])]),le.value.length?x("",!0):(i(),r("p",Ec,"No top queries data available."))]),e("div",$c,[B[19]||(B[19]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Keyword Rankings",-1)),e("div",Sc,[e("table",jc,[B[18]||(B[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Keyword"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ranking")])],-1)),e("tbody",Vc,[(i(!0),r(J,null,te(ne.value,H=>(i(),r("tr",{key:H.keyword},[e("td",Ac,g(H.keyword),1),e("td",Oc,g(H.ranking),1)]))),128))])])]),ne.value.length?x("",!0):(i(),r("p",Ic,"No keyword rankings data available."))]),e("div",Lc,[B[21]||(B[21]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Traffic Sources",-1)),e("div",Pc,[e("table",Nc,[B[20]||(B[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Source"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sessions")])],-1)),e("tbody",Uc,[(i(!0),r(J,null,te($.value.labels,(H,I)=>(i(),r("tr",{key:H},[e("td",Rc,g(H),1),e("td",Fc,g($.value.sessions[I]),1)]))),128))])])]),$.value.labels.length?x("",!0):(i(),r("p",Bc,"No traffic sources data available."))]),e("div",Hc,[B[23]||(B[23]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Device Usage",-1)),e("div",Wc,[e("table",Yc,[B[22]||(B[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Device"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",zc,[(i(!0),r(J,null,te(T.value.labels,(H,I)=>(i(),r("tr",{key:H},[e("td",qc,g(H),1),e("td",Zc,g(T.value.clicks[I]),1)]))),128))])])]),T.value.labels.length?x("",!0):(i(),r("p",Gc,"No device usage data available."))]),e("div",Kc,[B[25]||(B[25]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Country Performance (Top 10)",-1)),e("div",Jc,[e("table",Xc,[B[24]||(B[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Country"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",Qc,[(i(!0),r(J,null,te(D.value.labels,H=>(i(),r("tr",{key:H},[e("td",em,g(H),1),e("td",tm,g(D.value.clicks[D.value.labels.indexOf(H)]),1)]))),128))])])]),D.value.labels.length?x("",!0):(i(),r("p",sm,"No country performance data available."))]),e("div",lm,[e("div",null,[B[26]||(B[26]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Mobile)",-1)),O.value.mobile&&O.value.mobile.labels&&O.value.mobile.labels.length?(i(),r("div",am,[(i(!0),r(J,null,te(O.value.mobile.labels,(H,I)=>(i(),r("div",{key:H,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(H)+":",1),e("span",im,g(O.value.mobile.scores[I]),1)]))),128))])):(i(),r("p",nm,"No mobile core vitals data available."))]),e("div",null,[B[27]||(B[27]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Desktop)",-1)),O.value.desktop&&O.value.desktop.labels&&O.value.desktop.labels.length?(i(),r("div",om,[(i(!0),r(J,null,te(O.value.desktop.labels,(H,I)=>(i(),r("div",{key:H,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(H)+":",1),e("span",rm,g(O.value.desktop.scores[I]),1)]))),128))])):(i(),r("p",dm,"No desktop core vitals data available."))])])])):(i(),r("div",um," No report data to display. Please select a month from the dropdown. "))])]))}},mm=Ae(cm,[["__scopeId","data-v-37cb2f02"]]),vm={class:"space-y-4"},pm={key:0,class:"text-xs text-gray-500 mt-1 text-red-500"},hm=["onBlur"],gm={__name:"CreateSeoReportModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0},initialData:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,n=Te({report_date:"",data:""}),a=b(null);de(()=>[s.show,s.initialData],([h,f])=>{h&&(f?Object.assign(n,{report_date:f.report_date||"",data:f.data||""}):Object.assign(n,{report_date:"",data:""}))},{immediate:!0});const c=h=>{let f=h.data;try{f=JSON.stringify(JSON.parse(h.data))}catch{console.warn("Provided data is not valid JSON, sending as plain string. Backend should validate.")}return{report_date:h.report_date,data:f}},d=U(()=>s.initialData?"Edit SEO Report":"Create New SEO Report"),u=U(()=>`/api/projects/${s.projectId}/seo-reports`),m=U(()=>"post"),p=U(()=>s.initialData?"Update Report":"Create Report"),w=U(()=>s.initialData?"SEO Report updated successfully!":"SEO Report created successfully!"),_=h=>{o("saved",h),o("close")},V=()=>{o("close")},M=()=>{try{const h=JSON.parse(n.data);n.data=JSON.stringify(h,null,2)}catch(h){console.error("Invalid JSON for pretty print:",h)}},S=h=>{if(n.data)try{JSON.parse(n.data),h.data&&h.data[0]==="The data field must be a valid JSON string."&&(h.data=[])}catch{(!h.data||h.data.length===0)&&(h.data=["The data field must be a valid JSON string."])}};return(h,f)=>(i(),se(Ve,{show:l.show,title:d.value,"api-endpoint":u.value,"http-method":m.value,"form-data":n,"submit-button-text":p.value,"success-message":w.value,"format-data-for-api":c,onClose:V,onSubmitted:_},{default:z(({errors:k})=>[e("div",vm,[e("div",null,[v(G,{for:"report_date",value:"Report Month (YYYY-MM)"}),v(me,{id:"report_date",modelValue:n.report_date,"onUpdate:modelValue":f[0]||(f[0]=E=>n.report_date=E),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 2025-07",required:"",autofocus:"",pattern:"\\d{4}-\\d{2}",title:"Please enter a date in YYYY-MM format (e.g., 2025-07)",disabled:!!l.initialData},null,8,["modelValue","disabled"]),v(ae,{message:k.report_date?k.report_date[0]:"",class:"mt-2"},null,8,["message"]),f[2]||(f[2]=e("p",{class:"text-xs text-gray-500 mt-1"},"Enter the report month in YYYY-MM format (e.g., 2025-07).",-1)),l.initialData?(i(),r("p",pm,"Note: Report month cannot be changed when editing.")):x("",!0)]),e("div",null,[v(G,{for:"report_data",value:"Report Data (JSON)"}),he(e("textarea",{id:"report_data",ref_key:"jsonInputRef",ref:a,"onUpdate:modelValue":f[1]||(f[1]=E=>n.data=E),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 font-mono",rows:"10",placeholder:'Enter JSON data for the report, e.g., {"keywords_ranked": 150, "traffic": 1200, "rankings": {"keyword1": 5, "keyword2": 12}}',required:"",onBlur:E=>S(k)},null,40,hm),[[ke,n.data]]),v(ae,{message:k.data?k.data[0]:"",class:"mt-2"},null,8,["message"]),e("div",{class:"flex justify-end mt-2"},[e("button",{type:"button",onClick:M,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," Format JSON ")])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},fm={key:0,class:"bg-amber-50 border-l-4 border-amber-500 p-4 mb-6 rounded-md shadow-md"},ym={class:"flex items-center justify-between"},bm={class:"flex items-center"},wm={class:"ml-3"},_m={class:"text-sm text-amber-800 font-medium"},xm={key:0},km={key:1},Dm={key:2},Cm={__name:"ProjectTaskNotificationPrompt",props:{overdueTasks:{type:Number,required:!0},dueTodayTasks:{type:Number,required:!0}},emits:["view-tasks"],setup(l,{emit:t}){const s=l,o=t,n=U(()=>s.overdueTasks+s.dueTodayTasks),a=U(()=>n.value>0),c=()=>{o("view-tasks")};return(d,u)=>a.value?(i(),r("div",fm,[e("div",ym,[e("div",bm,[u[0]||(u[0]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-amber-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",wm,[e("p",_m,[l.overdueTasks>0&&l.dueTodayTasks>0?(i(),r("span",xm," This project has "+g(l.overdueTasks)+" overdue "+g(l.overdueTasks===1?"task":"tasks")+" and "+g(l.dueTodayTasks)+" "+g(l.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):l.overdueTasks>0?(i(),r("span",km," This project has "+g(l.overdueTasks)+" overdue "+g(l.overdueTasks===1?"task":"tasks")+" that require attention. ",1)):l.dueTodayTasks>0?(i(),r("span",Dm," This project has "+g(l.dueTodayTasks)+" "+g(l.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):x("",!0)])])]),e("div",null,[v(ge,{onClick:c,class:"px-4 py-2 text-sm bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"},{default:z(()=>u[1]||(u[1]=[q(" View ",-1)])),_:1,__:[1]})])])])):x("",!0)}},Tm={class:"space-y-4"},Mm={key:0},Em=["disabled"],$m={key:0,class:"mt-4"},Sm=["src"],jm={class:"flex items-center"},Vm="Create New Deliverable",Am="post",Om="Create Deliverable",Im="Deliverable created successfully!",Lm={__name:"CreateDeliverableModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,n=Te({title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),a=[{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],c=[{value:"pending_review",label:"Pending Review (Requires Client Approval)"},{value:"for_information",label:"For Information Only (No Approval Needed)"}],d=[{value:null,label:"Select Type (if providing URL)"},{value:"google_doc",label:"Google Document (Doc, Sheet, Slide)"},{value:"pdf",label:"PDF Document"},{value:"image",label:"Image (JPG, PNG, GIF)"},{value:"video",label:"Video (YouTube, Vimeo, etc.)"},{value:"other",label:"Other Web Link"}],u=b(null),m=b(null);de(()=>s.show,h=>{h&&(Object.assign(n,{title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),m.value=null,u.value&&(u.value.value=""))});const p=h=>{const f=h.target.files[0];if(f)if(n.attachment_file=f,n.content_url="",n.content_url_type=null,f.type.startsWith("image/")){const k=new FileReader;k.onload=E=>{m.value=E.target.result},k.readAsDataURL(f)}else m.value=null;else n.attachment_file=null,m.value=null},w=()=>{n.content_url?(n.attachment_file=null,m.value=null,u.value&&(u.value.value="")):n.content_url_type=null},_=h=>{const f=new FormData;return f.append("title",h.title),f.append("description",h.description||""),f.append("type",h.type),f.append("is_visible_to_client",h.is_visible_to_client?1:0),f.append("initial_status",h.initial_status),h.attachment_file?f.append("attachment_file",h.attachment_file):h.content_url&&(f.append("content_url",h.content_url),f.append("content_url_type",h.content_url_type||"")),f},V=U(()=>`/api/projects/${s.projectId}/deliverables`),M=h=>{o("saved",h),o("close")},S=()=>{o("close")};return(h,f)=>(i(),se(Ve,{show:l.show,title:Vm,"api-endpoint":V.value,"http-method":Am,"form-data":n,"submit-button-text":Om,"success-message":Im,"format-data-for-api":_,onClose:S,onSubmitted:M},{default:z(({errors:k})=>[e("div",Tm,[e("div",null,[v(G,{for:"title",value:"Title"}),v(me,{id:"title",modelValue:n.title,"onUpdate:modelValue":f[0]||(f[0]=E=>n.title=E),type:"text",class:"mt-1 block w-full",required:"",autofocus:""},null,8,["modelValue"]),v(ae,{message:k.title?k.title[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"description",value:"Description"}),he(e("textarea",{id:"description","onUpdate:modelValue":f[1]||(f[1]=E=>n.description=E),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter deliverable description"},null,512),[[ke,n.description]]),v(ae,{message:k.description?k.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"type",value:"Deliverable Type"}),v(pe,{id:"type",modelValue:n.type,"onUpdate:modelValue":f[2]||(f[2]=E=>n.type=E),options:a,"value-key":"value","label-key":"label",placeholder:"Select a type",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:k.type?k.type[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"initial_status",value:"Initial Status"}),v(pe,{id:"initial_status",modelValue:n.initial_status,"onUpdate:modelValue":f[3]||(f[3]=E=>n.initial_status=E),options:c,"value-key":"value","label-key":"label",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:k.initial_status?k.initial_status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[v(G,{for:"content_url",value:"Content URL (for Google Docs, external links)"}),v(me,{id:"content_url",modelValue:n.content_url,"onUpdate:modelValue":f[4]||(f[4]=E=>n.content_url=E),type:"url",class:"mt-1 block w-full",disabled:!!n.attachment_file,onInput:w,placeholder:"e.g., https://docs.google.com/document/d/..."},null,8,["modelValue","disabled"]),f[7]||(f[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Leave empty if uploading a file below.",-1)),v(ae,{message:k.content_url?k.content_url[0]:"",class:"mt-2"},null,8,["message"])]),n.content_url&&!n.attachment_file?(i(),r("div",Mm,[v(G,{for:"content_url_type",value:"Type of Content URL"}),v(pe,{id:"content_url_type",modelValue:n.content_url_type,"onUpdate:modelValue":f[5]||(f[5]=E=>n.content_url_type=E),options:d,"value-key":"value","label-key":"label",placeholder:"Select the type of content this URL links to",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),v(ae,{message:k.content_url_type?k.content_url_type[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0),e("div",null,[v(G,{for:"attachment_file",value:"Upload File (PDF, Image)"}),e("input",{id:"attachment_file",ref_key:"fileInput",ref:u,type:"file",onChange:p,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",disabled:!!n.content_url,accept:"application/pdf,image/*"},null,40,Em),f[9]||(f[9]=e("p",{class:"text-xs text-gray-500 mt-1"},"Max 10MB. Leave empty if providing a URL above.",-1)),v(ae,{message:k.attachment_file?k.attachment_file[0]:"",class:"mt-2"},null,8,["message"]),m.value?(i(),r("div",$m,[f[8]||(f[8]=e("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Image Preview:",-1)),e("img",{src:m.value,alt:"File Preview",class:"max-w-full h-auto rounded-lg shadow-md max-h-60 object-contain"},null,8,Sm)])):x("",!0)]),e("div",jm,[he(e("input",{id:"is_visible_to_client",type:"checkbox","onUpdate:modelValue":f[6]||(f[6]=E=>n.is_visible_to_client=E),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,512),[[Qe,n.is_visible_to_client]]),v(G,{for:"is_visible_to_client",value:"Visible to Client",class:"ml-2"}),v(ae,{message:k.is_visible_to_client?k.is_visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","api-endpoint","form-data"]))}},Pm={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},Nm={class:"flex justify-between items-center mb-4"},Um={class:"flex gap-2"},Rm={key:0},Fm={key:1},Bm={class:"mb-6 bg-gray-50 p-4 rounded-lg"},Hm={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},Wm={key:0,class:"mt-3 text-sm text-gray-600"},Ym={key:0,class:"text-red-600 font-medium"},zm={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},qm={key:1,class:"text-center py-4"},Zm={class:"text-red-600 text-sm font-medium"},Gm={key:2,class:"overflow-x-auto"},Km={class:"min-w-full divide-y divide-gray-200"},Jm={class:"bg-white divide-y divide-gray-200"},Xm={class:"px-4 py-3 text-sm text-gray-900"},Qm={class:"px-4 py-3 text-sm text-gray-700 capitalize"},ev={class:"px-4 py-3 text-sm text-gray-700"},tv={class:"px-4 py-3 text-sm text-gray-700"},sv={class:"px-4 py-3 text-sm text-gray-700"},lv={class:"px-4 py-3 text-sm text-gray-700"},av={class:"px-4 py-3 text-sm text-gray-700"},iv={class:"px-4 py-3 text-right"},nv={class:"flex justify-end space-x-2"},ov=["onClick"],rv={key:3,class:"text-center py-4"},dv={__name:"ProjectDeliverableTab",props:{projectId:{type:[String,Number],required:!0},canCreateDeliverables:{type:Boolean,default:!1},canViewDeliverables:{type:Boolean,default:!1}},emits:["deliverablesUpdated","openDeliverableDetailSidebar"],setup(l,{emit:t}){const s=l,o=t,n=b([]),a=b(!0),c=b(null),d=b(!1),u=b({status:"",type:"",visibility:"",clientStatus:""}),m=[{value:"",label:"All Statuses"},{value:"pending_review",label:"Pending Review"},{value:"for_information",label:"For Information"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"},{value:"completed",label:"Completed"}],p=[{value:"",label:"All Types"},{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],w=[{value:"",label:"All Visibility"},{value:"visible_to_client",label:"Visible to Client"},{value:"not_visible_to_client",label:"Not Visible to Client"}],_=[{value:"",label:"All Client Status"},{value:"read",label:"Read"},{value:"unread",label:"Unread"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"}],V=E=>{var C;if(!E.is_visible_to_client)return{status:"N/A",class:"bg-gray-100 text-gray-800"};const j=(C=E.client_interactions)==null?void 0:C[0];return j?j.approved_at?{status:"Approved",class:"bg-green-100 text-green-800"}:j.revisions_requested_at?{status:"Revisions Requested",class:"bg-yellow-100 text-yellow-800"}:j.rejected_at?{status:"Rejected",class:"bg-red-100 text-red-800"}:j.read_at?{status:`Read on ${new Date(j.read_at).toLocaleDateString()}`,class:"bg-blue-100 text-blue-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}},M=U(()=>n.value.length?n.value.filter(E=>{const j=V(E);return!(u.value.status&&E.status!==u.value.status||u.value.type&&E.type!==u.value.type||u.value.visibility&&(u.value.visibility==="visible_to_client"&&!E.is_visible_to_client||u.value.visibility==="not_visible_to_client"&&E.is_visible_to_client)||u.value.clientStatus&&(u.value.clientStatus==="read"&&!j.status.startsWith("Read")||u.value.clientStatus==="unread"&&j.status!=="Unread"||u.value.clientStatus==="approved"&&j.status!=="Approved"||u.value.clientStatus==="revisions_requested"&&j.status!=="Revisions Requested"))}):[]),S=()=>{u.value.status="",u.value.type="",u.value.visibility="",u.value.clientStatus=""},h=async()=>{if(!s.canViewDeliverables){c.value="You do not have permission to view deliverables.",a.value=!1;return}a.value=!0,c.value=null;try{const E=await window.axios.get(route("projects.deliverables.index",s.projectId));n.value=E.data}catch(E){console.error("Error fetching deliverables:",E),c.value="Failed to load deliverables."}finally{a.value=!1}},f=()=>{h(),o("deliverablesUpdated")},k=E=>{o("openDeliverableDetailSidebar",E)};return we(()=>{h()}),de(()=>s.projectId,()=>{h()}),(E,j)=>(i(),r("div",Pm,[e("div",Nm,[j[7]||(j[7]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Deliverables & Approvals",-1)),e("div",Um,[v(be,{onClick:h,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:z(()=>[a.value?(i(),r("span",Fm,"Loading...")):(i(),r("span",Rm,"Refresh"))]),_:1},8,["disabled"]),l.canCreateDeliverables?(i(),se(ge,{key:0,onClick:j[0]||(j[0]=C=>d.value=!0),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:z(()=>j[6]||(j[6]=[q(" Add New Deliverable ",-1)])),_:1,__:[6]})):x("",!0)])]),e("div",Bm,[e("div",Hm,[e("div",null,[v(G,{for:"deliverable-status-filter",value:"Status"}),v(pe,{id:"deliverable-status-filter",modelValue:u.value.status,"onUpdate:modelValue":j[1]||(j[1]=C=>u.value.status=C),options:m,placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[v(G,{for:"deliverable-type-filter",value:"Type"}),v(pe,{id:"deliverable-type-filter",modelValue:u.value.type,"onUpdate:modelValue":j[2]||(j[2]=C=>u.value.type=C),options:p,placeholder:"All Types",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[v(G,{for:"deliverable-visibility-filter",value:"Visibility"}),v(pe,{id:"deliverable-visibility-filter",modelValue:u.value.visibility,"onUpdate:modelValue":j[3]||(j[3]=C=>u.value.visibility=C),options:w,placeholder:"All Visibility",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[v(G,{for:"deliverable-client-status-filter",value:"Client Status"}),v(pe,{id:"deliverable-client-status-filter",modelValue:u.value.clientStatus,"onUpdate:modelValue":j[4]||(j[4]=C=>u.value.clientStatus=C),options:_,placeholder:"All Client Status",class:"mt-1"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end mt-4"},[e("button",{type:"button",onClick:S,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")]),Object.values(u.value).some(C=>C!==null&&C!=="")?(i(),r("div",Wm,[e("p",null,[q(" Showing "+g(M.value.length)+" of "+g(n.value.length)+" deliverables ",1),M.value.length===0?(i(),r("span",Ym," (No deliverables match the current filters) ")):x("",!0)])])):x("",!0)]),a.value?(i(),r("div",zm," Loading deliverables... ")):c.value?(i(),r("div",qm,[e("p",Zm,g(c.value),1)])):M.value.length?(i(),r("div",Gm,[e("table",Km,[j[8]||(j[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted By"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted On"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Visibility"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client Status"),q(),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Jm,[(i(!0),r(J,null,te(M.value,C=>{var P;return i(),r("tr",{key:C.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Xm,g(C.title),1),e("td",Qm,g(C.type.replace(/_/g," ")),1),e("td",ev,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":C.status==="pending_review"||C.status==="revisions_requested","bg-green-100 text-green-800":C.status==="approved","bg-blue-100 text-blue-800":C.status==="completed","bg-gray-100 text-gray-800":C.status==="for_information"})},g(C.status.replace(/_/g," ").replace(/\b\w/g,Y=>Y.toUpperCase())),3)]),e("td",tv,g(((P=C.team_member)==null?void 0:P.name)||"Unknown"),1),e("td",sv,g(new Date(C.submitted_at).toLocaleDateString()),1),e("td",lv,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":C.is_visible_to_client,"bg-red-100 text-red-800":!C.is_visible_to_client})},g(C.is_visible_to_client?"Visible":"Hidden"),3)]),e("td",av,[e("span",{class:Q(["px-2 py-1 rounded-full text-xs font-medium",V(C).class])},g(V(C).status),3)]),e("td",iv,[e("div",nv,[e("button",{onClick:Y=>k(C.id),class:"text-purple-600 hover:text-purple-800 text-sm font-medium"}," View Details ",8,ov)])])])}),128))])])])):(i(),r("div",rv,j[9]||(j[9]=[e("p",{class:"text-gray-400 text-sm"},"No deliverables found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add New Deliverable" button to create one. ',-1)]))),v(Lm,{show:d.value,"project-id":l.projectId,onClose:j[5]||(j[5]=C=>d.value=!1),onSaved:f},null,8,["show","project-id"])]))}},uv=Ae(dv,[["__scopeId","data-v-40d67f52"]]),cv={key:0,class:"bg-white rounded-xl shadow-lg border border-gray-200 h-full flex flex-col relative"},mv={key:2,class:"h-full flex flex-col"},vv={class:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200"},pv={class:"flex px-4 sm:px-6 border-b border-gray-200"},hv={class:"flex-1 overflow-y-auto p-4 sm:p-6"},gv={key:0,class:"flex justify-center py-8"},fv={key:1,class:"bg-gray-50 p-4 sm:p-6 rounded-lg text-center text-sm"},yv={class:"text-gray-600"},bv={key:2,class:"space-y-3 sm:space-y-4"},wv=["onClick"],_v={class:"flex items-center space-x-2 sm:space-x-3"},xv={class:"p-1 rounded-full text-gray-500 hover:bg-gray-200 transition-colors"},kv={class:"text-sm sm:text-base font-medium text-gray-900"},Dv={class:"flex items-center space-x-2"},Cv={key:0,class:"text-xs font-medium text-gray-600"},Tv={key:0,class:"mt-3 pl-6 sm:mt-4 sm:pl-8"},Mv={key:0,class:"text-xs sm:text-sm text-gray-600 mb-2"},Ev={class:"mt-2 flex items-center space-x-2 text-xs text-gray-500"},$v={key:0,class:"text-gray-700"},Sv={key:1,class:"text-gray-700"},jv={__name:"ProjectDeliverablesOverviewCard",props:{projectId:{type:[Number,String],required:!0},canViewProjectDeliverables:{type:Boolean,default:!0},isCollapsed:{type:Boolean,default:!1}},emits:["update:isCollapsed"],setup(l,{emit:t}){const s=l,o=t,n=b(s.isCollapsed);de(()=>s.isCollapsed,h=>{n.value=h});const a=b([]),c=b(!0),d=b("in-progress"),u=b({}),m=U(()=>d.value==="in-progress"?a.value.filter(h=>h.status!=="completed"&&h.status!=="cancelled"):a.value.filter(h=>h.status==="completed"||h.status==="cancelled")),p=async()=>{if(s.canViewProjectDeliverables){c.value=!0;try{const h=await ht.get(`/api/projects/${s.projectId}/project-deliverables`);a.value=h.data}catch(h){console.error("Error fetching deliverables:",h),et("Failed to load project deliverables.")}finally{c.value=!1}}};we(()=>{p()});const w=h=>{u.value[h]=!u.value[h]},_=h=>h?new Date(h).toLocaleDateString():"N/A",V=h=>!h||h.length===0?0:h.filter(f=>f.completed).length,M=(h,f)=>{const k=a.value.find(E=>E.id===h.id);k&&(k.details.checklist[f.index].completed=f.completed);try{const E={...h,details:{...h.details,checklist:k.details.checklist}};ht.put(`/api/project-deliverables/${h.id}`,E),kt("Checklist item updated!")}catch(E){console.error("Error updating checklist item:",E),et("Failed to update checklist item"),k&&(k.details.checklist[f.index].completed=!f.completed)}},S=()=>{n.value=!n.value,o("update:isCollapsed",n.value)};return(h,f)=>l.canViewProjectDeliverables?(i(),r("div",cv,[n.value?(i(),r("div",{key:0,onClick:S,class:"flex lg:hidden items-center p-4 cursor-pointer"},[f[2]||(f[2]=e("span",{class:"text-gray-600 font-bold text-lg flex-1"},"Project Deliverables",-1)),v(W(Vs),{class:"h-5 w-5 text-gray-500"})])):x("",!0),n.value?(i(),r("div",{key:1,onClick:S,class:"hidden lg:flex items-center justify-center cursor-pointer p-2 h-full"},f[3]||(f[3]=[e("span",{class:"text-gray-600 font-bold text-lg",style:{"writing-mode":"vertical-rl","text-orientation":"mixed"}}," Project Deliverables ",-1)]))):(i(),r("div",mv,[e("div",vv,[f[4]||(f[4]=e("h3",{class:"text-lg sm:text-xl font-bold text-gray-900"},"Project Deliverables",-1)),e("button",{onClick:S,class:"p-1 rounded-full text-gray-500 hover:bg-gray-200 transition-colors"},[v(W(As),{class:"h-5 w-5"})])]),e("div",pv,[e("button",{onClick:f[0]||(f[0]=k=>d.value="in-progress"),class:Q({"py-2 px-3 text-sm font-medium":!0,"text-indigo-600 border-b-2 border-indigo-600":d.value==="in-progress","text-gray-500 hover:text-gray-700":d.value!=="in-progress"})}," In Progress ",2),e("button",{onClick:f[1]||(f[1]=k=>d.value="completed"),class:Q({"py-2 px-3 text-sm font-medium":!0,"text-indigo-600 border-b-2 border-indigo-600":d.value==="completed","text-gray-500 hover:text-gray-700":d.value!=="completed"})}," Completed ",2)]),e("div",hv,[c.value?(i(),r("div",gv,f[5]||(f[5]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)]))):m.value.length===0?(i(),r("div",fv,[e("p",yv,"No "+g(d.value)+" deliverables found.",1)])):(i(),r("div",bv,[(i(!0),r(J,null,te(m.value,k=>{var E,j,C;return i(),r("div",{key:k.id,class:"bg-gray-50 border border-gray-200 rounded-lg p-3 sm:p-4 shadow-sm hover:shadow-md transition-all duration-300"},[e("div",{class:"flex items-center justify-between cursor-pointer",onClick:P=>w(k.id)},[e("div",_v,[e("button",xv,[u.value[k.id]?(i(),se(W(Os),{key:1,class:"h-4 w-4 sm:h-5 sm:w-5"})):(i(),se(W(Ss),{key:0,class:"h-4 w-4 sm:h-5 sm:w-5"}))]),e("div",null,[e("h4",kv,g(k.name),1)])]),e("div",Dv,[((j=(E=k.details)==null?void 0:E.checklist)==null?void 0:j.length)>0?(i(),r("span",Cv,g(V(k.details.checklist))+" / "+g(k.details.checklist.length),1)):x("",!0),e("span",{class:Q({"font-medium py-0.5 px-2 rounded-full text-white text-xs":!0,"bg-yellow-500":k.status==="pending","bg-blue-500":k.status==="in_progress","bg-green-500":k.status==="completed","bg-red-500":k.status==="cancelled"})},g(k.status.replace("_"," ").toUpperCase()),3)])],8,wv),u.value[k.id]?(i(),r("div",Tv,[k.description?(i(),r("p",Mv,g(k.description),1)):x("",!0),e("div",Ev,[k.milestone?(i(),r("span",$v,[f[6]||(f[6]=e("span",{class:"font-semibold"},"Milestone:",-1)),q(" "+g(k.milestone.name),1)])):x("",!0),k.due_date?(i(),r("span",Sv,[f[7]||(f[7]=e("span",{class:"font-semibold"},"Due:",-1)),q(" "+g(_(k.due_date)),1)])):x("",!0)]),(C=k.details)!=null&&C.checklist&&k.details.checklist.length>0?(i(),se(ts,{key:1,items:k.details.checklist,"api-endpoint":`/api/project-deliverables/${k.id}`,title:null,"payload-transformer":P=>({details:{...k.details,checklist:P}}),onItemToggled:P=>M(k,P),density:"tight","container-class":"p-0 border-0 bg-transparent text-sm","title-class":"hidden"},null,8,["items","api-endpoint","payload-transformer","onItemToggled"])):x("",!0)])):x("",!0)])}),128))]))])]))])):x("",!0)}},Vv={class:"py-8 max-w-full mx-auto px-4 sm:px-6 lg:px-8"},Av={key:0,class:"flex items-center justify-center min-h-[50vh]"},Ov={key:1,class:"text-center text-red-600 text-lg font-medium"},Iv={key:2,class:"space-y-8"},Lv={class:"flex flex-col lg:flex-row gap-6"},Pv={class:"flex-1 space-y-6"},Nv={class:"flex justify-end items-center"},Uv={class:"flex h-full w-full"},Rv={key:1,class:"transition-all duration-300 w-full relative"},Fv={class:"grid grid-cols-3 gap-4"},Bv={key:0},Hv={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Wv={class:"flex justify-between items-center mb-4"},Yv={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},zv={class:"flex justify-between items-center mb-4"},qv={key:2,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Zv={class:"flex justify-between items-center mb-4"},Gv={key:0,class:"text-gray-400 text-sm"},Kv={key:1,class:"overflow-x-auto"},Jv={class:"min-w-full divide-y divide-gray-200"},Xv={class:"bg-white divide-y divide-gray-200"},Qv={class:"px-4 py-3 text-sm text-gray-900"},e0={class:"px-4 py-3 text-sm text-gray-700"},t0={class:"px-4 py-3 text-sm text-gray-700"},s0={class:"px-4 py-3 text-sm text-gray-700"},l0={class:"px-4 py-3 text-sm text-gray-700"},a0={class:"px-4 py-3 text-right"},i0={key:3,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},n0={class:"flex justify-between items-center mb-4"},o0={class:"flex items-center gap-4"},r0={key:0},d0={key:0,class:"space-y-4"},u0={class:"flex justify-between"},c0={class:"flex-grow"},m0={key:0,class:"text-xs text-red-400 block mt-1"},v0={class:"flex items-center mt-1"},p0={class:"text-xs text-gray-500"},h0={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},g0={key:0},f0={key:1,class:"text-gray-400 text-sm"},y0={__name:"Show",setup(l){const t=Le(),s=us().props.id,o=b({clients:[],users:[],notes:[],transactions:[],documents:[],meetings:[],tasks:[],emails:[],deliverables:[]}),n=b(!1),a=b(!1),c=b(25),d=b(!1),u=b(!0),m=b(""),p=b(!1),w=b(!1),_=b(!1),V=b(!1),M=b(!1),S=b(!1),h=b(!1),f=b(!1),k=b(!1),E=b(null),j=[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"on_hold",label:"On Hold"},{value:"archived",label:"Archived"}],C=b(null),P=b(null),Y=cs(o),{canDo:$,canView:T}=xt(s),D=U(()=>{var X,R;return((R=(X=t.value)==null?void 0:X.role_data)==null?void 0:R.slug)==="super-admin"}),O=U(()=>$("manage_projects").value||D.value),le=U(()=>$("edit_projects").value||D.value),ne=U(()=>T("emails").value),F=U(()=>$("compose_emails").value),B=U(()=>$("approve_emails").value),H=U(()=>T("project_notes").value),I=U(()=>$("add_project_notes").value),K=U(()=>T("deliverables").value),oe=U(()=>$("create_deliverables").value),De=U(()=>T("seo_reports").value),N=U(()=>$("create_seo_reports").value),y=U(()=>T("client_contacts").value);U(()=>T("users").value);const A=U(()=>T("project_financial",Y).value),L=U(()=>T("project_transactions").value);U(()=>T("client_financial").value);const fe=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],Me=b([]),jt=b(null),We=b(null),Ge=b("all"),st=async()=>{try{Me.value=await as(s)}catch(X){console.error("Error fetching due and overdue tasks:",X)}},Vt=()=>{P.value="tasks",Ge.value="due-overdue",setTimeout(()=>{We.value&&We.value.scrollIntoView&&We.value.scrollIntoView({behavior:"smooth"})},100)},At=async()=>{await st()},lt=U(()=>o.value.notes?[...o.value.notes].filter(X=>X.type!=="standup").sort((X,R)=>new Date(R.created_at)-new Date(X.created_at)).slice(0,3):[]),at=b([]),it=async()=>{try{const X=await window.axios.get(`/api/projects/${s}/emails-simplified`,{params:{limit:5}});at.value=X.data}catch(X){console.error("Error fetching latest emails:",X)}},Ee=async()=>{u.value=!0,m.value="";try{const X=await window.axios.get(`/api/projects/${s}`);o.value=X.data,console.log("Full project data received (Show.vue main fetch):",o.value),n.value=o.value.deliverables&&o.value.deliverables.length>0,a.value=!n.value,await st(),ne.value&&await it()}catch(X){m.value="Failed to load project data.",console.error("Error fetching project data:",X),X.response&&(X.response.status===401||X.response.status===403)&&(m.value="You are not authorized to view this project or your session expired. Please log in.")}finally{u.value=!1}},Ot=X=>{o.value=X,p.value=!1,Ee()},It=X=>{o.value.tasks=X},Lt=X=>{o.value.emails=X,ne.value&&it()},nt=X=>{o.value.notes=X},Pt=()=>{Ee()},Nt=()=>{C.value&&C.value.fetchMeetings()},ot=()=>{Ee()},Ut=X=>{P.value=X,fs()},Rt=()=>{S.value=!0},Ft=()=>{h.value=!0,P.value="emails"},Bt=async()=>{h.value=!1,await Ee()},Ht=()=>{h.value=!1},rt=()=>{a.value=!a.value},Wt=X=>{d.value=!0,document.addEventListener("mousemove",dt),document.addEventListener("mouseup",ut),X.preventDefault()},dt=X=>{if(!d.value)return;const R=document.documentElement.clientWidth,Ne=Math.min(Math.max(10,(1-X.clientX/R)*100),50);c.value=Ne},ut=()=>{d.value=!1,document.removeEventListener("mousemove",dt),document.removeEventListener("mouseup",ut),localStorage.setItem(`project_${s}_deliverables_width`,c.value)},ct=(X,R)=>{gs(X,R||s,o.value.users)};de(ms,(X,R)=>{R.taskId&&!X.taskId&&Ee()},{deep:!0});const Yt=()=>{f.value=!0},zt=()=>{f.value=!1,Ee()},qt=(X=null)=>{E.value=X,k.value=!0},Zt=()=>{k.value=!1};return we(async()=>{console.log("Show.vue mounted, fetching initial data...");try{await vs(s),console.log("Project permissions fetched (includes global)")}catch(R){console.error(`Error fetching permissions for project ${s}:`,R)}const X=localStorage.getItem(`project_${s}_deliverables_width`);X!==null&&(c.value=parseFloat(X)),await $s(),await Ee()}),(X,R)=>(i(),r(J,null,[v(W(ps),{title:o.value.name||"Project Details"},null,8,["title"]),v(ls,null,{default:z(()=>{var Ne;return[e("div",Vv,[u.value?(i(),r("div",Av,R[24]||(R[24]=[e("div",{class:"flex flex-col items-center space-y-4"},[e("svg",{class:"animate-spin h-16 w-16 text-indigo-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("p",{class:"text-lg text-gray-600 font-medium"},"Loading project details...")],-1)]))):m.value?(i(),r("div",Ov,g(m.value),1)):(i(),r("div",Iv,[e("div",Lv,[e("div",Pv,[v(An,{project:o.value,"project-id":W(s),"can-manage-projects":O.value,"is-super-admin":D.value,"can-edit-projects":le.value,onOpenEditModal:R[0]||(R[0]=Z=>p.value=!0),onOpenStandupModal:R[1]||(R[1]=Z=>_.value=!0),onOpenMeetingModal:R[2]||(R[2]=Z=>w.value=!0),onOpenMagicLinkModal:R[3]||(R[3]=Z=>M.value=!0),onResourceSaved:Ee,onOpenComposeModal:Ft},null,8,["project","project-id","can-manage-projects","is-super-admin","can-edit-projects"]),v(Hn,{tasks:o.value.tasks||[],emails:o.value.emails||[]},null,8,["tasks","emails"]),e("div",Nv,[v(pe,{id:"display-currency-switcher",modelValue:W(He),"onUpdate:modelValue":R[4]||(R[4]=Z=>hs(He)?He.value=Z:null),options:fe,"value-key":"value","label-key":"label",class:"w-20",containerClasses:"max-w-[150px]"},null,8,["modelValue"])]),A.value&&L.value?(i(),se(cd,{key:0,"project-id":W(s),"can-view-project-services-and-payments":A.value,"can-view-project-transactions":L.value},null,8,["project-id","can-view-project-services-and-payments","can-view-project-transactions"])):x("",!0)]),K.value?(i(),r("div",{key:0,class:Q(["relative transition-all duration-300",{"w-full lg:flex-none":!a.value,"w-16":a.value}]),style:ye(a.value?"":`width: ${c.value}%`)},[e("div",Uv,[a.value?(i(),r("div",{key:0,class:"w-16 h-full flex items-center justify-center bg-white rounded-xl shadow-lg border border-gray-200 cursor-pointer transition-all duration-300 transform hover:scale-105",onClick:rt},R[25]||(R[25]=[e("span",{class:"font-bold text-gray-500 text-sm",style:{"writing-mode":"vertical-rl","text-orientation":"sideways"}},"Project Deliverables",-1)]))):(i(),r("div",Rv,[e("div",{class:Q(["absolute left-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-indigo-500 hover:w-1.5 z-10 transition-all",{"bg-indigo-500 w-1.5":d.value,"bg-gray-300":!d.value}]),onMousedown:Wt,title:"Drag to adjust width"},null,34),v(jv,{"project-id":W(s),"can-view-project-deliverables":K.value,"is-collapsed":a.value,"onUpdate:isCollapsed":rt},null,8,["project-id","can-view-project-deliverables","is-collapsed"])]))])],6)):x("",!0)]),e("div",Fv,[y.value?(i(),se(Ad,{key:0,"project-id":W(s),"can-view-client-contacts":y.value},null,8,["project-id","can-view-client-contacts"])):x("",!0),v(Gd,{"project-id":W(s),"can-view-users":!0},null,8,["project-id"]),v(fu,{"project-id":W(s),onViewUserTransactions:Rt},null,8,["project-id"])]),v(zn,{ref_key:"navigationRef",ref:We,selectedTab:P.value,"onUpdate:selectedTab":R[5]||(R[5]=Z=>P.value=Z),"can-view-emails":ne.value,"can-view-notes":H.value,"can-view-deliverables":K.value,"can-view-seo-reports":De.value},null,8,["selectedTab","can-view-emails","can-view-notes","can-view-deliverables","can-view-seo-reports"]),P.value===null?(i(),r("div",Bv,[v(Cm,{"overdue-tasks":Me.value.filter(Z=>new Date(Z.due_date)<new Date).length,"due-today-tasks":Me.value.filter(Z=>new Date(Z.due_date).toDateString()===new Date().toDateString()).length,onViewTasks:Vt},null,8,["overdue-tasks","due-today-tasks"]),Me.value.length>0?(i(),r("div",Hv,[e("div",Wv,[R[26]||(R[26]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:R[6]||(R[6]=Z=>P.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks â ")]),v(Ct,{tasks:Me.value,"project-id":W(s),"show-project-column":!1,onTaskUpdated:At,onOpenTaskDetail:ct},null,8,["tasks","project-id"])])):(i(),r("div",Yv,[e("div",zv,[R[27]||(R[27]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:R[7]||(R[7]=Z=>P.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks â ")]),R[28]||(R[28]=e("p",{class:"text-gray-400 text-sm"},"No due or overdue tasks.",-1))])),ne.value?(i(),r("div",qv,[e("div",Zv,[R[29]||(R[29]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Emails",-1)),e("button",{onClick:R[8]||(R[8]=Z=>P.value="emails"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Emails â ")]),(Ne=o.value.emails)!=null&&Ne.length?(i(),r("div",Kv,[e("table",Jv,[R[31]||(R[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Xv,[(i(!0),r(J,null,te(at.value,Z=>{var Ue;return i(),r("tr",{key:Z.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Qv,g(Z.subject),1),e("td",e0,g(((Ue=Z.sender)==null?void 0:Ue.name)||"N/A"),1),e("td",t0,g(new Date(Z.created_at).toLocaleDateString()),1),e("td",s0,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":Z.type==="sent","bg-purple-100 text-purple-800":Z.type==="received"})},g(Z.type?Z.type.toUpperCase():"N/A"),3)]),e("td",l0,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":Z.status==="sent","bg-yellow-100 text-yellow-800":Z.status==="pending_approval","bg-blue-200 text-blue-900":Z.status==="pending_approval_received","bg-red-100 text-red-800":Z.status==="rejected","bg-gray-100 text-gray-800":Z.status==="draft"})},g(Z.status.replace("_"," ").toUpperCase()),3)]),e("td",a0,[v(be,{class:"text-indigo-600 hover:text-indigo-800",onClick:Gt=>X.viewEmail(Z)},{default:z(()=>R[30]||(R[30]=[q(" View ",-1)])),_:2,__:[30]},1032,["onClick"])])])}),128))])])])):(i(),r("div",Gv,"No email communication found."))])):x("",!0),H.value?(i(),r("div",i0,[e("div",n0,[R[33]||(R[33]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Notes",-1)),e("div",o0,[e("button",{onClick:R[9]||(R[9]=Z=>P.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Notes â "),I.value?(i(),r("div",r0,[v(ge,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:R[10]||(R[10]=Z=>V.value=!0)},{default:z(()=>R[32]||(R[32]=[q(" Add Note ",-1)])),_:1,__:[32]})])):x("",!0)])]),lt.value.length?(i(),r("div",d0,[(i(!0),r(J,null,te(lt.value,Z=>{var Ue;return i(),r("div",{key:Z.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",u0,[e("div",c0,[e("p",{class:Q(["text-sm",{"text-gray-700":Z.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":Z.content==="[Encrypted content could not be decrypted]"}])},[q(g(Z.content)+" ",1),Z.content==="[Encrypted content could not be decrypted]"?(i(),r("span",m0," (There was an issue decrypting this note. Please contact an administrator.) ")):x("",!0)],2),e("div",v0,[e("p",p0,"Added by "+g(((Ue=Z.user)==null?void 0:Ue.name)||"Unknown")+" on "+g(new Date(Z.created_at).toLocaleDateString()),1),Z.reply_count>0?(i(),r("span",h0,g(Z.reply_count)+" "+g(Z.reply_count===1?"reply":"replies"),1)):x("",!0)])]),H.value&&Z.chat_message_id&&o.value.google_chat_id?(i(),r("div",g0,[e("button",{onClick:R[11]||(R[11]=Gt=>P.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View ")])):x("",!0)])])}),128))])):(i(),r("p",f0,"No notes available."))])):x("",!0)])):x("",!0),P.value==="tasks"?(i(),se(Lo,{key:1,ref_key:"tasksTabRef",ref:jt,"project-id":W(s),"project-users":o.value.users||[],"can-manage-projects":O.value,"tasks-filter":Ge.value,onTasksUpdated:It,onOpenTaskDetailSidebar:ct,onOpenCreateTaskModal:Yt,onFilterChanged:R[12]||(R[12]=Z=>Ge.value=Z)},null,8,["project-id","project-users","can-manage-projects","tasks-filter"])):x("",!0),P.value==="emails"?(i(),se(hr,{key:2,"project-id":W(s),"can-view-emails":ne.value,"can-compose-emails":F.value,"can-approve-emails":B.value,"user-project-role":W(Y),"open-compose":h.value,onEmailsUpdated:Lt,onResetOpenCompose:R[13]||(R[13]=Z=>h.value=!1)},null,8,["project-id","can-view-emails","can-compose-emails","can-approve-emails","user-project-role","open-compose"])):x("",!0),P.value==="standups"?(i(),se(ti,{key:3,projectId:W(s),users:o.value.users||[],onStandupAdded:ot},null,8,["projectId","users"])):x("",!0),P.value==="notes"?(i(),se(Kr,{key:4,"project-id":W(s),"google-chat-id":o.value.google_chat_id,"can-view-notes":H.value,"can-add-notes":I.value,onNotesUpdated:nt,onChangeTab:Ut},null,8,["project-id","google-chat-id","can-view-notes","can-add-notes"])):x("",!0),P.value==="deliverables"?(i(),se(uv,{key:5,"project-id":W(s),"can-create-deliverables":oe.value,"can-view-deliverables":K.value,onDeliverablesUpdated:Pt,onOpenDeliverableDetailSidebar:X.handleOpenDeliverableDetailSidebar},null,8,["project-id","can-create-deliverables","can-view-deliverables","onOpenDeliverableDetailSidebar"])):x("",!0),P.value==="seo-reports"?(i(),se(mm,{key:6,"project-id":W(s),"can-create-seo-reports":N.value,onOpenCreateSeoReportModal:qt},null,8,["project-id","can-create-seo-reports"])):x("",!0)]))]),v(je,{show:p.value,onClose:R[15]||(R[15]=Z=>p.value=!1)},{default:z(()=>[v(ys,{show:p.value,project:o.value,statusOptions:j,clientRoleOptions:[],userRoleOptions:[],paymentTypeOptions:[],onClose:R[14]||(R[14]=Z=>p.value=!1),onSubmit:Ot},null,8,["show","project"])]),_:1},8,["show"]),v(ki,{show:w.value,"project-name":o.value.name,onClose:R[16]||(R[16]=Z=>w.value=!1),onSaved:Nt,projectId:W(s),projectUsers:o.value.users||[]},null,8,["show","project-name","projectId","projectUsers"]),v(Dt,{show:_.value,onClose:R[17]||(R[17]=Z=>_.value=!1),onStandupAdded:ot,projectId:W(s)},null,8,["show","projectId"]),v(Tt,{show:V.value,"project-id":W(s),onClose:R[18]||(R[18]=Z=>V.value=!1),onNoteAdded:nt},null,8,["show","project-id"]),v(Si,{show:M.value,"project-id":W(s),"project-clients":o.value.clients||[],onClose:R[19]||(R[19]=Z=>M.value=!1)},null,8,["show","project-id","project-clients"]),v(Su,{show:S.value,"project-id":W(s),"project-name":o.value.name,onClose:R[20]||(R[20]=Z=>S.value=!1)},null,8,["show","project-id","project-name"]),v(St,{show:h.value,"project-id":W(s),"user-project-role":W(Y),onClose:Ht,onSubmitted:Bt,onError:R[21]||(R[21]=Z=>console.error("Error composing email:",Z))},null,8,["show","project-id","user-project-role"]),v(ss,{show:f.value,"project-id":W(s),onClose:R[22]||(R[22]=Z=>f.value=!1),onSaved:zt},null,8,["show","project-id"]),v(gm,{"project-id":W(s),show:k.value,"initial-data":E.value,onClose:R[23]||(R[23]=Z=>k.value=!1),onSaved:Zt},null,8,["project-id","show","initial-data"])]}),_:1})],64))}},B0=Ae(y0,[["__scopeId","data-v-61b3e75f"]]);export{B0 as default};
