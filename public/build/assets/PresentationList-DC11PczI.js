import{r as n,f as le,J as w,c as se,g as f,o as a,w as ne,b as t,i as g,a as d,m as ae,v as T,x as L,F as ie,l as re,t as y,s as ue,K as de,y as N,N as z,M as ce,I as ve}from"./app-DbT8OS6U.js";import{_ as fe}from"./AuthenticatedLayout-CvJcdJCK.js";import me from"./PresentationForm-J3tM-UN0.js";import pe from"./CreationChoiceModal-eRHJRmBr.js";import xe from"./TemplateBrowser-DNARxeFD.js";import be from"./SlideSummaryModal-DpVYSMJd.js";import he from"./CollaborateModal-BYpQVtAg.js";import{a as $}from"./presentationsApi-BQT_I4GM.js";import"./PrimaryButton-CNNIkbnD.js";import"./Modal-xyQrtzGU.js";import"./InputLabel-5o6j5_z2.js";import"./InputError-BhMxgrrh.js";import"./SecondaryButton-Dwoi8T9i.js";import"./index-DwcGlpZZ.js";import"./BaseFormModal-EMcFl8Zi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-VBinc-HC.js";import"./SelectDropdown-CHW2wT9H.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-Caz4HoWe.js";import"./createLucideIcon-CcTmroC8.js";import"./plus-Cqbd8Y22.js";import"./DangerButton-Dz0HnA5Q.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-ukaQCEyF.js";import"./save-Dz7hmyY3.js";import"./Modal-Cb3N0KI3.js";import"./BaseModal-C_ZIg0yV.js";import"./MultiSelectDropdown-Dh7Ohblw.js";import"./ChevronDownIcon-SjFHoykx.js";const we={class:"bg-slate-50 min-h-screen"},ge={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},ye={class:"flex flex-col md:flex-row items-start md:items-center justify-between pb-8 border-b border-slate-200 mb-8"},_e={class:"mb-6"},Ce={class:"relative"},ke={key:0,class:"text-center py-16"},$e={key:1,class:"text-center py-16 border-2 border-dashed border-slate-200 rounded-xl"},Me={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Se={class:"p-5 flex-grow"},De={class:"flex items-start justify-between"},Te={class:"inline-block px-2.5 py-1 text-xs font-semibold rounded-full mb-3 bg-blue-100 text-blue-600"},ze={class:"flex items-center gap-2"},Be=["onClick"],je={class:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-[10px] font-bold leading-none text-white bg-indigo-600 rounded-full","aria-label":"Collaborators count"},Ae=["onMouseenter","onMouseleave"],Ie=["onMouseenter","onMouseleave"],Pe=["onClick"],Le=["onClick"],Ne=["onClick"],Fe=["onClick"],Re={key:0,class:"mt-1 flex items-center gap-2"},Ve=["aria-label","onKeyup","disabled"],He=["onClick","disabled"],Ke={key:1},Ue=["title"],Ee={class:"text-sm text-slate-500 mt-1"},qe={class:"px-5 py-4 border-t border-slate-100 flex items-center justify-between"},Ge={class:"text-xs text-slate-400"},Je=["onClick"],Mt={__name:"PresentationList",setup(Oe){const i=n([]),M=n(!1),c=n(!1),m=n(!1),_=n(!1),p=n(!1),x=n(!1),B=n(null),S=n(null),b=n(null),h=n([]),D=n(""),u=n(null),C=n(null),v=n(""),k=n(!1);le(F);async function F(){M.value=!0;try{const e=await $.list();i.value=Array.isArray(e)?e:(e==null?void 0:e.data)??[]}catch{w("Failed to load presentations")}finally{M.value=!1}}const j=se(()=>{const e=D.value.toLowerCase();return(Array.isArray(i.value)?i.value:[]).filter(l=>{var r;return(l.title||"").toLowerCase().includes(e)||(l.presentable_name||((r=l.presentable)==null?void 0:r.name)||"").toLowerCase().includes(e)})});function R(e){if(!e)return"-";try{return new Date(e).toLocaleDateString()}catch{return e}}function V(e){ve.visit(`/presentations/${e}/edit`)}function H(){m.value=!0}function K(){m.value=!1,b.value=null,h.value=[],c.value=!0}function U(){m.value=!1,_.value=!0}function E(e){_.value=!1,b.value=(e==null?void 0:e.id)||null,h.value=[],c.value=!0}async function q(e){try{const o=await $.get(e.id);S.value=o,x.value=!0}catch{w("Failed to load collaborators")}}function G(e){B.value=e,p.value=!0}function J(e){u.value=e}function O(e){u.value=e}function Q(e){setTimeout(()=>{!u.value===e&&(u.value=null)},500)}function W(e){u.value=null}async function X(e){const o=`${window.location.origin}/view/${e.share_token||""}`;await navigator.clipboard.writeText(o),z("Share link copied to clipboard")}async function Y(e){if(await ce("Delete this presentation?",{confirmText:"Delete",cancelText:"Cancel",type:"warning"}))try{await $.destroy(e),i.value=i.value.filter(l=>l.id!==e),z("Presentation deleted")}catch{w("Failed to delete presentation")}}function Z(e){C.value=e.id,v.value=e.title||"",u.value=null}function A(){C.value=null,v.value=""}async function I(e){if(!(e!=null&&e.id))return;const o=(v.value||"").trim();if(!o){w("Title cannot be empty");return}k.value=!0;try{const l=await $.update(e.id,{title:o}),r=i.value.findIndex(s=>s.id===e.id);r!==-1&&(i.value[r].title=(l==null?void 0:l.title)??o),z("Presentation renamed"),C.value=null,v.value=""}catch{w("Failed to rename presentation")}finally{k.value=!1}}function P(e){c.value=!1,b.value=null,h.value=[],e&&i.value.unshift(e)}function ee(e){p.value=!1,e&&e._fromSelection?(b.value=null,h.value=e.source_slide_ids||[],c.value=!0):e&&e.id&&i.value.unshift(e)}function te(){p.value=!1}function oe(e){var o;try{const l=(o=S.value)==null?void 0:o.id,r=i.value.findIndex(s=>s.id===l);if(r!==-1){const s=Array.isArray(e)?e.length:0;i.value[r].users_count=s}}catch{}x.value=!1}return(e,o)=>(a(),f(fe,null,{default:ne(()=>[t("div",we,[t("main",ge,[t("div",ye,[o[9]||(o[9]=t("div",null,[t("h1",{class:"text-3xl font-bold text-slate-800"},"Presentations"),t("p",{class:"mt-1 text-slate-500"},"Create, manage, and share your client presentations.")],-1)),t("button",{onClick:o[0]||(o[0]=l=>H()),class:"mt-4 md:mt-0 inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold shadow hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-600","aria-label":"Create new presentation"},o[8]||(o[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[t("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"})],-1),ae(" New Presentation ",-1)]))]),t("div",_e,[t("div",Ce,[o[10]||(o[10]=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"},[t("path",{"fill-rule":"evenodd",d:"M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z","clip-rule":"evenodd"})],-1)),T(t("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>D.value=l),placeholder:"Search by title or client/lead...",class:"w-full border border-slate-300 rounded-lg py-2 pl-10 pr-4 focus:ring-2 focus:ring-blue-600 focus:border-blue-600 transition-shadow","aria-label":"Search presentations"},null,512),[[L,D.value]])])]),M.value?(a(),d("div",ke,o[11]||(o[11]=[t("div",{class:"flex items-center justify-center gap-3 text-slate-500"},[t("span",{class:"inline-block h-6 w-6 border-2 border-slate-300 border-t-blue-600 rounded-full animate-spin","aria-hidden":"true"}),t("span",null,"Loading Presentations...")],-1)]))):j.value.length?(a(),d("div",Me,[(a(!0),d(ie,null,re(j.value,l=>{var r;return a(),d("div",{key:l.id,class:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col transition-all hover:shadow-md hover:-translate-y-1"},[t("div",Se,[t("div",De,[t("span",Te,y(l.type),1),t("div",ze,[t("button",{onClick:ue(s=>q(l),["stop"]),class:"relative h-8 w-8 rounded-full flex items-center justify-center text-slate-500 hover:bg-slate-100 hover:text-slate-700",title:"Collaborators"},[o[13]||(o[13]=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-5 h-5"},[t("path",{d:"M12 12a4 4 0 100-8 4 4 0 000 8z"}),t("path",{"fill-rule":"evenodd",d:"M2 20a8 8 0 1116 0v1H2v-1z","clip-rule":"evenodd"})],-1)),t("span",je,y(l.users_count??0),1)],8,Be),t("div",{class:"relative group",onMouseenter:s=>J(l.id),onMouseleave:s=>Q(l.id)},[o[15]||(o[15]=t("button",{class:"h-8 w-8 rounded-full flex items-center justify-center text-slate-400 hover:bg-slate-100 hover:text-slate-600"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"w-5 h-5"},[t("path",{d:"M10 3a1.5 1.5 0 110 3 1.5 1.5 0 010-3zM10 8.5a1.5 1.5 0 110 3 1.5 1.5 0 010-3zM11.5 15.5a1.5 1.5 0 10-3 0 1.5 1.5 0 003 0z"})])],-1)),T(t("div",{class:"absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border border-slate-200 py-1 z-10 transition-opacity duration-200",onMouseenter:s=>O(l.id),onMouseleave:s=>W(l.id)},[t("a",{onClick:s=>G(l.id),class:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 cursor-pointer"},"Duplicate...",8,Pe),t("a",{onClick:s=>X(l),class:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 cursor-pointer"},"Share",8,Le),t("a",{onClick:s=>Z(l),class:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100 cursor-pointer"},"Rename",8,Ne),o[14]||(o[14]=t("div",{class:"my-1 h-px bg-slate-100"},null,-1)),t("a",{onClick:s=>Y(l.id),class:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 cursor-pointer"},"Delete",8,Fe)],40,Ie),[[de,u.value===l.id]])],40,Ae)])]),C.value===l.id?(a(),d("div",Re,[T(t("input",{"onUpdate:modelValue":o[2]||(o[2]=s=>v.value=s),placeholder:"New title",class:"flex-1 border border-slate-300 rounded-lg p-1.5 text-sm focus:ring-2 focus:ring-blue-600 focus:border-blue-600","aria-label":`Rename ${l.title}`,onKeyup:[N(s=>I(l),["enter"]),N(A,["esc"])],disabled:k.value},null,40,Ve),[[L,v.value]]),t("button",{onClick:s=>I(l),class:"px-2 py-1 bg-blue-600 text-white rounded-md text-xs font-semibold hover:bg-blue-700 disabled:opacity-50",disabled:k.value,"aria-label":"Save new title"},"Save",8,He),t("button",{onClick:A,class:"px-2 py-1 bg-slate-100 text-slate-700 rounded-md text-xs font-semibold hover:bg-slate-200","aria-label":"Cancel rename"},"Cancel")])):(a(),d("div",Ke,[t("h2",{class:"text-lg font-bold text-slate-800 truncate",title:l.title},y(l.title),9,Ue),t("p",Ee,y(l.presentable_name||((r=l.presentable)==null?void 0:r.name)||"-"),1)]))]),t("div",qe,[t("span",Ge,"Created: "+y(R(l.created_at)),1),t("button",{onClick:s=>V(l.id),class:"px-3 py-1.5 bg-slate-100 text-slate-700 rounded-md text-xs font-semibold hover:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-600"},"Edit",8,Je)])])}),128))])):(a(),d("div",$e,o[12]||(o[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"mx-auto h-12 w-12 text-slate-400"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})],-1),t("h3",{class:"mt-2 text-sm font-semibold text-slate-800"},"No presentations found",-1),t("p",{class:"mt-1 text-sm text-slate-500"},"Get started by creating a new presentation.",-1)])))]),m.value?(a(),f(pe,{key:0,onClose:o[3]||(o[3]=l=>m.value=!1),onScratch:K,onChooseTemplate:U,onCreated:P})):g("",!0),_.value?(a(),f(xe,{key:1,onClose:o[4]||(o[4]=l=>_.value=!1),onSelected:E})):g("",!0),c.value?(a(),f(me,{key:2,"template-id":b.value,"source-slide-ids":h.value,onClose:o[5]||(o[5]=l=>c.value=!1),onCreated:P},null,8,["template-id","source-slide-ids"])):g("",!0),p.value?(a(),f(be,{key:3,"presentation-id":B.value,onClose:o[6]||(o[6]=l=>p.value=!1),onCreated:ee,onCopied:te},null,8,["presentation-id"])):g("",!0),x.value?(a(),f(he,{key:4,show:x.value,presentation:S.value,onClose:o[7]||(o[7]=l=>x.value=!1),onUpdated:oe},null,8,["show","presentation"])):g("",!0)])]),_:1}))}};export{Mt as default};
