import{h as de,S as pe,B as Ee,b as zt,c as qt,R as Gt,d as Kt,e as Jt,_ as Zt}from"./AuthenticatedLayout-CfI6sbZQ.js";import{r as x,B as be,i as d,o as n,b as e,F as Z,j as ee,g as C,t as g,m as R,am as Te,e as p,an as Xe,a as L,A as ie,c as le,ao as ut,L as ct,p as Q,D as xe,T as ze,ap as se,H as Xt,P as Oe,aq as Qt,d as we,z as ke,w as re,s as P,f as ce,k as fe,v as We,h as K,G as es,_ as Ce,al as ts,l as Qe,ar as mt,Y as et,ab as ss,a5 as Le,u as ls,M as as,aj as is,ah as ns,y as os,ag as rs}from"./app-DYH6XKEr.js";import{c as he,a as Ie,d as Be,f as je,b as ds,_ as us}from"./ProjectForm-BqivMrFj.js";import{a as ye,_ as Se}from"./SecondaryButton-5fQHXKZF.js";import{P as ue}from"./PrimaryButton-c1xKMDPc.js";import{a as yt,_ as ft}from"./StandupModal-BEXwjekj.js";import{_ as W}from"./InputLabel-Brc2f-v_.js";import{_ as ne,a as ae}from"./InputError-d_Qr3rVn.js";import{_ as bt}from"./EmailEditor-DsdJ0XOc.js";import"./ApplicationLogo-CGb7ZT2L.js";import"./Checkbox-cD944bLw.js";import"./ProjectTypeInput-CSYv3opH.js";const cs={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},ms={key:0,class:"text-sm text-gray-500"},vs={key:1,class:"text-sm text-gray-500"},ps={key:2,class:"space-y-3"},hs={class:"flex justify-between items-start"},gs={class:"font-medium text-gray-900"},ys={class:"text-sm text-gray-600"},fs={key:0,class:"text-sm text-gray-600 mt-1"},bs={class:"flex space-x-2"},_s=["href"],ws=["href"],xs=["onClick"],ks={__name:"ProjectMeetingsList",props:{projectId:{type:Number,required:!0}},setup(l,{expose:t}){const s=l,o=x([]),i=x(!1),a=x(""),u=()=>{try{a.value=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(y){console.error("Error detecting user timezone:",y),a.value="UTC"}},r=(y,_=null,k=!1)=>{if(!y)return"";try{if(k||y.endsWith("Z")){if(_&&_===a.value){const E={dateStyle:"medium",timeStyle:"short"};return new Date(y).toLocaleString(void 0,E)}const w={dateStyle:"medium",timeStyle:"short",timeZone:_||a.value};return new Date(y).toLocaleString(void 0,w)}else{if(_&&_===a.value){const E={dateStyle:"medium",timeStyle:"short"};return new Date(y).toLocaleString(void 0,E)}const w={dateStyle:"medium",timeStyle:"short",timeZone:_||a.value};return new Date(y).toLocaleString(void 0,w)}}catch(w){return console.error("Error formatting meeting time:",w),new Date(y).toLocaleString()}},m=(y,_=null,k=!1)=>{if(!y)return"";try{if(k||y.endsWith("Z")){if(_&&_===a.value){const E={timeStyle:"short"};return new Date(y).toLocaleTimeString(void 0,E)}const w={timeStyle:"short",timeZone:_||a.value};return new Date(y).toLocaleTimeString(void 0,w)}else{if(_&&_===a.value){const E={timeStyle:"short"};return new Date(y).toLocaleTimeString(void 0,E)}const w={timeStyle:"short",timeZone:_||a.value};return new Date(y).toLocaleTimeString(void 0,w)}}catch(w){return console.error("Error formatting meeting time (time only):",w),new Date(y).toLocaleTimeString()}},c=async()=>{i.value=!0;try{const y=await window.axios.get(`/api/projects/${s.projectId}/meetings`);o.value=y.data}catch(y){console.error("Error fetching project meetings:",y)}finally{i.value=!1}},v=async y=>{if(confirm("Are you sure you want to delete this meeting?"))try{await window.axios.delete(`/api/projects/${s.projectId}/meetings/${y}`),await c()}catch(_){console.error("Error deleting meeting:",_),alert("Failed to delete meeting. Please try again.")}};return t({fetchMeetings:c}),be(()=>{u(),c()}),(y,_)=>(n(),d("div",cs,[_[4]||(_[4]=e("h4",{class:"text-md font-semibold text-gray-900 mb-2"},"Upcoming Meetings",-1)),i.value?(n(),d("div",ms," Loading meetings... ")):o.value.length===0?(n(),d("div",vs," No upcoming meetings scheduled. ")):(n(),d("div",ps,[(n(!0),d(Z,null,ee(o.value,k=>(n(),d("div",{key:k.id,class:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[e("div",hs,[e("div",null,[e("h5",gs,g(k.summary),1),e("p",ys,g(r(k.start_time,k.timezone,k.is_utc))+" - "+g(m(k.end_time,k.timezone,k.is_utc)),1),k.location?(n(),d("p",fs,[_[0]||(_[0]=e("span",{class:"font-medium"},"Location:",-1)),R(" "+g(k.location),1)])):C("",!0)]),e("div",bs,[e("a",{href:k.google_event_link,target:"_blank",class:"text-blue-600 hover:text-blue-800",title:"View in Google Calendar"},_[1]||(_[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]),8,_s),k.google_meet_link?(n(),d("a",{key:0,href:k.google_meet_link,target:"_blank",class:"text-green-600 hover:text-green-800",title:"Join Google Meet"},_[2]||(_[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,ws)):C("",!0),e("button",{onClick:w=>v(k.google_event_id),class:"text-red-600 hover:text-red-800",title:"Delete Meeting"},_[3]||(_[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,xs)])])]))),128))]))]))}};var Ds=Object.defineProperty,Cs=(l,t,s)=>t in l?Ds(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s,$e=(l,t,s)=>Cs(l,typeof t!="symbol"?t+"":t,s);const $s=(l,t,s)=>{const o=l[t];return o?typeof o=="function"?o():Promise.resolve(o):new Promise((i,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==s?". Note that variables only represent file names one level deep.":""))))})};let Pe,vt,pt,_e,Re={},Ae={};class Ss{constructor(t,s=!1){$e(this,"texts",{}),$e(this,"dateToMinutes",o=>o.getHours()*60+o.getMinutes()),_e=this,this._texts=t,!s&&Date&&!Date.prototype.addDays&&this._initDatePrototypes()}_initDatePrototypes(){Date.prototype.addDays=function(t){return _e.addDays(this,t)},Date.prototype.subtractDays=function(t){return _e.subtractDays(this,t)},Date.prototype.addHours=function(t){return _e.addHours(this,t)},Date.prototype.subtractHours=function(t){return _e.subtractHours(this,t)},Date.prototype.addMinutes=function(t){return _e.addMinutes(this,t)},Date.prototype.subtractMinutes=function(t){return _e.subtractMinutes(this,t)},Date.prototype.getWeek=function(){return _e.getWeek(this)},Date.prototype.isToday=function(){return _e.isToday(this)},Date.prototype.isLeapYear=function(){return _e.isLeapYear(this)},Date.prototype.format=function(t="YYYY-MM-DD"){return _e.formatDate(this,t)},Date.prototype.formatTime=function(t="HH:mm"){return _e.formatTime(this,t)}}removePrototypes(){delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime}updateTexts(t){this._texts=t}_todayFormatted(){return vt!==new Date().getDate()&&(Pe=new Date,vt=Pe.getDate(),pt=`${Pe.getFullYear()}-${Pe.getMonth()}-${Pe.getDate()}`),pt}addDays(t,s){const o=new Date(t.valueOf());return o.setDate(o.getDate()+s),o}subtractDays(t,s){const o=new Date(t.valueOf());return o.setDate(o.getDate()-s),o}addHours(t,s){const o=new Date(t.valueOf());return o.setHours(o.getHours()+s),o}subtractHours(t,s){const o=new Date(t.valueOf());return o.setHours(o.getHours()-s),o}addMinutes(t,s){const o=new Date(t.valueOf());return o.setMinutes(o.getMinutes()+s),o}subtractMinutes(t,s){const o=new Date(t.valueOf());return o.setMinutes(o.getMinutes()-s),o}getWeek(t){const s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),o=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-o);const i=new Date(Date.UTC(s.getUTCFullYear(),0,1));return Math.ceil(((s-i)/864e5+1)/7)}isToday(t){return`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`===this._todayFormatted()}isLeapYear(t){const s=t.getFullYear();return!(s%400)||s%100&&!(s%4)}getPreviousFirstDayOfWeek(t=null,s){const o=t&&new Date(t.valueOf())||new Date,i=s?7:6;return o.setDate(o.getDate()-(o.getDay()+i)%7),o}stringToDate(t){return t instanceof Date?t:(t.length===10&&(t+=" 00:00"),new Date(t.replace(/-/g,"/")))}countDays(t,s){typeof t=="string"&&(t=t.replace(/-/g,"/")),typeof s=="string"&&(s=s.replace(/-/g,"/")),t=new Date(t).setHours(0,0,0,0),s=new Date(s).setHours(0,0,1,0);const o=(new Date(s).getTimezoneOffset()-new Date(t).getTimezoneOffset())*60*1e3;return Math.ceil((s-t-o)/(24*3600*1e3))}datesInSameTimeStep(t,s,o){return Math.abs(t.getTime()-s.getTime())<=o*60*1e3}formatDate(t,s="YYYY-MM-DD",o=null){if(o||(o=this._texts),s||(s="YYYY-MM-DD"),s==="YYYY-MM-DD")return this.formatDateLite(t);Re={},Ae={};const i={YYYY:()=>this._hydrateDateObject(t,o).YYYY,YY:()=>this._hydrateDateObject(t,o).YY(),M:()=>this._hydrateDateObject(t,o).M,MM:()=>this._hydrateDateObject(t,o).MM(),MMM:()=>this._hydrateDateObject(t,o).MMM(),MMMM:()=>this._hydrateDateObject(t,o).MMMM(),MMMMG:()=>this._hydrateDateObject(t,o).MMMMG(),D:()=>this._hydrateDateObject(t,o).D,DD:()=>this._hydrateDateObject(t,o).DD(),S:()=>this._hydrateDateObject(t,o).S(),d:()=>this._hydrateDateObject(t,o).d,dd:()=>this._hydrateDateObject(t,o).dd(),ddd:()=>this._hydrateDateObject(t,o).ddd(),dddd:()=>this._hydrateDateObject(t,o).dddd(),HH:()=>this._hydrateTimeObject(t,o).HH,H:()=>this._hydrateTimeObject(t,o).H,hh:()=>this._hydrateTimeObject(t,o).hh,h:()=>this._hydrateTimeObject(t,o).h,am:()=>this._hydrateTimeObject(t,o).am,AM:()=>this._hydrateTimeObject(t,o).AM,mm:()=>this._hydrateTimeObject(t,o).mm,m:()=>this._hydrateTimeObject(t,o).m};return s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(a,u)=>{const r=i[u.replace(/\{|\}/g,"")];return r!==void 0?r():u})}formatDateLite(t){const s=t.getMonth()+1,o=t.getDate();return`${t.getFullYear()}-${s<10?"0":""}${s}-${o<10?"0":""}${o}`}formatTime(t,s="HH:mm",o=null,i=!1){let a=!1;if(i){const[m,c,v]=[t.getHours(),t.getMinutes(),t.getSeconds()];m+c+v===141&&(a=!0)}if(t instanceof Date&&s==="HH:mm")return a?"24:00":this.formatTimeLite(t);Ae={},o||(o=this._texts);const u=this._hydrateTimeObject(t,o),r=s.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(m,c)=>{const v=u[c.replace(/\{|\}/g,"")];return v!==void 0?v:c});return a?r.replace("23:59","24:00"):r}formatTimeLite(t){const s=t.getHours(),o=t.getMinutes();return`${(s<10?"0":"")+s}:${(o<10?"0":"")+o}`}_nth(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}_hydrateDateObject(t,s){if(Re.D)return Re;const o=t.getFullYear(),i=t.getMonth()+1,a=t.getDate(),r=(t.getDay()-1+7)%7;return Re={YYYY:o,YY:()=>o.toString().substring(2),M:i,MM:()=>(i<10?"0":"")+i,MMM:()=>s.months[i-1].substring(0,3),MMMM:()=>s.months[i-1],MMMMG:()=>(s.monthsGenitive||s.months)[i-1],D:a,DD:()=>(a<10?"0":"")+a,S:()=>this._nth(a),d:r+1,dd:()=>s.weekDays[r][0],ddd:()=>s.weekDays[r].substr(0,3),dddd:()=>s.weekDays[r]},Re}_hydrateTimeObject(t,s){if(Ae.am)return Ae;let o,i;t instanceof Date?(o=t.getHours(),i=t.getMinutes()):(o=Math.floor(t/60),i=Math.floor(t%60));const a=o%12?o%12:12,u=(s||{am:"am",pm:"pm"})[o===24||o<12?"am":"pm"];return Ae={H:o,h:a,HH:(o<10?"0":"")+o,hh:(a<10?"0":"")+a,am:u,AM:u.toUpperCase(),m:i,mm:(i<10?"0":"")+i},Ae}}const Es=1440;class Ms{constructor(t){$e(this,"_vuecal",null),$e(this,"selectCell",(s=!1,o,i)=>{this._vuecal.$emit("cell-click",i?{date:o,split:i}:o),this._vuecal.clickToNavigate||s?this._vuecal.switchToNarrowerView():this._vuecal.dblclickToNavigate&&"ontouchstart"in window&&(this._vuecal.domEvents.dblTapACell.taps++,setTimeout(()=>this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.domEvents.dblTapACell.timeout),this._vuecal.domEvents.dblTapACell.taps>=2&&(this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.switchToNarrowerView(),this._vuecal.$emit("cell-dblclick",i?{date:o,split:i}:o)))}),$e(this,"keyPressEnterCell",(s,o)=>{this._vuecal.$emit("cell-keypress-enter",o?{date:s,split:o}:s),this._vuecal.switchToNarrowerView()}),$e(this,"getPosition",s=>{const{left:o,top:i}=this._vuecal.cellsEl.getBoundingClientRect(),{clientX:a,clientY:u}="ontouchstart"in window&&s.touches?s.touches[0]:s;return{x:a-o,y:u-i}}),$e(this,"minutesAtCursor",s=>{let o=0,i={x:0,y:0};const{timeStep:a,timeCellHeight:u,timeFrom:r}=this._vuecal.$props;return typeof s=="number"?o=s:typeof s=="object"&&(i=this.getPosition(s),o=Math.round(i.y*a/parseInt(u)+r)),{minutes:Math.max(Math.min(o,Es),0),cursorCoords:i}}),this._vuecal=t}}const Ts=2,Je=1440;let me,ve,Ze;class js{constructor(t,s){$e(this,"_vuecal",null),$e(this,"eventDefaults",{_eid:null,start:"",startTimeMinutes:0,end:"",endTimeMinutes:0,title:"",content:"",background:!1,allDay:!1,segments:null,repeat:null,daysCount:1,deletable:!0,deleting:!1,titleEditable:!0,resizable:!0,resizing:!1,draggable:!0,dragging:!1,draggingStatic:!1,focused:!1,class:""}),this._vuecal=t,me=s}createAnEvent(t,s,o){if(typeof t=="string"&&(t=me.stringToDate(t)),!(t instanceof Date))return!1;const i=me.dateToMinutes(t);s=s*1||Ts*60;const a=i+s,u=me.addMinutes(new Date(t),s);o.end&&(typeof o.end=="string"&&(o.end=me.stringToDate(o.end)),o.endTimeMinutes=me.dateToMinutes(o.end));const r={...this.eventDefaults,_eid:`${this._vuecal._.uid}_${this._vuecal.eventIdIncrement++}`,start:t,startTimeMinutes:i,end:u,endTimeMinutes:a,segments:null,...o};if(!(typeof this._vuecal.onEventCreate=="function"&&!this._vuecal.onEventCreate(r,()=>this.deleteAnEvent(r))))return r.startDateF!==r.endDateF&&(r.daysCount=me.countDays(r.start,r.end)),this._vuecal.mutableEvents.push(r),this._vuecal.addEventsToView([r]),this._vuecal.emitWithEvent("event-create",r),this._vuecal.$emit("event-change",{event:this._vuecal.cleanupEvent(r),originalEvent:null}),r}addEventSegment(t){t.segments||(t.segments={},t.segments[me.formatDateLite(t.start)]={start:t.start,startTimeMinutes:t.startTimeMinutes,endTimeMinutes:Je,isFirstDay:!0,isLastDay:!1});const s=t.segments[me.formatDateLite(t.end)];s&&(s.isLastDay=!1,s.endTimeMinutes=Je);const o=me.addDays(t.end,1),i=me.formatDateLite(o);return o.setHours(0,0,0,0),t.segments[i]={start:o,startTimeMinutes:0,endTimeMinutes:t.endTimeMinutes,isFirstDay:!1,isLastDay:!0},t.end=me.addMinutes(o,t.endTimeMinutes),t.daysCount=Object.keys(t.segments).length,i}removeEventSegment(t){let s=Object.keys(t.segments).length;if(s<=1)return me.formatDateLite(t.end);delete t.segments[me.formatDateLite(t.end)],s--;const o=me.subtractDays(t.end,1),i=me.formatDateLite(o),a=t.segments[i];return s?a&&(a.isLastDay=!0,a.endTimeMinutes=t.endTimeMinutes):t.segments=null,t.daysCount=s||1,t.end=o,i}createEventSegments(t,s,o){const i=s.getTime(),a=o.getTime();let u=t.start.getTime(),r=t.end.getTime(),m=!1,c,v,y;for(!t.end.getHours()&&!t.end.getMinutes()&&(r-=1e3),t.segments={},t.repeat?(c=i,v=Math.min(a,t.repeat.until?me.stringToDate(t.repeat.until).getTime():a)):(c=Math.max(i,u),v=Math.min(a,r));c<=v;){let _=!1;const k=me.addDays(new Date(c),1).setHours(0,0,0,0);let w,E,f,h;if(t.repeat){const T=new Date(c),A=me.formatDateLite(T);(m||t.occurrences&&t.occurrences[A])&&(m||(u=t.occurrences[A].start,y=new Date(u).setHours(0,0,0,0),r=t.occurrences[A].end),m=!0,_=!0),w=c===y,E=A===me.formatDateLite(new Date(r)),f=new Date(w?u:c),h=me.formatDateLite(f),E&&(m=!1)}else _=!0,w=c===u,E=v===r&&k>v,f=w?t.start:new Date(c),h=me.formatDateLite(w?t.start:f);_&&(t.segments[h]={start:f,startTimeMinutes:w?t.startTimeMinutes:0,endTimeMinutes:E?t.endTimeMinutes:Je,isFirstDay:w,isLastDay:E}),c=k}return t}deleteAnEvent(t){this._vuecal.emitWithEvent("event-delete",t),this._vuecal.mutableEvents=this._vuecal.mutableEvents.filter(s=>s._eid!==t._eid),this._vuecal.view.events=this._vuecal.view.events.filter(s=>s._eid!==t._eid)}checkCellOverlappingEvents(t,s){Ze=t.slice(0),ve={},t.forEach(i=>{Ze.shift(),ve[i._eid]||(ve[i._eid]={overlaps:[],start:i.start,position:0}),ve[i._eid].position=0,Ze.forEach(a=>{ve[a._eid]||(ve[a._eid]={overlaps:[],start:a.start,position:0});const u=this.eventInRange(a,i.start,i.end),r=s.overlapsPerTimeStep?me.datesInSameTimeStep(i.start,a.start,s.timeStep):1;if(!i.background&&!i.allDay&&!a.background&&!a.allDay&&u&&r)ve[i._eid].overlaps.push(a._eid),ve[i._eid].overlaps=[...new Set(ve[i._eid].overlaps)],ve[a._eid].overlaps.push(i._eid),ve[a._eid].overlaps=[...new Set(ve[a._eid].overlaps)],ve[a._eid].position++;else{let m,c;(m=(ve[i._eid]||{overlaps:[]}).overlaps.indexOf(a._eid))>-1&&ve[i._eid].overlaps.splice(m,1),(c=(ve[a._eid]||{overlaps:[]}).overlaps.indexOf(i._eid))>-1&&ve[a._eid].overlaps.splice(c,1),ve[a._eid].position--}})});let o=0;for(const i in ve){const a=ve[i],u=a.overlaps.map(r=>({id:r,start:ve[r].start}));u.push({id:i,start:a.start}),u.sort((r,m)=>r.start<m.start?-1:r.start>m.start?1:r.id>m.id?-1:1),a.position=u.findIndex(r=>r.id===i),o=Math.max(this.getOverlapsStreak(a,ve),o)}return[ve,o]}getOverlapsStreak(t,s={}){let o=t.overlaps.length+1,i=[];return t.overlaps.forEach(a=>{i.includes(a)||t.overlaps.filter(r=>r!==a).forEach(r=>{s[r].overlaps.includes(a)||i.push(r)})}),i=[...new Set(i)],o-=i.length,o}eventInRange(t,s,o){if(t.allDay||!this._vuecal.time){const u=new Date(t.start).setHours(0,0,0,0);return new Date(t.end).setHours(23,59,0,0)>=new Date(s).setHours(0,0,0,0)&&u<=new Date(o).setHours(0,0,0,0)}const i=t.start.getTime(),a=t.end.getTime();return i<o.getTime()&&a>s.getTime()}}const Vs={class:"vuecal__flex vuecal__weekdays-headings"},As=["onClick"],Is={class:"vuecal__flex weekday-label",grow:""},Os={class:"full"},Ls={class:"small"},Us={class:"xsmall"},Ns={key:0},Ps={key:0,class:"vuecal__flex vuecal__split-days-headers",grow:""};function Rs(l,t,s,o,i,a){return n(),d("div",Vs,[(n(!0),d(Z,null,ee(a.headings,(u,r)=>(n(),d(Z,{key:r},[u.hide?C("",!0):(n(),d("div",{key:0,class:Q(["vuecal__flex vuecal__heading",{today:u.today,clickable:a.cellHeadingsClickable}]),style:xe(a.weekdayCellStyles),onClick:m=>a.view.id==="week"&&a.selectCell(u.date,m),onDblclick:t[0]||(t[0]=m=>a.view.id==="week"&&a.vuecal.dblclickToNavigate&&s.switchToNarrowerView())},[p(ze,{name:`slide-fade--${s.transitionDirection}`,appear:a.vuecal.transitions},{default:L(()=>[(n(),d("div",{class:"vuecal__flex",column:"",key:a.vuecal.transitions?`${r}-${u.dayOfMonth}`:!1},[e("div",Is,[ie(l.$slots,"weekday-heading",{heading:a.cleanupHeading(u),view:a.view},()=>[e("span",Os,g(u.full),1),e("span",Ls,g(u.small),1),e("span",Us,g(u.xsmall),1),u.dayOfMonth?(n(),d("span",Ns," "+g(u.dayOfMonth),1)):C("",!0)])]),a.vuecal.hasSplits&&a.vuecal.stickySplitLabels?(n(),d("div",Ps,[(n(!0),d(Z,null,ee(a.vuecal.daySplits,(m,c)=>(n(),d("div",{class:Q(["day-split-header",m.class||!1]),key:c},[ie(l.$slots,"split-label",{split:m,view:a.view},()=>[R(g(m.label),1)])],2))),128))])):C("",!0)]))]),_:2},1032,["name","appear"])],46,As))],64))),128))])}const Ue=(l,t)=>{const s=l.__vccOpts||l;for(const[o,i]of t)s[o]=i;return s},Fs={inject:["vuecal","utils","view"],props:{transitionDirection:{type:String,default:"right"},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},methods:{selectCell(l,t){l.getTime()!==this.view.selectedDate.getTime()&&(this.view.selectedDate=l),this.utils.cell.selectCell(!1,l,t)},cleanupHeading:l=>({label:l.full,date:l.date,...l.today?{today:l.today}:{}})},computed:{headings(){if(!["month","week"].includes(this.view.id))return[];let l=!1;return this.weekDays.map((s,o)=>{const i=this.utils.date.addDays(this.view.startDate,this.vuecal.startWeekOnSunday&&this.vuecal.hideWeekends?o-1:o);return{hide:s.hide,full:s.label,small:s.short||s.label.substr(0,3),xsmall:s.short||s.label.substr(0,1),...this.view.id==="week"?{dayOfMonth:i.getDate(),date:i,today:!l&&this.utils.date.isToday(i)&&!l++}:{}}})},cellWidth(){return 100/(7-this.weekDays.reduce((l,t)=>l+t.hide,0))},weekdayCellStyles(){return{...this.vuecal.hideWeekdays.length?{width:`${this.cellWidth}%`}:{}}},cellHeadingsClickable(){return this.view.id==="week"&&(this.vuecal.clickToNavigate||this.vuecal.dblclickToNavigate)}}},_t=Ue(Fs,[["render",Rs]]),Bs={class:"vuecal__header"},Hs={key:0,class:"vuecal__flex vuecal__menu",role:"tablist","aria-label":"Calendar views navigation"},Ws=["onDragenter","onDragleave","onClick","aria-label"],Ys={key:1,class:"vuecal__title-bar"},zs=["aria-label"],qs={class:"vuecal__flex vuecal__title",grow:""},Gs=["aria-label"],Ks={key:0,class:"vuecal__flex vuecal__split-days-headers"};function Js(l,t,s,o,i,a){const u=Te("weekdays-headings");return n(),d("div",Bs,[s.options.hideViewSelector?C("",!0):(n(),d("div",Hs,[(n(!0),d(Z,null,ee(s.viewProps.views,(r,m)=>(n(),d(Z,{key:m},[r.enabled?(n(),d("button",{key:0,class:Q(["vuecal__view-btn",{"vuecal__view-btn--active":a.view.id===m,"vuecal__view-btn--highlighted":l.highlightedControl===m}]),type:"button",onDragenter:c=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(c,m,l.$data),onDragleave:c=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(c,m,l.$data),onClick:c=>a.switchView(m,null,!0),"aria-label":`${r.label} view`},g(r.label),43,Ws)):C("",!0)],64))),128))])),s.options.hideTitleBar?C("",!0):(n(),d("div",Ys,[e("button",{class:Q(["vuecal__arrow vuecal__arrow--prev",{"vuecal__arrow--highlighted":l.highlightedControl==="previous"}]),type:"button",onClick:t[0]||(t[0]=(...r)=>a.previous&&a.previous(...r)),onDragenter:t[1]||(t[1]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(r,"previous",l.$data)),onDragleave:t[2]||(t[2]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(r,"previous",l.$data)),"aria-label":`Previous ${a.view.id}`},[ie(l.$slots,"arrow-prev")],42,zs),e("div",qs,[p(ze,{name:s.options.transitions?`slide-fade--${a.transitionDirection}`:""},{default:L(()=>[(n(),le(Xt(a.broaderView?"button":"span"),{type:!!a.broaderView&&"button",key:`${a.view.id}${a.view.startDate.toString()}`,onClick:t[3]||(t[3]=r=>!!a.broaderView&&a.switchToBroaderView()),"aria-label":!!a.broaderView&&`Go to ${a.broaderView} view`},{default:L(()=>[ie(l.$slots,"title")]),_:3},8,["type","aria-label"]))]),_:3},8,["name"])]),s.options.todayButton?(n(),d("button",{key:0,class:Q(["vuecal__today-btn",{"vuecal__today-btn--highlighted":l.highlightedControl==="today"}]),type:"button",onClick:t[4]||(t[4]=(...r)=>a.goToToday&&a.goToToday(...r)),onDragenter:t[5]||(t[5]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(r,"today",l.$data)),onDragleave:t[6]||(t[6]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(r,"today",l.$data)),"aria-label":"Today"},[ie(l.$slots,"today-button")],34)):C("",!0),e("button",{class:Q(["vuecal__arrow vuecal__arrow--next",{"vuecal__arrow--highlighted":l.highlightedControl==="next"}]),type:"button",onClick:t[7]||(t[7]=(...r)=>a.next&&a.next(...r)),onDragenter:t[8]||(t[8]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(r,"next",l.$data)),onDragleave:t[9]||(t[9]=r=>s.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(r,"next",l.$data)),"aria-label":`Next ${a.view.id}`},[ie(l.$slots,"arrow-next")],42,Gs)])),s.viewProps.weekDaysInHeader?(n(),le(u,{key:2,"week-days":s.weekDays,"transition-direction":a.transitionDirection,"switch-to-narrower-view":s.switchToNarrowerView},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:L(({heading:r,view:m})=>[ie(l.$slots,"weekday-heading",{heading:r,view:m})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:L(({split:r})=>[ie(l.$slots,"split-label",{split:r,view:a.view})]),key:"1"}:void 0]),1032,["week-days","transition-direction","switch-to-narrower-view"])):C("",!0),p(ze,{name:`slide-fade--${a.transitionDirection}`},{default:L(()=>[a.showDaySplits?(n(),d("div",Ks,[(n(!0),d(Z,null,ee(s.daySplits,(r,m)=>(n(),d("div",{class:Q(["day-split-header",r.class||!1]),key:m},[ie(l.$slots,"split-label",{split:r,view:a.view.id},()=>[R(g(r.label),1)])],2))),128))])):C("",!0)]),_:3},8,["name"])])}const Zs={inject:["vuecal","previous","next","switchView","updateSelectedDate","modules","view"],components:{WeekdaysHeadings:_t},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},hasSplits:{type:[Boolean,Number],default:!1},daySplits:{type:Array,default:()=>[]},viewProps:{type:Object,default:()=>({})},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},data:()=>({highlightedControl:null}),methods:{goToToday(){this.updateSelectedDate(new Date(new Date().setHours(0,0,0,0)))},switchToBroaderView(){this.transitionDirection="left",this.broaderView&&this.switchView(this.broaderView)}},computed:{transitionDirection:{get(){return this.vuecal.transitionDirection},set(l){this.vuecal.transitionDirection=l}},broaderView(){const{enabledViews:l}=this.vuecal;return l[l.indexOf(this.view.id)-1]},showDaySplits(){return this.view.id==="day"&&this.hasSplits&&this.options.stickySplitLabels&&!this.options.minSplitWidth},dnd(){return this.modules.dnd}}},Xs=Ue(Zs,[["render",Js]]),Qs=["draggable"];function el(l,t,s,o,i,a){return n(),d("div",{class:Q(["vuecal__event",a.eventClasses]),style:xe(a.eventStyles),tabindex:"0",onFocus:t[4]||(t[4]=(...u)=>a.focusEvent&&a.focusEvent(...u)),onKeypress:t[5]||(t[5]=Oe(we((...u)=>a.onEnterKeypress&&a.onEnterKeypress(...u),["stop"]),["enter"])),onMouseenter:t[6]||(t[6]=(...u)=>a.onMouseEnter&&a.onMouseEnter(...u)),onMouseleave:t[7]||(t[7]=(...u)=>a.onMouseLeave&&a.onMouseLeave(...u)),onTouchstart:t[8]||(t[8]=we((...u)=>a.onTouchStart&&a.onTouchStart(...u),["stop"])),onMousedown:t[9]||(t[9]=u=>a.onMouseDown(u)),onMouseup:t[10]||(t[10]=(...u)=>a.onMouseUp&&a.onMouseUp(...u)),onTouchend:t[11]||(t[11]=(...u)=>a.onMouseUp&&a.onMouseUp(...u)),onTouchmove:t[12]||(t[12]=(...u)=>a.onTouchMove&&a.onTouchMove(...u)),onDblclick:t[13]||(t[13]=(...u)=>a.onDblClick&&a.onDblClick(...u)),draggable:a.draggable,onDragstart:t[14]||(t[14]=u=>a.draggable&&a.onDragStart(u)),onDragend:t[15]||(t[15]=u=>a.draggable&&a.onDragEnd())},[a.vuecal.editEvents.delete&&s.event.deletable?(n(),d("div",{key:0,class:"vuecal__event-delete",onClick:t[0]||(t[0]=we((...u)=>a.deleteEvent&&a.deleteEvent(...u),["stop"])),onTouchstart:t[1]||(t[1]=we((...u)=>a.touchDeleteEvent&&a.touchDeleteEvent(...u),["stop"]))},g(a.vuecal.texts.deleteEvent),33)):C("",!0),ie(l.$slots,"event",{event:s.event,view:a.view.id}),a.resizable?(n(),d("div",{key:1,class:"vuecal__event-resize-handle",contenteditable:"false",onMousedown:t[2]||(t[2]=we((...u)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...u),["stop","prevent"])),onTouchstart:t[3]||(t[3]=we((...u)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...u),["stop","prevent"]))},null,32)):C("",!0)],46,Qs)}const tl={inject:["vuecal","utils","modules","view","domEvents","editEvents"],props:{cellFormattedDate:{type:String,default:""},event:{type:Object,default:()=>({})},cellEvents:{type:Array,default:()=>[]},overlaps:{type:Array,default:()=>[]},eventPosition:{type:Number,default:0},overlapsStreak:{type:Number,default:0},allDay:{type:Boolean,default:!1}},data:()=>({touch:{dragThreshold:30,startX:0,startY:0,dragged:!1}}),methods:{onMouseDown(l,t=!1){if("ontouchstart"in window&&!t)return!1;const{clickHoldAnEvent:s,focusAnEvent:o,resizeAnEvent:i,dragAnEvent:a}=this.domEvents;if(o._eid===this.event._eid&&s._eid===this.event._eid)return!0;this.focusEvent(),s._eid=null,this.vuecal.editEvents.delete&&this.event.deletable&&(s.timeoutId=setTimeout(()=>{!i._eid&&!a._eid&&(s._eid=this.event._eid,this.event.deleting=!0)},s.timeout))},onMouseUp(l){this.domEvents.focusAnEvent._eid===this.event._eid&&!this.touch.dragged&&(this.domEvents.focusAnEvent.mousedUp=!0),this.touch.dragged=!1},onMouseEnter(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-enter",this.event)},onMouseLeave(l){l.preventDefault(),this.vuecal.emitWithEvent("event-mouse-leave",this.event)},onTouchMove(l){if(typeof this.vuecal.onEventClick!="function")return;const{clientX:t,clientY:s}=l.touches[0],{startX:o,startY:i,dragThreshold:a}=this.touch;(Math.abs(t-o)>a||Math.abs(s-i)>a)&&(this.touch.dragged=!0)},onTouchStart(l){this.touch.startX=l.touches[0].clientX,this.touch.startY=l.touches[0].clientY,this.onMouseDown(l,!0)},onEnterKeypress(l){if(typeof this.vuecal.onEventClick=="function")return this.vuecal.onEventClick(this.event,l)},onDblClick(l){if(typeof this.vuecal.onEventDblclick=="function")return this.vuecal.onEventDblclick(this.event,l)},onDragStart(l){this.dnd&&this.dnd.eventDragStart(l,this.event)},onDragEnd(){this.dnd&&this.dnd.eventDragEnd(this.event)},onResizeHandleMouseDown(){this.focusEvent(),this.domEvents.dragAnEvent._eid=null,this.domEvents.resizeAnEvent=Object.assign(this.domEvents.resizeAnEvent,{_eid:this.event._eid,start:(this.segment||this.event).start,split:this.event.split||null,segment:!!this.segment&&this.utils.date.formatDateLite(this.segment.start),originalEnd:new Date((this.segment||this.event).end),originalEndTimeMinutes:this.event.endTimeMinutes}),this.event.resizing=!0},deleteEvent(l=!1){if("ontouchstart"in window&&!l)return!1;this.utils.event.deleteAnEvent(this.event)},touchDeleteEvent(l){this.deleteEvent(!0)},cancelDeleteEvent(){this.event.deleting=!1},focusEvent(){const{focusAnEvent:l}=this.domEvents,t=l._eid;if(t!==this.event._eid){if(t){const s=this.view.events.find(o=>o._eid===t);s&&(s.focused=!1)}this.vuecal.cancelDelete(),this.vuecal.emitWithEvent("event-focus",this.event),l._eid=this.event._eid,this.event.focused=!0}}},computed:{eventDimensions(){const{startTimeMinutes:l,endTimeMinutes:t}=this.segment||this.event;let s=l-this.vuecal.timeFrom;const o=Math.max(Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),0);s=Math.min(t,this.vuecal.timeTo)-this.vuecal.timeFrom;const i=Math.round(s*this.vuecal.timeCellHeight/this.vuecal.timeStep),a=Math.max(i-o,5);return{top:o,height:a}},eventStyles(){if(this.event.allDay||!this.vuecal.time||!this.event.endTimeMinutes||this.view.id==="month"||this.allDay)return{};let l=100/Math.min(this.overlaps.length+1,this.overlapsStreak),t=100/(this.overlaps.length+1)*this.eventPosition;this.vuecal.minEventWidth&&l<this.vuecal.minEventWidth&&(l=this.vuecal.minEventWidth,t=(100-this.vuecal.minEventWidth)/this.overlaps.length*this.eventPosition);const{top:s,height:o}=this.eventDimensions;return{top:`${s}px`,height:`${o}px`,width:`${l}%`,left:this.event.left&&`${this.event.left}px`||`${t}%`}},eventClasses(){const{isFirstDay:l,isLastDay:t}=this.segment||{};return{[this.event.class]:!!this.event.class,"vuecal__event--focus":this.event.focused,"vuecal__event--resizing":this.event.resizing,"vuecal__event--background":this.event.background,"vuecal__event--deletable":this.event.deleting,"vuecal__event--all-day":this.event.allDay,"vuecal__event--dragging":!this.event.draggingStatic&&this.event.dragging,"vuecal__event--static":this.event.dragging&&this.event.draggingStatic,"vuecal__event--multiple-days":!!this.segment,"event-start":this.segment&&l&&!t,"event-middle":this.segment&&!l&&!t,"event-end":this.segment&&t&&!l}},segment(){return this.event.segments&&this.event.segments[this.cellFormattedDate]||null},draggable(){const{draggable:l,background:t,daysCount:s}=this.event;return this.vuecal.editEvents.drag&&l&&!t&&s===1},resizable(){const{editEvents:l,time:t}=this.vuecal;return l.resize&&this.event.resizable&&t&&!this.allDay&&(!this.segment||this.segment&&this.segment.isLastDay)&&this.view.id!=="month"},dnd(){return this.modules.dnd}}},sl=Ue(tl,[["render",el]]),ll=["data-split","aria-label","onTouchstart","onMousedown","onDragover","onDrop"],al={key:0,class:"cell-time-labels"},il=["innerHTML"],nl={key:2,class:"vuecal__cell-events"},ol=["title"];function rl(l,t,s,o,i,a){const u=Te("event");return n(),le(Qt,{class:Q(["vuecal__cell",a.cellClasses]),name:`slide-fade--${a.transitionDirection}`,tag:"div",appear:s.options.transitions,style:xe(a.cellStyles)},{default:L(()=>[(n(!0),d(Z,null,ee(a.splitsCount?a.splits:1,(r,m)=>(n(),d("div",{class:Q(["vuecal__flex vuecal__cell-content",a.splitsCount&&a.splitClasses(r)]),key:s.options.transitions?`${a.view.id}-${s.data.content}-${m}`:m,"data-split":a.splitsCount?r.id:!1,column:"",tabindex:"0","aria-label":s.data.content,onFocus:t[0]||(t[0]=c=>a.onCellFocus(c)),onKeypress:t[1]||(t[1]=Oe(c=>a.onCellkeyPressEnter(c),["enter"])),onTouchstart:c=>!a.isDisabled&&a.onCellTouchStart(c,a.splitsCount?r.id:null),onMousedown:c=>!a.isDisabled&&a.onCellMouseDown(c,a.splitsCount?r.id:null),onClick:t[2]||(t[2]=c=>!a.isDisabled&&a.onCellClick(c)),onDblclick:t[3]||(t[3]=c=>!a.isDisabled&&a.onCellDblClick(c)),onContextmenu:t[4]||(t[4]=c=>!a.isDisabled&&s.options.cellContextmenu&&a.onCellContextMenu(c)),onDragenter:t[5]||(t[5]=c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragEnter(c,l.$data,s.data.startDate)),onDragover:c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragOver(c,l.$data,s.data.startDate,a.splitsCount?r.id:null),onDragleave:t[6]||(t[6]=c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragLeave(c,l.$data,s.data.startDate)),onDrop:c=>!a.isDisabled&&s.editEvents.drag&&a.dnd&&a.dnd.cellDragDrop(c,l.$data,s.data.startDate,a.splitsCount?r.id:null)},[s.options.showTimeInCells&&s.options.time&&a.isWeekOrDayView&&!s.allDay?(n(),d("div",al,[(n(!0),d(Z,null,ee(a.vuecal.timeCells,(c,v)=>(n(),d("span",{class:"cell-time-label",key:v},g(c.label),1))),128))])):C("",!0),a.isWeekOrDayView&&!s.allDay&&a.specialHours.length?(n(!0),d(Z,{key:1},ee(a.specialHours,(c,v)=>(n(),d("div",{class:Q(["vuecal__special-hours",`vuecal__special-hours--day${c.day} ${c.class}`]),style:xe(`height: ${c.height}px;top: ${c.top}px`)},[c.label?(n(),d("div",{key:0,class:"special-hours-label",innerHTML:c.label},null,8,il)):C("",!0)],6))),256)):C("",!0),ie(l.$slots,"cell-content",{events:a.events,selectCell:c=>a.selectCell(c,!0),split:a.splitsCount?r:!1}),a.eventsCount&&(a.isWeekOrDayView||a.view.id==="month"&&s.options.eventsOnMonthView)?(n(),d("div",nl,[(n(!0),d(Z,null,ee(a.splitsCount?r.events:a.events,(c,v)=>(n(),le(u,{key:v,"cell-formatted-date":s.data.formattedDate,event:c,"all-day":s.allDay,"cell-events":a.splitsCount?r.events:a.events,overlaps:((a.splitsCount?r.overlaps[c._eid]:l.cellOverlaps[c._eid])||[]).overlaps,"event-position":((a.splitsCount?r.overlaps[c._eid]:l.cellOverlaps[c._eid])||[]).position,"overlaps-streak":a.splitsCount?r.overlapsStreak:l.cellOverlapsStreak},{event:L(({event:y,view:_})=>[ie(l.$slots,"event",{view:_,event:y})]),_:2},1032,["cell-formatted-date","event","all-day","cell-events","overlaps","event-position","overlaps-streak"]))),128))])):C("",!0)],42,ll))),128)),a.timelineVisible?(n(),d("div",{class:"vuecal__now-line",style:xe(`top: ${a.todaysTimePosition}px`),key:s.options.transitions?`${a.view.id}-now-line`:"now-line",title:a.utils.date.formatTime(a.vuecal.now)},null,12,ol)):C("",!0)]),_:3},8,["class","name","appear","style"])}const dl={inject:["vuecal","utils","modules","view","domEvents"],components:{Event:sl},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},data:{type:Object,required:!0},cellSplits:{type:Array,default:()=>[]},minTimestamp:{type:[Number,null],default:null},maxTimestamp:{type:[Number,null],default:null},cellWidth:{type:[Number,Boolean],default:!1},allDay:{type:Boolean,default:!1}},data:()=>({cellOverlaps:{},cellOverlapsStreak:1,timeAtCursor:null,highlighted:!1,highlightedSplit:null}),methods:{getSplitAtCursor({target:l}){let s=l.classList.contains("vuecal__cell-split")?l:this.vuecal.findAncestor(l,"vuecal__cell-split");return s&&(s=s.attributes["data-split"].value,parseInt(s).toString()===s.toString()&&(s=parseInt(s))),s||null},splitClasses(l){return{"vuecal__cell-split":!0,"vuecal__cell-split--highlighted":this.highlightedSplit===l.id,[l.class]:!!l.class}},checkCellOverlappingEvents(){this.options.time&&this.eventsCount&&!this.splitsCount&&(this.eventsCount===1?(this.cellOverlaps=[],this.cellOverlapsStreak=1):[this.cellOverlaps,this.cellOverlapsStreak]=this.utils.event.checkCellOverlappingEvents(this.events,this.options))},isDOMElementAnEvent(l){return this.vuecal.isDOMElementAnEvent(l)},selectCell(l,t=!1){const s=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.selectCell(t,this.timeAtCursor,s),this.timeAtCursor=null},onCellkeyPressEnter(l){this.isSelected||this.onCellFocus(l);const t=this.splitsCount?this.getSplitAtCursor(l):null;this.utils.cell.keyPressEnterCell(this.timeAtCursor,t),this.timeAtCursor=null},onCellFocus(l){if(!this.isSelected&&!this.isDisabled){this.isSelected=this.data.startDate;const t=this.splitsCount?this.getSplitAtCursor(l):null,s=this.timeAtCursor||this.data.startDate;this.vuecal.$emit("cell-focus",t?{date:s,split:t}:s)}},onCellMouseDown(l,t=null,s=!1){if("ontouchstart"in window&&!s)return!1;this.isSelected||this.onCellFocus(l);const{clickHoldACell:o,focusAnEvent:i}=this.domEvents;this.domEvents.cancelClickEventCreation=!1,o.eventCreated=!1,this.timeAtCursor=new Date(this.data.startDate);const{minutes:a,cursorCoords:{y:u}}=this.vuecal.minutesAtCursor(l);this.timeAtCursor.setMinutes(a);const r=this.isDOMElementAnEvent(l.target);!r&&i._eid&&((this.view.events.find(m=>m._eid===i._eid)||{}).focused=!1),this.editEvents.create&&!r&&this.setUpEventCreation(l,u)},setUpEventCreation(l,t){if(this.options.dragToCreateEvent&&["week","day"].includes(this.view.id)){const{dragCreateAnEvent:s}=this.domEvents;if(s.startCursorY=t,s.split=this.splitsCount?this.getSplitAtCursor(l):null,s.start=this.timeAtCursor,this.options.snapToTime){let o=this.timeAtCursor.getHours()*60+this.timeAtCursor.getMinutes();const i=o+this.options.snapToTime/2;o=i-i%this.options.snapToTime,s.start.setHours(0,o,0,0)}}else this.options.cellClickHold&&["month","week","day"].includes(this.view.id)&&this.setUpCellHoldTimer(l)},setUpCellHoldTimer(l){const{clickHoldACell:t}=this.domEvents;t.cellId=`${this.vuecal._.uid}_${this.data.formattedDate}`,t.split=this.splitsCount?this.getSplitAtCursor(l):null,t.timeoutId=setTimeout(()=>{if(t.cellId&&!this.domEvents.cancelClickEventCreation){const{_eid:s}=this.utils.event.createAnEvent(this.timeAtCursor,null,t.split?{split:t.split}:{});t.eventCreated=s}},t.timeout)},onCellTouchStart(l,t=null){this.onCellMouseDown(l,t,!0)},onCellClick(l){this.isDOMElementAnEvent(l.target)||this.selectCell(l)},onCellDblClick(l){const t=new Date(this.data.startDate);t.setMinutes(this.vuecal.minutesAtCursor(l).minutes);const s=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-dblclick",s?{date:t,split:s}:t),this.options.dblclickToNavigate&&this.vuecal.switchToNarrowerView()},onCellContextMenu(l){l.stopPropagation(),l.preventDefault();const t=new Date(this.data.startDate),{cursorCoords:s,minutes:o}=this.vuecal.minutesAtCursor(l);t.setMinutes(o);const i=this.splitsCount?this.getSplitAtCursor(l):null;this.vuecal.$emit("cell-contextmenu",{date:t,...s,...i||{},e:l})}},computed:{dnd(){return this.modules.dnd},nowInMinutes(){return this.utils.date.dateToMinutes(this.vuecal.now)},isBeforeMinDate(){return this.minTimestamp!==null&&this.minTimestamp>this.data.endDate.getTime()},isAfterMaxDate(){return this.maxTimestamp&&this.maxTimestamp<this.data.startDate.getTime()},isDisabled(){const{disableDays:l}=this.options,{isYearsOrYearView:t}=this.vuecal;return l.length&&l.includes(this.data.formattedDate)&&!t?!0:this.isBeforeMinDate||this.isAfterMaxDate},isSelected:{get(){let l=!1;const{selectedDate:t}=this.view;return this.view.id==="years"?l=t.getFullYear()===this.data.startDate.getFullYear():this.view.id==="year"?l=t.getFullYear()===this.data.startDate.getFullYear()&&t.getMonth()===this.data.startDate.getMonth():l=t.getTime()===this.data.startDate.getTime(),l},set(l){this.view.selectedDate=l,this.vuecal.$emit("update:selected-date",this.view.selectedDate)}},isWeekOrDayView(){return["week","day"].includes(this.view.id)},transitionDirection(){return this.vuecal.transitionDirection},specialHours(){return this.data.specialHours.map(l=>{let{from:t,to:s}=l;return t=Math.max(t,this.options.timeFrom),s=Math.min(s,this.options.timeTo),{...l,height:(s-t)*this.timeScale,top:(t-this.options.timeFrom)*this.timeScale}})},events(){const{startDate:l,endDate:t}=this.data;let s=[];if(!(["years","year"].includes(this.view.id)&&!this.options.eventsCountOnYearView)){if(s=this.view.events.slice(0),this.view.id==="month"&&s.push(...this.view.outOfScopeEvents),s=s.filter(o=>this.utils.event.eventInRange(o,l,t)),this.options.showAllDayEvents&&this.view.id!=="month"&&(s=s.filter(o=>!!o.allDay===this.allDay)),this.options.time&&this.isWeekOrDayView&&!this.allDay){const{timeFrom:o,timeTo:i}=this.options;s=s.filter(a=>{const u=a.daysCount>1&&a.segments[this.data.formattedDate]||{},r=a.daysCount===1&&a.startTimeMinutes<i&&a.endTimeMinutes>o,m=a.daysCount>1&&u.startTimeMinutes<i&&u.endTimeMinutes>o;return a.allDay||r||m||!1})}this.options.time&&this.isWeekOrDayView&&!(this.options.showAllDayEvents&&this.allDay)&&s.sort((o,i)=>o.start<i.start?-1:1),this.cellSplits.length||this.$nextTick(this.checkCellOverlappingEvents)}return s},eventsCount(){return this.events.length},splits(){return this.cellSplits.map((l,t)=>{const s=this.events.filter(a=>a.split===l.id),[o,i]=this.utils.event.checkCellOverlappingEvents(s.filter(a=>!a.background&&!a.allDay),this.options);return{...l,overlaps:o,overlapsStreak:i,events:s}})},splitsCount(){return this.splits.length},cellClasses(){return{[this.data.class]:!!this.data.class,"vuecal__cell--current":this.data.current,"vuecal__cell--today":this.data.today,"vuecal__cell--out-of-scope":this.data.outOfScope,"vuecal__cell--before-min":this.isDisabled&&this.isBeforeMinDate,"vuecal__cell--after-max":this.isDisabled&&this.isAfterMaxDate,"vuecal__cell--disabled":this.isDisabled,"vuecal__cell--selected":this.isSelected,"vuecal__cell--highlighted":this.highlighted,"vuecal__cell--has-splits":this.splitsCount,"vuecal__cell--has-events":this.eventsCount}},cellStyles(){return{...this.cellWidth?{width:`${this.cellWidth}%`}:{}}},timelineVisible(){const{time:l,timeTo:t}=this.options;return this.data.today&&this.isWeekOrDayView&&l&&!this.allDay&&this.nowInMinutes<=t},todaysTimePosition(){if(!this.data.today||!this.options.time)return;const l=this.nowInMinutes-this.options.timeFrom;return Math.round(l*this.timeScale)},timeScale(){return this.options.timeCellHeight/this.options.timeStep}}},wt=Ue(dl,[["render",rl]]),ul={key:0,class:"vuecal__all-day-text",style:{width:"3em"}};function cl(l,t,s,o,i,a){const u=Te("vuecal-cell");return n(),d("div",{class:"vuecal__flex vuecal__all-day",style:xe(s.cellOrSplitMinWidth&&{height:s.height})},[s.cellOrSplitMinWidth?C("",!0):(n(),d("div",ul,[e("span",null,g(s.label),1)])),e("div",{class:Q(["vuecal__flex vuecal__cells",`${a.view.id}-view`]),grow:"",style:xe(s.cellOrSplitMinWidth?`min-width: ${s.cellOrSplitMinWidth}px`:"")},[(n(!0),d(Z,null,ee(s.cells,(r,m)=>(n(),le(u,{key:m,options:s.options,"edit-events":a.editEvents,data:r,"all-day":!0,"cell-width":s.options.hideWeekdays.length&&(a.vuecal.isWeekView||a.vuecal.isMonthView)&&a.vuecal.cellWidth,"min-timestamp":s.options.minTimestamp,"max-timestamp":s.options.maxTimestamp,"cell-splits":s.daySplits},{event:L(({event:c,view:v})=>[ie(l.$slots,"event",{view:v,event:c})]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],6)],4)}const ml={inject:["vuecal","view","editEvents"],components:{"vuecal-cell":wt},props:{options:{type:Object,required:!0},cells:{type:Array,required:!0},label:{type:String,required:!0},daySplits:{type:Array,default:()=>[]},shortEvents:{type:Boolean,default:!0},height:{type:String,default:""},cellOrSplitMinWidth:{type:Number,default:null}},computed:{hasCellOrSplitWidth(){return!!(this.options.minCellWidth||this.daySplits.length&&this.options.minSplitWidth)}}},vl=Ue(ml,[["render",cl]]),pl=["lang"],hl={class:"default"},gl={key:0,class:"vuecal__flex vuecal__body",grow:""},yl=["onBlur","innerHTML"],fl=["innerHTML"],bl=["innerHTML"],_l={class:"vuecal__flex",row:"",grow:""},wl={key:0,class:"vuecal__time-column"},xl={class:"vuecal__time-cell-label"},kl={key:1,class:"vuecal__flex vuecal__week-numbers",column:""},Dl=["wrap","column"],Cl=["onBlur","innerHTML"],$l=["innerHTML"],Sl=["innerHTML"],El=["wrap"],Ml=["innerHTML"],Tl=["innerHTML"],jl={key:2,class:"vuecal__cell-events-count"},Vl={key:3,class:"vuecal__no-event"},Al=["onBlur","innerHTML"],Il=["innerHTML"],Ol={key:2,class:"vuecal__event-time"},Ll={key:0},Ul={key:1,class:"days-to-end"},Nl=["innerHTML"],Pl={key:0,class:"vuecal__scrollbar-check"};function Rl(l,t,s,o,i,a){const u=Te("vuecal-header"),r=Te("all-day-bar"),m=Te("weekdays-headings"),c=Te("vuecal-cell");return n(),d("div",{class:Q(["vuecal__flex vuecal",a.cssClasses]),column:"",ref:"vuecal",lang:s.locale},[p(u,{options:l.$props,"edit-events":a.editEvents,"view-props":{views:a.views,weekDaysInHeader:a.weekDaysInHeader},"week-days":a.weekDays,"has-splits":a.hasSplits,"day-splits":a.daySplits,"switch-to-narrower-view":a.switchToNarrowerView},Xe({"arrow-prev":L(()=>[ie(l.$slots,"arrow-prev",{},()=>[t[0]||(t[0]=R(" ")),t[1]||(t[1]=e("i",{class:"angle"},null,-1)),t[2]||(t[2]=R(" "))])]),"arrow-next":L(()=>[ie(l.$slots,"arrow-next",{},()=>[t[3]||(t[3]=R(" ")),t[4]||(t[4]=e("i",{class:"angle"},null,-1)),t[5]||(t[5]=R(" "))])]),"today-button":L(()=>[ie(l.$slots,"today-button",{},()=>[e("span",hl,g(i.texts.today),1)])]),title:L(()=>[ie(l.$slots,"title",{title:a.viewTitle,view:i.view},()=>[R(g(a.viewTitle),1)])]),_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:L(({heading:v,view:y})=>[ie(l.$slots,"weekday-heading",{heading:v,view:y})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:L(({split:v})=>[ie(l.$slots,"split-label",{split:v,view:i.view.id})]),key:"1"}:void 0]),1032,["options","edit-events","view-props","week-days","has-splits","day-splits","switch-to-narrower-view"]),s.hideBody?C("",!0):(n(),d("div",gl,[p(ze,{name:`slide-fade--${i.transitionDirection}`,appear:s.transitions},{default:L(()=>[(n(),d("div",{class:"vuecal__flex",style:{"min-width":"100%"},key:s.transitions?i.view.id:!1,column:""},[s.showAllDayEvents&&a.hasTimeColumn&&(!a.cellOrSplitMinWidth||a.isDayView&&!s.minSplitWidth)?(n(),le(r,ut(ct({key:0},a.allDayBar)),{event:L(({event:v,view:y})=>[ie(l.$slots,"event",{view:y,event:v},()=>[a.editEvents.title&&v.titleEditable?(n(),d("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:_=>a.onEventTitleBlur(_,v),innerHTML:v.title},null,40,yl)):v.title?(n(),d("div",{key:1,class:"vuecal__event-title",innerHTML:v.title},null,8,fl)):C("",!0),v.content&&!a.hasShortEvents&&!a.isShortMonthView?(n(),d("div",{key:2,class:"vuecal__event-content",innerHTML:v.content},null,8,bl)):C("",!0)])]),_:3},16)):C("",!0),e("div",{class:Q(["vuecal__bg",{vuecal__flex:!a.hasTimeColumn}]),column:""},[e("div",_l,[a.hasTimeColumn?(n(),d("div",wl,[s.showAllDayEvents&&a.cellOrSplitMinWidth&&!(a.isDayView&&!s.minSplitWidth)?(n(),d("div",{key:0,class:"vuecal__all-day-text",style:xe({height:a.allDayBar.height})},[e("span",null,g(i.texts.allDay),1)],4)):C("",!0),(n(!0),d(Z,null,ee(a.timeCells,(v,y)=>(n(),d("div",{class:"vuecal__time-cell",key:y,style:xe(`height: ${s.timeCellHeight}px`)},[ie(l.$slots,"time-cell",{hours:v.hours,minutes:v.minutes},()=>[t[6]||(t[6]=e("span",{class:"vuecal__time-cell-line"},null,-1)),e("span",xl,g(v.label),1)])],4))),128))])):C("",!0),s.showWeekNumbers&&a.isMonthView?(n(),d("div",kl,[(n(),d(Z,null,ee(6,v=>e("div",{class:"vuecal__flex vuecal__week-number-cell",key:v,grow:""},[ie(l.$slots,"week-number-cell",{week:a.getWeekNumber(v-1)},()=>[R(g(a.getWeekNumber(v-1)),1)])])),64))])):C("",!0),e("div",{class:Q(["vuecal__flex vuecal__cells",`${i.view.id}-view`]),grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,column:!!a.cellOrSplitMinWidth},[a.cellOrSplitMinWidth&&a.isWeekView?(n(),le(m,{key:0,"transition-direction":i.transitionDirection,"week-days":a.weekDays,"switch-to-narrower-view":a.switchToNarrowerView,style:xe(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},Xe({_:2},[l.$slots["weekday-heading"]?{name:"weekday-heading",fn:L(({heading:v,view:y})=>[ie(l.$slots,"weekday-heading",{heading:v,view:y})]),key:"0"}:void 0,l.$slots["split-label"]?{name:"split-label",fn:L(({split:v})=>[ie(l.$slots,"split-label",{split:v,view:i.view.id})]),key:"1"}:void 0]),1032,["transition-direction","week-days","switch-to-narrower-view","style"])):a.hasSplits&&s.stickySplitLabels&&s.minSplitWidth?(n(),d("div",{key:1,class:"vuecal__flex vuecal__split-days-headers",style:xe(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(n(!0),d(Z,null,ee(a.daySplits,(v,y)=>(n(),d("div",{class:Q(["day-split-header",v.class||!1]),key:y},[ie(l.$slots,"split-label",{split:v,view:i.view.id},()=>[R(g(v.label),1)])],2))),128))],4)):C("",!0),s.showAllDayEvents&&a.hasTimeColumn&&(a.isWeekView&&a.cellOrSplitMinWidth||a.isDayView&&a.hasSplits&&s.minSplitWidth)?(n(),le(r,ut(ct({key:2},a.allDayBar)),{event:L(({event:v,view:y})=>[ie(l.$slots,"event",{view:y,event:v},()=>[a.editEvents.title&&v.titleEditable?(n(),d("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:_=>a.onEventTitleBlur(_,v),innerHTML:v.title},null,40,Cl)):v.title?(n(),d("div",{key:1,class:"vuecal__event-title",innerHTML:v.title},null,8,$l)):C("",!0),v.content&&!a.hasShortEvents&&!a.isShortMonthView?(n(),d("div",{key:2,class:"vuecal__event-content",innerHTML:v.content},null,8,Sl)):C("",!0)])]),_:3},16)):C("",!0),e("div",{class:"vuecal__flex",ref:v=>i.cellsEl=v,grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,style:xe(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(n(!0),d(Z,null,ee(a.viewCells,(v,y)=>(n(),le(c,{key:y,options:l.$props,"edit-events":a.editEvents,data:v,"cell-width":s.hideWeekdays.length&&(a.isWeekView||a.isMonthView)&&a.cellWidth,"min-timestamp":a.minTimestamp,"max-timestamp":a.maxTimestamp,"cell-splits":a.hasSplits&&a.daySplits||[]},{"cell-content":L(({events:_,split:k,selectCell:w})=>[ie(l.$slots,"cell-content",{cell:v,view:i.view,goNarrower:w,events:_},()=>[k&&!s.stickySplitLabels?(n(),d("div",{key:0,class:"split-label",innerHTML:k.label},null,8,Ml)):C("",!0),v.content?(n(),d("div",{key:1,class:"vuecal__cell-date",innerHTML:v.content},null,8,Tl)):C("",!0),(a.isMonthView&&!s.eventsOnMonthView||a.isYearsOrYearView&&s.eventsCountOnYearView)&&_.length?(n(),d("div",jl,[ie(l.$slots,"events-count",{view:i.view,events:_},()=>[R(g(_.length),1)])])):C("",!0),!a.cellOrSplitHasEvents(_,k)&&a.isWeekOrDayView?(n(),d("div",Vl,[ie(l.$slots,"no-event",{},()=>[R(g(i.texts.noEvent),1)])])):C("",!0)])]),event:L(({event:_,view:k})=>[ie(l.$slots,"event",{view:k,event:_},()=>[a.editEvents.title&&_.titleEditable?(n(),d("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:w=>a.onEventTitleBlur(w,_),innerHTML:_.title},null,40,Al)):_.title?(n(),d("div",{key:1,class:"vuecal__event-title",innerHTML:_.title},null,8,Il)):C("",!0),s.time&&!_.allDay&&!(a.isMonthView&&(_.allDay||s.showAllDayEvents==="short"))&&!a.isShortMonthView?(n(),d("div",Ol,[R(g(i.utils.date.formatTime(_.start,a.TimeFormat)),1),_.endTimeMinutes?(n(),d("span",Ll," - "+g(i.utils.date.formatTime(_.end,a.TimeFormat,null,!0)),1)):C("",!0),_.daysCount>1&&(_.segments[v.formattedDate]||{}).isFirstDay?(n(),d("small",Ul," +"+g(_.daysCount-1)+g((i.texts.day[0]||"").toLowerCase()),1)):C("",!0)])):C("",!0),_.content&&!(a.isMonthView&&_.allDay&&s.showAllDayEvents==="short")&&!a.isShortMonthView?(n(),d("div",{key:3,class:"vuecal__event-content",innerHTML:_.content},null,8,Nl)):C("",!0)])]),"no-event":L(()=>[ie(l.$slots,"no-event",{},()=>[R(g(i.texts.noEvent),1)])]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],12,El)],10,Dl)])],2)]))]),_:3},8,["name","appear"]),i.ready?C("",!0):(n(),d("div",Pl,t[7]||(t[7]=[e("div",null,null,-1)])))]))],10,pl)}const Fe=1440,Ye={weekDays:Array(7).fill(""),weekDaysShort:[],months:Array(12).fill(""),years:"",year:"",month:"",week:"",day:"",today:"",noEvent:"",allDay:"",deleteEvent:"",createEvent:"",dateFormat:"dddd MMMM D, YYYY",am:"am",pm:"pm"},ht=["years","year","month","week","day"],gt=new Ss(Ye),Fl={name:"vue-cal",components:{"vuecal-cell":wt,"vuecal-header":Xs,WeekdaysHeadings:_t,AllDayBar:vl},provide(){return{vuecal:this,utils:this.utils,modules:this.modules,previous:this.previous,next:this.next,switchView:this.switchView,updateSelectedDate:this.updateSelectedDate,editEvents:this.editEvents,view:this.view,domEvents:this.domEvents}},props:{activeView:{type:String,default:"week"},allDayBarHeight:{type:[String,Number],default:"25px"},cellClickHold:{type:Boolean,default:!0},cellContextmenu:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:!1},dblclickToNavigate:{type:Boolean,default:!0},disableDatePrototypes:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},disableViews:{type:Array,default:()=>[]},dragToCreateEvent:{type:Boolean,default:!0},dragToCreateThreshold:{type:Number,default:15},editableEvents:{type:[Boolean,Object],default:!1},events:{type:Array,default:()=>[]},eventsCountOnYearView:{type:Boolean,default:!1},eventsOnMonthView:{type:[Boolean,String],default:!1},hideBody:{type:Boolean,default:!1},hideTitleBar:{type:Boolean,default:!1},hideViewSelector:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:[String,Object],default:"en"},maxDate:{type:[String,Date],default:""},minCellWidth:{type:Number,default:0},minDate:{type:[String,Date],default:""},minEventWidth:{type:Number,default:0},minSplitWidth:{type:Number,default:0},onEventClick:{type:[Function,null],default:null},onEventCreate:{type:[Function,null],default:null},onEventDblclick:{type:[Function,null],default:null},overlapsPerTimeStep:{type:Boolean,default:!1},resizeX:{type:Boolean,default:!1},selectedDate:{type:[String,Date],default:""},showAllDayEvents:{type:[Boolean,String],default:!1},showTimeInCells:{type:Boolean,default:!1},showWeekNumbers:{type:[Boolean,String],default:!1},snapToTime:{type:Number,default:0},small:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},splitDays:{type:Array,default:()=>[]},startWeekOnSunday:{type:Boolean,default:!1},stickySplitLabels:{type:Boolean,default:!1},time:{type:Boolean,default:!0},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:Fe},todayButton:{type:Boolean,default:!1},transitions:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},watchRealTime:{type:Boolean,default:!1},xsmall:{type:Boolean,default:!1}},data(){return{ready:!1,texts:{...Ye},utils:{date:(this.disableDatePrototypes?gt.removePrototypes():!1)||gt,cell:null,event:null},modules:{dnd:null},cellsEl:null,view:{id:"",title:"",startDate:null,endDate:null,firstCellDate:null,lastCellDate:null,selectedDate:null,events:[]},eventIdIncrement:1,now:new Date,timeTickerIds:[null,null],domEvents:{resizeAnEvent:{_eid:null,start:null,split:null,segment:null,originalEndTimeMinutes:0,originalEnd:null,end:null,startCell:null,endCell:null},dragAnEvent:{_eid:null},dragCreateAnEvent:{startCursorY:null,start:null,split:null,event:null},focusAnEvent:{_eid:null,mousedUp:!1},clickHoldAnEvent:{_eid:null,timeout:1200,timeoutId:null},dblTapACell:{taps:0,timeout:500},clickHoldACell:{cellId:null,split:null,timeout:1200,timeoutId:null,eventCreated:!1},cancelClickEventCreation:!1},mutableEvents:[],transitionDirection:"right"}},methods:{async loadLocale(l){if(typeof this.locale=="object"){this.texts=Object.assign({},Ye,l),this.utils.date.updateTexts(this.texts);return}const t=await $s(Object.assign({"./i18n/ar.json":()=>se(()=>import("./ar.es-bitOgb9K.js"),[]),"./i18n/bg.json":()=>se(()=>import("./bg.es-5tp0KQRo.js"),[]),"./i18n/bn.json":()=>se(()=>import("./bn.es-C_qR0y0-.js"),[]),"./i18n/bs.json":()=>se(()=>import("./bs.es-DduooXS8.js"),[]),"./i18n/ca.json":()=>se(()=>import("./ca.es-DYDNDJFJ.js"),[]),"./i18n/cs.json":()=>se(()=>import("./cs.es-CvnAvfoI.js"),[]),"./i18n/da.json":()=>se(()=>import("./da.es-C_eJXDX3.js"),[]),"./i18n/de.json":()=>se(()=>import("./de.es-Cp-R9E16.js"),[]),"./i18n/el.json":()=>se(()=>import("./el.es-BZ44a1Tb.js"),[]),"./i18n/en.json":()=>se(()=>import("./en.es-DwVNOttH.js"),[]),"./i18n/es.json":()=>se(()=>import("./es.es-DO8PaQ_q.js"),[]),"./i18n/et.json":()=>se(()=>import("./et.es-DdRIcUrz.js"),[]),"./i18n/fa.json":()=>se(()=>import("./fa.es-XN0av8Tx.js"),[]),"./i18n/fi.json":()=>se(()=>import("./fi.es-B0Iy6aas.js"),[]),"./i18n/fr.json":()=>se(()=>import("./fr.es-B7WXlprl.js"),[]),"./i18n/he.json":()=>se(()=>import("./he.es-BWEk5prp.js"),[]),"./i18n/hr.json":()=>se(()=>import("./hr.es-B_iqHQyr.js"),[]),"./i18n/hu.json":()=>se(()=>import("./hu.es-D_t4Ibxf.js"),[]),"./i18n/id.json":()=>se(()=>import("./id.es-CzHAK-XV.js"),[]),"./i18n/is.json":()=>se(()=>import("./is.es-DChRpym4.js"),[]),"./i18n/it.json":()=>se(()=>import("./it.es-CquQA5xx.js"),[]),"./i18n/ja.json":()=>se(()=>import("./ja.es-B19gsG6H.js"),[]),"./i18n/ka.json":()=>se(()=>import("./ka.es-CuOe65jc.js"),[]),"./i18n/ko.json":()=>se(()=>import("./ko.es-CsMl2USK.js"),[]),"./i18n/lt.json":()=>se(()=>import("./lt.es-vqgjGyMx.js"),[]),"./i18n/mn.json":()=>se(()=>import("./mn.es-BmdwFdas.js"),[]),"./i18n/nl.json":()=>se(()=>import("./nl.es-CFxVMCWy.js"),[]),"./i18n/no.json":()=>se(()=>import("./no.es-qRcuRMwl.js"),[]),"./i18n/pl.json":()=>se(()=>import("./pl.es-BQ3a0ltx.js"),[]),"./i18n/pt-br.json":()=>se(()=>import("./pt-br.es-U9bVHsgs.js"),[]),"./i18n/pt-pt.json":()=>se(()=>import("./pt-pt.es-U9bVHsgs.js"),[]),"./i18n/ro.json":()=>se(()=>import("./ro.es-ldjMjt3l.js"),[]),"./i18n/ru.json":()=>se(()=>import("./ru.es-CS-QKsYL.js"),[]),"./i18n/sk.json":()=>se(()=>import("./sk.es-CAe8sEvL.js"),[]),"./i18n/sl.json":()=>se(()=>import("./sl.es-rdzOxu_X.js"),[]),"./i18n/sq.json":()=>se(()=>import("./sq.es-BY5E06HI.js"),[]),"./i18n/sr.json":()=>se(()=>import("./sr.es-QPseRVBy.js"),[]),"./i18n/sv.json":()=>se(()=>import("./sv.es-BfPUYcV1.js"),[]),"./i18n/tr.json":()=>se(()=>import("./tr.es-Cl6kz_IH.js"),[]),"./i18n/uk.json":()=>se(()=>import("./uk.es-DBEtNQnZ.js"),[]),"./i18n/vi.json":()=>se(()=>import("./vi.es-Bx2g_1jx.js"),[]),"./i18n/zh-cn.json":()=>se(()=>import("./zh-cn.es-BWMmCH-R.js"),[]),"./i18n/zh-hk.json":()=>se(()=>import("./zh-hk.es-DFZ0bKvi.js"),[])}),`./i18n/${l}.json`,3);this.texts=Object.assign({},Ye,t),this.utils.date.updateTexts(this.texts)},loadDragAndDrop(){se(()=>import("./drag-and-drop.es-CbCm7IHa.js"),[]).then(l=>{const{DragAndDrop:t}=l;this.modules.dnd=new t(this)}).catch(()=>console.warn("Vue Cal: Missing drag & drop module."))},validateView(l){return ht.includes(l)||(console.error(`Vue Cal: invalid active-view parameter provided: "${l}".
A valid view must be one of: ${ht.join(", ")}.`),l="week"),this.enabledViews.includes(l)||(console.warn(`Vue Cal: the provided active-view "${l}" is disabled. Using the "${this.enabledViews[0]}" view instead.`),l=this.enabledViews[0]),l},switchToNarrowerView(l=null){this.transitionDirection="right";const t=this.enabledViews[this.enabledViews.indexOf(this.view.id)+1];t&&this.switchView(t,l)},switchView(l,t=null,s=!1){l=this.validateView(l);const o=this.utils.date,i=this.view.startDate&&this.view.startDate.getTime();if(this.transitions&&s){if(this.view.id===l)return;const r=this.enabledViews;this.transitionDirection=r.indexOf(this.view.id)>r.indexOf(l)?"left":"right"}const a=this.view.id;switch(this.view.events=[],this.view.id=l,this.view.firstCellDate=null,this.view.lastCellDate=null,t||(t=this.view.selectedDate||this.view.startDate),l){case"years":{this.view.startDate=new Date(Math.floor(t.getFullYear()/25)*25||2e3,0,1),this.view.endDate=new Date(this.view.startDate.getFullYear()+25,0,1),this.view.endDate.setSeconds(-1);break}case"year":{this.view.startDate=new Date(t.getFullYear(),0,1),this.view.endDate=new Date(t.getFullYear()+1,0,1),this.view.endDate.setSeconds(-1);break}case"month":{this.view.startDate=new Date(t.getFullYear(),t.getMonth(),1),this.view.endDate=new Date(t.getFullYear(),t.getMonth()+1,1),this.view.endDate.setSeconds(-1);let r=new Date(this.view.startDate);if(r.getDay()!==(this.startWeekOnSunday?0:1)&&(r=o.getPreviousFirstDayOfWeek(r,this.startWeekOnSunday)),this.view.firstCellDate=r,this.view.lastCellDate=o.addDays(r,41),this.view.lastCellDate.setHours(23,59,59,0),this.hideWeekends){if([0,6].includes(this.view.firstCellDate.getDay())){const m=this.view.firstCellDate.getDay()===6&&!this.startWeekOnSunday?2:1;this.view.firstCellDate=o.addDays(this.view.firstCellDate,m)}if([0,6].includes(this.view.startDate.getDay())){const m=this.view.startDate.getDay()===6?2:1;this.view.startDate=o.addDays(this.view.startDate,m)}if([0,6].includes(this.view.lastCellDate.getDay())){const m=this.view.lastCellDate.getDay()===0&&!this.startWeekOnSunday?2:1;this.view.lastCellDate=o.subtractDays(this.view.lastCellDate,m)}if([0,6].includes(this.view.endDate.getDay())){const m=this.view.endDate.getDay()===0?2:1;this.view.endDate=o.subtractDays(this.view.endDate,m)}}break}case"week":{t=o.getPreviousFirstDayOfWeek(t,this.startWeekOnSunday);const r=this.hideWeekends?5:7;this.view.startDate=this.hideWeekends&&this.startWeekOnSunday?o.addDays(t,1):t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=o.addDays(t,r),this.view.endDate.setSeconds(-1);break}case"day":{this.view.startDate=t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=new Date(t),this.view.endDate.setHours(23,59,59,0);break}}this.addEventsToView();const u=this.view.startDate&&this.view.startDate.getTime();if(!(a===l&&u===i)&&(this.$emit("update:activeView",l),this.ready)){const r=this.view.startDate,m={view:l,startDate:r,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate,outOfScopeEvents:this.view.outOfScopeEvents.map(this.cleanupEvent)}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:o.getWeek(this.startWeekOnSunday?o.addDays(r,1):r)}:{}};this.$emit("view-change",m)}},previous(){this.previousNext(!1)},next(){this.previousNext()},previousNext(l=!0){const t=this.utils.date;this.transitionDirection=l?"right":"left";const s=l?1:-1;let o=null;const{startDate:i,id:a}=this.view;switch(a){case"years":o=new Date(i.getFullYear()+25*s,0,1);break;case"year":o=new Date(i.getFullYear()+1*s,1,1);break;case"month":o=new Date(i.getFullYear(),i.getMonth()+1*s,1);break;case"week":o=t[l?"addDays":"subtractDays"](t.getPreviousFirstDayOfWeek(i,this.startWeekOnSunday),7);break;case"day":o=t[l?"addDays":"subtractDays"](i,1);const u=o.getDay(),r=this.startWeekOnSunday?u:(u||7)-1;if(this.weekDays[r].hide){const c=this.weekDays.map((y,_)=>({...y,i:_}));let v=0;l?([...c.slice(r),...c].find(y=>(v++,!y.hide)).i,v--):[...c,...c.slice(0,r)].reverse().find(y=>(v++,!y.hide)).i,o=t[l?"addDays":"subtractDays"](o,v)}break}o&&this.switchView(a,o)},addEventsToView(l=[]){const t=this.utils.event,{startDate:s,endDate:o,firstCellDate:i,lastCellDate:a}=this.view;if(l.length||(this.view.events=[]),l=l.length?l:[...this.mutableEvents],!l||this.isYearsOrYearView&&!this.eventsCountOnYearView)return;let u=l.filter(r=>t.eventInRange(r,s,o));!this.isYearsOrYearView&&!(this.isMonthView&&!this.eventsOnMonthView)&&(u=u.map(r=>r.daysCount>1?t.createEventSegments(r,i||s,a||o):r)),this.view.events.push(...u),this.isMonthView&&(this.view.outOfScopeEvents=[],l.forEach(r=>{(t.eventInRange(r,i,s)||t.eventInRange(r,o,a))&&(this.view.events.some(m=>m._eid===r._eid)||this.view.outOfScopeEvents.push(r))}))},findAncestor(l,t){for(;(l=l.parentElement)&&!l.classList.contains(t););return l},isDOMElementAnEvent(l){return l.classList.contains("vuecal__event")||this.findAncestor(l,"vuecal__event")},onMouseMove(l){const{resizeAnEvent:t,dragAnEvent:s,dragCreateAnEvent:o}=this.domEvents;t._eid===null&&s._eid===null&&!o.start||(l.preventDefault(),t._eid?this.eventResizing(l):this.dragToCreateEvent&&o.start&&this.eventDragCreation(l))},onMouseUp(l){const{focusAnEvent:t,resizeAnEvent:s,clickHoldAnEvent:o,clickHoldACell:i,dragCreateAnEvent:a}=this.domEvents,{_eid:u}=o,{_eid:r}=s;let m=!1;const{event:c,start:v}=a,y=this.isDOMElementAnEvent(l.target),_=t.mousedUp;if(t.mousedUp=!1,y&&(this.domEvents.cancelClickEventCreation=!0),i.eventCreated)return;if(r){const{originalEnd:w,originalEndTimeMinutes:E,endTimeMinutes:f}=s,h=this.view.events.find(T=>T._eid===s._eid);if(m=f&&f!==E,h&&h.end.getTime()!==w.getTime()){const T=this.mutableEvents.find(I=>I._eid===s._eid);T.endTimeMinutes=h.endTimeMinutes,T.end=h.end;const A=this.cleanupEvent(h),N={...this.cleanupEvent(h),end:w,endTimeMinutes:h.originalEndTimeMinutes};this.$emit("event-duration-change",{event:A,oldDate:s.originalEnd,originalEvent:N}),this.$emit("event-change",{event:A,originalEvent:N})}h&&(h.resizing=!1),s._eid=null,s.start=null,s.split=null,s.segment=null,s.originalEndTimeMinutes=null,s.originalEnd=null,s.endTimeMinutes=null,s.startCell=null,s.endCell=null}else v&&(c&&(this.emitWithEvent("event-drag-create",c),a.event.resizing=!1),a.start=null,a.split=null,a.event=null);!y&&!r&&this.unfocusEvent(),o.timeoutId&&!u&&(clearTimeout(o.timeoutId),o.timeoutId=null),i.timeoutId&&(clearTimeout(i.timeoutId),i.timeoutId=null);const k=typeof this.onEventClick=="function";if(_&&!m&&!u&&!c&&k){let w=this.view.events.find(E=>E._eid===t._eid);return!w&&this.isMonthView&&(w=this.view.outOfScopeEvents.find(E=>E._eid===t._eid)),w&&this.onEventClick(w,l)}},onKeyUp(l){l.keyCode===27&&this.cancelDelete()},eventResizing(l){const{resizeAnEvent:t}=this.domEvents,s=this.view.events.find(c=>c._eid===t._eid)||{segments:{}},{minutes:o,cursorCoords:i}=this.minutesAtCursor(l),a=s.segments&&s.segments[t.segment],{date:u,event:r}=this.utils,m=Math.max(o,this.timeFrom+1,(a||s).startTimeMinutes+1);if(s.endTimeMinutes=t.endTimeMinutes=m,this.snapToTime){const c=s.endTimeMinutes+this.snapToTime/2;s.endTimeMinutes=c-c%this.snapToTime}if(a&&(a.endTimeMinutes=s.endTimeMinutes),s.end.setHours(0,s.endTimeMinutes,s.endTimeMinutes===Fe?-1:0,0),this.resizeX&&this.isWeekView){s.daysCount=u.countDays(s.start,s.end);const c=this.cellsEl,v=c.offsetWidth/c.childElementCount,y=Math.floor(i.x/v);if(t.startCell===null&&(t.startCell=y-(s.daysCount-1)),t.endCell!==y){t.endCell=y;const _=u.addDays(s.start,y-t.startCell),k=Math.max(u.countDays(s.start,_),1);if(k!==s.daysCount){let w=null;k>s.daysCount?w=r.addEventSegment(s):w=r.removeEventSegment(s),t.segment=w,s.endTimeMinutes+=.001}}}this.$emit("event-resizing",{_eid:s._eid,end:s.end,endTimeMinutes:s.endTimeMinutes})},eventDragCreation(l){const{dragCreateAnEvent:t}=this.domEvents,{start:s,startCursorY:o,split:i}=t,a=new Date(s),{minutes:u,cursorCoords:{y:r}}=this.minutesAtCursor(l);if(!(!t.event&&Math.abs(o-r)<this.dragToCreateThreshold))if(t.event){if(a.setHours(0,u,u===Fe?-1:0,0),this.snapToTime){let v=a.getHours()*60+a.getMinutes();const y=v+this.snapToTime/2;v=y-y%this.snapToTime,a.setHours(0,v,0,0)}const m=s<a,{event:c}=t;c.start=m?s:a,c.end=m?a:s,c.startTimeMinutes=c.start.getHours()*60+c.start.getMinutes(),c.endTimeMinutes=c.end.getHours()*60+c.end.getMinutes()}else{if(t.event=this.utils.event.createAnEvent(s,1,{split:i}),!t.event){t.start=null,t.split=null,t.event=null;return}t.event.resizing=!0}},unfocusEvent(){const{focusAnEvent:l,clickHoldAnEvent:t}=this.domEvents,s=this.view.events.find(o=>o._eid===(l._eid||t._eid));l._eid=null,t._eid=null,s&&(s.focused=!1,s.deleting=!1)},cancelDelete(){const{clickHoldAnEvent:l}=this.domEvents;if(l._eid){const t=this.view.events.find(s=>s._eid===l._eid);t&&(t.deleting=!1),l._eid=null,l.timeoutId=null}},onEventTitleBlur(l,t){if(t.title===l.target.innerHTML)return;const s=t.title;t.title=l.target.innerHTML;const o=this.cleanupEvent(t);this.$emit("event-title-change",{event:o,oldTitle:s}),this.$emit("event-change",{event:o,originalEvent:{...o,title:s}})},updateMutableEvents(){const l=this.utils.date;this.mutableEvents=[],this.events.forEach(t=>{const s=typeof t.start=="string"?l.stringToDate(t.start):t.start,o=l.formatDateLite(s),i=l.dateToMinutes(s);let a=null;typeof t.end=="string"&&t.end.includes("24:00")?(a=new Date(t.end.replace(" 24:00","")),a.setHours(23,59,59,0)):a=typeof t.end=="string"?l.stringToDate(t.end):t.end;let u=l.formatDateLite(a),r=l.dateToMinutes(a);(!r||r===Fe)&&(!this.time||typeof t.end=="string"&&t.end.length===10?a.setHours(23,59,59,0):a.setSeconds(a.getSeconds()-1),u=l.formatDateLite(a),r=Fe);const m=o!==u;t=Object.assign({...this.utils.event.eventDefaults},t,{_eid:`${this._.uid}_${this.eventIdIncrement++}`,segments:m?{}:null,start:s,startTimeMinutes:i,end:a,endTimeMinutes:r,daysCount:m?l.countDays(s,a):1,class:t.class}),this.mutableEvents.push(t)})},minutesAtCursor(l){return this.utils.cell.minutesAtCursor(l)},createEvent(l,t,s={}){return this.utils.event.createAnEvent(l,t,s)},cleanupEvent(l){return l={...l},["segments","deletable","deleting","titleEditable","resizable","resizing","draggable","dragging","draggingStatic","focused"].forEach(s=>{s in l&&delete l[s]}),l.repeat||delete l.repeat,l},emitWithEvent(l,t){this.$emit(l,this.cleanupEvent(t))},updateSelectedDate(l){if(l&&typeof l=="string"?l=this.utils.date.stringToDate(l):l=new Date(l),l&&l instanceof Date){const{selectedDate:t}=this.view;t&&(this.transitionDirection=t.getTime()>l.getTime()?"left":"right"),l.setHours(0,0,0,0),(!t||t.getTime()!==l.getTime())&&(this.view.selectedDate=l),this.switchView(this.view.id)}this.$emit("update:selected-date",this.view.selectedDate)},getWeekNumber(l){const t=this.utils.date,o=this.firstCellDateWeekNumber+l,i=this.startWeekOnSunday?1:0;return o>52?t.getWeek(t.addDays(this.view.firstCellDate,7*l+i)):o},timeTick(){this.now=new Date,this.timeTickerIds[1]=setTimeout(this.timeTick,60*1e3)},updateDateTexts(){this.utils.date.updateTexts(this.texts)},alignWithScrollbar(){if(document.getElementById("vuecal-align-with-scrollbar"))return;const l=this.$refs.vuecal.getElementsByClassName("vuecal__scrollbar-check")[0],t=l.offsetWidth-l.children[0].offsetWidth;if(t){const s=document.createElement("style");s.id="vuecal-align-with-scrollbar",s.type="text/css",s.innerHTML=`.vuecal--view-with-time .vuecal__weekdays-headings,.vuecal--view-with-time .vuecal__all-day {padding-right: ${t}px}`,document.head.appendChild(s)}},cellOrSplitHasEvents(l,t=null){return l.length&&(!t&&l.length||t&&l.some(s=>s.split===t.id))}},created(){this.utils.cell=new Ms(this),this.utils.event=new js(this,this.utils.date),this.loadLocale(this.locale),this.editEvents.drag&&this.loadDragAndDrop(),this.updateMutableEvents(this.events),this.view.id=this.currentView,this.selectedDate?this.updateSelectedDate(this.selectedDate):(this.view.selectedDate=new Date,this.switchView(this.currentView)),this.time&&this.watchRealTime&&(this.timeTickerIds[0]=setTimeout(this.timeTick,(60-this.now.getSeconds())*1e3))},mounted(){const l=this.utils.date,t="ontouchstart"in window,{resize:s,drag:o,create:i,delete:a,title:u}=this.editEvents,r=this.onEventClick&&typeof this.onEventClick=="function";(s||o||i||a||u||r)&&window.addEventListener(t?"touchend":"mouseup",this.onMouseUp),(s||o||i&&this.dragToCreateEvent)&&window.addEventListener(t?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),u&&window.addEventListener("keyup",this.onKeyUp),t&&(this.$refs.vuecal.oncontextmenu=function(v){v.preventDefault(),v.stopPropagation()}),this.hideBody||this.alignWithScrollbar();const m=this.view.startDate,c={view:this.view.id,startDate:m,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:l.getWeek(this.startWeekOnSunday?l.addDays(m,1):m)}:{}};this.$emit("ready",c),this.ready=!0},beforeUnmount(){const l="ontouchstart"in window;window.removeEventListener(l?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),window.removeEventListener(l?"touchend":"mouseup",this.onMouseUp),window.removeEventListener("keyup",this.onKeyUp),this.timeTickerIds[0]&&clearTimeout(this.timeTickerIds[0]),this.timeTickerIds[1]&&clearTimeout(this.timeTickerIds[1]),this.timeTickerIds=[null,null]},computed:{editEvents(){return this.editableEvents&&typeof this.editableEvents=="object"?{title:!!this.editableEvents.title,drag:!!this.editableEvents.drag,resize:!!this.editableEvents.resize,create:!!this.editableEvents.create,delete:!!this.editableEvents.delete}:{title:!!this.editableEvents,drag:!!this.editableEvents,resize:!!this.editableEvents,create:!!this.editableEvents,delete:!!this.editableEvents}},views(){return{years:{label:this.texts.years,enabled:!this.disableViews.includes("years")},year:{label:this.texts.year,enabled:!this.disableViews.includes("year")},month:{label:this.texts.month,enabled:!this.disableViews.includes("month")},week:{label:this.texts.week,enabled:!this.disableViews.includes("week")},day:{label:this.texts.day,enabled:!this.disableViews.includes("day")}}},currentView(){return this.validateView(this.activeView)},enabledViews(){return Object.keys(this.views).filter(l=>this.views[l].enabled)},hasTimeColumn(){return this.time&&this.isWeekOrDayView},isShortMonthView(){return this.isMonthView&&this.eventsOnMonthView==="short"},firstCellDateWeekNumber(){const l=this.utils.date,t=this.view.firstCellDate;return l.getWeek(this.startWeekOnSunday?l.addDays(t,1):t)},timeCells(){const l=[];for(let t=this.timeFrom,s=this.timeTo;t<s;t+=this.timeStep)l.push({hours:Math.floor(t/60),minutes:t%60,label:this.utils.date.formatTime(t,this.TimeFormat),value:t});return l},TimeFormat(){return this.timeFormat||(this.twelveHour?"h:mm{am}":"HH:mm")},daySplits(){return(this.splitDays.filter(l=>!l.hide)||[]).map((l,t)=>({...l,id:l.id||t+1}))},hasSplits(){return this.daySplits.length&&this.isWeekOrDayView},hasShortEvents(){return this.showAllDayEvents==="short"},cellOrSplitMinWidth(){let l=null;return this.hasSplits&&this.minSplitWidth?l=this.visibleDaysCount*this.minSplitWidth*this.daySplits.length:this.minCellWidth&&this.isWeekView&&(l=this.visibleDaysCount*this.minCellWidth),l},allDayBar(){let l=this.allDayBarHeight||null;return l&&!isNaN(l)&&(l+="px"),{cells:this.viewCells,options:this.$props,label:this.texts.allDay,shortEvents:this.hasShortEvents,daySplits:this.hasSplits&&this.daySplits||[],cellOrSplitMinWidth:this.cellOrSplitMinWidth,height:l}},minTimestamp(){let l=null;return this.minDate&&typeof this.minDate=="string"?l=this.utils.date.stringToDate(this.minDate):this.minDate&&this.minDate instanceof Date&&(l=this.minDate),l?l.getTime():null},maxTimestamp(){let l=null;return this.maxDate&&typeof this.maxDate=="string"?l=this.utils.date.stringToDate(this.maxDate):this.maxDate&&this.maxDate instanceof Date&&(l=this.maxDate),l?l.getTime():null},weekDays(){let{weekDays:l,weekDaysShort:t=[]}=this.texts;return l=l.slice(0).map((s,o)=>({label:s,...t.length?{short:t[o]}:{},hide:this.hideWeekends&&o>=5||this.hideWeekdays.length&&this.hideWeekdays.includes(o+1)})),this.startWeekOnSunday&&l.unshift(l.pop()),l},weekDaysInHeader(){return this.isMonthView||this.isWeekView&&!this.minCellWidth&&!(this.hasSplits&&this.minSplitWidth)},months(){return this.texts.months.map(l=>({label:l}))},specialDayHours(){return!this.specialHours||!Object.keys(this.specialHours).length?{}:Array(7).fill("").map((l,t)=>{let s=this.specialHours[t+1]||[];return Array.isArray(s)||(s=[s]),l=[],s.forEach(({from:o,to:i,class:a,label:u},r)=>{l[r]={day:t+1,from:[null,void 0].includes(o)?null:o*1,to:[null,void 0].includes(i)?null:i*1,class:a||"",label:u||""}}),l})},viewTitle(){const l=this.utils.date;let t="";const s=this.view.startDate,o=s.getFullYear(),i=s.getMonth();switch(this.view.id){case"years":{t=this.texts.years;break}case"year":{t=o;break}case"month":{t=`${this.months[i].label} ${o}`;break}case"week":{const a=this.view.endDate,u=s.getFullYear();let r=this.texts.months[s.getMonth()];this.xsmall&&(r=r.substring(0,3));let m=`${r} ${u}`;if(a.getMonth()!==s.getMonth()){const c=a.getFullYear();let v=this.texts.months[a.getMonth()];this.xsmall&&(v=v.substring(0,3)),u===c?m=`${r} - ${v} ${u}`:this.small?m=`${r.substring(0,3)} ${u} - ${v.substring(0,3)} ${c}`:m=`${r} ${u} - ${v} ${c}`}t=`${this.texts.week} ${l.getWeek(this.startWeekOnSunday?l.addDays(s,1):s)} (${m})`;break}case"day":{t=this.utils.date.formatDate(s,this.texts.dateFormat,this.texts);break}}return t},viewCells(){const l=this.utils.date;let t=[],s=null,o=!1;this.watchRealTime||(this.now=new Date);const i=this.now;switch(this.view.id){case"years":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(25)).map((a,u)=>{const r=new Date(s+u,0,1),m=new Date(s+u+1,0,1);return m.setSeconds(-1),{startDate:r,formattedDate:l.formatDateLite(r),endDate:m,content:s+u,current:s+u===i.getFullYear()}});break}case"year":{s=this.view.startDate.getFullYear(),t=Array.apply(null,Array(12)).map((a,u)=>{const r=new Date(s,u,1),m=new Date(s,u+1,1);return m.setSeconds(-1),{startDate:r,formattedDate:l.formatDateLite(r),endDate:m,content:this.xsmall?this.months[u].label.substr(0,3):this.months[u].label,current:u===i.getMonth()&&s===i.getFullYear()}});break}case"month":{const a=this.view.startDate.getMonth(),u=new Date(this.view.firstCellDate);o=!1,t=Array.apply(null,Array(42)).map((r,m)=>{const c=l.addDays(u,m),v=new Date(c);v.setHours(23,59,59,0);const y=!o&&l.isToday(c)&&!o++;return{startDate:c,formattedDate:l.formatDateLite(c),endDate:v,content:c.getDate(),today:y,outOfScope:c.getMonth()!==a,class:`vuecal__cell--day${c.getDay()||7}`}}),(this.hideWeekends||this.hideWeekdays.length)&&(t=t.filter(r=>{const m=r.startDate.getDay()||7;return!(this.hideWeekends&&m>=6||this.hideWeekdays.length&&this.hideWeekdays.includes(m))}));break}case"week":{o=!1;const a=this.view.startDate,u=this.weekDays;t=u.map((r,m)=>{const c=l.addDays(a,this.startWeekOnSunday&&this.hideWeekends?m-1:m),v=new Date(c);v.setHours(23,59,59,0);const y=(c.getDay()||7)-1;return{startDate:c,formattedDate:l.formatDateLite(c),endDate:v,today:!o&&l.isToday(c)&&!o++,specialHours:this.specialDayHours[y]||[]}}).filter((r,m)=>!u[m].hide);break}case"day":{const a=this.view.startDate,u=new Date(this.view.startDate);u.setHours(23,59,59,0);const r=(a.getDay()||7)-1;t=[{startDate:a,formattedDate:l.formatDateLite(a),endDate:u,today:l.isToday(a),specialHours:this.specialDayHours[r]||[]}];break}}return t},visibleDaysCount(){return this.isDayView?1:7-this.weekDays.reduce((l,t)=>l+t.hide,0)},cellWidth(){return 100/this.visibleDaysCount},cssClasses(){const{resizeAnEvent:l,dragAnEvent:t,dragCreateAnEvent:s}=this.domEvents;return{[`vuecal--${this.view.id}-view`]:!0,[`vuecal--${this.locale}`]:this.locale,"vuecal--no-time":!this.time,"vuecal--view-with-time":this.hasTimeColumn,"vuecal--week-numbers":this.showWeekNumbers&&this.isMonthView,"vuecal--twelve-hour":this.twelveHour,"vuecal--click-to-navigate":this.clickToNavigate,"vuecal--hide-weekends":this.hideWeekends,"vuecal--split-days":this.hasSplits,"vuecal--sticky-split-labels":this.hasSplits&&this.stickySplitLabels,"vuecal--overflow-x":this.minCellWidth&&this.isWeekView||this.hasSplits&&this.minSplitWidth,"vuecal--small":this.small,"vuecal--xsmall":this.xsmall,"vuecal--resizing-event":l._eid,"vuecal--drag-creating-event":s.event,"vuecal--dragging-event":t._eid,"vuecal--events-on-month-view":this.eventsOnMonthView,"vuecal--short-events":this.isMonthView&&this.eventsOnMonthView==="short","vuecal--has-touch":typeof window<"u"&&"ontouchstart"in window}},isYearsOrYearView(){return["years","year"].includes(this.view.id)},isYearsView(){return this.view.id==="years"},isYearView(){return this.view.id==="year"},isMonthView(){return this.view.id==="month"},isWeekOrDayView(){return["week","day"].includes(this.view.id)},isWeekView(){return this.view.id==="week"},isDayView(){return this.view.id==="day"}},watch:{events:{handler(l,t){this.updateMutableEvents(l),this.addEventsToView()},deep:!0},locale(l){this.loadLocale(l)},selectedDate(l){this.updateSelectedDate(l)},activeView(l){this.switchView(l)}}},Bl=Ue(Fl,[["render",Rl]]),Hl={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Wl={class:"flex justify-between items-center mb-4"},Yl={class:"flex gap-3"},zl={class:"flex rounded-md shadow-sm mr-3"},ql={key:0,class:"mb-4 bg-gray-50 p-4 rounded-lg"},Gl={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Kl=["value"],Jl={class:"mt-1 relative rounded-md shadow-sm"},Zl={key:1,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Xl={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md"},Ql={key:3},ea={key:0,class:"space-y-4"},ta={key:0,class:"flex justify-between"},sa={class:"flex-grow"},la={class:"text-sm text-red-500 italic"},aa={class:"flex items-center mt-1"},ia={class:"text-xs text-gray-500"},na={key:1},oa={class:"flex-grow"},ra={class:"flex justify-between items-center mb-3"},da={class:"text-sm text-gray-600 bg-blue-100 px-2 py-1 rounded-full"},ua={class:"mb-3"},ca={class:"text-sm text-gray-700 ml-6"},ma={class:"mb-3"},va={class:"text-sm text-gray-700 ml-6"},pa={class:"mb-2"},ha={class:"text-sm text-gray-700 ml-6"},ga={class:"flex items-center mt-3 pt-2 border-t border-blue-200"},ya={class:"text-xs text-gray-500"},fa={key:1,class:"text-gray-400 text-sm"},ba={key:4,class:"mt-4"},_a={class:"flex justify-between items-center mb-6"},wa={class:"text-lg font-medium text-gray-900"},xa=["innerHTML"],ka=["innerHTML"],Da={key:0,class:"mt-1 text-xs p-1 rounded bg-red-50 border-l-2 border-red-500 text-red-700"},Ca={class:"mt-6 bg-white rounded-lg shadow p-4"},$a={key:0},Sa={class:"font-medium text-gray-800 mb-2"},Ea={class:"font-medium text-blue-800"},Ma={class:"text-sm text-gray-600 mt-1"},Ta={key:1,class:"text-gray-500 text-sm"},ja={__name:"DailyStandups",props:{projectId:{type:Number,required:!0},users:{type:Array,default:()=>[]}},emits:["standupAdded"],setup(l,{emit:t}){const s=l,o=x("list"),i=x(!1),a=x(!1),u=x(""),r=x([]),m=x(""),c=ke({startDate:"",endDate:"",search:"",userId:""}),v=V=>{const M=de(V);return M.isValid()?{start:M.clone().startOf("month").format("YYYY-MM-DD"),end:M.clone().endOf("month").format("YYYY-MM-DD")}:(console.warn("getMonthRange received an invalid input, defaulting to current date:",V),{start:de().startOf("month").format("YYYY-MM-DD"),end:de().endOf("month").format("YYYY-MM-DD")})};let y=null;const _=()=>{clearTimeout(y),y=setTimeout(()=>{w()},500)},k=async()=>{a.value=!0,u.value="";try{const V=new URLSearchParams;c.startDate&&V.append("start_date",c.startDate),c.endDate&&V.append("end_date",c.endDate),c.search&&V.append("search",c.search),c.userId&&V.append("user_id",String(c.userId));const M=V.toString(),O=`/api/projects/${s.projectId}/sections/notes?type=standup${M?`&${M}`:""}`,G=await window.axios.get(O);r.value=G.data.filter(U=>U.type==="standup")}catch(V){console.error("Error fetching project standups:",V),u.value="Failed to load standups. Please try again."}finally{a.value=!1}},w=()=>{k()},E=()=>{c.search="",c.userId="",c.startDate="",c.endDate="",k()},f=()=>{m.value=de(m.value).subtract(1,"month").format("YYYY-MM-DD")},h=()=>{m.value=de(m.value).add(1,"month").format("YYYY-MM-DD")};re(()=>m.value,V=>{if(o.value==="calendar"&&V){const M=v(V);c.startDate=M.start,c.endDate=M.end,k()}}),re(()=>o.value,V=>{V==="calendar"?(c.search="",c.userId="",m.value=v(new Date).start):(c.startDate="",c.endDate="",k())});const T=P(()=>(r.value||[]).map(V=>{var G;if(!(V!=null&&V.created_at))return null;const M=de(V.created_at);if(!M.isValid())return null;const O=B(V.content);return{start:M.format("YYYY-MM-DD HH:mm"),end:M.format("YYYY-MM-DD HH:mm"),title:`${((G=V.user)==null?void 0:G.name)||"Unknown"} - Standup`,content:`Yesterday: ${O.yesterday}
Today: ${O.today}
Blockers: ${O.blockers}`,class:"standup-event",standupData:V}}).filter(Boolean));be(()=>{k()});const A=P(()=>{if(!r.value)return[];let V=[...r.value];if(c.startDate&&(V=V.filter(M=>M.created_at&&de(M.created_at).isSameOrAfter(c.startDate,"day"))),c.endDate&&(V=V.filter(M=>M.created_at&&de(M.created_at).isSameOrBefore(c.endDate,"day"))),c.userId&&(V=V.filter(M=>M.user_id===parseInt(c.userId))),c.search){const M=c.search.toLowerCase();V=V.filter(O=>O.content&&O.content!=="[Encrypted content could not be decrypted]"&&O.content.toLowerCase().includes(M))}return V.sort((M,O)=>de(O.created_at).valueOf()-de(M.created_at).valueOf())}),N=V=>{const M=de(V).day();return M>=1&&M<=5},I=V=>de(V).isBefore(de(),"day"),Y=(V,M)=>de(V).isSame(M,"day"),B=V=>{var j,b,D,$;if(!V||typeof V!="string"||V==="[Encrypted content could not be decrypted]"||V.trim()==="")return{yesterday:"N/A",today:"N/A",blockers:"N/A",date:"N/A"};const M=((j=V.match(/\*\*Yesterday:\*\* ([^\n]+)/))==null?void 0:j[1].trim())||"Nothing",O=((b=V.match(/\*\*Today:\*\* ([^\n]+)/))==null?void 0:b[1].trim())||"Nothing",G=((D=V.match(/\*\*Blockers:\*\* ([^\n]+)/))==null?void 0:D[1].trim())||"None",U=(($=V.match(/\*\*Daily Standup - ([^*]+)\*\*/))==null?void 0:$[1].trim())||de().format("L");return{yesterday:M,today:O,blockers:G,date:U}},S=P(()=>{const V={};return(r.value||[]).forEach(M=>{if(!(M!=null&&M.created_at))return;const O=de(M.created_at).format("YYYY-MM-DD");V[O]||(V[O]=[]),V[O].push(M)}),V});return(V,M)=>(n(),d("div",Hl,[e("div",Wl,[M[11]||(M[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Daily Standups",-1)),e("div",Yl,[e("div",zl,[e("button",{type:"button",onClick:M[0]||(M[0]=O=>o.value="list"),class:Q([o.value==="list"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-l-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},M[8]||(M[8]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})]),R(" List ")],-1)]),2),e("button",{type:"button",onClick:M[1]||(M[1]=O=>o.value="calendar"),class:Q([o.value==="calendar"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-r-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},M[9]||(M[9]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),R(" Calendar ")],-1)]),2)]),p(ue,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:M[2]||(M[2]=O=>i.value=!0)},{default:L(()=>M[10]||(M[10]=[R(" Submit Standup ",-1)])),_:1,__:[10]})])]),o.value==="list"?(n(),d("div",ql,[e("div",Gl,[e("div",null,[M[12]||(M[12]=e("label",{for:"standupStartDate",class:"block text-sm font-medium text-gray-700 mb-1"},"From Date",-1)),ce(e("input",{type:"date",id:"standupStartDate","onUpdate:modelValue":M[3]||(M[3]=O=>c.startDate=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:w},null,544),[[fe,c.startDate]])]),e("div",null,[M[13]||(M[13]=e("label",{for:"standupEndDate",class:"block text-sm font-medium text-gray-700 mb-1"},"To Date",-1)),ce(e("input",{type:"date",id:"standupEndDate","onUpdate:modelValue":M[4]||(M[4]=O=>c.endDate=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:w},null,544),[[fe,c.endDate]])]),e("div",null,[M[15]||(M[15]=e("label",{for:"standupUserFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),ce(e("select",{id:"standupUserFilter","onUpdate:modelValue":M[5]||(M[5]=O=>c.userId=O),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:w},[M[14]||(M[14]=e("option",{value:""},"All Users",-1)),(n(!0),d(Z,null,ee(s.users,O=>(n(),d("option",{key:O.id,value:O.id},g(O.name),9,Kl))),128))],544),[[We,c.userId]])]),e("div",null,[M[17]||(M[17]=e("label",{for:"standupSearchFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Search Content",-1)),e("div",Jl,[ce(e("input",{type:"text",id:"standupSearchFilter","onUpdate:modelValue":M[6]||(M[6]=O=>c.search=O),class:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pr-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search in standup content...",onInput:_},null,544),[[fe,c.search]]),M[16]||(M[16]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:E}," Reset Filters ")])])):C("",!0),a.value?(n(),d("div",Zl,"Loading standups...")):u.value?(n(),d("div",Xl,g(u.value),1)):o.value==="list"?(n(),d("div",Ql,[A.value.length?(n(),d("div",ea,[(n(!0),d(Z,null,ee(A.value,O=>{var G,U;return n(),d("div",{key:O.id,class:"p-4 bg-blue-50 rounded-md shadow-sm hover:bg-blue-100 transition-colors border-l-4 border-blue-500"},[O.content==="[Encrypted content could not be decrypted]"?(n(),d("div",ta,[e("div",sa,[e("p",la,[R(g(O.content),1),M[18]||(M[18]=e("span",{class:"text-xs text-red-400 block mt-1"},"(There was an issue decrypting this standup. Please contact an administrator.)",-1))]),e("div",aa,[e("p",ia,"Submitted by "+g(((G=O.user)==null?void 0:G.name)||"Unknown")+" on "+g(K(de)(O.created_at).format("L")),1)])])])):(n(),d("div",na,[e("div",oa,[e("div",ra,[M[19]||(M[19]=e("h3",{class:"text-md font-bold text-gray-800"},"Daily Standup",-1)),e("span",da,g(B(O.content).date),1)]),e("div",ua,[M[20]||(M[20]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Yesterday:")],-1)),e("p",ca,g(B(O.content).yesterday),1)]),e("div",ma,[M[21]||(M[21]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-green-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Today:")],-1)),e("p",va,g(B(O.content).today),1)]),e("div",pa,[M[22]||(M[22]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-red-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Blockers:")],-1)),e("p",ha,g(B(O.content).blockers),1)]),e("div",ga,[e("p",ya,"Submitted by "+g(((U=O.user)==null?void 0:U.name)||"Unknown")+" on "+g(K(de)(O.created_at).format("L")),1)])])]))])}),128))])):(n(),d("p",fa,"No daily standups found for the selected criteria."))])):o.value==="calendar"?(n(),d("div",ba,[e("div",_a,[e("button",{onClick:f,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},M[23]||(M[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("h3",wa,g(m.value?K(de)(m.value).format("MMMM YYYY"):"Loading..."),1),e("button",{onClick:h,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},M[24]||(M[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),p(K(Bl),{class:"vuecal--blue-theme","active-view":"month",events:T.value,"selected-date":m.value,"hide-title-bar":"","disable-views":["week","day","years","year"],twelveHour:!0,"time-from":480,"time-to":1200,"time-step":30,"events-on-month-view":"short"},{event:L(({event:O})=>[e("div",{class:"vuecal__event-title",innerHTML:O.title},null,8,xa),e("div",{class:"vuecal__event-content",innerHTML:O.content},null,8,ka)]),"cell-content":L(({view:O,date:G})=>[O.id==="month"?(n(),d(Z,{key:0},[G&&N(G)&&I(G)&&!T.value.some(U=>Y(U.start,G))?(n(),d("div",Da," No standups ")):C("",!0)],64)):C("",!0)]),_:1},8,["events","selected-date"]),M[26]||(M[26]=es('<div class="mt-4 flex items-center space-x-4 text-sm"><div class="flex items-center"><span class="inline-block w-3 h-3 bg-blue-50 border-l-2 border-blue-500 mr-1"></span><span>Standup submitted</span></div><div class="flex items-center"><span class="inline-block w-3 h-3 bg-red-50 border-l-2 border-red-500 mr-1"></span><span>Missing standup</span></div></div>',1)),e("div",Ca,[M[25]||(M[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Standups Outside Current Month View",-1)),Object.entries(S.value).some(([O])=>!K(de)(O).isSame(m.value,"month"))?(n(),d("div",$a,[(n(!0),d(Z,null,ee(Object.entries(S.value).filter(([O])=>!K(de)(O).isSame(m.value,"month")).sort((O,G)=>K(de)(O[0]).valueOf()-K(de)(G[0]).valueOf()),([O,G])=>(n(),d("div",{key:O,class:"mb-4"},[e("div",Sa,g(K(de)(O).format("dddd, MMMM Do YYYY")),1),(n(!0),d(Z,null,ee(G,U=>{var j;return n(),d("div",{key:U.id,class:"p-2 mb-2 rounded bg-blue-50 border-l-2 border-blue-500"},[e("div",Ea,g(((j=U.user)==null?void 0:j.name)||"Unknown"),1),e("div",Ma,g(K(de)(U.created_at).format("LT")),1)])}),128))]))),128))])):(n(),d("div",Ta,"No standups outside the current month view."))])])):C("",!0),p(yt,{show:i.value,onClose:M[7]||(M[7]=O=>i.value=!1),onStandupAdded:k,projectId:l.projectId},null,8,["show","projectId"])]))}},Va={class:"relative"},Aa={key:0,class:"text-gray-400 text-sm"},Ia=["onClick"],Oa=["placeholder"],La={key:0,class:"absolute z-50 w-full bg-white border border-gray-300 rounded-md shadow-lg mt-1 max-h-60 overflow-y-auto"},Ua={class:"py-1"},Na={key:0,class:"px-4 py-2 text-gray-500 text-sm"},Pa=["onClick"],Ra={__name:"CustomMultiSelect",props:{modelValue:{type:Array,default:()=>[]},options:{type:Array,default:()=>[],required:!0},placeholder:{type:String,default:"Select items"},labelKey:{type:String,default:"name"},trackBy:{type:String,default:"id"}},emits:["update:modelValue"],setup(l,{emit:t}){const s=l,o=t,i=x(!1),a=x(""),u=P(()=>{if(!a.value)return s.options;const v=a.value.toLowerCase();return s.options.filter(y=>y[s.labelKey].toLowerCase().includes(v))});re(()=>s.modelValue,v=>{},{deep:!0});const r=v=>{const y=[...s.modelValue],_=y.findIndex(k=>k===v[s.trackBy]);_===-1?y.push(v[s.trackBy]):y.splice(_,1),o("update:modelValue",y),a.value=""},m=v=>{const y=s.options.find(_=>_[s.trackBy]===v);return y?y[s.labelKey]:""},c=v=>s.modelValue.includes(v);return(v,y)=>{const _=ts("click-outside");return ce((n(),d("div",Va,[e("div",{class:"flex flex-wrap items-center w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm cursor-pointer min-h-[38px] bg-white focus-within:border-indigo-500 focus-within:ring-indigo-500",onClick:y[2]||(y[2]=k=>i.value=!i.value)},[l.modelValue.length===0&&!a.value?(n(),d("span",Aa,g(l.placeholder),1)):C("",!0),(n(!0),d(Z,null,ee(l.modelValue,k=>(n(),d("div",{key:k,class:"inline-flex items-center bg-indigo-100 text-indigo-800 text-xs font-medium px-2.5 py-0.5 rounded mr-2 mb-1"},[R(g(m(k))+" ",1),e("button",{type:"button",onClick:we(w=>r(l.options.find(E=>E[l.trackBy]===k)),["stop"]),class:"ml-1 text-indigo-800 hover:text-indigo-900 focus:outline-none"},y[3]||(y[3]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ia)]))),128)),ce(e("input",{type:"text","onUpdate:modelValue":y[0]||(y[0]=k=>a.value=k),onInput:y[1]||(y[1]=k=>i.value=!0),class:"flex-grow border-none focus:ring-0 p-0 text-sm placeholder-gray-400 bg-transparent outline-none",placeholder:l.modelValue.length===0?"Search...":""},null,40,Oa),[[fe,a.value]])]),i.value?(n(),d("div",La,[e("ul",Ua,[u.value.length===0?(n(),d("li",Na,"No items found.")):C("",!0),(n(!0),d(Z,null,ee(u.value,k=>(n(),d("li",{key:k[l.trackBy],class:Q(["px-4 py-2 cursor-pointer hover:bg-gray-100 text-sm",{"bg-indigo-50 text-indigo-900":c(k[l.trackBy])}]),onClick:w=>r(k)},g(k[l.labelKey]),11,Pa))),128))])])):C("",!0)])),[[_,()=>i.value=!1]])}}},He=Ce(Ra,[["__scopeId","data-v-5326f069"]]),Fa={class:"mt-6 space-y-6"},Ba={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ha={class:"flex items-center"},Wa={class:"flex items-center"},Ya={__name:"MeetingModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,a=["Africa/Cairo","Africa/Johannesburg","Africa/Lagos","America/Anchorage","America/Bogota","America/Chicago","America/Denver","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Dubai","Asia/Hong_Kong","Asia/Jerusalem","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Tokyo","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Berlin","Europe/Dublin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Rome","Pacific/Auckland","Pacific/Honolulu","UTC","GMT","Europe/Belfast","America/Adak","America/Boise","America/Detroit","America/Indianapolis","America/Juneau","America/Louisville","America/Menominee","America/Nome","America/Sitka","America/Yakutat","Asia/Karachi","Asia/Kolkata","Pacific/Auckland","Pacific/Chatham","Europe/Athens","Europe/Brussels","Europe/Budapest","Europe/Copenhagen","Europe/Helsinki","Europe/Lisbon","Europe/Oslo","Europe/Stockholm","Europe/Zurich","Europe/Vienna","Europe/Warsaw","Europe/Zurich","Europe/Sofia","Europe/Prague","Europe/Malta","Europe/Luxembourg","Europe/Kiev","Europe/Rome"].sort(),u=P(()=>a.map(h=>({value:h,label:h}))),r=P(()=>{const h=i(),T=a.includes(h);return console.log("DEBUG: Is detected timezone in list?",T,"Detected:",h),T?h:(console.log("DEBUG: Falling back to UTC for timezone as detected timezone not in list."),"UTC")}),m=ke({summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0,timezone:r.value,enable_recording:!1}),c=()=>{m.summary="",m.description="",m.attendee_user_ids=[],m.location="",m.with_google_meet=!0,m.timezone=r.value,m.enable_recording=!1,y(),console.log("DEBUG: Form reset. Current timezone in form:",m.timezone)},v=h=>{const T=new Date(h),A=T.getFullYear(),N=String(T.getMonth()+1).padStart(2,"0"),I=String(T.getDate()).padStart(2,"0"),Y=String(T.getHours()).padStart(2,"0"),B=String(T.getMinutes()).padStart(2,"0");return`${A}-${N}-${I}T${Y}:${B}`},y=()=>{const h=new Date,T=new Date(h.getTime()+3600*1e3),A=new Date(h.getTime()+7200*1e3);m.start_datetime=v(T),m.end_datetime=v(A),console.log("DEBUG: Default times set. Start:",m.start_datetime,"End:",m.end_datetime)};y(),re(()=>s.show,h=>{h&&c()},{immediate:!0});const _=h=>h?(console.log(h),h.replace("T"," ")+":00"):"",k=h=>{const T={...h};return T.start_datetime=_(h.start_datetime),T.end_datetime=_(h.end_datetime),console.log(T),T},w=P(()=>`/api/projects/${s.projectId}/meetings`),E=h=>{o("saved",h)},f=h=>{console.error("DEBUG: MeetingModal submission error:",h)};return(h,T)=>(n(),le(Ee,{show:l.show,title:"Schedule a Meeting","api-endpoint":w.value,"http-method":"post","form-data":m,"format-data-for-api":k,"submit-button-text":"Schedule Meeting","success-message":"Meeting scheduled successfully!",onClose:T[9]||(T[9]=A=>h.$emit("close")),onSubmitted:E,onError:f},{default:L(({errors:A})=>[e("div",Fa,[e("div",null,[p(W,{for:"summary",value:"Meeting Title"}),p(ne,{id:"summary",modelValue:m.summary,"onUpdate:modelValue":T[0]||(T[0]=N=>m.summary=N),type:"text",class:"mt-1 block w-full",placeholder:"Project Status Meeting",required:""},null,8,["modelValue"]),p(ae,{message:A.summary?A.summary[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"description",value:"Description"}),ce(e("textarea",{id:"description","onUpdate:modelValue":T[1]||(T[1]=N=>m.description=N),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Meeting agenda and details..."},null,512),[[fe,m.description]]),p(ae,{message:A.description?A.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Ba,[e("div",null,[p(W,{for:"start_datetime",value:"Start Date & Time"}),p(ne,{id:"start_datetime",modelValue:m.start_datetime,"onUpdate:modelValue":T[2]||(T[2]=N=>m.start_datetime=N),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:A.start_datetime?A.start_datetime[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"end_datetime",value:"End Date & Time"}),p(ne,{id:"end_datetime",modelValue:m.end_datetime,"onUpdate:modelValue":T[3]||(T[3]=N=>m.end_datetime=N),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:A.end_datetime?A.end_datetime[0]:"",class:"mt-2"},null,8,["message"])])]),e("div",null,[p(W,{for:"attendees",value:"Attendees"}),p(He,{id:"attendees",modelValue:m.attendee_user_ids,"onUpdate:modelValue":T[4]||(T[4]=N=>m.attendee_user_ids=N),options:s.projectUsers,"label-key":"name","track-by":"id",placeholder:"Select attendees",class:"mt-1"},null,8,["modelValue","options"]),T[10]||(T[10]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select project members to invite to this meeting ",-1)),p(ae,{message:A.attendee_user_ids?A.attendee_user_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"location",value:"Location (Optional)"}),p(ne,{id:"location",modelValue:m.location,"onUpdate:modelValue":T[5]||(T[5]=N=>m.location=N),type:"text",class:"mt-1 block w-full",placeholder:"Office, Conference Room, etc."},null,8,["modelValue"]),p(ae,{message:A.location?A.location[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"timezone",value:"Timezone"}),p(pe,{id:"timezone",modelValue:m.timezone,"onUpdate:modelValue":T[6]||(T[6]=N=>m.timezone=N),options:u.value,"value-key":"value","label-key":"label",placeholder:"Select timezone",class:"mt-1"},null,8,["modelValue","options"]),T[11]||(T[11]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select your timezone for this meeting ",-1)),p(ae,{message:A.timezone?A.timezone[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Ha,[ce(e("input",{id:"with_google_meet","onUpdate:modelValue":T[7]||(T[7]=N=>m.with_google_meet=N),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,m.with_google_meet]]),T[12]||(T[12]=e("label",{for:"with_google_meet",class:"ml-2 block text-sm text-gray-900"}," Create Google Meet video conference ",-1))]),e("div",Wa,[ce(e("input",{id:"enable_recording","onUpdate:modelValue":T[8]||(T[8]=N=>m.enable_recording=N),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qe,m.enable_recording]]),T[13]||(T[13]=e("label",{for:"enable_recording",class:"ml-2 block text-sm text-gray-900"}," Enable recording and transcript ",-1))])])]),_:1},8,["show","api-endpoint","form-data"]))}},za=Ce(Ya,[["__scopeId","data-v-4e53a3e5"]]),qa={class:"p-6"},Ga={key:0,class:"mb-4 p-3 bg-green-100 text-green-800 rounded-md"},Ka={key:1,class:"mb-4 p-3 bg-red-100 text-red-800 rounded-md"},Ja={class:"mb-4"},Za=["value"],Xa={class:"mt-6 flex justify-end space-x-3"},Qa={__name:"ProjectMagicLinkModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectClients:{type:Array,default:()=>[]}},emits:["close"],setup(l,{emit:t}){const s=l,o=t,i=x(!1),a=x(""),u=x(""),r=x(""),m=async()=>{var v,y;if(!a.value){r.value="Please select a client email";return}i.value=!0,u.value="",r.value="";try{const _=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{email:a.value});_.data.success?(u.value=_.data.message,a.value=""):r.value=_.data.message||"Failed to send magic link"}catch(_){console.error("Error sending magic link:",_),r.value=((y=(v=_.response)==null?void 0:v.data)==null?void 0:y.message)||"An error occurred while sending the magic link"}finally{i.value=!1}},c=()=>{a.value="",u.value="",r.value="",o("close")};return(v,y)=>(n(),le(Se,{show:l.show,onClose:c},{default:L(()=>[e("div",qa,[e("div",{class:"flex justify-between items-center mb-4"},[y[2]||(y[2]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Send Magic Link to Client",-1)),e("button",{onClick:c,class:"text-gray-400 hover:text-gray-500"},y[1]||(y[1]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u.value?(n(),d("div",Ga,g(u.value),1)):C("",!0),r.value?(n(),d("div",Ka,g(r.value),1)):C("",!0),e("div",Ja,[p(W,{for:"client-email",value:"Select Client"}),ce(e("select",{id:"client-email","onUpdate:modelValue":y[0]||(y[0]=_=>a.value=_),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full"},[y[3]||(y[3]=e("option",{value:""},"Select a client",-1)),(n(!0),d(Z,null,ee(l.projectClients,_=>(n(),d("option",{key:_.id,value:_.email},g(_.name)+" ("+g(_.email)+") ",9,Za))),128))],512),[[We,a.value]]),y[4]||(y[4]=e("p",{class:"mt-2 text-sm text-gray-500"}," The magic link will be sent to the selected client's email address. ",-1))]),e("div",Xa,[p(ye,{onClick:c,type:"button"},{default:L(()=>y[5]||(y[5]=[R(" Cancel ",-1)])),_:1,__:[5]}),p(ue,{onClick:m,disabled:i.value||!a.value,class:"bg-purple-600 hover:bg-purple-700"},{default:L(()=>[R(g(i.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},ei={class:"mt-6 space-y-6"},ti={class:"mt-2 flex space-x-4"},si={class:"inline-flex items-center"},li={class:"inline-flex items-center"},ai={key:0},ii={key:1},ni=["required"],oi={__name:"ResourceModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},resource:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=x({name:"",type:"link",url:"",file:null,description:""}),a=x(null),u=P(()=>s.resource?`/api/projects/${s.projectId}/resources/${s.resource.id}`:`/api/projects/${s.projectId}/resources`),r=P(()=>s.resource?"put":"post"),m=P(()=>s.resource?"Update Resource":"Add Resource"),c=P(()=>s.resource?"Resource updated successfully!":"Resource added successfully!");re(()=>s.show,w=>{w&&(s.resource?i.value={name:s.resource.name,type:s.resource.type,url:s.resource.type==="link"?s.resource.url:"",file:null,description:s.resource.description||""}:i.value={name:"",type:"link",url:"",file:null,description:""},a.value&&(a.value.value=""))},{immediate:!0});const v=w=>{i.value.file=w.target.files[0]||null},y=w=>{const E=new FormData;return E.append("name",w.name||""),E.append("type",w.type||"link"),E.append("description",w.description||""),w.type==="link"?E.append("url",w.url||""):w.type==="file"&&w.file&&E.append("file",w.file),(r.value==="put"||r.value==="patch")&&E.append("_method","PUT"),E},_=w=>{o("saved",w.resource)},k=()=>{o("close")};return(w,E)=>(n(),le(Ee,{show:l.show,title:l.resource?"Edit Resource":"Add Resource","api-endpoint":u.value,"http-method":r.value,"form-data":i.value,"submit-button-text":m.value,"success-message":c.value,"format-data-for-api":y,onClose:k,onSubmitted:_},{default:L(({errors:f})=>[e("div",ei,[e("div",null,[p(W,{for:"resource-type",value:"Resource Type"}),e("div",ti,[e("label",si,[ce(e("input",{type:"radio","onUpdate:modelValue":E[0]||(E[0]=h=>i.value.type=h),value:"link",class:"form-radio text-indigo-600"},null,512),[[mt,i.value.type]]),E[5]||(E[5]=e("span",{class:"ml-2 text-gray-700"},"Link",-1))]),e("label",li,[ce(e("input",{type:"radio","onUpdate:modelValue":E[1]||(E[1]=h=>i.value.type=h),value:"file",class:"form-radio text-indigo-600"},null,512),[[mt,i.value.type]]),E[6]||(E[6]=e("span",{class:"ml-2 text-gray-700"},"File",-1))])])]),e("div",null,[p(W,{for:"resource-name",value:"Name"}),p(ne,{id:"resource-name",modelValue:i.value.name,"onUpdate:modelValue":E[2]||(E[2]=h=>i.value.name=h),type:"text",class:"mt-1 block w-full",placeholder:"Enter resource name",required:""},null,8,["modelValue"]),p(ae,{message:f.name?f.name[0]:"",class:"mt-2"},null,8,["message"])]),i.value.type==="link"?(n(),d("div",ai,[p(W,{for:"resource-url",value:"URL"}),p(ne,{id:"resource-url",modelValue:i.value.url,"onUpdate:modelValue":E[3]||(E[3]=h=>i.value.url=h),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com",required:""},null,8,["modelValue"]),p(ae,{message:f.url?f.url[0]:"",class:"mt-2"},null,8,["message"])])):C("",!0),i.value.type==="file"?(n(),d("div",ii,[p(W,{for:"resource-file",value:"File"}),e("input",{id:"resource-file",ref_key:"fileInputRef",ref:a,type:"file",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",onChange:v,required:!l.resource||i.value.type==="file"},null,40,ni),p(ae,{message:f.file?f.file[0]:"",class:"mt-2"},null,8,["message"])])):C("",!0),e("div",null,[p(W,{for:"resource-description",value:"Description (Optional)"}),ce(e("textarea",{id:"resource-description","onUpdate:modelValue":E[4]||(E[4]=h=>i.value.description=h),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter a description for this resource"},null,512),[[fe,i.value.description]]),p(ae,{message:f.description?f.description[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},ri=Ce(oi,[["__scopeId","data-v-f508dda8"]]),di={class:"flex flex-col space-y-6"},ui={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},ci={key:0},mi={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},vi={class:"mb-4"},pi={key:0,class:"text-xs text-gray-500 mt-1"},hi={key:0,class:"text-xs text-gray-500 mt-1"},gi={class:"flex justify-between items-center mb-3"},yi={key:0,class:"flex items-center"},fi={key:1},bi={class:"bg-gray-100 p-4 rounded-lg shadow-inner min-h-[300px]"},_i={key:0,class:"flex items-center justify-center h-full"},wi=["innerHTML"],xi={__name:"ComposeEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},clients:{type:Array,default:()=>[]}},emits:["close"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(""),u=x(!1),r=x({}),m=x({}),c=x(!1),v=ke({template_id:null,template_data:{},project_id:s.projectId,client_ids:[],subject:"",greeting_name:"",custom_greeting_name:"",status:"pending_approval"});et(s.projectId);const y=P(()=>i.value.find(I=>I.id===v.template_id)),_=async I=>{c.value=!0,m.value={};const Y=new Set;I.placeholders.forEach(B=>{(B.is_repeatable||B.is_selectable)&&B.source_model&&Y.add(B.source_model)});try{const B=Array.from(Y).map(S=>{const V=S.split("\\").pop(),M=`/api/projects/${s.projectId}/model-data/${V}`;return window.axios.get(M).then(O=>{m.value[V]=O.data})});await Promise.all(B)}catch(B){console.error("Failed to fetch source model data:",B)}finally{c.value=!1}},k=async()=>{try{const I=await window.axios.get("/api/email-templates");i.value=I.data}catch(I){console.error("Failed to fetch email templates:",I)}},w=async()=>{if(!v.template_id||v.client_ids.length===0){a.value='<p class="text-gray-500 italic">Select a template and at least one recipient to see a preview.</p>';return}u.value=!0;try{const I=v.client_ids[0],Y=typeof I=="object"?I.id:I,B=await window.axios.post(`/api/projects/${s.projectId}/email-preview`,{template_id:v.template_id,client_id:Y,template_data:v.template_data});a.value=B.data.body_html,B.data.subject&&(v.subject=B.data.subject)}catch(I){console.error("Failed to fetch email preview:",I),a.value='<p class="text-red-500 italic">Error loading preview.</p>'}finally{u.value=!1}};re(()=>s.show,I=>{I&&(Object.assign(v,{template_id:null,template_data:{},project_id:s.projectId,client_ids:[],subject:"",greeting_name:"",custom_greeting_name:"",status:"pending_approval"}),a.value="",r.value={},m.value={},k())}),re(y,I=>{v.template_data={},I&&I.placeholders&&(I.placeholders.forEach(Y=>{Y.is_dynamic?v.template_data[Y.name]="":(Y.is_repeatable||Y.is_selectable)&&(Y.is_repeatable?v.template_data[Y.name]=[]:v.template_data[Y.name]=null)}),_(I))});const E=async()=>{if(Array.isArray(v.client_ids)&&v.client_ids.length>0&&typeof v.client_ids[0]=="object"&&(v.client_ids=v.client_ids.map(I=>I.id)),!v.subject&&y.value&&(v.subject=y.value.subject||""),v.client_ids.length>0){const I=v.client_ids[0],Y=s.clients.find(B=>B.id===I);Y&&(v.greeting_name=Y.name||"")}return console.log("Form data prepared:",JSON.stringify(v)),!0},f=()=>{o("close")},h=()=>{o("close")},T=P(()=>i.value.map(I=>({value:I.id,label:I.name}))),A=P(()=>y.value?y.value.placeholders.filter(I=>I.is_dynamic||I.is_repeatable||I.is_selectable):[]),N=P(()=>"/api/emails/templated");return be(()=>{k()}),(I,Y)=>(n(),le(Ee,{show:l.show,title:"Compose Email from Template","api-endpoint":N.value,"http-method":"post","form-data":v,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!",onClose:h,onSubmitted:f,"before-submit":E},{default:L(({errors:B})=>[e("div",di,[e("div",ui,[e("div",null,[p(W,{for:"template",value:"Select Template"}),p(pe,{id:"template",modelValue:v.template_id,"onUpdate:modelValue":Y[0]||(Y[0]=S=>v.template_id=S),options:T.value,placeholder:"Select a template","value-key":"value","label-key":"label","allow-empty":!0,class:"mt-1"},null,8,["modelValue","options"]),p(ae,{message:B.template_id?B.template_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"client_ids",value:"Recipients"}),p(He,{id:"client_ids",modelValue:v.client_ids,"onUpdate:modelValue":Y[1]||(Y[1]=S=>v.client_ids=S),options:l.clients,placeholder:"Select clients to send to","label-key":"name","track-by":"id","preserve-search":!0,"object-value":!0,class:"mt-1"},null,8,["modelValue","options"]),p(ae,{message:B.client_ids?B.client_ids[0]:"",class:"mt-2"},null,8,["message"])])]),y.value?(n(),d("div",ci,[Y[2]||(Y[2]=e("h4",{class:"text-md font-semibold text-gray-800 mb-3"},"Dynamic Placeholders",-1)),e("div",mi,[(n(!0),d(Z,null,ee(A.value,S=>(n(),d("div",{key:S.id},[e("div",vi,[p(W,{for:S.name,value:S.name},null,8,["for","value"]),S.is_repeatable&&S.source_model?(n(),d(Z,{key:0},[p(He,{id:S.name,modelValue:v.template_data[S.name],"onUpdate:modelValue":V=>v.template_data[S.name]=V,options:m.value[S.source_model.split("\\").pop()]||[],placeholder:`Select one or more ${S.name}`,"label-key":S.source_attribute,"track-by":"id",class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue","options","placeholder","label-key"]),c.value?(n(),d("div",pi," Loading "+g(S.source_model.split("\\").pop())+"... ",1)):C("",!0)],64)):S.is_selectable&&S.source_model?(n(),d(Z,{key:1},[p(pe,{id:S.name,modelValue:v.template_data[S.name],"onUpdate:modelValue":V=>v.template_data[S.name]=V,options:m.value[S.source_model.split("\\").pop()]||[],placeholder:`Select a ${S.name}`,"value-key":S.trackBy??"id","label-key":S.source_attribute,"allow-empty":!0,class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue","options","placeholder","value-key","label-key"]),c.value?(n(),d("div",hi," Loading "+g(S.source_model.split("\\").pop())+"... ",1)):C("",!0)],64)):S.is_dynamic&&S.is_link?(n(),le(ne,{key:2,id:S.name,type:"url",class:"mt-1 block w-full",modelValue:v.template_data[S.name],"onUpdate:modelValue":V=>v.template_data[S.name]=V,placeholder:"Enter URL"},null,8,["id","modelValue","onUpdate:modelValue"])):(n(),le(ne,{key:3,id:S.name,type:"text",class:"mt-1 block w-full",modelValue:v.template_data[S.name],"onUpdate:modelValue":V=>v.template_data[S.name]=V},null,8,["id","modelValue","onUpdate:modelValue"])),p(ae,{message:B[`template_data.${S.name}`]?B[`template_data.${S.name}`][0]:"",class:"mt-2"},null,8,["message"])])]))),128))])])):C("",!0),e("div",null,[e("div",gi,[Y[4]||(Y[4]=e("h4",{class:"text-md font-semibold text-gray-800"},"Email Preview",-1)),p(ue,{onClick:w,disabled:!v.template_id||v.client_ids.length===0||u.value,class:Q({"opacity-50 cursor-not-allowed":!v.template_id||v.client_ids.length===0||u.value})},{default:L(()=>[u.value?(n(),d("span",yi,Y[3]||(Y[3]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),R(" Loading... ",-1)]))):(n(),d("span",fi," Refresh Preview "))]),_:1},8,["disabled","class"])]),e("div",bi,[u.value?(n(),d("div",_i,Y[5]||(Y[5]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"},null,-1)]))):(n(),d("div",{key:1,innerHTML:a.value},null,8,wi))])])])]),_:1},8,["show","api-endpoint","form-data"]))}},ki={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Di={class:"flex justify-between items-center mb-4"},Ci={class:"flex gap-3"},$i={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Si={class:"text-2xl font-bold text-gray-900 tracking-tight mb-2"},Ei={class:"text-gray-600 text-base"},Mi={class:"space-y-3 text-sm text-gray-700"},Ti={class:"flex flex-wrap gap-2 mt-2 items-center"},ji=["href"],Vi=["href"],Ai=["href"],Ii={key:3,class:"text-gray-500 text-sm"},Oi={class:"relative"},Li=["onClick"],Ui={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ni={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Pi={key:0,class:"resource-tooltip absolute left-0 bottom-full mb-2 w-48 z-10"},Ri={class:"bg-white rounded-md shadow-lg p-3 text-sm border border-gray-200"},Fi={class:"flex justify-between items-center mb-2"},Bi={class:"font-medium text-gray-900"},Hi={key:0,class:"text-gray-600 text-xs mb-2"},Wi={class:"flex justify-between mt-2 pt-2 border-t border-gray-100"},Yi=["href"],zi={class:"flex space-x-2"},qi=["onClick"],Gi=["onClick"],Ki={class:"p-6"},Ji={key:0,class:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-md"},Zi={key:1,class:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md"},Xi={class:"mb-4"},Qi={key:0,class:"text-gray-500 text-sm mt-1"},en={key:1,class:"text-red-500 text-sm mt-1"},tn={class:"flex justify-end mt-6"},sn={__name:"ProjectGeneralInfoCard",props:{project:{type:Object,required:!0},projectId:{type:Number,required:!0},canManageProjects:{type:Boolean,required:!0},canEditProjects:{type:Boolean,required:!1},isSuperAdmin:{type:Boolean,required:!0}},emits:["openEditModal","openStandupModal","openMeetingModal","resourceSaved","openComposeModal"],setup(l,{emit:t}){const s=l,o=t,i=x(!1),a=x(null),u=x([]),r=x(!1),m=x(null),c=x(!1),v=x(!1),y=x(!1),_=x({client_ids:[]}),k=x({}),w=x(""),E=x([]),f=x(!1),h=x("");et(s.projectId);const T=async()=>{r.value=!0;try{const b=await window.axios.get(`/api/projects/${s.projectId}/resources`);b.data.success?u.value=b.data.resources:console.error("Failed to fetch resources:",b.data.message)}catch(b){console.error("Error fetching resources:",b)}finally{r.value=!1}},A=()=>{a.value=null,i.value=!0},N=b=>{a.value=b,i.value=!0},I=async b=>{if(confirm("Are you sure you want to delete this resource?"))try{const D=await window.axios.delete(`/api/projects/${s.projectId}/resources/${b}`);D.data.success?u.value=u.value.filter($=>$.id!==b):console.error("Failed to delete resource:",D.data.message)}catch(D){console.error("Error deleting resource:",D)}},Y=b=>{if(a.value){const D=u.value.findIndex($=>$.id===b.id);D!==-1&&(u.value[D]=b)}else u.value.push(b);o("resourceSaved",b)},B=b=>{m.value=m.value===b?null:b},S=()=>{m.value=null},V=b=>{if(m.value!==null){const D=b.target.closest(".resource-tooltip"),$=b.target.closest(".resource-button");!D&&!$&&S()}};be(()=>{T(),document.addEventListener("click",V)}),ss(()=>{document.removeEventListener("click",V)});const M=async()=>{var b,D;f.value=!0,h.value="";try{const $=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);console.log($),E.value=$.data}catch($){console.error("Failed to fetch project clients:",$),h.value=((D=(b=$.response)==null?void 0:b.data)==null?void 0:D.message)||"Failed to load client data."}finally{f.value=!1}},O=()=>{_.value.client_ids=[],k.value={},w.value="",v.value=!0,M()},G=()=>{c.value=!0,M()},U=()=>{v.value=!1},j=async()=>{if(k.value={},w.value="",y.value=!0,!_.value.client_ids||_.value.client_ids.length===0){k.value={client_ids:["Please select a client."]},y.value=!1;return}try{const b=_.value.client_ids[0];if(!E.value.find(H=>H.id===b)){k.value={client_ids:["Selected client does not have a valid email."]},y.value=!1;return}const $=await window.axios.post(`/api/projects/${s.projectId}/magic-link`,{client_id:b});$.data.success&&(w.value=$.data.message,_.value.client_ids=[])}catch(b){b.response&&b.response.status===422?k.value=b.response.data.errors:b.response&&b.response.data.message?k.value={general:[b.response.data.message]}:k.value={general:["An unexpected error occurred. Please try again."]}}finally{y.value=!1}};return(b,D)=>{var $;return n(),d(Z,null,[e("div",ki,[e("div",Di,[D[10]||(D[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"General Information",-1)),e("div",Ci,[p(ue,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:D[0]||(D[0]=H=>o("openStandupModal"))},{default:L(()=>D[6]||(D[6]=[R(" Daily Standup ",-1)])),_:1,__:[6]}),l.canEditProjects||l.isSuperAdmin?(n(),le(ue,{key:0,onClick:D[1]||(D[1]=H=>b.$inertia.visit("/projects/"+l.projectId+"/edit")),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:L(()=>D[7]||(D[7]=[R(" Edit Project ",-1)])),_:1,__:[7]})):C("",!0),l.canManageProjects||l.isSuperAdmin?(n(),le(ue,{key:1,class:"bg-green-600 hover:bg-green-700 transition-colors",onClick:D[2]||(D[2]=H=>o("openMeetingModal"))},{default:L(()=>D[8]||(D[8]=[R(" Schedule Meeting ",-1)])),_:1,__:[8]})):C("",!0),l.canManageProjects||l.isSuperAdmin?(n(),le(ue,{key:2,class:"bg-blue-400 hover:bg-blue-600 transition-colors",onClick:G},{default:L(()=>D[9]||(D[9]=[R(" Compose Email ",-1)])),_:1,__:[9]})):C("",!0),l.canManageProjects?(n(),le(ue,{key:3,class:"bg-purple-600 hover:bg-purple-700 transition-colors",onClick:O,disabled:y.value},{default:L(()=>[R(g(y.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])):C("",!0)])]),e("div",$i,[e("div",null,[e("h3",Si,g(l.project.name),1),e("p",Ei,g(l.project.description||"No description provided"),1)]),e("div",Mi,[e("p",null,[D[11]||(D[11]=e("strong",{class:"text-gray-900"},"Status:",-1)),R(" "+g((($=l.project.status)==null?void 0:$.replace("_"," ").toUpperCase())||"N/A"),1)]),e("p",null,[D[12]||(D[12]=e("strong",{class:"text-gray-900"},"Project Type:",-1)),R(" "+g(l.project.project_type||"N/A"),1)]),e("p",null,[D[13]||(D[13]=e("strong",{class:"text-gray-900"},"Source:",-1)),R(" "+g(l.project.source||"N/A"),1)]),e("div",Ti,[e("button",{onClick:A,class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Add Resource"},D[14]||(D[14]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])),l.project.website?(n(),d("a",{key:0,href:l.project.website,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Visit Website"},D[15]||(D[15]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})],-1)]),8,ji)):C("",!0),l.project.social_media_link?(n(),d("a",{key:1,href:l.project.social_media_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Social Media"},D[16]||(D[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})],-1)]),8,Vi)):C("",!0),l.project.google_drive_link?(n(),d("a",{key:2,href:l.project.google_drive_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Google Drive"},D[17]||(D[17]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]),8,Ai)):C("",!0),r.value?(n(),d("div",Ii," Loading resources... ")):(n(!0),d(Z,{key:4},ee(u.value,H=>(n(),d("div",{key:H.id,class:"relative"},[e("div",Oi,[e("button",{onClick:we(oe=>B(H.id),["prevent"]),class:"resource-button p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors block"},[H.type==="link"?(n(),d("svg",Ui,D[18]||(D[18]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.172 13.828a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.102 1.101"},null,-1)]))):(n(),d("svg",Ni,D[19]||(D[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])))],8,Li),m.value===H.id?(n(),d("div",Pi,[e("div",Ri,[e("div",Fi,[e("h4",Bi,g(H.name),1),e("button",{onClick:we(S,["prevent"]),class:"text-gray-400 hover:text-gray-600"},D[20]||(D[20]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),H.description?(n(),d("p",Hi,g(H.description),1)):C("",!0),e("div",Wi,[e("a",{href:H.url,target:"_blank",class:"text-xs text-indigo-600 hover:text-indigo-800"}," Open Link ",8,Yi),e("div",zi,[e("button",{onClick:we(oe=>N(H),["prevent"]),class:"p-1 text-gray-500 hover:text-indigo-600",title:"Edit"},D[21]||(D[21]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,qi),e("button",{onClick:we(oe=>I(H.id),["prevent"]),class:"p-1 text-gray-500 hover:text-red-600",title:"Delete"},D[22]||(D[22]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Gi)])])]),D[23]||(D[23]=e("div",{class:"absolute left-5 bottom-0 transform translate-y-1/2 rotate-45 w-2 h-2 bg-white border-r border-b border-gray-200"},null,-1))])):C("",!0)])]))),128))])])])]),p(ri,{show:i.value,"project-id":l.projectId,resource:a.value,onClose:D[3]||(D[3]=H=>i.value=!1),onSaved:Y},null,8,["show","project-id","resource"]),p(Se,{show:v.value,onClose:U},{default:L(()=>[e("div",Ki,[D[26]||(D[26]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Send Magic Link ",-1)),w.value?(n(),d("div",Ji,g(w.value),1)):C("",!0),k.value.general?(n(),d("div",Zi,g(k.value.general[0]),1)):C("",!0),e("form",{onSubmit:we(j,["prevent"])},[e("div",Xi,[p(W,{for:"client",value:"Select Client"}),f.value?(n(),d("div",Qi,"Loading clients...")):h.value?(n(),d("div",en,g(h.value),1)):(n(),le(He,{key:2,id:"client",modelValue:_.value.client_ids,"onUpdate:modelValue":D[4]||(D[4]=H=>_.value.client_ids=H),options:E.value,placeholder:"Select a client","label-key":"name","track-by":"id",class:"mt-1"},null,8,["modelValue","options"])),p(ae,{message:k.value.client_ids?k.value.client_ids[0]:"",class:"mt-2"},null,8,["message"]),D[24]||(D[24]=e("p",{class:"mt-2 text-sm text-gray-500"}," Select a client to send them a magic link for project access. ",-1))]),e("div",tn,[p(ye,{onClick:U,class:"mr-3"},{default:L(()=>D[25]||(D[25]=[R(" Cancel ",-1)])),_:1,__:[25]}),p(ue,{type:"submit",class:"bg-purple-600 hover:bg-purple-700 transition-colors",disabled:y.value},{default:L(()=>[R(g(y.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),p(xi,{show:c.value,"project-id":l.projectId,clients:E.value,onClose:D[5]||(D[5]=H=>c.value=!1)},null,8,["show","project-id","clients"])],64)}}},ln=Ce(sn,[["__scopeId","data-v-f8fc7685"]]),an={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},nn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},on={class:"text-2xl font-bold text-indigo-600"},rn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},dn={class:"text-2xl font-bold text-indigo-600"},un={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},cn={class:"text-2xl font-bold text-indigo-600"},mn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},vn={class:"text-2xl font-bold text-indigo-600"},pn={__name:"ProjectStatsCards",props:{tasks:{type:Array,required:!0},emails:{type:Array,required:!0}},setup(l){const t=l,s=P(()=>t.tasks.filter(u=>u.status!=="Done").length),o=P(()=>t.emails.filter(u=>u.type==="received").length),i=P(()=>{const u=t.emails.filter(r=>r.status==="received"||r.type==="received");if(u.length>0){const r=[...u].sort((m,c)=>new Date(c.created_at)-new Date(m.created_at));return new Date(r[0].created_at).toLocaleDateString()}return"N/A"}),a=P(()=>{const u=t.tasks.filter(r=>r.status!=="Done");if(u.length>0){const r=u.filter(m=>m.due_date);if(r.length>0)return[...r].sort((c,v)=>new Date(c.due_date)-new Date(v.due_date))[0].due_date}return"N/A"});return(u,r)=>(n(),d("div",an,[e("div",nn,[r[0]||(r[0]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Pending Tasks",-1)),e("p",on,g(s.value),1)]),e("div",rn,[r[1]||(r[1]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Received Emails",-1)),e("p",dn,g(o.value),1)]),e("div",un,[r[2]||(r[2]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Last Email Received",-1)),e("p",cn,g(i.value),1)]),e("div",mn,[r[3]||(r[3]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Next Task Deadline",-1)),e("p",vn,g(a.value),1)])]))}},hn={class:"bg-white p-4 rounded-xl shadow-md mb-6"},gn={class:"border-b border-gray-200"},yn={class:"-mb-px flex space-x-8 overflow-x-auto"},fn={__name:"ProjectTabsNavigation",props:{selectedTab:{type:String,default:null},canViewEmails:{type:Boolean,required:!0},canViewNotes:{type:Boolean,required:!0},canViewDeliverables:{type:Boolean,required:!0},canViewSeoReports:{type:Boolean,required:!0}},emits:["update:selectedTab"],setup(l,{emit:t}){const s=l,o=t,i=P({get:()=>s.selectedTab,set:a=>o("update:selectedTab",a)});return(a,u)=>(n(),d("div",hn,[e("div",gn,[e("nav",yn,[e("button",{onClick:u[0]||(u[0]=r=>i.value=null),class:Q([i.value===null?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Overview ",2),e("button",{onClick:u[1]||(u[1]=r=>i.value="tasks"),class:Q([i.value==="tasks"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Project Tasks ",2),l.canViewEmails?(n(),d("button",{key:0,onClick:u[2]||(u[2]=r=>i.value="emails"),class:Q([i.value==="emails"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Email Communication ",2)):C("",!0),l.canViewNotes?(n(),d("button",{key:1,onClick:u[3]||(u[3]=r=>i.value="notes"),class:Q([i.value==="notes"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Notes ",2)):C("",!0),l.canViewNotes?(n(),d("button",{key:2,onClick:u[4]||(u[4]=r=>i.value="standups"),class:Q([i.value==="standups"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Daily Standups ",2)):C("",!0),l.canViewDeliverables?(n(),d("button",{key:3,onClick:u[5]||(u[5]=r=>i.value="deliverables"),class:Q([i.value==="deliverables"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Deliverables ",2)):C("",!0),l.canViewSeoReports?(n(),d("button",{key:4,onClick:u[6]||(u[6]=r=>i.value="seo-reports"),class:Q([i.value==="seo-reports"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," SEO Reports ",2)):C("",!0)])])]))}},bn={class:"space-y-4"},_n={key:0,class:"text-sm text-gray-500"},wn={class:"flex justify-between items-center"},xn={key:0,class:"text-sm text-gray-500"},kn="put",Dn="Update Task",Cn="Task updated successfully!",$n={__name:"EditTaskModal",props:{show:Boolean,projectId:Number,selectedTask:Object,projectUsers:Array,taskTypes:Array,milestones:Array,loadingTaskTypes:Boolean,loadingMilestones:Boolean},emits:["close","saved","open-add-milestone-modal"],setup(l,{emit:t}){const s=l,o=t,i=ke({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null}),a=["To Do","In Progress","Done","Blocked","Archived"],u=P(()=>"Edit Task"),r=P(()=>{var w;return`/api/tasks/${(w=s.selectedTask)==null?void 0:w.id}`});re(()=>[s.show,s.selectedTask],([w,E],[f,h]=[])=>{var T;if(w&&E){let A=null;if(E.milestone){const Y=s.milestones.find(B=>B.name===E.milestone);Y&&(A=Y.id)}else E.milestone_id&&(A=E.milestone_id);let N=null;if(E.task_type){const Y=s.taskTypes.find(B=>B.name===E.task_type);Y&&(N=Y.id)}else E.task_type_id&&(N=E.task_type_id);let I=null;if(E.assigned_to&&E.assigned_to!=="Unassigned"){const Y=(T=s.projectUsers)==null?void 0:T.find(B=>B.name===E.assigned_to);Y&&(I=Y.id)}else E.assigned_to_id&&(I=E.assigned_to_id);Object.assign(i,{name:E.title,description:E.description||"",assigned_to_user_id:I,due_date:E.due_date||null,status:E.status,task_type_id:N,milestone_id:A})}else w||Object.assign(i,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null})},{immediate:!0});const m=w=>{o("saved",w),o("close")},c=()=>{o("open-add-milestone-modal")},v=()=>{o("close")},y=P(()=>s.projectUsers.map(w=>({value:w.id,label:w.name}))),_=P(()=>s.taskTypes.map(w=>({value:w.id,label:w.name}))),k=P(()=>s.milestones.map(w=>({value:w.id,label:w.name})));return(w,E)=>(n(),le(Ee,{show:l.show,title:u.value,"api-endpoint":r.value,"http-method":kn,"form-data":i,"submit-button-text":Dn,"success-message":Cn,onClose:v,onSubmitted:m},{default:L(({errors:f})=>[e("div",bn,[e("div",null,[p(W,{for:"task-name",value:"Task Name"}),p(ne,{id:"task-name",modelValue:i.name,"onUpdate:modelValue":E[0]||(E[0]=h=>i.name=h),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),p(ae,{message:f.name?f.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-description",value:"Description"}),ce(e("textarea",{id:"task-description","onUpdate:modelValue":E[1]||(E[1]=h=>i.description=h),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[fe,i.description]]),p(ae,{message:f.description?f.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-status",value:"Status"}),p(pe,{id:"task-status",modelValue:i.status,"onUpdate:modelValue":E[2]||(E[2]=h=>i.status=h),options:a.map(h=>({value:h,label:h})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),p(ae,{message:f.status?f.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-due-date",value:"Due Date"}),p(ne,{id:"task-due-date",modelValue:i.due_date,"onUpdate:modelValue":E[3]||(E[3]=h=>i.due_date=h),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),p(ae,{message:f.due_date?f.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-assigned-to",value:"Assigned To"}),p(pe,{id:"task-assigned-to",modelValue:i.assigned_to_user_id,"onUpdate:modelValue":E[4]||(E[4]=h=>i.assigned_to_user_id=h),options:y.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"]),p(ae,{message:f.assigned_to_user_id?f.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"task-type",value:"Task Type"}),l.loadingTaskTypes?(n(),d("div",_n,"Loading task types...")):(n(),le(pe,{key:1,id:"task-type",modelValue:i.task_type_id,"onUpdate:modelValue":E[5]||(E[5]=h=>i.task_type_id=h),options:_.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),p(ae,{message:f.task_type_id?f.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[e("div",wn,[p(W,{for:"task-milestone",value:"Milestone"}),e("button",{type:"button",onClick:c,class:"text-sm text-indigo-600 hover:text-indigo-800"}," + Create New Milestone ")]),l.loadingMilestones?(n(),d("div",xn,"Loading milestones...")):(n(),le(pe,{key:1,id:"task-milestone",modelValue:i.milestone_id,"onUpdate:modelValue":E[6]||(E[6]=h=>i.milestone_id=h),options:k.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),p(ae,{message:f.milestone_id?f.milestone_id[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},Sn={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},En={class:"flex justify-between items-center mb-4"},Mn={class:"flex gap-2"},Tn={key:0},jn={key:1},Vn={class:"mb-6 overflow-x-auto"},An={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},In={key:1,class:"text-center py-4"},On={key:2,class:"relative py-8"},Ln={class:"relative flex justify-between"},Un={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Nn={key:1,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pn={key:2,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Rn={key:3,class:"w-2 h-2 bg-white rounded-full"},Fn={class:"absolute -top-8 transform -translate-x-1/2 left-1/2 w-32"},Bn=["title"],Hn={class:"absolute top-8 transform -translate-x-1/2 left-1/2"},Wn={class:"text-xs text-gray-500 whitespace-nowrap"},Yn={class:"mb-6 bg-gray-50 p-4 rounded-lg"},zn={class:"flex flex-wrap items-center gap-4"},qn={class:"flex-1 min-w-[200px]"},Gn={class:"flex-1 min-w-[200px]"},Kn={class:"flex-1 min-w-[200px]"},Jn={class:"flex-1 min-w-[200px]"},Zn={key:0,class:"mt-3 text-sm text-gray-600"},Xn={key:0,class:"text-red-600 font-medium"},Qn={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},eo={key:1,class:"text-center py-4"},to={class:"text-red-600 text-sm font-medium"},so={key:2,class:"overflow-x-auto"},lo={class:"min-w-full divide-y divide-gray-200"},ao={class:"bg-white divide-y divide-gray-200"},io={class:"px-4 py-3 text-sm text-gray-900"},no={class:"px-4 py-3 text-sm text-gray-700"},oo={class:"px-4 py-3 text-sm text-gray-700"},ro={class:"px-4 py-3 text-sm text-gray-700"},uo={class:"px-4 py-3 text-sm text-gray-700"},co={class:"px-4 py-3 text-right"},mo={class:"flex justify-end space-x-2"},vo=["onClick"],po=["onClick"],ho=["onClick"],go=["onClick"],yo=["onClick"],fo={key:3,class:"text-center py-4"},bo={__name:"ProjectTasksTab",props:{projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},canManageProjects:{type:Boolean,required:!0}},emits:["tasksUpdated","openTaskDetailSidebar","open-create-task-modal"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(""),r=x(!1),m=x(null),c=x(!1),v=x(!1),y=x(null),_=x([]),k=x([]),w=x(!1),E=x(!1),f=ke({status:"",assigned_to_user_id:null,milestone_id:null,due_date_range:""}),h=[{value:"",label:"All Statuses"},{value:"To Do",label:"To Do"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Blocked",label:"Blocked"},{value:"Archived",label:"Archived"}],T=P(()=>{const X=[{value:null,label:"All Users"},{value:-1,label:"Unassigned"}];return X.push(...s.projectUsers.map(q=>({value:q.id,label:q.name}))),X}),A=P(()=>{const X=[{value:null,label:"All Milestones"},{value:-1,label:"No Milestone"}];return X.push(...k.value.map(q=>({value:q.id,label:q.name}))),X}),N=[{value:"",label:"All Dates"},{value:"today",label:"Due Today"},{value:"this_week",label:"Due This Week"},{value:"next_week",label:"Due Next Week"},{value:"overdue",label:"Overdue"},{value:"no_date",label:"No Due Date"}],I=P(()=>!k.value||!k.value.length?[]:[...k.value].sort((X,q)=>X.completion_date?q.completion_date?new Date(X.completion_date)-new Date(q.completion_date):-1:1)),Y=P(()=>i.value.length?i.value.filter(X=>{if(f.status&&X.status!==f.status)return!1;if(f.assigned_to_user_id!==null){const q=parseInt(f.assigned_to_user_id);if(q===-1){if(X.assigned_to!=="Unassigned"&&X.assigned_to_id!==null)return!1}else if(X.assigned_to_id!==q)return!1}if(f.milestone_id!==null){const q=parseInt(f.milestone_id);if(q===-1){if(X.milestone_id)return!1}else if(X.milestone_id!==q)return!1}if(f.due_date_range){const q=new Date;q.setHours(0,0,0,0);const J=X.due_date?new Date(X.due_date):null;switch(f.due_date_range){case"today":if(!J||J.toDateString()!==q.toDateString())return!1;break;case"this_week":{if(!J)return!1;const ge=new Date(q);if(ge.setDate(q.getDate()+(6-q.getDay())),J<q||J>ge)return!1;break}case"next_week":{if(!J)return!1;const ge=new Date(q);ge.setDate(q.getDate()+(7-q.getDay()));const Ne=new Date(ge);if(Ne.setDate(ge.getDate()+6),J<ge||J>Ne)return!1;break}case"overdue":{if(!J||J>=q)return!1;break}case"no_date":{if(J)return!1;break}}}return!0}):[]),B=()=>{f.status="",f.assigned_to_user_id=null,f.milestone_id=null,f.due_date_range=""},S=async()=>{a.value=!0,u.value="";try{const X=await window.axios.get(`/api/projects/${s.projectId}/tasks`);i.value=X.data,o("tasksUpdated",i.value)}catch(X){u.value="Failed to load tasks data.",console.error("Error fetching project tasks:",X),X.response&&X.response.data&&X.response.data.message&&(u.value=X.response.data.message)}finally{a.value=!1}},V=async()=>{w.value=!0;try{const X=await window.axios.get("/api/task-types");_.value=X.data}catch(X){console.error("Error fetching task types:",X)}finally{w.value=!1}},M=async()=>{E.value=!0;try{const X=await window.axios.get(`/api/projects/${s.projectId}/milestones`);k.value=X.data}catch(X){console.error("Error fetching milestones:",X)}finally{E.value=!1}},O=()=>{o("open-create-task-modal")},G=async X=>{m.value=X,await V(),await M(),r.value=!0},U=()=>{S()},j=X=>{console.log("ProjectTasksTab: Emitting open-task-detail-sidebar for taskId:",X.id),o("openTaskDetailSidebar",X.id)},b=()=>{c.value=!0},D=X=>{k.value.push(X),S()},$=X=>{y.value=X,v.value=!0},H=()=>{S()},oe=async X=>{try{await window.axios.post(`/api/tasks/${X.id}/complete`),await S()}catch(q){console.error("Error marking task as completed:",q),alert("Failed to mark task as completed. Please try again.")}},Ve=async X=>{try{await window.axios.post(`/api/tasks/${X.id}/start`),await S()}catch(q){console.error("Error starting task:",q),alert("Failed to start task. Please try again.")}};return be(()=>{S(),V(),M()}),re(()=>s.projectUsers,()=>{}),re(()=>s.taskTypes,()=>{}),re(()=>s.milestones,()=>{}),(X,q)=>(n(),d("div",Sn,[e("div",En,[q[8]||(q[8]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Tasks",-1)),e("div",Mn,[p(ye,{onClick:S,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:L(()=>[a.value?(n(),d("span",jn,"Loading...")):(n(),d("span",Tn,"Refresh"))]),_:1},8,["disabled"]),l.canManageProjects?(n(),le(ue,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:O},{default:L(()=>q[7]||(q[7]=[R(" Add Task ",-1)])),_:1,__:[7]})):C("",!0)])]),e("div",Vn,[E.value?(n(),d("div",An," Loading milestones... ")):I.value.length?(n(),d("div",On,[q[13]||(q[13]=e("div",{class:"absolute h-1 bg-gray-200 top-1/2 left-0 right-0 transform -translate-y-1/2"},null,-1)),e("div",Ln,[(n(!0),d(Z,null,ee(I.value,(J,ge)=>(n(),d("div",{key:J.id,class:Q(["flex flex-col items-center relative z-10",{"ml-4":ge===0,"mr-4":ge===I.value.length-1}])},[e("div",{class:Q(["w-6 h-6 rounded-full shadow-lg flex items-center justify-center",{"bg-gray-300":J.status==="Not Started","bg-blue-500":J.status==="In Progress","bg-green-500":J.status==="Completed","bg-red-500":J.status==="Overdue"}])},[J.status==="Completed"?(n(),d("svg",Un,q[10]||(q[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):J.status==="In Progress"?(n(),d("svg",Nn,q[11]||(q[11]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))):J.status==="Overdue"?(n(),d("svg",Pn,q[12]||(q[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(n(),d("span",Rn))],2),e("div",Fn,[e("p",{class:"text-xs font-medium text-gray-700 text-center truncate",title:J.name},g(J.name),9,Bn)]),e("div",Hn,[e("p",Wn,g(J.completion_date?new Date(J.completion_date).toLocaleDateString():"No date"),1)])],2))),128))])])):(n(),d("div",In,q[9]||(q[9]=[e("p",{class:"text-gray-400 text-sm"},"No milestones found for this project.",-1)])))]),e("div",Yn,[e("div",zn,[e("div",qn,[p(W,{for:"status-filter",value:"Status"}),p(pe,{id:"status-filter",modelValue:f.status,"onUpdate:modelValue":q[0]||(q[0]=J=>f.status=J),options:h,"value-key":"value","label-key":"label",placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",Gn,[p(W,{for:"assigned-filter",value:"Assigned To"}),p(pe,{id:"assigned-filter",modelValue:f.assigned_to_user_id,"onUpdate:modelValue":q[1]||(q[1]=J=>f.assigned_to_user_id=J),options:T.value,"value-key":"value","label-key":"label",placeholder:"All Users",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Kn,[p(W,{for:"milestone-filter",value:"Milestone"}),p(pe,{id:"milestone-filter",modelValue:f.milestone_id,"onUpdate:modelValue":q[2]||(q[2]=J=>f.milestone_id=J),options:A.value,"value-key":"value","label-key":"label",placeholder:"All Milestones",class:"mt-1"},null,8,["modelValue","options"])]),e("div",Jn,[p(W,{for:"due-date-filter",value:"Due Date"}),p(pe,{id:"due-date-filter",modelValue:f.due_date_range,"onUpdate:modelValue":q[3]||(q[3]=J=>f.due_date_range=J),options:N,"value-key":"value","label-key":"label",placeholder:"All Dates",class:"mt-1"},null,8,["modelValue"])]),e("div",{class:"flex items-end"},[e("button",{type:"button",onClick:B,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")])]),Object.values(f).some(J=>J!==null&&J!=="")?(n(),d("div",Zn,[e("p",null,[R(" Showing "+g(Y.value.length)+" of "+g(i.value.length)+" tasks ",1),Y.value.length===0?(n(),d("span",Xn," (No tasks match the current filters) ")):C("",!0)])])):C("",!0)]),a.value?(n(),d("div",Qn," Loading tasks... ")):u.value?(n(),d("div",eo,[e("p",to,g(u.value),1)])):i.value.length?(n(),d("div",so,[e("table",lo,[q[14]||(q[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned To"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Due Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Milestone"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ao,[(n(!0),d(Z,null,ee(Y.value,J=>(n(),d("tr",{key:J.id,class:"hover:bg-gray-50 transition-colors"},[e("td",io,g(J.title),1),e("td",no,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":J.status==="To Do","bg-blue-100 text-blue-800":J.status==="In Progress","bg-green-100 text-green-800":J.status==="Done","bg-red-100 text-red-800":J.status==="Blocked","bg-gray-100 text-gray-800":J.status==="Archived"})},g(J.status),3)]),e("td",oo,g(J.assigned_to),1),e("td",ro,g(J.due_date?J.due_date:"N/A"),1),e("td",uo,g(J.milestone||"N/A"),1),e("td",co,[e("div",mo,[e("button",{onClick:ge=>j(J),class:"text-purple-600 hover:text-purple-800 text-sm font-medium"}," View ",8,vo),e("button",{onClick:ge=>G(J),class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium"}," Edit ",8,po),e("button",{onClick:ge=>$(J),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Add Note ",8,ho),J.status==="To Do"?(n(),d("button",{key:0,onClick:ge=>Ve(J),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Start ",8,go)):C("",!0),J.status!=="Done"?(n(),d("button",{key:1,onClick:ge=>oe(J),class:"text-green-600 hover:text-green-800 text-sm font-medium"}," Complete ",8,yo)):C("",!0)])])]))),128))])])])):(n(),d("div",fo,q[15]||(q[15]=[e("p",{class:"text-gray-400 text-sm"},"No tasks found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add Task" button to create a new task. ',-1)]))),p($n,{show:r.value,"project-id":l.projectId,"selected-task":m.value,"project-users":l.projectUsers,"task-types":_.value,milestones:k.value,"loading-task-types":w.value,"loading-milestones":E.value,onClose:q[4]||(q[4]=J=>r.value=!1),onSaved:U,onOpenAddMilestoneModal:b},null,8,["show","project-id","selected-task","project-users","task-types","milestones","loading-task-types","loading-milestones"]),p(zt,{show:c.value,"project-id":l.projectId,onClose:q[5]||(q[5]=J=>c.value=!1),onSaved:D},null,8,["show","project-id"]),p(qt,{show:v.value,"task-for-note":y.value,onClose:q[6]||(q[6]=J=>v.value=!1),onNoteAdded:H},null,8,["show","task-for-note"])]))}};function xt(l){const t=i=>{const a=/\[([^\]]+?)\][\s\u00A0]*\{([^}]+?)\}/g;return i.replace(a,(u,r,m)=>{let c=m.trim();return!c.startsWith("http://")&&!c.startsWith("https://")&&(c=`https://${c}`),`<a href="${c}" target="_blank" style="color: #1a73e8; text-decoration: underline;">${r.trim()}</a>`})},s=i=>{const a=/<(ul|ol)>(.*?)<\/(ul|ol)>/gs;return i.replace(a,(u,r,m)=>{const c=r,v=c==="ul"?"list-style-type: disc;":"list-style-type: decimal;",y=/<li>(.*?)<\/li>/gs,_=m.replace(y,(k,w)=>`<li style="margin-bottom: 5px; font-family: 'Inter', sans-serif; font-size: 16px; line-height: 1.6; color: #1a202c;">${w}</li>`);return`<${c} style="margin: 0; padding: 0 0 0 20px; ${v}">${_}</${c}>`})};return{processedHtmlBody:P(()=>{let i=l.value;return i=t(i),i=s(i),i})}}const _o={key:0},wo={class:"mb-4"},xo={class:"mb-6"},ko={class:"mb-2 flex justify-end space-x-2"},Do={key:0,class:"min-h-[300px] flex items-center justify-center bg-gray-50 rounded-md"},Co={class:"mb-2 flex justify-end space-x-2"},$o={key:1},So={class:"mb-6"},Eo={class:"p-6"},Mo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},To={class:"block sm:inline"},jo={class:"mb-4"},Vo={class:"mb-6"},Ao={class:"flex justify-end space-x-3"},Io={class:"p-6"},Oo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Lo={class:"block sm:inline"},Uo={class:"mb-4"},No={class:"mb-6"},Po={class:"flex justify-end space-x-3"},Ro={__name:"EmailActionModal",props:{show:{type:Boolean,default:!1},title:{type:String,required:!0},apiEndpoint:{type:String,required:!0},httpMethod:{type:String,default:"post"},initialFormData:{type:Object,default:()=>({})},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},emailId:{type:Number,required:!1},projectId:{type:Number,required:!0}},emits:["close","submitted","error","fetchEmails"],setup(l,{emit:t}){const s=l,o=t,i=ke({}),a=x(!1),u=x(!1),r=x(""),m=x(""),c=x(""),v=x(!1),y=x(""),_=x("bullet"),k=x(""),w=P(()=>i.body||""),{processedHtmlBody:E}=xt(w);re(()=>s.show,G=>{if(G){for(const U in i)delete i[U];Object.assign(i,JSON.parse(JSON.stringify(s.initialFormData))),i.template_id&&i.template_data&&s.projectId&&i.client_id&&(a.value=!0,window.axios.post(`/api/projects/${s.projectId}/email-preview`,{template_id:i.template_id,template_data:i.template_data,client_id:i.client_id}).then(U=>{i.body=U.data.body_html,a.value=!1}).catch(U=>{console.error("Failed to fetch rendered email body:",U),i.body="Error rendering email body.",a.value=!1}))}},{immediate:!0});const f=G=>{const U={...G};return s.title==="Edit and Approve Email"&&(U.body=E.value),U},h=()=>{o("close")},T=G=>{o("submitted",G)},A=G=>{o("error",G)},N=()=>{r.value="",m.value="",c.value="",u.value=!0},I=()=>{if(!r.value.trim()){c.value="Link text cannot be empty.";return}let G=m.value.trim();!G.startsWith("http://")&&!G.startsWith("https://")&&(G="http://"+G);try{new URL(G)}catch{c.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const U=`[${r.value.trim()}] {${G}}`;i.body+=U,u.value=!1,r.value="",m.value="",c.value=""},Y=()=>{y.value="",_.value="bullet",k.value="",v.value=!0},B=()=>{const G=y.value.split(`
`).map(b=>b.trim()).filter(b=>b!=="");if(G.length===0){k.value="Please enter at least one list item.";return}const U=_.value==="bullet"?"ul":"ol";let j=`<${U}>`;G.forEach(b=>{j+=`<li>${b}</li>`}),j+=`</${U}>`,i.body+=j,v.value=!1,y.value="",k.value=""},S=x({}),V=x(!1),M=async()=>{V.value=!0;try{await window.axios.post(`/api/emails/${s.emailId}/update`,{subject:i.subject,body:i.body}),typeof success=="function"?success("Email approved successfully!"):console.log("Email approved successfully!"),V.value=!1,o("fetchEmails"),h()}catch(G){V.value=!1,G.response&&G.response.data.message?S.value=G.response.data.message:(S.value="Failed to approve email.",console.error("Error approving email directly:",G)),typeof G=="function"&&G(S.value)}},O=()=>{if(s.emailId){const G=`/emails/${s.emailId}/preview`;window.open(G,"_blank")}else console.warn("Cannot preview email: Email ID not available.")};return(G,U)=>(n(),d(Z,null,[p(Ee,{show:l.show,title:l.title,"api-endpoint":l.apiEndpoint,"http-method":l.httpMethod,"form-data":i,"submit-button-text":l.submitButtonText,"success-message":l.successMessage,"format-data-for-api":f,onClose:h,onSubmitted:T,onError:A,"max-width":"3xl"},{default:L(({errors:j})=>[l.title==="Edit and Approve Email"?(n(),d("div",_o,[e("div",wo,[p(W,{for:"edit_subject",value:"Subject"}),p(ne,{id:"edit_subject",type:"text",class:"mt-1 block w-full",modelValue:i.subject,"onUpdate:modelValue":U[0]||(U[0]=b=>i.subject=b),required:""},null,8,["modelValue"]),p(ae,{message:j.subject?j.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",xo,[e("div",ko,[p(ye,{type:"button",onClick:Y},{default:L(()=>U[11]||(U[11]=[R(" Insert List ",-1)])),_:1,__:[11]}),p(ye,{type:"button",onClick:N},{default:L(()=>U[12]||(U[12]=[R(" Insert Link ",-1)])),_:1,__:[12]})]),p(W,{for:"edit_body",value:"Email Body",class:"sr-only"}),a.value?(n(),d("div",Do,U[13]||(U[13]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"},null,-1)]))):(n(),le(bt,{key:1,id:"edit_body",modelValue:i.body,"onUpdate:modelValue":U[1]||(U[1]=b=>i.body=b),placeholder:"Edit your email here...",height:"300px"},null,8,["modelValue"])),p(ae,{message:j.body?j.body[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Co,[p(ue,{type:"button",disabled:V.value,onClick:M},{default:L(()=>[R(g(V.value?"Saving...":"Save"),1)]),_:1},8,["disabled"]),p(ye,{type:"button",onClick:O},{default:L(()=>U[14]||(U[14]=[R(" Preview Email ",-1)])),_:1,__:[14]})])])):l.title==="Reject Email"?(n(),d("div",$o,[e("div",So,[p(W,{for:"rejection_reason",value:"Rejection Reason"}),ce(e("textarea",{id:"rejection_reason",rows:"5",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":U[2]||(U[2]=b=>i.rejection_reason=b),required:"",placeholder:"Please provide a reason for rejecting this email (minimum 10 characters)"},null,512),[[fe,i.rejection_reason]]),p(ae,{message:j.rejection_reason?j.rejection_reason[0]:"",class:"mt-2"},null,8,["message"])])])):C("",!0)]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]),p(Se,{show:u.value,onClose:U[6]||(U[6]=j=>u.value=!1),"max-width":"md"},{default:L(()=>[e("div",Eo,[U[17]||(U[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),c.value?(n(),d("div",Mo,[e("span",To,g(c.value),1)])):C("",!0),e("div",jo,[p(W,{for:"link_text",value:"Link Text"}),p(ne,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:r.value,"onUpdate:modelValue":U[3]||(U[3]=j=>r.value=j),onKeyup:Oe(I,["enter"])},null,8,["modelValue"])]),e("div",Vo,[p(W,{for:"link_url",value:"URL"}),p(ne,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:m.value,"onUpdate:modelValue":U[4]||(U[4]=j=>m.value=j),placeholder:"e.g., https://www.example.com",onKeyup:Oe(I,["enter"])},null,8,["modelValue"])]),e("div",Ao,[p(ye,{onClick:U[5]||(U[5]=j=>u.value=!1)},{default:L(()=>U[15]||(U[15]=[R("Cancel",-1)])),_:1,__:[15]}),p(ue,{onClick:I},{default:L(()=>U[16]||(U[16]=[R("Insert",-1)])),_:1,__:[16]})])])]),_:1},8,["show"]),p(Se,{show:v.value,onClose:U[10]||(U[10]=j=>v.value=!1),"max-width":"md"},{default:L(()=>[e("div",Io,[U[21]||(U[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),k.value?(n(),d("div",Oo,[e("span",Lo,g(k.value),1)])):C("",!0),e("div",Uo,[p(W,{for:"list_items",value:"List Items (one per line)"}),ce(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":U[7]||(U[7]=j=>y.value=j),placeholder:"Enter each list item on a new line"},null,512),[[fe,y.value]])]),e("div",No,[p(W,{for:"list_type",value:"List Type"}),ce(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":U[8]||(U[8]=j=>_.value=j)},U[18]||(U[18]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[We,_.value]])]),e("div",Po,[p(ye,{onClick:U[9]||(U[9]=j=>v.value=!1)},{default:L(()=>U[19]||(U[19]=[R("Cancel",-1)])),_:1,__:[19]}),p(ue,{onClick:B},{default:L(()=>U[20]||(U[20]=[R("Insert List",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])],64))}},Fo=Ce(Ro,[["__scopeId","data-v-955ad996"]]);function Bo(l){const t=Le();return{userSignature:P(()=>{const o=t.value&&t.value.name?t.value.name:"",i=l.name??"",a="+61 456 639 389",u="ozeeweb.com.au",r="#1a73e8",m="#fbbc05",c="#1a202c",v="#4a5568",y="#e5e7eb",_="#f9fafb",k=`${window.location.origin}/logo.png`,w=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/facebook-new.png`,E=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/twitter.png`,f=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/linkedin.png`,h=`https://img.icons8.com/ios-filled/20/${r.substring(1)}/instagram-new.png`;return`
            <div style="font-family: 'Inter', sans-serif; padding: 20px; border: 1px solid ${y}; margin-top: 30px; background-color: ${_}; border-radius: 8px; overflow: hidden; box-shadow: 0 0 0 3px ${m};">
                <table role="presentation" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td style="vertical-align: middle;">
                            <p style="margin: 0; font-size: 18px; color: ${c};">Best Regards</p>
                            <p style="margin: 0; font-size: 18px; font-weight: bold; color: ${c};">${o}</p>
                            <p style="margin: 5px 0 5px 0; font-size: 14px; color: ${v};">${i}</p>
                            <p style="margin: 0 0 15px 0; font-size: 12px; color: ${v};">
                                Your website and social media are like your home, first impressions matter!
                            </p>
                            <table role="presentation" cellspacing="0" cellpadding="0">
                                <tr>
                                    <td style="padding-right: 15px;">
                                        <p style="margin: 0; font-size: 13px; color: ${v};">📞 ${a}</p>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: ${v};">🌐 <a href="https://${u}" target="_blank" style="color: ${r}; text-decoration: none;">${u}</a></p>
                                    </td>
                                </tr>
                            </table>
                            <div style="margin-top: 15px; text-align: left;">
                                <a href="https://www.facebook.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${w}" alt="Facebook" style="vertical-align: middle;">
                                </a>
                                <a href="https://twitter.com/yourhandle" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${E}" alt="Twitter" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.linkedin.com/in/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${f}" alt="LinkedIn" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.instagram.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${r}; text-decoration: none;">
                                    <img src="${h}" alt="Instagram" style="vertical-align: middle;">
                                </a>
                            </div>
                        </td>
                        <td style="padding-left: 20px; vertical-align: middle; width: 120px; text-align: right;">
                            <img src="${k}" alt="Company Logo" width="100" style="display: block; border-radius: 8px; margin-left: auto;">
                        </td>
                    </tr>
                </table>

                <p style="margin-top: 25px; font-size: 12px; color: ${v}; text-align: center;">
                    Powered by MMS IT & Web Solutions PTY Ltd.
                </p>
                <p style="margin-top: 10px; font-style: italic; color: ${v}; text-align: center; font-size: 13px;">
                    Please consider the environment before printing this email.
                </p>
                <p style="margin-top: 10px; text-align: center; font-size: 13px;">
                    How did I do? <a href="https://www.example.com/review" target="_blank" style="color: ${r}; text-decoration: none; font-weight: bold;">Leave a review!</a>
                </p>
            </div>
        `})}}const Ho={class:"mb-4"},Wo={key:0,class:"text-gray-500 text-sm"},Yo={key:1,class:"text-red-500 text-sm"},zo={class:"mb-4"},qo={class:"mb-6"},Go={class:"mb-2 flex justify-end space-x-2"},Ko={class:"mb-4"},Jo={key:0,class:"mt-2"},Zo={class:"text-gray-700 text-base mb-2"},Xo=["innerHTML"],Qo={class:"p-6"},er={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},tr={class:"block sm:inline"},sr={class:"mb-4"},lr={class:"mb-6"},ar={class:"flex justify-end space-x-3"},ir={class:"p-6"},nr={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},or={class:"block sm:inline"},rr={class:"mb-4"},dr={class:"mb-6"},ur={class:"flex justify-end space-x-3"},cr={__name:"ComponseEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},userProjectRole:{type:Object,required:!0}},emits:["close","submitted","error"],setup(l,{emit:t}){const s=l,o=t,i=ke({project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),a=x([]),u=x(!0),r=x(""),m=x(!1),c=x(""),v=x(""),y=x(""),_=x(!1),k=x(""),w=x("bullet"),E=x(""),f=x("full_name"),h=x(""),T=x([{value:"full_name",label:"Full Name"},{value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"custom",label:"Custom"}]),{userSignature:A}=Bo(P(()=>s.userProjectRole)),N=P(()=>i.body||""),{processedHtmlBody:I}=xt(N),Y=P(()=>{if(i.client_ids&&i.client_ids.length>0){const D=i.client_ids[0],$=a.value.find(H=>H.id===D);if($){const H=$.name.split(" ").filter(X=>X.length>0),oe=H.length>0?H[0]:"",Ve=H.length>1?H[H.length-1]:"";switch(f.value){case"full_name":return`Hi ${$.name},`;case"first_name":return`Hi ${oe},`;case"last_name":return`Hi ${Ve},`;case"custom":return`Hi ${h.value.trim()||"there"},`;default:return`Hi ${$.name},`}}}return"Hi there,"});re(()=>s.show,D=>{D&&(Object.assign(i,{project_id:s.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),f.value="full_name",h.value="",r.value="",b())},{immediate:!0});const B=D=>{const $={...D};return $.client_ids&&Array.isArray($.client_ids)&&($.client_ids=$.client_ids.map(H=>({id:H}))),$.body=I.value,$.greeting_name=Y.value,$.custom_greeting_name=h.value.trim(),$.first_client_id=i.client_ids&&i.client_ids.length>0?i.client_ids[0]:null,$},S=()=>{o("close")},V=D=>{o("submitted",D)},M=D=>{o("error",D)},O=()=>{c.value="",v.value="",y.value="",m.value=!0},G=()=>{if(!c.value.trim()){y.value="Link text cannot be empty.";return}let D=v.value.trim();!D.startsWith("http://")&&!D.startsWith("https://")&&(D="http://"+D);try{new URL(D)}catch{y.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const $=`[${c.value.trim()}] {${D}}`;i.body+=$,m.value=!1,c.value="",v.value="",y.value=""},U=()=>{k.value="",w.value="bullet",E.value="",_.value=!0},j=()=>{const D=k.value.split(`
`).map(oe=>oe.trim()).filter(oe=>oe!=="");if(D.length===0){E.value="Please enter at least one list item.";return}const $=w.value==="bullet"?"ul":"ol";let H=`<${$}>`;D.forEach(oe=>{H+=`<li>${oe}</li>`}),H+=`</${$}>`,i.body+=H,_.value=!1,k.value="",E.value=""},b=async()=>{var D,$;u.value=!0,r.value=null;try{const H=await window.axios.get(`/api/projects/${s.projectId}/sections/clients?type=clients`);a.value=H.data}catch(H){console.error("Failed to fetch project clients:",H),r.value=(($=(D=H.response)==null?void 0:D.data)==null?void 0:$.message)||"Failed to load client data."}finally{u.value=!1}};return be(()=>{}),(D,$)=>(n(),d(Z,null,[p(Ee,{show:l.show,title:"Compose New Email","api-endpoint":"/api/emails","http-method":"post","form-data":i,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","format-data-for-api":B,onClose:S,onSubmitted:V,onError:M,"max-width":"3xl"},{default:L(({errors:H})=>[e("div",Ho,[p(W,{for:"client_ids",value:"To (Clients)"}),u.value?(n(),d("div",Wo,"Loading clients...")):r.value?(n(),d("div",Yo,g(r.value),1)):(n(),le(He,{key:2,modelValue:i.client_ids,"onUpdate:modelValue":$[0]||($[0]=oe=>i.client_ids=oe),options:a.value,placeholder:"Select one or more clients","label-key":"name","value-key":"id"},null,8,["modelValue","options"])),p(ae,{message:H.client_ids?H.client_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",zo,[p(W,{for:"subject",value:"Subject"}),p(ne,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:i.subject,"onUpdate:modelValue":$[1]||($[1]=oe=>i.subject=oe),required:""},null,8,["modelValue"]),p(ae,{message:H.subject?H.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",qo,[e("div",Go,[p(ye,{type:"button",onClick:U},{default:L(()=>$[13]||($[13]=[R(" Insert List ",-1)])),_:1,__:[13]}),p(ye,{type:"button",onClick:O},{default:L(()=>$[14]||($[14]=[R(" Insert Link ",-1)])),_:1,__:[14]})]),e("div",Ko,[p(W,{for:"greeting_type",value:"Address Client By"}),p(pe,{id:"greeting_type",modelValue:f.value,"onUpdate:modelValue":$[2]||($[2]=oe=>f.value=oe),options:T.value,"value-key":"value","label-key":"label",class:"mt-1 block w-full"},null,8,["modelValue","options"]),f.value==="custom"?(n(),d("div",Jo,[p(W,{for:"custom_greeting_name",value:"Custom Name"}),p(ne,{id:"custom_greeting_name",type:"text",class:"mt-1 block w-full",modelValue:h.value,"onUpdate:modelValue":$[3]||($[3]=oe=>h.value=oe),placeholder:"e.g., Azaan"},null,8,["modelValue"])])):C("",!0)]),e("p",Zo,g(Y.value),1),p(W,{for:"body",value:"Email Body",class:"sr-only"}),p(bt,{id:"body",modelValue:i.body,"onUpdate:modelValue":$[4]||($[4]=oe=>i.body=oe),placeholder:"Compose your email here...",height:"300px"},null,8,["modelValue"]),p(ae,{message:H.body?H.body[0]:"",class:"mt-2"},null,8,["message"])]),K(A)?(n(),d("div",{key:0,class:"unselectable-signature",innerHTML:K(A)},null,8,Xo)):C("",!0)]),_:1},8,["show","form-data"]),p(Se,{show:m.value,onClose:$[8]||($[8]=H=>m.value=!1),"max-width":"md"},{default:L(()=>[e("div",Qo,[$[17]||($[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),y.value?(n(),d("div",er,[e("span",tr,g(y.value),1)])):C("",!0),e("div",sr,[p(W,{for:"link_text",value:"Link Text"}),p(ne,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:c.value,"onUpdate:modelValue":$[5]||($[5]=H=>c.value=H),onKeyup:Oe(G,["enter"])},null,8,["modelValue"])]),e("div",lr,[p(W,{for:"link_url",value:"URL"}),p(ne,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:v.value,"onUpdate:modelValue":$[6]||($[6]=H=>v.value=H),placeholder:"e.g., https://www.example.com",onKeyup:Oe(G,["enter"])},null,8,["modelValue"])]),e("div",ar,[p(ye,{onClick:$[7]||($[7]=H=>m.value=!1)},{default:L(()=>$[15]||($[15]=[R("Cancel",-1)])),_:1,__:[15]}),p(ue,{onClick:G},{default:L(()=>$[16]||($[16]=[R("Insert",-1)])),_:1,__:[16]})])])]),_:1},8,["show"]),p(Se,{show:_.value,onClose:$[12]||($[12]=H=>_.value=!1),"max-width":"md"},{default:L(()=>[e("div",ir,[$[21]||($[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),E.value?(n(),d("div",nr,[e("span",or,g(E.value),1)])):C("",!0),e("div",rr,[p(W,{for:"list_items",value:"List Items (one per line)"}),ce(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":$[9]||($[9]=H=>k.value=H),placeholder:"Enter each list item on a new line"},null,512),[[fe,k.value]])]),e("div",dr,[p(W,{for:"list_type",value:"List Type"}),ce(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":$[10]||($[10]=H=>w.value=H)},$[18]||($[18]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[We,w.value]])]),e("div",ur,[p(ye,{onClick:$[11]||($[11]=H=>_.value=!1)},{default:L(()=>$[19]||($[19]=[R("Cancel",-1)])),_:1,__:[19]}),p(ue,{onClick:j},{default:L(()=>$[20]||($[20]=[R("Insert List",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])],64))}},kt=Ce(cr,[["__scopeId","data-v-70bf1503"]]),mr={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},vr={class:"flex justify-between items-center mb-4"},pr={key:0,class:"flex gap-3"},hr={key:1,class:"mt-2 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative",role:"alert"},gr={class:"block sm:inline"},yr={class:"mb-4 bg-gray-50 p-4 rounded-lg"},fr={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},br={class:"mt-1 relative rounded-md shadow-sm"},_r={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},wr={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},xr={key:2,class:"overflow-x-auto"},kr={class:"min-w-full divide-y divide-gray-200"},Dr={class:"bg-white divide-y divide-gray-200"},Cr={class:"px-4 py-3 text-sm text-gray-900"},$r={class:"px-4 py-3 text-sm text-gray-700"},Sr={class:"px-4 py-3 text-sm text-gray-700"},Er={class:"px-4 py-3 text-sm text-gray-700"},Mr={class:"px-4 py-3 text-sm text-gray-700"},Tr={class:"px-4 py-3 text-right"},jr={key:3,class:"text-gray-400 text-sm"},Vr={class:"p-6"},Ar={class:"flex justify-between items-center mb-4"},Ir={key:0,class:"space-y-4"},Or={class:"border-b pb-4"},Lr={class:"text-xl font-medium text-gray-900 mb-2"},Ur={class:"grid grid-cols-2 gap-4 text-sm"},Nr={class:"text-gray-600"},Pr={class:"text-gray-900"},Rr={class:"text-gray-600 mt-1"},Fr={class:"text-gray-600"},Br={class:"text-gray-900"},Hr={class:"prose max-w-none"},Wr=["innerHTML"],Yr={key:0,class:"mt-4 p-4 bg-red-50 rounded-md"},zr={class:"text-red-700"},qr={key:1,class:"mt-4 text-sm text-gray-600"},Gr={key:0},Kr={key:2,class:"mt-6 flex justify-end space-x-2"},Jr={__name:"ProjectEmailsTab",props:{projectId:{type:Number,required:!0},canViewEmails:{type:Boolean,required:!0},canComposeEmails:{type:Boolean,required:!0},canApproveEmails:{type:Boolean,required:!0},userProjectRole:{type:Object,required:!0},openCompose:{type:Boolean,required:!1,default:!1}},emits:["emailsUpdated","resetOpenCompose"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(""),r=x(null),m=x(!1),c=x(!1),v=x(""),y=x(""),_=x("post"),k=x(""),w=x(""),E=ke({}),f=x(!1);Le();const h=ke({type:"",startDate:"",endDate:"",search:""});let T=null;const A=()=>{Y()},N=()=>{h.type="",h.startDate="",h.endDate="",h.search="",Y()},I=()=>{clearTimeout(T),T=setTimeout(()=>{A()},500)},Y=async()=>{a.value=!0,u.value="";try{const j=new URLSearchParams;h.type&&j.append("type",h.type),h.startDate&&j.append("start_date",h.startDate),h.endDate&&j.append("end_date",h.endDate),h.search&&j.append("search",h.search);const b=j.toString(),D=`/api/projects/${s.projectId}/emails-simplified${b?`?${b}`:""}`,$=await window.axios.get(D);i.value=$.data,o("emailsUpdated",i.value)}catch(j){u.value="Failed to load email data.",console.error("Error fetching project emails:",j)}finally{a.value=!1}},B=async j=>{r.value=null,m.value=!0;try{const b=await window.axios.get(`/api/emails/${j.id}`);r.value={...j,subject:b.data.subject,body:b.data.body_html}}catch(b){console.error("Failed to fetch full email details:",b),r.value={subject:"Error",body:"Failed to load email content.",created_at:new Date().toISOString(),status:"error",sender:{name:"System"}}}},S=async j=>{try{const D=(await window.axios.get(`/api/emails/${j.id}`)).data;r.value=D,v.value="Edit and Approve Email",y.value=`/api/emails/${D.id}/edit-and-approve`,_.value="post",k.value="Approve & Send",w.value="Email updated and approved successfully!",Object.assign(E,D),c.value=!0,m.value=!1}catch(b){console.error("Failed to fetch email details for editing:",b),u.value="Failed to load email for editing."}},V=j=>{r.value=j,v.value="Reject Email",y.value=`/api/emails/${j.id}/reject`,_.value="post",k.value="Reject Email",w.value="Email rejected successfully!",Object.assign(E,{rejection_reason:""}),c.value=!0,m.value=!1},M=async j=>{console.log("Form submitted successfully:",j),await Y(),c.value=!1},O=()=>{c.value=!1},G=()=>{f.value=!1,o("resetOpenCompose")},U=async j=>{console.log("Compose email submitted successfully:",j),await Y(),f.value=!1,o("resetOpenCompose")};return re(()=>s.openCompose,j=>{console.log("Watcher triggered: openCompose changed to",j),j&&(console.log("Opening compose email modal"),f.value=!0)}),be(()=>{s.canViewEmails&&Y(),s.openCompose&&(f.value=!0)}),(j,b)=>{var D;return l.canViewEmails?(n(),d("div",mr,[e("div",vr,[b[12]||(b[12]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Email Communication",-1)),l.canComposeEmails?(n(),d("div",pr,[p(ue,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:b[0]||(b[0]=$=>f.value=!0)},{default:L(()=>b[11]||(b[11]=[R(" Compose Email ",-1)])),_:1,__:[11]})])):C("",!0),u.value?(n(),d("div",hr,[e("span",gr,g(u.value),1)])):C("",!0)]),e("div",yr,[e("div",fr,[e("div",null,[p(W,{for:"typeFilter",value:"Type"}),ce(e("select",{id:"typeFilter","onUpdate:modelValue":b[1]||(b[1]=$=>h.type=$),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:A},b[13]||(b[13]=[e("option",{value:""},"All Types",-1),e("option",{value:"sent"},"Sent",-1),e("option",{value:"received"},"Received",-1)]),544),[[We,h.type]])]),e("div",null,[p(W,{for:"startDate",value:"From Date"}),p(ne,{type:"date",id:"startDate",modelValue:h.startDate,"onUpdate:modelValue":b[2]||(b[2]=$=>h.startDate=$),class:"mt-1 block w-full",onChange:A},null,8,["modelValue"])]),e("div",null,[p(W,{for:"endDate",value:"To Date"}),p(ne,{type:"date",id:"endDate",modelValue:h.endDate,"onUpdate:modelValue":b[3]||(b[3]=$=>h.endDate=$),class:"mt-1 block w-full",onChange:A},null,8,["modelValue"])]),e("div",null,[p(W,{for:"searchFilter",value:"Search Content"}),e("div",br,[p(ne,{type:"text",id:"searchFilter",modelValue:h.search,"onUpdate:modelValue":b[4]||(b[4]=$=>h.search=$),class:"block w-full pr-10",placeholder:"Search in email content...",onInput:I},null,8,["modelValue"]),b[14]||(b[14]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:N}," Reset Filters ")])]),a.value?(n(),d("div",_r," Loading email data... ")):u.value?(n(),d("div",wr,g(u.value),1)):i.value.length?(n(),d("div",xr,[e("table",kr,[b[16]||(b[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Dr,[(n(!0),d(Z,null,ee(i.value,$=>{var H;return n(),d("tr",{key:$.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Cr,g($.subject),1),e("td",$r,g(((H=$.sender)==null?void 0:H.name)||"N/A"),1),e("td",Sr,g(new Date($.created_at).toLocaleDateString()),1),e("td",Er,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":$.type==="sent","bg-purple-100 text-purple-800":$.type==="received"})},g($.type?$.type.toUpperCase():"N/A"),3)]),e("td",Mr,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":$.status==="sent","bg-yellow-100 text-yellow-800":$.status==="pending_approval","bg-red-100 text-red-800":$.status==="rejected","bg-gray-100 text-gray-800":$.status==="draft"})},g($.status?$.status.replace("_"," ").toUpperCase():"N/A"),3)]),e("td",Tr,[p(ye,{class:"text-indigo-600 hover:text-indigo-800",onClick:oe=>B($)},{default:L(()=>b[15]||(b[15]=[R(" View ",-1)])),_:2,__:[15]},1032,["onClick"])])])}),128))])])])):(n(),d("p",jr,"No email communication found.")),p(Se,{show:m.value,onClose:b[8]||(b[8]=$=>m.value=!1)},{default:L(()=>{var $;return[e("div",Vr,[e("div",Ar,[b[18]||(b[18]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Email Details",-1)),e("button",{onClick:b[5]||(b[5]=H=>m.value=!1),class:"text-gray-400 hover:text-gray-500"},b[17]||(b[17]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),r.value?(n(),d("div",Ir,[e("div",Or,[e("h4",Lr,g(r.value.subject),1),e("div",Ur,[e("div",null,[e("p",Nr,[b[19]||(b[19]=R("From: ",-1)),e("span",Pr,g((($=r.value.sender)==null?void 0:$.name)||"N/A"),1)]),e("p",Rr,[b[20]||(b[20]=R("Status: ",-1)),e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":r.value.status==="sent","bg-yellow-100 text-yellow-800":r.value.status==="pending_approval","bg-red-100 text-red-800":r.value.status==="rejected","bg-gray-100 text-gray-800":r.value.status==="draft"})},g(r.value.status?r.value.status.replace("_"," ").toUpperCase():"N/A"),3)])]),e("div",null,[e("p",Fr,[b[21]||(b[21]=R("Date: ",-1)),e("span",Br,g(new Date(r.value.created_at).toLocaleString()),1)])])])]),e("div",Hr,[e("div",{innerHTML:r.value.body},null,8,Wr)]),r.value.rejection_reason?(n(),d("div",Yr,[b[22]||(b[22]=e("h5",{class:"font-medium text-red-800"},"Rejection Reason:",-1)),e("p",zr,g(r.value.rejection_reason),1)])):C("",!0),r.value.approver?(n(),d("div",qr,[e("p",null,"Approved/Rejected by: "+g(r.value.approver.name),1),r.value.sent_at?(n(),d("p",Gr,"Sent at: "+g(new Date(r.value.sent_at).toLocaleString()),1)):C("",!0)])):C("",!0),(r.value.status==="pending_approval"||r.value.status==="pending_approval_received")&&l.canApproveEmails?(n(),d("div",Kr,[p(ue,{onClick:b[6]||(b[6]=H=>S(r.value)),class:"bg-blue-600 hover:bg-blue-700"},{default:L(()=>b[23]||(b[23]=[R("Edit & Approve",-1)])),_:1,__:[23]}),p(ye,{onClick:b[7]||(b[7]=H=>V(r.value)),class:"text-red-600 hover:text-red-800"},{default:L(()=>b[24]||(b[24]=[R("Reject",-1)])),_:1,__:[24]})])):C("",!0)])):C("",!0)])]}),_:1},8,["show"]),p(kt,{show:f.value,"project-id":l.projectId,"user-project-role":l.userProjectRole,onClose:G,onSubmitted:U,onError:b[9]||(b[9]=$=>console.error("ComposeEmailModal error:",$))},null,8,["show","project-id","user-project-role"]),p(Fo,{show:c.value,title:v.value,"api-endpoint":y.value,"http-method":_.value,"initial-form-data":E,"submit-button-text":k.value,"success-message":w.value,"email-id":(D=r.value)==null?void 0:D.id,"project-id":l.projectId,onClose:O,onSubmitted:M,onError:b[10]||(b[10]=$=>console.error("EmailActionModal error:",$))},null,8,["show","title","api-endpoint","http-method","initial-form-data","submit-button-text","success-message","email-id","project-id"])])):C("",!0)}}},Zr={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Xr={class:"flex justify-between items-center mb-4"},Qr={class:"flex gap-3"},ed={class:"mb-4 bg-gray-50 p-4 rounded-lg"},td={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},sd={class:"mt-1 relative rounded-md shadow-sm"},ld={class:"mb-8 p-4 bg-blue-50 rounded-md"},ad={class:"flex items-center"},id={class:"text-sm text-blue-800"},nd={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},od={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},rd={key:2,class:"space-y-4"},dd={class:"flex justify-between"},ud={class:"flex-grow"},cd={key:0,class:"text-xs text-red-400 block mt-1"},md={class:"flex items-center mt-1"},vd={class:"text-xs text-gray-500"},pd={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},hd={key:0},gd={key:3,class:"text-gray-400 text-sm"},yd={class:"p-6"},fd={class:"flex justify-between items-center mb-4"},bd={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},_d={class:"text-sm text-gray-700"},wd={class:"text-xs text-gray-500 mt-1"},xd={key:1,class:"mb-4"},kd={key:0,class:"text-center py-4"},Dd={key:1,class:"space-y-3 max-h-60 overflow-y-auto"},Cd={class:"text-sm text-gray-700"},$d={class:"text-xs text-gray-500 mt-1"},Sd={key:2,class:"text-center py-3"},Ed={key:2,class:"mb-4"},Md={key:0,class:"mt-2 text-sm text-red-600"},Td={key:3,class:"mt-6 flex justify-end"},jd={__name:"ProjectNotesTab",props:{projectId:{type:Number,required:!0},googleChatId:{type:String,default:null},canViewNotes:{type:Boolean,required:!0},canAddNotes:{type:Boolean,required:!0}},emits:["notesUpdated"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(""),r=x(!1),m=x(!1),c=x(null),v=x(""),y=x(""),_=x([]),k=x(!1),w=ke({startDate:"",endDate:"",search:""});let E=null;const f=async()=>{a.value=!0,u.value="";try{const B=new URLSearchParams;w.startDate&&B.append("start_date",w.startDate),w.endDate&&B.append("end_date",w.endDate),w.search&&B.append("search",w.search);const S=B.toString(),V=`/api/projects/${s.projectId}/notes${S?`?${S}`:""}`,M=await window.axios.get(V);i.value=M.data,o("notesUpdated",i.value)}catch(B){u.value="Failed to load notes data.",console.error("Error fetching project notes:",B)}finally{a.value=!1}},h=()=>{r.value=!0},T=async B=>{c.value=B,v.value="",y.value="",_.value=[],k.value=!0,m.value=!0;try{const S=await window.axios.get(`/api/projects/${s.projectId}/notes/${B.id}/replies`);S.data.success?_.value=S.data.replies:console.error("Failed to fetch replies:",S.data.message)}catch(S){console.error("Error fetching replies:",S)}finally{k.value=!1}},A=async()=>{var B,S;if(!c.value||!v.value.trim()){y.value="Reply content is required";return}y.value="";try{const V=await window.axios.post(`/api/projects/${s.projectId}/notes/${c.value.id}/reply`,{content:v.value});if(V.data.success){v.value="",k.value=!0;const M=await window.axios.get(`/api/projects/${s.projectId}/notes/${c.value.id}/replies`);M.data.success&&(_.value=M.data.replies),k.value=!1,await f()}else y.value=V.data.message||"Failed to send reply"}catch(V){console.error("Error sending reply:",V),y.value=((S=(B=V.response)==null?void 0:B.data)==null?void 0:S.message)||"An error occurred while sending the reply"}},N=()=>{f()},I=()=>{w.startDate="",w.endDate="",w.search="",f()},Y=()=>{clearTimeout(E),E=setTimeout(()=>{N()},500)};return be(()=>{s.canViewNotes&&f()}),(B,S)=>l.canViewNotes?(n(),d("div",Zr,[e("div",Xr,[S[10]||(S[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Notes",-1)),e("div",Qr,[l.canAddNotes?(n(),le(ue,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:h},{default:L(()=>S[9]||(S[9]=[R(" Add Note ",-1)])),_:1,__:[9]})):C("",!0)])]),e("div",ed,[e("div",td,[e("div",null,[p(W,{for:"noteStartDate",value:"From Date"}),p(ne,{type:"date",id:"noteStartDate",modelValue:w.startDate,"onUpdate:modelValue":S[0]||(S[0]=V=>w.startDate=V),class:"mt-1 block w-full",onChange:N},null,8,["modelValue"])]),e("div",null,[p(W,{for:"noteEndDate",value:"To Date"}),p(ne,{type:"date",id:"noteEndDate",modelValue:w.endDate,"onUpdate:modelValue":S[1]||(S[1]=V=>w.endDate=V),class:"mt-1 block w-full",onChange:N},null,8,["modelValue"])]),e("div",null,[p(W,{for:"noteSearchFilter",value:"Search Content"}),e("div",sd,[p(ne,{type:"text",id:"noteSearchFilter",modelValue:w.search,"onUpdate:modelValue":S[2]||(S[2]=V=>w.search=V),class:"block w-full pr-10",placeholder:"Search in note content...",onInput:Y},null,8,["modelValue"]),S[11]||(S[11]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:I}," Reset Filters ")])]),e("div",ld,[e("div",ad,[S[13]||(S[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",id,[S[12]||(S[12]=R(" Daily Standups are now available in their own dedicated tab. ",-1)),e("button",{onClick:S[3]||(S[3]=V=>B.$emit("changeTab","standups")),class:"text-blue-600 hover:text-blue-800 font-medium underline"}," Click here to view Daily Standups ")])])]),e("div",null,[S[15]||(S[15]=e("h5",{class:"text-md font-semibold text-gray-900 mb-4 border-b pb-2"},"Notes",-1)),a.value?(n(),d("div",nd," Loading notes... ")):u.value?(n(),d("div",od,g(u.value),1)):i.value.length?(n(),d("div",rd,[(n(!0),d(Z,null,ee(i.value,V=>{var M;return n(),d("div",{key:V.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",dd,[e("div",ud,[e("p",{class:Q(["text-sm",{"text-gray-700":V.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":V.content==="[Encrypted content could not be decrypted]"}])},[R(g(V.content)+" ",1),V.content==="[Encrypted content could not be decrypted]"?(n(),d("span",cd," (There was an issue decrypting this note. Please contact an administrator.) ")):C("",!0)],2),e("div",md,[e("p",vd,"Added by "+g(((M=V.user)==null?void 0:M.name)||"Unknown")+" on "+g(new Date(V.created_at).toLocaleDateString()),1),V.reply_count>0?(n(),d("span",pd,g(V.reply_count)+" "+g(V.reply_count===1?"reply":"replies"),1)):C("",!0)])]),l.googleChatId&&V.chat_message_id?(n(),d("div",hd,[p(ye,{class:"text-sm text-indigo-600 hover:text-indigo-800",onClick:O=>T(V)},{default:L(()=>S[14]||(S[14]=[R(" View ",-1)])),_:2,__:[14]},1032,["onClick"])])):C("",!0)])])}),128))])):(n(),d("p",gd,"No notes available."))]),p(ft,{show:r.value,"project-id":l.projectId,onClose:S[4]||(S[4]=V=>r.value=!1),onNoteAdded:f},null,8,["show","project-id"]),p(Se,{show:m.value,onClose:S[8]||(S[8]=V=>m.value=!1)},{default:L(()=>{var V;return[e("div",yd,[e("div",fd,[S[17]||(S[17]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Reply to Note",-1)),e("button",{onClick:S[5]||(S[5]=M=>m.value=!1),class:"text-gray-400 hover:text-gray-500"},S[16]||(S[16]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),c.value?(n(),d("div",bd,[e("p",_d,g(c.value.content),1),e("p",wd,"Added by "+g(((V=c.value.user)==null?void 0:V.name)||"Unknown")+" on "+g(new Date(c.value.created_at).toLocaleDateString()),1)])):C("",!0),c.value?(n(),d("div",xd,[S[20]||(S[20]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Replies",-1)),k.value?(n(),d("div",kd,S[18]||(S[18]=[e("p",{class:"text-gray-500 text-sm"},"Loading replies...",-1)]))):_.value.length?(n(),d("div",Dd,[(n(!0),d(Z,null,ee(_.value,M=>{var O;return n(),d("div",{key:M.id,class:"p-2 bg-gray-50 rounded border-l-2 border-indigo-300"},[e("p",Cd,g(M.content),1),e("p",$d,"Replied by "+g(((O=M.user)==null?void 0:O.name)||"Unknown")+" on "+g(new Date(M.created_at).toLocaleDateString()),1)])}),128))])):(n(),d("div",Sd,S[19]||(S[19]=[e("p",{class:"text-gray-500 text-sm"},"No replies yet. Be the first to reply!",-1)])))])):C("",!0),l.canAddNotes?(n(),d("div",Ed,[p(W,{for:"reply-content",value:"Your Reply"}),ce(e("textarea",{id:"reply-content","onUpdate:modelValue":S[6]||(S[6]=M=>v.value=M),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your reply..."},null,512),[[fe,v.value]]),y.value?(n(),d("p",Md,g(y.value),1)):C("",!0)])):C("",!0),l.canAddNotes?(n(),d("div",Td,[p(ye,{onClick:S[7]||(S[7]=M=>m.value=!1),class:"mr-2"},{default:L(()=>S[21]||(S[21]=[R("Cancel",-1)])),_:1,__:[21]}),p(ue,{onClick:A},{default:L(()=>S[22]||(S[22]=[R("Send Reply",-1)])),_:1,__:[22]})])):C("",!0)])]}),_:1},8,["show"])])):C("",!0)}},Vd={class:"w-full"},Ad={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Id={key:1,class:"text-red-600 text-sm py-2 text-center"},Od={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Ld={class:"p-4 bg-blue-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Ud={class:"text-2xl font-bold text-blue-900 mt-1"},Nd={class:"p-4 bg-green-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Pd={class:"text-2xl font-bold text-green-900 mt-1"},Rd={class:"p-4 bg-red-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},Fd={class:"text-2xl font-bold mt-1"},Bd={key:3,class:"space-y-2 text-sm text-gray-700 mt-6 pt-4 border-t border-gray-200"},Hd={key:0},Wd={class:"text-gray-900 whitespace-pre-wrap"},Yd={key:4,class:"text-gray-400 text-sm mt-4 text-center"},zd={__name:"ProjectFinancialsCard",props:{projectId:{type:Number,required:!0},canViewProjectServicesAndPayments:{type:Boolean,default:!1},canViewProjectTransactions:{type:Boolean,default:!1}},setup(l){const t=l,s=x(null),o=x([]),i=x(!0),a=x(null),u=Be,r=P(()=>{var k;if(!he.value||Object.keys(he.value).length===0)return 0;const _=parseFloat(((k=s.value)==null?void 0:k.total_amount)||0);return Ie(_,"USD",u.value)}),m=P(()=>!o.value.length||!he.value||Object.keys(he.value).length===0?0:o.value.filter(_=>_.type==="expense").reduce((_,k)=>_+Ie(parseFloat(k.amount||0),k.currency,u.value),0)),c=P(()=>!o.value.length||!he.value||Object.keys(he.value).length===0?0:o.value.filter(_=>_.type==="income").reduce((_,k)=>_+Ie(parseFloat(k.amount||0),k.currency,u.value),0)),v=P(()=>c.value-m.value),y=async()=>{var _,k;if(i.value=!0,a.value=null,o.value=[],!he.value||Object.keys(he.value).length===0){a.value="Currency rates not loaded. Please try again.",i.value=!1;return}if(!t.canViewProjectServicesAndPayments&&!t.canViewProjectTransactions){a.value="You don't have permission to view project financials.",i.value=!1;return}try{if(t.canViewProjectServicesAndPayments){const w=await window.axios.get(`/api/projects/${t.projectId}/sections/services-payment`);s.value=w.data}else s.value=null;if(t.canViewProjectTransactions){const w=await window.axios.get(`/api/projects/${t.projectId}/sections/transactions`);o.value=w.data}else o.value=[]}catch(w){console.error("Failed to fetch project financials:",w),a.value=((k=(_=w.response)==null?void 0:_.data)==null?void 0:k.message)||"Failed to load financial data."}finally{i.value=!1}};return re([()=>t.canViewProjectServicesAndPayments,()=>t.canViewProjectTransactions,u,he],(_,k)=>{t.projectId&&he.value&&Object.keys(he.value).length>0?y():t.projectId||(i.value=!0,a.value=null)},{immediate:!0,deep:!0}),(_,k)=>{var w,E;return n(),d("div",Vd,[i.value?(n(),d("div",Ad,[(n(),d(Z,null,ee(4,f=>e("div",{key:f,class:"p-4 bg-gray-100 rounded-lg animate-pulse h-24"},k[0]||(k[0]=[e("div",{class:"h-4 bg-gray-200 rounded w-1/2 mb-3"},null,-1),e("div",{class:"h-6 bg-gray-200 rounded w-3/4"},null,-1)]))),64))])):a.value?(n(),d("div",Id,[e("p",null,g(a.value),1)])):(n(),d("div",Od,[e("div",Ld,[k[1]||(k[1]=e("p",{class:"text-sm font-medium text-blue-800"},"Contract Value",-1)),e("p",Ud,g(K(je)(r.value,K(u).value)),1)]),e("div",Nd,[k[2]||(k[2]=e("p",{class:"text-sm font-medium text-green-800"},"Total Income",-1)),e("p",Pd,g(K(je)(c.value,K(u))),1)]),e("div",Rd,[k[3]||(k[3]=e("p",{class:"text-sm font-medium text-red-800"},"Total Expenses",-1)),e("p",Fd,g(K(je)(m.value,K(u))),1)]),e("div",{class:Q(["p-4 rounded-lg shadow-sm transition-shadow hover:shadow-lg",{"bg-green-100":v.value>=0,"bg-red-100":v.value<0}])},[e("p",{class:Q(["text-sm font-medium",{"text-green-800":v.value>=0,"text-red-800":v.value<0}])},"Profit/Loss",2),e("p",{class:Q(["text-2xl font-bold mt-1",{"text-green-900":v.value>=0,"text-red-900":v.value<0}])},g(K(je)(v.value,K(u))),3)],2)])),!i.value&&!a.value&&((w=s.value)!=null&&w.contract_details)?(n(),d("dl",Bd,[(E=s.value)!=null&&E.contract_details?(n(),d("div",Hd,[k[4]||(k[4]=e("dt",{class:"font-medium w-full block mt-2"},"Contract Details:",-1)),e("dd",Wd,g(s.value.contract_details),1)])):C("",!0)])):C("",!0),!i.value&&!a.value&&!s.value&&!o.value.length?(n(),d("p",Yd," No financial information available. ")):C("",!0)])}}},qd={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},Gd={key:0},Kd={key:1,class:"text-red-600 text-sm py-2"},Jd={key:2,class:"space-y-1 text-sm text-gray-700"},Zd={key:0},Xd={key:3,class:"text-gray-400 text-sm"},Qd={__name:"ProjectClientsCard",props:{projectId:{type:Number,required:!0},canViewClientContacts:{type:Boolean,default:!1}},setup(l){const t=l,s=x([]),o=x(!0),i=x(null),a=async()=>{var u,r;if(o.value=!0,i.value=null,!t.canViewClientContacts){i.value="You don't have permission to view project clients.",o.value=!1;return}try{const m=await window.axios.get(`/api/projects/${t.projectId}/sections/clients?type=clients`);s.value=m.data}catch(m){console.error("Failed to fetch project clients:",m),i.value=((r=(u=m.response)==null?void 0:u.data)==null?void 0:r.message)||"Failed to load client data."}finally{o.value=!1}};return be(()=>{a()}),re(()=>t.canViewClientContacts,()=>{a()}),(u,r)=>(n(),d("div",qd,[r[1]||(r[1]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Clients",-1)),o.value?(n(),d("div",Gd,r[0]||(r[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):i.value?(n(),d("div",Kd,[e("p",null,g(i.value),1)])):s.value.length?(n(),d("ul",Jd,[(n(!0),d(Z,null,ee(s.value,m=>(n(),d("li",{key:m.id},[R(g(m.name)+" ",1),m.email?(n(),d("span",Zd,"("+g(m.email)+")",1)):C("",!0)]))),128))])):(n(),d("p",Xd,"No clients assigned."))]))}},eu={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},tu={key:0},su={key:1,class:"text-red-600 text-sm py-2"},lu={key:2},au={key:0,class:"space-y-2 text-sm text-gray-700 mb-4"},iu={class:"font-medium"},nu={class:"text-xs text-gray-500 mt-1"},ou={key:1,class:"text-gray-400 text-sm mb-4"},ru={__name:"ProjectTeamCard",props:{projectId:{type:Number,required:!0},canViewUsers:{type:Boolean,default:!1}},setup(l){const t=l,s=Le(),o=x([]),i=x(!0),a=x(null),u=async()=>{var m,c;if(i.value=!0,a.value=null,!t.canViewUsers){a.value="You don't have permission to view project team members.",i.value=!1,o.value=[];return}try{const v=await window.axios.get(`/api/projects/${t.projectId}/sections/users`);o.value=v.data.users||[],console.log("Fetched team users:",o.value)}catch(v){console.error("Failed to fetch project users:",v),a.value=((c=(m=v.response)==null?void 0:m.data)==null?void 0:c.message)||"Failed to load team data."}finally{i.value=!1}},r=m=>{if(!m.availabilities||m.availabilities.length===0)return"No availability submitted for today.";const c=m.availabilities[0];return c.is_available?c.time_slots&&c.time_slots.length>0?`${c.time_slots.map(y=>`${y.start_time}-${y.end_time}`).join(", ")}`:"No specific slots provided.":`Not available today: ${c.reason||"No reason provided"}`};return be(()=>{u()}),re([()=>t.canViewUsers,()=>s.value,()=>t.projectId],()=>{u()},{deep:!0}),(m,c)=>(n(),d("div",eu,[c[3]||(c[3]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Team",-1)),i.value?(n(),d("div",tu,c[0]||(c[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):a.value?(n(),d("div",su,[e("p",null,g(a.value),1)])):(n(),d("div",lu,[o.value.length?(n(),d("ul",au,[(n(!0),d(Z,null,ee(o.value,v=>{var y;return n(),d("li",{key:v.id,class:"border-b pb-2 last:border-b-0"},[e("div",null,[e("strong",null,g(v.name),1),c[1]||(c[1]=R(" (Role: ",-1)),e("span",iu,g(((y=v.pivot)==null?void 0:y.role)||"N/A"),1),c[2]||(c[2]=R(") ",-1))]),e("div",nu," Today's Availability: "+g(r(v)),1)])}),128))])):(n(),d("p",ou,"No team members assigned."))]))]))}},du={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},uu={key:0,class:"space-y-3"},cu={key:1,class:"text-red-600 text-sm py-2 text-center"},mu={key:2},vu={class:"space-y-1 text-sm text-gray-700"},pu={key:0},hu={class:"inline-block text-gray-900"},gu={class:"inline-block text-gray-900"},yu={class:"inline-block text-gray-900"},fu={key:1},bu={key:0,class:"text-gray-400 text-sm"},_u={key:1,class:"text-gray-400 text-sm"},wu={key:0,class:"mt-4 text-right"},xu={__name:"UserFinancialCard",props:{projectId:{type:Number,required:!0}},emits:["viewUserTransactions"],setup(l,{emit:t}){const s=l,o=t,i=Le(),a=x(!0),u=x(null),r=x([]),m=Be,c=async()=>{var E,f;if(a.value=!0,u.value=null,!i.value||!i.value.id||!s.projectId){r.value=[],a.value=!1;return}if(!he.value||Object.keys(he.value).length===0){u.value="Currency rates not loaded. Please try again.",a.value=!1;return}try{const h=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${i.value.id}`);r.value=h.data,console.log("User-specific transactions:",r.value)}catch(h){console.error("Failed to fetch user transactions for UserFinancialsCard:",h),u.value=((f=(E=h.response)==null?void 0:E.data)==null?void 0:f.message)||"Failed to load your financial data.",r.value=[]}finally{a.value=!1}},v=P(()=>!i.value||!i.value.id||!r.value.length||!he.value||Object.keys(he.value).length===0?0:r.value.filter(f=>f.type==="expense").reduce((f,h)=>f+Ie(parseFloat(h.amount||0),h.currency,m.value),0)),y=P(()=>!i.value||!i.value.id||!r.value.length||!he.value||Object.keys(he.value).length===0?0:r.value.filter(f=>f.type==="bonus").reduce((f,h)=>f+Ie(parseFloat(h.amount||0),h.currency,m.value),0)),_=P(()=>!i.value||!i.value.id||!r.value.length||!he.value||Object.keys(he.value).length===0?0:r.value.filter(f=>(f.type==="expense"||f.type==="bonus")&&f.is_paid===1).reduce((f,h)=>f+Ie(parseFloat(h.amount||0),h.currency,m.value),0)),k=P(()=>i.value&&(v.value>0||y.value>0||_.value>0));be(()=>{c()}),re([()=>i.value,()=>s.projectId,m,he],()=>{c()},{deep:!0});const w=()=>{o("viewUserTransactions")};return(E,f)=>(n(),d("div",du,[f[5]||(f[5]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Your Financials",-1)),a.value?(n(),d("div",uu,f[0]||(f[0]=[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"},null,-1)]))):u.value?(n(),d("div",cu,[e("p",null,g(u.value),1)])):(n(),d("div",mu,[e("dl",vu,[k.value?(n(),d("div",pu,[e("div",null,[f[1]||(f[1]=e("dt",{class:"font-medium inline-block w-32"},"Agreed Amount:",-1)),e("dd",hu,g(K(je)(v.value,K(m))),1)]),e("div",null,[f[2]||(f[2]=e("dt",{class:"font-medium inline-block w-32"},"Bonus Amount:",-1)),e("dd",gu,g(K(je)(y.value,K(m))),1)]),e("div",null,[f[3]||(f[3]=e("dt",{class:"font-medium inline-block w-32"},"Received Amount:",-1)),e("dd",yu,g(K(je)(_.value,K(m))),1)])])):(n(),d("div",fu,[K(i)?(n(),d("p",_u," Your financials for this project are not available or you're not assigned. ")):(n(),d("p",bu," Sign in to view your specific financials. "))]))]),K(i)?(n(),d("div",wu,[p(ue,{onClick:w},{default:L(()=>f[4]||(f[4]=[R(" View Transactions ",-1)])),_:1,__:[4]})])):C("",!0)]))]))}},ku=Ce(xu,[["__scopeId","data-v-34bab241"]]),Du={class:"p-4"},Cu={key:0,class:"text-center text-gray-600"},$u={key:1,class:"text-red-600 text-sm py-2"},Su={key:2,class:"text-gray-500 text-center py-4"},Eu={key:3,class:"overflow-x-auto"},Mu={class:"min-w-full divide-y divide-gray-200"},Tu={class:"bg-white divide-y divide-gray-200"},ju={class:"px-4 py-3 text-sm text-gray-900"},Vu={class:"px-4 py-3 text-sm text-gray-700"},Au={class:"px-4 py-3 text-sm text-right text-gray-900"},Iu={class:"px-4 py-3 text-sm"},Ou={class:"px-4 py-3 text-sm text-gray-700"},Lu={__name:"UserTransactionsModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectName:{type:String,required:!1}},emits:["close"],setup(l,{emit:t}){const s=l,o=Le(),i=x(!0),a=x(null),u=x([]);x("PKR");const r=(c,v="USD")=>isNaN(c)||c==null?"0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:v,minimumFractionDigits:2,maximumFractionDigits:2}).format(c),m=async()=>{var c,v;if(i.value=!0,a.value=null,u.value=[],!o.value||!o.value.id||!s.projectId){a.value="User not authenticated or project ID missing.",i.value=!1;return}try{const y=await window.axios.get(`/api/projects/${s.projectId}/sections/transactions?user_id=${o.value.id}`);u.value=y.data}catch(y){console.error("Failed to fetch user-specific transactions for modal:",y),a.value=((v=(c=y.response)==null?void 0:c.data)==null?void 0:v.message)||"Failed to load transactions."}finally{i.value=!1}};return re(()=>s.show,c=>{c&&m()},{immediate:!1}),re([()=>{var c;return(c=o.value)==null?void 0:c.id},()=>s.projectId],(c,v)=>{s.show&&m()},{deep:!0}),P(()=>`Your Transactions for Project ${s.projectId}`),(c,v)=>(n(),le(Ee,{show:l.show,title:"Transactions for: "+l.projectName,"show-footer":!1,onClose:v[0]||(v[0]=y=>c.$emit("close")),"hide-submit-button":!0,"hide-cancel-button":!0,"api-endpoint":null,"form-data":"{}"},{default:L(({errors:y})=>[e("div",Du,[i.value?(n(),d("div",Cu,v[1]||(v[1]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"})],-1)]))):a.value?(n(),d("div",$u,[e("p",null,g(a.value),1)])):u.value.length===0?(n(),d("div",Su," No transactions found for you on this project. ")):(n(),d("div",Eu,[e("table",Mu,[v[2]||(v[2]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date")])],-1)),e("tbody",Tu,[(n(!0),d(Z,null,ee(u.value,_=>(n(),d("tr",{key:_.id,class:"hover:bg-gray-50 transition-colors"},[e("td",ju,g(_.description),1),e("td",Vu,g(_.type),1),e("td",Au,g(r(_.amount,_.currency)),1),e("td",Iu,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":_.is_paid===1,"bg-yellow-100 text-yellow-800":_.is_paid===0})},g(_.is_paid===1?"Paid":"Unpaid"),3)]),e("td",Ou,g(new Date(_.created_at).toLocaleDateString()),1)]))),128))])])]))])]),_:1},8,["show","title"]))}},Uu={class:"space-y-4"},Nu={key:0},Pu=["disabled"],Ru={key:0,class:"mt-4"},Fu=["src"],Bu={class:"flex items-center"},Hu="Create New Deliverable",Wu="post",Yu="Create Deliverable",zu="Deliverable created successfully!",Dt={__name:"CreateDeliverableModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=ke({title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),a=[{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],u=[{value:"pending_review",label:"Pending Review (Requires Client Approval)"},{value:"for_information",label:"For Information Only (No Approval Needed)"}],r=[{value:null,label:"Select Type (if providing URL)"},{value:"google_doc",label:"Google Document (Doc, Sheet, Slide)"},{value:"pdf",label:"PDF Document"},{value:"image",label:"Image (JPG, PNG, GIF)"},{value:"video",label:"Video (YouTube, Vimeo, etc.)"},{value:"other",label:"Other Web Link"}],m=x(null),c=x(null);re(()=>s.show,f=>{f&&(Object.assign(i,{title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),c.value=null,m.value&&(m.value.value=""))});const v=f=>{const h=f.target.files[0];if(h)if(i.attachment_file=h,i.content_url="",i.content_url_type=null,h.type.startsWith("image/")){const T=new FileReader;T.onload=A=>{c.value=A.target.result},T.readAsDataURL(h)}else c.value=null;else i.attachment_file=null,c.value=null},y=()=>{i.content_url?(i.attachment_file=null,c.value=null,m.value&&(m.value.value="")):i.content_url_type=null},_=f=>{const h=new FormData;return h.append("title",f.title),h.append("description",f.description||""),h.append("type",f.type),h.append("is_visible_to_client",f.is_visible_to_client?1:0),h.append("initial_status",f.initial_status),f.attachment_file?h.append("attachment_file",f.attachment_file):f.content_url&&(h.append("content_url",f.content_url),h.append("content_url_type",f.content_url_type||"")),h},k=P(()=>`/api/projects/${s.projectId}/deliverables`),w=f=>{o("saved",f),o("close")},E=()=>{o("close")};return(f,h)=>(n(),le(Ee,{show:l.show,title:Hu,"api-endpoint":k.value,"http-method":Wu,"form-data":i,"submit-button-text":Yu,"success-message":zu,"format-data-for-api":_,onClose:E,onSubmitted:w},{default:L(({errors:T})=>[e("div",Uu,[e("div",null,[p(W,{for:"title",value:"Title"}),p(ne,{id:"title",modelValue:i.title,"onUpdate:modelValue":h[0]||(h[0]=A=>i.title=A),type:"text",class:"mt-1 block w-full",required:"",autofocus:""},null,8,["modelValue"]),p(ae,{message:T.title?T.title[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"description",value:"Description"}),ce(e("textarea",{id:"description","onUpdate:modelValue":h[1]||(h[1]=A=>i.description=A),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter deliverable description"},null,512),[[fe,i.description]]),p(ae,{message:T.description?T.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"type",value:"Deliverable Type"}),p(pe,{id:"type",modelValue:i.type,"onUpdate:modelValue":h[2]||(h[2]=A=>i.type=A),options:a,"value-key":"value","label-key":"label",placeholder:"Select a type",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:T.type?T.type[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"initial_status",value:"Initial Status"}),p(pe,{id:"initial_status",modelValue:i.initial_status,"onUpdate:modelValue":h[3]||(h[3]=A=>i.initial_status=A),options:u,"value-key":"value","label-key":"label",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:T.initial_status?T.initial_status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"content_url",value:"Content URL (for Google Docs, external links)"}),p(ne,{id:"content_url",modelValue:i.content_url,"onUpdate:modelValue":h[4]||(h[4]=A=>i.content_url=A),type:"url",class:"mt-1 block w-full",disabled:!!i.attachment_file,onInput:y,placeholder:"e.g., https://docs.google.com/document/d/..."},null,8,["modelValue","disabled"]),h[7]||(h[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Leave empty if uploading a file below.",-1)),p(ae,{message:T.content_url?T.content_url[0]:"",class:"mt-2"},null,8,["message"])]),i.content_url&&!i.attachment_file?(n(),d("div",Nu,[p(W,{for:"content_url_type",value:"Type of Content URL"}),p(pe,{id:"content_url_type",modelValue:i.content_url_type,"onUpdate:modelValue":h[5]||(h[5]=A=>i.content_url_type=A),options:r,"value-key":"value","label-key":"label",placeholder:"Select the type of content this URL links to",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(ae,{message:T.content_url_type?T.content_url_type[0]:"",class:"mt-2"},null,8,["message"])])):C("",!0),e("div",null,[p(W,{for:"attachment_file",value:"Upload File (PDF, Image)"}),e("input",{id:"attachment_file",ref_key:"fileInput",ref:m,type:"file",onChange:v,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",disabled:!!i.content_url,accept:"application/pdf,image/*"},null,40,Pu),h[9]||(h[9]=e("p",{class:"text-xs text-gray-500 mt-1"},"Max 10MB. Leave empty if providing a URL above.",-1)),p(ae,{message:T.attachment_file?T.attachment_file[0]:"",class:"mt-2"},null,8,["message"]),c.value?(n(),d("div",Ru,[h[8]||(h[8]=e("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Image Preview:",-1)),e("img",{src:c.value,alt:"File Preview",class:"max-w-full h-auto rounded-lg shadow-md max-h-60 object-contain"},null,8,Fu)])):C("",!0)]),e("div",Bu,[ce(e("input",{id:"is_visible_to_client",type:"checkbox","onUpdate:modelValue":h[6]||(h[6]=A=>i.is_visible_to_client=A),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,512),[[Qe,i.is_visible_to_client]]),p(W,{for:"is_visible_to_client",value:"Visible to Client",class:"ml-2"}),p(ae,{message:T.is_visible_to_client?T.is_visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","api-endpoint","form-data"]))}};function qu(){return{formatDate:o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",formatDateTime:o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",timeAgo:o=>{if(!o)return"";const i=new Date(o),u=Math.floor((new Date-i)/1e3);let r=u/31536e3;return r>1?Math.floor(r)+" years ago":(r=u/2592e3,r>1?Math.floor(r)+" months ago":(r=u/86400,r>1?Math.floor(r)+" days ago":(r=u/3600,r>1?Math.floor(r)+" hours ago":(r=u/60,r>1?Math.floor(r)+" minutes ago":Math.floor(u)+" seconds ago"))))}}}const Gu={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},Ku={class:"flex justify-between items-center mb-4"},Ju={class:"flex gap-2"},Zu={key:0},Xu={key:1},Qu={class:"mb-6 bg-gray-50 p-4 rounded-lg"},ec={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},tc={key:0,class:"mt-3 text-sm text-gray-600"},sc={key:0,class:"text-red-600 font-medium"},lc={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},ac={key:1,class:"text-center py-4"},ic={class:"text-red-600 text-sm font-medium"},nc={key:2,class:"overflow-x-auto"},oc={class:"min-w-full divide-y divide-gray-200"},rc={class:"bg-white divide-y divide-gray-200"},dc={class:"px-4 py-3 text-sm text-gray-900"},uc={class:"px-4 py-3 text-sm text-gray-700 capitalize"},cc={class:"px-4 py-3 text-sm text-gray-700"},mc={class:"px-4 py-3 text-sm text-gray-700"},vc={class:"px-4 py-3 text-sm text-gray-700"},pc={class:"px-4 py-3 text-sm text-gray-700"},hc={class:"px-4 py-3 text-sm text-gray-700"},gc={class:"px-4 py-3 text-right"},yc={class:"flex justify-end space-x-2"},fc=["onClick"],bc={key:3,class:"text-center py-4"},_c={__name:"ProjectDeliverableTab",props:{projectId:{type:[String,Number],required:!0},canCreateDeliverables:{type:Boolean,default:!1},canViewDeliverables:{type:Boolean,default:!1}},emits:["deliverablesUpdated","openDeliverableDetailSidebar"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(!0),u=x(null),r=x(!1),m=x({status:"",type:"",visibility:"",clientStatus:""}),c=[{value:"",label:"All Statuses"},{value:"pending_review",label:"Pending Review"},{value:"for_information",label:"For Information"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"},{value:"completed",label:"Completed"}],v=[{value:"",label:"All Types"},{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],y=[{value:"",label:"All Visibility"},{value:"visible_to_client",label:"Visible to Client"},{value:"not_visible_to_client",label:"Not Visible to Client"}],_=[{value:"",label:"All Client Status"},{value:"read",label:"Read"},{value:"unread",label:"Unread"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"}],k=A=>{var I;if(!A.is_visible_to_client)return{status:"N/A",class:"bg-gray-100 text-gray-800"};const N=(I=A.client_interactions)==null?void 0:I[0];return N?N.approved_at?{status:"Approved",class:"bg-green-100 text-green-800"}:N.revisions_requested_at?{status:"Revisions Requested",class:"bg-yellow-100 text-yellow-800"}:N.rejected_at?{status:"Rejected",class:"bg-red-100 text-red-800"}:N.read_at?{status:`Read on ${new Date(N.read_at).toLocaleDateString()}`,class:"bg-blue-100 text-blue-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}},w=P(()=>i.value.length?i.value.filter(A=>{const N=k(A);return!(m.value.status&&A.status!==m.value.status||m.value.type&&A.type!==m.value.type||m.value.visibility&&(m.value.visibility==="visible_to_client"&&!A.is_visible_to_client||m.value.visibility==="not_visible_to_client"&&A.is_visible_to_client)||m.value.clientStatus&&(m.value.clientStatus==="read"&&!N.status.startsWith("Read")||m.value.clientStatus==="unread"&&N.status!=="Unread"||m.value.clientStatus==="approved"&&N.status!=="Approved"||m.value.clientStatus==="revisions_requested"&&N.status!=="Revisions Requested"))}):[]),E=()=>{m.value.status="",m.value.type="",m.value.visibility="",m.value.clientStatus=""},f=async()=>{if(!s.canViewDeliverables){u.value="You do not have permission to view deliverables.",a.value=!1;return}a.value=!0,u.value=null;try{const A=await window.axios.get(route("projects.deliverables.index",s.projectId));i.value=A.data}catch(A){console.error("Error fetching deliverables:",A),u.value="Failed to load deliverables."}finally{a.value=!1}},h=()=>{f(),o("deliverablesUpdated")},T=A=>{o("openDeliverableDetailSidebar",A)};return be(()=>{f()}),re(()=>s.projectId,()=>{f()}),(A,N)=>(n(),d("div",Gu,[e("div",Ku,[N[7]||(N[7]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Deliverables & Approvals",-1)),e("div",Ju,[p(ye,{onClick:f,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:L(()=>[a.value?(n(),d("span",Xu,"Loading...")):(n(),d("span",Zu,"Refresh"))]),_:1},8,["disabled"]),l.canCreateDeliverables?(n(),le(ue,{key:0,onClick:N[0]||(N[0]=I=>r.value=!0),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:L(()=>N[6]||(N[6]=[R(" Add New Deliverable ",-1)])),_:1,__:[6]})):C("",!0)])]),e("div",Qu,[e("div",ec,[e("div",null,[p(W,{for:"deliverable-status-filter",value:"Status"}),p(pe,{id:"deliverable-status-filter",modelValue:m.value.status,"onUpdate:modelValue":N[1]||(N[1]=I=>m.value.status=I),options:c,placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(W,{for:"deliverable-type-filter",value:"Type"}),p(pe,{id:"deliverable-type-filter",modelValue:m.value.type,"onUpdate:modelValue":N[2]||(N[2]=I=>m.value.type=I),options:v,placeholder:"All Types",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(W,{for:"deliverable-visibility-filter",value:"Visibility"}),p(pe,{id:"deliverable-visibility-filter",modelValue:m.value.visibility,"onUpdate:modelValue":N[3]||(N[3]=I=>m.value.visibility=I),options:y,placeholder:"All Visibility",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(W,{for:"deliverable-client-status-filter",value:"Client Status"}),p(pe,{id:"deliverable-client-status-filter",modelValue:m.value.clientStatus,"onUpdate:modelValue":N[4]||(N[4]=I=>m.value.clientStatus=I),options:_,placeholder:"All Client Status",class:"mt-1"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end mt-4"},[e("button",{type:"button",onClick:E,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")]),Object.values(m.value).some(I=>I!==null&&I!=="")?(n(),d("div",tc,[e("p",null,[R(" Showing "+g(w.value.length)+" of "+g(i.value.length)+" deliverables ",1),w.value.length===0?(n(),d("span",sc," (No deliverables match the current filters) ")):C("",!0)])])):C("",!0)]),a.value?(n(),d("div",lc," Loading deliverables... ")):u.value?(n(),d("div",ac,[e("p",ic,g(u.value),1)])):w.value.length?(n(),d("div",nc,[e("table",oc,[N[8]||(N[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted By"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted On"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Visibility"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client Status"),R(),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",rc,[(n(!0),d(Z,null,ee(w.value,I=>{var Y;return n(),d("tr",{key:I.id,class:"hover:bg-gray-50 transition-colors"},[e("td",dc,g(I.title),1),e("td",uc,g(I.type.replace(/_/g," ")),1),e("td",cc,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":I.status==="pending_review"||I.status==="revisions_requested","bg-green-100 text-green-800":I.status==="approved","bg-blue-100 text-blue-800":I.status==="completed","bg-gray-100 text-gray-800":I.status==="for_information"})},g(I.status.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase())),3)]),e("td",mc,g(((Y=I.team_member)==null?void 0:Y.name)||"Unknown"),1),e("td",vc,g(new Date(I.submitted_at).toLocaleDateString()),1),e("td",pc,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":I.is_visible_to_client,"bg-red-100 text-red-800":!I.is_visible_to_client})},g(I.is_visible_to_client?"Visible":"Hidden"),3)]),e("td",hc,[e("span",{class:Q(["px-2 py-1 rounded-full text-xs font-medium",k(I).class])},g(k(I).status),3)]),e("td",gc,[e("div",yc,[e("button",{onClick:B=>T(I.id),class:"text-purple-600 hover:text-purple-800 text-sm font-medium"}," View Details ",8,fc)])])])}),128))])])])):(n(),d("div",bc,N[9]||(N[9]=[e("p",{class:"text-gray-400 text-sm"},"No deliverables found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add New Deliverable" button to create one. ',-1)]))),p(Dt,{show:r.value,"project-id":l.projectId,onClose:N[5]||(N[5]=I=>r.value=!1),onSaved:h},null,8,["show","project-id"])]))}},wc=Ce(_c,[["__scopeId","data-v-40d67f52"]]),xc={key:0,class:"text-center py-8 text-gray-500"},kc={key:1,class:"text-center py-8 text-red-600"},Dc={key:2,class:"space-y-6"},Cc={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},$c={class:"text-xl font-bold text-gray-900 mb-2"},Sc={class:"flex items-center space-x-2 text-sm text-gray-600 mb-4"},Ec={class:"text-indigo-600 font-medium"},Mc={class:"text-gray-700"},Tc={class:"text-gray-700 leading-relaxed"},jc={class:"mt-4 space-y-2 text-sm"},Vc={key:0,class:"text-blue-600 hover:underline"},Ac=["href"],Ic={key:1,class:"text-blue-600 hover:underline"},Oc=["href"],Lc={key:2,class:"text-green-600 font-medium"},Uc={class:"bg-white p-4 rounded-lg shadow-sm"},Nc={key:0,class:"space-y-3"},Pc={class:"font-semibold text-gray-800"},Rc={class:"text-sm text-gray-700"},Fc={class:"font-medium"},Bc={key:0,class:"text-xs text-gray-500 ml-2"},Hc={key:0,class:"text-sm text-gray-600 mt-1"},Wc={key:1,class:"text-gray-500 text-sm py-2"},Yc={class:"bg-white p-4 rounded-lg shadow-sm"},zc={class:"flex justify-between items-center mb-4 border-b pb-2"},qc={class:"space-y-3 mb-4"},Gc={key:0,class:"space-y-3"},Kc={class:"text-sm text-gray-700"},Jc={class:"text-xs text-gray-500 mt-1"},Zc={key:0},Xc={key:1,class:"ml-2 text-gray-400"},Qc={key:1,class:"text-gray-500 text-sm py-2"},em={key:3,class:"text-center py-8 text-gray-500"},tm={__name:"DeliverableDetailSidebar",props:{projectId:{type:Number,required:!0},deliverableId:{type:Number,required:!0}},emits:["close","deliverable-updated"],setup(l,{emit:t}){const s=l,o=t,i=x(null),a=x(!0),u=x(""),{formatDateTime:r,timeAgo:m}=qu(),c=ls({comment_text:"",context:""}),v=async()=>{a.value=!0,u.value="";try{const f=await window.axios.get(route("projects.deliverables.show",{project:s.projectId,deliverable:s.deliverableId}));i.value=f.data}catch(f){u.value="Failed to load deliverable details.",console.error("Error fetching deliverable details:",f)}finally{a.value=!1}};re(()=>s.deliverableId,f=>{f?v():i.value=null},{immediate:!0});const y=x(!1),_=async()=>{var f,h;if(i.value){y.value=!0,c.errors={};try{const T=await window.axios.post(`/api/projects/${s.projectId}/deliverables/${s.deliverableId}/comments`,{comment_text:c.comment_text,context:c.context});c.comment_text="",c.context="",v(),o("deliverable-updated")}catch(T){console.error("Error adding comment:",T),T.response&&T.response.status===422?c.errors=T.response.data.errors:console.error("Failed to add comment:",((h=(f=T.response)==null?void 0:f.data)==null?void 0:h.message)||T.message)}finally{y.value=!1}}},k=P(()=>i.value?{"bg-yellow-100 text-yellow-800":i.value.status==="pending_review"||i.value.status==="revisions_requested","bg-green-100 text-green-800":i.value.status==="approved","bg-blue-100 text-blue-800":i.value.status==="completed","bg-gray-100 text-gray-800":i.value.status==="for_information"}:""),w=f=>{let h="No Action Yet",T="";return f.approved_at?(h="Approved",T=r(f.approved_at)):f.revisions_requested_at?(h="Revisions Requested",T=r(f.revisions_requested_at)):f.rejected_at?(h="Rejected",T=r(f.rejected_at)):f.read_at&&(h="Read",T=r(f.read_at)),{status:h,timestamp:T}},E=f=>f.creator_type==="App\\Models\\Client"?"Client":f.creator_type==="App\\Models\\User"?"Team Member":"Unknown";return(f,h)=>{var T;return a.value?(n(),d("div",xc," Loading deliverable details... ")):u.value?(n(),d("div",kc,g(u.value),1)):i.value?(n(),d("div",Dc,[e("div",Cc,[e("h4",$c,g(i.value.title),1),e("div",Sc,[e("span",{class:Q(["px-2 py-1 rounded-full text-xs font-medium",k.value])},g(i.value.status.replace(/_/g," ").replace(/\b\w/g,A=>A.toUpperCase())),3),e("span",Ec," | "+g(i.value.type.replace(/_/g," "))+" | ",1),e("span",Mc," Submitted by: "+g(((T=i.value.team_member)==null?void 0:T.name)||"Unknown"),1)]),e("p",Tc,g(i.value.description||"No description provided."),1),e("div",jc,[i.value.content_url?(n(),d("div",Vc,[e("a",{href:i.value.content_url,target:"_blank",rel:"noopener noreferrer"},"View Content Link ("+g(i.value.mime_type||"Unknown Type")+")",9,Ac)])):C("",!0),i.value.attachment_path?(n(),d("div",Ic,[e("a",{href:i.value.attachment_path,target:"_blank",rel:"noopener noreferrer"},"View Attachment",8,Oc)])):C("",!0),e("div",{class:Q(i.value.is_visible_to_client?"text-green-600":"text-red-600")}," Visibility: "+g(i.value.is_visible_to_client?"Visible to Client":"Not Visible to Client"),3),i.value.overall_approved_at?(n(),d("div",Lc," Overall Approved by Client on "+g(K(r)(i.value.overall_approved_at)),1)):C("",!0)])]),e("div",Uc,[h[3]||(h[3]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Client Interactions",-1)),i.value.client_interactions&&i.value.client_interactions.length>0?(n(),d("div",Nc,[(n(!0),d(Z,null,ee(i.value.client_interactions,A=>{var N;return n(),d("div",{key:A.id,class:"p-3 bg-gray-50 rounded-md"},[e("p",Pc,g(((N=A.client)==null?void 0:N.name)||"Unknown Client"),1),e("p",Rc,[h[2]||(h[2]=R(" Status: ",-1)),e("span",Fc,g(w(A).status),1),w(A).timestamp?(n(),d("span",Bc," ("+g(w(A).timestamp)+") ",1)):C("",!0)]),A.feedback_text?(n(),d("p",Hc,'Feedback: "'+g(A.feedback_text)+'"',1)):C("",!0)])}),128))])):(n(),d("div",Wc,"No client interactions recorded yet."))]),e("div",Yc,[e("div",zc,[h[5]||(h[5]=e("h5",{class:"text-lg font-semibold text-gray-800"},"Comments",-1)),p(ue,{onClick:_,disabled:K(c).processing,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:L(()=>h[4]||(h[4]=[R(" Add Comment ",-1)])),_:1,__:[4]},8,["disabled"])]),e("div",qc,[e("div",null,[p(W,{for:"new-comment-text",value:"New Comment",class:"sr-only"}),ce(e("textarea",{id:"new-comment-text","onUpdate:modelValue":h[0]||(h[0]=A=>K(c).comment_text=A),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Type your comment here..."},null,512),[[fe,K(c).comment_text]]),p(ae,{message:K(c).errors.comment_text,class:"mt-2"},null,8,["message"])]),e("div",null,[p(W,{for:"comment-context",value:"Context (Optional, e.g., 'Paragraph 2', 'Image 1')",class:"sr-only"}),p(ne,{id:"comment-context",modelValue:K(c).context,"onUpdate:modelValue":h[1]||(h[1]=A=>K(c).context=A),type:"text",class:"mt-1 block w-full",placeholder:"Context (optional)"},null,8,["modelValue"]),p(ae,{message:K(c).errors.context,class:"mt-2"},null,8,["message"])])]),i.value.comments&&i.value.comments.length>0?(n(),d("div",Gc,[(n(!0),d(Z,null,ee(i.value.comments,A=>(n(),d("div",{key:A.id,class:"p-3 bg-gray-50 rounded-md"},[e("p",Kc,g(A.content),1),e("p",Jc,[R(" By "+g(A.creator_name||"Unknown")+" ("+g(E(A))+") ",1),A.created_at?(n(),d("span",Zc,g(K(m)(A.created_at)),1)):C("",!0),A.context?(n(),d("span",Xc,"("+g(A.context)+")",1)):C("",!0)])]))),128))])):(n(),d("div",Qc,"No comments for this deliverable yet."))])])):(n(),d("div",em," Select a deliverable to view details. "))}}},sm={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},lm={class:"flex justify-between items-center mb-4"},am={class:"mb-6 bg-gray-50 p-4 rounded-lg"},im={class:"flex items-center gap-4"},nm={class:"flex-1 min-w-[200px]"},om={key:0,class:"text-red-600 text-sm mt-2"},rm={key:1,class:"text-gray-600 text-sm mt-2 animate-pulse"},dm={key:2,class:"text-gray-500 text-sm mt-2"},um={class:"mt-6"},cm={class:"flex justify-between items-center mb-3"},mm={class:"text-md font-medium text-gray-800"},vm={key:0},pm={key:1},hm={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-8"},gm={key:1,class:"text-center py-8"},ym={class:"text-red-600 text-sm font-medium"},fm={key:2,class:"text-center py-8"},bm={class:"text-red-600 text-sm font-medium"},_m={key:3,class:"space-y-8"},wm={class:"bg-gray-50 p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},xm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},km={class:"text-lg font-semibold text-gray-900"},Dm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Cm={class:"text-lg font-semibold text-gray-900"},$m={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Sm={class:"text-lg font-semibold text-gray-900"},Em={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Mm={class:"text-lg font-semibold text-gray-900"},Tm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},jm={class:"text-lg font-semibold text-gray-900"},Vm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Am={class:"text-lg font-semibold text-gray-900"},Im={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},Om={class:"text-lg font-semibold text-gray-900"},Lm={class:"bg-white p-6 rounded-lg shadow-sm"},Um={class:"overflow-x-auto max-h-60"},Nm={class:"min-w-full divide-y divide-gray-200"},Pm={class:"bg-white divide-y divide-gray-200"},Rm={class:"px-4 py-3 text-sm text-gray-900"},Fm={class:"px-4 py-3 text-sm text-gray-700"},Bm={class:"px-4 py-3 text-sm text-gray-700"},Hm={key:0,class:"text-gray-500 text-sm py-2"},Wm={class:"bg-white p-6 rounded-lg shadow-sm"},Ym={class:"overflow-x-auto max-h-60"},zm={class:"min-w-full divide-y divide-gray-200"},qm={class:"bg-white divide-y divide-gray-200"},Gm={class:"px-4 py-3 text-sm text-gray-900"},Km={class:"px-4 py-3 text-sm text-gray-700"},Jm={class:"px-4 py-3 text-sm text-gray-700"},Zm={class:"px-4 py-3 text-sm text-gray-700"},Xm={class:"px-4 py-3 text-sm text-gray-700"},Qm={key:0,class:"text-gray-500 text-sm py-2"},ev={class:"bg-white p-6 rounded-lg shadow-sm"},tv={class:"overflow-x-auto max-h-60"},sv={class:"min-w-full divide-y divide-gray-200"},lv={class:"bg-white divide-y divide-gray-200"},av={class:"px-4 py-3 text-sm text-gray-900"},iv={class:"px-4 py-3 text-sm text-gray-700"},nv={key:0,class:"text-gray-500 text-sm py-2"},ov={class:"bg-white p-6 rounded-lg shadow-sm"},rv={class:"overflow-x-auto"},dv={class:"min-w-full divide-y divide-gray-200"},uv={class:"bg-white divide-y divide-gray-200"},cv={class:"px-4 py-3 text-sm text-gray-900"},mv={class:"px-4 py-3 text-sm text-gray-700"},vv={key:0,class:"text-gray-500 text-sm py-2"},pv={class:"bg-white p-6 rounded-lg shadow-sm"},hv={class:"overflow-x-auto"},gv={class:"min-w-full divide-y divide-gray-200"},yv={class:"bg-white divide-y divide-gray-200"},fv={class:"px-4 py-3 text-sm text-gray-900"},bv={class:"px-4 py-3 text-sm text-gray-700"},_v={key:0,class:"text-gray-500 text-sm py-2"},wv={class:"bg-white p-6 rounded-lg shadow-sm"},xv={class:"overflow-x-auto max-h-60"},kv={class:"min-w-full divide-y divide-gray-200"},Dv={class:"bg-white divide-y divide-gray-200"},Cv={class:"px-4 py-3 text-sm text-gray-900"},$v={class:"px-4 py-3 text-sm text-gray-700"},Sv={key:0,class:"text-gray-500 text-sm py-2"},Ev={class:"bg-white p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6"},Mv={key:0,class:"space-y-2"},Tv={class:"font-medium"},jv={key:1,class:"text-gray-500 text-sm py-2"},Vv={key:0,class:"space-y-2"},Av={class:"font-medium"},Iv={key:1,class:"text-gray-500 text-sm py-2"},Ov={key:4,class:"text-center py-8 text-gray-500"},Lv={__name:"SeoReportTab",props:{projectId:{type:[String,Number],required:!0},canCreateSeoReports:{type:Boolean,default:!1}},emits:["openCreateSeoReportModal"],setup(l,{emit:t}){const s=l,o=t,i=x([]),a=x(""),u=x(null),r=x(!0),m=x(!1),c=x(null),v=x(null),y=x(null),_=async()=>{r.value=!0,c.value=null;try{const j=await window.axios.get(`/api/projects/${s.projectId}/seo-reports/available-months`);i.value=j.data.map(b=>({value:b,label:new Date(b+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})})),i.value.length>0&&(a.value=i.value[0].value)}catch(j){console.error("Error fetching available months:",j),c.value="Failed to load available report months."}finally{r.value=!1}},k=j=>{const D=["clientName","reportingPeriod","authorityScoreValue","totalClicksValue","totalImpressionsValue","averagePositionValue","totalBacklinksValue","clicksImpressions","trafficSources","deviceUsage","countryPerformance","coreVitals","topQueries","keywordRankings","backlinks","zeroClickKeywords"].filter($=>!($ in j));return D.length>0?`Report data is missing expected top-level keys: ${D.join(", ")}. Please ensure the JSON structure is correct.`:!j.clicksImpressions||!Array.isArray(j.clicksImpressions.labels)||!Array.isArray(j.clicksImpressions.clicks)?"clicksImpressions data is malformed.":!j.trafficSources||!Array.isArray(j.trafficSources.labels)||!Array.isArray(j.trafficSources.sessions)?"trafficSources data is malformed.":null},w=async()=>{if(!a.value){u.value=null,y.value=null;return}m.value=!0,v.value=null,y.value=null;try{const b=(await window.axios.get(`/api/projects/${s.projectId}/seo-reports/${a.value}`)).data,D=k(b);D?(y.value=D,u.value=null):u.value=b}catch(j){console.error("Error fetching SEO report:",j),v.value="Failed to load SEO report for the selected month.",u.value=null,y.value=null}finally{m.value=!1}},E=(j=null)=>{o("openCreateSeoReportModal",j)},f=P(()=>{var j;return((j=u.value)==null?void 0:j.clientName)||"N/A"}),h=P(()=>{var j;return((j=u.value)==null?void 0:j.reportingPeriod)||"N/A"}),T=P(()=>{var j;return((j=u.value)==null?void 0:j.authorityScoreValue)||"N/A"}),A=P(()=>{var j;return((j=u.value)==null?void 0:j.totalClicksValue)||"N/A"}),N=P(()=>{var j;return((j=u.value)==null?void 0:j.totalImpressionsValue)||"N/A"}),I=P(()=>{var j;return((j=u.value)==null?void 0:j.averagePositionValue)||"N/A"}),Y=P(()=>{var j;return((j=u.value)==null?void 0:j.totalBacklinksValue)||"N/A"}),B=P(()=>{var j;return((j=u.value)==null?void 0:j.clicksImpressions)||{labels:[],clicks:[],impressions:[]}}),S=P(()=>{var j;return((j=u.value)==null?void 0:j.trafficSources)||{labels:[],sessions:[],colors:[]}}),V=P(()=>{var j;return((j=u.value)==null?void 0:j.deviceUsage)||{labels:[],clicks:[],colors:[]}}),M=P(()=>{var j;return((j=u.value)==null?void 0:j.countryPerformance)||{labels:[],clicks:[]}}),O=P(()=>{var j;return((j=u.value)==null?void 0:j.coreVitals)||{mobile:{},desktop:{}}}),G=P(()=>{var j;return((j=u.value)==null?void 0:j.topQueries)||[]}),U=P(()=>{var j;return((j=u.value)==null?void 0:j.keywordRankings)||[]});return be(()=>{_()}),re(()=>s.projectId,()=>{_()}),re(a,j=>{j?w():(u.value=null,y.value=null)}),(j,b)=>(n(),d("div",sm,[e("div",lm,[b[4]||(b[4]=e("h4",{class:"text-lg font-semibold text-gray-900"},"SEO Reports",-1)),l.canCreateSeoReports?(n(),le(ue,{key:0,onClick:b[0]||(b[0]=D=>E()),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:L(()=>b[3]||(b[3]=[R(" Add New Report ",-1)])),_:1,__:[3]})):C("",!0)]),e("div",am,[e("div",im,[e("div",nm,[p(W,{for:"seo-report-month-filter",value:"Select Report Month"}),p(pe,{id:"seo-report-month-filter",modelValue:a.value,"onUpdate:modelValue":b[1]||(b[1]=D=>a.value=D),options:i.value,"value-key":"value","label-key":"label",placeholder:"Select a month",disabled:r.value||i.value.length===0,class:"mt-1"},null,8,["modelValue","options","disabled"])])]),c.value?(n(),d("div",om,g(c.value),1)):C("",!0),r.value?(n(),d("div",rm,"Loading available months...")):C("",!0),!r.value&&i.value.length===0?(n(),d("div",dm,"No SEO reports available for this project.")):C("",!0)]),e("div",um,[e("div",cm,[e("h5",mm,[a.value?(n(),d("span",vm,"Report for "+g(new Date(a.value+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})),1)):(n(),d("span",pm,"Select a month to view report"))]),l.canCreateSeoReports&&u.value&&a.value?(n(),le(ue,{key:0,onClick:b[2]||(b[2]=D=>E({report_date:a.value,data:JSON.stringify(u.value,null,2)})),class:"bg-blue-500 hover:bg-blue-600 transition-colors text-sm py-1 px-3"},{default:L(()=>b[5]||(b[5]=[R(" Edit Report ",-1)])),_:1,__:[5]})):C("",!0)]),m.value?(n(),d("div",hm," Loading SEO report data... ")):v.value?(n(),d("div",gm,[e("p",ym,g(v.value),1)])):y.value?(n(),d("div",fm,[e("p",bm,"Data Structure Error: "+g(y.value),1),b[6]||(b[6]=e("p",{class:"text-gray-500 text-sm mt-2"},"Please ensure the JSON data conforms to the expected format.",-1))])):u.value?(n(),d("div",_m,[e("div",wm,[e("div",xm,[b[7]||(b[7]=e("p",{class:"text-sm text-gray-500"},"Client Name",-1)),e("p",km,g(f.value),1)]),e("div",Dm,[b[8]||(b[8]=e("p",{class:"text-sm text-gray-500"},"Reporting Period",-1)),e("p",Cm,g(h.value),1)]),e("div",$m,[b[9]||(b[9]=e("p",{class:"text-sm text-gray-500"},"Authority Score",-1)),e("p",Sm,g(T.value),1)]),e("div",Em,[b[10]||(b[10]=e("p",{class:"text-sm text-gray-500"},"Total Clicks",-1)),e("p",Mm,g(A.value),1)]),e("div",Tm,[b[11]||(b[11]=e("p",{class:"text-sm text-gray-500"},"Total Impressions",-1)),e("p",jm,g(N.value),1)]),e("div",Vm,[b[12]||(b[12]=e("p",{class:"text-sm text-gray-500"},"Average Position",-1)),e("p",Am,g(I.value),1)]),e("div",Im,[b[13]||(b[13]=e("p",{class:"text-sm text-gray-500"},"Total Backlinks",-1)),e("p",Om,g(Y.value),1)])]),e("div",Lm,[b[15]||(b[15]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Clicks & Impressions Trend",-1)),e("div",Um,[e("table",Nm,[b[14]||(b[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions")])],-1)),e("tbody",Pm,[(n(!0),d(Z,null,ee(B.value.labels,(D,$)=>(n(),d("tr",{key:$},[e("td",Rm,g(D),1),e("td",Fm,g(B.value.clicks[$]),1),e("td",Bm,g(B.value.impressions[$]),1)]))),128))])])]),B.value.labels.length?C("",!0):(n(),d("p",Hm,"No clicks and impressions data available."))]),e("div",Wm,[b[17]||(b[17]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Top Queries",-1)),e("div",Ym,[e("table",zm,[b[16]||(b[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Query"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"CTR"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Position")])],-1)),e("tbody",qm,[(n(!0),d(Z,null,ee(G.value,D=>(n(),d("tr",{key:D.query},[e("td",Gm,g(D.query),1),e("td",Km,g(D.clicks),1),e("td",Jm,g(D.impressions),1),e("td",Zm,g(D.ctr)+"%",1),e("td",Xm,g(D.position),1)]))),128))])])]),G.value.length?C("",!0):(n(),d("p",Qm,"No top queries data available."))]),e("div",ev,[b[19]||(b[19]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Keyword Rankings",-1)),e("div",tv,[e("table",sv,[b[18]||(b[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Keyword"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ranking")])],-1)),e("tbody",lv,[(n(!0),d(Z,null,ee(U.value,D=>(n(),d("tr",{key:D.keyword},[e("td",av,g(D.keyword),1),e("td",iv,g(D.ranking),1)]))),128))])])]),U.value.length?C("",!0):(n(),d("p",nv,"No keyword rankings data available."))]),e("div",ov,[b[21]||(b[21]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Traffic Sources",-1)),e("div",rv,[e("table",dv,[b[20]||(b[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Source"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sessions")])],-1)),e("tbody",uv,[(n(!0),d(Z,null,ee(S.value.labels,(D,$)=>(n(),d("tr",{key:D},[e("td",cv,g(D),1),e("td",mv,g(S.value.sessions[$]),1)]))),128))])])]),S.value.labels.length?C("",!0):(n(),d("p",vv,"No traffic sources data available."))]),e("div",pv,[b[23]||(b[23]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Device Usage",-1)),e("div",hv,[e("table",gv,[b[22]||(b[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Device"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",yv,[(n(!0),d(Z,null,ee(V.value.labels,(D,$)=>(n(),d("tr",{key:D},[e("td",fv,g(D),1),e("td",bv,g(V.value.clicks[$]),1)]))),128))])])]),V.value.labels.length?C("",!0):(n(),d("p",_v,"No device usage data available."))]),e("div",wv,[b[25]||(b[25]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Country Performance (Top 10)",-1)),e("div",xv,[e("table",kv,[b[24]||(b[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Country"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",Dv,[(n(!0),d(Z,null,ee(M.value.labels,D=>(n(),d("tr",{key:D},[e("td",Cv,g(D),1),e("td",$v,g(M.value.clicks[M.value.labels.indexOf(D)]),1)]))),128))])])]),M.value.labels.length?C("",!0):(n(),d("p",Sv,"No country performance data available."))]),e("div",Ev,[e("div",null,[b[26]||(b[26]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Mobile)",-1)),O.value.mobile&&O.value.mobile.labels&&O.value.mobile.labels.length?(n(),d("div",Mv,[(n(!0),d(Z,null,ee(O.value.mobile.labels,(D,$)=>(n(),d("div",{key:D,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(D)+":",1),e("span",Tv,g(O.value.mobile.scores[$]),1)]))),128))])):(n(),d("p",jv,"No mobile core vitals data available."))]),e("div",null,[b[27]||(b[27]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Desktop)",-1)),O.value.desktop&&O.value.desktop.labels&&O.value.desktop.labels.length?(n(),d("div",Vv,[(n(!0),d(Z,null,ee(O.value.desktop.labels,(D,$)=>(n(),d("div",{key:D,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,g(D)+":",1),e("span",Av,g(O.value.desktop.scores[$]),1)]))),128))])):(n(),d("p",Iv,"No desktop core vitals data available."))])])])):(n(),d("div",Ov," No report data to display. Please select a month from the dropdown. "))])]))}},Uv=Ce(Lv,[["__scopeId","data-v-37cb2f02"]]),Nv={class:"space-y-4"},Pv={key:0,class:"text-xs text-gray-500 mt-1 text-red-500"},Rv=["onBlur"],Fv={__name:"CreateSeoReportModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0},initialData:{type:Object,default:null}},emits:["close","saved"],setup(l,{emit:t}){const s=l,o=t,i=ke({report_date:"",data:""}),a=x(null);re(()=>[s.show,s.initialData],([f,h])=>{f&&(h?Object.assign(i,{report_date:h.report_date||"",data:h.data||""}):Object.assign(i,{report_date:"",data:""}))},{immediate:!0});const u=f=>{let h=f.data;try{h=JSON.stringify(JSON.parse(f.data))}catch{console.warn("Provided data is not valid JSON, sending as plain string. Backend should validate.")}return{report_date:f.report_date,data:h}},r=P(()=>s.initialData?"Edit SEO Report":"Create New SEO Report"),m=P(()=>`/api/projects/${s.projectId}/seo-reports`),c=P(()=>"post"),v=P(()=>s.initialData?"Update Report":"Create Report"),y=P(()=>s.initialData?"SEO Report updated successfully!":"SEO Report created successfully!"),_=f=>{o("saved",f),o("close")},k=()=>{o("close")},w=()=>{try{const f=JSON.parse(i.data);i.data=JSON.stringify(f,null,2)}catch(f){console.error("Invalid JSON for pretty print:",f)}},E=f=>{if(i.data)try{JSON.parse(i.data),f.data&&f.data[0]==="The data field must be a valid JSON string."&&(f.data=[])}catch{(!f.data||f.data.length===0)&&(f.data=["The data field must be a valid JSON string."])}};return(f,h)=>(n(),le(Ee,{show:l.show,title:r.value,"api-endpoint":m.value,"http-method":c.value,"form-data":i,"submit-button-text":v.value,"success-message":y.value,"format-data-for-api":u,onClose:k,onSubmitted:_},{default:L(({errors:T})=>[e("div",Nv,[e("div",null,[p(W,{for:"report_date",value:"Report Month (YYYY-MM)"}),p(ne,{id:"report_date",modelValue:i.report_date,"onUpdate:modelValue":h[0]||(h[0]=A=>i.report_date=A),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 2025-07",required:"",autofocus:"",pattern:"\\d{4}-\\d{2}",title:"Please enter a date in YYYY-MM format (e.g., 2025-07)",disabled:!!l.initialData},null,8,["modelValue","disabled"]),p(ae,{message:T.report_date?T.report_date[0]:"",class:"mt-2"},null,8,["message"]),h[2]||(h[2]=e("p",{class:"text-xs text-gray-500 mt-1"},"Enter the report month in YYYY-MM format (e.g., 2025-07).",-1)),l.initialData?(n(),d("p",Pv,"Note: Report month cannot be changed when editing.")):C("",!0)]),e("div",null,[p(W,{for:"report_data",value:"Report Data (JSON)"}),ce(e("textarea",{id:"report_data",ref_key:"jsonInputRef",ref:a,"onUpdate:modelValue":h[1]||(h[1]=A=>i.data=A),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 font-mono",rows:"10",placeholder:'Enter JSON data for the report, e.g., {"keywords_ranked": 150, "traffic": 1200, "rankings": {"keyword1": 5, "keyword2": 12}}',required:"",onBlur:A=>E(T)},null,40,Rv),[[fe,i.data]]),p(ae,{message:T.data?T.data[0]:"",class:"mt-2"},null,8,["message"]),e("div",{class:"flex justify-end mt-2"},[e("button",{type:"button",onClick:w,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," Format JSON ")])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},Bv={class:"py-8 max-w-full mx-auto px-4 sm:px-6 lg:px-8"},Hv={key:0,class:"text-center text-gray-600 text-lg animate-pulse"},Wv={key:1,class:"text-center text-red-600 text-lg font-medium"},Yv={key:2,class:"space-y-8"},zv={class:"flex justify-end items-center mb-5"},qv={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Gv={key:1},Kv={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Jv={class:"flex justify-between items-center mb-4"},Zv={class:"overflow-x-auto"},Xv={class:"min-w-full divide-y divide-gray-200"},Qv={class:"bg-white divide-y divide-gray-200"},ep={class:"px-4 py-3 text-sm text-gray-900"},tp={class:"px-4 py-3 text-sm text-gray-700"},sp={class:"px-4 py-3 text-sm text-gray-700"},lp={class:"px-4 py-3 text-right"},ap=["onClick"],ip={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},np={class:"flex justify-between items-center mb-4"},op={key:2,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},rp={class:"flex justify-between items-center mb-4"},dp={key:0,class:"text-gray-400 text-sm"},up={key:1,class:"overflow-x-auto"},cp={class:"min-w-full divide-y divide-gray-200"},mp={class:"bg-white divide-y divide-gray-200"},vp={class:"px-4 py-3 text-sm text-gray-900"},pp={class:"px-4 py-3 text-sm text-gray-700"},hp={class:"px-4 py-3 text-sm text-gray-700"},gp={class:"px-4 py-3 text-sm text-gray-700"},yp={class:"px-4 py-3 text-sm text-gray-700"},fp={class:"px-4 py-3 text-right"},bp={key:3,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},_p={class:"flex justify-between items-center mb-4"},wp={class:"flex items-center gap-4"},xp={key:0},kp={key:0,class:"space-y-4"},Dp={class:"flex justify-between"},Cp={class:"flex-grow"},$p={key:0,class:"text-xs text-red-400 block mt-1"},Sp={class:"flex items-center mt-1"},Ep={class:"text-xs text-gray-500"},Mp={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},Tp={key:0},jp={key:1,class:"text-gray-400 text-sm"},Vp={__name:"Show",setup(l){const t=Le(),s=as().props.id,o=x({clients:[],users:[],notes:[],transactions:[],documents:[],meetings:[],tasks:[],emails:[],deliverables:[]}),i=x(!0),a=x(""),u=x(!1),r=x(!1),m=x(!1),c=x(!1),v=x(!1),y=x(!1),_=x(!1),k=x(!1),w=x(!1),E=x(null),f=x(null),h=x(!1),T=x(!1),A=x(null),N=[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"on_hold",label:"On Hold"},{value:"archived",label:"Archived"}],I=[{value:"Website Designing",label:"Website Designing"},{value:"SEO",label:"SEO"},{value:"Social Media",label:"Social Media"},{value:"Content Writing",label:"Content Writing"},{value:"Graphic Design",label:"Graphic Design"}],Y=[{value:"UpWork",label:"UpWork"},{value:"Direct",label:"Direct Client"},{value:"Wix Marketplace",label:"Wix Marketplace"},{value:"Referral",label:"Referral"}],B=x(null),S=x(null),V=is(o),{canDo:M,canView:O}=et(s),G=P(()=>{var te,F;return((F=(te=t.value)==null?void 0:te.role_data)==null?void 0:F.slug)==="super-admin"}),U=P(()=>M("manage_projects").value||G.value),j=P(()=>M("edit_projects").value||G.value),b=P(()=>O("emails").value),D=P(()=>M("compose_emails").value),$=P(()=>M("approve_emails").value),H=P(()=>O("project_notes").value),oe=P(()=>M("add_project_notes").value),Ve=P(()=>O("deliverables").value),X=P(()=>M("create_deliverables").value),q=P(()=>O("seo_reports").value),J=P(()=>M("create_seo_reports").value),ge=P(()=>O("client_contacts").value);P(()=>O("users").value);const Ne=P(()=>O("project_financial",V).value),tt=P(()=>O("project_transactions").value);P(()=>O("client_financial").value);const Ct=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],qe=x([]),$t=async()=>{try{const te=await window.axios.get(`/api/projects/${s}/due-and-overdue-tasks`);qe.value=te.data}catch(te){console.error("Error fetching due and overdue tasks:",te)}},st=P(()=>o.value.notes?[...o.value.notes].filter(te=>te.type!=="standup").sort((te,F)=>new Date(F.created_at)-new Date(te.created_at)).slice(0,3):[]),lt=x([]),Ge=async()=>{try{const te=await window.axios.get(`/api/projects/${s}/emails-simplified`,{params:{limit:5}});lt.value=te.data}catch(te){console.error("Error fetching latest emails:",te)}},De=async()=>{i.value=!0,a.value="";try{const te=await window.axios.get(`/api/projects/${s}`);o.value=te.data,console.log("Full project data received (Show.vue main fetch):",o.value),await $t()}catch(te){a.value="Failed to load project data.",console.error("Error fetching project data:",te),te.response&&(te.response.status===401||te.response.status===403)&&(a.value="You are not authorized to view this project or your session expired. Please log in.")}finally{i.value=!1}},St=te=>{o.value=te,u.value=!1,De()},Et=te=>{o.value.tasks=te},Mt=te=>{o.value.emails=te,b.value&&Ge()},at=te=>{o.value.notes=te},Tt=()=>{De()},jt=()=>{B.value&&B.value.fetchMeetings()},it=()=>{De()},Vt=te=>{S.value=te,Ke(),ot()},At=()=>{y.value=!0},It=()=>{_.value=!0,S.value="emails"},Ot=async()=>{_.value=!1,await De(),b.value&&await Ge()},Lt=()=>{_.value=!1},nt=te=>{E.value=te,f.value=null,w.value=!0},Ke=()=>{w.value=!1,E.value=null},Ut=()=>{De()},Nt=te=>{o.value.tasks=o.value.tasks.filter(F=>F.id!==te),De(),Ke()},Pt=te=>{f.value=te,E.value=null,w.value=!0},ot=()=>{w.value=!1,f.value=null},Rt=()=>{De()},Ft=()=>{h.value=!0},Bt=()=>{h.value=!1,De()},Ht=(te=null)=>{A.value=te,T.value=!0},Wt=()=>{T.value=!1};return be(async()=>{console.log("Show.vue mounted, fetching initial data...");try{await ns(s),console.log("Project permissions fetched (includes global)")}catch(te){console.error(`Error fetching permissions for project ${s}:`,te)}await ds(),await De(),b.value&&await Ge()}),(te,F)=>{const Yt=Te("SecondaryButton");return n(),d(Z,null,[p(K(os),{title:o.value.name||"Project Details"},null,8,["title"]),p(Zt,null,{default:L(()=>{var rt;return[e("div",Bv,[i.value?(n(),d("div",Hv," Loading project details... ")):a.value?(n(),d("div",Wv,g(a.value),1)):(n(),d("div",Yv,[p(ln,{project:o.value,"project-id":K(s),"can-manage-projects":U.value,"is-super-admin":G.value,"can-edit-projects":j.value,onOpenEditModal:F[0]||(F[0]=z=>u.value=!0),onOpenStandupModal:F[1]||(F[1]=z=>m.value=!0),onOpenMeetingModal:F[2]||(F[2]=z=>r.value=!0),onOpenMagicLinkModal:F[3]||(F[3]=z=>v.value=!0),onResourceSaved:De,onOpenComposeModal:It},null,8,["project","project-id","can-manage-projects","is-super-admin","can-edit-projects"]),p(ks,{"project-id":K(s),ref_key:"meetingsListComponent",ref:B},null,8,["project-id"]),p(pn,{tasks:o.value.tasks||[],emails:o.value.emails||[]},null,8,["tasks","emails"]),e("div",zv,[p(pe,{id:"display-currency-switcher",modelValue:K(Be),"onUpdate:modelValue":F[4]||(F[4]=z=>rs(Be)?Be.value=z:null),options:Ct,"value-key":"value","label-key":"label",class:"w-20",containerClasses:"max-w-[150px]"},null,8,["modelValue"])]),Ne.value&&tt.value?(n(),le(zd,{key:0,"project-id":K(s),"can-view-project-services-and-payments":Ne.value,"can-view-project-transactions":tt.value},null,8,["project-id","can-view-project-services-and-payments","can-view-project-transactions"])):C("",!0),e("div",qv,[ge.value?(n(),le(Qd,{key:0,"project-id":K(s),"can-view-client-contacts":ge.value},null,8,["project-id","can-view-client-contacts"])):C("",!0),p(ru,{"project-id":K(s),"can-view-users":!0},null,8,["project-id"]),p(ku,{"project-id":K(s),onViewUserTransactions:At},null,8,["project-id"])]),p(fn,{selectedTab:S.value,"onUpdate:selectedTab":F[5]||(F[5]=z=>S.value=z),"can-view-emails":b.value,"can-view-notes":H.value,"can-view-deliverables":Ve.value,"can-view-seo-reports":q.value},null,8,["selectedTab","can-view-emails","can-view-notes","can-view-deliverables","can-view-seo-reports"]),S.value===null?(n(),d("div",Gv,[qe.value.length>0?(n(),d("div",Kv,[e("div",Jv,[F[25]||(F[25]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:F[6]||(F[6]=z=>S.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),e("div",Zv,[e("table",Xv,[F[26]||(F[26]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned To"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Qv,[(n(!0),d(Z,null,ee(qe.value,z=>{var Me;return n(),d("tr",{key:z.id,class:"hover:bg-gray-50 transition-colors"},[e("td",ep,g(z.name),1),e("td",tp,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":z.status==="To Do","bg-blue-100 text-blue-800":z.status==="In Progress","bg-green-100 text-green-800":z.status==="Done","bg-red-100 text-red-800":z.status==="Blocked","bg-gray-100 text-gray-800":z.status==="Archived"})},g(z.status),3)]),e("td",sp,g((Me=z.assigned_to)==null?void 0:Me.name),1),e("td",lp,[e("button",{onClick:dt=>nt(z.id),class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium"}," View/Edit ",8,ap)])])}),128))])])])])):(n(),d("div",ip,[e("div",np,[F[27]||(F[27]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:F[7]||(F[7]=z=>S.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),F[28]||(F[28]=e("p",{class:"text-gray-400 text-sm"},"No due or overdue tasks.",-1))])),b.value?(n(),d("div",op,[e("div",rp,[F[29]||(F[29]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Emails",-1)),e("button",{onClick:F[8]||(F[8]=z=>S.value="emails"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Emails → ")]),(rt=o.value.emails)!=null&&rt.length?(n(),d("div",up,[e("table",cp,[F[31]||(F[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",mp,[(n(!0),d(Z,null,ee(lt.value,z=>{var Me;return n(),d("tr",{key:z.id,class:"hover:bg-gray-50 transition-colors"},[e("td",vp,g(z.subject),1),e("td",pp,g(((Me=z.sender)==null?void 0:Me.name)||"N/A"),1),e("td",hp,g(new Date(z.created_at).toLocaleDateString()),1),e("td",gp,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":z.type==="sent","bg-purple-100 text-purple-800":z.type==="received"})},g(z.type?z.type.toUpperCase():"N/A"),3)]),e("td",yp,[e("span",{class:Q({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":z.status==="sent","bg-yellow-100 text-yellow-800":z.status==="pending_approval","bg-blue-200 text-blue-900":z.status==="pending_approval_received","bg-red-100 text-red-800":z.status==="rejected","bg-gray-100 text-gray-800":z.status==="draft"})},g(z.status.replace("_"," ").toUpperCase()),3)]),e("td",fp,[p(Yt,{class:"text-indigo-600 hover:text-indigo-800",onClick:dt=>te.viewEmail(z)},{default:L(()=>F[30]||(F[30]=[R(" View ",-1)])),_:2,__:[30]},1032,["onClick"])])])}),128))])])])):(n(),d("div",dp,"No email communication found."))])):C("",!0),H.value?(n(),d("div",bp,[e("div",_p,[F[33]||(F[33]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Notes",-1)),e("div",wp,[e("button",{onClick:F[9]||(F[9]=z=>S.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Notes → "),oe.value?(n(),d("div",xp,[p(ue,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:F[10]||(F[10]=z=>c.value=!0)},{default:L(()=>F[32]||(F[32]=[R(" Add Note ",-1)])),_:1,__:[32]})])):C("",!0)])]),st.value.length?(n(),d("div",kp,[(n(!0),d(Z,null,ee(st.value,z=>{var Me;return n(),d("div",{key:z.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",Dp,[e("div",Cp,[e("p",{class:Q(["text-sm",{"text-gray-700":z.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":z.content==="[Encrypted content could not be decrypted]"}])},[R(g(z.content)+" ",1),z.content==="[Encrypted content could not be decrypted]"?(n(),d("span",$p," (There was an issue decrypting this note. Please contact an administrator.) ")):C("",!0)],2),e("div",Sp,[e("p",Ep,"Added by "+g(((Me=z.user)==null?void 0:Me.name)||"Unknown")+" on "+g(new Date(z.created_at).toLocaleDateString()),1),z.reply_count>0?(n(),d("span",Mp,g(z.reply_count)+" "+g(z.reply_count===1?"reply":"replies"),1)):C("",!0)])]),H.value&&z.chat_message_id&&o.value.google_chat_id?(n(),d("div",Tp,[e("button",{onClick:F[11]||(F[11]=dt=>S.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View ")])):C("",!0)])])}),128))])):(n(),d("p",jp,"No notes available."))])):C("",!0)])):C("",!0),S.value==="tasks"?(n(),le(bo,{key:2,"project-id":K(s),"project-users":o.value.users||[],"can-manage-projects":U.value,onTasksUpdated:Et,onOpenTaskDetailSidebar:nt,onOpenCreateTaskModal:Ft},null,8,["project-id","project-users","can-manage-projects"])):C("",!0),S.value==="emails"?(n(),le(Jr,{key:3,"project-id":K(s),"can-view-emails":b.value,"can-compose-emails":D.value,"can-approve-emails":$.value,"user-project-role":K(V),"open-compose":_.value,onEmailsUpdated:Mt,onResetOpenCompose:F[12]||(F[12]=z=>_.value=!1)},null,8,["project-id","can-view-emails","can-compose-emails","can-approve-emails","user-project-role","open-compose"])):C("",!0),S.value==="standups"?(n(),le(ja,{key:4,projectId:K(s),users:o.value.users||[],onStandupAdded:it},null,8,["projectId","users"])):C("",!0),S.value==="notes"?(n(),le(jd,{key:5,"project-id":K(s),"google-chat-id":o.value.google_chat_id,"can-view-notes":H.value,"can-add-notes":oe.value,onNotesUpdated:at,onChangeTab:Vt},null,8,["project-id","google-chat-id","can-view-notes","can-add-notes"])):C("",!0),S.value==="deliverables"?(n(),le(wc,{key:6,"project-id":K(s),"can-create-deliverables":X.value,"can-view-deliverables":Ve.value,onDeliverablesUpdated:Tt,onOpenDeliverableDetailSidebar:Pt},null,8,["project-id","can-create-deliverables","can-view-deliverables"])):C("",!0),S.value==="seo-reports"?(n(),le(Uv,{key:7,"project-id":K(s),"can-create-seo-reports":J.value,onOpenCreateSeoReportModal:Ht},null,8,["project-id","can-create-seo-reports"])):C("",!0)]))]),p(Se,{show:u.value,onClose:F[14]||(F[14]=z=>u.value=!1)},{default:L(()=>[p(us,{show:u.value,project:o.value,statusOptions:N,departmentOptions:I,sourceOptions:Y,clientRoleOptions:[],userRoleOptions:[],paymentTypeOptions:[],onClose:F[13]||(F[13]=z=>u.value=!1),onSubmit:St},null,8,["show","project"])]),_:1},8,["show"]),p(za,{show:r.value,onClose:F[15]||(F[15]=z=>r.value=!1),onSaved:jt,projectId:K(s),projectUsers:o.value.users||[]},null,8,["show","projectId","projectUsers"]),p(yt,{show:m.value,onClose:F[16]||(F[16]=z=>m.value=!1),onStandupAdded:it,projectId:K(s)},null,8,["show","projectId"]),p(ft,{show:c.value,"project-id":K(s),onClose:F[17]||(F[17]=z=>c.value=!1),onNoteAdded:at},null,8,["show","project-id"]),p(Qa,{show:v.value,"project-id":K(s),"project-clients":o.value.clients||[],onClose:F[18]||(F[18]=z=>v.value=!1)},null,8,["show","project-id","project-clients"]),p(Lu,{show:y.value,"project-id":K(s),"project-name":o.value.name,onClose:F[19]||(F[19]=z=>y.value=!1)},null,8,["show","project-id","project-name"]),p(kt,{show:_.value,"project-id":K(s),"user-project-role":K(V),onClose:Lt,onSubmitted:Ot,onError:F[20]||(F[20]=z=>console.error("Error composing email:",z))},null,8,["show","project-id","user-project-role"]),p(Gt,{show:w.value,"onUpdate:show":F[21]||(F[21]=z=>w.value=z),title:E.value?"Task Details":f.value?"Deliverable Details":"Details",initialWidth:50},{content:L(()=>[E.value?(n(),le(Kt,{key:0,"task-id":E.value,"project-users":o.value.users||[],onClose:Ke,onTaskUpdated:Ut,onTaskDeleted:Nt},null,8,["task-id","project-users"])):f.value?(n(),le(tm,{key:1,"project-id":K(s),"deliverable-id":f.value,onClose:ot,onDeliverableUpdated:Rt},null,8,["project-id","deliverable-id"])):C("",!0)]),_:1},8,["show","title"]),p(Jt,{show:h.value,"project-id":K(s),onClose:F[22]||(F[22]=z=>h.value=!1),onSaved:Bt},null,8,["show","project-id"]),p(Dt,{show:k.value,"project-id":K(s),onClose:F[23]||(F[23]=z=>k.value=!1),onSaved:te.handleDeliverableSaved},null,8,["show","project-id","onSaved"]),p(Fv,{"project-id":K(s),show:T.value,"initial-data":A.value,onClose:F[24]||(F[24]=z=>T.value=!1),onSaved:Wt},null,8,["project-id","show","initial-data"])]}),_:1})],64)}}},Yp=Ce(Vp,[["__scopeId","data-v-4fb56b07"]]);export{Yp as default};
