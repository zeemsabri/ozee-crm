import{c as n,o as r,a as o,l as V,G as Ve,E as Ce,r as v,D as $e,b as je,e as a,u as f,h as Ae,w as _,t as m,f as C,q as ze,k as w,F as $,i as j,H as A,g as b,n as se,y as te,A as oe}from"./app-DdN7Mxvn.js";import{T as le,_ as Me}from"./AuthenticatedLayout-DCuF-6aA.js";import{_ as B}from"./PrimaryButton-DXqku6c5.js";import{D as Pe}from"./DangerButton-C59gx8tK.js";import{_ as K}from"./Modal-BcCWKK72.js";import{_ as p}from"./InputLabel-DKcmer0l.js";import{_ as k}from"./TextInput-rDmpDdXP.js";import{_ as h}from"./InputError-CKfk0GwB.js";import{_ as Y}from"./SecondaryButton-B7cHuvDb.js";import{r as Z}from"./UsersIcon-CyrabjPA.js";import{r as Se}from"./BriefcaseIcon-Oi85ojVn.js";import{r as Ee}from"./MagnifyingGlassIcon-DsFDxTyx.js";import{r as Re}from"./PlusIcon-CqRqPlty.js";import{r as De}from"./PencilSquareIcon-BQ52J45z.js";import"./index-v3z0kSKS.js";import"./BaseFormModal-BYgNgfCI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SelectDropdown-u4-e266e.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./RightSidebar-CB8jYa8v.js";import"./ApplicationLogo-DGT7JHiM.js";import"./MultiSelectDropdown-BdM68tHG.js";import"./createLucideIcon-BXbmwqJx.js";import"./plus-Buz5Bsfi.js";import"./moment-BLMuvzoS.js";import"./taskState-owP4uair.js";import"./NoticeboardModal-BKh2eV_V.js";import"./x-DGBM-pIh.js";function Ne(H,g){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"})])}function qe(H,g){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9 9 6-6m0 0 6 6m-6-6v12a6 6 0 0 1-12 0v-3"})])}function ae(H,g){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})])}const Fe={class:"py-6 sm:py-12"},Le={class:"px-4 sm:px-6 lg:px-8"},Be={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},He={class:"bg-white rounded-2xl shadow-sm p-6 flex items-center justify-between transition-all duration-300 hover:shadow-md hover:scale-105"},Te={class:"text-3xl font-bold text-gray-900 mt-1"},Oe={class:"bg-white rounded-2xl shadow-sm p-6 flex items-center justify-between transition-all duration-300 hover:shadow-md hover:scale-105"},Ke={class:"text-3xl font-bold text-gray-900 mt-1"},Ye={class:"bg-white rounded-2xl shadow-sm p-6 flex items-center justify-between transition-all duration-300 hover:shadow-md hover:scale-105"},Ze={class:"text-3xl font-bold text-gray-900 mt-1"},Ge={class:"bg-white rounded-2xl shadow-sm p-6 flex items-center justify-between transition-all duration-300 hover:shadow-md hover:scale-105"},Qe={class:"text-3xl font-bold text-gray-900 mt-1"},Je={class:"bg-white rounded-2xl shadow-xl overflow-hidden"},We={class:"p-6"},Xe={class:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4"},Ie={class:"w-full md:w-auto flex flex-col sm:flex-row gap-4 items-center"},es={class:"relative w-full"},ss={class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},ts=["value"],os=["value"],ls={key:0,class:"text-center p-12"},as={key:1,class:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg",role:"alert"},rs={key:2,class:"text-center p-12"},ns={key:3},is={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},ds={class:"flex items-center space-x-4 mb-4"},us={class:"flex-shrink-0"},ms={class:"text-xl font-bold text-gray-900"},cs={class:"text-sm text-gray-500 truncate"},ps={class:"flex flex-wrap gap-2 mb-4"},gs={class:"inline-flex items-center rounded-full px-3 py-1 text-xs font-medium bg-gray-50 text-gray-600 ring-1 ring-inset ring-gray-500/10"},vs={class:"text-sm text-gray-600 mt-auto"},fs={key:0,class:"text-xs mt-1 text-gray-500"},ys={key:0,class:"group relative inline-block cursor-pointer text-indigo-500 hover:text-indigo-700"},_s={class:"absolute z-10 bottom-full left-1/2 -translate-x-1/2 mb-2 w-max p-2 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity"},ws={class:"list-none p-0 m-0"},xs={key:1,class:"text-xs text-gray-400 mt-1"},bs={key:0,class:"mt-3 p-2 bg-gray-50 rounded-lg border border-dashed border-gray-300"},hs={class:"text-[10px] uppercase font-semibold text-gray-400 mb-1 flex items-center"},ks={class:"text-[10px] break-all text-indigo-600 block"},Us={class:"mt-4 flex justify-end gap-2"},Vs=["onClick"],Cs=["onClick"],$s=["onClick"],js=["onClick"],As={class:"p-6"},zs={key:0,class:"text-red-600 text-sm mb-4"},Ms={class:"mb-4"},Ps={class:"mb-4"},Ss={class:"mb-4"},Es={class:"mb-4"},Rs={class:"mb-4"},Ds=["value","disabled"],Ns={class:"mb-4"},qs={class:"mb-4"},Fs={class:"mt-2 grid grid-cols-1 gap-4"},Ls={class:"flex items-center space-x-3 cursor-pointer"},Bs=["value"],Hs={class:"text-sm font-semibold text-gray-800"},Ts={key:0,class:"mt-4 pt-4 border-t border-gray-100"},Os={class:"mb-4"},Ks={class:"mt-6 flex justify-end"},Ys={class:"p-6"},Zs={key:0,class:"text-red-600 text-sm mb-4"},Gs={class:"mb-4"},Qs={class:"mb-4"},Js={class:"mb-4"},Ws={class:"mb-4"},Xs={class:"mb-4"},Is=["disabled"],et=["value","disabled"],st={class:"mb-4"},tt={class:"mb-4"},ot={class:"mt-2 grid grid-cols-1 gap-4"},lt={class:"flex items-center space-x-3 cursor-pointer"},at=["value"],rt={class:"text-sm font-semibold text-gray-800"},nt={key:0,class:"mt-4 pt-4 border-t border-gray-100"},it={class:"mb-4"},dt={class:"mt-6 flex justify-end"},ut={class:"p-6"},mt={key:0,class:"mt-4 text-gray-800"},ct={key:1,class:"text-red-600 text-sm mb-4"},pt={class:"mt-6 flex justify-end"},Tt={__name:"Index",setup(H){const g=V(()=>Ve().props.auth.user),{canDo:G}=Ce(),x=v([]),T=v(!0),i=v({}),d=v(""),D=v(""),N=v(""),q=v(""),F=v("active"),P=v(!1),S=v(!1),E=v(!1),l=$e({id:null,name:"",email:"",password:"",password_confirmation:"",role:"contractor",role_id:4,user_type:"contractor",timezone:"",category_ids:[]}),U=v(null),y=v([]),O=v([]),re=v(null),ne=V(()=>{const t=x.value.flatMap(s=>s.projects||[]);return[...new Set(t.map(s=>s.id))].map(s=>{const u=t.find(c=>c.id===s);return{value:u.id,label:u.name}})}),ie=V(()=>x.value.length),de=V(()=>x.value.filter(t=>{var e;return((e=t.role_data)==null?void 0:e.slug)==="manager"||t.role==="manager"||t.role==="manager-role"||t.role==="manager_role"}).length),ue=V(()=>x.value.filter(t=>{var e;return((e=t.role_data)==null?void 0:e.slug)==="employee"||t.role==="employee"}).length),me=V(()=>x.value.filter(t=>{var e;return((e=t.role_data)==null?void 0:e.slug)==="contractor"||t.role==="contractor"}).length),Q=V(()=>{let t=x.value;if(N.value&&(t=t.filter(e=>{var u,c;return(((u=e.role_data)==null?void 0:u.id)||((c=y.value.find(L=>L.slug===e.role))==null?void 0:c.value))===N.value})),q.value&&(t=t.filter(e=>e.projects&&e.projects.some(s=>s.id===q.value))),D.value){const e=D.value.toLowerCase();t=t.filter(s=>s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e))}return t}),ce=async()=>{try{const t=await window.axios.get("/api/roles?type=application");y.value=t.data.map(e=>({value:e.id,slug:e.slug.replace(/-/g,"_"),label:e.name}))}catch(t){console.error("Error fetching roles:",t),y.value=[{value:1,slug:"super_admin",label:"Super Admin"},{value:2,slug:"manager",label:"Manager"},{value:3,slug:"employee",label:"Employee"},{value:4,slug:"contractor",label:"Contractor"}]}},J=async()=>{try{const e=(await window.axios.get("/api/category-sets")).data.find(s=>s.slug==="departments");if(e){re.value=e.id;const s=await window.axios.get(`/api/category-sets/${e.id}/categories`);O.value=s.data}}catch(t){console.error("Error fetching departments:",t)}},W=async(t,e)=>{try{await window.axios.put(`/api/categories/${t.id}`,{tag_ids:e}),J()}catch(s){console.error("Error updating department tags:",s)}},R=V(()=>{var t;return g.value?((t=g.value.role_data)==null?void 0:t.slug)==="super-admin"||g.value.role==="super_admin"||g.value.role==="super-admin":!1}),X=V(()=>{var t;return g.value?((t=g.value.role_data)==null?void 0:t.slug)==="manager"||g.value.role==="manager"||g.value.role==="manager-role"||g.value.role==="manager_role":!1}),I=G("delete_users"),pe=G("create_users"),z=async()=>{T.value=!0,d.value="";try{const t={};F.value==="all"?t.with_trashed=1:F.value==="archived"&&(t.only_trashed=1);const e=await window.axios.get("/api/users",{params:t});x.value=e.data}catch(t){d.value="Failed to fetch users.",console.error("Error fetching users:",t),t.response&&t.response.status===403?d.value="You do not have permission to view users.":t.response&&t.response.status===401&&(d.value="Session expired. Please log in again.",localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),window.location.href="/login")}finally{T.value=!1}},ge=()=>{l.id=null,l.name="",l.email="",l.password="",l.password_confirmation="";const t=y.value.find(e=>e.slug==="contractor");l.role_id=(t==null?void 0:t.value)||(y.value.length>0?y.value[0].value:4),l.role=(t==null?void 0:t.slug)||"contractor",l.user_type="contractor";try{l.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone||""}catch{l.timezone=""}l.category_ids=[],i.value={},d.value="",P.value=!0},ve=async()=>{i.value={},d.value="";try{const t=await window.axios.post("/api/users",l);x.value.push(t.data),P.value=!1,console.log("User created successfully!"),z()}catch(t){t.response&&t.response.status===422?i.value=t.response.data.errors:t.response&&t.response.data.message?d.value=t.response.data.message:(d.value="Failed to create user.",console.error("Error creating user:",t))}},fe=t=>{if(l.id=t.id,l.name=t.name,l.email=t.email,l.timezone=t.timezone||"",t.role_data&&t.role_data.id)l.role_id=t.role_data.id,l.role=t.role_data.slug.replace(/-/g,"_");else{const e=typeof t.role=="string"?t.role.replace(/-/g,"_"):"employee",s=y.value.find(u=>u.slug===e);l.role_id=(s==null?void 0:s.value)||(y.value.length>0?y.value[0].value:null),l.role=e}l.user_type=t.user_type||"employee",l.category_ids=t.categories?t.categories.map(e=>e.id):[],l.password="",l.password_confirmation="",i.value={},d.value="",S.value=!0},ye=async()=>{i.value={},d.value="";try{const t={...l};t.password||(delete t.password,delete t.password_confirmation);const e=await window.axios.put(`/api/users/${l.id}`,t),s=x.value.findIndex(u=>u.id===l.id);s!==-1&&(x.value[s]=e.data),S.value=!1,console.log("User updated successfully!"),z()}catch(t){t.response&&t.response.status===422?i.value=t.response.data.errors:t.response&&t.response.data.message?d.value=t.response.data.message:(d.value="Failed to update user.",console.error("Error updating user:",t))}},_e=t=>{U.value=t,E.value=!0},we=async()=>{d.value="";try{await window.axios.delete(`/api/users/${U.value.id}`),await z(),E.value=!1,U.value=null,console.log("User archived successfully!")}catch(t){d.value="Failed to archive user.",t.response&&t.response.data.message&&(d.value=t.response.data.message),console.error("Error archiving user:",t)}},xe=async t=>{d.value="";try{await window.axios.post(`/api/users/${t.id}/restore`),await z(),console.log("User restored successfully!")}catch(e){d.value="Failed to restore user.",e.response&&e.response.data.message&&(d.value=e.response.data.message),console.error("Error restoring user:",e)}},be=async t=>{if(confirm(`Are you sure you want to generate a new API key for ${t.name}? The old one will stop working.`))try{const e=await window.axios.post(`/api/users/${t.id}/generate-api-key`),s=x.value.findIndex(u=>u.id===t.id);s!==-1&&(x.value[s].api_key=e.data.api_key),console.log("API key generated successfully!")}catch(e){console.error("Error generating API key:",e),alert("Failed to generate API key.")}},ee=()=>{const t=y.value.find(e=>e.value===l.role_id);t&&(l.role=t.slug)},he=t=>{if(!t||t.length===0)return"None";const e=t.map(u=>u.name);if(e.length<=2)return e.join(", ");const s=e.length-2;return`${e[0]}, ${e[1]} and ${s} more`};je(()=>{z(),ce(),J()});const ke=t=>{switch(typeof t=="string"?t.toLowerCase():(t==null?void 0:t.slug)||"employee"){case"super_admin":case"super-admin":return"bg-red-50 text-red-700 ring-red-600/20";case"manager":return"bg-indigo-50 text-indigo-700 ring-indigo-600/20";case"employee":return"bg-emerald-50 text-emerald-700 ring-emerald-600/20";case"contractor":return"bg-yellow-50 text-yellow-700 ring-yellow-600/20";default:return"bg-gray-50 text-gray-600 ring-gray-500/10"}},Ue=t=>{const e=t.split("").reduce((u,c)=>u+c.charCodeAt(0),0),s=["bg-blue-500","bg-indigo-500","bg-purple-500","bg-pink-500","bg-rose-500","bg-orange-500","bg-amber-500","bg-lime-500","bg-emerald-500","bg-cyan-500"];return s[e%s.length]};return(t,e)=>(r(),n($,null,[a(f(Ae),{title:"Users"}),a(Me,null,{header:_(()=>e[26]||(e[26]=[o("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Users",-1)])),default:_(()=>[o("div",Fe,[o("div",Le,[o("div",Be,[o("div",He,[o("div",null,[e[27]||(e[27]=o("h4",{class:"text-gray-500 font-medium text-sm"},"Total Users",-1)),o("p",Te,m(ie.value),1)]),a(f(Z),{class:"h-12 w-12 text-indigo-500 opacity-80"})]),o("div",Oe,[o("div",null,[e[28]||(e[28]=o("h4",{class:"text-gray-500 font-medium text-sm"},"Managers",-1)),o("p",Ke,m(de.value),1)]),a(f(Z),{class:"h-12 w-12 text-green-500 opacity-80"})]),o("div",Ye,[o("div",null,[e[29]||(e[29]=o("h4",{class:"text-gray-500 font-medium text-sm"},"Employees",-1)),o("p",Ze,m(ue.value),1)]),a(f(Z),{class:"h-12 w-12 text-yellow-500 opacity-80"})]),o("div",Ge,[o("div",null,[e[30]||(e[30]=o("h4",{class:"text-gray-500 font-medium text-sm"},"Contractors",-1)),o("p",Qe,m(me.value),1)]),a(f(Se),{class:"h-12 w-12 text-pink-500 opacity-80"})])]),o("div",Je,[o("div",We,[o("div",Xe,[e[35]||(e[35]=o("h3",{class:"text-2xl font-bold text-gray-900"},"User Management",-1)),o("div",Ie,[o("div",es,[o("div",ss,[a(f(Ee),{class:"w-5 h-5 text-gray-400"})]),a(k,{id:"search",type:"text",class:"w-full pl-10 pr-3 py-2 rounded-lg",placeholder:"Search users...",modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=s=>D.value=s)},null,8,["modelValue"])]),C(o("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>N.value=s),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm w-full sm:w-40"},[e[31]||(e[31]=o("option",{value:""},"All Roles",-1)),(r(!0),n($,null,j(y.value,s=>(r(),n("option",{key:s.value,value:s.value},m(s.label),9,ts))),128))],512),[[A,N.value]]),C(o("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>q.value=s),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm w-full sm:w-40"},[e[32]||(e[32]=o("option",{value:""},"All Projects",-1)),(r(!0),n($,null,j(ne.value,s=>(r(),n("option",{key:s.value,value:s.value},m(s.label),9,os))),128))],512),[[A,q.value]]),C(o("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>F.value=s),onChange:z,class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm w-full sm:w-40"},e[33]||(e[33]=[o("option",{value:"active"},"Active",-1),o("option",{value:"archived"},"Archived",-1),o("option",{value:"all"},"All",-1)]),544),[[A,F.value]]),f(pe)?(r(),ze(B,{key:0,onClick:ge,class:"w-full sm:w-auto"},{default:_(()=>[a(f(Re),{class:"w-4 h-4 mr-2"}),e[34]||(e[34]=b(" Add User ",-1))]),_:1,__:[34]})):w("",!0)])]),T.value?(r(),n("div",ls,e[36]||(e[36]=[o("svg",{class:"animate-spin h-10 w-10 text-indigo-500 mx-auto",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),o("p",{class:"text-gray-600 mt-4"},"Loading users...",-1)]))):d.value?(r(),n("div",as,[o("p",null,m(d.value),1)])):Q.value.length===0?(r(),n("div",rs,e[37]||(e[37]=[o("p",{class:"text-gray-600"},"No users found matching your criteria.",-1)]))):(r(),n("div",ns,[o("div",is,[(r(!0),n($,null,j(Q.value,s=>{var u,c,L;return r(),n("div",{key:s.id,class:"bg-white rounded-2xl shadow-sm p-6 flex flex-col justify-between relative border border-gray-100 transition-all duration-300 hover:shadow-lg"},[o("div",null,[o("div",ds,[o("div",us,[o("div",{class:se(["h-12 w-12 rounded-full flex items-center justify-center text-white font-bold text-lg",Ue(s.name)])},m(s.name.charAt(0)),3)]),o("div",null,[o("p",ms,m(s.name),1),o("p",cs,m(s.email),1)])]),o("div",ps,[o("span",{class:se(["inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ring-1 ring-inset",ke(((u=s.role_data)==null?void 0:u.slug)||s.role)])}," Role: "+m(((c=s.role_data)==null?void 0:c.name)||(typeof s.role=="string"?s.role.replace(/_|-/g," "):"Employee")),3),o("span",gs," Type: "+m(((L=s.user_type)==null?void 0:L.toUpperCase())||"EMPLOYEE"),1)]),o("div",vs,[e[40]||(e[40]=o("p",{class:"font-medium text-gray-800"},"Projects",-1)),s.projects&&s.projects.length?(r(),n("p",fs,[b(m(he(s.projects))+" ",1),s.projects.length>2?(r(),n("span",ys,[e[39]||(e[39]=b(" (more) ",-1)),o("span",_s,[o("ul",ws,[(r(!0),n($,null,j(s.projects,M=>(r(),n("li",{key:M.id,class:"whitespace-nowrap"},m(M.name),1))),128))]),e[38]||(e[38]=o("div",{class:"absolute w-3 h-3 bg-gray-800 transform rotate-45 -bottom-1 left-1/2 -translate-x-1/2"},null,-1))])])):w("",!0)])):(r(),n("p",xs,"No projects assigned."))]),s.api_key?(r(),n("div",bs,[o("p",hs,[a(f(ae),{class:"h-3 w-3 mr-1"}),e[41]||(e[41]=b(" API Key ",-1))]),o("code",ks,m(s.api_key),1)])):w("",!0)]),o("div",Us,[a(B,{as:"a",href:`/users/${s.id}`,title:"View User"},{default:_(()=>e[42]||(e[42]=[b("View",-1)])),_:2,__:[42]},1032,["href"]),R.value||X.value?(r(),n("button",{key:0,onClick:M=>be(s),class:"p-2 rounded-full text-gray-400 hover:text-amber-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-amber-500 transition-colors",title:"Generate API Key"},[a(f(ae),{class:"h-5 w-5"})],8,Vs)):w("",!0),R.value||X.value?(r(),n("button",{key:1,onClick:M=>fe(s),class:"p-2 rounded-full text-gray-400 hover:text-indigo-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors",title:"Edit User"},[a(f(De),{class:"h-5 w-5"})],8,Cs)):w("",!0),f(I)&&s.id!==g.value.id&&!s.deleted_at?(r(),n("button",{key:2,onClick:M=>_e(s),class:"p-2 rounded-full text-gray-400 hover:text-red-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",title:"Archive User"},[a(f(Ne),{class:"h-5 w-5"})],8,$s)):w("",!0),f(I)&&s.deleted_at?(r(),n("button",{key:3,onClick:M=>xe(s),class:"p-2 rounded-full text-gray-400 hover:text-green-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors",title:"Unarchive User"},[a(f(qe),{class:"h-5 w-5"})],8,js)):w("",!0)])])}),128))])]))])])])]),a(K,{show:P.value,onClose:e[13]||(e[13]=s=>P.value=!1)},{default:_(()=>[o("div",As,[e[47]||(e[47]=o("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Create New User",-1)),d.value?(r(),n("div",zs,m(d.value),1)):w("",!0),o("form",{onSubmit:te(ve,["prevent"])},[o("div",Ms,[a(p,{for:"create_name",value:"Name"}),a(k,{id:"create_name",type:"text",class:"mt-1 block w-full",modelValue:l.name,"onUpdate:modelValue":e[4]||(e[4]=s=>l.name=s),required:"",autofocus:""},null,8,["modelValue"]),a(h,{message:i.value.name?i.value.name[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Ps,[a(p,{for:"create_email",value:"Email"}),a(k,{id:"create_email",type:"email",class:"mt-1 block w-full",modelValue:l.email,"onUpdate:modelValue":e[5]||(e[5]=s=>l.email=s),required:""},null,8,["modelValue"]),a(h,{message:i.value.email?i.value.email[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Ss,[a(p,{for:"create_password",value:"Password"}),a(k,{id:"create_password",type:"password",class:"mt-1 block w-full",modelValue:l.password,"onUpdate:modelValue":e[6]||(e[6]=s=>l.password=s),required:"",autocomplete:"new-password"},null,8,["modelValue"]),a(h,{message:i.value.password?i.value.password[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Es,[a(p,{for:"create_password_confirmation",value:"Confirm Password"}),a(k,{id:"create_password_confirmation",type:"password",class:"mt-1 block w-full",modelValue:l.password_confirmation,"onUpdate:modelValue":e[7]||(e[7]=s=>l.password_confirmation=s),required:"",autocomplete:"new-password"},null,8,["modelValue"])]),o("div",Rs,[a(p,{for:"create_role",value:"Role"}),C(o("select",{id:"create_role",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[8]||(e[8]=s=>l.role_id=s),onChange:ee},[(r(!0),n($,null,j(y.value,s=>(r(),n("option",{key:s.value,value:s.value,disabled:!R.value&&(s.slug==="super_admin"||s.slug==="manager")},m(s.label),9,Ds))),128))],544),[[A,l.role_id]]),a(h,{message:i.value.role_id?i.value.role_id[0]:i.value.role?i.value.role[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Ns,[a(p,{for:"create_user_type",value:"User Type"}),C(o("select",{id:"create_user_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[9]||(e[9]=s=>l.user_type=s)},e[43]||(e[43]=[o("option",{value:"employee"},"Employee",-1),o("option",{value:"contractor"},"Contractor",-1)]),512),[[A,l.user_type]]),a(h,{message:i.value.user_type?i.value.user_type[0]:"",class:"mt-2"},null,8,["message"])]),o("div",qs,[a(p,{value:"Departments & Responsibilities"}),o("div",Fs,[(r(!0),n($,null,j(O.value,s=>{var u;return r(),n("div",{key:s.id,class:"border rounded-xl p-4 bg-gray-50/50 shadow-sm transition-all hover:bg-white hover:shadow-md"},[o("label",Ls,[C(o("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":e[10]||(e[10]=c=>l.category_ids=c),class:"rounded-lg border-gray-300 text-indigo-600 focus:ring-indigo-500 w-5 h-5"},null,8,Bs),[[oe,l.category_ids]]),o("span",Hs,m(s.name),1)]),l.category_ids.includes(s.id)?(r(),n("div",Ts,[a(le,{modelValue:((u=s.tags)==null?void 0:u.map(c=>c.id))||[],"onUpdate:modelValue":c=>W(s,c),initialTags:s.tags||[],label:"Responsibilities",placeholder:"Add responsibilities..."},null,8,["modelValue","onUpdate:modelValue","initialTags"]),e[44]||(e[44]=o("p",{class:"text-[10px] text-gray-500 mt-2 italic"},"Note: Responsibilities are shared across all users in this department.",-1))])):w("",!0)])}),128))])]),o("div",Os,[a(p,{for:"create_timezone",value:"Timezone"}),a(k,{id:"create_timezone",type:"text",class:"mt-1 block w-full",modelValue:l.timezone,"onUpdate:modelValue":e[11]||(e[11]=s=>l.timezone=s),placeholder:"e.g., America/New_York"},null,8,["modelValue"]),a(h,{message:i.value.timezone?i.value.timezone[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Ks,[a(Y,{onClick:e[12]||(e[12]=s=>P.value=!1)},{default:_(()=>e[45]||(e[45]=[b("Cancel",-1)])),_:1,__:[45]}),a(B,{class:"ms-3",type:"submit"},{default:_(()=>e[46]||(e[46]=[b("Create User",-1)])),_:1,__:[46]})])],32)])]),_:1},8,["show"]),a(K,{show:S.value,onClose:e[23]||(e[23]=s=>S.value=!1)},{default:_(()=>[o("div",Ys,[e[52]||(e[52]=o("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit User",-1)),d.value?(r(),n("div",Zs,m(d.value),1)):w("",!0),o("form",{onSubmit:te(ye,["prevent"])},[o("div",Gs,[a(p,{for:"edit_name",value:"Name"}),a(k,{id:"edit_name",type:"text",class:"mt-1 block w-full",modelValue:l.name,"onUpdate:modelValue":e[14]||(e[14]=s=>l.name=s),required:"",autofocus:""},null,8,["modelValue"]),a(h,{message:i.value.name?i.value.name[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Qs,[a(p,{for:"edit_email",value:"Email"}),a(k,{id:"edit_email",type:"email",class:"mt-1 block w-full",modelValue:l.email,"onUpdate:modelValue":e[15]||(e[15]=s=>l.email=s),required:""},null,8,["modelValue"]),a(h,{message:i.value.email?i.value.email[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Js,[a(p,{for:"edit_password",value:"Password (leave blank to keep current)"}),a(k,{id:"edit_password",type:"password",class:"mt-1 block w-full",modelValue:l.password,"onUpdate:modelValue":e[16]||(e[16]=s=>l.password=s),autocomplete:"new-password"},null,8,["modelValue"]),a(h,{message:i.value.password?i.value.password[0]:"",class:"mt-2"},null,8,["message"])]),o("div",Ws,[a(p,{for:"edit_password_confirmation",value:"Confirm Password"}),a(k,{id:"edit_password_confirmation",type:"password",class:"mt-1 block w-full",modelValue:l.password_confirmation,"onUpdate:modelValue":e[17]||(e[17]=s=>l.password_confirmation=s),autocomplete:"new-password"},null,8,["modelValue"])]),o("div",Xs,[a(p,{for:"edit_role",value:"Role"}),C(o("select",{id:"edit_role",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[18]||(e[18]=s=>l.role_id=s),onChange:ee,disabled:!R.value&&l.id===g.value.id},[(r(!0),n($,null,j(y.value,s=>(r(),n("option",{key:s.value,value:s.value,disabled:!R.value&&(s.slug==="super_admin"||s.slug==="manager")&&l.id!==g.value.id},m(s.label),9,et))),128))],40,Is),[[A,l.role_id]]),a(h,{message:i.value.role_id?i.value.role_id[0]:i.value.role?i.value.role[0]:"",class:"mt-2"},null,8,["message"])]),o("div",st,[a(p,{for:"edit_user_type",value:"User Type"}),C(o("select",{id:"edit_user_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[19]||(e[19]=s=>l.user_type=s)},e[48]||(e[48]=[o("option",{value:"employee"},"Employee",-1),o("option",{value:"contractor"},"Contractor",-1)]),512),[[A,l.user_type]]),a(h,{message:i.value.user_type?i.value.user_type[0]:"",class:"mt-2"},null,8,["message"])]),o("div",tt,[a(p,{value:"Departments & Responsibilities"}),o("div",ot,[(r(!0),n($,null,j(O.value,s=>{var u;return r(),n("div",{key:s.id,class:"border rounded-xl p-4 bg-gray-50/50 shadow-sm transition-all hover:bg-white hover:shadow-md"},[o("label",lt,[C(o("input",{type:"checkbox",value:s.id,"onUpdate:modelValue":e[20]||(e[20]=c=>l.category_ids=c),class:"rounded-lg border-gray-300 text-indigo-600 focus:ring-indigo-500 w-5 h-5"},null,8,at),[[oe,l.category_ids]]),o("span",rt,m(s.name),1)]),l.category_ids.includes(s.id)?(r(),n("div",nt,[a(le,{modelValue:((u=s.tags)==null?void 0:u.map(c=>c.id))||[],"onUpdate:modelValue":c=>W(s,c),initialTags:s.tags||[],label:"Responsibilities",placeholder:"Add responsibilities..."},null,8,["modelValue","onUpdate:modelValue","initialTags"]),e[49]||(e[49]=o("p",{class:"text-[10px] text-gray-500 mt-2 italic"},"Note: Responsibilities are shared across all users in this department.",-1))])):w("",!0)])}),128))])]),o("div",it,[a(p,{for:"edit_timezone",value:"Timezone"}),a(k,{id:"edit_timezone",type:"text",class:"mt-1 block w-full",modelValue:l.timezone,"onUpdate:modelValue":e[21]||(e[21]=s=>l.timezone=s),placeholder:"e.g., Europe/London"},null,8,["modelValue"]),a(h,{message:i.value.timezone?i.value.timezone[0]:"",class:"mt-2"},null,8,["message"])]),o("div",dt,[a(Y,{onClick:e[22]||(e[22]=s=>S.value=!1)},{default:_(()=>e[50]||(e[50]=[b("Cancel",-1)])),_:1,__:[50]}),a(B,{class:"ms-3",type:"submit"},{default:_(()=>e[51]||(e[51]=[b("Update User",-1)])),_:1,__:[51]})])],32)])]),_:1},8,["show"]),a(K,{show:E.value,onClose:e[25]||(e[25]=s=>E.value=!1)},{default:_(()=>{var s;return[o("div",ut,[e[56]||(e[56]=o("h2",{class:"text-lg font-medium text-gray-900"}," Archive this user? ",-1)),e[57]||(e[57]=o("p",{class:"mt-1 text-sm text-gray-600"}," The user will be archived and can be unarchived later. No data will be permanently removed. ",-1)),U.value?(r(),n("div",mt,[e[53]||(e[53]=o("strong",null,"User:",-1)),b(" "+m(U.value.name)+" ("+m(U.value.email)+") - Role: "+m(((s=U.value.role_data)==null?void 0:s.name)||(typeof U.value.role=="string"?U.value.role:"Employee")),1)])):w("",!0),d.value?(r(),n("div",ct,m(d.value),1)):w("",!0),o("div",pt,[a(Y,{onClick:e[24]||(e[24]=u=>E.value=!1)},{default:_(()=>e[54]||(e[54]=[b("Cancel",-1)])),_:1,__:[54]}),a(Pe,{class:"ms-3",onClick:we},{default:_(()=>e[55]||(e[55]=[b("Archive User",-1)])),_:1,__:[55]})])])]}),_:1},8,["show"])]),_:1})],64))}};export{Tt as default};
