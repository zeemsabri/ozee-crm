import{c as a,o as l,a as o,r as b,l as x,m as N,b as Z,a0 as z,f as E,k as u,n as g,e as j,u as V,t as f,F as _,i as C,s as L}from"./app-D6UmWjSc.js";import{r as I}from"./ChevronDownIcon-BOt0WZ1a.js";function O(k,w){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"})])}const q={class:"px-6 pb-4"},P={key:0,class:"text-sm text-gray-500"},R={key:1,class:"space-y-3"},U={class:"flex items-center justify-between"},G={class:"flex items-center gap-2"},J=["title"],K={class:"hidden sm:inline"},Q={class:"text-xs text-gray-500"},T={class:"flex items-center flex-wrap gap-2"},W=["onClick"],X=["onClick"],Y={key:1,class:"relative"},ee={key:0,class:"absolute top-full left-0 mt-1 w-64 bg-white rounded-md shadow-lg border border-gray-200 z-50 max-h-64 overflow-y-auto"},te={class:"py-1"},se=["onClick"],re={key:0,class:"text-blue-600 text-xs"},ae={key:2,class:"text-sm text-gray-500"},ie={__name:"EmailCategoryFilters",props:{selectedCategories:{type:Array,default:()=>[]},filters:{type:Object,required:!0}},emits:["update:selectedCategories"],setup(k,{emit:w}){const r=k,v=w,c=b([]),m=b(!1),p=b(!1),n=b(!1),h=x(()=>c.value.filter(e=>e.has_unread)),S=x(()=>{const e=c.value.filter(s=>!s.has_unread);return e.length===0&&c.value.length===0?[]:h.value.length===0?e.sort((s,i)=>s.name.localeCompare(i.name)).slice(0,Math.min(5,e.length)):e.sort((s,i)=>s.name.localeCompare(i.name))}),A=x(()=>h.value.length===0?c.value.filter(s=>!s.has_unread).sort((s,i)=>s.name.localeCompare(i.name)).slice(5):S.value),$=x(()=>A.value.length>0),D=async()=>{m.value=!0;try{const e=new URLSearchParams;r.filters.type&&e.append("type",r.filters.type),r.filters.status&&e.append("status",r.filters.status),r.filters.startDate&&e.append("start_date",r.filters.startDate),r.filters.endDate&&e.append("end_date",r.filters.endDate),r.filters.search&&e.append("search",r.filters.search),r.filters.projectId&&e.append("project_id",r.filters.projectId),r.filters.senderId&&e.append("sender_id",r.filters.senderId);const s=await L.get(`/api/inbox/category-stats?${e.toString()}`);c.value=s.data.categories}catch(e){console.error("Failed to fetch category stats:",e),c.value=[]}finally{m.value=!1}},y=e=>{const s=[...r.selectedCategories],i=s.indexOf(e);n.value?(i>-1?s.splice(i,1):s.push(e),v("update:selectedCategories",s)):i>-1?v("update:selectedCategories",[]):v("update:selectedCategories",[e])},B=()=>{n.value=!n.value,!n.value&&r.selectedCategories.length>1&&v("update:selectedCategories",[r.selectedCategories[0]])},F=()=>{v("update:selectedCategories",[])},d=e=>r.selectedCategories.includes(e),H=e=>{y(e),p.value=!1};return N(()=>r.filters,D,{deep:!0}),Z(()=>{D()}),(e,s)=>{const i=z("permission");return E((l(),a("div",q,[m.value?(l(),a("div",P," Loading categories... ")):c.value.length>0?(l(),a("div",R,[o("div",U,[o("div",G,[o("button",{onClick:B,class:g({"px-3 py-1.5 rounded-md text-sm font-medium transition-colors flex items-center space-x-1":!0,"bg-blue-600 text-white hover:bg-blue-700":n.value,"bg-gray-100 text-gray-700 hover:bg-gray-200":!n.value}),title:n.value?"Switch to single selection":"Enable multiple selection"},[j(V(O),{class:"h-4 w-4"}),o("span",K,f(n.value?"Multi-Select":"Single-Select"),1)],10,J),o("span",Q,f(n.value?"Click multiple categories to combine filters":"Click a category to filter, click again to clear"),1)]),r.selectedCategories.length>0?(l(),a("button",{key:0,onClick:F,class:"px-3 py-1.5 rounded-md text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors"}," Clear All ")):u("",!0)]),o("div",T,[(l(!0),a(_,null,C(h.value,t=>(l(),a("button",{key:t.id,onClick:M=>y(t.id),class:g({"px-3 py-1.5 rounded-full text-sm font-medium transition-colors flex items-center space-x-1 border-2":!0,"bg-blue-600 text-white hover:bg-blue-700 border-blue-600":d(t.id),"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200 hover:border-gray-300":!d(t.id)})},[o("span",null,f(t.name),1),t.unread_count>0?(l(),a("span",{key:0,class:g({"ml-1 px-1.5 py-0.5 text-xs font-semibold rounded-full":!0,"bg-white text-blue-600":d(t.id),"bg-blue-600 text-white":!d(t.id)})},f(t.unread_count),3)):u("",!0)],10,W))),128)),h.value.length===0?(l(!0),a(_,{key:0},C(S.value.slice(0,5),t=>(l(),a("button",{key:t.id,onClick:M=>y(t.id),class:g({"px-3 py-1.5 rounded-full text-sm font-medium transition-colors border-2":!0,"bg-blue-600 text-white hover:bg-blue-700 border-blue-600":d(t.id),"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200 hover:border-gray-300":!d(t.id)})},[o("span",null,f(t.name),1)],10,X))),128)):u("",!0),$.value?(l(),a("div",Y,[o("button",{onClick:s[0]||(s[0]=t=>p.value=!p.value),class:"px-3 py-1.5 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors flex items-center space-x-1"},[s[2]||(s[2]=o("span",null,"More Categories",-1)),j(V(I),{class:g({"h-4 w-4 transform transition-transform duration-200":!0,"rotate-180":p.value})},null,8,["class"])]),p.value?(l(),a("div",ee,[o("div",te,[(l(!0),a(_,null,C(A.value,t=>(l(),a("button",{key:t.id,onClick:M=>H(t.id),class:g({"w-full text-left px-4 py-2 text-sm transition-colors flex items-center justify-between":!0,"bg-blue-50 text-blue-700":d(t.id),"text-gray-700 hover:bg-gray-50":!d(t.id)})},[o("span",null,f(t.name),1),d(t.id)?(l(),a("span",re," âœ“ ")):u("",!0)],10,se))),128))])])):u("",!0)])):u("",!0),p.value?(l(),a("div",{key:2,onClick:s[1]||(s[1]=t=>p.value=!1),class:"fixed inset-0 z-40"})):u("",!0)])])):m.value?u("",!0):(l(),a("div",ae," No categories available "))])),[[i,"view_all_emails"]])}}};export{ie as default};
