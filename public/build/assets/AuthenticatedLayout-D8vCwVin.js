import{r as D,c as B,Q as Te,f as ye,R as Ee,a as i,i as y,o as s,F as H,l as K,b as t,t as I,u as j,S as Ke,T as mt,U as Ye,V as Je,j as N,e as G,g as M,w as _,v as je,x as Z,A as vt,m as S,d as f,z as ie,p as q,W as Ie,O as pt,n as fe,L as le,K as se,D as Q,E as Pe,G as Ae,k as gt,X as Ze,Y as ft,Z as Fe,H as ce,B as ne,_ as Ge,$ as Ue,q as Be,a0 as me,a1 as te,a2 as ue,a3 as Ne,a4 as yt,a5 as ht,a6 as Oe,C as bt}from"./app-3py7x8f1.js";import{P as X}from"./PrimaryButton-CRiK8rbu.js";import{_ as Le}from"./Modal-9WYwIiGU.js";import{_ as F}from"./InputLabel-Cnai-htk.js";import{_ as J}from"./InputError-Dm9zJ05G.js";import{_ as De}from"./SecondaryButton-CQZ-c5NM.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as de}from"./TextInput-c4VObcBL.js";import{S as ae}from"./SelectDropdown-86Cxrjx1.js";import{_ as kt}from"./Checkbox-jTHl9ced.js";import{A as xt}from"./ApplicationLogo-Dkp_J6mJ.js";import{D as Re}from"./DangerButton-BHAUTJIS.js";import{h as wt}from"./moment-BLMuvzoS.js";const _t={key:0,class:"fixed bottom-4 right-4 z-50 flex flex-col items-end space-y-2"},$t={key:0,class:"notification-list w-full max-w-xs space-y-2"},Ct={class:"flex-1 min-w-0"},St={class:"flex items-start justify-between gap-2 mb-1"},Tt={class:"flex-1 min-w-0"},Dt={key:0,class:"text-base font-semibold text-gray-800 truncate"},jt={key:1,class:"text-xs text-gray-500"},It={key:0,class:"text-xs text-gray-600 mb-2"},At={class:"flex items-center justify-between mt-2"},Mt={key:0,class:"text-xs text-gray-500 font-medium"},Pt=["onClick"],Et={key:1,class:"flex justify-end w-full max-w-xs"},Vt={key:0},Nt={key:1},ge="notification_minimized_state",Ut=3,Bt={__name:"PushNotificationContainer",props:{sidebarIsOpen:{type:Boolean,default:!1}},setup(a){const l=D(!1),d=D(null),c=D(0),e=D(null),g=B(()=>Te.value.notifications.filter(p=>p.isNewPush).slice(0,Ut)),u=B(()=>{const p=Math.floor(c.value/60),w=c.value%60;return`${String(p).padStart(2,"0")}:${String(w).padStart(2,"0")}`}),m=p=>{if(!p)return null;const w=p.match(/\/task\/(\d+)/);return w?parseInt(w[1]):null},v=p=>{if(!p)return null;const w=p.match(/\/project\/(\d+)\//);return w?parseInt(w[1]):null},n=()=>{if(l.value=!l.value,clearTimeout(d.value),clearInterval(e.value),l.value){const p=Date.now()+3e5;localStorage.setItem(ge,JSON.stringify({isMinimized:!0,expiryTime:p})),d.value=setTimeout(()=>{l.value=!1,clearInterval(e.value),localStorage.removeItem(ge)},3e5),c.value=300,e.value=setInterval(()=>{c.value>0?c.value--:clearInterval(e.value)},1e3)}else localStorage.removeItem(ge)},k=async p=>{mt(p.id),await Ye(p.view_id);const w=p.task_id||m(p.url),A=p.project_id||v(p.url);w&&A?Je(w,A):(console.warn("Could not open task sidebar. Falling back to redirecting."),p.url&&(window.location.href=p.url))};return ye(()=>{const p=localStorage.getItem(ge);if(p)try{const{isMinimized:w,expiryTime:A}=JSON.parse(p),T=Date.now(),b=A-T;b>0?(l.value=w,c.value=Math.floor(b/1e3),d.value=setTimeout(()=>{l.value=!1,clearInterval(e.value),localStorage.removeItem(ge)},b),e.value=setInterval(()=>{c.value>0?c.value--:clearInterval(e.value)},1e3)):localStorage.removeItem(ge)}catch(w){console.error("Error restoring notification minimized state:",w),localStorage.removeItem(ge)}}),Ee(()=>{clearTimeout(d.value),clearInterval(e.value)}),(p,w)=>a.sidebarIsOpen?y("",!0):(s(),i("div",_t,[!l.value&&g.value.length>0?(s(),i("div",$t,[(s(!0),i(H,null,K(g.value,A=>(s(),i("div",{key:A.id,class:"bg-white rounded-lg shadow-lg p-3 flex items-start space-x-3 border border-gray-200 transition-opacity duration-300 opacity-60 hover:opacity-100"},[t("div",Ct,[t("div",St,[t("div",Tt,[A.title?(s(),i("h3",Dt,I(A.title),1)):y("",!0),A.project_name?(s(),i("p",jt,I(A.project_name),1)):y("",!0)])]),A.message?(s(),i("p",It,I(A.message),1)):y("",!0),t("div",At,[A.due_date?(s(),i("div",Mt," Due: "+I(j(Ke)(A.due_date)),1)):y("",!0),t("button",{onClick:T=>k(A),class:"px-2.5 py-1 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 transition-colors duration-200 shadow"},I(A.button_label||"View"),9,Pt)])])]))),128))])):y("",!0),g.value.length>0?(s(),i("div",Et,[t("button",{onClick:n,class:"bg-white/80 backdrop-blur-sm text-gray-600 hover:text-gray-900 text-xs font-bold py-1 px-3 rounded-full shadow-md transition-all duration-300"},[l.value?(s(),i("span",Vt,"Show ("+I(u.value)+")",1)):(s(),i("span",Nt,"Minimize"))])])):y("",!0)]))}},Lt={class:"fixed top-4 right-4 z-[9999] flex flex-col items-end space-y-3"},Rt={class:"p-4"},zt={class:"text-sm font-medium text-white"},Ft={key:0,class:"mt-3 flex gap-2"},Ot=["onClick"],Wt=["onClick"],qt={__name:"StandardNotificationContainer",setup(a,{expose:l}){const d=D([]),c=(v,n="info",k=5e3)=>{let p;typeof v=="object"&&v!==null?p={...v}:p={message:v,type:n,duration:k};const w=p.id||crypto.randomUUID(),A={id:w,message:p.message||"",type:p.type||"info",duration:typeof p.duration=="number"?p.duration:5e3,sticky:!!p.sticky,confirm:p.confirm||null};return d.value.unshift(A),!A.sticky&&!A.confirm&&setTimeout(()=>{e(w)},A.duration),w},e=v=>{const n=d.value.findIndex(k=>k.id===v);n>-1&&d.value.splice(n,1)},g=v=>{const n=d.value.find(k=>k.id===v);if(n&&n.confirm&&typeof n.confirm.onConfirm=="function")try{n.confirm.onConfirm()}catch{}e(v)},u=v=>{const n=d.value.find(k=>k.id===v);if(n&&n.confirm&&typeof n.confirm.onCancel=="function")try{n.confirm.onCancel()}catch{}e(v)},m=v=>{switch(v){case"success":return"bg-green-500";case"error":return"bg-red-500";case"warning":return"bg-yellow-500";case"info":default:return"bg-blue-500"}};return l({addNotification:c}),(v,n)=>(s(),i("div",Lt,[(s(!0),i(H,null,K(d.value,k=>(s(),i("div",{key:k.id,class:N(["w-full max-w-sm rounded-md shadow-lg pointer-events-auto overflow-hidden",m(k.type)])},[t("div",Rt,[t("p",zt,I(k.message),1),k.confirm?(s(),i("div",Ft,[t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-white/90 text-slate-800 hover:bg-white",onClick:p=>g(k.id)},I(k.confirm.confirmText||"Confirm"),9,Ot),t("button",{class:"px-3 py-1 text-sm font-semibold rounded bg-transparent border border-white/70 text-white hover:bg-white/10",onClick:p=>u(k.id)},I(k.confirm.cancelText||"Cancel"),9,Wt)])):y("",!0)])],2))),128))]))}},Ht={class:"p-6"},Kt={class:"mt-6"},Yt={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},Jt={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Zt={class:"flex items-center mb-3"},Gt=["id","onUpdate:modelValue"],Qt=["for"],Xt={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},es={key:0},ts={class:"mb-4"},ss={class:"flex items-center"},as=["id","checked","onChange"],os=["for"],ls={key:0,class:"mb-4"},rs=["id","onUpdate:modelValue"],ns={key:1,class:"mb-4"},is={class:"flex-1"},ds=["id","onUpdate:modelValue"],us={class:"flex-1"},cs=["id","onUpdate:modelValue"],ms={key:0,class:"flex items-end pb-1"},vs=["onClick"],ps=["onClick"],gs={class:"mt-6 flex justify-end space-x-3"},fs={key:0,class:"flex items-center"},ys={key:1},hs={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(a,{emit:l}){const d=()=>{const P=localStorage.getItem("authToken");P&&!q.defaults.headers.common.Authorization&&(q.defaults.headers.common.Authorization=`Bearer ${P}`,console.log("Auth headers set in AvailabilityModal"))},c=a,e=l,g=D({}),u=D({}),m=D(!1),v=D(""),n=()=>{const P=[],h=new Date,o=new Date(h);o.setDate(h.getDate()+1);for(let r=0;r<7;r++){const x=new Date(o);x.setDate(o.getDate()+r);const C=x.toISOString().split("T")[0];P.push({value:C,label:x.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),g.value[C]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return P},k=D([]);ye(()=>{d(),c.nextWeekDates.length>0?(k.value=c.nextWeekDates,c.nextWeekDates.forEach(P=>{g.value[P.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):k.value=n()});const p=async()=>{try{if(d(),k.value.length===0)return;const P=k.value[0].value,h=k.value[k.value.length-1].value,o=await q.get("/api/availabilities",{params:{start_date:P,end_date:h,user_id:c.userId}});if(o.data&&o.data.availabilities){const r=o.data.availabilities;k.value.forEach(x=>{g.value[x.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),r.forEach(x=>{const C=x.date.split("T")[0];g.value[C]&&(g.value[C].isSelected=!0,g.value[C].isAvailable=x.is_available,x.is_available?g.value[C].timeSlots=x.time_slots&&x.time_slots.length>0?[...x.time_slots]:[{start_time:"",end_time:""}]:g.value[C].reason=x.reason||"")})}}catch(P){console.error("Error fetching existing availabilities:",P),k.value.forEach(h=>{g.value[h.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};G(()=>c.show,async P=>{P&&(u.value={},v.value="",await p())},{immediate:!0});const w=P=>{g.value[P].timeSlots.push({start_time:"",end_time:""})},A=(P,h)=>{g.value[P].timeSlots.length>1&&g.value[P].timeSlots.splice(h,1)},T=(P,h)=>{g.value[P].isAvailable=h,h?g.value[P].reason="":g.value[P].timeSlots=[{start_time:"",end_time:""}]},b=async()=>{m.value=!0,u.value={},v.value="";const P=[];let h=!1;for(const o of k.value){const r=o.value,x=g.value[r];if(x.isSelected){let C={};if(x.isAvailable)if(x.timeSlots.some(E=>!E.start_time||!E.end_time))C.timeSlots="Please fill in all time slots.",h=!0;else for(const E of x.timeSlots){const L=E.start_time.split(":").map(Number),re=E.end_time.split(":").map(Number);if(L.length!==2||re.length!==2||isNaN(L[0])||isNaN(L[1])||isNaN(re[0])||isNaN(re[1])){C.timeSlots="Invalid time format. Please use HH:MM format.",h=!0;break}const W=L[0]*60+L[1],U=re[0]*60+re[1];if(W>=U){C.timeSlots="End time must be after start time.",h=!0;break}}else x.reason.trim()||(C.reason="Please provide a reason for unavailability.",h=!0);Object.keys(C).length>0&&(u.value[r]=C),Object.keys(C).length===0&&P.push({date:r,is_available:x.isAvailable,reason:x.isAvailable?null:x.reason,time_slots:x.isAvailable?x.timeSlots:null})}}if(h){m.value=!1,u.value.general="Please correct the errors in the highlighted dates.";return}if(P.length===0){u.value.general="Please select at least one day to set availability for.",m.value=!1;return}try{d();const o=await q.post("/api/availabilities/batch",{availabilities:P});v.value="Availability saved successfully!";try{const r=await q.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",r.data.should_block_user),localStorage.setItem("allWeekdaysCovered",r.data.all_weekdays_covered);const x=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:r.data.should_block_user,allWeekdaysCovered:r.data.all_weekdays_covered}});window.dispatchEvent(x),console.log("Availability status updated from modal:",{shouldBlockUser:r.data.should_block_user,allWeekdaysCovered:r.data.all_weekdays_covered})}catch(r){console.error("Error updating availability status:",r)}e("availability-saved",o.data.availabilities),setTimeout(()=>{e("close")},1500)}catch(o){console.error("Error saving availability:",o),o.response&&o.response.data&&o.response.data.errors?u.value.general=o.response.data.message||"An error occurred while saving your availability.":o.response&&o.response.status===409?(v.value=o.response.data.message,setTimeout(()=>{e("close")},1500)):u.value.general="An unexpected error occurred while saving your availability."}finally{m.value=!1}};return(P,h)=>(s(),M(Le,{show:a.show,onClose:h[1]||(h[1]=o=>P.$emit("close")),"max-width":"xl"},{default:_(()=>[t("div",Ht,[h[6]||(h[6]=t("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),h[7]||(h[7]=t("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),t("div",Kt,[t("form",{onSubmit:je(b,["prevent"])},[v.value?(s(),i("div",Yt,I(v.value),1)):y("",!0),u.value.general?(s(),i("div",Jt,I(u.value.general),1)):y("",!0),(s(!0),i(H,null,K(k.value,o=>{var r,x;return s(),i("div",{key:o.value,class:N(["mb-6 p-4 border rounded-lg shadow-sm",[g.value[o.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",g.value[o.value].isSelected&&!u.value[o.value]?"border-l-4 border-l-indigo-500":""]])},[t("div",Zt,[Z(t("input",{type:"checkbox",id:`select_date_${o.value}`,"onUpdate:modelValue":C=>g.value[o.value].isSelected=C,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,Gt),[[vt,g.value[o.value].isSelected]]),t("label",{for:`select_date_${o.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[S(I(o.label)+" ",1),g.value[o.value].isSelected?(s(),i("span",Xt," Saved ")):y("",!0)],8,Qt)]),g.value[o.value].isSelected?(s(),i("div",es,[t("div",ts,[t("div",ss,[t("input",{type:"checkbox",id:`isAvailableToggle_${o.value}`,checked:g.value[o.value].isAvailable,onChange:C=>T(o.value,C.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,as),t("label",{for:`isAvailableToggle_${o.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,os)])]),g.value[o.value].isAvailable?y("",!0):(s(),i("div",ls,[f(F,{for:`reason_${o.value}`,value:"Reason for Not Available"},null,8,["for"]),Z(t("textarea",{id:`reason_${o.value}`,"onUpdate:modelValue":C=>g.value[o.value].reason=C,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,rs),[[ie,g.value[o.value].reason]]),f(J,{message:(r=u.value[o.value])==null?void 0:r.reason,class:"mt-2"},null,8,["message"])])),g.value[o.value].isAvailable?(s(),i("div",ns,[f(F,{value:"Available Time Slots"}),f(J,{message:(x=u.value[o.value])==null?void 0:x.timeSlots,class:"mt-2"},null,8,["message"]),(s(!0),i(H,null,K(g.value[o.value].timeSlots,(C,E)=>(s(),i("div",{key:E,class:"flex items-center space-x-2 mt-2"},[t("div",is,[f(F,{for:`start_time_${o.value}_${E}`,value:"Start Time",class:"text-xs"},null,8,["for"]),Z(t("input",{id:`start_time_${o.value}_${E}`,type:"time","onUpdate:modelValue":L=>C.start_time=L,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,ds),[[ie,C.start_time]])]),t("div",us,[f(F,{for:`end_time_${o.value}_${E}`,value:"End Time",class:"text-xs"},null,8,["for"]),Z(t("input",{id:`end_time_${o.value}_${E}`,type:"time","onUpdate:modelValue":L=>C.end_time=L,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,cs),[[ie,C.end_time]])]),g.value[o.value].timeSlots.length>1?(s(),i("div",ms,[t("button",{type:"button",onClick:L=>A(o.value,E),class:"p-2 text-red-600 hover:text-red-800"},h[2]||(h[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,vs)])):y("",!0)]))),128)),t("button",{type:"button",onClick:C=>w(o.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},h[3]||(h[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),S(" Add Another Time Slot ",-1)]),8,ps)])):y("",!0)])):y("",!0)],2)}),128)),t("div",gs,[f(De,{onClick:h[0]||(h[0]=o=>P.$emit("close"))},{default:_(()=>h[4]||(h[4]=[S(" Cancel ",-1)])),_:1,__:[4]}),f(X,{disabled:m.value,class:N({"opacity-50":m.value})},{default:_(()=>[m.value?(s(),i("span",fs,h[5]||(h[5]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),S(" Saving... ",-1)]))):(s(),i("span",ys,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},bs={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},ks={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},xs={class:"flex justify-center"},ws={__name:"AvailabilityBlocker",setup(a){const l=D(!1),d=D(!0),c=D(!1),e=D([]),g=B(()=>{var b;return((b=Ie().props.auth.user)==null?void 0:b.id)||null}),u=()=>{const b=localStorage.getItem("authToken");b&&!q.defaults.headers.common.Authorization&&(q.defaults.headers.common.Authorization=`Bearer ${b}`)},m=async()=>{d.value=!0;const b=localStorage.getItem("shouldBlockUser"),P=localStorage.getItem("allWeekdaysCovered");if(b==="true"&&P==="false")l.value=!0,await v();else try{u();const h=await q.get("/api/availability-prompt");l.value=h.data.should_block_user&&!h.data.all_weekdays_covered,l.value&&await v()}catch(h){console.error("Error checking if user should be blocked:",h),l.value=!1}d.value=!1},v=async()=>{try{u();const b=await q.get("/api/availability-prompt");n(b.data.next_week_start,b.data.next_week_end)}catch(b){console.error("Error fetching next week dates:",b)}},n=(b,P)=>{const h=[],o=new Date(b),r=new Date(P),x=new Date(o);for(;x<=r;)h.push({value:x.toISOString().split("T")[0],label:x.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),x.setDate(x.getDate()+1);e.value=h},k=()=>{c.value=!0},p=()=>{m()},w=b=>{l.value=b.detail.shouldBlockUser&&!b.detail.allWeekdaysCovered},A=()=>{document.visibilityState==="visible"&&fe(()=>{m()})},T=b=>{(b.key==="shouldBlockUser"||b.key==="allWeekdaysCovered")&&fe(()=>{m()})};return ye(()=>{m(),window.addEventListener("availability-status-updated",w),document.addEventListener("visibilitychange",A),window.addEventListener("storage",T)}),Ee(()=>{window.removeEventListener("availability-status-updated",w),document.removeEventListener("visibilitychange",A),window.removeEventListener("storage",T)}),(b,P)=>l.value&&!d.value?(s(),i("div",bs,[t("div",ks,[P[2]||(P[2]=pt('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),t("div",xs,[f(X,{onClick:k,class:"bg-red-600 hover:bg-red-700"},{default:_(()=>P[1]||(P[1]=[S(" Submit Availability Now ",-1)])),_:1,__:[1]})]),f(hs,{show:c.value,"next-week-dates":e.value,date:e.value.length>0?e.value[0].value:"",userId:g.value,onClose:P[0]||(P[0]=h=>c.value=!1),onAvailabilitySaved:p},null,8,["show","next-week-dates","date","userId"])])])):y("",!0)}},_s={class:"p-6"},$s={class:"flex justify-between items-center mb-4"},Cs={class:"text-lg font-medium text-gray-900"},Ss={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Ts={class:"block sm:inline"},Ds={key:0,class:"mt-6 flex justify-end space-x-3"},js={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:a=>["post","put","patch","delete"].includes(a.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:a=>a},beforeSubmit:{type:Function,default:()=>!0},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(a,{emit:l}){const d=a,c=l,e=D(!1),g=D({}),u=D("");G(()=>d.show,n=>{n&&(g.value={},u.value="",e.value=!1)});const m=async()=>{var n;e.value=!0,g.value={},u.value="";try{if(await d.beforeSubmit()===!1){e.value=!1;return}const p=d.formatDataForApi(d.formData);let w;const A=d.httpMethod.toLowerCase();if(A==="post")w=await window.axios.post(d.apiEndpoint,p);else if(A==="put")w=await window.axios.put(d.apiEndpoint,p);else if(A==="patch")w=await window.axios.patch(d.apiEndpoint,p);else if(A==="delete")w=await window.axios.delete(d.apiEndpoint,{data:p});else throw new Error(`Unsupported HTTP method: ${d.httpMethod}`);se(d.successMessage),c("submitted",w.data),c("close")}catch(k){console.error("API submission error:",k);let p="An unexpected error occurred.";k.response?k.response.status===422?(g.value=k.response.data.errors||{},p=k.response.data.message||"Please correct the errors in the form."):(p=k.response.data.message||"An unexpected error occurred.",u.value=p):(p="A network error occurred or the server is unreachable.",u.value=p),Object.keys(g.value).length>0?u.value="Please correct the errors in the form.":((n=k.response)==null?void 0:n.status)!==422&&(u.value=p),Q(p),c("error",k)}finally{e.value=!1}},v=()=>{c("close")};return(n,k)=>(s(),M(Le,{show:a.show,onClose:v},{default:_(()=>[t("div",_s,[t("div",$s,[t("h2",Cs,I(a.title),1),t("button",{onClick:v,class:"text-gray-400 hover:text-gray-500"},k[0]||(k[0]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u.value?(s(),i("div",Ss,[t("span",Ts,I(u.value),1)])):y("",!0),t("form",{onSubmit:je(m,["prevent"])},[le(n.$slots,"default",{errors:g.value},void 0,!0),a.showFooter?(s(),i("div",Ds,[f(De,{onClick:v,type:"button",disabled:e.value},{default:_(()=>k[1]||(k[1]=[S(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),f(X,{type:"submit",disabled:e.value,class:N({"opacity-75 cursor-not-allowed":e.value})},{default:_(()=>[S(I(e.value?"Submitting...":a.submitButtonText),1)]),_:1},8,["disabled","class"])])):y("",!0)],32)])]),_:3},8,["show"]))}},Me=be(js,[["__scopeId","data-v-5ed3c88d"]]),Is=(a,l)=>{let d;return(...c)=>{clearTimeout(d),d=setTimeout(()=>a(...c),l)}},As={class:"relative"},Ms={class:"flex flex-wrap items-center gap-2 mb-2 p-2 border border-gray-300 rounded-lg bg-white min-h-[44px] focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 transition-all duration-150"},Ps=["onClick"],Es={key:0,class:"absolute z-20 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto mt-1 transform-gpu"},Vs=["onClick"],Ns={key:1,class:"px-4 py-2 text-sm text-gray-500"},Us={key:2,class:"px-4 py-2 text-sm text-gray-500"},Bs={__name:"TagInput",props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:"Tags"},placeholder:{type:String,default:"Add tags..."},error:{type:String,default:""},initialTags:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(a,{emit:l}){const d=a,c=l,e=D(""),g=D([]),u=D([]),m=D(!1),v=D(null);function n(){c("update:modelValue",u.value.map(h=>h.id))}G(()=>d.initialTags,h=>{if(u.value=[],h&&h.length>0){const C=[],E=new Set;h.forEach(L=>{E.has(L.id)||(C.push(L),E.add(L.id))}),u.value.push(...C)}const o=h.map(C=>C.id),r=Array.isArray(d.modelValue)?d.modelValue:[];(o.length!==r.length||o.some(C=>!r.includes(C))||r.some(C=>!o.includes(C)))&&n()},{immediate:!0});const k=Is(async h=>{if(h.length<2){g.value=[],m.value=!1;return}try{const o=await q.get(`/api/tags/search?query=${h}`);g.value=o.data,m.value=!0}catch(o){console.error("Error fetching tags:",o),g.value=[],m.value=!1}},300);G(e,h=>{d.disabled||k(h)});const p=h=>{u.value.some(o=>o.id===h.id)||(u.value.push(h),e.value="",g.value=[],m.value=!1,n()),fe(()=>v.value.focus())},w=()=>{if(d.disabled)return;const h=e.value.trim();if(!h)return;const o=g.value.find(x=>x.name.toLowerCase()===h.toLowerCase()),r=u.value.some(x=>x.name.toLowerCase()===h.toLowerCase());if(o)p(o);else if(r)e.value="",g.value=[],m.value=!1;else{const x={id:`new_${h.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:h};u.value.push(x),e.value="",g.value=[],m.value=!1,n()}fe(()=>v.value.focus())},A=h=>{d.disabled||(u.value=u.value.filter(o=>o.id!==h.id),n(),fe(()=>v.value.focus()))},T=()=>{d.disabled||e.value===""&&u.value.length>0&&A(u.value[u.value.length-1])},b=B(()=>g.value.filter(h=>!u.value.some(o=>o.id===h.id))),P=h=>{v.value&&!v.value.$el.contains(h.target)&&(m.value=!1,e.value="")};return ye(()=>{document.addEventListener("click",P)}),Ee(()=>{document.removeEventListener("click",P)}),(h,o)=>(s(),i("div",As,[f(F,{value:a.label,class:"mb-1"},null,8,["value"]),t("div",Ms,[(s(!0),i(H,null,K(u.value,r=>(s(),i("span",{key:r.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},[S(I(r.name)+" ",1),a.disabled?y("",!0):(s(),i("button",{key:0,type:"button",onClick:x=>A(r),class:"ml-2 -mr-1 text-indigo-500 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-full p-0.5"},o[3]||(o[3]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ps))]))),128)),f(de,{ref_key:"inputRef",ref:v,type:"text",placeholder:u.value.length===0?a.placeholder:"",modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=r=>e.value=r),onFocus:o[1]||(o[1]=r=>m.value=!0),onKeydown:[Pe(je(w,["prevent"]),["enter"]),o[2]||(o[2]=Pe(r=>m.value=!1,["tab"])),Pe(T,["delete"])],class:"flex-grow min-w-[100px] border-none focus:ring-0 shadow-none p-0 bg-transparent text-gray-900",disabled:a.disabled},null,8,["placeholder","modelValue","onKeydown","disabled"])]),m.value&&(b.value.length>0||e.value.length>=2||b.value.length===0&&e.value.length<2)&&!a.disabled?(s(),i("div",Es,[(s(!0),i(H,null,K(b.value,r=>(s(),i("div",{key:r.id,onClick:x=>p(r),class:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer transition-colors duration-100"},I(r.name),9,Vs))),128)),!g.value.some(r=>r.name.toLowerCase()===e.value.toLowerCase())&&e.value.length>=2?(s(),i("div",{key:0,onClick:w,class:"px-4 py-2 text-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 cursor-pointer border-t border-indigo-200 font-semibold transition-colors duration-100"},' Add new tag: "'+I(e.value)+'" ',1)):y("",!0),b.value.length===0&&e.value.length<2?(s(),i("div",Ns," Type at least 2 characters to search for tags. ")):y("",!0),b.value.length===0&&e.value.length>=2&&!g.value.some(r=>r.name.toLowerCase()===e.value.toLowerCase())?(s(),i("div",Us,[o[4]||(o[4]=S(" No matching tags found. Press ",-1)),o[5]||(o[5]=t("span",{class:"font-semibold text-indigo-600"},"Enter",-1)),S(' to add "'+I(e.value)+'" as a new tag. ',1)])):y("",!0)])):y("",!0),f(J,{message:a.error,class:"mt-2"},null,8,["message"])]))}},Qe=be(Bs,[["__scopeId","data-v-4d528a4c"]]),Ls={class:"space-y-4"},Rs={key:1,id:"final-task-list",class:"space-y-3"},zs={class:"flex items-center justify-between"},Fs={class:"text-sm font-semibold text-gray-800 truncate"},Os=["onClick"],Ws={class:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 text-xs text-gray-500 mt-2"},qs={class:"flex items-center space-x-2"},Hs=["onClick"],Ks=["onClick"],Ys=["value","onChange","min","max"],Js={class:"flex items-center space-x-2"},Zs=["onClick"],Gs=["onClick"],Qs=["onClick"],Xs={__name:"MilestoneFormModal",props:{show:{type:Boolean,default:!1},contractId:{type:Number,required:!0},completionDate:{type:String,required:!1,default:null}},emits:["close","tasks-submitted"],setup(a,{emit:l}){const d=a,c=l,e=Ae([]),g=D(""),u=D({show:!1,text:"",type:"success"}),m=new Date,v=new Date(m);v.setDate(m.getDate()+1);const n=D("");G(()=>d.show,o=>{o||(e.splice(0,e.length),g.value="",n.value="",u.value={show:!1,text:"",type:"success"})});const k=()=>{n.value&&n.value.trim()!==""&&(e.push({name:n.value,dueDate:"",priority:"Medium",contract_id:d.contractId}),n.value="",u.value.show=!1)},p=o=>{e.splice(o,1)},w=(o,r)=>{e[o].priority=r},A=(o,r)=>{const x=new Date(m.getFullYear(),m.getMonth(),m.getDate()),C=d.completionDate?new Date(d.completionDate):null,E=new Date(r);if(u.value.show=!1,C&&E>C){u.value={show:!0,text:"The selected due date is after the milestone completion date.",type:"error"},e[o].dueDate="";return}if(E<x){u.value={show:!0,text:"The selected due date cannot be in the past.",type:"error"},e[o].dueDate="";return}e[o].dueDate=r},T=o=>({tasks:o}),b=o=>{e.length>0?(e.filter(x=>!x.dueDate).length>0&&(u.value={show:!0,text:"Some tasks do not have a due date. They will be submitted without one.",type:"error"}),console.log("Submitting tasks to API:",e),u.value={show:!0,text:"Tasks submitted successfully!",type:"success"},setTimeout(()=>{u.value.show=!1,c("tasks-submitted"),o()},1500)):u.value={show:!0,text:"Please add at least one task.",type:"error"}},P=B(()=>e),h=o=>{const r=d.completionDate?new Date(d.completionDate):null,x=new Date(m.getFullYear(),m.getMonth(),m.getDate()),C=new Date(o);return C>=x&&(!r||C<=r)};return(o,r)=>(s(),M(Me,{show:a.show,title:"Create Tasks in Bulk","api-endpoint":"/api/tasks/bulk","http-method":"post","form-data":P.value,"format-data-for-api":T,onClose:r[1]||(r[1]=x=>o.$emit("close")),onSubmitted:b},{default:_(({errors:x})=>[t("div",Ls,[u.value.show?(s(),i("div",{key:0,class:N(["mb-4 p-4 rounded-lg transition-all duration-300 ease-in-out",{"bg-green-100 text-green-700 border border-green-200":u.value.type==="success","bg-red-100 text-red-700 border border-red-200":u.value.type==="error"}])},I(u.value.text),3)):y("",!0),t("form",{onSubmit:je(k,["prevent"]),class:"relative"},[f(de,{modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=C=>n.value=C),id:"task-name-input",placeholder:"e.g., 'Finish project report'",class:"w-full p-4 pr-12 text-lg border border-gray-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 shadow-sm transition-all duration-200 ease-in-out"},null,8,["modelValue"]),r[2]||(r[2]=t("button",{type:"submit",class:"absolute right-4 top-1/2 -translate-y-1/2 p-2 text-indigo-600 hover:text-indigo-800"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})])],-1))],32),r[7]||(r[7]=t("hr",{class:"my-6 border-gray-200"},null,-1)),e.length>0?(s(),i("div",Rs,[r[6]||(r[6]=t("h2",{class:"text-lg font-semibold text-gray-800"},"Tasks to Create:",-1)),(s(!0),i(H,null,K(e,(C,E)=>(s(),i("div",{key:E,class:"flex flex-col p-4 bg-gray-50 rounded-xl border border-gray-200 group transition-all duration-200 ease-in-out"},[t("div",zs,[t("p",Fs,I(C.name),1),t("button",{type:"button",onClick:L=>p(E),class:"remove-final-task ml-4 p-1 rounded-full text-red-500 opacity-0 group-hover:opacity-100 transition-all duration-200 ease-in-out"},r[3]||(r[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Os)]),t("div",Ws,[t("div",qs,[r[4]||(r[4]=t("span",{class:"font-medium"},"Due:",-1)),h(j(m).toISOString().split("T")[0])?(s(),i("button",{key:0,type:"button",onClick:L=>A(E,j(m).toISOString().split("T")[0]),class:N(["px-2 py-0.5 rounded-full text-indigo-600 bg-indigo-100 text-xs hover:bg-indigo-200",{"bg-indigo-300 font-semibold":C.dueDate===j(m).toISOString().split("T")[0]}])},"Today",10,Hs)):y("",!0),h(j(v).toISOString().split("T")[0])?(s(),i("button",{key:1,type:"button",onClick:L=>A(E,j(v).toISOString().split("T")[0]),class:N(["px-2 py-0.5 rounded-full text-indigo-600 bg-indigo-100 text-xs hover:bg-indigo-200",{"bg-indigo-300 font-semibold":C.dueDate===j(v).toISOString().split("T")[0]}])},"Tomorrow",10,Ks)):y("",!0),t("input",{type:"date",value:C.dueDate,onChange:L=>A(E,L.target.value),min:j(m).toISOString().split("T")[0],max:a.completionDate,class:"p-1 rounded-lg border border-gray-300 text-xs focus:ring-indigo-500 focus:border-indigo-500 shadow-sm transition-all duration-200 ease-in-out"},null,40,Ys)]),t("div",Js,[r[5]||(r[5]=t("span",{class:"font-medium"},"Priority:",-1)),t("button",{type:"button",onClick:L=>w(E,"Low"),class:N(["px-2 py-0.5 rounded-full text-gray-500 bg-gray-100 text-xs hover:bg-gray-200",{"bg-gray-200 font-semibold":C.priority==="Low"}])},"Low",10,Zs),t("button",{type:"button",onClick:L=>w(E,"Medium"),class:N(["px-2 py-0.5 rounded-full text-blue-600 bg-blue-100 text-xs hover:bg-blue-200",{"bg-blue-200 font-semibold":C.priority==="Medium"}])},"Medium",10,Gs),t("button",{type:"button",onClick:L=>w(E,"High"),class:N(["px-2 py-0.5 rounded-full text-red-600 bg-red-100 text-xs hover:bg-red-200",{"bg-red-200 font-semibold":C.priority==="High"}])},"High",10,Qs)])])]))),128))])):y("",!0)])]),_:1},8,["show","form-data"]))}},ea={class:"space-y-4"},ta={key:0},sa={key:0,class:"text-sm text-gray-500"},aa={key:0,class:"text-sm text-gray-500"},oa={key:0,class:"text-sm text-gray-500"},la={class:"flex items-center gap-2 mt-1"},ra={key:0,class:"text-sm text-gray-500"},na=["disabled"],ia="Create New Task",da="/api/tasks",ua="post",ca="Create Task",ma="Task created successfully!",va={__name:"CreateTaskModal",props:{show:Boolean,projectId:{type:Number,default:null}},emits:["close","saved"],setup(a,{emit:l}){const d=a,c=l,e=Ae({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:d.projectId,priority:"medium",tags:[],tags_data:[]}),g=["To Do","In Progress","Done","Blocked","Archived"],u=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],m=D([]),v=D([]),n=D([]),k=D([]),p=D(!0),w=D(!1),A=D(!1),T=D(!1),b=D(!1);G(()=>d.show,async W=>{W&&(Object.assign(e,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:d.projectId,priority:"medium",tags:[],tags_data:[]}),d.projectId?await h(d.projectId):await P())},{immediate:!0}),G(()=>e.project_id,async W=>{W?await h(W):(v.value=[],n.value=[],k.value=[])});const P=async()=>{p.value=!0;try{const W=await window.axios.get("/api/projects-simplified");m.value=W.data.map(U=>({value:U.id,label:U.name}))}catch(W){console.error("Error fetching projects:",W),m.value=[]}finally{p.value=!1}},h=async W=>{if(W){w.value=!0,A.value=!0,T.value=!0;try{const[U,z,O]=await Promise.all([window.axios.get(`/api/projects/${W}/users`),window.axios.get("/api/task-types"),window.axios.get(`/api/projects/${W}/milestones`)]);v.value=U.data.map(oe=>({value:oe.id,label:oe.name})),n.value=z.data.map(oe=>({value:oe.id,label:oe.name})),k.value=O.data.map(oe=>({value:oe.id,label:oe.name}))}catch(U){console.error("Error fetching associated task data:",U),v.value=[],n.value=[],k.value=[]}finally{w.value=!1,A.value=!1,T.value=!1}}},o=W=>{c("saved",W),c("close")},r=()=>{c("close")},x=()=>{e.project_id?b.value=!0:alert("Please select a project before adding a milestone.")},C=W=>{if(b.value=!1,W&&W.id&&W.name){const U={value:W.id,label:W.name};k.value.some(z=>z.value===U.value)||k.value.push(U),e.milestone_id=U.value}},E=B(()=>v.value),L=B(()=>n.value),re=B(()=>k.value);return(W,U)=>(s(),i(H,null,[f(Me,{show:a.show,title:ia,"api-endpoint":da,"http-method":ua,"form-data":e,"submit-button-text":ca,"success-message":ma,onClose:r,onSubmitted:o},{default:_(({errors:z})=>[t("div",ea,[a.projectId?y("",!0):(s(),i("div",ta,[f(F,{for:"task-project",value:"Project"}),p.value?(s(),i("div",sa,"Loading projects...")):(s(),M(ae,{key:1,id:"task-project",modelValue:e.project_id,"onUpdate:modelValue":U[0]||(U[0]=O=>e.project_id=O),options:m.value,"value-key":"value","label-key":"label",placeholder:"Select a project",class:"mt-1",required:!0},null,8,["modelValue","options"])),f(J,{message:z.project_id?z.project_id[0]:"",class:"mt-2"},null,8,["message"])])),t("div",null,[f(F,{for:"task-name",value:"Task Name"}),f(de,{id:"task-name",modelValue:e.name,"onUpdate:modelValue":U[1]||(U[1]=O=>e.name=O),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),f(J,{message:z.name?z.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"task-description",value:"Description"}),Z(t("textarea",{id:"task-description","onUpdate:modelValue":U[2]||(U[2]=O=>e.description=O),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[ie,e.description]]),f(J,{message:z.description?z.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"task-status",value:"Status"}),f(ae,{id:"task-status",modelValue:e.status,"onUpdate:modelValue":U[3]||(U[3]=O=>e.status=O),options:g.map(O=>({value:O,label:O})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),f(J,{message:z.status?z.status[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"task-priority",value:"Priority"}),f(ae,{id:"task-priority",modelValue:e.priority,"onUpdate:modelValue":U[4]||(U[4]=O=>e.priority=O),options:u,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),f(J,{message:z.priority?z.priority[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"task-due-date",value:"Due Date"}),f(de,{id:"task-due-date",modelValue:e.due_date,"onUpdate:modelValue":U[5]||(U[5]=O=>e.due_date=O),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),f(J,{message:z.due_date?z.due_date[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"task-assigned-to",value:"Assigned To"}),w.value?(s(),i("div",aa,"Loading users...")):(s(),M(ae,{key:1,id:"task-assigned-to",modelValue:e.assigned_to_user_id,"onUpdate:modelValue":U[6]||(U[6]=O=>e.assigned_to_user_id=O),options:E.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(J,{message:z.assigned_to_user_id?z.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"task-type",value:"Task Type"}),A.value?(s(),i("div",oa,"Loading task types...")):(s(),M(ae,{key:1,id:"task-type",modelValue:e.task_type_id,"onUpdate:modelValue":U[7]||(U[7]=O=>e.task_type_id=O),options:L.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),f(J,{message:z.task_type_id?z.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"task-milestone",value:"Milestone"}),t("div",la,[T.value?(s(),i("div",ra,"Loading milestones...")):(s(),M(ae,{key:1,id:"task-milestone",modelValue:e.milestone_id,"onUpdate:modelValue":U[8]||(U[8]=O=>e.milestone_id=O),options:re.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"flex-grow","allow-empty":!0,disabled:!e.project_id},null,8,["modelValue","options","disabled"])),t("button",{type:"button",onClick:x,disabled:!e.project_id||T.value,class:"px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Add New Milestone"},U[11]||(U[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1)]),8,na)]),f(J,{message:z.milestone_id?z.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(Qe,{modelValue:e.tags,"onUpdate:modelValue":U[9]||(U[9]=O=>e.tags=O),initialTags:e.tags_data,label:"Tags",placeholder:"Search or add tags",error:z.tags?z.tags[0]:"",disabled:!e.project_id},null,8,["modelValue","initialTags","error","disabled"])])])]),_:1},8,["show","form-data"]),f(Xs,{show:b.value,"project-id":e.project_id,onClose:U[10]||(U[10]=z=>b.value=!1),onSaved:C},null,8,["show","project-id"])],64))}},pa={class:"space-y-4"},ga={class:"flex items-center mt-4"},fa={__name:"CreateForm",props:{show:{type:Boolean,default:!1},apiEndpoint:{type:String,required:!0}},emits:["close","resourceCreated"],setup(a,{emit:l}){const d=a,c=l,e=Ae({title:"",description:"",url:"",type:"website",thumbnail_url:"",visible_to_client:!0,tags:[]}),g=B(()=>[{value:"website",label:"Website"},{value:"youtube",label:"YouTube Video"},{value:"document",label:"Document"},{value:"image",label:"Image"},{value:"other",label:"Other"}]),u=n=>n,m=n=>{c("resourceCreated",n),v()},v=()=>{e.title="",e.description="",e.url="",e.type="website",e.thumbnail_url="",e.visible_to_client=!0,e.tags=[],c("close")};return(n,k)=>(s(),M(Me,{show:d.show,title:"Add New Shareable Resource",apiEndpoint:d.apiEndpoint,httpMethod:"post",formData:e,submitButtonText:"Create Resource",successMessage:"Shareable resource created successfully!",formatDataForApi:u,onSubmitted:m,onClose:v},{default:_(({errors:p})=>[t("div",pa,[t("div",null,[f(F,{for:"title",value:"Title",class:"mb-1"}),f(de,{id:"title",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.title,"onUpdate:modelValue":k[0]||(k[0]=w=>e.title=w),required:""},null,8,["modelValue"]),f(J,{message:p.title?p.title[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"url",value:"Resource URL",class:"mb-1"}),f(de,{id:"url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.url,"onUpdate:modelValue":k[1]||(k[1]=w=>e.url=w),required:""},null,8,["modelValue"]),f(J,{message:p.url?p.url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"type",value:"Resource Type",class:"mb-1"}),f(ae,{id:"type",modelValue:e.type,"onUpdate:modelValue":k[2]||(k[2]=w=>e.type=w),options:g.value,valueKey:"value",labelKey:"label",placeholder:"Select Resource Type",required:"",class:"mt-1 block w-full"},null,8,["modelValue","options"]),f(J,{message:p.type?p.type[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"thumbnail_url",value:"Thumbnail URL (Optional)",class:"mb-1"}),f(de,{id:"thumbnail_url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.thumbnail_url,"onUpdate:modelValue":k[3]||(k[3]=w=>e.thumbnail_url=w)},null,8,["modelValue"]),f(J,{message:p.thumbnail_url?p.thumbnail_url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(F,{for:"description",value:"Description (Optional)",class:"mb-1"}),Z(t("textarea",{id:"description",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm mt-1 block w-full","onUpdate:modelValue":k[4]||(k[4]=w=>e.description=w),rows:"3"},null,512),[[ie,e.description]]),f(J,{message:p.description?p.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[f(Qe,{modelValue:e.tags,"onUpdate:modelValue":k[5]||(k[5]=w=>e.tags=w),label:"Associated Tags",placeholder:"Search or add tags",error:p.tags?p.tags[0]:""},null,8,["modelValue","error"])]),t("div",ga,[f(kt,{id:"visible_to_client",checked:e.visible_to_client,"onUpdate:checked":k[6]||(k[6]=w=>e.visible_to_client=w)},null,8,["checked"]),f(F,{for:"visible_to_client",value:"Visible to Client",class:"ml-2"}),f(J,{message:p.visible_to_client?p.visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","apiEndpoint","formData"]))}},ya=be(fa,[["__scopeId","data-v-3e3a6a9f"]]),ha={key:0,class:"sidebar-wrapper"},ba={class:"fixed inset-0 z-[100] flex pointer-events-none"},ka={class:"flex items-center justify-between p-4 border-b border-gray-200 bg-white rounded-tl-xl sticky top-0 z-20"},xa={class:"text-xl font-semibold text-gray-900"},wa={class:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-gray-300 scrollbar-track-gray-100"},_a={key:1,class:"p-4 border-t border-gray-200 bg-white sticky bottom-0 z-20"},$a={__name:"RightSidebar",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Details"},initialWidth:{type:Number,default:50},minWidth:{type:Number,default:30},maxWidth:{type:Number,default:90}},emits:["close","update:show"],setup(a,{emit:l}){const d=a,c=l,e=D(d.initialWidth),g=D(!1),u=p=>{g.value=!0,document.addEventListener("pointermove",m),document.addEventListener("pointerup",v)},m=p=>{if(!g.value)return;const w=window.innerWidth,T=(w-p.clientX)/w*100,b=Math.max(d.minWidth,Math.min(d.maxWidth,T));e.value=b},v=()=>{g.value=!1,document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",v)};G(()=>d.show,p=>{p?document.body.style.overflow="hidden":document.body.style.overflow=""},{immediate:!0});const n=()=>{c("update:show",!1),c("close")},k=B(()=>window.innerWidth<768);return G(k,p=>{p&&d.show?e.value=100:!p&&d.show&&(e.value=d.initialWidth)},{immediate:!0}),G(()=>d.show,p=>{p&&(k.value?e.value=100:e.value=d.initialWidth)}),(p,w)=>(s(),M(ft,{to:"body"},[f(Ze,{"enter-active-class":"transition ease-out duration-300 transform","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"transition ease-in duration-200 transform","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:_(()=>[a.show?(s(),i("div",ha,[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity z-[99]",onClick:n}),t("div",ba,[t("div",{class:"relative ml-auto h-full bg-white shadow-xl flex flex-col rounded-l-xl pointer-events-auto",style:gt({width:k.value?"100%":`${e.value}vw`})},[k.value?y("",!0):(s(),i("div",{key:0,class:"absolute left-0 top-0 h-full w-2 cursor-col-resize -ml-1 z-10",onPointerdown:u,title:"Drag to resize"},null,32)),t("div",ka,[t("h3",xa,I(a.title),1),t("button",{onClick:n,class:"text-gray-400 hover:text-gray-600 transition-colors"},w[0]||(w[0]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",wa,[le(p.$slots,"content",{},void 0,!0)]),p.$slots.footer?(s(),i("div",_a,[le(p.$slots,"footer",{},void 0,!0)])):y("",!0)],4)])])):y("",!0)]),_:3})]))}},Xe=be($a,[["__scopeId","data-v-2d864577"]]),Ca={class:"flex border-b border-gray-200"},Sa={key:0,class:"ml-2 px-2 py-1 text-xs font-bold bg-red-600 text-white rounded-full"},Ta={class:"p-4 space-y-2 overflow-y-auto"},Da={key:0,class:"p-6 text-center text-gray-500"},ja={key:0},Ia={key:1},Aa=["onClick"],Ma={class:"flex-1 min-w-0"},Pa={class:"flex items-start justify-between gap-2 mb-1"},Ea={class:"flex-1 min-w-0"},Va={key:0,class:"text-base font-semibold text-gray-900 truncate"},Na={key:1,class:"text-xs text-gray-500"},Ua={key:0,class:"text-sm text-gray-600 mt-1 mb-2"},Ba={class:"flex items-center text-xs text-gray-500 font-medium"},La={key:0},Ra={key:1,class:"mx-2"},za={key:2},Fa={__name:"NotificationsSidebar",setup(a){const l=B(()=>Te.value.notifications),d=D("New"),c=B(()=>d.value==="New"?l.value.filter(m=>!m.isRead):l.value),e=async m=>{await Ye(m.view_id);const v=m.task_id||g(m.url),n=m.project_id||u(m.url);v&&n?(Je(v,n),Fe()):(console.warn("Could not open task sidebar. Falling back to opening URL in new tab."),m.url&&window.open(m.url,"_blank"))},g=m=>{const v=m.match(/\/task\/(\d+)/);return v?parseInt(v[1]):null},u=m=>{const v=m.match(/\/project\/(\d+)\//);return v?parseInt(v[1]):null};return(m,v)=>(s(),M(Xe,{show:j(Te).show,"onUpdate:show":j(Fe),title:"Notifications","initial-width":35,class:"z-[100]"},{content:_(()=>[t("div",Ca,[t("button",{onClick:v[0]||(v[0]=n=>d.value="New"),class:N([{"border-blue-600 text-blue-600 font-semibold":d.value==="New","border-transparent text-gray-500 hover:text-gray-700":d.value!=="New"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])},[v[2]||(v[2]=S(" New ",-1)),l.value.filter(n=>!n.isRead).length>0?(s(),i("span",Sa,I(l.value.filter(n=>!n.isRead).length),1)):y("",!0)],2),t("button",{onClick:v[1]||(v[1]=n=>d.value="All"),class:N([{"border-blue-600 text-blue-600 font-semibold":d.value==="All","border-transparent text-gray-500 hover:text-gray-700":d.value!=="All"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])}," All ",2)]),t("div",Ta,[c.value.length===0?(s(),i("div",Da,[d.value==="New"?(s(),i("span",ja,"You have no new notifications.")):(s(),i("span",Ia,"You have no notifications."))])):y("",!0),(s(!0),i(H,null,K(c.value,n=>(s(),i("div",{key:n.id,class:N(["bg-white rounded-xl shadow-sm p-4 flex items-start space-x-4 border border-gray-200 transition-all duration-200 hover:shadow-md cursor-pointer",{"bg-gray-50":n.isRead}]),onClick:k=>e(n)},[t("div",Ma,[t("div",Pa,[t("div",Ea,[n.title?(s(),i("h3",Va,I(n.title),1)):y("",!0),n.project_name?(s(),i("p",Na,I(n.project_name),1)):y("",!0)])]),n.message?(s(),i("p",Ua,I(n.message),1)):y("",!0),t("div",Ba,[n.due_date?(s(),i("span",La,"Due: "+I(j(Ke)(n.due_date)),1)):y("",!0),n.due_date&&n.priority?(s(),i("span",Ra,"•")):y("",!0),n.priority?(s(),i("span",za,"Priority: "+I(n.priority),1)):y("",!0)])])],10,Aa))),128))])]),_:1},8,["show","onUpdate:show"]))}},Oa={class:"space-y-4"},Wa={key:0,class:"text-red-600 text-xs mt-1"},qa={key:0,class:"text-red-600 text-xs mt-1"},Ha={key:0,class:"text-red-600 text-xs mt-1"},Ka={__name:"KudoModal",props:{show:{type:Boolean,default:!1}},emits:["close","submitted"],setup(a,{emit:l}){const d=l,c=D([]),e=D([]),g=Ae({recipient_id:"",project_id:"",comment:""}),u=D({}),m=async()=>{try{const{data:p}=await window.axios.get("/api/projects-simplified");c.value=(p||[]).map(w=>({value:w.id,label:w.name}))}catch{c.value=[]}},v=async p=>{if(e.value=[],!!p)try{const{data:w}=await window.axios.get(`/api/projects/${p}/users`);e.value=(w||[]).map(A=>({value:A.id,label:`${A.name} (${A.email})`}))}catch{e.value=[]}};G(()=>g.project_id,p=>{p&&v(p)}),ye(()=>{m()});const n=()=>{g.recipient_id="",g.project_id="",g.comment="",u.value={}},k=p=>{n(),d("submitted",p)};return(p,w)=>(s(),M(Me,{show:a.show,title:"Give a Kudo ✨","api-endpoint":"/api/kudos","http-method":"post","form-data":g,"submit-button-text":"Submit Kudo","success-message":"Kudo submitted! Pending approval.",onClose:w[3]||(w[3]=A=>p.$emit("close")),onSubmitted:k},{default:_(({errors:A})=>[t("div",Oa,[t("div",null,[w[4]||(w[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Project",-1)),f(ae,{options:c.value,modelValue:g.project_id,"onUpdate:modelValue":w[0]||(w[0]=T=>g.project_id=T),placeholder:"Select a project..."},null,8,["options","modelValue"]),A.project_id?(s(),i("p",Wa,I(A.project_id[0]),1)):y("",!0)]),t("div",null,[w[5]||(w[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Recipient",-1)),f(ae,{options:e.value,modelValue:g.recipient_id,"onUpdate:modelValue":w[1]||(w[1]=T=>g.recipient_id=T),placeholder:"Select a teammate..."},null,8,["options","modelValue"]),A.recipient_id?(s(),i("p",qa,I(A.recipient_id[0]),1)):y("",!0)]),t("div",null,[w[6]||(w[6]=t("label",{class:"block text-sm font-medium text-gray-700"},"Comment",-1)),Z(t("textarea",{"onUpdate:modelValue":w[2]||(w[2]=T=>g.comment=T),rows:"4",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"e.g., Thank you for helping with the last-minute changes!"},null,512),[[ie,g.comment]]),A.comment?(s(),i("p",Ha,I(A.comment[0]),1)):y("",!0)])])]),_:1},8,["show","form-data"]))}},Ya={class:"flex items-center p-4 h-16 border-b border-gray-700"},Ja={key:0,class:"text-xl font-semibold flex-1 truncate"},Za=["title"],Ga={key:0,class:"p-4 border-b border-gray-700"},Qa={class:"relative"},Xa={key:1,class:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-500 scrollbar-track-gray-700 p-4"},eo={key:0,class:"mb-4"},to={class:"ml-2 mt-2 space-y-1"},so=["onClick"],ao={class:"text-sm font-medium text-gray-300 truncate"},oo={class:"ml-4 mt-1 space-y-1"},lo={class:"truncate"},ro={key:1,class:"mb-4"},no={class:"ml-2 mt-2 space-y-1"},io=["onClick"],uo={class:"text-sm font-medium text-gray-300 truncate"},co={class:"ml-4 mt-1 space-y-1"},mo={class:"truncate"},vo={key:2,class:"mb-4"},po={class:"ml-2 mt-2 space-y-1"},go={class:"truncate"},fo={key:3,class:"mb-4"},yo={class:"ml-2 mt-2 space-y-1"},ho={class:"truncate"},bo={key:4,class:"text-gray-400 text-sm text-center py-4"},ko={key:5,class:"text-gray-400 text-sm text-center py-4"},xo={key:2,class:"flex flex-col items-center pt-4 space-y-4"},wo={key:0,class:"text-gray-400 text-xs text-center px-2"},_o={__name:"LeftSidebar",props:{allProjects:{type:Array,default:()=>[]},activeProjectId:{type:Number,default:null}},emits:["project-selected"],setup(a,{emit:l}){const d=a,c=l,e=D(localStorage.getItem("leftSidebarCollapsed")!=="false"),g=D(""),u=D({}),m=B(()=>{const o=new Set;return d.allProjects.forEach(r=>{r.project_type&&o.add(r.project_type)}),Array.from(o).sort()}),v=B(()=>{const o=new Set;return d.allProjects.forEach(r=>{Array.isArray(r.tags)&&r.tags.forEach(x=>o.add(x))}),Array.from(o).sort()}),n=B(()=>{if(!g.value)return d.allProjects;const o=g.value.toLowerCase();return d.allProjects.filter(r=>{var x,C,E;return r.name.toLowerCase().includes(o)||((x=r.description)==null?void 0:x.toLowerCase().includes(o))||((C=r.project_type)==null?void 0:C.toLowerCase().includes(o))||Array.isArray(r.tags)&&r.tags.some(L=>L.toLowerCase().includes(o))||((E=r.status)==null?void 0:E.toLowerCase().includes(o))})}),k=B(()=>{const o={};n.value.forEach(r=>{r.project_type&&r.status==="active"&&(o[r.project_type]||(o[r.project_type]=[]),o[r.project_type].push(r))});for(const r in o)o[r].sort((x,C)=>x.name.localeCompare(C.name));return o}),p=B(()=>{const o={};n.value.forEach(r=>{Array.isArray(r.tags)&&r.tags.length>0&&r.tags.forEach(x=>{o[x]||(o[x]=[]),o[x].push(r)})});for(const r in o)o[r]=[...new Set(o[r])].sort((x,C)=>x.name.localeCompare(C.name));return o}),w=B(()=>n.value.filter(o=>o.status!=="active").sort((o,r)=>o.name.localeCompare(r.name))),A=B(()=>n.value.filter(o=>!o.project_type&&(!Array.isArray(o.tags)||o.tags.length===0)).sort((o,r)=>o.name.localeCompare(r.name)));G(()=>d.allProjects,()=>{m.value.forEach(o=>{const r=`type-${o}`;u.value[r]===void 0&&(u.value[r]=!0)}),v.value.forEach(o=>{const r=`tag-${o}`;u.value[r]===void 0&&(u.value[r]=!0)}),u.value["main-types"]===void 0&&(u.value["main-types"]=!1),u.value["main-tags"]===void 0&&(u.value["main-tags"]=!1),u.value["inactive-projects"]===void 0&&(u.value["inactive-projects"]=!1),u.value.uncategorized===void 0&&(u.value.uncategorized=!1)},{immediate:!0}),G(e,o=>{localStorage.setItem("leftSidebarCollapsed",o)});const T=()=>{e.value=!e.value},b=o=>{u.value[o]=!u.value[o]},P=o=>{c("project-selected",o)},h=()=>{g.value=""};return(o,r)=>(s(),i("div",{class:N({"w-64":!e.value,"w-16":e.value,"min-w-16":!0,"bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out shrink-0 h-screen overflow-hidden":!0})},[t("div",Ya,[e.value?y("",!0):(s(),i("h2",Ja,"Projects")),t("button",{onClick:T,class:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:e.value?"Expand Sidebar":"Collapse Sidebar"},[(s(),i("svg",{class:N(["w-6 h-6 text-gray-400 transform transition-transform duration-300",{"rotate-180":e.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},r[5]||(r[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],8,Za)]),e.value?y("",!0):(s(),i("div",Ga,[t("div",Qa,[Z(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=x=>g.value=x),placeholder:"Search all projects...",class:"w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 text-sm"},null,512),[[ie,g.value]]),g.value?(s(),i("button",{key:0,onClick:h,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200",title:"Clear search"},r[6]||(r[6]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):y("",!0)])])),e.value?(s(),i("div",xo,[(s(!0),i(H,null,K(d.allProjects,x=>(s(),M(j(ne),{key:x.id,href:o.route("projects.show",x.id),onClick:C=>P(x.id),class:N({"w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-200":!0,"bg-indigo-600 text-white":x.id===a.activeProjectId,"bg-gray-700 text-gray-300 hover:bg-gray-600":x.id!==a.activeProjectId}),title:x.name},{default:_(()=>[S(I(x.name.charAt(0).toUpperCase()),1)]),_:2},1032,["href","onClick","class","title"]))),128)),a.allProjects.length===0?(s(),i("div",wo," No Projects ")):y("",!0)])):(s(),i("div",Xa,[Object.keys(k.value).length>0?(s(),i("div",eo,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:r[1]||(r[1]=x=>b("main-types"))},[r[8]||(r[8]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Active Projects by Type",-1)),(s(),i("svg",{class:N(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["main-types"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[7]||(r[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("div",to,[(s(!0),i(H,null,K(k.value,(x,C)=>(s(),i("div",{key:C},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:E=>b(`type-${C}`)},[t("h4",ao,I(C),1),(s(),i("svg",{class:N(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value[`type-${C}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[9]||(r[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,so),Z(t("ul",oo,[(s(!0),i(H,null,K(x,E=>(s(),i("li",{key:E.id},[f(j(ne),{href:o.route("projects.show",E.id),onClick:L=>P(E.id),class:N({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":E.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":E.id!==a.activeProjectId,"font-bold":E.id===a.activeProjectId})},{default:_(()=>[t("span",lo,I(E.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value[`type-${C}`]]])]))),128))],512),[[ce,!u.value["main-types"]]])])):y("",!0),Object.keys(p.value).length>0?(s(),i("div",ro,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:r[2]||(r[2]=x=>b("main-tags"))},[r[11]||(r[11]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Projects by Tag",-1)),(s(),i("svg",{class:N(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["main-tags"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[10]||(r[10]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("div",no,[(s(!0),i(H,null,K(p.value,(x,C)=>(s(),i("div",{key:C},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:E=>b(`tag-${C}`)},[t("h4",uo,I(C),1),(s(),i("svg",{class:N(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value[`tag-${C}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[12]||(r[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,io),Z(t("ul",co,[(s(!0),i(H,null,K(x,E=>(s(),i("li",{key:E.id},[f(j(ne),{href:o.route("projects.show",E.id),onClick:L=>P(E.id),class:N({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":E.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":E.id!==a.activeProjectId,"font-bold":E.id===a.activeProjectId})},{default:_(()=>[t("span",mo,I(E.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value[`tag-${C}`]]])]))),128))],512),[[ce,!u.value["main-tags"]]])])):y("",!0),w.value.length>0?(s(),i("div",vo,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:r[3]||(r[3]=x=>b("inactive-projects"))},[r[14]||(r[14]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Inactive Projects",-1)),(s(),i("svg",{class:N(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["inactive-projects"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[13]||(r[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("ul",po,[(s(!0),i(H,null,K(w.value,x=>(s(),i("li",{key:x.id},[f(j(ne),{href:o.route("projects.show",x.id),onClick:C=>P(x.id),class:N({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":x.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":x.id!==a.activeProjectId,"font-bold":x.id===a.activeProjectId})},{default:_(()=>[t("span",go,I(x.name)+" ("+I(x.status.replace("_"," "))+")",1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value["inactive-projects"]]])])):y("",!0),A.value.length>0?(s(),i("div",fo,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:r[4]||(r[4]=x=>b("uncategorized"))},[r[16]||(r[16]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Uncategorized",-1)),(s(),i("svg",{class:N(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value.uncategorized}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r[15]||(r[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("ul",yo,[(s(!0),i(H,null,K(A.value,x=>(s(),i("li",{key:x.id},[f(j(ne),{href:o.route("projects.show",x.id),onClick:C=>P(x.id),class:N({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":x.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":x.id!==a.activeProjectId,"font-bold":x.id===a.activeProjectId})},{default:_(()=>[t("span",ho,I(x.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value.uncategorized]])])):y("",!0),n.value.length===0?(s(),i("div",bo," No projects found matching your search. ")):a.allProjects.length===0&&!g.value?(s(),i("div",ko," No projects available. ")):y("",!0)]))],2))}},$o=be(_o,[["__scopeId","data-v-417d431f"]]),Co={class:"relative"},et={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(a){const l=a,d=m=>{u.value&&m.key==="Escape"&&(u.value=!1)};ye(()=>document.addEventListener("keydown",d)),Ee(()=>document.removeEventListener("keydown",d));const c=B(()=>{const m={48:"w-48",64:"w-64",72:"w-72",80:"w-80",96:"w-96",full:"w-full",screen:"w-screen",auto:""},v=l.width.toString();return m[v]??m[48]}),e=B(()=>l.width.toString()==="screen"),g=B(()=>l.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":l.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),u=D(!1);return(m,v)=>(s(),i("div",Co,[t("div",{onClick:v[0]||(v[0]=n=>u.value=!u.value)},[le(m.$slots,"trigger")]),Z(t("div",{class:"fixed inset-0 z-40",onClick:v[1]||(v[1]=n=>u.value=!1)},null,512),[[ce,u.value]]),f(Ze,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:_(()=>[Z(t("div",{class:N(["z-50 mt-2 rounded-md shadow-lg",e.value?"fixed left-0 right-0":"absolute",g.value,c.value]),style:{display:"none"},onClick:v[2]||(v[2]=n=>u.value=!1)},[t("div",{class:N(["rounded-md ring-1 ring-black ring-opacity-5",a.contentClasses])},[le(m.$slots,"content")],2)],2),[[ce,u.value]])]),_:3})]))}},ee={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){return(l,d)=>(s(),M(j(ne),Ge({href:a.href,method:a.method,as:a.as},l.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:_(()=>[le(l.$slots,"default")]),_:3},16,["href","method","as"]))}},Ce={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(a){const l=a,d=B(()=>l.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(c,e)=>(s(),M(j(ne),{href:a.href,class:N(d.value)},{default:_(()=>[le(c.$slots,"default")]),_:3},8,["href","class"]))}};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),So=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(l,d,c)=>c?c.toUpperCase():d.toLowerCase()),To=a=>{const l=So(a);return l.charAt(0).toUpperCase()+l.slice(1)},Do=(...a)=>a.filter((l,d,c)=>!!l&&l.trim()!==""&&c.indexOf(l)===d).join(" ").trim(),qe=a=>a==="";/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Se={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=({name:a,iconNode:l,absoluteStrokeWidth:d,"absolute-stroke-width":c,strokeWidth:e,"stroke-width":g,size:u=Se.width,color:m=Se.stroke,...v},{slots:n})=>Ue("svg",{...Se,...v,width:u,height:u,stroke:m,"stroke-width":qe(d)||qe(c)||d===!0||c===!0?Number(e||g||Se["stroke-width"])*24/Number(u):e||g||Se["stroke-width"],class:Do("lucide",v.class,...a?[`lucide-${We(To(a))}-icon`,`lucide-${We(a)}`]:["lucide-icon"])},[...l.map(k=>Ue(...k)),...n.default?[n.default()]:[]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(a,l)=>(d,{slots:c,attrs:e})=>Ue(jo,{...e,...d,iconNode:l,name:a},c);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=tt("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=tt("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Mo={class:"hidden sm:flex sm:items-center"},Po={class:"mx-auto w-full max-w-6xl"},Eo={class:"grid grid-cols-2 md:grid-cols-4 gap-8"},Vo={class:"space-y-1"},No={class:"space-y-1"},Uo={class:"space-y-1"},Bo={class:"space-y-1"},Lo={__name:"AdminDropdown",setup(a){const{canDo:l}=Be(),d=l("manage_projects"),c=l("create_users"),e=l("manage_roles"),g=l("manage_task_types"),u=l("create_clients"),m=l("manage_project_tiers")||l("view_project_tiers");return(v,n)=>(s(),i("div",Mo,[f(et,{align:"left",width:"screen","content-classes":"py-6 bg-white p-6 w-full shadow-lg"},{trigger:_(()=>n[0]||(n[0]=[t("span",{class:"inline-flex rounded-md"},[t("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-700 hover:text-gray-900 focus:outline-none"},[S(" Admin "),t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:_(()=>[t("div",Po,[t("div",Eo,[t("div",null,[n[4]||(n[4]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Management",-1)),t("div",Vo,[j(d)?(s(),M(ee,{key:0,href:v.route("projects.index"),active:v.route().current("projects.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[1]||(n[1]=[S("Projects",-1)])),_:1,__:[1]},8,["href","active"])):y("",!0),j(u)?(s(),M(ee,{key:1,href:v.route("clients.index"),active:v.route().current("clients.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[2]||(n[2]=[S("Clients",-1)])),_:1,__:[2]},8,["href","active"])):y("",!0),j(c)?(s(),M(ee,{key:2,href:v.route("users.index"),active:v.route().current("users.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[3]||(n[3]=[S("Users",-1)])),_:1,__:[3]},8,["href","active"])):y("",!0)])]),t("div",null,[n[6]||(n[6]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Planning",-1)),t("div",No,[j(c)?(s(),M(ee,{key:0,href:v.route("availability.index"),active:v.route().current("availability.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[5]||(n[5]=[S("Weekly Availability",-1)])),_:1,__:[5]},8,["href","active"])):y("",!0)])]),t("div",null,[n[11]||(n[11]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Configuration",-1)),t("div",Uo,[j(g)?(s(),M(ee,{key:0,href:v.route("task-types.index"),active:v.route().current("task-types.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[7]||(n[7]=[S("Task Types",-1)])),_:1,__:[7]},8,["href","active"])):y("",!0),j(m)||j(l)("create_project_tiers")||j(l)("edit_project_tiers")?(s(),M(ee,{key:1,href:"/admin/project-tiers",class:"!px-2 !py-1.5"},{default:_(()=>n[8]||(n[8]=[S("Project Tiers",-1)])),_:1,__:[8]})):y("",!0),j(l)("manage_email_templates")?(s(),M(ee,{key:2,href:v.route("email-templates.index"),active:v.route().current("email-templates.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[9]||(n[9]=[S("Email Templates",-1)])),_:1,__:[9]},8,["href","active"])):y("",!0),j(l)("manage_placeholder_definitions")?(s(),M(ee,{key:3,href:v.route("placeholder-definitions.index"),active:v.route().current("placeholder-definitions.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[10]||(n[10]=[S("Placeholder Definitions",-1)])),_:1,__:[10]},8,["href","active"])):y("",!0)])]),t("div",null,[n[17]||(n[17]=t("h4",{class:"text-xs font-semibold uppercase tracking-wider text-gray-500 mb-3"},"Access & Finance",-1)),t("div",Bo,[j(e)?(s(),M(ee,{key:0,href:v.route("admin.roles.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[12]||(n[12]=[S("Manage Roles",-1)])),_:1,__:[12]},8,["href"])):y("",!0),j(l)("manage_permissions")?(s(),M(ee,{key:1,href:v.route("admin.permissions.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[13]||(n[13]=[S("Manage Permissions",-1)])),_:1,__:[13]},8,["href"])):y("",!0),j(l)("manage_monthly_budgets")?(s(),M(ee,{key:2,href:"/admin/monthly-budgets",class:"!px-2 !py-1.5"},{default:_(()=>n[14]||(n[14]=[S("Monthly Budgets",-1)])),_:1,__:[14]})):y("",!0),j(l)("view_monthly_budgets")?(s(),M(ee,{key:3,href:"/admin/bonus-calculator",class:"!px-2 !py-1.5"},{default:_(()=>n[15]||(n[15]=[S("Bonus Calculator",-1)])),_:1,__:[15]})):y("",!0),j(l)("manage_projects")?(s(),M(ee,{key:4,href:v.route("admin.project-expendables.index"),class:"!px-2 !py-1.5"},{default:_(()=>n[16]||(n[16]=[S("Project Expendables",-1)])),_:1,__:[16]},8,["href"])):y("",!0)])])])])]),_:1})]))}},Ro={class:"relative ms-3"},zo={class:"inline-flex rounded-md"},Fo={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},Oo={__name:"UserDropdown",emits:["logoutSuccess","logoutError"],setup(a,{emit:l}){const d=B(()=>Ie().props.auth.user),c=l,e=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,c("logoutSuccess")},g=u=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",c("logoutError",u)};return(u,m)=>(s(),i("div",Ro,[f(et,{align:"right",width:"48"},{trigger:_(()=>{var v;return[t("span",zo,[t("button",Fo,[S(I(d.value.name)+" ("+I((v=d.value.role_data)==null?void 0:v.name)+") ",1),m[0]||(m[0]=t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:_(()=>[f(ee,{href:u.route("profile.edit")},{default:_(()=>m[1]||(m[1]=[S(" Profile ",-1)])),_:1,__:[1]},8,["href"]),f(ee,{href:u.route("logout"),method:"post",as:"button",onSuccess:e,onError:g},{default:_(()=>m[2]||(m[2]=[S(" Log Out ",-1)])),_:1,__:[2]},8,["href"])]),_:1})]))}},Wo={class:"border-b border-gray-100 bg-white z-10 relative w-full"},qo={class:"w-full px-4 sm:px-6 lg:px-8"},Ho={class:"flex h-16 justify-between"},Ko={class:"flex flex-1 min-w-0"},Yo={class:"flex shrink-0 items-center"},Jo={class:"hidden sm:-my-px sm:ms-10 sm:flex sm:flex-wrap sm:gap-4 overflow-x-auto no-scrollbar"},Zo={class:"hidden sm:ms-6 sm:flex sm:items-center"},Go={key:0,class:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-100 transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full"},Qo={class:"-me-2 flex items-center sm:hidden"},Xo={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},el={__name:"TopNavigation",props:{unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar","open-kudo-modal"],setup(a,{emit:l}){const d=l,c=D(!1);B(()=>Ie().props.auth.user);const{canDo:e}=Be(),g=e("manage_roles");return(u,m)=>(s(),i("nav",Wo,[t("div",qo,[t("div",Ho,[t("div",Ko,[t("div",Yo,[f(j(ne),{href:u.route("dashboard")},{default:_(()=>[f(xt,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),t("div",Jo,[f(Ce,{href:u.route("dashboard"),active:u.route().current("dashboard")},{default:_(()=>m[5]||(m[5]=[S(" Dashboard ",-1)])),_:1,__:[5]},8,["href","active"]),j(e)("view_emails")?(s(),M(Ce,{key:0,href:u.route("inbox"),active:u.route().current("inbox")},{default:_(()=>m[6]||(m[6]=[S(" Inbox ",-1)])),_:1,__:[6]},8,["href","active"])):y("",!0),j(e)("view_own_points")?(s(),M(Ce,{key:1,href:u.route("bonus-system.index"),active:u.route().current("bonus-system.index")},{default:_(()=>m[7]||(m[7]=[S(" Bonus System ",-1)])),_:1,__:[7]},8,["href","active"])):y("",!0),j(e)("view_own_points")?(s(),M(Ce,{key:2,href:u.route("leaderboard.index"),active:u.route().current("leaderboard.index")},{default:_(()=>m[8]||(m[8]=[S(" Leaderboard ",-1)])),_:1,__:[8]},8,["href","active"])):y("",!0),j(e)("view_kudos")?(s(),M(Ce,{key:3,href:u.route("kudos.index"),active:u.route().current("kudos.index")},{default:_(()=>m[9]||(m[9]=[S(" Kudos ",-1)])),_:1,__:[9]},8,["href","active"])):y("",!0),j(g)?(s(),M(Lo,{key:4})):y("",!0)])]),t("div",Zo,[f(X,{type:"button",onClick:m[0]||(m[0]=v=>d("openCreateTaskModal")),class:"mr-2 px-4 py-2 text-sm"},{default:_(()=>m[10]||(m[10]=[S(" Add Task ",-1)])),_:1,__:[10]}),f(X,{type:"button",onClick:m[1]||(m[1]=v=>d("openAddResource")),class:"mr-2 px-4 py-2 text-sm"},{default:_(()=>m[11]||(m[11]=[S(" Add Resource ",-1)])),_:1,__:[11]}),j(e)("create_kudos")?(s(),M(X,{key:0,type:"button",onClick:m[2]||(m[2]=v=>u.$emit("open-kudo-modal")),class:"mr-2 px-4 py-2 text-sm bg-orange-500 hover:bg-orange-600"},{default:_(()=>m[12]||(m[12]=[S(" ✨ Give Kudo ",-1)])),_:1,__:[12]})):y("",!0),t("button",{onClick:m[3]||(m[3]=v=>d("openNotificationsSidebar")),class:"relative flex-shrink-0 text-gray-400 hover:text-gray-600 p-1 rounded-full transition-colors duration-200 mr-4","aria-label":"View all notifications"},[f(j(Io),{class:"h-6 w-6"}),a.unreadNotificationCount>0?(s(),i("span",Go,I(a.unreadNotificationCount),1)):y("",!0)]),f(Oo)]),t("div",Qo,[t("button",{onClick:m[4]||(m[4]=v=>c.value=!c.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(s(),i("svg",Xo,[t("path",{class:N({hidden:c.value,"inline-flex":!c.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),t("path",{class:N({hidden:!c.value,"inline-flex":c.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])])]))}},Y={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){const l=a,d=B(()=>l.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(c,e)=>(s(),M(j(ne),Ge({href:a.href,method:a.method,as:a.as},c.$attrs,{class:d.value}),{default:_(()=>[le(c.$slots,"default")]),_:3},16,["href","method","as","class"]))}},tl={class:"space-y-1 pb-3 pt-2"},sl={key:0,class:"mt-3 space-y-1"},al={class:"border-t border-gray-200 pb-1 pt-4"},ol={class:"px-4"},ll={class:"text-base font-medium text-gray-800"},rl={class:"text-sm font-medium text-gray-500"},nl={class:"text-sm font-medium text-gray-500 capitalize"},il={class:"mt-3 space-y-1"},dl={__name:"MobileNavigation",props:{showingNavigationDropdown:{type:Boolean,required:!0},unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar","logoutSuccess","logoutError"],setup(a,{emit:l}){const d=l,c=B(()=>Ie().props.auth.user),{canDo:e}=Be(),g=e("manage_projects"),u=e("compose_emails"),m=e("approve_emails"),v=e("create_users"),n=e("manage_roles"),k=e("manage_task_types"),p=e("create_clients"),w=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,d("logoutSuccess")},A=T=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",d("logoutError",T)};return(T,b)=>{var P;return s(),i("div",{class:N([{block:a.showingNavigationDropdown,hidden:!a.showingNavigationDropdown},"sm:hidden"])},[t("div",tl,[j(n)?(s(),i("div",sl,[b[17]||(b[17]=t("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),f(Y,{href:T.route("dashboard"),active:T.route().current("dashboard")},{default:_(()=>b[3]||(b[3]=[S(" Dashboard ",-1)])),_:1,__:[3]},8,["href","active"]),j(e)("view_emails")?(s(),M(Y,{key:0,href:T.route("inbox"),active:T.route().current("inbox")},{default:_(()=>b[4]||(b[4]=[S(" Inbox ",-1)])),_:1,__:[4]},8,["href","active"])):y("",!0),j(p)?(s(),M(Y,{key:1,href:T.route("clients.index"),active:T.route().current("clients.index")},{default:_(()=>b[5]||(b[5]=[S(" Clients ",-1)])),_:1,__:[5]},8,["href","active"])):y("",!0),j(g)?(s(),M(Y,{key:2,href:T.route("projects.index"),active:T.route().current("projects.index")},{default:_(()=>b[6]||(b[6]=[S(" Projects ",-1)])),_:1,__:[6]},8,["href","active"])):y("",!0),j(v)?(s(),M(Y,{key:3,href:T.route("users.index"),active:T.route().current("users.index")},{default:_(()=>b[7]||(b[7]=[S(" Users ",-1)])),_:1,__:[7]},8,["href","active"])):y("",!0),j(u)?(s(),M(Y,{key:4,href:T.route("emails.compose"),active:T.route().current("emails.compose")},{default:_(()=>b[8]||(b[8]=[S(" Compose Email ",-1)])),_:1,__:[8]},8,["href","active"])):y("",!0),j(m)?(s(),M(Y,{key:5,href:T.route("emails.pending"),active:T.route().current("emails.pending")},{default:_(()=>b[9]||(b[9]=[S(" Approve Emails ",-1)])),_:1,__:[9]},8,["href","active"])):y("",!0),j(u)?(s(),M(Y,{key:6,href:T.route("emails.rejected"),active:T.route().current("emails.rejected")},{default:_(()=>b[10]||(b[10]=[S(" Rejected Emails ",-1)])),_:1,__:[10]},8,["href","active"])):y("",!0),j(v)?(s(),M(Y,{key:7,href:T.route("availability.index"),active:T.route().current("availability.index")},{default:_(()=>b[11]||(b[11]=[S(" Weekly Availability ",-1)])),_:1,__:[11]},8,["href","active"])):y("",!0),j(e)("manage_roles")?(s(),M(Y,{key:8,href:T.route("admin.roles.index"),active:T.route().current("admin.roles.index")},{default:_(()=>b[12]||(b[12]=[S(" Manage Roles ",-1)])),_:1,__:[12]},8,["href","active"])):y("",!0),j(e)("manage_permissions")?(s(),M(Y,{key:9,href:T.route("admin.permissions.index"),active:T.route().current("admin.permissions.index")},{default:_(()=>b[13]||(b[13]=[S(" Manage Permissions ",-1)])),_:1,__:[13]},8,["href","active"])):y("",!0),j(k)?(s(),M(Y,{key:10,href:T.route("task-types.index"),active:T.route().current("task-types.index")},{default:_(()=>b[14]||(b[14]=[S(" Task Types ",-1)])),_:1,__:[14]},8,["href","active"])):y("",!0),j(e)("manage_email_templates")?(s(),M(Y,{key:11,href:T.route("email-templates.index"),active:T.route().current("email-templates.index")},{default:_(()=>b[15]||(b[15]=[S(" Email Templates ",-1)])),_:1,__:[15]},8,["href","active"])):y("",!0),j(e)("manage_placeholder_definitions")?(s(),M(Y,{key:12,href:T.route("placeholder-definitions.index"),active:T.route().current("placeholder-definitions.index")},{default:_(()=>b[16]||(b[16]=[S(" Placeholder Definitions ",-1)])),_:1,__:[16]},8,["href","active"])):y("",!0)])):y("",!0)]),t("div",al,[t("div",ol,[t("div",ll,I(c.value.name),1),t("div",rl,I(c.value.email),1),t("div",nl,I((P=c.value.role_data)==null?void 0:P.name),1)]),t("div",il,[f(Y,{as:"button",onClick:b[0]||(b[0]=h=>d("openCreateTaskModal"))},{default:_(()=>b[18]||(b[18]=[S(" Add Task ",-1)])),_:1,__:[18]}),f(Y,{as:"button",onClick:b[1]||(b[1]=h=>d("openAddResource"))},{default:_(()=>b[19]||(b[19]=[S(" Add Resource ",-1)])),_:1,__:[19]}),f(Y,{as:"button",onClick:b[2]||(b[2]=h=>d("openNotificationsSidebar"))},{default:_(()=>[S(" Notifications ("+I(a.unreadNotificationCount)+") ",1)]),_:1}),f(Y,{href:T.route("profile.edit")},{default:_(()=>b[20]||(b[20]=[S(" Profile ",-1)])),_:1,__:[20]},8,["href"]),f(Y,{href:T.route("logout"),method:"post",as:"button",onSuccess:w,onError:A},{default:_(()=>b[21]||(b[21]=[S(" Log Out ",-1)])),_:1,__:[21]},8,["href"])])])],2)}}},ul={class:"space-y-4"},cl={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},ml={class:"text-sm font-medium text-gray-900"},vl={class:"text-xs text-gray-500 mt-1"},pl={class:"mb-4"},gl="post",fl="Add Note",yl="Note added successfully!",hl={__name:"TaskNoteModal",props:{show:Boolean,taskForNote:Object},emits:["close","note-added"],setup(a,{emit:l}){const d=a,c=l,e=Ae({note:""}),g=B(()=>{var n;return`Add Note to Task: "${(n=d.taskForNote)==null?void 0:n.name}"`}),u=B(()=>{var n;return`/api/tasks/${(n=d.taskForNote)==null?void 0:n.id}/notes`});G(()=>d.show,n=>{n&&Object.assign(e,{note:""})},{immediate:!0});const m=n=>{c("note-added",n),c("close")},v=()=>{c("close")};return(n,k)=>(s(),M(Me,{show:a.show,title:g.value,"api-endpoint":u.value,"http-method":gl,"form-data":e,"submit-button-text":fl,"success-message":yl,onClose:v,onSubmitted:m},{default:_(({errors:p})=>[t("div",ul,[a.taskForNote?(s(),i("div",cl,[t("p",ml,I(a.taskForNote.name),1),t("p",vl,"Status: "+I(a.taskForNote.status),1)])):y("",!0),t("div",pl,[f(F,{for:"task-note-content",value:"Note Content"}),Z(t("textarea",{id:"task-note-content","onUpdate:modelValue":k[0]||(k[0]=w=>e.note=w),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your note...",required:""},null,512),[[ie,e.note]]),f(J,{message:p.note?p.note[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},bl={class:"task-history-list"},kl={key:0,class:"text-center py-4"},xl={key:1,class:"text-gray-500 text-sm py-2"},wl={key:2,class:"space-y-3"},_l={class:"flex items-start"},$l={class:"text-xl mr-2"},Cl={class:"text-sm text-gray-700"},Sl={class:"text-xs text-gray-500 mt-1"},Tl={__name:"TaskHistoryList",props:{activities:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(a){const l=c=>c?new Date(c).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",d=c=>(console.log(c),c.includes("created")?"🆕":c.includes("started")?"🚀":c.includes("paused")?"⏸️":c.includes("resumed")?"▶️":c.includes("unblocked")?"🔓":c.includes("blocked")?"⛔":c.includes("completed")?"✅":c.includes("revised")?"🔄":c.includes("deleted")?"🗑️":c.includes("assigned")?"👤":c.includes("updated")?"📝":c.includes("added note")?"🗒️":c.includes("commented")?"💬":"📋");return(c,e)=>(s(),i("div",bl,[a.loading?(s(),i("div",kl,e[0]||(e[0]=[t("div",{class:"inline-block animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-indigo-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"Loading activity history...",-1)]))):a.activities.length===0?(s(),i("div",xl," No activity history available for this task. ")):(s(),i("div",wl,[(s(!0),i(H,null,K(a.activities,g=>{var u;return s(),i("div",{key:g.id,class:"p-3 bg-gray-50 rounded-md"},[t("div",_l,[t("span",$l,I(d(g.description)),1),t("div",null,[t("p",Cl,I(g.description),1),t("p",Sl," By "+I(((u=g.causer)==null?void 0:u.name)||"System")+" on "+I(l(g.created_at)),1)])])])}),128))]))]))}},Dl=be(Tl,[["__scopeId","data-v-423d54af"]]),dn=async()=>{try{return(await q.get("/api/assigned-tasks")).data}catch(a){throw console.error("Error fetching assigned tasks:",a),Q("Failed to load assigned tasks"),a}},un=async a=>{try{return(await q.get(`/api/projects/${a}/tasks`)).data}catch(l){throw console.error("Error fetching project tasks:",l),Q("Failed to load project tasks"),l}},cn=async a=>{try{return(await q.get(`/api/projects/${a}/due-and-overdue-tasks`)).data}catch(l){throw console.error("Error fetching due and overdue tasks:",l),Q("Failed to load due and overdue tasks"),l}},jl=async a=>{if(!a||a.status==="In Progress")return a;try{me("Starting task...");const l=await q.post(`/api/tasks/${a.id}/start`);return se("Task started successfully"),l.data}catch(l){throw console.error("Error starting task:",l),Q("Failed to start task. Please try again."),l}},Il=async a=>{if(!a||a.status!=="In Progress")return te('Task can only be paused from "In Progress" status.'),a;try{me("Pausing task...");const l=await q.post(`/api/tasks/${a.id}/pause`);return se("Task paused successfully"),l.data}catch(l){throw console.error("Error pausing task:",l),Q("Failed to pause task. Please try again."),l}},Al=async a=>{if(!a||a.status!=="Paused")return te('Task can only be resumed from "Paused" status.'),a;try{me("Resuming task...");const l=await q.post(`/api/tasks/${a.id}/resume`);return se("Task resumed successfully"),l.data}catch(l){throw console.error("Error resuming task:",l),Q("Failed to resume task. Please try again."),l}},Ml=async a=>{if(!a||a.status==="Done")return a;if(a.status!=="In Progress")throw te("Task must be started before it can be completed"),new Error("Task must be started before it can be completed");try{me("Completing task...");const l=await q.patch(`/api/tasks/${a.id}/complete`);return se("Task completed successfully"),l.data}catch(l){throw console.error("Error completing task:",l),l.response&&l.response.status===422?te(l.response.data.message||"Task must be started before it can be completed"):Q("Failed to complete task. Please try again."),l}},Pl=async(a,l)=>{if(!a||a.status==="Blocked")return te("Task is already blocked."),a;if(a.status==="Done")return te("Completed tasks cannot be blocked."),a;if(!l)throw te("Please provide a reason for blocking the task"),new Error("Blocking reason is required");try{me("Blocking task...");const d=await q.post(`/api/tasks/${a.id}/block`,{reason:l});return se("Task blocked successfully"),d.data}catch(d){throw console.error("Error blocking task:",d),Q("Failed to block task. Please try again."),d}},El=async a=>{if(!a||a.status!=="Blocked")return te("Task is not in a blocked state."),a;try{me("Unblocking task...");const l=await q.post(`/api/tasks/${a.id}/unblock`);return se("Task unblocked successfully"),l.data}catch(l){throw console.error("Error unblocking task:",l),Q("Failed to unblock task. Please try again."),l}},Vl=async a=>{if(!a||a.status!=="Done")return te("Only completed tasks can be revised."),a;try{me("Revising task...");const l=await q.post(`/api/tasks/${a.id}/revise`);return se("Task revised successfully"),l.data}catch(l){throw console.error("Error revising task:",l),l.response&&l.response.status===422?te(l.response.data.message||"Only completed tasks can be revised"):Q("Failed to revise task. Please try again."),l}},Nl=async a=>{if(!a)return!1;if(a.status!=="To Do")throw te("Only tasks in To Do status can be deleted"),new Error("Only tasks in To Do status can be deleted");if(!confirm("Are you sure you want to delete this task? This action cannot be undone."))return!1;try{return me("Deleting task..."),await q.delete(`/api/tasks/${a.id}`),se("Task deleted successfully"),!0}catch(l){throw console.error("Error deleting task:",l),Q("Failed to delete task. Please try again."),l}},Ul=a=>{switch(a){case"To Do":return"bg-yellow-100 text-yellow-800";case"In Progress":return"bg-blue-100 text-blue-800";case"Paused":return"bg-orange-100 text-orange-800";case"Blocked":return"bg-red-100 text-red-800";case"Done":return"bg-green-100 text-green-800";case"Archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},mn=a=>{switch(a){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},vn=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"Medium",Bl=["checked","onChange"],Ll={__name:"ChecklistComponent",props:{items:{type:Array,required:!0},apiEndpoint:{type:String,required:!0},title:{type:String,default:"Checklist"},containerClass:{type:String,default:"mt-4 p-3 bg-gray-100 rounded-lg text-sm text-gray-700 border border-gray-200"},titleClass:{type:String,default:"font-semibold text-gray-900 mb-2"},itemsContainerClass:{type:String,default:"space-y-1"},itemClass:{type:String,default:"flex items-center space-x-2"},checkboxClass:{type:String,default:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},completedItemClass:{type:String,default:"line-through text-gray-500"},successMessage:{type:String,default:"Checklist item updated!"},errorMessage:{type:String,default:"Failed to update checklist item"},payloadTransformer:{type:Function,default:null},checkListStyle:{type:String,default:"checklist"}},emits:["update:items","item-toggled"],setup(a,{emit:l}){const d=a,c=l,e=D(JSON.parse(JSON.stringify(d.items)));G(()=>d.items,u=>{e.value=JSON.parse(JSON.stringify(u))},{deep:!0});async function g(u){const m=e.value[u],v=!m.completed;m.completed=v;try{let n;d.payloadTransformer?n=d.payloadTransformer(e.value,u):n={items:e.value},await q.put(d.apiEndpoint,n),c("update:items",e.value),c("item-toggled",{index:u,item:m,completed:v}),se(d.successMessage)}catch(n){console.error("Error updating checklist item:",n),m.completed=!v,Q(d.errorMessage)}}return(u,m)=>e.value&&e.value.length>0?(s(),i("div",{key:0,class:N(a.containerClass)},[t("p",{class:N(a.titleClass)},I(a.title),3),t("ul",{class:N(a.itemsContainerClass)},[(s(!0),i(H,null,K(e.value,(v,n)=>(s(),i("li",{key:n,class:N(a.itemClass)},[a.checkListStyle==="checklist"?(s(),i("input",{key:0,type:"checkbox",checked:v.completed,onChange:k=>g(n),class:N(a.checkboxClass)},null,42,Bl)):y("",!0),t("span",{class:N({[a.completedItemClass]:v.completed})},I(v.name),3)],2))),128))],2)],2)):y("",!0)}};function He(a,l){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z","clip-rule":"evenodd"})])}const Rl={class:"mt-4"},zl={__name:"ChecklistCreator",props:{modelValue:{type:Array,required:!0},placeholder:{type:String,default:"e.g., Task 1, Task 2, Task 3"},label:{type:String,default:"Checklist Items"},density:{type:String,default:"spacious",validator:a=>["spacious","tight","notes"].includes(a)}},emits:["update:modelValue"],setup(a,{emit:l}){const d=a,c=l,e=D([]),g=D([]),u=D(!1);G(()=>d.modelValue,p=>{u.value=!0,e.value=JSON.parse(JSON.stringify(p)),(e.value.length===0||e.value[e.value.length-1].name.trim()!=="")&&e.value.push({name:"",completed:!1}),fe(()=>{u.value=!1})},{immediate:!0,deep:!0}),G(()=>e.value,p=>{u.value||c("update:modelValue",p)},{deep:!0});function m(p){e.value.splice(p,1),e.value.length===0&&e.value.push({name:"",completed:!1})}function v(p){p===e.value.length-1&&e.value[p].name.trim()!==""&&e.value.push({name:"",completed:!1})}function n(p){p<e.value.length-1&&fe(()=>{var w;(w=g.value[p+1])==null||w.focus()})}const k=B(()=>d.density==="tight"?{listClass:"space-y-1",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-1 text-sm"}:d.density==="notes"?{listClass:"space-y-0.5",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-0.5 text-sm border-transparent focus:border-transparent focus:ring-0 bg-transparent"}:{listClass:"space-y-2",itemClass:"flex items-center space-x-2",inputClass:""});return(p,w)=>(s(),i("div",Rl,[a.label?(s(),M(F,{key:0,value:a.label},null,8,["value"])):y("",!0),t("ul",{class:N(k.value.listClass)},[(s(!0),i(H,null,K(e.value,(A,T)=>(s(),i("li",{key:T,class:N(k.value.itemClass)},[a.density==="notes"?(s(),M(j(He),{key:0,class:"h4 w-4",onClick:b=>m(T)},null,8,["onClick"])):y("",!0),f(de,{modelValue:A.name,"onUpdate:modelValue":b=>A.name=b,type:"text",class:N(["flex-1",k.value.inputClass]),placeholder:T===e.value.length-1?a.placeholder:"",onInput:b=>v(T),onKeyup:Pe(je(b=>n(T),["prevent"]),["enter"]),ref_for:!0,ref:b=>{b&&(g.value[T]=b)}},null,8,["modelValue","onUpdate:modelValue","class","placeholder","onInput","onKeyup"]),e.value.length>1&&a.density!=="notes"?(s(),M(Re,{key:1,type:"button",onClick:b=>m(T)},{default:_(()=>[f(j(He),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):y("",!0)],2))),128))],2)]))}},Fl={key:0,class:"text-center py-8 text-gray-500"},Ol={key:1,class:"text-center py-8 text-red-600"},Wl={key:2,class:"space-y-6"},ql={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},Hl={class:"text-xl font-bold text-gray-900 mb-2"},Kl={class:"flex items-center space-x-2 text-sm text-gray-600 mb-4"},Yl={key:0,class:"text-indigo-600 font-medium"},Jl={key:1,class:"text-purple-600 font-medium"},Zl={class:"text-gray-700 leading-relaxed"},Gl={class:"mt-4 flex flex-wrap gap-2"},Ql={key:0,class:"text-xs text-gray-500 mt-1"},Xl={key:0,class:"bg-yellow-50 border-l-4 border-red-400 p-4 rounded-lg shadow-sm"},er={class:"flex items-center"},tr={class:"ml-3"},sr={class:"mt-2 text-sm text-yellow-700"},ar={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm mb-4"},or={class:"flex justify-between items-center border-b pb-2 mb-4"},lr={key:0},rr={key:1},nr={key:0,class:"mb-4"},ir={class:"flex justify-end mt-4"},dr={key:2,class:"text-gray-500 text-sm py-2"},ur={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm"},cr={class:"flex items-center justify-between py-2 border-b border-gray-100"},mr={class:"flex-1 text-right"},vr={key:0,class:"text-xs text-gray-400 ml-1"},pr={key:1,class:"flex items-center space-x-2"},gr={class:"flex items-center justify-between py-2 border-b border-gray-100"},fr={class:"flex-1 text-right"},yr={key:1,class:"flex items-center space-x-2"},hr={class:"flex items-center justify-between py-2 border-b border-gray-100"},br={class:"flex-1 text-right"},kr={key:0,class:"text-xs text-gray-400 ml-1"},xr={key:1,class:"flex items-center space-x-2"},wr={class:"flex items-center justify-between py-2 border-b border-gray-100"},_r={class:"text-gray-700"},$r={class:"flex items-start py-2 border-b border-gray-100"},Cr={class:"flex-1 flex flex-wrap gap-2"},Sr={key:0,class:"text-gray-500 text-sm"},Tr={class:"bg-white p-4 rounded-lg shadow-sm"},Dr={class:"flex justify-between items-center mb-4 border-b pb-2"},jr={key:0,class:"space-y-3"},Ir={class:"text-sm text-gray-700"},Ar={class:"text-xs text-gray-500 mt-1"},Mr={key:1,class:"text-gray-500 text-sm py-2"},Pr={class:"bg-white p-4 rounded-lg shadow-sm"},Er={key:3,class:"text-center py-8 text-gray-500"},Vr={key:4,class:"mt-4 flex flex-col items-center"},Nr={key:0,class:"text-xs text-red-500 mt-1"},Ur={class:"p-6"},Br={class:"mb-4"},Lr={class:"flex justify-end space-x-3"},Rr={__name:"TaskDetailSidebar",props:{taskId:{type:Number,required:!0},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]}},emits:["close","task-updated","task-deleted"],setup(a,{emit:l}){const d=a,c=l,e=D(null),g=D(!0),u=D(""),m=D(!1),v=D(!1),n=D(!1),k=D(null),p=D(null),w=D(null),A=D([]),T=D(!1),b=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],P=D(!1),h=D(!1),o=D([{name:"",completed:!1}]),r=D(!1),x=async()=>{g.value=!0,u.value="";try{const V=await window.axios.get(`/api/tasks/${d.taskId}`);e.value=V.data,k.value=e.value.assigned_to_id||null,p.value=e.value.due_date||null,w.value=e.value.priority||"medium",C()}catch(V){u.value="Failed to load task details.",console.error("Error fetching task details:",V)}finally{g.value=!1}},C=async()=>{T.value=!0;try{const V=await window.axios.get("/api/activities",{params:{subject_type:"App\\Models\\Task",subject_id:d.taskId}});A.value=V.data}catch(V){console.error("Error fetching task activities:",V)}finally{T.value=!1}};G(()=>d.taskId,V=>{V?x():e.value=null},{immediate:!0});const E=B(()=>d.projectUsers.map(V=>({value:V.id,label:V.name}))),L=async()=>{if(!e.value||k.value===e.value.assigned_to_id){m.value=!1;return}try{const V=await window.axios.patch(`/api/tasks/${e.value.id}`,{assigned_to_user_id:k.value});e.value=V.data,c("task-updated",e.value)}catch(V){console.error("Error updating assigned user:",V),k.value=e.value.assigned_to_id,Q("Failed to update assigned user. Please try again.")}finally{m.value=!1}},re=async()=>{if(!e.value||p.value===e.value.due_date){v.value=!1;return}try{const V=await window.axios.patch(`/api/tasks/${e.value.id}`,{due_date:p.value});e.value=V.data,c("task-updated",e.value)}catch(V){console.error("Error updating due date:",V),p.value=e.value.due_date,Q("Failed to update due date. Please try again.")}finally{v.value=!1}},W=async()=>{if(!e.value||w.value===e.value.priority){n.value=!1;return}try{const V=await window.axios.patch(`/api/tasks/${e.value.id}`,{priority:w.value});e.value=V.data,c("task-updated",e.value)}catch(V){console.error("Error updating priority:",V),w.value=e.value.priority,Q("Failed to update priority. Please try again.")}finally{n.value=!1}},U=()=>{P.value=!0},z=()=>{x(),P.value=!1},O=async()=>{try{await Nl(e.value),c("task-deleted",e.value.id),c("close")}catch(V){console.error("Error deleting task:",V)}},oe=async()=>{try{e.value=await jl(e.value),c("task-updated",e.value),C()}catch(V){console.error("Error starting task:",V)}},st=async()=>{try{e.value=await Il(e.value),c("task-updated",e.value),C()}catch(V){console.error("Error pausing task:",V)}},at=async()=>{try{e.value=await Al(e.value),c("task-updated",e.value),C()}catch(V){console.error("Error resuming task:",V)}},ot=async()=>{try{e.value=await Ml(e.value),c("task-updated",e.value),C()}catch(V){console.error("Error completing task:",V)}},lt=async()=>{try{e.value=await Vl(e.value),c("task-updated",e.value),C()}catch(V){console.error("Error revising task:",V)}},rt=()=>{var V;h.value=!h.value,h.value&&((V=e.value.details)!=null&&V.checklist&&e.value.details.checklist.length>0?(o.value=JSON.parse(JSON.stringify(e.value.details.checklist)),o.value[o.value.length-1].name!==""&&o.value.push({name:"",completed:!1})):o.value=[{name:"",completed:!1}])},nt=async()=>{if(!r.value){r.value=!0;try{const V=o.value.filter(pe=>pe.name.trim()!==""),$={details:{...e.value.details,checklist:V}},ve=await window.axios.patch(`/api/tasks/${e.value.id}`,$);e.value=ve.data,h.value=!1,se("Checklist saved successfully"),c("task-updated",e.value)}catch(V){console.error("Error saving checklist:",V),Q("Failed to save checklist")}finally{r.value=!1}}},ke=D(!1),he=D(""),it=()=>{he.value="",ke.value=!0},dt=async()=>{if(!he.value.trim()){te("Please provide a reason for blocking the task");return}try{e.value=await Pl(e.value,he.value),se("Task blocked successfully"),c("task-updated",e.value),C(),ke.value=!1}catch(V){console.error("Error blocking task:",V)}},ut=async()=>{try{e.value=await El(e.value),c("task-updated",e.value),C()}catch(V){console.error("Error unblocking task:",V)}},ct=B(()=>e.value?Ul(e.value.status):""),Ve=B(()=>{var $,ve,pe,xe;if(!A.value||(($=e.value)==null?void 0:$.status)!=="Blocked")return null;const V=A.value.find(we=>{var _e,$e;return we.event==="updated"&&(($e=(_e=we.properties)==null?void 0:_e.attributes)==null?void 0:$e.status)==="Blocked"});return V?(console.log(V.properties),{causer:((ve=V.causer)==null?void 0:ve.name)||"Unknown",reason:((xe=(pe=V.properties)==null?void 0:pe.attributes)==null?void 0:xe.block_reason)||"No reason provided."}):null});return(V,$)=>{var ve,pe,xe,we,_e,$e,ze;return s(),i("div",null,[g.value?(s(),i("div",Fl," Loading task details... ")):u.value?(s(),i("div",Ol,I(u.value),1)):e.value?(s(),i("div",Wl,[t("div",ql,[t("h4",Hl,I(e.value.name),1),t("div",Kl,[t("span",{class:N(["px-2 py-1 rounded-full text-xs font-medium",ct.value])},I(e.value.status),3),e.value.task_type?(s(),i("span",Yl," | "+I((ve=e.value.task_type)==null?void 0:ve.name)+" | ",1)):y("",!0),$[14]||($[14]=t("br",null,null,-1)),(pe=e.value.milestone)!=null&&pe.name?(s(),i("span",Jl,I((xe=e.value.milestone)==null?void 0:xe.name),1)):y("",!0)]),t("p",Zl,I(e.value.description||"No description provided."),1),t("div",Gl,[e.value.status==="To Do"?(s(),M(X,{key:0,onClick:oe,class:"bg-blue-600 hover:bg-blue-700"},{default:_(()=>$[15]||($[15]=[S(" Start Task ",-1)])),_:1,__:[15]})):e.value.status==="In Progress"?(s(),M(X,{key:1,onClick:st,class:"bg-orange-600 hover:bg-orange-700"},{default:_(()=>$[16]||($[16]=[S(" Pause Task ",-1)])),_:1,__:[16]})):e.value.status==="Paused"?(s(),M(X,{key:2,onClick:at,class:"bg-blue-600 hover:bg-blue-700"},{default:_(()=>$[17]||($[17]=[S(" Resume Task ",-1)])),_:1,__:[17]})):e.value.status==="Blocked"?(s(),M(X,{key:3,onClick:ut,class:"bg-green-600 hover:bg-green-700"},{default:_(()=>$[18]||($[18]=[S(" Unblock Task ",-1)])),_:1,__:[18]})):y("",!0),e.value.status==="To Do"||e.value.status==="In Progress"||e.value.status==="Paused"?(s(),M(X,{key:4,onClick:it,class:"bg-red-600 hover:bg-red-700"},{default:_(()=>$[19]||($[19]=[S(" Block Task ",-1)])),_:1,__:[19]})):y("",!0),e.value.status==="In Progress"?(s(),M(X,{key:5,onClick:ot,class:"bg-green-600 hover:bg-green-700"},{default:_(()=>$[20]||($[20]=[S(" Complete Task ",-1)])),_:1,__:[20]})):y("",!0),e.value.status==="Done"?(s(),M(X,{key:6,onClick:lt,class:"bg-yellow-600 hover:bg-yellow-700"},{default:_(()=>$[21]||($[21]=[S(" Revise Task ",-1)])),_:1,__:[21]})):y("",!0)]),e.value.status==="Done"?(s(),i("div",Ql,' Revising will change the task status back to "To Do" ')):y("",!0)]),e.value.status==="Blocked"&&Ve.value?(s(),i("div",Xl,[t("div",er,[$[23]||($[23]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.487 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11.75 13a.75.75 0 01-1.5 0v-2.25a.75.75 0 011.5 0V13zm-1.5-7.5a.75.75 0 011.5 0v1.5a.75.75 0 01-1.5 0V5.5z","clip-rule":"evenodd"})])],-1)),t("div",tr,[$[22]||($[22]=t("h3",{class:"text-sm font-medium text-yellow-800"},"Task Blocked",-1)),t("div",sr,[t("p",null,"This task was blocked by **"+I(Ve.value.causer)+"** with the following reason:",1),t("p",null,I(Ve.value.reason),1)])])])])):y("",!0),t("div",ar,[t("div",or,[$[24]||($[24]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Task Checklist",-1)),t("button",{onClick:rt,class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center"},[h.value?(s(),i("span",rr,"Cancel")):(s(),i("span",lr,I((we=e.value.details)!=null&&we.checklist&&e.value.details.checklist.length>0?"Edit Checklist":"Add Checklist"),1))])]),h.value?(s(),i("div",nr,[f(zl,{modelValue:o.value,"onUpdate:modelValue":$[0]||($[0]=R=>o.value=R),placeholder:"e.g., Review design, Update documentation",label:"Checklist Items",density:"notes"},null,8,["modelValue"]),t("div",ir,[f(X,{onClick:nt,disabled:r.value,class:"flex items-center space-x-1"},{default:_(()=>[f(j(Ao),{class:"h-4 w-4"}),$[25]||($[25]=t("span",null,"Save Checklist",-1))]),_:1,__:[25]},8,["disabled"])])])):y("",!0),(_e=e.value.details)!=null&&_e.checklist&&e.value.details.checklist.length>0&&!h.value?(s(),M(Ll,{key:1,items:e.value.details.checklist,"api-endpoint":`/api/tasks/${e.value.id}`,title:"Items to complete:","payload-transformer":R=>({details:{...e.value.details,checklist:R}})},null,8,["items","api-endpoint","payload-transformer"])):y("",!0),(!(($e=e.value.details)!=null&&$e.checklist)||e.value.details.checklist.length===0)&&!h.value?(s(),i("div",dr,' No checklist items for this task yet. Click "Add Checklist" to create one. ')):y("",!0)]),t("div",ur,[$[32]||($[32]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Task Attributes",-1)),t("div",cr,[f(F,{class:"min-w-[100px] text-gray-600"},{default:_(()=>$[26]||($[26]=[S("Assigned To:",-1)])),_:1,__:[26]}),t("div",mr,[m.value?(s(),i("div",pr,[f(ae,{id:"edit-assigned-to",modelValue:k.value,"onUpdate:modelValue":$[2]||($[2]=R=>k.value=R),options:E.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1 flex-1","allow-empty":!0},null,8,["modelValue","options"]),t("button",{onClick:L,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:$[3]||($[3]=R=>m.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),i("div",{key:0,onClick:$[1]||($[1]=R=>e.value.status!=="Done"?m.value=!0:te("Cannot change assignment for a completed task. Use the Revise button to change the task status first.")),class:N(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[S(I(((ze=e.value.assigned_to)==null?void 0:ze.name)||"Unassigned")+" ",1),e.value.status!=="Done"?(s(),i("span",vr,"(Click to edit)")):y("",!0)],2))])]),t("div",gr,[f(F,{class:"min-w-[100px] text-gray-600"},{default:_(()=>$[27]||($[27]=[S("Due Date:",-1)])),_:1,__:[27]}),t("div",fr,[v.value?(s(),i("div",yr,[f(de,{id:"edit-due-date",modelValue:p.value,"onUpdate:modelValue":$[5]||($[5]=R=>p.value=R),type:"date",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:re,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:$[6]||($[6]=R=>v.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),i("div",{key:0,onClick:$[4]||($[4]=R=>v.value=!0),class:"cursor-pointer text-indigo-600 hover:text-indigo-800"},[S(I(e.value.due_date?j(wt)(e.value.due_date).format("MMM D, YYYY"):"No Due Date")+" ",1),$[28]||($[28]=t("span",{class:"text-xs text-gray-400 ml-1"},"(Click to edit)",-1))]))])]),t("div",hr,[f(F,{class:"min-w-[100px] text-gray-600"},{default:_(()=>$[29]||($[29]=[S("Priority:",-1)])),_:1,__:[29]}),t("div",br,[n.value?(s(),i("div",xr,[f(ae,{id:"edit-priority",modelValue:w.value,"onUpdate:modelValue":$[8]||($[8]=R=>w.value=R),options:b,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:W,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:$[9]||($[9]=R=>n.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),i("div",{key:0,onClick:$[7]||($[7]=R=>e.value.status!=="Done"?n.value=!0:te("Cannot change priority for a completed task. Use the Revise button to change the task status first.")),class:N(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[t("span",{class:N({"text-red-600 font-medium":e.value.priority==="high","text-yellow-600 font-medium":e.value.priority==="medium","text-green-600 font-medium":e.value.priority==="low"})},I(e.value.priority?e.value.priority.charAt(0).toUpperCase()+e.value.priority.slice(1):"Medium"),3),e.value.status!=="Done"?(s(),i("span",kr,"(Click to edit)")):y("",!0)],2))])]),t("div",wr,[f(F,{class:"min-w-[100px] text-gray-600"},{default:_(()=>$[30]||($[30]=[S("Created:",-1)])),_:1,__:[30]}),t("span",_r,I(e.value.created_at?new Date(e.value.created_at).toLocaleDateString():"N/A"),1)]),t("div",$r,[f(F,{class:"min-w-[100px] text-gray-600 mt-1"},{default:_(()=>$[31]||($[31]=[S("Tags:",-1)])),_:1,__:[31]}),t("div",Cr,[(s(!0),i(H,null,K(e.value.tags,R=>(s(),i("span",{key:R.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},I(R.name),1))),128)),!e.value.tags||e.value.tags.length===0?(s(),i("span",Sr,"No tags")):y("",!0)])])]),t("div",Tr,[t("div",Dr,[$[34]||($[34]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Notes",-1)),f(X,{onClick:U,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:_(()=>$[33]||($[33]=[S(" Add Note ",-1)])),_:1,__:[33]})]),e.value.notes&&e.value.notes.length>0?(s(),i("div",jr,[(s(!0),i(H,null,K(e.value.notes,R=>(s(),i("div",{key:R.id,class:"p-3 bg-gray-50 rounded-md"},[t("p",Ir,I(R.content),1),t("p",Ar," By "+I(R.creator_name||"Unknown")+" on "+I(new Date(R.created_at).toLocaleDateString()),1)]))),128))])):(s(),i("div",Mr,"No notes for this task yet."))]),t("div",Pr,[$[35]||($[35]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"History",-1)),f(Dl,{activities:A.value,loading:T.value},null,8,["activities","loading"])])])):(s(),i("div",Er," Select a task to view details. ")),e.value&&e.value.status!=="Done"?(s(),i("div",Vr,[f(Re,{onClick:O,disabled:e.value.status!=="To Do"},{default:_(()=>$[36]||($[36]=[S(" Delete Task ",-1)])),_:1,__:[36]},8,["disabled"]),e.value.status!=="To Do"?(s(),i("p",Nr,"Task can only be deleted in 'To Do' status.")):y("",!0)])):y("",!0),f(hl,{show:P.value,"task-for-note":e.value,onClose:$[10]||($[10]=R=>P.value=!1),onNoteAdded:z},null,8,["show","task-for-note"]),f(Le,{show:ke.value,onClose:$[13]||($[13]=R=>ke.value=!1)},{default:_(()=>[t("div",Ur,[$[40]||($[40]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),t("div",Br,[$[37]||($[37]=t("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),Z(t("textarea",{"onUpdate:modelValue":$[11]||($[11]=R=>he.value=R),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[ie,he.value]])]),t("div",Lr,[f(De,{onClick:$[12]||($[12]=R=>ke.value=!1)},{default:_(()=>$[38]||($[38]=[S(" Cancel ",-1)])),_:1,__:[38]}),f(X,{onClick:dt,disabled:!he.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:_(()=>$[39]||($[39]=[S(" Block Task ",-1)])),_:1,__:[39]},8,["disabled"])])])]),_:1},8,["show"])])}}},zr={key:1,class:"p-4 text-gray-500"},Fr={key:0,class:"flex justify-end space-x-3"},Or={__name:"TaskSidebar",emits:["taskUpdated","taskDeleted"],setup(a){const l=D(null);return(d,c)=>(s(),M(Xe,{show:j(ue).show,"onUpdate:show":j(Ne),title:j(ue).taskId?"Task Details":"Details",initialWidth:50},{content:_(()=>[j(ue).taskId?(s(),M(Rr,{key:0,"task-id":j(ue).taskId,"project-id":j(ue).projectId,"project-users":j(ue).projectUsers,ref_key:"taskDetailSidebarRef",ref:l,onClose:j(Ne),onTaskUpdated:c[0]||(c[0]=e=>{d.$emit("taskUpdated",e)}),onTaskDeleted:c[1]||(c[1]=e=>{d.$emit("taskDeleted",e),j(Ne)()})},null,8,["task-id","project-id","project-users","onClose"])):j(ue).show?(s(),i("div",zr," No task selected or task ID is missing. ")):y("",!0)]),footer:_(()=>[j(ue).taskId?(s(),i("div",Fr,[l.value&&l.value.task&&l.value.task.status!=="In Progress"&&l.value.task.status!=="Done"?(s(),M(De,{key:0,onClick:l.value.startTask,class:"bg-blue-50 text-blue-700 hover:bg-blue-100"},{default:_(()=>c[2]||(c[2]=[S(" Start Task ",-1)])),_:1,__:[2]},8,["onClick"])):y("",!0),l.value&&l.value.task&&l.value.task.status==="In Progress"?(s(),M(De,{key:1,onClick:l.value.completeTask,class:"bg-green-50 text-green-700 hover:bg-green-100"},{default:_(()=>c[3]||(c[3]=[S(" Complete Task ",-1)])),_:1,__:[3]},8,["onClick"])):y("",!0),l.value&&l.value.task?(s(),M(Re,{key:2,onClick:l.value.deleteTask,class:"bg-red-50 text-red-700 hover:bg-red-100"},{default:_(()=>c[4]||(c[4]=[S(" Delete Task ",-1)])),_:1,__:[4]},8,["onClick"])):y("",!0)])):y("",!0)]),_:1},8,["show","onUpdate:show","title"]))}},Wr={class:"flex h-screen overflow-hidden"},qr={class:"flex-1 flex flex-col overflow-hidden"},Hr={key:0,class:"bg-white shadow"},Kr={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},Yr={class:"flex-1 overflow-y-auto"},pn={__name:"AuthenticatedLayout",setup(a){const l=D(!1),d=D(!1),c=D(!1),e=D(!1),g=D([]),u=D(!0),m=B(()=>Ie().props.id||null),v=D(null),n=async()=>{const h=localStorage.getItem("authToken");if(h){window.axios.defaults.headers.common.Authorization=`Bearer ${h}`;try{await window.axios.get("/api/user")}catch(o){o.response&&o.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},k=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization},p=h=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},w=async()=>{u.value=!0;try{const h=await window.axios.get("/api/projects-simplified");g.value=h.data}catch(h){console.error("Error fetching all projects for sidebar:",h),g.value=[]}finally{u.value=!1}},A=h=>{bt.visit(route("projects.show",h))},T=B(()=>Te.value.notifications.filter(h=>!h.isRead).length),b=h=>{console.log("Task updated globally.",h)},P=h=>{console.log("Task deleted globally.",h)};return ye(()=>{n(),v.value&&yt(v.value),w(),ht()}),(h,o)=>(s(),i("div",Wr,[f(qt,{ref_key:"standardNotificationContainerRef",ref:v},null,512),f(Bt,{"sidebar-is-open":j(Te).show},null,8,["sidebar-is-open"]),f(ws),f($o,{"all-projects":g.value,"active-project-id":m.value,onProjectSelected:A},null,8,["all-projects","active-project-id"]),t("div",qr,[f(el,{"unread-notification-count":T.value,onOpenCreateTaskModal:o[0]||(o[0]=r=>d.value=!0),onOpenAddResource:o[1]||(o[1]=r=>c.value=!0),onOpenNotificationsSidebar:j(Oe),onOpenKudoModal:o[2]||(o[2]=r=>e.value=!0)},null,8,["unread-notification-count","onOpenNotificationsSidebar"]),f(dl,{"showing-navigation-dropdown":l.value,"unread-notification-count":T.value,onOpenCreateTaskModal:o[3]||(o[3]=r=>d.value=!0),onOpenAddResource:o[4]||(o[4]=r=>c.value=!0),onOpenNotificationsSidebar:j(Oe),onLogoutSuccess:k,onLogoutError:p},null,8,["showing-navigation-dropdown","unread-notification-count","onOpenNotificationsSidebar"]),h.$slots.header?(s(),i("header",Hr,[t("div",Kr,[le(h.$slots,"header")])])):y("",!0),t("main",Yr,[le(h.$slots,"default")]),f(va,{show:d.value,onClose:o[5]||(o[5]=r=>d.value=!1),onSaved:o[6]||(o[6]=r=>d.value=!1)},null,8,["show"]),f(ya,{"api-endpoint":"/api/shareable-resources",show:c.value,onClose:o[7]||(o[7]=r=>c.value=!1)},null,8,["show"]),f(Ka,{show:e.value,onClose:o[8]||(o[8]=r=>e.value=!1),onSubmitted:o[9]||(o[9]=r=>e.value=!1)},null,8,["show"])]),f(Or,{onTaskUpdated:b,onTaskDeleted:P}),f(Fa)]))}};export{Me as B,ya as C,Qe as T,pn as _,Xs as a,hs as b,vn as c,mn as d,Ml as e,dn as f,Ul as g,Nl as h,Vl as i,Pl as j,Ll as k,zl as l,Is as m,He as n,hl as o,Il as p,un as q,Al as r,jl as s,va as t,El as u,cn as v};
