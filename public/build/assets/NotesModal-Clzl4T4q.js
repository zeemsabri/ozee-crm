import{r as w,w as _,c as x,o as p,a as m,b as i,i as b,g as y,t as v,d as B,A as M,e as u,m as g,n as S,z as k,s as E}from"./app-CVGDP6I0.js";import{a as C,_ as N}from"./SecondaryButton-BfI_TbHa.js";import{P as $}from"./PrimaryButton-CD6-48la.js";import{s as j,e as A}from"./AuthenticatedLayout-BkDNYAP9.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as D,a as T}from"./InputError-Bn0nt5-1.js";import{_ as V}from"./TextInput-BAVMqkDT.js";const I={class:"p-6"},P={class:"flex justify-between items-center mb-4"},q={class:"text-lg font-medium text-gray-900"},L={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},z={class:"block sm:inline"},H={key:0,class:"mt-6 flex justify-end space-x-3"},O={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:r=>["post","put","patch","delete"].includes(r.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:r=>r},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(r,{emit:f}){const o=r,l=f,t=w(!1),d=w({}),n=w("");_(()=>o.show,e=>{e&&(d.value={},n.value="",t.value=!1)});const h=async()=>{t.value=!0,d.value={},n.value="";try{const e=o.formatDataForApi(o.formData);console.log("BaseFormModal: Data being sent to API:",e);let s;const c=o.httpMethod.toLowerCase();if(c==="post")s=await window.axios.post(o.apiEndpoint,e);else if(c==="put")s=await window.axios.put(o.apiEndpoint,e);else if(c==="patch")s=await window.axios.patch(o.apiEndpoint,e);else if(c==="delete")s=await window.axios.delete(o.apiEndpoint,{data:e});else throw new Error(`Unsupported HTTP method: ${o.httpMethod}`);j(o.successMessage),l("submitted",s.data),l("close")}catch(e){console.error("BaseFormModal: API submission error:",e),e.response?e.response.status===422?(d.value=e.response.data.errors,n.value="Please correct the errors in the form."):n.value=e.response.data.message||"An unexpected error occurred.":n.value="A network error occurred or the server is unreachable.",A(n.value),l("error",e)}finally{t.value=!1}},a=()=>{l("close")};return(e,s)=>(p(),x(N,{show:r.show,onClose:a},{default:m(()=>[i("div",I,[i("div",P,[i("h2",q,v(r.title),1),i("button",{onClick:a,class:"text-gray-400 hover:text-gray-500"},s[0]||(s[0]=[i("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),n.value?(p(),b("div",L,[i("span",z,v(n.value),1)])):y("",!0),i("form",{onSubmit:B(h,["prevent"])},[M(e.$slots,"default",{errors:d.value},void 0,!0),r.showFooter?(p(),b("div",H,[u(C,{onClick:a,type:"button",disabled:t.value},{default:m(()=>s[1]||(s[1]=[g(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),u($,{type:"submit",disabled:t.value,class:S({"opacity-75 cursor-not-allowed":t.value})},{default:m(()=>[g(v(t.value?"Submitting...":r.submitButtonText),1)]),_:1},8,["disabled","class"])])):y("",!0)],32)])]),_:3},8,["show"]))}},U=F(O,[["__scopeId","data-v-a2f6d2f8"]]),G={class:"mb-4"},Z={__name:"NotesModal",props:{show:Boolean,projectId:Number},emits:["close","noteAdded"],setup(r,{emit:f}){const o=r,l=f,t=k({project_id:null,notes:[{content:""}]});_(()=>o.projectId,a=>{a&&(t.project_id=a)},{immediate:!0}),_(()=>o.show,a=>{a&&(t.project_id=o.projectId,t.notes[0].content="")});const d=E(()=>`/api/projects/${t.project_id}/notes`),n=a=>{l("noteAdded")},h=a=>{console.error("Error in NotesModal submission:",a)};return(a,e)=>(p(),x(U,{show:r.show,title:"Add Note","api-endpoint":d.value,"http-method":"post","form-data":t,"submit-button-text":"Add Note","success-message":"Note added successfully!",onClose:e[1]||(e[1]=s=>a.$emit("close")),onSubmitted:n,onError:h},{default:m(({errors:s})=>[i("div",G,[u(D,{for:"note_content",value:"Note Content"}),u(V,{id:"note_content",type:"text",class:"mt-1 block w-full",modelValue:t.notes[0].content,"onUpdate:modelValue":e[0]||(e[0]=c=>t.notes[0].content=c),required:""},null,8,["modelValue"]),u(T,{message:s["notes.0.content"]?s["notes.0.content"][0]:"",class:"mt-2"},null,8,["message"])])]),_:1},8,["show","api-endpoint","form-data"]))}};export{U as B,Z as _};
