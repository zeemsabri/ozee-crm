import{_ as F}from"./AuthenticatedLayout-DGP8zdUd.js";import{c as _,r as P,C as R,e as j,g as E,o as i,w as f,b as s,a as o,d as V,i as v,t as m,F as d,l as p,u as M,A as O,m as D,p as H}from"./app-DPPlWUgE.js";import{_ as L}from"./MultiSelectDropdown-H6ecYkj-.js";import"./PrimaryButton-BGxDguGg.js";import"./Modal-Dtl518ch.js";import"./InputLabel-BhlhMI_u.js";import"./InputError-DsIVl3hn.js";import"./SecondaryButton-CS9GxTxs.js";import"./index-DYoTJTvT.js";import"./BaseFormModal-_SRr_3OK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-joXTkR7R.js";import"./SelectDropdown-CFOqYu4w.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-DGWouZ-M.js";import"./createLucideIcon-DCzPbb62.js";import"./plus-C14Liy18.js";import"./DangerButton-CiIy4XwL.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-BPP4z-kh.js";import"./ChevronDownIcon-C6AEg5m3.js";const T={class:"py-12"},U={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Y={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},q={class:"p-6 bg-white border-b border-gray-200"},z={class:"mb-6"},G={class:"max-w-3xl"},J={key:0,class:"text-sm text-red-600 mt-2"},K={key:0,class:"text-sm text-gray-500 p-4 bg-gray-50 rounded-lg"},Q={key:1},W={class:"overflow-x-auto"},X={class:"min-w-full divide-y divide-gray-200"},Z={class:"bg-gray-50"},I={class:"bg-white divide-y divide-gray-200"},ee={class:"bg-gray-100"},te=["colspan"],se={class:"px-6 py-3 text-sm text-gray-900"},ie={class:"font-medium"},oe={key:0,class:"text-xs text-gray-500"},ae={class:"inline-flex items-center space-x-2"},re=["checked","disabled","onChange"],ne={key:0,class:"text-xs text-gray-500"},le={class:"flex items-center justify-end mt-6"},Ne={__name:"Compare",props:{roles:Array,permissions:Object},setup(A){const g=A,S=_(()=>(g.roles||[]).map(e=>({value:e.id,label:e.name}))),x=P([]),y=P(""),$=e=>{y.value="",Array.isArray(e)&&e.length>3?(x.value=e.slice(0,3),y.value="You can select a maximum of 3 roles."):x.value=e},n=R({}),b=()=>{(g.roles||[]).forEach(e=>{n[e.id]=new Set((e.permissions||[]).map(t=>t.id))})};b();const c=_(()=>(g.roles||[]).filter(e=>{var t;return(t=x.value)==null?void 0:t.includes(e.id)})),k=_(()=>g.permissions||{}),h=R({}),w=(e,t)=>`${e}:${t}`,C=(e,t)=>!!h[w(e,t)],B=(e,t)=>!!n[e]&&n[e].has(t),N=async(e,t)=>{n[e]||(n[e]=new Set);const r=w(e,t);if(h[r])return;const u=n[e].has(t);u?n[e].delete(t):n[e].add(t),h[r]=!0;try{const a=Array.from(n[e]);await H.post(`/api/roles/${e}/permissions`,{permissions:a})}catch(a){u?n[e].add(t):n[e].delete(t),console.error("Failed to update permission:",a)}finally{h[r]=!1}};return j(()=>g.roles,()=>b(),{deep:!0}),(e,t)=>(i(),E(F,null,{header:f(()=>t[1]||(t[1]=[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Compare and Manage Role Permissions ",-1)])),default:f(()=>[s("div",T,[s("div",U,[s("div",Y,[s("div",q,[s("div",z,[t[2]||(t[2]=s("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Select up to 3 roles",-1)),s("div",G,[V(L,{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=r=>x.value=r),options:S.value,isMulti:!0,placeholder:"Select roles (max 3)",onChange:$},null,8,["modelValue","options"]),y.value?(i(),o("p",J,m(y.value),1)):v("",!0)])]),Object.keys(k.value).length===0?(i(),o("div",K," No permissions available. Please create some permissions first. ")):(i(),o("div",Q,[s("div",W,[s("table",X,[s("thead",Z,[s("tr",null,[t[3]||(t[3]=s("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/3"}," Permission ",-1)),(i(!0),o(d,null,p(c.value,(r,u)=>(i(),o("th",{key:r.id,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},m(r.name),1))),128)),(i(!0),o(d,null,p(3-c.value.length,r=>(i(),o("th",{key:"empty-col-"+r,class:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider"}," Role "+m(c.value.length+r),1))),128))])]),s("tbody",I,[(i(!0),o(d,null,p(k.value,(r,u)=>(i(),o(d,{key:u},[s("tr",ee,[s("td",{class:"px-6 py-2 text-sm font-semibold text-gray-700",colspan:1+Math.max(3,c.value.length)},m(u),9,te)]),(i(!0),o(d,null,p(r,a=>(i(),o("tr",{key:a.id},[s("td",se,[s("div",ie,m(a.name),1),a.description?(i(),o("div",oe,m(a.description),1)):v("",!0)]),(i(!0),o(d,null,p(c.value,l=>(i(),o("td",{key:l.id+"-"+a.id,class:"px-6 py-3"},[s("label",ae,[s("input",{type:"checkbox",class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded",checked:B(l.id,a.id),disabled:C(l.id,a.id),onChange:de=>N(l.id,a.id)},null,40,re),C(l.id,a.id)?(i(),o("span",ne,"Saving...")):v("",!0)])]))),128)),(i(!0),o(d,null,p(3-c.value.length,l=>(i(),o("td",{key:a.id+"-empty-"+l,class:"px-6 py-3 text-gray-300"}," â€” "))),128))]))),128))],64))),128))])])])])),s("div",le,[V(M(O),{href:e.route("admin.roles.index"),class:"inline-flex items-center px-4 py-2 bg-gray-300 border border-transparent rounded-md font-semibold text-xs text-gray-800 uppercase tracking-widest hover:bg-gray-400 active:bg-gray-500 focus:outline-none focus:border-gray-500 focus:ring focus:ring-gray-300 disabled:opacity-25 transition"},{default:f(()=>t[4]||(t[4]=[D(" Back to Roles ",-1)])),_:1,__:[4]},8,["href"])])])])])])]),_:1}))}};export{Ne as default};
