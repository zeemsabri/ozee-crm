import{r as u,G as ys,E as qs,l as D,b as Es,m as J,c as l,o,e as B,a as e,q as Gs,k as c,w as z,g as i,_ as O,t as r,f as Ys,v as Qs,F as w,i as F,n as b,j as K,y as Js,W as Ks,V as Xs}from"./app-BLU9hplj.js";import{_ as Zs,s as ks,c as gs,r as st,p as tt}from"./taskState-BGQyGbJ5.js";import{S as et}from"./SelectDropdown-Bt4hm_C9.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseFormModal-Ch3QqYhr.js";import"./Modal-CM4aiHEy.js";import"./PrimaryButton-DjNPhEwL.js";import"./SecondaryButton-DETx9xQ1.js";import"./InputLabel-a2FNPi2t.js";import"./InputError-D8vZx8_h.js";/* empty css                                                                       */const ot={class:"daily-work-log"},lt={key:0,class:"tips-banner"},nt={class:"dwl-header"},rt={class:"dwl-date-nav"},it={class:"dwl-date-label"},dt={class:"dwl-date-main"},ct={key:0,class:"chip chip-today"},ut={key:1,class:"chip chip-future"},pt={key:2,class:"chip chip-past"},vt={key:0,class:"dwl-user-switcher"},yt={class:"dwl-header-right"},kt={key:0,class:"progress-pills"},gt={class:"pill p-pending"},ft={class:"pill p-done"},ht={key:0,class:"pill p-pushed"},wt={key:0,class:"task-picker"},bt={class:"picker-header"},mt=["disabled"],_t={key:0,class:"picker-empty"},Ct={key:1,class:"picker-empty"},Dt={key:0},xt={key:1},St={key:2,class:"picker-grid"},Pt=["onClick"],Tt={key:0,viewBox:"0 0 20 20",fill:"currentColor",width:"12",height:"12"},$t={class:"picker-task-body"},It={class:"picker-task-name"},At={class:"picker-task-meta"},Lt={key:0,class:"tag tag-proj"},jt={class:"dwl-body"},Bt={key:0,class:"skeleton-wrap"},Ft={key:1,class:"empty-state"},Nt={key:2,class:"task-list"},Vt=["onDragstart","onDragover","onDrop"],Ht={key:0,class:"active-ring"},Mt={class:"task-info"},zt=["onClick"],Ot={class:"task-meta"},Ut={key:0,class:"tag tag-proj"},Rt={key:1,class:"tag tag-milestone"},Wt={key:0,class:"status-hint"},qt={class:"task-actions"},Et={key:0,class:"spinner"},Gt=["disabled","onClick","title"],Yt=["onClick"],Qt=["onClick"],Jt=["onClick"],Kt={key:3,class:"dwl-foot"},Xt={key:0,class:"foot-note"},Zt={key:1,class:"foot-note dim"},se={class:"warn-modal"},te={class:"warn-modal-body"},ee={key:0,class:"history-panel"},ae={key:0,class:"picker-empty"},oe={class:"history-day-header"},le={class:"history-date"},ne={class:"history-day-pills"},re={class:"pill p-done"},ie={key:0,class:"pill p-pending"},de={key:1,class:"pill p-pushed"},ce={class:"history-list"},ue={class:"history-task-name"},pe={key:0,class:"tag tag-proj sm"},ve={__name:"DailyWorkLog",setup(ye){const X=s=>{const t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0");return`${t}-${a}-${d}`},Z=s=>{const[t,a,d]=s.split("-");return new Date(t,a-1,d)},ss=s=>Z(s).toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),U=X(new Date),m=u(U),p=u([]),R=u([]),W=u({}),ts=u([]),P=u(ys().props.auth.user.id),{canDo:fs}=qs(),es=D(()=>fs("view_all_projects").value),q=u(!1),E=u(!1),G=u(!1),Y=u(new Set),N=u(!1),Q=u(null),T=u(""),f=u(!1),$=u(!1),V=u(localStorage.getItem("dwl_tips_dismissed")!=="1"),x=u({show:!1,item:null,mode:""}),L=u(null),H=u(null),hs=D(()=>m.value===U),ws=D(()=>m.value>U),as=D(()=>{const s=T.value.toLowerCase().trim(),t=new Set(p.value.map(a=>a.task_id));return R.value.filter(a=>{var n,y,k;return t.has(a.id)||a.status==="Done"||a.status==="Archived"?!1:s?String(a.name||"").toLowerCase().includes(s)||String(((y=(n=a.milestone)==null?void 0:n.project)==null?void 0:y.name)||"").toLowerCase().includes(s)||String(((k=a.milestone)==null?void 0:k.name)||"").toLowerCase().includes(s):!0})}),bs=D(()=>p.value.filter(s=>s.status==="pending").length),ms=D(()=>p.value.filter(s=>s.status==="completed").length),os=D(()=>p.value.filter(s=>s.status==="pushed_to_next_day").length),ls=D(()=>Object.entries(W.value).sort(([s],[t])=>t.localeCompare(s))),v=s=>{var t;return((t=s.task)==null?void 0:t.status)??"To Do"},_s=s=>v(s)==="Paused",Cs=s=>v(s)==="In Progress",ns=s=>v(s)==="In Progress",rs=s=>v(s)==="Done",j=s=>rs(s)?{label:"âœ“ Done",disabled:!0,type:"done"}:ns(s)?{label:"âœ“ Complete",type:"complete"}:_s(s)?{label:"â–· Resume",type:"resume"}:Cs(s)?{label:"â¸ Pause",type:"pause"}:{label:"â–· Start",type:"start"},Ds=s=>Y.value.has(s.task_id),h=(s,t)=>{const a=new Set(Y.value);t?a.add(s.task_id):a.delete(s.task_id),Y.value=a},xs=async s=>{h(s,!0);try{const t=await ks(s.task);s.task={...s.task,...t}}catch{}h(s,!1)},Ss=async s=>{h(s,!0);try{const t=await st(s.task);s.task={...s.task,...t}}catch{}h(s,!1)},Ps=async s=>{h(s,!0);try{const t=await tt(s.task);s.task={...s.task,...t}}catch{}h(s,!1)},Ts=async s=>{if(!ns(s)){x.value={show:!0,item:s,mode:"complete"};return}h(s,!0);try{const t=await gs(s.task);s.task={...s.task,...t},await window.axios.patch(`/api/daily-tasks/${s.id}`,{status:"completed"}),s.status="completed",f.value&&await I()}catch{}h(s,!1)},$s=async()=>{const s=x.value.item;if(x.value={show:!1,item:null,mode:""},!!s){h(s,!0);try{const t=await ks(s.task);s.task={...s.task,...t};const a=await gs(s.task);s.task={...s.task,...a},await window.axios.patch(`/api/daily-tasks/${s.id}`,{status:"completed"}),s.status="completed",f.value&&await I()}catch{}h(s,!1)}},is=()=>{x.value={show:!1,item:null,mode:""}},Is=s=>{const t=j(s);t.disabled||(t.type==="start"&&xs(s),t.type==="resume"&&Ss(s),t.type==="pause"&&Ps(s),t.type==="complete"&&Ts(s))},M=async()=>{q.value=!0;try{const{data:s}=await window.axios.get("/api/daily-tasks",{params:{date:m.value,user_id:P.value}});p.value=Array.isArray(s)?s:[]}catch(s){console.error("Failed to load daily log",s)}finally{q.value=!1}},As=async()=>{if(es.value)try{const{data:s}=await window.axios.get("/api/users");ts.value=(Array.isArray(s)?s:[]).map(t=>({value:t.id,label:t.name}))}catch(s){console.error("Failed to load users",s)}},ds=async()=>{if(P.value!==ys().props.auth.user.id){R.value=[];return}E.value=!0;try{const{data:s}=await window.axios.get("/api/tasks",{params:{assigned_to_me:1,statuses:"To Do,In Progress,Paused,Blocked",per_page:200}});R.value=Array.isArray(s)?s:(s==null?void 0:s.data)||[]}catch(s){console.error("Failed to load task pool",s)}finally{E.value=!1}},I=async()=>{try{const{data:s}=await window.axios.get("/api/daily-tasks/history",{params:{days:14,user_id:P.value}});W.value=s||{}}catch(s){console.error("Failed to load history",s)}},Ls=async s=>{try{const{data:t}=await window.axios.post("/api/daily-tasks",{task_ids:s,date:m.value}),a=Array.isArray(t)?t:[],d=new Set(p.value.map(n=>n.id));for(const n of a)d.has(n.id)||p.value.push(n);$.value=!1,T.value="",g.value=new Set}catch(t){console.error("Failed to add tasks",t)}},js=async()=>{G.value=!0;try{await window.axios.post("/api/daily-tasks/reorder",{date:m.value,ordered_ids:p.value.map(s=>s.id)})}catch(s){console.error("Failed to save order",s)}finally{G.value=!1}},Bs=async s=>{try{await window.axios.post(`/api/daily-tasks/${s.id}/push-to-tomorrow`),s.status="pushed_to_next_day",f.value&&await I()}catch(t){console.error("Failed to push to tomorrow",t)}},Fs=async s=>{try{await window.axios.delete(`/api/daily-tasks/${s.id}`),p.value=p.value.filter(t=>t.id!==s.id)}catch(t){console.error("Failed to remove from log",t)}},Ns=s=>{var t;s&&Xs(s.id,(t=s.milestone)==null?void 0:t.project_id,[])},Vs=s=>{Q.value=s,N.value=!0},Hs=s=>{L.value=s.id},Ms=(s,t)=>{t.preventDefault(),H.value=s.id},zs=async(s,t)=>{t.preventDefault();const a=L.value,d=s.id;if(L.value=null,H.value=null,!a||a===d)return;const n=p.value.findIndex(_=>_.id===a),y=p.value.findIndex(_=>_.id===d);if(n===-1||y===-1)return;const k=[...p.value],[S]=k.splice(n,1);k.splice(y,0,S),p.value=k,await js()},Os=()=>{L.value=null,H.value=null},cs=s=>{const t=Z(m.value);t.setDate(t.getDate()+s),m.value=X(t)},A=s=>({"To Do":{bg:"#eff6ff",color:"#1d4ed8",border:"#bfdbfe"},"In Progress":{bg:"#ecfdf5",color:"#065f46",border:"#6ee7b7"},Paused:{bg:"#fffbeb",color:"#92400e",border:"#fcd34d"},Blocked:{bg:"#fef2f2",color:"#991b1b",border:"#fca5a5"},Done:{bg:"#ede9fe",color:"#5b21b6",border:"#c4b5fd"}})[s]||{bg:"#f3f4f6",color:"#374151",border:"#e5e7eb"},us=s=>({pending:"Pending",completed:"Completed",pushed_to_next_day:"Pushed"})[s]||s,Us=s=>{const t=j(s);return t.disabled?{background:"#d1fae5",color:"#065f46",border:"#6ee7b7"}:t.type==="complete"?{background:"#6366f1",color:"#fff",border:"#818cf8"}:t.type==="pause"?{background:"#fef3c7",color:"#78350f",border:"#fcd34d"}:{background:"#3b82f6",color:"#fff",border:"#60a5fa"}},ps=()=>{V.value=!1;try{localStorage.setItem("dwl_tips_dismissed","1")}catch{}};Es(async()=>{await As(),await M(),await ds()}),J(P,async()=>{await M(),await ds(),f.value&&await I()}),J(m,async()=>{await M(),f.value&&await I()}),J(f,async s=>{s&&Object.keys(W.value).length===0&&await I()});const g=u(new Set),Rs=s=>{const t=new Set(g.value);t.has(s)?t.delete(s):t.add(s),g.value=t},Ws=()=>{const s=Array.from(g.value);s.length&&Ls(s)};return(s,t)=>(o(),l("div",ot,[B(O,{name:"slide-down"},{default:z(()=>[V.value?(o(),l("div",lt,[e("button",{class:"tips-close",onClick:ps,title:"Dismiss tips"},"âœ•"),t[10]||(t[10]=e("div",{class:"tips-heading"},[e("span",{class:"tips-icon"},"ðŸ’¡"),e("strong",null,"How the Daily Work Log works")],-1)),t[11]||(t[11]=e("div",{class:"tips-grid"},[e("div",{class:"tip-card"},[e("div",{class:"tip-step"},"1"),e("div",{class:"tip-body"},[e("strong",null,"Plan your day"),i(" â€” Pick tasks from your assigned list and add them here. Drag to set the order you'll work on them. ")])]),e("div",{class:"tip-card"},[e("div",{class:"tip-step"},"2"),e("div",{class:"tip-body"},[e("strong",null,"Start each task"),i(" â€” Hit "),e("em",null,"â–· Start"),i(" when you begin. This logs your time and signals to the team you're on it. ")])]),e("div",{class:"tip-card"},[e("div",{class:"tip-step"},"3"),e("div",{class:"tip-body"},[e("strong",null,"Pause when you stop"),i(" â€” If you need to switch or take a break, hit "),e("em",null,"â¸ Pause"),i(". Resume later when you're back. ")])]),e("div",{class:"tip-card"},[e("div",{class:"tip-step"},"4"),e("div",{class:"tip-body"},[e("strong",null,"Complete to finish"),i(" â€” Only available once the task is "),e("em",null,"In Progress"),i(". This marks the task Done and logs your session. ")])]),e("div",{class:"tip-card tip-card-warn"},[e("div",{class:"tip-step warn"},"âš "),e("div",{class:"tip-body"},[e("strong",null,"Don't skip steps"),i(" â€” Avoid starting and immediately completing without actually working on it. Accurate time tracking helps the whole team. ")])]),e("div",{class:"tip-card"},[e("div",{class:"tip-step"},"5"),e("div",{class:"tip-body"},[e("strong",null,"Push unfinished tasks"),i(" â€” Hit "),e("em",null,"â†’ Tomorrow"),i(" to move anything you didn't finish to the next day. It stays in history so nothing gets lost. ")])])],-1)),e("button",{class:"tips-got-it",onClick:ps},"Got it, let's go â†’")])):c("",!0)]),_:1}),e("div",nt,[e("div",rt,[e("button",{class:"nav-btn",onClick:t[0]||(t[0]=a=>cs(-1)),title:"Previous day"},"â€¹"),e("div",it,[e("div",dt,r(ss(m.value)),1),hs.value?(o(),l("div",ct,"Today")):ws.value?(o(),l("div",ut,"Upcoming")):(o(),l("div",pt,"Past"))]),e("button",{class:"nav-btn",onClick:t[1]||(t[1]=a=>cs(1)),title:"Next day"},"â€º")]),es.value?(o(),l("div",vt,[B(et,{id:"dwl-user-select",modelValue:P.value,"onUpdate:modelValue":t[2]||(t[2]=a=>P.value=a),options:ts.value,placeholder:"Viewing log for..."},null,8,["modelValue","options"])])):c("",!0),e("div",yt,[p.value.length?(o(),l("div",kt,[e("span",gt,r(bs.value)+" Pending",1),e("span",ft,r(ms.value)+" Done",1),os.value?(o(),l("span",ht,r(os.value)+" Pushed",1)):c("",!0)])):c("",!0),e("button",{class:"btn-ghost-sm",onClick:t[3]||(t[3]=a=>V.value=!V.value),title:"Show tips"},"ðŸ’¡ Tips"),e("button",{class:"btn-outline",onClick:t[4]||(t[4]=a=>f.value=!f.value)},r(f.value?"Hide History":"ðŸ“… History"),1),e("button",{class:"btn-primary",onClick:t[5]||(t[5]=a=>$.value=!$.value)}," + Add Tasks ")])]),B(O,{name:"slide-down"},{default:z(()=>[$.value?(o(),l("div",wt,[e("div",bt,[Ys(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>T.value=a),class:"picker-search",placeholder:"Search your tasksâ€¦",autofocus:""},null,512),[[Qs,T.value]]),t[12]||(t[12]=e("span",{class:"picker-hint"},"Click to select, then Add",-1)),e("button",{class:"btn-primary btn-sm",disabled:g.value.size===0,onClick:Ws}," Add"+r(g.value.size>0?` (${g.value.size})`:""),9,mt),e("button",{class:"btn-ghost btn-sm",onClick:t[7]||(t[7]=a=>{$.value=!1,g.value=new Set})},"âœ•")]),E.value?(o(),l("div",_t,"Loading your tasksâ€¦")):as.value.length===0?(o(),l("div",Ct,[T.value?(o(),l("span",Dt,'No tasks match "'+r(T.value)+'"',1)):(o(),l("span",xt,"All your active tasks are already in today's log! ðŸŽ‰"))])):(o(),l("div",St,[(o(!0),l(w,null,F(as.value,a=>{var d,n;return o(),l("div",{key:a.id,class:b(["picker-task",{selected:g.value.has(a.id)}]),onClick:y=>Rs(a.id)},[e("div",{class:b(["picker-check",{checked:g.value.has(a.id)}])},[g.value.has(a.id)?(o(),l("svg",Tt,t[13]||(t[13]=[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)]))):c("",!0)],2),e("div",$t,[e("div",It,r(a.name),1),e("div",At,[(n=(d=a.milestone)==null?void 0:d.project)!=null&&n.name?(o(),l("span",Lt,r(a.milestone.project.name),1)):c("",!0),a.priority?(o(),l("span",{key:1,class:b(["tag",`prio-${a.priority}`])},r(a.priority),3)):c("",!0),e("span",{class:"tag",style:K({background:A(a.status).bg,color:A(a.status).color,border:`1px solid ${A(a.status).border}`})},r(a.status),5)])])],10,Pt)}),128))]))])):c("",!0)]),_:1}),e("div",jt,[q.value?(o(),l("div",Bt,[(o(),l(w,null,F(3,a=>e("div",{class:"skeleton",key:a})),64))])):p.value.length===0?(o(),l("div",Ft,[t[14]||(t[14]=e("div",{class:"empty-icon"},"ðŸ“‹",-1)),t[15]||(t[15]=e("h3",null,"No tasks planned for this day",-1)),t[16]||(t[16]=e("p",null,"Add tasks from your assigned list and drag them into your preferred work order.",-1)),e("button",{class:"btn-primary",onClick:t[8]||(t[8]=a=>$.value=!0)},"+ Plan Your Day")])):(o(),l("ul",Nt,[(o(!0),l(w,null,F(p.value,a=>{var d,n,y,k,S,_,vs;return o(),l("li",{key:a.id,class:b(["task-card",{"is-done":a.status==="completed","is-pushed":a.status==="pushed_to_next_day","is-active":v(a)==="In Progress",dragging:L.value===a.id,"drag-over":H.value===a.id}]),draggable:"true",onDragstart:C=>Hs(a),onDragover:C=>Ms(a,C),onDrop:C=>zs(a,C),onDragend:Os},[t[31]||(t[31]=Ks('<div class="drag-handle" data-v-4b1f7c03><svg viewBox="0 0 16 24" fill="currentColor" width="10" height="16" data-v-4b1f7c03><circle cx="5" cy="4" r="2" data-v-4b1f7c03></circle><circle cx="11" cy="4" r="2" data-v-4b1f7c03></circle><circle cx="5" cy="12" r="2" data-v-4b1f7c03></circle><circle cx="11" cy="12" r="2" data-v-4b1f7c03></circle><circle cx="5" cy="20" r="2" data-v-4b1f7c03></circle><circle cx="11" cy="20" r="2" data-v-4b1f7c03></circle></svg></div>',1)),v(a)==="In Progress"?(o(),l("div",Ht,t[17]||(t[17]=[e("span",{class:"pulse-dot"},null,-1)]))):c("",!0),e("div",Mt,[e("div",{class:b(["task-name cursor-pointer hover:text-indigo-600 transition-colors",{"line-through":rs(a)}]),onClick:C=>Ns(a.task)},r((d=a.task)==null?void 0:d.name),11,zt),e("div",Ot,[(k=(y=(n=a.task)==null?void 0:n.milestone)==null?void 0:y.project)!=null&&k.name?(o(),l("span",Ut,r(a.task.milestone.project.name),1)):c("",!0),(_=(S=a.task)==null?void 0:S.milestone)!=null&&_.name?(o(),l("span",Rt,r(a.task.milestone.name),1)):c("",!0),(vs=a.task)!=null&&vs.priority?(o(),l("span",{key:2,class:b(["tag",`prio-${a.task.priority}`])},r(a.task.priority),3)):c("",!0),e("span",{class:"tag task-status-tag",style:K({background:A(v(a)).bg,color:A(v(a)).color,border:`1px solid ${A(v(a)).border}`})},r(v(a)),5),e("span",{class:b(["tag",`log-${a.status}`])},r(us(a.status)),3)]),a.status!=="completed"&&a.status!=="pushed_to_next_day"?(o(),l("div",Wt,[v(a)==="To Do"?(o(),l(w,{key:0},[t[18]||(t[18]=i(" â„¹ï¸ Hit ",-1)),t[19]||(t[19]=e("strong",null,"Start",-1)),t[20]||(t[20]=i(" to begin tracking time on this task. ",-1))],64)):v(a)==="In Progress"?(o(),l(w,{key:1},[t[21]||(t[21]=i(" ðŸŸ¢ Task is running â€” hit ",-1)),t[22]||(t[22]=e("strong",null,"Pause",-1)),t[23]||(t[23]=i(" if you're stepping away, or ",-1)),t[24]||(t[24]=e("strong",null,"Complete",-1)),t[25]||(t[25]=i(" when done. ",-1))],64)):v(a)==="Paused"?(o(),l(w,{key:2},[t[26]||(t[26]=i(" â¸ Paused â€” hit ",-1)),t[27]||(t[27]=e("strong",null,"Resume",-1)),t[28]||(t[28]=i(" when you're ready to continue. ",-1))],64)):v(a)==="Blocked"?(o(),l(w,{key:3},[i(" ðŸ”´ This task is blocked. Unblock it in the task detail before starting. ")],64)):c("",!0)])):c("",!0)]),e("div",qt,[Ds(a)?(o(),l("div",Et)):(o(),l(w,{key:1},[e("button",{class:"btn-lifecycle",disabled:j(a).disabled||v(a)==="Blocked",style:K(Us(a)),onClick:C=>Is(a),title:j(a).label},r(j(a).label),13,Gt),a.status==="pending"?(o(),l("button",{key:0,class:"btn-icon push-btn",title:"Push to tomorrow",onClick:C=>Bs(a)},t[29]||(t[29]=[e("svg",{viewBox:"0 0 20 20",fill:"currentColor",width:"14",height:"14"},[e("path",{"fill-rule":"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,Yt)):c("",!0),e("button",{class:"btn-icon note-btn",title:"Add Note",onClick:C=>Vs(a.task)},t[30]||(t[30]=[e("span",{style:{"font-size":"14px"}},"ðŸ“",-1)]),8,Qt),e("button",{class:"btn-icon remove-btn",title:"Remove from today's log",onClick:C=>Fs(a)},"âœ•",8,Jt)],64))])],42,Vt)}),128))])),p.value.length>0?(o(),l("div",Kt,[G.value?(o(),l("span",Xt,"Saving orderâ€¦")):(o(),l("span",Zt,"Drag to reorder â€¢ Changes are saved automatically"))])):c("",!0)]),B(O,{name:"fade"},{default:z(()=>{var a,d;return[x.value.show?(o(),l("div",{key:0,class:"modal-overlay",onClick:Js(is,["self"])},[e("div",se,[t[34]||(t[34]=e("div",{class:"warn-modal-icon"},"âš ï¸",-1)),t[35]||(t[35]=e("h3",{class:"warn-modal-title"},"Task hasn't been started yet",-1)),e("p",te,[e("strong",null,r((d=(a=x.value.item)==null?void 0:a.task)==null?void 0:d.name),1),t[32]||(t[32]=i(" is currently ",-1)),e("em",null,r(v(x.value.item)),1),t[33]||(t[33]=i(". ",-1))]),t[36]||(t[36]=e("p",{class:"warn-modal-body"},[i(" Our workflow requires you to "),e("strong",null,"start"),i(" a task before marking it complete â€” this helps track time accurately and keeps the team informed. ")],-1)),t[37]||(t[37]=e("div",{class:"warn-tips"},[e("div",{class:"warn-tip"},[i("âœ… "),e("strong",null,"Best practice:"),i(" Start â†’ work on the task â†’ Pause if interrupted â†’ Complete when done.")]),e("div",{class:"warn-tip"},[i("âš¡ "),e("strong",null,"Quick option:"),i(" If you've already finished this task, we can start & complete it now â€” but please use proper start/pause/complete going forward.")])],-1)),e("div",{class:"warn-modal-actions"},[e("button",{class:"btn-outline",onClick:is},"Go back â€” I'll start it first"),e("button",{class:"btn-warn-ok",onClick:$s},"Mark as complete anyway")])])])):c("",!0)]}),_:1}),B(O,{name:"slide-down"},{default:z(()=>[f.value?(o(),l("div",ee,[t[38]||(t[38]=e("h3",{class:"history-title"},"ðŸ“… Past 14 Days â€” Task Log",-1)),t[39]||(t[39]=e("p",{class:"history-sub"},"Track patterns: tasks pushed repeatedly may need re-prioritisation or support.",-1)),ls.value.length===0?(o(),l("div",ae,"No history yet â€” come back after your first day!")):c("",!0),(o(!0),l(w,null,F(ls.value,([a,d])=>(o(),l("div",{key:a,class:"history-day"},[e("div",oe,[e("span",le,r(ss(a)),1),e("div",ne,[e("span",re,r(d.filter(n=>n.status==="completed").length)+" done",1),d.filter(n=>n.status==="pending").length?(o(),l("span",ie,r(d.filter(n=>n.status==="pending").length)+" unfinished ",1)):c("",!0),d.filter(n=>n.status==="pushed_to_next_day").length?(o(),l("span",de,r(d.filter(n=>n.status==="pushed_to_next_day").length)+" pushed ",1)):c("",!0)])]),e("ul",ce,[(o(!0),l(w,null,F(d,n=>{var y,k,S,_;return o(),l("li",{key:n.id,class:b(["history-item",`his-${n.status}`])},[e("span",{class:b(["h-dot",`hdot-${n.status}`])},null,2),e("span",ue,r((y=n.task)==null?void 0:y.name),1),(_=(S=(k=n.task)==null?void 0:k.milestone)==null?void 0:S.project)!=null&&_.name?(o(),l("span",pe,r(n.task.milestone.project.name),1)):c("",!0),e("span",{class:b(["tag",`log-${n.status}`]),style:{"font-size":".65rem"}},r(us(n.status)),3)],2)}),128))])]))),128))])):c("",!0)]),_:1}),N.value?(o(),Gs(Zs,{key:0,show:N.value,"task-for-note":Q.value,onClose:t[9]||(t[9]=a=>{N.value=!1,Q.value=null}),onNoteAdded:M},null,8,["show","task-for-note"])):c("",!0)]))}},Se=at(ve,[["__scopeId","data-v-4b1f7c03"]]);export{Se as default};
