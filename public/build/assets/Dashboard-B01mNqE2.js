import{a as Q,f as q,_ as J}from"./AuthenticatedLayout-o7cv2_eS.js";import{s as S,i as s,g as j,o as t,b as e,t as r,e as T,a as P,m as M,r as d,K as I,B as z,J as K,p as L,F as N,x as V,I as E,j as F,h as W,n as Y,V as R,c as G,y as X}from"./app-BUJGx-PL.js";import{_ as Z,a as ee,b as te}from"./TaskList-BJFDmA0h.js";import{P as O}from"./PrimaryButton-C6ule55S.js";import{_ as H}from"./InputError-OPji2r2O.js";import"./SecondaryButton-DHOHjNsi.js";import"./InputLabel-BM29aa35.js";import"./Checkbox-6RWnR6K5.js";import"./ApplicationLogo-DShdDr1f.js";import"./DangerButton-DQkpMdFT.js";const se={key:0,class:"bg-amber-50 border-l-4 border-amber-500 p-4 mb-6 rounded-md shadow-md"},ae={class:"flex items-center justify-between"},oe={class:"flex items-center"},ne={class:"ml-3"},le={class:"text-sm text-amber-800 font-medium"},re={key:0},ie={key:1},de={key:2},ue={__name:"TaskNotificationPrompt",props:{overdueTasks:{type:Number,required:!0},dueTodayTasks:{type:Number,required:!0}},emits:["view-tasks"],setup(y,{emit:h}){const i=y,u=h,o=S(()=>i.overdueTasks+i.dueTodayTasks),m=S(()=>o.value>0),v=()=>{u("view-tasks")};return(p,k)=>m.value?(t(),s("div",se,[e("div",ae,[e("div",oe,[k[0]||(k[0]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-amber-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",ne,[e("p",le,[y.overdueTasks>0&&y.dueTodayTasks>0?(t(),s("span",re," You have "+r(y.overdueTasks)+" overdue "+r(y.overdueTasks===1?"task":"tasks")+" and "+r(y.dueTodayTasks)+" "+r(y.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):y.overdueTasks>0?(t(),s("span",ie," You have "+r(y.overdueTasks)+" overdue "+r(y.overdueTasks===1?"task":"tasks")+" that require your attention. ",1)):y.dueTodayTasks>0?(t(),s("span",de," You have "+r(y.dueTodayTasks)+" "+r(y.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):j("",!0)])])]),e("div",null,[T(O,{onClick:v,class:"px-4 py-2 text-sm bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"},{default:P(()=>k[1]||(k[1]=[M(" View ",-1)])),_:1,__:[1]})])])])):j("",!0)}},ce={class:"flex items-center justify-between flex-wrap gap-4"},me={class:"flex-shrink-0 flex items-center"},ve={key:0,class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},pe={key:1,class:"h-6 w-6 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},ge={class:"flex-shrink-0 mt-3 sm:mt-0"},xe={key:1,class:"text-center text-sm text-gray-500 py-4"},fe={key:2,class:"text-center text-sm text-red-500 py-4"},ye={__name:"AvailabilityPrompt",setup(y){const h=d(!1),i=d(!0),u=d([]),o=d(!1),m=d(""),v=d(!1),p=d(!1),k=d(null),w=d(!1),f=S(()=>{var g;return((g=I().props.auth.user)==null?void 0:g.id)||null}),n=()=>{const g=localStorage.getItem("authToken");g&&!V.defaults.headers.common.Authorization&&(V.defaults.headers.common.Authorization=`Bearer ${g}`,console.log("Auth headers set in AvailabilityPrompt"))},l=async()=>{i.value=!0,m.value="";try{n();const g=await V.get("/api/availability-prompt");h.value=g.data.should_show_prompt,v.value=g.data.should_block_user,p.value=g.data.all_next_weekdays_covered,k.value=g.data.current_day,w.value=g.data.is_thursday_to_saturday,h.value&&c(g.data.next_week_start,g.data.next_week_end),localStorage.setItem("shouldBlockUser",v.value),localStorage.setItem("allNextWeekdaysCovered",p.value);const D=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:v.value,allNextWeekdaysCovered:p.value}});window.dispatchEvent(D)}catch(g){console.error("Error checking availability prompt:",g),h.value=!1,g.response&&g.response.status===401?m.value="Authentication error. Please refresh the page or log in again.":m.value="Failed to load availability prompt status."}finally{i.value=!1}},c=(g,D)=>{const U=[],_=new Date(g),$=new Date(D);let A=new Date(_);for(;A<=$;)U.push({value:A.toISOString().split("T")[0],label:A.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),A.setDate(A.getDate()+1);u.value=U},a=()=>{o.value=!0},x=()=>{l()},C=()=>{document.visibilityState==="visible"&&E(()=>{l()})},b=g=>{(g.key==="shouldBlockUser"||g.key==="allNextWeekdaysCovered")&&E(()=>{l()})};return z(()=>{l(),document.addEventListener("visibilitychange",C),window.addEventListener("storage",b)}),K(()=>{document.removeEventListener("visibilitychange",C),window.removeEventListener("storage",b)}),(g,D)=>(t(),s(N,null,[h.value&&!i.value&&!m.value?(t(),s("div",{key:0,class:L(["border-l-4 p-4 mb-6 rounded-md shadow-sm transition-all duration-300",v.value?"bg-red-50 border-red-500":"bg-indigo-50 border-indigo-500"])},[e("div",ce,[e("div",me,[v.value?(t(),s("svg",ve,D[1]||(D[1]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(t(),s("svg",pe,D[2]||(D[2]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)]))),e("p",{class:L(["ml-3 text-sm font-medium",v.value?"text-red-800":"text-indigo-800"])},[v.value?(t(),s(N,{key:0},[D[3]||(D[3]=e("span",{class:"font-bold"},"Action Required:",-1)),D[4]||(D[4]=M(" You must submit your availability for all weekdays of next week to unlock all features. ",-1))],64)):p.value?(t(),s(N,{key:2},[M(" Thank you for submitting your availability for next week! You can still update it if needed. ")],64)):(t(),s(N,{key:1},[M(" Please submit your availability for next week. This helps in planning meetings and work schedules. ")],64))],2)]),e("div",ge,[T(O,{onClick:a,class:L(["whitespace-nowrap px-6 py-2 text-sm font-semibold rounded-md shadow-md",{"bg-red-600 hover:bg-red-700 focus:ring-red-500":v.value,"bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500":!v.value&&!p.value,"bg-green-600 hover:bg-green-700 focus:ring-green-500":!v.value&&p.value}])},{default:P(()=>[M(r(p.value?"Update Availability":"Submit Availability"),1)]),_:1},8,["class"])])])],2)):i.value?(t(),s("div",xe,"Loading availability prompt...")):m.value?(t(),s("div",fe,r(m.value),1)):j("",!0),T(Q,{show:o.value,"next-week-dates":u.value,date:u.value.length>0?u.value[0].value:"",userId:f.value,onClose:D[0]||(D[0]=U=>o.value=!1),onAvailabilitySaved:x},null,8,["show","next-week-dates","date","userId"])],64))}},he={class:"md:col-span-2 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg shadow-xl p-8 text-white flex flex-col sm:flex-row items-center justify-between transition-all duration-300 hover:shadow-2xl"},we={class:"text-3xl font-bold mb-2"},be={class:"mt-6 sm:mt-0 sm:ml-8 text-center sm:text-right"},_e={class:"text-5xl font-extrabold"},ke={__name:"WelcomeCard",props:{projectCount:Number},setup(y){const h=S(()=>I().props.auth.user),i=y;return(u,o)=>(t(),s("div",he,[e("div",null,[e("h3",we,"Hello, "+r(h.value.name)+"!",1),o[0]||(o[0]=e("p",{class:"text-md opacity-90"},"Here's a quick overview of your activities and progress.",-1))]),e("div",be,[e("p",_e,r(i.projectCount),1),o[1]||(o[1]=e("p",{class:"text-sm opacity-90"},"Total Projects",-1))])]))}},$e={class:"bg-white rounded-lg shadow-xl p-8 flex flex-col justify-between transition-all duration-300 hover:shadow-2xl"},Te={class:"flex items-center justify-between"},Ce={class:"text-5xl font-extrabold text-indigo-600"},De={__name:"PendingTasksCard",props:{"total-due-tasks":{type:Number,default:0}},setup(y){const h=y;return(i,u)=>(t(),s("div",$e,[u[1]||(u[1]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-4"},"Pending Tasks",-1)),e("div",Te,[e("p",Ce,r(h["total-due-tasks"]),1),u[0]||(u[0]=e("svg",{class:"w-12 h-12 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})],-1))]),u[2]||(u[2]=e("p",{class:"text-sm text-gray-600 mt-4"},"Tasks currently due across all your projects.",-1))]))}},je={class:"md:col-span-3 bg-white overflow-hidden shadow-xl sm:rounded-lg p-8 transition-all duration-300 hover:shadow-2xl"},Se={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-5 gap-4"},Ae={class:"text-3xl font-bold text-amber-600 mb-2"},Me={class:"text-3xl font-bold text-red-600 mb-2"},Ne={class:"bg-blue-50 rounded-lg p-4 flex flex-col items-center justify-center border border-blue-200 hover:shadow-md transition-all cursor-pointer"},Ve={class:"text-3xl font-bold text-blue-600 mb-2"},Pe={key:0,class:"text-3xl font-bold text-purple-600 mb-2 opacity-50"},ze={key:1,class:"text-3xl font-bold text-purple-600 mb-2"},Le={class:"bg-green-50 rounded-lg p-4 flex flex-col items-center justify-center border border-green-200 hover:shadow-md transition-all"},Ue={key:0,class:"text-3xl font-bold text-green-600 mb-2 opacity-50"},Be={key:1,class:"text-3xl font-bold text-green-600 mb-2"},Ee={__name:"DashboardOverviewCard",props:{dueTodayTasksCount:{type:Number,default:0},overdueTasksCount:{type:Number,default:0}},emits:["view-tasks","view-meetings"],setup(y,{emit:h}){const i=h,u=d(0),o=d(!0),m=d(0),v=d(0),p=d(!0),k=S(()=>I().props.auth.user),w=async()=>{o.value=!0;try{const c=new Date().toISOString().split("T")[0],a=await V.get("/api/user/meetings",{params:{date:c}});u.value=a.data.length}catch(c){console.error("Error fetching meetings:",c)}finally{o.value=!1}},f=async()=>{p.value=!0;try{const c=new Date().toISOString().split("T")[0],a=await V.get("/api/project-notes",{params:{type:"standup",date:c,user_id:k.value.id}});v.value=a.data.length}catch(c){console.error("Error fetching standups:",c)}finally{p.value=!1}},n=()=>{i("view-tasks")},l=()=>{i("view-meetings")};return z(()=>{w(),f()}),(c,a)=>(t(),s("div",je,[a[10]||(a[10]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-6"},"Today's Overview",-1)),e("div",Se,[e("div",{class:"bg-amber-50 rounded-lg p-4 flex flex-col items-center justify-center border border-amber-200 hover:shadow-md transition-all cursor-pointer",onClick:n},[e("div",Ae,r(y.dueTodayTasksCount),1),a[0]||(a[0]=e("div",{class:"text-sm text-gray-700 text-center"},"Tasks Due Today",-1)),a[1]||(a[1]=e("div",{class:"mt-2 text-xs text-amber-600 hover:underline"},"View Tasks",-1))]),e("div",{class:"bg-red-50 rounded-lg p-4 flex flex-col items-center justify-center border border-red-200 hover:shadow-md transition-all cursor-pointer",onClick:n},[e("div",Me,r(y.overdueTasksCount),1),a[2]||(a[2]=e("div",{class:"text-sm text-gray-700 text-center"},"Overdue Tasks",-1)),a[3]||(a[3]=e("div",{class:"mt-2 text-xs text-red-600 hover:underline"},"View Tasks",-1))]),e("div",Ne,[e("div",Ve,r(m.value),1),a[4]||(a[4]=e("div",{class:"text-sm text-gray-700 text-center"},"Unread Emails",-1)),a[5]||(a[5]=e("div",{class:"mt-2 text-xs text-blue-600 hover:underline"},"Coming Soon",-1))]),e("div",{class:"bg-purple-50 rounded-lg p-4 flex flex-col items-center justify-center border border-purple-200 hover:shadow-md transition-all cursor-pointer",onClick:l},[o.value?(t(),s("div",Pe,"...")):(t(),s("div",ze,r(u.value),1)),a[6]||(a[6]=e("div",{class:"text-sm text-gray-700 text-center"},"Meetings Today",-1)),a[7]||(a[7]=e("div",{class:"mt-2 text-xs text-purple-600 hover:underline"},"View Meetings",-1))]),e("div",Le,[p.value?(t(),s("div",Ue,"...")):(t(),s("div",Be,r(v.value),1)),a[8]||(a[8]=e("div",{class:"text-sm text-gray-700 text-center"},"Standups Today",-1)),a[9]||(a[9]=e("div",{class:"mt-2 text-xs text-green-600"},"Your Updates",-1))])])]))}},Oe={class:"md:col-span-3 bg-white overflow-hidden shadow-xl sm:rounded-lg p-8 transition-all duration-300 hover:shadow-2xl"},Ie={class:"mb-6 text-md text-gray-600"},Fe={class:"font-semibold text-indigo-700"},We={key:0,class:"text-center text-sm text-gray-500 py-6"},Ye={key:1,class:"text-center text-sm text-red-500 py-6"},Re={key:2,class:"text-center text-sm text-gray-500 py-6"},He={key:3,class:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-7 gap-4 mt-4"},Qe={class:"text-sm font-bold text-gray-800"},qe={class:"text-xs text-gray-600 mt-0.5"},Je={class:"mt-3 text-center text-xs w-full"},Ke={key:0,class:"text-gray-600 leading-tight mt-1"},Ge={key:0,class:"text-gray-600 leading-tight mt-1 break-words"},Xe={key:2,class:"text-gray-500 font-medium"},Ze={__name:"WeeklyAvailabilityCard",setup(y){const h=S(()=>I().props.auth.user),i=d({availabilities:[],start_date:"",end_date:""}),u=d(!1),o=d(""),m=n=>n?new Date(n).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"",v=async()=>{u.value=!0,o.value="";try{const n=new Date,l=new Date(n);l.setDate(n.getDate()-n.getDay()+(n.getDay()===0?-6:1));const c=new Date(l);c.setDate(l.getDate()+6);const a=C=>C.toISOString().split("T")[0],x=await V.get("/api/availabilities",{params:{user_id:h.value.id,start_date:a(l),end_date:a(c)}});i.value=x.data}catch(n){o.value="Failed to load availability data",console.error("Error fetching weekly availability:",n)}finally{u.value=!1}},p=n=>["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][n-1],k=n=>{const l=new Date(i.value.start_date);return l.setDate(l.getDate()+n-1),l.toLocaleDateString("en-US",{month:"short",day:"numeric"})},w=n=>{const l=new Date(i.value.start_date);l.setDate(l.getDate()+n-1);const c=l.toISOString().split("T")[0],a=i.value.availabilities.filter(b=>b.date.split("T")[0]===c);if(a.length===0)return{status:"not-set"};if(a.some(b=>!b.is_available)){const b=a.find(g=>!g.is_available);return{status:"unavailable",reason:(b==null?void 0:b.reason)||"Not specified"}}const C=[];return a.forEach(b=>{b.is_available&&b.time_slots&&Array.isArray(b.time_slots)&&b.time_slots.forEach(g=>{C.push(`${g.start_time} - ${g.end_time}`)})}),{status:"available",slots:C.length>0?C:["All Day"]}},f=n=>{const l=w(n);let c="";l.status==="available"?c="border-green-300 bg-green-50/50":l.status==="unavailable"?c="border-red-300 bg-red-50/50":c="border-gray-200 bg-gray-50";const a=new Date,x=new Date(i.value.start_date);return x.setDate(x.getDate()+n-1),a.toDateString()===x.toDateString()&&(c+=" ring-2 ring-indigo-500 ring-offset-2"),c};return z(()=>{v()}),(n,l)=>(t(),s("div",Oe,[l[3]||(l[3]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-4"},"Your Weekly Availability",-1)),e("p",Ie,[l[0]||(l[0]=M(" Availability for: ",-1)),e("span",Fe,r(i.value.start_date?m(i.value.start_date):"")+" to "+r(i.value.end_date?m(i.value.end_date):""),1)]),u.value?(t(),s("div",We,"Loading availability data...")):o.value?(t(),s("div",Ye,r(o.value),1)):!i.value.availabilities||i.value.availabilities.length===0?(t(),s("div",Re," No availability data found for this week. ")):(t(),s("div",He,[(t(),s(N,null,F(7,c=>e("div",{key:"availability-day-"+c,class:L(["flex flex-col items-center justify-start p-4 border rounded-lg shadow-sm h-36 overflow-hidden text-clip relative group",f(c)])},[e("span",Qe,r(p(c)),1),e("span",qe,r(k(c)),1),e("div",Je,[w(c).status==="available"?(t(),s(N,{key:0},[l[1]||(l[1]=e("p",{class:"text-green-700 font-bold"},"Available",-1)),w(c).slots.length>0?(t(),s("p",Ke,r(w(c).slots.join(", ")),1)):j("",!0)],64)):w(c).status==="unavailable"?(t(),s(N,{key:1},[l[2]||(l[2]=e("p",{class:"text-red-700 font-bold"},"Unavailable",-1)),w(c).reason?(t(),s("p",Ge," Reason: "+r(w(c).reason),1)):j("",!0)],64)):(t(),s("p",Xe,"Not Set"))])],2)),64))]))]))}},et={class:"md:col-span-3 bg-white overflow-hidden shadow-xl sm:rounded-lg p-8 transition-all duration-300 hover:shadow-2xl"},tt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6"},st={key:0,class:"mt-4"},at={class:"mb-6"},ot={key:0,class:"text-center text-sm text-red-500 py-6"},nt={key:1,class:"text-center text-sm text-gray-500 py-6"},lt={key:2,class:"mt-3 overflow-x-auto rounded-lg border border-gray-200 shadow-sm relative"},rt={key:0,class:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg z-10"},it={class:"min-w-full divide-y divide-gray-200"},dt={class:"bg-white divide-y divide-gray-200"},ut={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},ct={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-600"},mt={class:"px-4 py-3 whitespace-nowrap text-sm"},vt={class:"px-4 py-3 whitespace-nowrap text-sm"},pt={class:"flex space-x-2"},gt={__name:"ProjectsCard",props:{projectCount:Number},emits:["open-notes-modal","open-standup-modal"],setup(y,{emit:h}){const i=h,u=d([]),o=d(!0),m=d(""),v=d(!1),p=d(""),k=S(()=>{if(!p.value)return u.value;const a=p.value.toLowerCase();return u.value.filter(x=>x.name.toLowerCase().includes(a)||x.user_role&&x.user_role.toLowerCase().includes(a)||x.status.toLowerCase().includes(a.replace(" ","_")))}),w=()=>{v.value=!v.value,v.value&&u.value.length===0&&f()},f=async()=>{o.value=!0,m.value="";try{const a=await V.get("/api/projects-simplified");u.value=a.data}catch(a){m.value="Failed to load projects",console.error("Error fetching projects:",a)}finally{o.value=!1}},n=a=>{switch(a){case"active":return"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 capitalize";case"pending":return"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 capitalize";case"on_hold":return"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 capitalize";default:return"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 capitalize"}},l=a=>{i("open-notes-modal",a)},c=a=>{i("open-standup-modal",a)};return(a,x)=>(t(),s("div",et,[e("div",tt,[x[1]||(x[1]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2 sm:mb-0"},"Your Projects",-1)),e("button",{onClick:w,class:"inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition ease-in-out duration-150 w-48"},r(v.value?"Collapse Projects":"View My Projects ("+y.projectCount+")"),1)]),v.value?(t(),s("div",st,[e("div",at,[T(H,{modelValue:p.value,"onUpdate:modelValue":x[0]||(x[0]=C=>p.value=C),placeholder:"Search projects by name, role, or status...",class:"w-full",disabled:o.value},null,8,["modelValue","disabled"])]),m.value?(t(),s("div",ot,r(m.value),1)):k.value.length===0&&!o.value?(t(),s("div",nt,"No projects found matching your search.")):(t(),s("div",lt,[o.value?(t(),s("div",rt,x[2]||(x[2]=[e("svg",{class:"animate-spin h-8 w-8 text-indigo-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("span",{class:"ml-3 text-indigo-700"},"Loading projects...",-1)]))):j("",!0),e("table",it,[x[6]||(x[6]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Project Name"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Your Role"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",dt,[(t(!0),s(N,null,F(k.value,C=>(t(),s("tr",{key:C.id,class:"hover:bg-gray-50 transition-colors duration-100"},[e("td",ut,r(C.name),1),e("td",ct,r(C.user_role||"N/A"),1),e("td",mt,[e("span",{class:L(n(C.status))},r(C.status.replace("_"," ")),3)]),e("td",vt,[e("div",pt,[T(W(Y),{href:`/projects/${C.id}`,class:"inline-flex items-center px-3 py-1 border border-transparent text-xs leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:border-indigo-700 focus:ring active:bg-indigo-700 transition ease-in-out duration-150"},{default:P(()=>x[3]||(x[3]=[M(" View ",-1)])),_:2,__:[3]},1032,["href"]),T(O,{onClick:b=>l(C.id),class:"px-3 py-1 text-xs leading-4 bg-purple-600 hover:bg-purple-700"},{default:P(()=>x[4]||(x[4]=[M(" Notes ",-1)])),_:2,__:[4]},1032,["onClick"]),T(O,{onClick:b=>c(C.id),class:"px-3 py-1 text-xs leading-4 bg-green-600 hover:bg-green-700"},{default:P(()=>x[5]||(x[5]=[M(" Standup ",-1)])),_:2,__:[5]},1032,["onClick"])])])]))),128))])])]))])):j("",!0)]))}},xt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6"},ft={class:"flex space-x-4 mt-2"},yt={class:"flex items-center"},ht={class:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-red-100 text-red-800 font-medium text-xs mr-2"},wt={class:"flex items-center"},bt={class:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-yellow-100 text-yellow-800 font-medium text-xs mr-2"},_t={class:"flex items-center"},kt={class:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-green-100 text-green-800 font-medium text-xs mr-2"},$t={class:"flex items-center space-x-4"},Tt={key:0,class:"text-sm text-amber-600 font-medium"},Ct={key:0,class:"mt-4"},Dt={key:0,class:"text-center text-sm text-red-500 py-6"},jt={key:1,class:"text-center text-sm text-gray-500 py-6"},St={key:2,class:"relative"},At={key:0,class:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg z-10"},Mt={__name:"AssignedTasksCard",props:{},emits:["view-due-overdue-tasks","task-counts-updated"],setup(y,{expose:h,emit:i}){const u=i,o=d([]),m=d(!0),v=d(""),p=d(!1),k=d(""),w=d("all"),f=async()=>{m.value=!0,v.value="";try{o.value=await q(),u("task-counts-updated",{overdue:C.value,dueToday:b.value})}catch(_){v.value="Failed to load assigned tasks",console.error("Error fetching assigned tasks:",_)}finally{m.value=!1}},n=S(()=>{if(!k.value)return o.value;const _=k.value.toLowerCase();return o.value.filter($=>{var A,B;return $.name.toLowerCase().includes(_)||((A=$.milestone)==null?void 0:A.name)&&$.milestone.name.toLowerCase().includes(_)||((B=$.project)==null?void 0:B.name)&&$.project.name.toLowerCase().includes(_)})}),l=S(()=>w.value==="due-overdue"?n.value.filter(_=>_.due_date&&new Date(_.due_date)<new Date||_.due_date&&new Date(_.due_date).toDateString()===new Date().toDateString()):n.value),c=()=>{p.value=!p.value,p.value&&o.value.length===0&&f()},a=async _=>{await f()},x=(_,$)=>{if($)R(_,$);else{const A=o.value.find(B=>B.id===_);A?R(_,A.project_id):console.error("Task not found and no projectId provided")}},C=S(()=>o.value.filter(_=>_.due_date&&new Date(_.due_date)<new Date).length),b=S(()=>o.value.filter(_=>_.due_date&&new Date(_.due_date).toDateString()===new Date().toDateString()).length),g=S(()=>o.value.filter(_=>_.status==="In Progress").length),D=d(null);return h({showDueOverdueTasksAndScroll:()=>{p.value=!0,w.value="due-overdue",o.value.length===0&&f(),E(()=>{D.value.scrollIntoView({behavior:"smooth"})})}}),z(()=>{f()}),(_,$)=>(t(),s("div",{ref_key:"assignedTasksRef",ref:D,class:"md:col-span-3 bg-white overflow-hidden shadow-xl sm:rounded-lg p-8 transition-all duration-300 hover:shadow-2xl"},[e("div",xt,[e("div",null,[$[4]||($[4]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Your Assigned Tasks",-1)),e("div",ft,[e("div",yt,[e("span",ht,r(C.value),1),$[1]||($[1]=e("span",{class:"text-sm text-gray-600"},"Overdue",-1))]),e("div",wt,[e("span",bt,r(b.value),1),$[2]||($[2]=e("span",{class:"text-sm text-gray-600"},"Due Today",-1))]),e("div",_t,[e("span",kt,r(g.value),1),$[3]||($[3]=e("span",{class:"text-sm text-gray-600"},"In Progress",-1))])])]),e("div",$t,[p.value&&w.value==="due-overdue"?(t(),s("div",Tt,[$[5]||($[5]=M(" Showing due and overdue tasks ",-1)),e("button",{onClick:$[0]||($[0]=A=>w.value="all"),class:"ml-2 text-blue-600 hover:text-blue-800 underline"}," Show all ")])):j("",!0),e("button",{onClick:c,class:"inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition ease-in-out duration-150 w-48"},r(p.value?"Collapse Tasks":"View My Tasks ("+o.value.length+")"),1)])]),p.value?(t(),s("div",Ct,[v.value?(t(),s("div",Dt,r(v.value),1)):o.value.length===0&&!m.value?(t(),s("div",jt,r(w.value==="due-overdue"?"No due or overdue tasks found.":"No assigned tasks found."),1)):(t(),s("div",St,[m.value?(t(),s("div",At,$[6]||($[6]=[e("svg",{class:"animate-spin h-8 w-8 text-purple-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("span",{class:"ml-3 text-purple-700"},"Loading assigned tasks...",-1)]))):j("",!0),T(Z,{tasks:l.value,"show-project-column":!0,onTaskUpdated:a,onOpenTaskDetail:x},null,8,["tasks"])]))])):j("",!0)],512))}},Nt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6"},Vt={key:0,class:"mt-4"},Pt={key:0,class:"text-center text-sm text-red-500 py-6"},zt={key:1,class:"text-center text-sm text-gray-500 py-6"},Lt={key:2,class:"mt-3 overflow-x-auto rounded-lg border border-gray-200 shadow-sm relative"},Ut={key:0,class:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg z-10"},Bt={class:"min-w-full divide-y divide-gray-200"},Et={class:"bg-white divide-y divide-gray-200"},Ot={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},It={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-600"},Ft={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-600"},Wt={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-600"},Yt={class:"px-4 py-3 whitespace-nowrap text-sm"},Rt={class:"flex space-x-2"},Ht=["href"],Qt={__name:"UpcomingMeetingsCard",setup(y,{expose:h}){const i=d([]),u=d(!0),o=d(""),m=d(!1),v=d(null),p=async()=>{u.value=!0,o.value="";try{const f=await V.get("/api/user/meetings");i.value=f.data}catch(f){o.value="Failed to load upcoming meetings",console.error("Error fetching upcoming meetings:",f)}finally{u.value=!1}},k=()=>{m.value=!m.value};return h({showMeetingsAndScroll:()=>{m.value=!0,p(),E(()=>{v.value.scrollIntoView({behavior:"smooth"})})}}),z(()=>{p()}),(f,n)=>(t(),s("div",{ref_key:"meetingsRef",ref:v,class:"md:col-span-3 bg-white overflow-hidden shadow-xl sm:rounded-lg p-8 transition-all duration-300 hover:shadow-2xl"},[e("div",Nt,[n[0]||(n[0]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2 sm:mb-0"},"Your Upcoming Meetings",-1)),e("button",{onClick:k,class:"inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition ease-in-out duration-150 w-48"},r(m.value?"Collapse Meetings":"View Meetings ("+i.value.length+")"),1)]),m.value?(t(),s("div",Vt,[o.value?(t(),s("div",Pt,r(o.value),1)):i.value.length===0&&!u.value?(t(),s("div",zt," No upcoming meetings found. You'll see meetings here when you're invited to one. ")):(t(),s("div",Lt,[u.value?(t(),s("div",Ut,n[1]||(n[1]=[e("svg",{class:"animate-spin h-8 w-8 text-purple-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("span",{class:"ml-3 text-purple-700"},"Loading meetings...",-1)]))):j("",!0),e("table",Bt,[n[3]||(n[3]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Meeting"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Project"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date & Time"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Organizer"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Et,[(t(!0),s(N,null,F(i.value,l=>{var c,a;return t(),s("tr",{key:l.id,class:"hover:bg-gray-50 transition-colors duration-100"},[e("td",Ot,r(l.summary),1),e("td",It,r(((c=l.project)==null?void 0:c.name)||"N/A"),1),e("td",Ft,r(new Date(l.start_time).toLocaleString()),1),e("td",Wt,r(((a=l.creator)==null?void 0:a.name)||"N/A"),1),e("td",Yt,[e("div",Rt,[l.google_meet_link?(t(),s("a",{key:0,href:l.google_meet_link,target:"_blank",class:"inline-flex items-center px-3 py-1 border border-transparent text-xs leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:border-green-700 focus:ring active:bg-green-700 transition ease-in-out duration-150"}," Join Meeting ",8,Ht)):j("",!0),l.project_id?(t(),G(W(Y),{key:1,href:`/projects/${l.project_id}`,class:"inline-flex items-center px-3 py-1 border border-transparent text-xs leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:border-indigo-700 focus:ring active:bg-indigo-700 transition ease-in-out duration-150"},{default:P(()=>n[2]||(n[2]=[M(" View Project ",-1)])),_:2,__:[2]},1032,["href"])):j("",!0)])])])}),128))])])]))])):j("",!0)],512))}},qt={class:"md:col-span-3 bg-white overflow-hidden shadow-xl sm:rounded-lg p-8 transition-all duration-300 hover:shadow-2xl"},Jt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6"},Kt={key:0,class:"mt-4"},Gt={class:"mb-6"},Xt={key:0,class:"text-center text-sm text-red-500 py-6"},Zt={key:1,class:"text-center text-sm text-gray-500 py-6"},es={key:2,class:"mt-3 overflow-x-auto rounded-lg border border-gray-200 shadow-sm relative"},ts={key:0,class:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg z-10"},ss={class:"min-w-full divide-y divide-gray-200"},as={class:"bg-white divide-y divide-gray-200"},os={class:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900"},ns={class:"px-4 py-3 whitespace-nowrap text-sm"},ls={class:"px-4 py-3 whitespace-nowrap text-sm"},rs={class:"px-4 py-3 whitespace-nowrap text-sm"},is={class:"px-4 py-3 whitespace-nowrap text-sm"},ds={class:"flex space-x-2"},us={__name:"DueTasksBreakdownCard",setup(y){const h=d({total_due_tasks:0,projects:[]}),i=d(!0),u=d(""),o=d(!1),m=d(""),v=S(()=>{if(!m.value)return h.value.projects;const w=m.value.toLowerCase();return h.value.projects.filter(f=>f.name.toLowerCase().includes(w))}),p=async()=>{i.value=!0,u.value="";try{const w=await V.get("/api/task-statistics");h.value=w.data}catch(w){u.value="Failed to load task statistics",console.error("Error fetching task statistics:",w)}finally{i.value=!1}},k=()=>{o.value=!o.value,o.value&&h.value.projects.length===0&&p()};return z(()=>{p()}),(w,f)=>(t(),s("div",qt,[e("div",Jt,[f[1]||(f[1]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2 sm:mb-0"},"Due Tasks Breakdown",-1)),e("button",{onClick:k,class:"inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition ease-in-out duration-150 w-48"},r(o.value?"Collapse Tasks":"My Task Summary"),1)]),o.value?(t(),s("div",Kt,[e("div",Gt,[T(H,{modelValue:m.value,"onUpdate:modelValue":f[0]||(f[0]=n=>m.value=n),placeholder:"Search tasks by project name...",class:"w-full",disabled:i.value},null,8,["modelValue","disabled"])]),u.value?(t(),s("div",Xt,r(u.value),1)):v.value.length===0&&!i.value?(t(),s("div",Zt,"No due tasks found matching your search.")):(t(),s("div",es,[i.value?(t(),s("div",ts,f[2]||(f[2]=[e("svg",{class:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("span",{class:"ml-3 text-blue-700"},"Loading tasks...",-1)]))):j("",!0),e("table",ss,[f[4]||(f[4]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Project Name"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Due"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Due Today"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned To Me"),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",as,[(t(!0),s(N,null,F(v.value,n=>(t(),s("tr",{key:n.id,class:"hover:bg-gray-50 transition-colors duration-100"},[e("td",os,r(n.name),1),e("td",ns,r(n.due_tasks),1),e("td",ls,r(n.due_today),1),e("td",rs,r(n.assigned_to_me),1),e("td",is,[e("div",ds,[T(W(Y),{href:`/projects/${n.id}`,class:"inline-flex items-center px-3 py-1 border border-transparent text-xs leading-4 font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:border-blue-700 focus:ring active:bg-blue-700 transition ease-in-out duration-150"},{default:P(()=>f[3]||(f[3]=[M(" View Project ",-1)])),_:2,__:[3]},1032,["href"])])])]))),128))])])]))])):j("",!0)]))}},cs={class:"md:col-span-3 bg-white overflow-hidden shadow-xl sm:rounded-lg p-8 transition-all duration-300 hover:shadow-2xl"},ms={__name:"NoticeBoardCard",setup(y){return(h,i)=>(t(),s("div",cs,i[0]||(i[0]=[e("h3",{class:"text-xl font-semibold text-gray-900 mb-4"},"Notice Board",-1),e("p",{class:"text-md text-gray-600"}," No new announcements at this time. Check back later for important updates! ",-1)])))}},vs={class:"py-12"},ps={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},gs={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},xs={class:"md:col-span-3"},Ds={__name:"Dashboard",props:{projectCount:Number},setup(y){const h=d(!1),i=d(null),u=d(!1),o=d(null),m=d(null),v=d(null),p=d(0),k=d(0),w=S(()=>p.value+k.value),f=({overdue:b,dueToday:g})=>{p.value=b,k.value=g};z(()=>{});const n=b=>{i.value=b,h.value=!0},l=()=>{},c=b=>{o.value=b,u.value=!0},a=()=>{u.value=!1},x=()=>{m.value&&m.value.showDueOverdueTasksAndScroll()},C=()=>{v.value&&v.value.showMeetingsAndScroll()};return(b,g)=>(t(),s(N,null,[T(W(X),{title:"Dashboard"}),T(J,null,{default:P(()=>[e("div",vs,[e("div",ps,[T(ue,{"overdue-tasks":p.value,"due-today-tasks":k.value,onViewTasks:x},null,8,["overdue-tasks","due-today-tasks"]),e("div",gs,[T(ke,{"project-count":y.projectCount},null,8,["project-count"]),T(De,{"total-due-tasks":w.value,onCardClicked:x},null,8,["total-due-tasks"]),e("div",xs,[T(ye)]),T(Ee,{"due-today-tasks-count":k.value,"overdue-tasks-count":p.value,onViewTasks:x,onViewMeetings:C},null,8,["due-today-tasks-count","overdue-tasks-count"]),T(Ze),T(Mt,{ref_key:"assignedTasksCardRef",ref:m,onTaskCountsUpdated:f},null,512),T(gt,{"project-count":y.projectCount,onOpenNotesModal:n,onOpenStandupModal:c},null,8,["project-count"]),T(Qt,{ref_key:"upcomingMeetingsCardRef",ref:v,class:"upcoming-meetings-card"},null,512),T(us),T(ms)])])]),T(ee,{show:h.value,"project-id":i.value,onClose:g[0]||(g[0]=D=>h.value=!1),onNoteAdded:l},null,8,["show","project-id"]),T(te,{show:u.value,"project-id":o.value,onClose:g[1]||(g[1]=D=>u.value=!1),onStandupAdded:a},null,8,["show","project-id"])]),_:1})],64))}};export{Ds as default};
