import{c as k,B as J,r as x,K as O,f as Q,a as u,o as i,d as l,u as R,h as W,w as r,b as s,i as y,m,t as c,F as B,l as X,g as F,y as P,x as V,A as $,p as E}from"./app-DNyLw3kL.js";import{_ as Z}from"./AuthenticatedLayout-2bGXdlTQ.js";import{P as N}from"./PrimaryButton-BqxAc8eF.js";import{D as j}from"./DangerButton-B7H3dFeC.js";import{_ as D}from"./Modal-LDWekqmT.js";import{_ as v}from"./InputLabel-aah-Wjzx.js";import{_ as w}from"./TextInput-25srFAic.js";import{_ as p}from"./InputError-hgXXzus2.js";import{_ as A}from"./SecondaryButton-D4V817Pp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SelectDropdown-CTk_771u.js";import"./Checkbox-Dj4QO9mJ.js";import"./ApplicationLogo-B-Pw6S0R.js";import"./moment-BLMuvzoS.js";const ee={class:"py-12"},se={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},le={class:"p-6 text-gray-900"},ae={key:0,class:"mb-6"},oe={key:1,class:"text-gray-600"},ne={key:2,class:"text-red-600"},de={key:3,class:"text-gray-600"},ie={key:4},re={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap"},ve={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4 whitespace-nowrap"},fe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ce={class:"flex items-center space-x-2"},ge={class:"p-6"},xe={key:0,class:"text-red-600 text-sm mb-4"},_e={class:"mb-4"},ye={class:"mb-4"},we={class:"mb-4"},be={class:"mb-4"},he={class:"mb-4"},Ce={class:"mt-6 flex justify-end"},ke={class:"p-6"},Ve={key:0,class:"text-red-600 text-sm mb-4"},$e={class:"mb-4"},Ee={class:"mb-4"},Ne={class:"mb-4"},Ue={class:"mb-4"},Me={class:"mb-4"},De={class:"mt-6 flex justify-end"},Ae={class:"p-6"},Be={key:0,class:"mt-4 text-gray-800"},Fe={key:1,class:"text-red-600 text-sm mb-4"},Pe={class:"mt-6 flex justify-end"},We={__name:"Index",setup(je){const f=k(()=>J().props.auth.user),g=x([]),U=x(!0),n=x({}),d=x(""),b=x(!1),h=x(!1),C=x(!1),a=O({id:null,name:"",email:"",phone:"",address:"",notes:""}),_=x(null),q=k(()=>{var t;return f.value?((t=f.value.role_data)==null?void 0:t.slug)==="super-admin"||f.value.role==="super_admin"||f.value.role==="super-admin":!1}),S=k(()=>{var t;return f.value?((t=f.value.role_data)==null?void 0:t.slug)==="manager"||f.value.role==="manager"||f.value.role==="manager-role"||f.value.role==="manager_role":!1}),M=k(()=>q.value||S.value),T=async()=>{U.value=!0,d.value="";try{const t=await E.get("/api/clients");g.value=t.data.data}catch(t){d.value="Failed to fetch clients.",console.error("Error fetching clients:",t),t.response&&t.response.status===403&&(d.value="You do not have permission to view clients.")}finally{U.value=!1}},L=()=>{a.id=null,a.name="",a.email="",a.phone="",a.address="",a.notes="",n.value={},d.value="",b.value=!0},I=async()=>{n.value={},d.value="";try{const t=await E.post("/api/clients",a);g.value.push(t.data.data),b.value=!1,alert("Client created successfully!")}catch(t){t.response&&t.response.status===422?n.value=t.response.data.errors:t.response&&t.response.data.message?d.value=t.response.data.message:(d.value="Failed to create client.",console.error("Error creating client:",t))}},K=t=>{a.id=t.id,a.name=t.name,a.email=t.email,a.phone=t.phone,a.address=t.address,a.notes=t.notes,n.value={},d.value="",h.value=!0},Y=async()=>{n.value={},d.value="";try{const t=await E.put(`/api/clients/${a.id}`,a),e=g.value.findIndex(o=>o.id===a.id);e!==-1&&(g.value[e]=t.data.data),h.value=!1,alert("Client updated successfully!")}catch(t){t.response&&t.response.status===422?n.value=t.response.data.errors:t.response&&t.response.data.message?d.value=t.response.data.message:(d.value="Failed to update client.",console.error("Error updating client:",t))}},z=t=>{_.value=t,C.value=!0},G=async()=>{d.value="";try{await E.delete(`/api/clients/${_.value.id}`),g.value=g.value.filter(t=>t.id!==_.value.id),C.value=!1,_.value=null,alert("Client deleted successfully!")}catch(t){d.value="Failed to delete client.",console.error("Error deleting client:",t)}};return Q(()=>{T()}),(t,e)=>(i(),u(B,null,[l(R(W),{title:"Clients"}),l(Z,null,{header:r(()=>e[16]||(e[16]=[s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Clients",-1)])),default:r(()=>[s("div",ee,[s("div",se,[s("div",te,[s("div",le,[e[21]||(e[21]=s("h3",{class:"text-2xl font-bold mb-4"},"Client List",-1)),M.value?(i(),u("div",ae,[l(N,{onClick:L},{default:r(()=>e[17]||(e[17]=[m(" Create New Client ",-1)])),_:1,__:[17]})])):y("",!0),U.value?(i(),u("div",oe,"Loading clients...")):d.value?(i(),u("div",ne,c(d.value),1)):g.value.length===0?(i(),u("div",de,"No clients found.")):(i(),u("div",ie,[s("table",re,[e[20]||(e[20]=s("thead",{class:"bg-gray-50"},[s("tr",null,[s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Phone"),s("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),s("tbody",ue,[(i(!0),u(B,null,X(g.value,o=>(i(),u("tr",{key:o.id},[s("td",me,c(o.name),1),s("td",ve,c(o.email),1),s("td",pe,c(o.phone||"N/A"),1),s("td",fe,[s("div",ce,[M.value?(i(),F(N,{key:0,onClick:H=>K(o)},{default:r(()=>e[18]||(e[18]=[m("Edit",-1)])),_:2,__:[18]},1032,["onClick"])):y("",!0),M.value?(i(),F(j,{key:1,onClick:H=>z(o)},{default:r(()=>e[19]||(e[19]=[m("Delete",-1)])),_:2,__:[19]},1032,["onClick"])):y("",!0)])])]))),128))])])]))])])])]),l(D,{show:b.value,onClose:e[6]||(e[6]=o=>b.value=!1)},{default:r(()=>[s("div",ge,[e[24]||(e[24]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Create New Client",-1)),d.value?(i(),u("div",xe,c(d.value),1)):y("",!0),s("form",{onSubmit:P(I,["prevent"])},[s("div",_e,[l(v,{for:"name",value:"Name"}),l(w,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.name=o),required:"",autofocus:""},null,8,["modelValue"]),l(p,{message:n.value.name?n.value.name[0]:"",class:"mt-2"},null,8,["message"])]),s("div",ye,[l(v,{for:"email",value:"Email"}),l(w,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:a.email,"onUpdate:modelValue":e[1]||(e[1]=o=>a.email=o),required:""},null,8,["modelValue"]),l(p,{message:n.value.email?n.value.email[0]:"",class:"mt-2"},null,8,["message"])]),s("div",we,[l(v,{for:"phone",value:"Phone"}),l(w,{id:"phone",type:"text",class:"mt-1 block w-full",modelValue:a.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>a.phone=o)},null,8,["modelValue"]),l(p,{message:n.value.phone?n.value.phone[0]:"",class:"mt-2"},null,8,["message"])]),s("div",be,[l(v,{for:"address",value:"Address"}),V(s("textarea",{id:"address",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[3]||(e[3]=o=>a.address=o)},null,512),[[$,a.address]]),l(p,{message:n.value.address?n.value.address[0]:"",class:"mt-2"},null,8,["message"])]),s("div",he,[l(v,{for:"notes",value:"Notes"}),V(s("textarea",{id:"notes",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[4]||(e[4]=o=>a.notes=o)},null,512),[[$,a.notes]]),l(p,{message:n.value.notes?n.value.notes[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ce,[l(A,{onClick:e[5]||(e[5]=o=>b.value=!1)},{default:r(()=>e[22]||(e[22]=[m("Cancel",-1)])),_:1,__:[22]}),l(N,{class:"ms-3",type:"submit"},{default:r(()=>e[23]||(e[23]=[m("Create Client",-1)])),_:1,__:[23]})])],32)])]),_:1},8,["show"]),l(D,{show:h.value,onClose:e[13]||(e[13]=o=>h.value=!1)},{default:r(()=>[s("div",ke,[e[27]||(e[27]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Edit Client",-1)),d.value?(i(),u("div",Ve,c(d.value),1)):y("",!0),s("form",{onSubmit:P(Y,["prevent"])},[s("div",$e,[l(v,{for:"edit_name",value:"Name"}),l(w,{id:"edit_name",type:"text",class:"mt-1 block w-full",modelValue:a.name,"onUpdate:modelValue":e[7]||(e[7]=o=>a.name=o),required:"",autofocus:""},null,8,["modelValue"]),l(p,{message:n.value.name?n.value.name[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ee,[l(v,{for:"edit_email",value:"Email"}),l(w,{id:"edit_email",type:"email",class:"mt-1 block w-full",modelValue:a.email,"onUpdate:modelValue":e[8]||(e[8]=o=>a.email=o),required:""},null,8,["modelValue"]),l(p,{message:n.value.email?n.value.email[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ne,[l(v,{for:"edit_phone",value:"Phone"}),l(w,{id:"edit_phone",type:"text",class:"mt-1 block w-full",modelValue:a.phone,"onUpdate:modelValue":e[9]||(e[9]=o=>a.phone=o)},null,8,["modelValue"]),l(p,{message:n.value.phone?n.value.phone[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Ue,[l(v,{for:"edit_address",value:"Address"}),V(s("textarea",{id:"edit_address",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[10]||(e[10]=o=>a.address=o)},null,512),[[$,a.address]]),l(p,{message:n.value.address?n.value.address[0]:"",class:"mt-2"},null,8,["message"])]),s("div",Me,[l(v,{for:"edit_notes",value:"Notes"}),V(s("textarea",{id:"edit_notes",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[11]||(e[11]=o=>a.notes=o)},null,512),[[$,a.notes]]),l(p,{message:n.value.notes?n.value.notes[0]:"",class:"mt-2"},null,8,["message"])]),s("div",De,[l(A,{onClick:e[12]||(e[12]=o=>h.value=!1)},{default:r(()=>e[25]||(e[25]=[m("Cancel",-1)])),_:1,__:[25]}),l(N,{class:"ms-3",type:"submit"},{default:r(()=>e[26]||(e[26]=[m("Update Client",-1)])),_:1,__:[26]})])],32)])]),_:1},8,["show"]),l(D,{show:C.value,onClose:e[15]||(e[15]=o=>C.value=!1)},{default:r(()=>[s("div",Ae,[e[31]||(e[31]=s("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this client? ",-1)),e[32]||(e[32]=s("p",{class:"mt-1 text-sm text-gray-600"}," This action cannot be undone. All associated projects and conversations will also be deleted. ",-1)),_.value?(i(),u("div",Be,[e[28]||(e[28]=s("strong",null,"Client:",-1)),m(" "+c(_.value.name)+" ("+c(_.value.email)+") ",1)])):y("",!0),d.value?(i(),u("div",Fe,c(d.value),1)):y("",!0),s("div",Pe,[l(A,{onClick:e[14]||(e[14]=o=>C.value=!1)},{default:r(()=>e[29]||(e[29]=[m("Cancel",-1)])),_:1,__:[29]}),l(j,{class:"ms-3",onClick:G},{default:r(()=>e[30]||(e[30]=[m("Delete Client",-1)])),_:1,__:[30]})])])]),_:1},8,["show"])]),_:1})],64))}};export{We as default};
