import{q as E,c as h,e as J,a as r,o as i,d as l,u as s,h as L,w as f,b as o,v as m,i as c,x as y,t as p,F as g,l as b,z as j,G as w,j as B,A as T,m as D}from"./app-Dkfi9AsS.js";import{_ as I}from"./AuthenticatedLayout-K_03siSH.js";import{_ as a}from"./InputLabel-DzkFfZBn.js";import{S as x}from"./SelectDropdown-BsOhiUSf.js";import"./PrimaryButton-B1kazBK1.js";import"./Modal-DpYS89YI.js";import"./InputError-JRdV-61-.js";import"./SecondaryButton-BaxhzgV_.js";import"./index-DoH4RQvg.js";import"./BaseFormModal-RK1bZwo2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-DsZsVt0G.js";import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-BbEDJSL2.js";import"./createLucideIcon-D3_s4t3r.js";import"./plus-J6ZNHlGD.js";import"./DangerButton-G7cd6ssg.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-KBWhzfTn.js";/* empty css                                                                       */const Y={class:"flex items-center justify-between w-full"},z={class:"py-6"},K={class:"mx-auto max-w-4xl sm:px-6 lg:px-8"},R={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},G={class:"p-6 text-gray-900 space-y-8"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},P={key:0,class:"text-sm text-red-600 mt-1"},Q={key:0,class:"text-sm text-red-600 mt-1"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z={key:0},ee=["min"],te={key:0,class:"text-sm text-red-600 mt-1"},oe={key:1},se=["min"],de={key:0,class:"text-sm text-red-600 mt-1"},ne={key:2,class:"md:col-span-2"},le={class:"mt-2 flex flex-wrap gap-2"},re=["value"],ie={class:"ml-2 text-sm"},ae={class:"flex gap-2"},ue=["value"],me=["value"],ce={key:5,class:"md:col-span-2"},pe={class:"p-4 rounded-md bg-gray-50 border border-gray-200 text-sm text-gray-800"},ye={class:"flex items-center justify-between gap-3"},ge={class:"flex items-center gap-2"},_e={class:"flex items-center gap-3"},he=["disabled"],Ee={__name:"Edit",props:{schedule:{type:Object,required:!0},schedulableTypes:{type:Array,required:!0},tasks:{type:Array,required:!0},workflows:{type:Array,required:!0}},setup(M){function k(n=new Date){const t=q=>String(q).padStart(2,"0"),d=n.getFullYear(),_=t(n.getMonth()+1),V=t(n.getDate()),$=t(n.getHours()),v=t(n.getMinutes());return`${d}-${_}-${V}T${$}:${v}`}const u=M,F=u.schedule.is_onetime?"once":"cron",e=E({name:u.schedule.name||"",description:u.schedule.description||"",scheduled_item_type:String(u.schedule.scheduled_item_type||"workflow").toLowerCase(),scheduled_item_id:u.schedule.scheduled_item_id||null,start_at:u.schedule.start_at||k(new Date),end_at:u.schedule.end_at||"",mode:F,time:new Date().toTimeString().slice(0,5),days_of_week:[],day_of_month:null,nth:1,dow_for_monthly:1,month:1,cron:u.schedule.recurrence_pattern||"",is_active:!!u.schedule.is_active}),U=h(()=>u.schedulableTypes),C=h(()=>String(e.scheduled_item_type).toLowerCase().includes("task")?u.tasks.map(n=>({id:n.id,name:n.name||`Task #${n.id}`})):u.workflows.map(n=>({id:n.id,name:n.name||`Workflow #${n.id}`})));J(()=>e.scheduled_item_type,()=>{e.scheduled_item_id=null});const A=[{value:"once",label:"Once"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"yearly",label:"Yearly"},{value:"cron",label:"Custom cron"}],S=h(()=>k(new Date)),N=h(()=>e.start_at||S.value),O=h(()=>{var t,d;const n=e.time||"00:00";switch(e.mode){case"once":return`One-time at ${(t=e.start_at)==null?void 0:t.replace("T"," ")} (deactivates after run)`;case"daily":return`Daily at ${n}`;case"weekly":if(!((d=e.days_of_week)!=null&&d.length))return`Weekly at ${n}`;const _=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return`Weekly on ${e.days_of_week.map(v=>_[v]).join(", ")} at ${n}`;case"monthly":return e.day_of_month?`Monthly on day ${e.day_of_month} at ${n}`:`Monthly on the ${["First","Second","Third","Fourth","Fifth"][e.nth-1]} ${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.dow_for_monthly]} at ${n}`;case"yearly":return`Yearly on ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][(e.month||1)-1]} ${e.day_of_month||1} at ${n}`;case"cron":return`Custom cron: ${e.cron||"* * * * *"}`}});function W(){e.put(route("schedules.update",u.schedule.id))}return(n,t)=>(i(),r(g,null,[l(s(L),{title:"Edit Schedule"}),l(I,null,{header:f(()=>[o("div",Y,[t[16]||(t[16]=o("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Edit Schedule",-1)),l(s(T),{href:n.route("schedules.index"),class:"text-sm text-indigo-600 hover:underline"},{default:f(()=>t[15]||(t[15]=[D("Back to list",-1)])),_:1,__:[15]},8,["href"])])]),default:f(()=>[o("div",z,[o("div",K,[o("div",R,[o("div",G,[o("section",null,[t[17]||(t[17]=o("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"1. Basic Details",-1)),o("div",H,[o("div",null,[l(a,{value:"Schedule Name"}),m(o("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>s(e).name=d),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,s(e).name]]),s(e).errors.name?(i(),r("div",P,p(s(e).errors.name),1)):c("",!0)]),o("div",null,[l(a,{value:"Linked Type"}),l(x,{modelValue:s(e).scheduled_item_type,"onUpdate:modelValue":t[1]||(t[1]=d=>s(e).scheduled_item_type=d),options:U.value,placeholder:"Select type..."},null,8,["modelValue","options"])]),o("div",null,[l(a,{value:"Linked Item"}),l(x,{modelValue:s(e).scheduled_item_id,"onUpdate:modelValue":t[2]||(t[2]=d=>s(e).scheduled_item_id=d),options:C.value,valueKey:"id",labelKey:"name",placeholder:"Select item..."},null,8,["modelValue","options"]),s(e).errors.scheduled_item_id?(i(),r("div",Q,p(s(e).errors.scheduled_item_id),1)):c("",!0)]),o("div",null,[l(a,{value:"Description (optional)"}),m(o("input",{"onUpdate:modelValue":t[3]||(t[3]=d=>s(e).description=d),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,s(e).description]])])])]),o("section",null,[t[19]||(t[19]=o("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"2. Recurrence",-1)),o("div",X,[o("div",null,[l(a,{value:"Run"}),l(x,{modelValue:s(e).mode,"onUpdate:modelValue":t[4]||(t[4]=d=>s(e).mode=d),options:A,placeholder:"Select frequency..."},null,8,["modelValue"])]),s(e).mode!=="cron"&&s(e).mode!=="once"?(i(),r("div",Z,[l(a,{value:"Time"}),m(o("input",{"onUpdate:modelValue":t[5]||(t[5]=d=>s(e).time=d),type:"time",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,s(e).time]])])):c("",!0),o("div",null,[l(a,{value:"Start at"}),m(o("input",{"onUpdate:modelValue":t[6]||(t[6]=d=>s(e).start_at=d),type:"datetime-local",min:S.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,8,ee),[[y,s(e).start_at]]),s(e).errors.start_at?(i(),r("div",te,p(s(e).errors.start_at),1)):c("",!0)]),s(e).mode!=="once"?(i(),r("div",oe,[l(a,{value:"End at (optional)"}),m(o("input",{"onUpdate:modelValue":t[7]||(t[7]=d=>s(e).end_at=d),type:"datetime-local",min:N.value,class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,8,se),[[y,s(e).end_at]]),s(e).errors.end_at?(i(),r("div",de,p(s(e).errors.end_at),1)):c("",!0)])):c("",!0),s(e).mode==="weekly"?(i(),r("div",ne,[l(a,{value:"Days of the week"}),o("div",le,[(i(),r(g,null,b(7,d=>o("label",{key:d-1,class:"inline-flex items-center"},[m(o("input",{class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500",type:"checkbox",value:d-1,"onUpdate:modelValue":t[8]||(t[8]=_=>s(e).days_of_week=_)},null,8,re),[[j,s(e).days_of_week]]),o("span",ie,p(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d-1]),1)])),64))])])):c("",!0),s(e).mode==="monthly"?(i(),r(g,{key:3},[o("div",null,[l(a,{value:"Day of month"}),m(o("input",{"onUpdate:modelValue":t[9]||(t[9]=d=>s(e).day_of_month=d),type:"number",min:"1",max:"31",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,s(e).day_of_month,void 0,{number:!0}]])]),o("div",null,[l(a,{value:"Or: Nth weekday"}),o("div",ae,[m(o("select",{"onUpdate:modelValue":t[10]||(t[10]=d=>s(e).nth=d),class:"mt-1 block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},t[18]||(t[18]=[o("option",{value:1},"First",-1),o("option",{value:2},"Second",-1),o("option",{value:3},"Third",-1),o("option",{value:4},"Fourth",-1),o("option",{value:5},"Fifth",-1)]),512),[[w,s(e).nth,void 0,{number:!0}]]),m(o("select",{"onUpdate:modelValue":t[11]||(t[11]=d=>s(e).dow_for_monthly=d),class:"mt-1 block w-1/2 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[(i(),r(g,null,b(7,d=>o("option",{key:d-1,value:d-1},p(["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d-1]),9,ue)),64))],512),[[w,s(e).dow_for_monthly,void 0,{number:!0}]])])])],64)):c("",!0),s(e).mode==="yearly"?(i(),r(g,{key:4},[o("div",null,[l(a,{value:"Month"}),m(o("select",{"onUpdate:modelValue":t[12]||(t[12]=d=>s(e).month=d),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[(i(),r(g,null,b(12,d=>o("option",{key:d,value:d},p(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][d-1]),9,me)),64))],512),[[w,s(e).month,void 0,{number:!0}]])]),o("div",null,[l(a,{value:"Day of month"}),m(o("input",{"onUpdate:modelValue":t[13]||(t[13]=d=>s(e).day_of_month=d),type:"number",min:"1",max:"31",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,s(e).day_of_month,void 0,{number:!0}]])])],64)):c("",!0),s(e).mode==="cron"?(i(),r("div",ce,[l(a,{value:"Cron expression"}),m(o("input",{"onUpdate:modelValue":t[14]||(t[14]=d=>s(e).cron=d),type:"text",placeholder:"* * * * *",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,s(e).cron]])])):c("",!0)])]),o("section",null,[t[20]||(t[20]=o("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"3. Confirmation",-1)),o("div",pe,p(O.value),1)]),o("div",ye,[o("div",ge,[t[21]||(t[21]=o("span",{class:"text-xs text-gray-600"},"Status:",-1)),o("span",{class:B(["text-xs font-medium",s(e).is_active?"text-green-700":"text-gray-600"])},p(s(e).is_active?"Active":"Inactive"),3)]),o("div",_e,[l(s(T),{href:n.route("schedules.index"),class:"px-4 py-2 rounded-md border border-gray-300 text-gray-700 bg-white hover:bg-gray-50"},{default:f(()=>t[22]||(t[22]=[D("Cancel",-1)])),_:1,__:[22]},8,["href"]),o("button",{onClick:W,disabled:s(e).processing,class:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:opacity-50"},p(s(e).processing?"Savingâ€¦":"Save Changes"),9,he)])])])])])])]),_:1})],64))}};export{Ee as default};
