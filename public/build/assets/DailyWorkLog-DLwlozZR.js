import{r as c,G as fs,E as Ks,b as D,d as Xs,m as K,c as l,o,f as j,a,q as Zs,l as u,w as U,i as d,_ as R,t as r,g as st,v as tt,F as m,j as B,n as _,k as X,y as et,W as at,V as ot}from"./app-CyL2wLyO.js";import{_ as lt,s as bs,c as ws,r as nt,p as rt}from"./taskState-17ur5Hzv.js";import{S as ms}from"./SelectDropdown-CzJBflKr.js";import{_ as it}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseFormModal-Dsf7XBYD.js";import"./Modal-JbcKvSYg.js";import"./PrimaryButton-xItLiNnq.js";import"./SecondaryButton-Bblf67Ij.js";import"./InputLabel-oHNZnu0Z.js";import"./InputError-BBm47rPp.js";/* empty css                                                                       */const dt={class:"daily-work-log"},ut={key:0,class:"tips-banner"},ct={class:"dwl-header"},pt={class:"dwl-date-nav"},vt={class:"dwl-date-label"},yt={class:"dwl-date-main"},kt={key:0,class:"chip chip-today"},gt={key:1,class:"chip chip-future"},ht={key:2,class:"chip chip-past"},ft={key:0,class:"dwl-user-switcher"},bt={class:"dwl-header-right"},wt={key:0,class:"progress-pills"},mt={class:"pill p-pending"},_t={class:"pill p-done"},xt={key:0,class:"pill p-pushed"},Ct={key:0,class:"task-picker"},Dt={class:"picker-header"},Pt={class:"flex-1 flex gap-2"},St={class:"w-48"},Tt=["disabled"],$t={key:0,class:"picker-empty"},It={key:1,class:"picker-empty"},At={key:0},jt={key:1},Lt={key:2,class:"picker-grid"},Ft=["onClick"],Bt={key:0,viewBox:"0 0 20 20",fill:"currentColor",width:"12",height:"12"},Vt={class:"picker-task-body"},Nt={class:"picker-task-name"},Mt={class:"picker-task-meta"},Ht={key:0,class:"tag tag-proj"},Ot={class:"dwl-body"},zt={key:0,class:"skeleton-wrap"},Ut={key:1,class:"empty-state"},Rt={key:2,class:"task-list"},Wt=["onDragstart","onDragover","onDrop"],Et={key:0,class:"active-ring"},qt={class:"task-info"},Gt=["onClick"],Yt={class:"task-meta"},Qt={key:0,class:"tag tag-proj"},Jt={key:1,class:"tag tag-milestone"},Kt={key:0,class:"mt-2 text-[11px] text-gray-500 line-clamp-2"},Xt={key:1,class:"mt-2 p-2 bg-indigo-50/50 rounded-lg border border-indigo-100/50 text-[10px] text-gray-600 italic"},Zt={key:2,class:"status-hint"},se={class:"task-actions"},te={key:0,class:"spinner"},ee=["disabled","onClick","title"],ae=["onClick"],oe=["onClick"],le=["onClick"],ne={key:3,class:"dwl-foot"},re={key:0,class:"foot-note"},ie={key:1,class:"foot-note dim"},de={class:"warn-modal"},ue={class:"warn-modal-body"},ce={key:0,class:"history-panel"},pe={key:0,class:"picker-empty"},ve={class:"history-day-header"},ye={class:"history-date"},ke={class:"history-day-pills"},ge={class:"pill p-done"},he={key:0,class:"pill p-pending"},fe={key:1,class:"pill p-pushed"},be={class:"history-list"},we={class:"history-task-name"},me={key:0,class:"tag tag-proj sm"},_e={__name:"DailyWorkLog",setup(xe){const Z=s=>{const t=s.getFullYear(),e=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");return`${t}-${e}-${i}`},ss=s=>{const[t,e,i]=s.split("-");return new Date(t,e-1,i)},ts=s=>ss(s).toLocaleDateString("en-AU",{weekday:"long",day:"numeric",month:"long",year:"numeric"}),W=Z(new Date),h=c(W),p=c([]),V=c([]),E=c({}),es=c([]),S=c(fs().props.auth.user.id),{canDo:_s}=Ks(),as=D(()=>_s("view_all_projects").value),q=c(!1),G=c(!1),Y=c(!1),Q=c(new Set),N=c(!1),J=c(null),T=c(""),M=c(null),f=c(!1),$=c(!1),H=c(localStorage.getItem("dwl_tips_dismissed")!=="1"),P=c({show:!1,item:null,mode:""}),L=c(null),O=c(null),xs=D(()=>h.value===W),Cs=D(()=>h.value>W),os=D(()=>{const s=T.value.toLowerCase().trim(),t=new Set(p.value.map(e=>e.task_id));return V.value.filter(e=>{var n,y,k,w;return t.has(e.id)||M.value&&((n=e.milestone)==null?void 0:n.project_id)!==M.value||e.status==="Done"||e.status==="Archived"?!1:s?String(e.name||"").toLowerCase().includes(s)||String(((k=(y=e.milestone)==null?void 0:y.project)==null?void 0:k.name)||"").toLowerCase().includes(s)||String(((w=e.milestone)==null?void 0:w.name)||"").toLowerCase().includes(s):!0})}),Ds=D(()=>p.value.filter(s=>s.status==="pending").length),Ps=D(()=>p.value.filter(s=>s.status==="completed").length),ls=D(()=>p.value.filter(s=>s.status==="pushed_to_next_day").length),Ss=D(()=>{const s=new Map;return V.value.forEach(t=>{var i;const e=(i=t.milestone)==null?void 0:i.project;e&&!s.has(e.id)&&s.set(e.id,{value:e.id,label:e.name})}),[{value:null,label:"All Projects"},...Array.from(s.values())]}),ns=D(()=>Object.entries(E.value).sort(([s],[t])=>t.localeCompare(s))),v=s=>{var t;return((t=s.task)==null?void 0:t.status)??"To Do"},Ts=s=>v(s)==="Paused",$s=s=>v(s)==="In Progress",rs=s=>v(s)==="In Progress",is=s=>v(s)==="Done",F=s=>is(s)?{label:"âœ“ Done",disabled:!0,type:"done"}:rs(s)?{label:"âœ“ Complete",type:"complete"}:Ts(s)?{label:"â–· Resume",type:"resume"}:$s(s)?{label:"â¸ Pause",type:"pause"}:{label:"â–· Start",type:"start"},Is=s=>Q.value.has(s.task_id),b=(s,t)=>{const e=new Set(Q.value);t?e.add(s.task_id):e.delete(s.task_id),Q.value=e},As=async s=>{b(s,!0);try{const t=await bs(s.task);s.task={...s.task,...t}}catch{}b(s,!1)},js=async s=>{b(s,!0);try{const t=await nt(s.task);s.task={...s.task,...t}}catch{}b(s,!1)},Ls=async s=>{b(s,!0);try{const t=await rt(s.task);s.task={...s.task,...t}}catch{}b(s,!1)},Fs=async s=>{if(!rs(s)){P.value={show:!0,item:s,mode:"complete"};return}b(s,!0);try{const t=await ws(s.task);s.task={...s.task,...t},await window.axios.patch(`/api/daily-tasks/${s.id}`,{status:"completed"}),s.status="completed",f.value&&await I()}catch{}b(s,!1)},Bs=async()=>{const s=P.value.item;if(P.value={show:!1,item:null,mode:""},!!s){b(s,!0);try{const t=await bs(s.task);s.task={...s.task,...t};const e=await ws(s.task);s.task={...s.task,...e},await window.axios.patch(`/api/daily-tasks/${s.id}`,{status:"completed"}),s.status="completed",f.value&&await I()}catch{}b(s,!1)}},ds=()=>{P.value={show:!1,item:null,mode:""}},Vs=s=>{const t=F(s);t.disabled||(t.type==="start"&&As(s),t.type==="resume"&&js(s),t.type==="pause"&&Ls(s),t.type==="complete"&&Fs(s))},z=async()=>{q.value=!0;try{const{data:s}=await window.axios.get("/api/daily-tasks",{params:{date:h.value,user_id:S.value}});p.value=Array.isArray(s)?s:[]}catch(s){console.error("Failed to load daily log",s)}finally{q.value=!1}},Ns=async()=>{if(as.value)try{const{data:s}=await window.axios.get("/api/users");es.value=(Array.isArray(s)?s:[]).map(t=>({value:t.id,label:t.name}))}catch(s){console.error("Failed to load users",s)}},us=async()=>{if(S.value!==fs().props.auth.user.id){V.value=[];return}G.value=!0;try{const{data:s}=await window.axios.get("/api/tasks",{params:{assigned_to_me:1,statuses:"To Do,In Progress,Paused,Blocked",per_page:200}});V.value=Array.isArray(s)?s:(s==null?void 0:s.data)||[]}catch(s){console.error("Failed to load task pool",s)}finally{G.value=!1}},I=async()=>{try{const{data:s}=await window.axios.get("/api/daily-tasks/history",{params:{days:14,user_id:S.value,today:h.value}});E.value=s||{}}catch(s){console.error("Failed to load history",s)}},Ms=async s=>{try{const{data:t}=await window.axios.post("/api/daily-tasks",{task_ids:s,date:h.value}),e=Array.isArray(t)?t:[],i=new Set(p.value.map(n=>n.id));for(const n of e)i.has(n.id)||p.value.push(n);$.value=!1,T.value="",g.value=new Set}catch(t){console.error("Failed to add tasks",t)}},Hs=async()=>{Y.value=!0;try{await window.axios.post("/api/daily-tasks/reorder",{date:h.value,ordered_ids:p.value.map(s=>s.id)})}catch(s){console.error("Failed to save order",s)}finally{Y.value=!1}},Os=async s=>{try{await window.axios.post(`/api/daily-tasks/${s.id}/push-to-tomorrow`),s.status="pushed_to_next_day",f.value&&await I()}catch(t){console.error("Failed to push to tomorrow",t)}},zs=async s=>{try{await window.axios.delete(`/api/daily-tasks/${s.id}`),p.value=p.value.filter(t=>t.id!==s.id)}catch(t){console.error("Failed to remove from log",t)}},Us=s=>{var t;s&&ot(s.id,(t=s.milestone)==null?void 0:t.project_id,[])},Rs=s=>{J.value=s,N.value=!0},Ws=s=>{L.value=s.id},Es=(s,t)=>{t.preventDefault(),O.value=s.id},qs=async(s,t)=>{t.preventDefault();const e=L.value,i=s.id;if(L.value=null,O.value=null,!e||e===i)return;const n=p.value.findIndex(x=>x.id===e),y=p.value.findIndex(x=>x.id===i);if(n===-1||y===-1)return;const k=[...p.value],[w]=k.splice(n,1);k.splice(y,0,w),p.value=k,await Hs()},Gs=()=>{L.value=null,O.value=null},cs=s=>{const t=ss(h.value);t.setDate(t.getDate()+s),h.value=Z(t)},A=s=>({"To Do":{bg:"#eff6ff",color:"#1d4ed8",border:"#bfdbfe"},"In Progress":{bg:"#ecfdf5",color:"#065f46",border:"#6ee7b7"},Paused:{bg:"#fffbeb",color:"#92400e",border:"#fcd34d"},Blocked:{bg:"#fef2f2",color:"#991b1b",border:"#fca5a5"},Done:{bg:"#ede9fe",color:"#5b21b6",border:"#c4b5fd"}})[s]||{bg:"#f3f4f6",color:"#374151",border:"#e5e7eb"},ps=s=>({pending:"Pending",completed:"Completed",pushed_to_next_day:"Pushed"})[s]||s,Ys=s=>{const t=F(s);return t.disabled?{background:"#d1fae5",color:"#065f46",border:"#6ee7b7"}:t.type==="complete"?{background:"#6366f1",color:"#fff",border:"#818cf8"}:t.type==="pause"?{background:"#fef3c7",color:"#78350f",border:"#fcd34d"}:{background:"#3b82f6",color:"#fff",border:"#60a5fa"}},vs=()=>{H.value=!1;try{localStorage.setItem("dwl_tips_dismissed","1")}catch{}};Xs(async()=>{await Ns(),await z(),await us()}),K(S,async()=>{await z(),await us(),f.value&&await I()}),K(h,async()=>{await z(),f.value&&await I()}),K(f,async s=>{s&&Object.keys(E.value).length===0&&await I()});const g=c(new Set),Qs=s=>{const t=new Set(g.value);t.has(s)?t.delete(s):t.add(s),g.value=t},Js=()=>{const s=Array.from(g.value);s.length&&Ms(s)};return(s,t)=>(o(),l("div",dt,[j(R,{name:"slide-down"},{default:U(()=>[H.value?(o(),l("div",ut,[a("button",{class:"tips-close",onClick:vs,title:"Dismiss tips"},"âœ•"),t[11]||(t[11]=a("div",{class:"tips-heading"},[a("span",{class:"tips-icon"},"ðŸ’¡"),a("strong",null,"How the Daily Work Log works")],-1)),t[12]||(t[12]=a("div",{class:"tips-grid"},[a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"1"),a("div",{class:"tip-body"},[a("strong",null,"Plan your day"),d(" â€” Pick tasks from your assigned list and add them here. Drag to set the order you'll work on them. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"2"),a("div",{class:"tip-body"},[a("strong",null,"Start each task"),d(" â€” Hit "),a("em",null,"â–· Start"),d(" when you begin. This logs your time and signals to the team you're on it. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"3"),a("div",{class:"tip-body"},[a("strong",null,"Pause when you stop"),d(" â€” If you need to switch or take a break, hit "),a("em",null,"â¸ Pause"),d(". Resume later when you're back. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"4"),a("div",{class:"tip-body"},[a("strong",null,"Complete to finish"),d(" â€” Only available once the task is "),a("em",null,"In Progress"),d(". This marks the task Done and logs your session. ")])]),a("div",{class:"tip-card tip-card-warn"},[a("div",{class:"tip-step warn"},"âš "),a("div",{class:"tip-body"},[a("strong",null,"Don't skip steps"),d(" â€” Avoid starting and immediately completing without actually working on it. Accurate time tracking helps the whole team. ")])]),a("div",{class:"tip-card"},[a("div",{class:"tip-step"},"5"),a("div",{class:"tip-body"},[a("strong",null,"Push unfinished tasks"),d(" â€” Hit "),a("em",null,"â†’ Tomorrow"),d(" to move anything you didn't finish to the next day. It stays in history so nothing gets lost. ")])])],-1)),a("button",{class:"tips-got-it",onClick:vs},"Got it, let's go â†’")])):u("",!0)]),_:1}),a("div",ct,[a("div",pt,[a("button",{class:"nav-btn",onClick:t[0]||(t[0]=e=>cs(-1)),title:"Previous day"},"â€¹"),a("div",vt,[a("div",yt,r(ts(h.value)),1),xs.value?(o(),l("div",kt,"Today")):Cs.value?(o(),l("div",gt,"Upcoming")):(o(),l("div",ht,"Past"))]),a("button",{class:"nav-btn",onClick:t[1]||(t[1]=e=>cs(1)),title:"Next day"},"â€º")]),as.value?(o(),l("div",ft,[j(ms,{id:"dwl-user-select",modelValue:S.value,"onUpdate:modelValue":t[2]||(t[2]=e=>S.value=e),options:es.value,placeholder:"Viewing log for..."},null,8,["modelValue","options"])])):u("",!0),a("div",bt,[p.value.length?(o(),l("div",wt,[a("span",mt,r(Ds.value)+" Pending",1),a("span",_t,r(Ps.value)+" Done",1),ls.value?(o(),l("span",xt,r(ls.value)+" Pushed",1)):u("",!0)])):u("",!0),a("button",{class:"btn-ghost-sm",onClick:t[3]||(t[3]=e=>H.value=!H.value),title:"Show tips"},"ðŸ’¡ Tips"),a("button",{class:"btn-outline",onClick:t[4]||(t[4]=e=>f.value=!f.value)},r(f.value?"Hide History":"ðŸ“… History"),1),a("button",{class:"btn-primary",onClick:t[5]||(t[5]=e=>$.value=!$.value)}," + Add Tasks ")])]),j(R,{name:"slide-down"},{default:U(()=>[$.value?(o(),l("div",Ct,[a("div",Dt,[a("div",Pt,[st(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>T.value=e),class:"picker-search",placeholder:"Search your tasksâ€¦",autofocus:""},null,512),[[tt,T.value]]),a("div",St,[j(ms,{modelValue:M.value,"onUpdate:modelValue":t[7]||(t[7]=e=>M.value=e),options:Ss.value,placeholder:"Filter by project"},null,8,["modelValue","options"])])]),t[13]||(t[13]=a("span",{class:"picker-hint"},"Click to select, then Add",-1)),a("button",{class:"btn-primary btn-sm",disabled:g.value.size===0,onClick:Js}," Add"+r(g.value.size>0?` (${g.value.size})`:""),9,Tt),a("button",{class:"btn-ghost btn-sm",onClick:t[8]||(t[8]=e=>{$.value=!1,g.value=new Set})},"âœ•")]),G.value?(o(),l("div",$t,"Loading your tasksâ€¦")):os.value.length===0?(o(),l("div",It,[T.value?(o(),l("span",At,'No tasks match "'+r(T.value)+'"',1)):(o(),l("span",jt,"All your active tasks are already in today's log! ðŸŽ‰"))])):(o(),l("div",Lt,[(o(!0),l(m,null,B(os.value,e=>{var i,n;return o(),l("div",{key:e.id,class:_(["picker-task",{selected:g.value.has(e.id)}]),onClick:y=>Qs(e.id)},[a("div",{class:_(["picker-check",{checked:g.value.has(e.id)}])},[g.value.has(e.id)?(o(),l("svg",Bt,t[14]||(t[14]=[a("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)]))):u("",!0)],2),a("div",Vt,[a("div",Nt,r(e.name),1),a("div",Mt,[(n=(i=e.milestone)==null?void 0:i.project)!=null&&n.name?(o(),l("span",Ht,r(e.milestone.project.name),1)):u("",!0),e.priority?(o(),l("span",{key:1,class:_(["tag",`prio-${e.priority}`])},r(e.priority),3)):u("",!0),a("span",{class:"tag",style:X({background:A(e.status).bg,color:A(e.status).color,border:`1px solid ${A(e.status).border}`})},r(e.status),5)])])],10,Ft)}),128))]))])):u("",!0)]),_:1}),a("div",Ot,[q.value?(o(),l("div",zt,[(o(),l(m,null,B(3,e=>a("div",{class:"skeleton",key:e})),64))])):p.value.length===0?(o(),l("div",Ut,[t[15]||(t[15]=a("div",{class:"empty-icon"},"ðŸ“‹",-1)),t[16]||(t[16]=a("h3",null,"No tasks planned for this day",-1)),t[17]||(t[17]=a("p",null,"Add tasks from your assigned list and drag them into your preferred work order.",-1)),a("button",{class:"btn-primary",onClick:t[9]||(t[9]=e=>$.value=!0)},"+ Plan Your Day")])):(o(),l("ul",Rt,[(o(!0),l(m,null,B(p.value,e=>{var i,n,y,k,w,x,ys,ks,gs,hs;return o(),l("li",{key:e.id,class:_(["task-card",{"is-done":e.status==="completed","is-pushed":e.status==="pushed_to_next_day","is-active":v(e)==="In Progress",dragging:L.value===e.id,"drag-over":O.value===e.id}]),draggable:"true",onDragstart:C=>Ws(e),onDragover:C=>Es(e,C),onDrop:C=>qs(e,C),onDragend:Gs},[t[33]||(t[33]=at('<div class="drag-handle" data-v-6b0baa70><svg viewBox="0 0 16 24" fill="currentColor" width="10" height="16" data-v-6b0baa70><circle cx="5" cy="4" r="2" data-v-6b0baa70></circle><circle cx="11" cy="4" r="2" data-v-6b0baa70></circle><circle cx="5" cy="12" r="2" data-v-6b0baa70></circle><circle cx="11" cy="12" r="2" data-v-6b0baa70></circle><circle cx="5" cy="20" r="2" data-v-6b0baa70></circle><circle cx="11" cy="20" r="2" data-v-6b0baa70></circle></svg></div>',1)),v(e)==="In Progress"?(o(),l("div",Et,t[18]||(t[18]=[a("span",{class:"pulse-dot"},null,-1)]))):u("",!0),a("div",qt,[a("div",{class:_(["task-name cursor-pointer hover:text-indigo-600 transition-colors",{"line-through":is(e)}]),onClick:C=>Us(e.task)},r((i=e.task)==null?void 0:i.name),11,Gt),a("div",Yt,[(k=(y=(n=e.task)==null?void 0:n.milestone)==null?void 0:y.project)!=null&&k.name?(o(),l("span",Qt,r(e.task.milestone.project.name),1)):u("",!0),(x=(w=e.task)==null?void 0:w.milestone)!=null&&x.name?(o(),l("span",Jt,r(e.task.milestone.name),1)):u("",!0),(ys=e.task)!=null&&ys.priority?(o(),l("span",{key:2,class:_(["tag",`prio-${e.task.priority}`])},r(e.task.priority),3)):u("",!0),a("span",{class:"tag task-status-tag",style:X({background:A(v(e)).bg,color:A(v(e)).color,border:`1px solid ${A(v(e)).border}`})},r(v(e)),5),a("span",{class:_(["tag",`log-${e.status}`])},r(ps(e.status)),3)]),(ks=e.task)!=null&&ks.description?(o(),l("div",Kt,r(e.task.description),1)):u("",!0),(hs=(gs=e.task)==null?void 0:gs.notes)!=null&&hs.length?(o(),l("div",Xt,[t[19]||(t[19]=a("span",{class:"font-bold text-indigo-400 not-italic mr-1"},"Latest Update:",-1)),d(' "'+r(e.task.notes[0].content)+'" ',1)])):u("",!0),e.status!=="completed"&&e.status!=="pushed_to_next_day"?(o(),l("div",Zt,[v(e)==="To Do"?(o(),l(m,{key:0},[t[20]||(t[20]=d(" â„¹ï¸ Hit ",-1)),t[21]||(t[21]=a("strong",null,"Start",-1)),t[22]||(t[22]=d(" to begin tracking time on this task. ",-1))],64)):v(e)==="In Progress"?(o(),l(m,{key:1},[t[23]||(t[23]=d(" ðŸŸ¢ Task is running â€” hit ",-1)),t[24]||(t[24]=a("strong",null,"Pause",-1)),t[25]||(t[25]=d(" if you're stepping away, or ",-1)),t[26]||(t[26]=a("strong",null,"Complete",-1)),t[27]||(t[27]=d(" when done. ",-1))],64)):v(e)==="Paused"?(o(),l(m,{key:2},[t[28]||(t[28]=d(" â¸ Paused â€” hit ",-1)),t[29]||(t[29]=a("strong",null,"Resume",-1)),t[30]||(t[30]=d(" when you're ready to continue. ",-1))],64)):v(e)==="Blocked"?(o(),l(m,{key:3},[d(" ðŸ”´ This task is blocked. Unblock it in the task detail before starting. ")],64)):u("",!0)])):u("",!0)]),a("div",se,[Is(e)?(o(),l("div",te)):(o(),l(m,{key:1},[a("button",{class:"btn-lifecycle",disabled:F(e).disabled||v(e)==="Blocked",style:X(Ys(e)),onClick:C=>Vs(e),title:F(e).label},r(F(e).label),13,ee),e.status==="pending"?(o(),l("button",{key:0,class:"btn-icon push-btn",title:"Push to tomorrow",onClick:C=>Os(e)},t[31]||(t[31]=[a("svg",{viewBox:"0 0 20 20",fill:"currentColor",width:"14",height:"14"},[a("path",{"fill-rule":"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,ae)):u("",!0),a("button",{class:"btn-icon note-btn",title:"Add Note",onClick:C=>Rs(e.task)},t[32]||(t[32]=[a("span",{style:{"font-size":"14px"}},"ðŸ“",-1)]),8,oe),a("button",{class:"btn-icon remove-btn",title:"Remove from today's log",onClick:C=>zs(e)},"âœ•",8,le)],64))])],42,Wt)}),128))])),p.value.length>0?(o(),l("div",ne,[Y.value?(o(),l("span",re,"Saving orderâ€¦")):(o(),l("span",ie,"Drag to reorder â€¢ Changes are saved automatically"))])):u("",!0)]),j(R,{name:"fade"},{default:U(()=>{var e,i;return[P.value.show?(o(),l("div",{key:0,class:"modal-overlay",onClick:et(ds,["self"])},[a("div",de,[t[36]||(t[36]=a("div",{class:"warn-modal-icon"},"âš ï¸",-1)),t[37]||(t[37]=a("h3",{class:"warn-modal-title"},"Task hasn't been started yet",-1)),a("p",ue,[a("strong",null,r((i=(e=P.value.item)==null?void 0:e.task)==null?void 0:i.name),1),t[34]||(t[34]=d(" is currently ",-1)),a("em",null,r(v(P.value.item)),1),t[35]||(t[35]=d(". ",-1))]),t[38]||(t[38]=a("p",{class:"warn-modal-body"},[d(" Our workflow requires you to "),a("strong",null,"start"),d(" a task before marking it complete â€” this helps track time accurately and keeps the team informed. ")],-1)),t[39]||(t[39]=a("div",{class:"warn-tips"},[a("div",{class:"warn-tip"},[d("âœ… "),a("strong",null,"Best practice:"),d(" Start â†’ work on the task â†’ Pause if interrupted â†’ Complete when done.")]),a("div",{class:"warn-tip"},[d("âš¡ "),a("strong",null,"Quick option:"),d(" If you've already finished this task, we can start & complete it now â€” but please use proper start/pause/complete going forward.")])],-1)),a("div",{class:"warn-modal-actions"},[a("button",{class:"btn-outline",onClick:ds},"Go back â€” I'll start it first"),a("button",{class:"btn-warn-ok",onClick:Bs},"Mark as complete anyway")])])])):u("",!0)]}),_:1}),j(R,{name:"slide-down"},{default:U(()=>[f.value?(o(),l("div",ce,[t[40]||(t[40]=a("h3",{class:"history-title"},"ðŸ“… Past 14 Days â€” Task Log",-1)),t[41]||(t[41]=a("p",{class:"history-sub"},"Track patterns: tasks pushed repeatedly may need re-prioritisation or support.",-1)),ns.value.length===0?(o(),l("div",pe,"No history yet â€” come back after your first day!")):u("",!0),(o(!0),l(m,null,B(ns.value,([e,i])=>(o(),l("div",{key:e,class:"history-day"},[a("div",ve,[a("span",ye,r(ts(e)),1),a("div",ke,[a("span",ge,r(i.filter(n=>n.status==="completed").length)+" done",1),i.filter(n=>n.status==="pending").length?(o(),l("span",he,r(i.filter(n=>n.status==="pending").length)+" unfinished ",1)):u("",!0),i.filter(n=>n.status==="pushed_to_next_day").length?(o(),l("span",fe,r(i.filter(n=>n.status==="pushed_to_next_day").length)+" pushed ",1)):u("",!0)])]),a("ul",be,[(o(!0),l(m,null,B(i,n=>{var y,k,w,x;return o(),l("li",{key:n.id,class:_(["history-item",`his-${n.status}`])},[a("span",{class:_(["h-dot",`hdot-${n.status}`])},null,2),a("span",we,r((y=n.task)==null?void 0:y.name),1),(x=(w=(k=n.task)==null?void 0:k.milestone)==null?void 0:w.project)!=null&&x.name?(o(),l("span",me,r(n.task.milestone.project.name),1)):u("",!0),a("span",{class:_(["tag",`log-${n.status}`]),style:{"font-size":".65rem"}},r(ps(n.status)),3)],2)}),128))])]))),128))])):u("",!0)]),_:1}),N.value?(o(),Zs(lt,{key:0,show:N.value,"task-for-note":J.value,onClose:t[10]||(t[10]=e=>{N.value=!1,J.value=null}),onNoteAdded:z},null,8,["show","task-for-note"])):u("",!0)]))}},Be=it(_e,[["__scopeId","data-v-6b0baa70"]]);export{Be as default};
