import{j as ce,S as ge,B as Te,T as Bt,k as Ht,l as Wt,m as Yt,n as zt,_ as qt,o as Gt}from"./AuthenticatedLayout-BN238DcP.js";import{r as k,B as be,i as r,o,b as e,F as Z,j as ee,g as T,t as y,m as W,an as $e,e as p,ao as Qe,a as U,A as ne,c as X,ap as dt,W as ut,p as te,D as ke,T as Ge,aq as Q,H as Kt,O as Oe,ar as Jt,d as xe,z as De,w as re,s as N,f as me,k as we,v as We,h as J,G as Zt,_ as Ee,am as Xt,l as et,as as ct,Y as tt,ad as Qt,$ as es,Z as ts,L as ss,M as ls,a7 as Ue,K as as,al as is,a0 as ns,aj as os,y as rs,ai as ds,V as us,a1 as cs}from"./app-Z6XFB6TM.js";import{c as he,a as Ie,d as He,f as Ve,b as ms,_ as vs}from"./ProjectForm-CtzUyTO-.js";import{a as ye,_ as Ce}from"./SecondaryButton-CUgn9evh.js";import{P as de}from"./PrimaryButton-CWSTBu4J.js";import{b as ht,_ as yt,a as ft}from"./TaskList-BPQQwJ_w.js";import{_ as Y}from"./InputLabel-Bw5vfI9P.js";import{_ as oe,a as le}from"./InputError-B-zruA7l.js";import{_ as bt}from"./EmailEditor-CA7RkYfG.js";import"./Checkbox-DKmZsiWQ.js";import"./ApplicationLogo-vbzkeJnx.js";import"./DangerButton-BqToPWh8.js";import"./ProjectTypeInput-DKYB8ptb.js";const ps={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},gs={key:0,class:"text-sm text-gray-500"},hs={key:1,class:"text-sm text-gray-500"},ys={key:2,class:"space-y-3"},fs={class:"flex justify-between items-start"},bs={class:"font-medium text-gray-900"},ws={class:"text-sm text-gray-600"},_s={key:0,class:"text-sm text-gray-600 mt-1"},xs={class:"flex space-x-2"},ks=["href"],Ds=["href"],Cs=["onClick"],Ts={__name:"ProjectMeetingsList",props:{projectId:{type:Number,required:!0}},setup(s,{expose:t}){const l=s,n=k([]),i=k(!1),a=k(""),c=()=>{try{a.value=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(g){console.error("Error detecting user timezone:",g),a.value="UTC"}},m=(g,_=null,E=!1)=>{if(!g)return"";try{if(E||g.endsWith("Z")){if(_&&_===a.value){const $={dateStyle:"medium",timeStyle:"short"};return new Date(g).toLocaleString(void 0,$)}const S={dateStyle:"medium",timeStyle:"short",timeZone:_||a.value};return new Date(g).toLocaleString(void 0,S)}else{if(_&&_===a.value){const $={dateStyle:"medium",timeStyle:"short"};return new Date(g).toLocaleString(void 0,$)}const S={dateStyle:"medium",timeStyle:"short",timeZone:_||a.value};return new Date(g).toLocaleString(void 0,S)}}catch(S){return console.error("Error formatting meeting time:",S),new Date(g).toLocaleString()}},u=(g,_=null,E=!1)=>{if(!g)return"";try{if(E||g.endsWith("Z")){if(_&&_===a.value){const $={timeStyle:"short"};return new Date(g).toLocaleTimeString(void 0,$)}const S={timeStyle:"short",timeZone:_||a.value};return new Date(g).toLocaleTimeString(void 0,S)}else{if(_&&_===a.value){const $={timeStyle:"short"};return new Date(g).toLocaleTimeString(void 0,$)}const S={timeStyle:"short",timeZone:_||a.value};return new Date(g).toLocaleTimeString(void 0,S)}}catch(S){return console.error("Error formatting meeting time (time only):",S),new Date(g).toLocaleTimeString()}},d=async()=>{i.value=!0;try{const g=await window.axios.get(`/api/projects/${l.projectId}/meetings`);n.value=g.data}catch(g){console.error("Error fetching project meetings:",g)}finally{i.value=!1}},v=async g=>{if(confirm("Are you sure you want to delete this meeting?"))try{await window.axios.delete(`/api/projects/${l.projectId}/meetings/${g}`),await d()}catch(_){console.error("Error deleting meeting:",_),alert("Failed to delete meeting. Please try again.")}};return t({fetchMeetings:d}),be(()=>{c(),d()}),(g,_)=>(o(),r("div",ps,[_[4]||(_[4]=e("h4",{class:"text-md font-semibold text-gray-900 mb-2"},"Upcoming Meetings",-1)),i.value?(o(),r("div",gs," Loading meetings... ")):n.value.length===0?(o(),r("div",hs," No upcoming meetings scheduled. ")):(o(),r("div",ys,[(o(!0),r(Z,null,ee(n.value,E=>(o(),r("div",{key:E.id,class:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[e("div",fs,[e("div",null,[e("h5",bs,y(E.summary),1),e("p",ws,y(m(E.start_time,E.timezone,E.is_utc))+" - "+y(u(E.end_time,E.timezone,E.is_utc)),1),E.location?(o(),r("p",_s,[_[0]||(_[0]=e("span",{class:"font-medium"},"Location:",-1)),W(" "+y(E.location),1)])):T("",!0)]),e("div",xs,[e("a",{href:E.google_event_link,target:"_blank",class:"text-blue-600 hover:text-blue-800",title:"View in Google Calendar"},_[1]||(_[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]),8,ks),E.google_meet_link?(o(),r("a",{key:0,href:E.google_meet_link,target:"_blank",class:"text-green-600 hover:text-green-800",title:"Join Google Meet"},_[2]||(_[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,Ds)):T("",!0),e("button",{onClick:S=>v(E.google_event_id),class:"text-red-600 hover:text-red-800",title:"Delete Meeting"},_[3]||(_[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Cs)])])]))),128))]))]))}};var Es=Object.defineProperty,Ss=(s,t,l)=>t in s?Es(s,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[t]=l,Se=(s,t,l)=>Ss(s,typeof t!="symbol"?t+"":t,l);const js=(s,t,l)=>{const n=s[t];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((i,a)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(a.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==l?". Note that variables only represent file names one level deep.":""))))})};let Re,mt,vt,_e,Fe={},Ae={};class Ms{constructor(t,l=!1){Se(this,"texts",{}),Se(this,"dateToMinutes",n=>n.getHours()*60+n.getMinutes()),_e=this,this._texts=t,!l&&Date&&!Date.prototype.addDays&&this._initDatePrototypes()}_initDatePrototypes(){Date.prototype.addDays=function(t){return _e.addDays(this,t)},Date.prototype.subtractDays=function(t){return _e.subtractDays(this,t)},Date.prototype.addHours=function(t){return _e.addHours(this,t)},Date.prototype.subtractHours=function(t){return _e.subtractHours(this,t)},Date.prototype.addMinutes=function(t){return _e.addMinutes(this,t)},Date.prototype.subtractMinutes=function(t){return _e.subtractMinutes(this,t)},Date.prototype.getWeek=function(){return _e.getWeek(this)},Date.prototype.isToday=function(){return _e.isToday(this)},Date.prototype.isLeapYear=function(){return _e.isLeapYear(this)},Date.prototype.format=function(t="YYYY-MM-DD"){return _e.formatDate(this,t)},Date.prototype.formatTime=function(t="HH:mm"){return _e.formatTime(this,t)}}removePrototypes(){delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime}updateTexts(t){this._texts=t}_todayFormatted(){return mt!==new Date().getDate()&&(Re=new Date,mt=Re.getDate(),vt=`${Re.getFullYear()}-${Re.getMonth()}-${Re.getDate()}`),vt}addDays(t,l){const n=new Date(t.valueOf());return n.setDate(n.getDate()+l),n}subtractDays(t,l){const n=new Date(t.valueOf());return n.setDate(n.getDate()-l),n}addHours(t,l){const n=new Date(t.valueOf());return n.setHours(n.getHours()+l),n}subtractHours(t,l){const n=new Date(t.valueOf());return n.setHours(n.getHours()-l),n}addMinutes(t,l){const n=new Date(t.valueOf());return n.setMinutes(n.getMinutes()+l),n}subtractMinutes(t,l){const n=new Date(t.valueOf());return n.setMinutes(n.getMinutes()-l),n}getWeek(t){const l=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=l.getUTCDay()||7;l.setUTCDate(l.getUTCDate()+4-n);const i=new Date(Date.UTC(l.getUTCFullYear(),0,1));return Math.ceil(((l-i)/864e5+1)/7)}isToday(t){return`${t.getFullYear()}-${t.getMonth()}-${t.getDate()}`===this._todayFormatted()}isLeapYear(t){const l=t.getFullYear();return!(l%400)||l%100&&!(l%4)}getPreviousFirstDayOfWeek(t=null,l){const n=t&&new Date(t.valueOf())||new Date,i=l?7:6;return n.setDate(n.getDate()-(n.getDay()+i)%7),n}stringToDate(t){return t instanceof Date?t:(t.length===10&&(t+=" 00:00"),new Date(t.replace(/-/g,"/")))}countDays(t,l){typeof t=="string"&&(t=t.replace(/-/g,"/")),typeof l=="string"&&(l=l.replace(/-/g,"/")),t=new Date(t).setHours(0,0,0,0),l=new Date(l).setHours(0,0,1,0);const n=(new Date(l).getTimezoneOffset()-new Date(t).getTimezoneOffset())*60*1e3;return Math.ceil((l-t-n)/(24*3600*1e3))}datesInSameTimeStep(t,l,n){return Math.abs(t.getTime()-l.getTime())<=n*60*1e3}formatDate(t,l="YYYY-MM-DD",n=null){if(n||(n=this._texts),l||(l="YYYY-MM-DD"),l==="YYYY-MM-DD")return this.formatDateLite(t);Fe={},Ae={};const i={YYYY:()=>this._hydrateDateObject(t,n).YYYY,YY:()=>this._hydrateDateObject(t,n).YY(),M:()=>this._hydrateDateObject(t,n).M,MM:()=>this._hydrateDateObject(t,n).MM(),MMM:()=>this._hydrateDateObject(t,n).MMM(),MMMM:()=>this._hydrateDateObject(t,n).MMMM(),MMMMG:()=>this._hydrateDateObject(t,n).MMMMG(),D:()=>this._hydrateDateObject(t,n).D,DD:()=>this._hydrateDateObject(t,n).DD(),S:()=>this._hydrateDateObject(t,n).S(),d:()=>this._hydrateDateObject(t,n).d,dd:()=>this._hydrateDateObject(t,n).dd(),ddd:()=>this._hydrateDateObject(t,n).ddd(),dddd:()=>this._hydrateDateObject(t,n).dddd(),HH:()=>this._hydrateTimeObject(t,n).HH,H:()=>this._hydrateTimeObject(t,n).H,hh:()=>this._hydrateTimeObject(t,n).hh,h:()=>this._hydrateTimeObject(t,n).h,am:()=>this._hydrateTimeObject(t,n).am,AM:()=>this._hydrateTimeObject(t,n).AM,mm:()=>this._hydrateTimeObject(t,n).mm,m:()=>this._hydrateTimeObject(t,n).m};return l.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(a,c)=>{const m=i[c.replace(/\{|\}/g,"")];return m!==void 0?m():c})}formatDateLite(t){const l=t.getMonth()+1,n=t.getDate();return`${t.getFullYear()}-${l<10?"0":""}${l}-${n<10?"0":""}${n}`}formatTime(t,l="HH:mm",n=null,i=!1){let a=!1;if(i){const[u,d,v]=[t.getHours(),t.getMinutes(),t.getSeconds()];u+d+v===141&&(a=!0)}if(t instanceof Date&&l==="HH:mm")return a?"24:00":this.formatTimeLite(t);Ae={},n||(n=this._texts);const c=this._hydrateTimeObject(t,n),m=l.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(u,d)=>{const v=c[d.replace(/\{|\}/g,"")];return v!==void 0?v:d});return a?m.replace("23:59","24:00"):m}formatTimeLite(t){const l=t.getHours(),n=t.getMinutes();return`${(l<10?"0":"")+l}:${(n<10?"0":"")+n}`}_nth(t){if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}_hydrateDateObject(t,l){if(Fe.D)return Fe;const n=t.getFullYear(),i=t.getMonth()+1,a=t.getDate(),m=(t.getDay()-1+7)%7;return Fe={YYYY:n,YY:()=>n.toString().substring(2),M:i,MM:()=>(i<10?"0":"")+i,MMM:()=>l.months[i-1].substring(0,3),MMMM:()=>l.months[i-1],MMMMG:()=>(l.monthsGenitive||l.months)[i-1],D:a,DD:()=>(a<10?"0":"")+a,S:()=>this._nth(a),d:m+1,dd:()=>l.weekDays[m][0],ddd:()=>l.weekDays[m].substr(0,3),dddd:()=>l.weekDays[m]},Fe}_hydrateTimeObject(t,l){if(Ae.am)return Ae;let n,i;t instanceof Date?(n=t.getHours(),i=t.getMinutes()):(n=Math.floor(t/60),i=Math.floor(t%60));const a=n%12?n%12:12,c=(l||{am:"am",pm:"pm"})[n===24||n<12?"am":"pm"];return Ae={H:n,h:a,HH:(n<10?"0":"")+n,hh:(a<10?"0":"")+a,am:c,AM:c.toUpperCase(),m:i,mm:(i<10?"0":"")+i},Ae}}const $s=1440;class Vs{constructor(t){Se(this,"_vuecal",null),Se(this,"selectCell",(l=!1,n,i)=>{this._vuecal.$emit("cell-click",i?{date:n,split:i}:n),this._vuecal.clickToNavigate||l?this._vuecal.switchToNarrowerView():this._vuecal.dblclickToNavigate&&"ontouchstart"in window&&(this._vuecal.domEvents.dblTapACell.taps++,setTimeout(()=>this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.domEvents.dblTapACell.timeout),this._vuecal.domEvents.dblTapACell.taps>=2&&(this._vuecal.domEvents.dblTapACell.taps=0,this._vuecal.switchToNarrowerView(),this._vuecal.$emit("cell-dblclick",i?{date:n,split:i}:n)))}),Se(this,"keyPressEnterCell",(l,n)=>{this._vuecal.$emit("cell-keypress-enter",n?{date:l,split:n}:l),this._vuecal.switchToNarrowerView()}),Se(this,"getPosition",l=>{const{left:n,top:i}=this._vuecal.cellsEl.getBoundingClientRect(),{clientX:a,clientY:c}="ontouchstart"in window&&l.touches?l.touches[0]:l;return{x:a-n,y:c-i}}),Se(this,"minutesAtCursor",l=>{let n=0,i={x:0,y:0};const{timeStep:a,timeCellHeight:c,timeFrom:m}=this._vuecal.$props;return typeof l=="number"?n=l:typeof l=="object"&&(i=this.getPosition(l),n=Math.round(i.y*a/parseInt(c)+m)),{minutes:Math.max(Math.min(n,$s),0),cursorCoords:i}}),this._vuecal=t}}const As=2,Ze=1440;let ve,pe,Xe;class Is{constructor(t,l){Se(this,"_vuecal",null),Se(this,"eventDefaults",{_eid:null,start:"",startTimeMinutes:0,end:"",endTimeMinutes:0,title:"",content:"",background:!1,allDay:!1,segments:null,repeat:null,daysCount:1,deletable:!0,deleting:!1,titleEditable:!0,resizable:!0,resizing:!1,draggable:!0,dragging:!1,draggingStatic:!1,focused:!1,class:""}),this._vuecal=t,ve=l}createAnEvent(t,l,n){if(typeof t=="string"&&(t=ve.stringToDate(t)),!(t instanceof Date))return!1;const i=ve.dateToMinutes(t);l=l*1||As*60;const a=i+l,c=ve.addMinutes(new Date(t),l);n.end&&(typeof n.end=="string"&&(n.end=ve.stringToDate(n.end)),n.endTimeMinutes=ve.dateToMinutes(n.end));const m={...this.eventDefaults,_eid:`${this._vuecal._.uid}_${this._vuecal.eventIdIncrement++}`,start:t,startTimeMinutes:i,end:c,endTimeMinutes:a,segments:null,...n};if(!(typeof this._vuecal.onEventCreate=="function"&&!this._vuecal.onEventCreate(m,()=>this.deleteAnEvent(m))))return m.startDateF!==m.endDateF&&(m.daysCount=ve.countDays(m.start,m.end)),this._vuecal.mutableEvents.push(m),this._vuecal.addEventsToView([m]),this._vuecal.emitWithEvent("event-create",m),this._vuecal.$emit("event-change",{event:this._vuecal.cleanupEvent(m),originalEvent:null}),m}addEventSegment(t){t.segments||(t.segments={},t.segments[ve.formatDateLite(t.start)]={start:t.start,startTimeMinutes:t.startTimeMinutes,endTimeMinutes:Ze,isFirstDay:!0,isLastDay:!1});const l=t.segments[ve.formatDateLite(t.end)];l&&(l.isLastDay=!1,l.endTimeMinutes=Ze);const n=ve.addDays(t.end,1),i=ve.formatDateLite(n);return n.setHours(0,0,0,0),t.segments[i]={start:n,startTimeMinutes:0,endTimeMinutes:t.endTimeMinutes,isFirstDay:!1,isLastDay:!0},t.end=ve.addMinutes(n,t.endTimeMinutes),t.daysCount=Object.keys(t.segments).length,i}removeEventSegment(t){let l=Object.keys(t.segments).length;if(l<=1)return ve.formatDateLite(t.end);delete t.segments[ve.formatDateLite(t.end)],l--;const n=ve.subtractDays(t.end,1),i=ve.formatDateLite(n),a=t.segments[i];return l?a&&(a.isLastDay=!0,a.endTimeMinutes=t.endTimeMinutes):t.segments=null,t.daysCount=l||1,t.end=n,i}createEventSegments(t,l,n){const i=l.getTime(),a=n.getTime();let c=t.start.getTime(),m=t.end.getTime(),u=!1,d,v,g;for(!t.end.getHours()&&!t.end.getMinutes()&&(m-=1e3),t.segments={},t.repeat?(d=i,v=Math.min(a,t.repeat.until?ve.stringToDate(t.repeat.until).getTime():a)):(d=Math.max(i,c),v=Math.min(a,m));d<=v;){let _=!1;const E=ve.addDays(new Date(d),1).setHours(0,0,0,0);let S,$,b,D;if(t.repeat){const R=new Date(d),L=ve.formatDateLite(R);(u||t.occurrences&&t.occurrences[L])&&(u||(c=t.occurrences[L].start,g=new Date(c).setHours(0,0,0,0),m=t.occurrences[L].end),u=!0,_=!0),S=d===g,$=L===ve.formatDateLite(new Date(m)),b=new Date(S?c:d),D=ve.formatDateLite(b),$&&(u=!1)}else _=!0,S=d===c,$=v===m&&E>v,b=S?t.start:new Date(d),D=ve.formatDateLite(S?t.start:b);_&&(t.segments[D]={start:b,startTimeMinutes:S?t.startTimeMinutes:0,endTimeMinutes:$?t.endTimeMinutes:Ze,isFirstDay:S,isLastDay:$}),d=E}return t}deleteAnEvent(t){this._vuecal.emitWithEvent("event-delete",t),this._vuecal.mutableEvents=this._vuecal.mutableEvents.filter(l=>l._eid!==t._eid),this._vuecal.view.events=this._vuecal.view.events.filter(l=>l._eid!==t._eid)}checkCellOverlappingEvents(t,l){Xe=t.slice(0),pe={},t.forEach(i=>{Xe.shift(),pe[i._eid]||(pe[i._eid]={overlaps:[],start:i.start,position:0}),pe[i._eid].position=0,Xe.forEach(a=>{pe[a._eid]||(pe[a._eid]={overlaps:[],start:a.start,position:0});const c=this.eventInRange(a,i.start,i.end),m=l.overlapsPerTimeStep?ve.datesInSameTimeStep(i.start,a.start,l.timeStep):1;if(!i.background&&!i.allDay&&!a.background&&!a.allDay&&c&&m)pe[i._eid].overlaps.push(a._eid),pe[i._eid].overlaps=[...new Set(pe[i._eid].overlaps)],pe[a._eid].overlaps.push(i._eid),pe[a._eid].overlaps=[...new Set(pe[a._eid].overlaps)],pe[a._eid].position++;else{let u,d;(u=(pe[i._eid]||{overlaps:[]}).overlaps.indexOf(a._eid))>-1&&pe[i._eid].overlaps.splice(u,1),(d=(pe[a._eid]||{overlaps:[]}).overlaps.indexOf(i._eid))>-1&&pe[a._eid].overlaps.splice(d,1),pe[a._eid].position--}})});let n=0;for(const i in pe){const a=pe[i],c=a.overlaps.map(m=>({id:m,start:pe[m].start}));c.push({id:i,start:a.start}),c.sort((m,u)=>m.start<u.start?-1:m.start>u.start?1:m.id>u.id?-1:1),a.position=c.findIndex(m=>m.id===i),n=Math.max(this.getOverlapsStreak(a,pe),n)}return[pe,n]}getOverlapsStreak(t,l={}){let n=t.overlaps.length+1,i=[];return t.overlaps.forEach(a=>{i.includes(a)||t.overlaps.filter(m=>m!==a).forEach(m=>{l[m].overlaps.includes(a)||i.push(m)})}),i=[...new Set(i)],n-=i.length,n}eventInRange(t,l,n){if(t.allDay||!this._vuecal.time){const c=new Date(t.start).setHours(0,0,0,0);return new Date(t.end).setHours(23,59,0,0)>=new Date(l).setHours(0,0,0,0)&&c<=new Date(n).setHours(0,0,0,0)}const i=t.start.getTime(),a=t.end.getTime();return i<n.getTime()&&a>l.getTime()}}const Os={class:"vuecal__flex vuecal__weekdays-headings"},Ls=["onClick"],Us={class:"vuecal__flex weekday-label",grow:""},Ns={class:"full"},Ps={class:"small"},Rs={class:"xsmall"},Fs={key:0},Bs={key:0,class:"vuecal__flex vuecal__split-days-headers",grow:""};function Hs(s,t,l,n,i,a){return o(),r("div",Os,[(o(!0),r(Z,null,ee(a.headings,(c,m)=>(o(),r(Z,{key:m},[c.hide?T("",!0):(o(),r("div",{key:0,class:te(["vuecal__flex vuecal__heading",{today:c.today,clickable:a.cellHeadingsClickable}]),style:ke(a.weekdayCellStyles),onClick:u=>a.view.id==="week"&&a.selectCell(c.date,u),onDblclick:t[0]||(t[0]=u=>a.view.id==="week"&&a.vuecal.dblclickToNavigate&&l.switchToNarrowerView())},[p(Ge,{name:`slide-fade--${l.transitionDirection}`,appear:a.vuecal.transitions},{default:U(()=>[(o(),r("div",{class:"vuecal__flex",column:"",key:a.vuecal.transitions?`${m}-${c.dayOfMonth}`:!1},[e("div",Us,[ne(s.$slots,"weekday-heading",{heading:a.cleanupHeading(c),view:a.view},()=>[e("span",Ns,y(c.full),1),e("span",Ps,y(c.small),1),e("span",Rs,y(c.xsmall),1),c.dayOfMonth?(o(),r("span",Fs," "+y(c.dayOfMonth),1)):T("",!0)])]),a.vuecal.hasSplits&&a.vuecal.stickySplitLabels?(o(),r("div",Bs,[(o(!0),r(Z,null,ee(a.vuecal.daySplits,(u,d)=>(o(),r("div",{class:te(["day-split-header",u.class||!1]),key:d},[ne(s.$slots,"split-label",{split:u,view:a.view},()=>[W(y(u.label),1)])],2))),128))])):T("",!0)]))]),_:2},1032,["name","appear"])],46,Ls))],64))),128))])}const Ne=(s,t)=>{const l=s.__vccOpts||s;for(const[n,i]of t)l[n]=i;return l},Ws={inject:["vuecal","utils","view"],props:{transitionDirection:{type:String,default:"right"},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},methods:{selectCell(s,t){s.getTime()!==this.view.selectedDate.getTime()&&(this.view.selectedDate=s),this.utils.cell.selectCell(!1,s,t)},cleanupHeading:s=>({label:s.full,date:s.date,...s.today?{today:s.today}:{}})},computed:{headings(){if(!["month","week"].includes(this.view.id))return[];let s=!1;return this.weekDays.map((l,n)=>{const i=this.utils.date.addDays(this.view.startDate,this.vuecal.startWeekOnSunday&&this.vuecal.hideWeekends?n-1:n);return{hide:l.hide,full:l.label,small:l.short||l.label.substr(0,3),xsmall:l.short||l.label.substr(0,1),...this.view.id==="week"?{dayOfMonth:i.getDate(),date:i,today:!s&&this.utils.date.isToday(i)&&!s++}:{}}})},cellWidth(){return 100/(7-this.weekDays.reduce((s,t)=>s+t.hide,0))},weekdayCellStyles(){return{...this.vuecal.hideWeekdays.length?{width:`${this.cellWidth}%`}:{}}},cellHeadingsClickable(){return this.view.id==="week"&&(this.vuecal.clickToNavigate||this.vuecal.dblclickToNavigate)}}},wt=Ne(Ws,[["render",Hs]]),Ys={class:"vuecal__header"},zs={key:0,class:"vuecal__flex vuecal__menu",role:"tablist","aria-label":"Calendar views navigation"},qs=["onDragenter","onDragleave","onClick","aria-label"],Gs={key:1,class:"vuecal__title-bar"},Ks=["aria-label"],Js={class:"vuecal__flex vuecal__title",grow:""},Zs=["aria-label"],Xs={key:0,class:"vuecal__flex vuecal__split-days-headers"};function Qs(s,t,l,n,i,a){const c=$e("weekdays-headings");return o(),r("div",Ys,[l.options.hideViewSelector?T("",!0):(o(),r("div",zs,[(o(!0),r(Z,null,ee(l.viewProps.views,(m,u)=>(o(),r(Z,{key:u},[m.enabled?(o(),r("button",{key:0,class:te(["vuecal__view-btn",{"vuecal__view-btn--active":a.view.id===u,"vuecal__view-btn--highlighted":s.highlightedControl===u}]),type:"button",onDragenter:d=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(d,u,s.$data),onDragleave:d=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(d,u,s.$data),onClick:d=>a.switchView(u,null,!0),"aria-label":`${m.label} view`},y(m.label),43,qs)):T("",!0)],64))),128))])),l.options.hideTitleBar?T("",!0):(o(),r("div",Gs,[e("button",{class:te(["vuecal__arrow vuecal__arrow--prev",{"vuecal__arrow--highlighted":s.highlightedControl==="previous"}]),type:"button",onClick:t[0]||(t[0]=(...m)=>a.previous&&a.previous(...m)),onDragenter:t[1]||(t[1]=m=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(m,"previous",s.$data)),onDragleave:t[2]||(t[2]=m=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(m,"previous",s.$data)),"aria-label":`Previous ${a.view.id}`},[ne(s.$slots,"arrow-prev")],42,Ks),e("div",Js,[p(Ge,{name:l.options.transitions?`slide-fade--${a.transitionDirection}`:""},{default:U(()=>[(o(),X(Kt(a.broaderView?"button":"span"),{type:!!a.broaderView&&"button",key:`${a.view.id}${a.view.startDate.toString()}`,onClick:t[3]||(t[3]=m=>!!a.broaderView&&a.switchToBroaderView()),"aria-label":!!a.broaderView&&`Go to ${a.broaderView} view`},{default:U(()=>[ne(s.$slots,"title")]),_:3},8,["type","aria-label"]))]),_:3},8,["name"])]),l.options.todayButton?(o(),r("button",{key:0,class:te(["vuecal__today-btn",{"vuecal__today-btn--highlighted":s.highlightedControl==="today"}]),type:"button",onClick:t[4]||(t[4]=(...m)=>a.goToToday&&a.goToToday(...m)),onDragenter:t[5]||(t[5]=m=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(m,"today",s.$data)),onDragleave:t[6]||(t[6]=m=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(m,"today",s.$data)),"aria-label":"Today"},[ne(s.$slots,"today-button")],34)):T("",!0),e("button",{class:te(["vuecal__arrow vuecal__arrow--next",{"vuecal__arrow--highlighted":s.highlightedControl==="next"}]),type:"button",onClick:t[7]||(t[7]=(...m)=>a.next&&a.next(...m)),onDragenter:t[8]||(t[8]=m=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragEnter(m,"next",s.$data)),onDragleave:t[9]||(t[9]=m=>l.editEvents.drag&&a.dnd&&a.dnd.viewSelectorDragLeave(m,"next",s.$data)),"aria-label":`Next ${a.view.id}`},[ne(s.$slots,"arrow-next")],42,Zs)])),l.viewProps.weekDaysInHeader?(o(),X(c,{key:2,"week-days":l.weekDays,"transition-direction":a.transitionDirection,"switch-to-narrower-view":l.switchToNarrowerView},Qe({_:2},[s.$slots["weekday-heading"]?{name:"weekday-heading",fn:U(({heading:m,view:u})=>[ne(s.$slots,"weekday-heading",{heading:m,view:u})]),key:"0"}:void 0,s.$slots["split-label"]?{name:"split-label",fn:U(({split:m})=>[ne(s.$slots,"split-label",{split:m,view:a.view})]),key:"1"}:void 0]),1032,["week-days","transition-direction","switch-to-narrower-view"])):T("",!0),p(Ge,{name:`slide-fade--${a.transitionDirection}`},{default:U(()=>[a.showDaySplits?(o(),r("div",Xs,[(o(!0),r(Z,null,ee(l.daySplits,(m,u)=>(o(),r("div",{class:te(["day-split-header",m.class||!1]),key:u},[ne(s.$slots,"split-label",{split:m,view:a.view.id},()=>[W(y(m.label),1)])],2))),128))])):T("",!0)]),_:3},8,["name"])])}const el={inject:["vuecal","previous","next","switchView","updateSelectedDate","modules","view"],components:{WeekdaysHeadings:wt},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},hasSplits:{type:[Boolean,Number],default:!1},daySplits:{type:Array,default:()=>[]},viewProps:{type:Object,default:()=>({})},weekDays:{type:Array,default:()=>[]},switchToNarrowerView:{type:Function,default:()=>{}}},data:()=>({highlightedControl:null}),methods:{goToToday(){this.updateSelectedDate(new Date(new Date().setHours(0,0,0,0)))},switchToBroaderView(){this.transitionDirection="left",this.broaderView&&this.switchView(this.broaderView)}},computed:{transitionDirection:{get(){return this.vuecal.transitionDirection},set(s){this.vuecal.transitionDirection=s}},broaderView(){const{enabledViews:s}=this.vuecal;return s[s.indexOf(this.view.id)-1]},showDaySplits(){return this.view.id==="day"&&this.hasSplits&&this.options.stickySplitLabels&&!this.options.minSplitWidth},dnd(){return this.modules.dnd}}},tl=Ne(el,[["render",Qs]]),sl=["draggable"];function ll(s,t,l,n,i,a){return o(),r("div",{class:te(["vuecal__event",a.eventClasses]),style:ke(a.eventStyles),tabindex:"0",onFocus:t[4]||(t[4]=(...c)=>a.focusEvent&&a.focusEvent(...c)),onKeypress:t[5]||(t[5]=Oe(xe((...c)=>a.onEnterKeypress&&a.onEnterKeypress(...c),["stop"]),["enter"])),onMouseenter:t[6]||(t[6]=(...c)=>a.onMouseEnter&&a.onMouseEnter(...c)),onMouseleave:t[7]||(t[7]=(...c)=>a.onMouseLeave&&a.onMouseLeave(...c)),onTouchstart:t[8]||(t[8]=xe((...c)=>a.onTouchStart&&a.onTouchStart(...c),["stop"])),onMousedown:t[9]||(t[9]=c=>a.onMouseDown(c)),onMouseup:t[10]||(t[10]=(...c)=>a.onMouseUp&&a.onMouseUp(...c)),onTouchend:t[11]||(t[11]=(...c)=>a.onMouseUp&&a.onMouseUp(...c)),onTouchmove:t[12]||(t[12]=(...c)=>a.onTouchMove&&a.onTouchMove(...c)),onDblclick:t[13]||(t[13]=(...c)=>a.onDblClick&&a.onDblClick(...c)),draggable:a.draggable,onDragstart:t[14]||(t[14]=c=>a.draggable&&a.onDragStart(c)),onDragend:t[15]||(t[15]=c=>a.draggable&&a.onDragEnd())},[a.vuecal.editEvents.delete&&l.event.deletable?(o(),r("div",{key:0,class:"vuecal__event-delete",onClick:t[0]||(t[0]=xe((...c)=>a.deleteEvent&&a.deleteEvent(...c),["stop"])),onTouchstart:t[1]||(t[1]=xe((...c)=>a.touchDeleteEvent&&a.touchDeleteEvent(...c),["stop"]))},y(a.vuecal.texts.deleteEvent),33)):T("",!0),ne(s.$slots,"event",{event:l.event,view:a.view.id}),a.resizable?(o(),r("div",{key:1,class:"vuecal__event-resize-handle",contenteditable:"false",onMousedown:t[2]||(t[2]=xe((...c)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...c),["stop","prevent"])),onTouchstart:t[3]||(t[3]=xe((...c)=>a.onResizeHandleMouseDown&&a.onResizeHandleMouseDown(...c),["stop","prevent"]))},null,32)):T("",!0)],46,sl)}const al={inject:["vuecal","utils","modules","view","domEvents","editEvents"],props:{cellFormattedDate:{type:String,default:""},event:{type:Object,default:()=>({})},cellEvents:{type:Array,default:()=>[]},overlaps:{type:Array,default:()=>[]},eventPosition:{type:Number,default:0},overlapsStreak:{type:Number,default:0},allDay:{type:Boolean,default:!1}},data:()=>({touch:{dragThreshold:30,startX:0,startY:0,dragged:!1}}),methods:{onMouseDown(s,t=!1){if("ontouchstart"in window&&!t)return!1;const{clickHoldAnEvent:l,focusAnEvent:n,resizeAnEvent:i,dragAnEvent:a}=this.domEvents;if(n._eid===this.event._eid&&l._eid===this.event._eid)return!0;this.focusEvent(),l._eid=null,this.vuecal.editEvents.delete&&this.event.deletable&&(l.timeoutId=setTimeout(()=>{!i._eid&&!a._eid&&(l._eid=this.event._eid,this.event.deleting=!0)},l.timeout))},onMouseUp(s){this.domEvents.focusAnEvent._eid===this.event._eid&&!this.touch.dragged&&(this.domEvents.focusAnEvent.mousedUp=!0),this.touch.dragged=!1},onMouseEnter(s){s.preventDefault(),this.vuecal.emitWithEvent("event-mouse-enter",this.event)},onMouseLeave(s){s.preventDefault(),this.vuecal.emitWithEvent("event-mouse-leave",this.event)},onTouchMove(s){if(typeof this.vuecal.onEventClick!="function")return;const{clientX:t,clientY:l}=s.touches[0],{startX:n,startY:i,dragThreshold:a}=this.touch;(Math.abs(t-n)>a||Math.abs(l-i)>a)&&(this.touch.dragged=!0)},onTouchStart(s){this.touch.startX=s.touches[0].clientX,this.touch.startY=s.touches[0].clientY,this.onMouseDown(s,!0)},onEnterKeypress(s){if(typeof this.vuecal.onEventClick=="function")return this.vuecal.onEventClick(this.event,s)},onDblClick(s){if(typeof this.vuecal.onEventDblclick=="function")return this.vuecal.onEventDblclick(this.event,s)},onDragStart(s){this.dnd&&this.dnd.eventDragStart(s,this.event)},onDragEnd(){this.dnd&&this.dnd.eventDragEnd(this.event)},onResizeHandleMouseDown(){this.focusEvent(),this.domEvents.dragAnEvent._eid=null,this.domEvents.resizeAnEvent=Object.assign(this.domEvents.resizeAnEvent,{_eid:this.event._eid,start:(this.segment||this.event).start,split:this.event.split||null,segment:!!this.segment&&this.utils.date.formatDateLite(this.segment.start),originalEnd:new Date((this.segment||this.event).end),originalEndTimeMinutes:this.event.endTimeMinutes}),this.event.resizing=!0},deleteEvent(s=!1){if("ontouchstart"in window&&!s)return!1;this.utils.event.deleteAnEvent(this.event)},touchDeleteEvent(s){this.deleteEvent(!0)},cancelDeleteEvent(){this.event.deleting=!1},focusEvent(){const{focusAnEvent:s}=this.domEvents,t=s._eid;if(t!==this.event._eid){if(t){const l=this.view.events.find(n=>n._eid===t);l&&(l.focused=!1)}this.vuecal.cancelDelete(),this.vuecal.emitWithEvent("event-focus",this.event),s._eid=this.event._eid,this.event.focused=!0}}},computed:{eventDimensions(){const{startTimeMinutes:s,endTimeMinutes:t}=this.segment||this.event;let l=s-this.vuecal.timeFrom;const n=Math.max(Math.round(l*this.vuecal.timeCellHeight/this.vuecal.timeStep),0);l=Math.min(t,this.vuecal.timeTo)-this.vuecal.timeFrom;const i=Math.round(l*this.vuecal.timeCellHeight/this.vuecal.timeStep),a=Math.max(i-n,5);return{top:n,height:a}},eventStyles(){if(this.event.allDay||!this.vuecal.time||!this.event.endTimeMinutes||this.view.id==="month"||this.allDay)return{};let s=100/Math.min(this.overlaps.length+1,this.overlapsStreak),t=100/(this.overlaps.length+1)*this.eventPosition;this.vuecal.minEventWidth&&s<this.vuecal.minEventWidth&&(s=this.vuecal.minEventWidth,t=(100-this.vuecal.minEventWidth)/this.overlaps.length*this.eventPosition);const{top:l,height:n}=this.eventDimensions;return{top:`${l}px`,height:`${n}px`,width:`${s}%`,left:this.event.left&&`${this.event.left}px`||`${t}%`}},eventClasses(){const{isFirstDay:s,isLastDay:t}=this.segment||{};return{[this.event.class]:!!this.event.class,"vuecal__event--focus":this.event.focused,"vuecal__event--resizing":this.event.resizing,"vuecal__event--background":this.event.background,"vuecal__event--deletable":this.event.deleting,"vuecal__event--all-day":this.event.allDay,"vuecal__event--dragging":!this.event.draggingStatic&&this.event.dragging,"vuecal__event--static":this.event.dragging&&this.event.draggingStatic,"vuecal__event--multiple-days":!!this.segment,"event-start":this.segment&&s&&!t,"event-middle":this.segment&&!s&&!t,"event-end":this.segment&&t&&!s}},segment(){return this.event.segments&&this.event.segments[this.cellFormattedDate]||null},draggable(){const{draggable:s,background:t,daysCount:l}=this.event;return this.vuecal.editEvents.drag&&s&&!t&&l===1},resizable(){const{editEvents:s,time:t}=this.vuecal;return s.resize&&this.event.resizable&&t&&!this.allDay&&(!this.segment||this.segment&&this.segment.isLastDay)&&this.view.id!=="month"},dnd(){return this.modules.dnd}}},il=Ne(al,[["render",ll]]),nl=["data-split","aria-label","onTouchstart","onMousedown","onDragover","onDrop"],ol={key:0,class:"cell-time-labels"},rl=["innerHTML"],dl={key:2,class:"vuecal__cell-events"},ul=["title"];function cl(s,t,l,n,i,a){const c=$e("event");return o(),X(Jt,{class:te(["vuecal__cell",a.cellClasses]),name:`slide-fade--${a.transitionDirection}`,tag:"div",appear:l.options.transitions,style:ke(a.cellStyles)},{default:U(()=>[(o(!0),r(Z,null,ee(a.splitsCount?a.splits:1,(m,u)=>(o(),r("div",{class:te(["vuecal__flex vuecal__cell-content",a.splitsCount&&a.splitClasses(m)]),key:l.options.transitions?`${a.view.id}-${l.data.content}-${u}`:u,"data-split":a.splitsCount?m.id:!1,column:"",tabindex:"0","aria-label":l.data.content,onFocus:t[0]||(t[0]=d=>a.onCellFocus(d)),onKeypress:t[1]||(t[1]=Oe(d=>a.onCellkeyPressEnter(d),["enter"])),onTouchstart:d=>!a.isDisabled&&a.onCellTouchStart(d,a.splitsCount?m.id:null),onMousedown:d=>!a.isDisabled&&a.onCellMouseDown(d,a.splitsCount?m.id:null),onClick:t[2]||(t[2]=d=>!a.isDisabled&&a.onCellClick(d)),onDblclick:t[3]||(t[3]=d=>!a.isDisabled&&a.onCellDblClick(d)),onContextmenu:t[4]||(t[4]=d=>!a.isDisabled&&l.options.cellContextmenu&&a.onCellContextMenu(d)),onDragenter:t[5]||(t[5]=d=>!a.isDisabled&&l.editEvents.drag&&a.dnd&&a.dnd.cellDragEnter(d,s.$data,l.data.startDate)),onDragover:d=>!a.isDisabled&&l.editEvents.drag&&a.dnd&&a.dnd.cellDragOver(d,s.$data,l.data.startDate,a.splitsCount?m.id:null),onDragleave:t[6]||(t[6]=d=>!a.isDisabled&&l.editEvents.drag&&a.dnd&&a.dnd.cellDragLeave(d,s.$data,l.data.startDate)),onDrop:d=>!a.isDisabled&&l.editEvents.drag&&a.dnd&&a.dnd.cellDragDrop(d,s.$data,l.data.startDate,a.splitsCount?m.id:null)},[l.options.showTimeInCells&&l.options.time&&a.isWeekOrDayView&&!l.allDay?(o(),r("div",ol,[(o(!0),r(Z,null,ee(a.vuecal.timeCells,(d,v)=>(o(),r("span",{class:"cell-time-label",key:v},y(d.label),1))),128))])):T("",!0),a.isWeekOrDayView&&!l.allDay&&a.specialHours.length?(o(!0),r(Z,{key:1},ee(a.specialHours,(d,v)=>(o(),r("div",{class:te(["vuecal__special-hours",`vuecal__special-hours--day${d.day} ${d.class}`]),style:ke(`height: ${d.height}px;top: ${d.top}px`)},[d.label?(o(),r("div",{key:0,class:"special-hours-label",innerHTML:d.label},null,8,rl)):T("",!0)],6))),256)):T("",!0),ne(s.$slots,"cell-content",{events:a.events,selectCell:d=>a.selectCell(d,!0),split:a.splitsCount?m:!1}),a.eventsCount&&(a.isWeekOrDayView||a.view.id==="month"&&l.options.eventsOnMonthView)?(o(),r("div",dl,[(o(!0),r(Z,null,ee(a.splitsCount?m.events:a.events,(d,v)=>(o(),X(c,{key:v,"cell-formatted-date":l.data.formattedDate,event:d,"all-day":l.allDay,"cell-events":a.splitsCount?m.events:a.events,overlaps:((a.splitsCount?m.overlaps[d._eid]:s.cellOverlaps[d._eid])||[]).overlaps,"event-position":((a.splitsCount?m.overlaps[d._eid]:s.cellOverlaps[d._eid])||[]).position,"overlaps-streak":a.splitsCount?m.overlapsStreak:s.cellOverlapsStreak},{event:U(({event:g,view:_})=>[ne(s.$slots,"event",{view:_,event:g})]),_:2},1032,["cell-formatted-date","event","all-day","cell-events","overlaps","event-position","overlaps-streak"]))),128))])):T("",!0)],42,nl))),128)),a.timelineVisible?(o(),r("div",{class:"vuecal__now-line",style:ke(`top: ${a.todaysTimePosition}px`),key:l.options.transitions?`${a.view.id}-now-line`:"now-line",title:a.utils.date.formatTime(a.vuecal.now)},null,12,ul)):T("",!0)]),_:3},8,["class","name","appear","style"])}const ml={inject:["vuecal","utils","modules","view","domEvents"],components:{Event:il},props:{options:{type:Object,default:()=>({})},editEvents:{type:Object,required:!0},data:{type:Object,required:!0},cellSplits:{type:Array,default:()=>[]},minTimestamp:{type:[Number,null],default:null},maxTimestamp:{type:[Number,null],default:null},cellWidth:{type:[Number,Boolean],default:!1},allDay:{type:Boolean,default:!1}},data:()=>({cellOverlaps:{},cellOverlapsStreak:1,timeAtCursor:null,highlighted:!1,highlightedSplit:null}),methods:{getSplitAtCursor({target:s}){let l=s.classList.contains("vuecal__cell-split")?s:this.vuecal.findAncestor(s,"vuecal__cell-split");return l&&(l=l.attributes["data-split"].value,parseInt(l).toString()===l.toString()&&(l=parseInt(l))),l||null},splitClasses(s){return{"vuecal__cell-split":!0,"vuecal__cell-split--highlighted":this.highlightedSplit===s.id,[s.class]:!!s.class}},checkCellOverlappingEvents(){this.options.time&&this.eventsCount&&!this.splitsCount&&(this.eventsCount===1?(this.cellOverlaps=[],this.cellOverlapsStreak=1):[this.cellOverlaps,this.cellOverlapsStreak]=this.utils.event.checkCellOverlappingEvents(this.events,this.options))},isDOMElementAnEvent(s){return this.vuecal.isDOMElementAnEvent(s)},selectCell(s,t=!1){const l=this.splitsCount?this.getSplitAtCursor(s):null;this.utils.cell.selectCell(t,this.timeAtCursor,l),this.timeAtCursor=null},onCellkeyPressEnter(s){this.isSelected||this.onCellFocus(s);const t=this.splitsCount?this.getSplitAtCursor(s):null;this.utils.cell.keyPressEnterCell(this.timeAtCursor,t),this.timeAtCursor=null},onCellFocus(s){if(!this.isSelected&&!this.isDisabled){this.isSelected=this.data.startDate;const t=this.splitsCount?this.getSplitAtCursor(s):null,l=this.timeAtCursor||this.data.startDate;this.vuecal.$emit("cell-focus",t?{date:l,split:t}:l)}},onCellMouseDown(s,t=null,l=!1){if("ontouchstart"in window&&!l)return!1;this.isSelected||this.onCellFocus(s);const{clickHoldACell:n,focusAnEvent:i}=this.domEvents;this.domEvents.cancelClickEventCreation=!1,n.eventCreated=!1,this.timeAtCursor=new Date(this.data.startDate);const{minutes:a,cursorCoords:{y:c}}=this.vuecal.minutesAtCursor(s);this.timeAtCursor.setMinutes(a);const m=this.isDOMElementAnEvent(s.target);!m&&i._eid&&((this.view.events.find(u=>u._eid===i._eid)||{}).focused=!1),this.editEvents.create&&!m&&this.setUpEventCreation(s,c)},setUpEventCreation(s,t){if(this.options.dragToCreateEvent&&["week","day"].includes(this.view.id)){const{dragCreateAnEvent:l}=this.domEvents;if(l.startCursorY=t,l.split=this.splitsCount?this.getSplitAtCursor(s):null,l.start=this.timeAtCursor,this.options.snapToTime){let n=this.timeAtCursor.getHours()*60+this.timeAtCursor.getMinutes();const i=n+this.options.snapToTime/2;n=i-i%this.options.snapToTime,l.start.setHours(0,n,0,0)}}else this.options.cellClickHold&&["month","week","day"].includes(this.view.id)&&this.setUpCellHoldTimer(s)},setUpCellHoldTimer(s){const{clickHoldACell:t}=this.domEvents;t.cellId=`${this.vuecal._.uid}_${this.data.formattedDate}`,t.split=this.splitsCount?this.getSplitAtCursor(s):null,t.timeoutId=setTimeout(()=>{if(t.cellId&&!this.domEvents.cancelClickEventCreation){const{_eid:l}=this.utils.event.createAnEvent(this.timeAtCursor,null,t.split?{split:t.split}:{});t.eventCreated=l}},t.timeout)},onCellTouchStart(s,t=null){this.onCellMouseDown(s,t,!0)},onCellClick(s){this.isDOMElementAnEvent(s.target)||this.selectCell(s)},onCellDblClick(s){const t=new Date(this.data.startDate);t.setMinutes(this.vuecal.minutesAtCursor(s).minutes);const l=this.splitsCount?this.getSplitAtCursor(s):null;this.vuecal.$emit("cell-dblclick",l?{date:t,split:l}:t),this.options.dblclickToNavigate&&this.vuecal.switchToNarrowerView()},onCellContextMenu(s){s.stopPropagation(),s.preventDefault();const t=new Date(this.data.startDate),{cursorCoords:l,minutes:n}=this.vuecal.minutesAtCursor(s);t.setMinutes(n);const i=this.splitsCount?this.getSplitAtCursor(s):null;this.vuecal.$emit("cell-contextmenu",{date:t,...l,...i||{},e:s})}},computed:{dnd(){return this.modules.dnd},nowInMinutes(){return this.utils.date.dateToMinutes(this.vuecal.now)},isBeforeMinDate(){return this.minTimestamp!==null&&this.minTimestamp>this.data.endDate.getTime()},isAfterMaxDate(){return this.maxTimestamp&&this.maxTimestamp<this.data.startDate.getTime()},isDisabled(){const{disableDays:s}=this.options,{isYearsOrYearView:t}=this.vuecal;return s.length&&s.includes(this.data.formattedDate)&&!t?!0:this.isBeforeMinDate||this.isAfterMaxDate},isSelected:{get(){let s=!1;const{selectedDate:t}=this.view;return this.view.id==="years"?s=t.getFullYear()===this.data.startDate.getFullYear():this.view.id==="year"?s=t.getFullYear()===this.data.startDate.getFullYear()&&t.getMonth()===this.data.startDate.getMonth():s=t.getTime()===this.data.startDate.getTime(),s},set(s){this.view.selectedDate=s,this.vuecal.$emit("update:selected-date",this.view.selectedDate)}},isWeekOrDayView(){return["week","day"].includes(this.view.id)},transitionDirection(){return this.vuecal.transitionDirection},specialHours(){return this.data.specialHours.map(s=>{let{from:t,to:l}=s;return t=Math.max(t,this.options.timeFrom),l=Math.min(l,this.options.timeTo),{...s,height:(l-t)*this.timeScale,top:(t-this.options.timeFrom)*this.timeScale}})},events(){const{startDate:s,endDate:t}=this.data;let l=[];if(!(["years","year"].includes(this.view.id)&&!this.options.eventsCountOnYearView)){if(l=this.view.events.slice(0),this.view.id==="month"&&l.push(...this.view.outOfScopeEvents),l=l.filter(n=>this.utils.event.eventInRange(n,s,t)),this.options.showAllDayEvents&&this.view.id!=="month"&&(l=l.filter(n=>!!n.allDay===this.allDay)),this.options.time&&this.isWeekOrDayView&&!this.allDay){const{timeFrom:n,timeTo:i}=this.options;l=l.filter(a=>{const c=a.daysCount>1&&a.segments[this.data.formattedDate]||{},m=a.daysCount===1&&a.startTimeMinutes<i&&a.endTimeMinutes>n,u=a.daysCount>1&&c.startTimeMinutes<i&&c.endTimeMinutes>n;return a.allDay||m||u||!1})}this.options.time&&this.isWeekOrDayView&&!(this.options.showAllDayEvents&&this.allDay)&&l.sort((n,i)=>n.start<i.start?-1:1),this.cellSplits.length||this.$nextTick(this.checkCellOverlappingEvents)}return l},eventsCount(){return this.events.length},splits(){return this.cellSplits.map((s,t)=>{const l=this.events.filter(a=>a.split===s.id),[n,i]=this.utils.event.checkCellOverlappingEvents(l.filter(a=>!a.background&&!a.allDay),this.options);return{...s,overlaps:n,overlapsStreak:i,events:l}})},splitsCount(){return this.splits.length},cellClasses(){return{[this.data.class]:!!this.data.class,"vuecal__cell--current":this.data.current,"vuecal__cell--today":this.data.today,"vuecal__cell--out-of-scope":this.data.outOfScope,"vuecal__cell--before-min":this.isDisabled&&this.isBeforeMinDate,"vuecal__cell--after-max":this.isDisabled&&this.isAfterMaxDate,"vuecal__cell--disabled":this.isDisabled,"vuecal__cell--selected":this.isSelected,"vuecal__cell--highlighted":this.highlighted,"vuecal__cell--has-splits":this.splitsCount,"vuecal__cell--has-events":this.eventsCount}},cellStyles(){return{...this.cellWidth?{width:`${this.cellWidth}%`}:{}}},timelineVisible(){const{time:s,timeTo:t}=this.options;return this.data.today&&this.isWeekOrDayView&&s&&!this.allDay&&this.nowInMinutes<=t},todaysTimePosition(){if(!this.data.today||!this.options.time)return;const s=this.nowInMinutes-this.options.timeFrom;return Math.round(s*this.timeScale)},timeScale(){return this.options.timeCellHeight/this.options.timeStep}}},_t=Ne(ml,[["render",cl]]),vl={key:0,class:"vuecal__all-day-text",style:{width:"3em"}};function pl(s,t,l,n,i,a){const c=$e("vuecal-cell");return o(),r("div",{class:"vuecal__flex vuecal__all-day",style:ke(l.cellOrSplitMinWidth&&{height:l.height})},[l.cellOrSplitMinWidth?T("",!0):(o(),r("div",vl,[e("span",null,y(l.label),1)])),e("div",{class:te(["vuecal__flex vuecal__cells",`${a.view.id}-view`]),grow:"",style:ke(l.cellOrSplitMinWidth?`min-width: ${l.cellOrSplitMinWidth}px`:"")},[(o(!0),r(Z,null,ee(l.cells,(m,u)=>(o(),X(c,{key:u,options:l.options,"edit-events":a.editEvents,data:m,"all-day":!0,"cell-width":l.options.hideWeekdays.length&&(a.vuecal.isWeekView||a.vuecal.isMonthView)&&a.vuecal.cellWidth,"min-timestamp":l.options.minTimestamp,"max-timestamp":l.options.maxTimestamp,"cell-splits":l.daySplits},{event:U(({event:d,view:v})=>[ne(s.$slots,"event",{view:v,event:d})]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],6)],4)}const gl={inject:["vuecal","view","editEvents"],components:{"vuecal-cell":_t},props:{options:{type:Object,required:!0},cells:{type:Array,required:!0},label:{type:String,required:!0},daySplits:{type:Array,default:()=>[]},shortEvents:{type:Boolean,default:!0},height:{type:String,default:""},cellOrSplitMinWidth:{type:Number,default:null}},computed:{hasCellOrSplitWidth(){return!!(this.options.minCellWidth||this.daySplits.length&&this.options.minSplitWidth)}}},hl=Ne(gl,[["render",pl]]),yl=["lang"],fl={class:"default"},bl={key:0,class:"vuecal__flex vuecal__body",grow:""},wl=["onBlur","innerHTML"],_l=["innerHTML"],xl=["innerHTML"],kl={class:"vuecal__flex",row:"",grow:""},Dl={key:0,class:"vuecal__time-column"},Cl={class:"vuecal__time-cell-label"},Tl={key:1,class:"vuecal__flex vuecal__week-numbers",column:""},El=["wrap","column"],Sl=["onBlur","innerHTML"],jl=["innerHTML"],Ml=["innerHTML"],$l=["wrap"],Vl=["innerHTML"],Al=["innerHTML"],Il={key:2,class:"vuecal__cell-events-count"},Ol={key:3,class:"vuecal__no-event"},Ll=["onBlur","innerHTML"],Ul=["innerHTML"],Nl={key:2,class:"vuecal__event-time"},Pl={key:0},Rl={key:1,class:"days-to-end"},Fl=["innerHTML"],Bl={key:0,class:"vuecal__scrollbar-check"};function Hl(s,t,l,n,i,a){const c=$e("vuecal-header"),m=$e("all-day-bar"),u=$e("weekdays-headings"),d=$e("vuecal-cell");return o(),r("div",{class:te(["vuecal__flex vuecal",a.cssClasses]),column:"",ref:"vuecal",lang:l.locale},[p(c,{options:s.$props,"edit-events":a.editEvents,"view-props":{views:a.views,weekDaysInHeader:a.weekDaysInHeader},"week-days":a.weekDays,"has-splits":a.hasSplits,"day-splits":a.daySplits,"switch-to-narrower-view":a.switchToNarrowerView},Qe({"arrow-prev":U(()=>[ne(s.$slots,"arrow-prev",{},()=>[t[0]||(t[0]=W(" ")),t[1]||(t[1]=e("i",{class:"angle"},null,-1)),t[2]||(t[2]=W(" "))])]),"arrow-next":U(()=>[ne(s.$slots,"arrow-next",{},()=>[t[3]||(t[3]=W(" ")),t[4]||(t[4]=e("i",{class:"angle"},null,-1)),t[5]||(t[5]=W(" "))])]),"today-button":U(()=>[ne(s.$slots,"today-button",{},()=>[e("span",fl,y(i.texts.today),1)])]),title:U(()=>[ne(s.$slots,"title",{title:a.viewTitle,view:i.view},()=>[W(y(a.viewTitle),1)])]),_:2},[s.$slots["weekday-heading"]?{name:"weekday-heading",fn:U(({heading:v,view:g})=>[ne(s.$slots,"weekday-heading",{heading:v,view:g})]),key:"0"}:void 0,s.$slots["split-label"]?{name:"split-label",fn:U(({split:v})=>[ne(s.$slots,"split-label",{split:v,view:i.view.id})]),key:"1"}:void 0]),1032,["options","edit-events","view-props","week-days","has-splits","day-splits","switch-to-narrower-view"]),l.hideBody?T("",!0):(o(),r("div",bl,[p(Ge,{name:`slide-fade--${i.transitionDirection}`,appear:l.transitions},{default:U(()=>[(o(),r("div",{class:"vuecal__flex",style:{"min-width":"100%"},key:l.transitions?i.view.id:!1,column:""},[l.showAllDayEvents&&a.hasTimeColumn&&(!a.cellOrSplitMinWidth||a.isDayView&&!l.minSplitWidth)?(o(),X(m,dt(ut({key:0},a.allDayBar)),{event:U(({event:v,view:g})=>[ne(s.$slots,"event",{view:g,event:v},()=>[a.editEvents.title&&v.titleEditable?(o(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:_=>a.onEventTitleBlur(_,v),innerHTML:v.title},null,40,wl)):v.title?(o(),r("div",{key:1,class:"vuecal__event-title",innerHTML:v.title},null,8,_l)):T("",!0),v.content&&!a.hasShortEvents&&!a.isShortMonthView?(o(),r("div",{key:2,class:"vuecal__event-content",innerHTML:v.content},null,8,xl)):T("",!0)])]),_:3},16)):T("",!0),e("div",{class:te(["vuecal__bg",{vuecal__flex:!a.hasTimeColumn}]),column:""},[e("div",kl,[a.hasTimeColumn?(o(),r("div",Dl,[l.showAllDayEvents&&a.cellOrSplitMinWidth&&!(a.isDayView&&!l.minSplitWidth)?(o(),r("div",{key:0,class:"vuecal__all-day-text",style:ke({height:a.allDayBar.height})},[e("span",null,y(i.texts.allDay),1)],4)):T("",!0),(o(!0),r(Z,null,ee(a.timeCells,(v,g)=>(o(),r("div",{class:"vuecal__time-cell",key:g,style:ke(`height: ${l.timeCellHeight}px`)},[ne(s.$slots,"time-cell",{hours:v.hours,minutes:v.minutes},()=>[t[6]||(t[6]=e("span",{class:"vuecal__time-cell-line"},null,-1)),e("span",Cl,y(v.label),1)])],4))),128))])):T("",!0),l.showWeekNumbers&&a.isMonthView?(o(),r("div",Tl,[(o(),r(Z,null,ee(6,v=>e("div",{class:"vuecal__flex vuecal__week-number-cell",key:v,grow:""},[ne(s.$slots,"week-number-cell",{week:a.getWeekNumber(v-1)},()=>[W(y(a.getWeekNumber(v-1)),1)])])),64))])):T("",!0),e("div",{class:te(["vuecal__flex vuecal__cells",`${i.view.id}-view`]),grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,column:!!a.cellOrSplitMinWidth},[a.cellOrSplitMinWidth&&a.isWeekView?(o(),X(u,{key:0,"transition-direction":i.transitionDirection,"week-days":a.weekDays,"switch-to-narrower-view":a.switchToNarrowerView,style:ke(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},Qe({_:2},[s.$slots["weekday-heading"]?{name:"weekday-heading",fn:U(({heading:v,view:g})=>[ne(s.$slots,"weekday-heading",{heading:v,view:g})]),key:"0"}:void 0,s.$slots["split-label"]?{name:"split-label",fn:U(({split:v})=>[ne(s.$slots,"split-label",{split:v,view:i.view.id})]),key:"1"}:void 0]),1032,["transition-direction","week-days","switch-to-narrower-view","style"])):a.hasSplits&&l.stickySplitLabels&&l.minSplitWidth?(o(),r("div",{key:1,class:"vuecal__flex vuecal__split-days-headers",style:ke(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(o(!0),r(Z,null,ee(a.daySplits,(v,g)=>(o(),r("div",{class:te(["day-split-header",v.class||!1]),key:g},[ne(s.$slots,"split-label",{split:v,view:i.view.id},()=>[W(y(v.label),1)])],2))),128))],4)):T("",!0),l.showAllDayEvents&&a.hasTimeColumn&&(a.isWeekView&&a.cellOrSplitMinWidth||a.isDayView&&a.hasSplits&&l.minSplitWidth)?(o(),X(m,dt(ut({key:2},a.allDayBar)),{event:U(({event:v,view:g})=>[ne(s.$slots,"event",{view:g,event:v},()=>[a.editEvents.title&&v.titleEditable?(o(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:_=>a.onEventTitleBlur(_,v),innerHTML:v.title},null,40,Sl)):v.title?(o(),r("div",{key:1,class:"vuecal__event-title",innerHTML:v.title},null,8,jl)):T("",!0),v.content&&!a.hasShortEvents&&!a.isShortMonthView?(o(),r("div",{key:2,class:"vuecal__event-content",innerHTML:v.content},null,8,Ml)):T("",!0)])]),_:3},16)):T("",!0),e("div",{class:"vuecal__flex",ref:v=>i.cellsEl=v,grow:"",wrap:!a.cellOrSplitMinWidth||!a.isWeekView,style:ke(a.cellOrSplitMinWidth?`min-width: ${a.cellOrSplitMinWidth}px`:"")},[(o(!0),r(Z,null,ee(a.viewCells,(v,g)=>(o(),X(d,{key:g,options:s.$props,"edit-events":a.editEvents,data:v,"cell-width":l.hideWeekdays.length&&(a.isWeekView||a.isMonthView)&&a.cellWidth,"min-timestamp":a.minTimestamp,"max-timestamp":a.maxTimestamp,"cell-splits":a.hasSplits&&a.daySplits||[]},{"cell-content":U(({events:_,split:E,selectCell:S})=>[ne(s.$slots,"cell-content",{cell:v,view:i.view,goNarrower:S,events:_},()=>[E&&!l.stickySplitLabels?(o(),r("div",{key:0,class:"split-label",innerHTML:E.label},null,8,Vl)):T("",!0),v.content?(o(),r("div",{key:1,class:"vuecal__cell-date",innerHTML:v.content},null,8,Al)):T("",!0),(a.isMonthView&&!l.eventsOnMonthView||a.isYearsOrYearView&&l.eventsCountOnYearView)&&_.length?(o(),r("div",Il,[ne(s.$slots,"events-count",{view:i.view,events:_},()=>[W(y(_.length),1)])])):T("",!0),!a.cellOrSplitHasEvents(_,E)&&a.isWeekOrDayView?(o(),r("div",Ol,[ne(s.$slots,"no-event",{},()=>[W(y(i.texts.noEvent),1)])])):T("",!0)])]),event:U(({event:_,view:E})=>[ne(s.$slots,"event",{view:E,event:_},()=>[a.editEvents.title&&_.titleEditable?(o(),r("div",{key:0,class:"vuecal__event-title vuecal__event-title--edit",contenteditable:"",onBlur:S=>a.onEventTitleBlur(S,_),innerHTML:_.title},null,40,Ll)):_.title?(o(),r("div",{key:1,class:"vuecal__event-title",innerHTML:_.title},null,8,Ul)):T("",!0),l.time&&!_.allDay&&!(a.isMonthView&&(_.allDay||l.showAllDayEvents==="short"))&&!a.isShortMonthView?(o(),r("div",Nl,[W(y(i.utils.date.formatTime(_.start,a.TimeFormat)),1),_.endTimeMinutes?(o(),r("span",Pl," - "+y(i.utils.date.formatTime(_.end,a.TimeFormat,null,!0)),1)):T("",!0),_.daysCount>1&&(_.segments[v.formattedDate]||{}).isFirstDay?(o(),r("small",Rl," +"+y(_.daysCount-1)+y((i.texts.day[0]||"").toLowerCase()),1)):T("",!0)])):T("",!0),_.content&&!(a.isMonthView&&_.allDay&&l.showAllDayEvents==="short")&&!a.isShortMonthView?(o(),r("div",{key:3,class:"vuecal__event-content",innerHTML:_.content},null,8,Fl)):T("",!0)])]),"no-event":U(()=>[ne(s.$slots,"no-event",{},()=>[W(y(i.texts.noEvent),1)])]),_:2},1032,["options","edit-events","data","cell-width","min-timestamp","max-timestamp","cell-splits"]))),128))],12,$l)],10,El)])],2)]))]),_:3},8,["name","appear"]),i.ready?T("",!0):(o(),r("div",Bl,t[7]||(t[7]=[e("div",null,null,-1)])))]))],10,yl)}const Be=1440,qe={weekDays:Array(7).fill(""),weekDaysShort:[],months:Array(12).fill(""),years:"",year:"",month:"",week:"",day:"",today:"",noEvent:"",allDay:"",deleteEvent:"",createEvent:"",dateFormat:"dddd MMMM D, YYYY",am:"am",pm:"pm"},pt=["years","year","month","week","day"],gt=new Ms(qe),Wl={name:"vue-cal",components:{"vuecal-cell":_t,"vuecal-header":tl,WeekdaysHeadings:wt,AllDayBar:hl},provide(){return{vuecal:this,utils:this.utils,modules:this.modules,previous:this.previous,next:this.next,switchView:this.switchView,updateSelectedDate:this.updateSelectedDate,editEvents:this.editEvents,view:this.view,domEvents:this.domEvents}},props:{activeView:{type:String,default:"week"},allDayBarHeight:{type:[String,Number],default:"25px"},cellClickHold:{type:Boolean,default:!0},cellContextmenu:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:!1},dblclickToNavigate:{type:Boolean,default:!0},disableDatePrototypes:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},disableViews:{type:Array,default:()=>[]},dragToCreateEvent:{type:Boolean,default:!0},dragToCreateThreshold:{type:Number,default:15},editableEvents:{type:[Boolean,Object],default:!1},events:{type:Array,default:()=>[]},eventsCountOnYearView:{type:Boolean,default:!1},eventsOnMonthView:{type:[Boolean,String],default:!1},hideBody:{type:Boolean,default:!1},hideTitleBar:{type:Boolean,default:!1},hideViewSelector:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:[String,Object],default:"en"},maxDate:{type:[String,Date],default:""},minCellWidth:{type:Number,default:0},minDate:{type:[String,Date],default:""},minEventWidth:{type:Number,default:0},minSplitWidth:{type:Number,default:0},onEventClick:{type:[Function,null],default:null},onEventCreate:{type:[Function,null],default:null},onEventDblclick:{type:[Function,null],default:null},overlapsPerTimeStep:{type:Boolean,default:!1},resizeX:{type:Boolean,default:!1},selectedDate:{type:[String,Date],default:""},showAllDayEvents:{type:[Boolean,String],default:!1},showTimeInCells:{type:Boolean,default:!1},showWeekNumbers:{type:[Boolean,String],default:!1},snapToTime:{type:Number,default:0},small:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},splitDays:{type:Array,default:()=>[]},startWeekOnSunday:{type:Boolean,default:!1},stickySplitLabels:{type:Boolean,default:!1},time:{type:Boolean,default:!0},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:Be},todayButton:{type:Boolean,default:!1},transitions:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},watchRealTime:{type:Boolean,default:!1},xsmall:{type:Boolean,default:!1}},data(){return{ready:!1,texts:{...qe},utils:{date:(this.disableDatePrototypes?gt.removePrototypes():!1)||gt,cell:null,event:null},modules:{dnd:null},cellsEl:null,view:{id:"",title:"",startDate:null,endDate:null,firstCellDate:null,lastCellDate:null,selectedDate:null,events:[]},eventIdIncrement:1,now:new Date,timeTickerIds:[null,null],domEvents:{resizeAnEvent:{_eid:null,start:null,split:null,segment:null,originalEndTimeMinutes:0,originalEnd:null,end:null,startCell:null,endCell:null},dragAnEvent:{_eid:null},dragCreateAnEvent:{startCursorY:null,start:null,split:null,event:null},focusAnEvent:{_eid:null,mousedUp:!1},clickHoldAnEvent:{_eid:null,timeout:1200,timeoutId:null},dblTapACell:{taps:0,timeout:500},clickHoldACell:{cellId:null,split:null,timeout:1200,timeoutId:null,eventCreated:!1},cancelClickEventCreation:!1},mutableEvents:[],transitionDirection:"right"}},methods:{async loadLocale(s){if(typeof this.locale=="object"){this.texts=Object.assign({},qe,s),this.utils.date.updateTexts(this.texts);return}const t=await js(Object.assign({"./i18n/ar.json":()=>Q(()=>import("./ar.es-bitOgb9K.js"),[]),"./i18n/bg.json":()=>Q(()=>import("./bg.es-5tp0KQRo.js"),[]),"./i18n/bn.json":()=>Q(()=>import("./bn.es-C_qR0y0-.js"),[]),"./i18n/bs.json":()=>Q(()=>import("./bs.es-DduooXS8.js"),[]),"./i18n/ca.json":()=>Q(()=>import("./ca.es-DYDNDJFJ.js"),[]),"./i18n/cs.json":()=>Q(()=>import("./cs.es-CvnAvfoI.js"),[]),"./i18n/da.json":()=>Q(()=>import("./da.es-C_eJXDX3.js"),[]),"./i18n/de.json":()=>Q(()=>import("./de.es-Cp-R9E16.js"),[]),"./i18n/el.json":()=>Q(()=>import("./el.es-BZ44a1Tb.js"),[]),"./i18n/en.json":()=>Q(()=>import("./en.es-DwVNOttH.js"),[]),"./i18n/es.json":()=>Q(()=>import("./es.es-DO8PaQ_q.js"),[]),"./i18n/et.json":()=>Q(()=>import("./et.es-DdRIcUrz.js"),[]),"./i18n/fa.json":()=>Q(()=>import("./fa.es-XN0av8Tx.js"),[]),"./i18n/fi.json":()=>Q(()=>import("./fi.es-B0Iy6aas.js"),[]),"./i18n/fr.json":()=>Q(()=>import("./fr.es-B7WXlprl.js"),[]),"./i18n/he.json":()=>Q(()=>import("./he.es-BWEk5prp.js"),[]),"./i18n/hr.json":()=>Q(()=>import("./hr.es-B_iqHQyr.js"),[]),"./i18n/hu.json":()=>Q(()=>import("./hu.es-D_t4Ibxf.js"),[]),"./i18n/id.json":()=>Q(()=>import("./id.es-CzHAK-XV.js"),[]),"./i18n/is.json":()=>Q(()=>import("./is.es-DChRpym4.js"),[]),"./i18n/it.json":()=>Q(()=>import("./it.es-CquQA5xx.js"),[]),"./i18n/ja.json":()=>Q(()=>import("./ja.es-B19gsG6H.js"),[]),"./i18n/ka.json":()=>Q(()=>import("./ka.es-CuOe65jc.js"),[]),"./i18n/ko.json":()=>Q(()=>import("./ko.es-CsMl2USK.js"),[]),"./i18n/lt.json":()=>Q(()=>import("./lt.es-vqgjGyMx.js"),[]),"./i18n/mn.json":()=>Q(()=>import("./mn.es-BmdwFdas.js"),[]),"./i18n/nl.json":()=>Q(()=>import("./nl.es-CFxVMCWy.js"),[]),"./i18n/no.json":()=>Q(()=>import("./no.es-qRcuRMwl.js"),[]),"./i18n/pl.json":()=>Q(()=>import("./pl.es-BQ3a0ltx.js"),[]),"./i18n/pt-br.json":()=>Q(()=>import("./pt-br.es-U9bVHsgs.js"),[]),"./i18n/pt-pt.json":()=>Q(()=>import("./pt-pt.es-U9bVHsgs.js"),[]),"./i18n/ro.json":()=>Q(()=>import("./ro.es-ldjMjt3l.js"),[]),"./i18n/ru.json":()=>Q(()=>import("./ru.es-CS-QKsYL.js"),[]),"./i18n/sk.json":()=>Q(()=>import("./sk.es-CAe8sEvL.js"),[]),"./i18n/sl.json":()=>Q(()=>import("./sl.es-rdzOxu_X.js"),[]),"./i18n/sq.json":()=>Q(()=>import("./sq.es-BY5E06HI.js"),[]),"./i18n/sr.json":()=>Q(()=>import("./sr.es-QPseRVBy.js"),[]),"./i18n/sv.json":()=>Q(()=>import("./sv.es-BfPUYcV1.js"),[]),"./i18n/tr.json":()=>Q(()=>import("./tr.es-Cl6kz_IH.js"),[]),"./i18n/uk.json":()=>Q(()=>import("./uk.es-DBEtNQnZ.js"),[]),"./i18n/vi.json":()=>Q(()=>import("./vi.es-Bx2g_1jx.js"),[]),"./i18n/zh-cn.json":()=>Q(()=>import("./zh-cn.es-BWMmCH-R.js"),[]),"./i18n/zh-hk.json":()=>Q(()=>import("./zh-hk.es-DFZ0bKvi.js"),[])}),`./i18n/${s}.json`,3);this.texts=Object.assign({},qe,t),this.utils.date.updateTexts(this.texts)},loadDragAndDrop(){Q(()=>import("./drag-and-drop.es-CbCm7IHa.js"),[]).then(s=>{const{DragAndDrop:t}=s;this.modules.dnd=new t(this)}).catch(()=>console.warn("Vue Cal: Missing drag & drop module."))},validateView(s){return pt.includes(s)||(console.error(`Vue Cal: invalid active-view parameter provided: "${s}".
A valid view must be one of: ${pt.join(", ")}.`),s="week"),this.enabledViews.includes(s)||(console.warn(`Vue Cal: the provided active-view "${s}" is disabled. Using the "${this.enabledViews[0]}" view instead.`),s=this.enabledViews[0]),s},switchToNarrowerView(s=null){this.transitionDirection="right";const t=this.enabledViews[this.enabledViews.indexOf(this.view.id)+1];t&&this.switchView(t,s)},switchView(s,t=null,l=!1){s=this.validateView(s);const n=this.utils.date,i=this.view.startDate&&this.view.startDate.getTime();if(this.transitions&&l){if(this.view.id===s)return;const m=this.enabledViews;this.transitionDirection=m.indexOf(this.view.id)>m.indexOf(s)?"left":"right"}const a=this.view.id;switch(this.view.events=[],this.view.id=s,this.view.firstCellDate=null,this.view.lastCellDate=null,t||(t=this.view.selectedDate||this.view.startDate),s){case"years":{this.view.startDate=new Date(Math.floor(t.getFullYear()/25)*25||2e3,0,1),this.view.endDate=new Date(this.view.startDate.getFullYear()+25,0,1),this.view.endDate.setSeconds(-1);break}case"year":{this.view.startDate=new Date(t.getFullYear(),0,1),this.view.endDate=new Date(t.getFullYear()+1,0,1),this.view.endDate.setSeconds(-1);break}case"month":{this.view.startDate=new Date(t.getFullYear(),t.getMonth(),1),this.view.endDate=new Date(t.getFullYear(),t.getMonth()+1,1),this.view.endDate.setSeconds(-1);let m=new Date(this.view.startDate);if(m.getDay()!==(this.startWeekOnSunday?0:1)&&(m=n.getPreviousFirstDayOfWeek(m,this.startWeekOnSunday)),this.view.firstCellDate=m,this.view.lastCellDate=n.addDays(m,41),this.view.lastCellDate.setHours(23,59,59,0),this.hideWeekends){if([0,6].includes(this.view.firstCellDate.getDay())){const u=this.view.firstCellDate.getDay()===6&&!this.startWeekOnSunday?2:1;this.view.firstCellDate=n.addDays(this.view.firstCellDate,u)}if([0,6].includes(this.view.startDate.getDay())){const u=this.view.startDate.getDay()===6?2:1;this.view.startDate=n.addDays(this.view.startDate,u)}if([0,6].includes(this.view.lastCellDate.getDay())){const u=this.view.lastCellDate.getDay()===0&&!this.startWeekOnSunday?2:1;this.view.lastCellDate=n.subtractDays(this.view.lastCellDate,u)}if([0,6].includes(this.view.endDate.getDay())){const u=this.view.endDate.getDay()===0?2:1;this.view.endDate=n.subtractDays(this.view.endDate,u)}}break}case"week":{t=n.getPreviousFirstDayOfWeek(t,this.startWeekOnSunday);const m=this.hideWeekends?5:7;this.view.startDate=this.hideWeekends&&this.startWeekOnSunday?n.addDays(t,1):t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=n.addDays(t,m),this.view.endDate.setSeconds(-1);break}case"day":{this.view.startDate=t,this.view.startDate.setHours(0,0,0,0),this.view.endDate=new Date(t),this.view.endDate.setHours(23,59,59,0);break}}this.addEventsToView();const c=this.view.startDate&&this.view.startDate.getTime();if(!(a===s&&c===i)&&(this.$emit("update:activeView",s),this.ready)){const m=this.view.startDate,u={view:s,startDate:m,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate,outOfScopeEvents:this.view.outOfScopeEvents.map(this.cleanupEvent)}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:n.getWeek(this.startWeekOnSunday?n.addDays(m,1):m)}:{}};this.$emit("view-change",u)}},previous(){this.previousNext(!1)},next(){this.previousNext()},previousNext(s=!0){const t=this.utils.date;this.transitionDirection=s?"right":"left";const l=s?1:-1;let n=null;const{startDate:i,id:a}=this.view;switch(a){case"years":n=new Date(i.getFullYear()+25*l,0,1);break;case"year":n=new Date(i.getFullYear()+1*l,1,1);break;case"month":n=new Date(i.getFullYear(),i.getMonth()+1*l,1);break;case"week":n=t[s?"addDays":"subtractDays"](t.getPreviousFirstDayOfWeek(i,this.startWeekOnSunday),7);break;case"day":n=t[s?"addDays":"subtractDays"](i,1);const c=n.getDay(),m=this.startWeekOnSunday?c:(c||7)-1;if(this.weekDays[m].hide){const d=this.weekDays.map((g,_)=>({...g,i:_}));let v=0;s?([...d.slice(m),...d].find(g=>(v++,!g.hide)).i,v--):[...d,...d.slice(0,m)].reverse().find(g=>(v++,!g.hide)).i,n=t[s?"addDays":"subtractDays"](n,v)}break}n&&this.switchView(a,n)},addEventsToView(s=[]){const t=this.utils.event,{startDate:l,endDate:n,firstCellDate:i,lastCellDate:a}=this.view;if(s.length||(this.view.events=[]),s=s.length?s:[...this.mutableEvents],!s||this.isYearsOrYearView&&!this.eventsCountOnYearView)return;let c=s.filter(m=>t.eventInRange(m,l,n));!this.isYearsOrYearView&&!(this.isMonthView&&!this.eventsOnMonthView)&&(c=c.map(m=>m.daysCount>1?t.createEventSegments(m,i||l,a||n):m)),this.view.events.push(...c),this.isMonthView&&(this.view.outOfScopeEvents=[],s.forEach(m=>{(t.eventInRange(m,i,l)||t.eventInRange(m,n,a))&&(this.view.events.some(u=>u._eid===m._eid)||this.view.outOfScopeEvents.push(m))}))},findAncestor(s,t){for(;(s=s.parentElement)&&!s.classList.contains(t););return s},isDOMElementAnEvent(s){return s.classList.contains("vuecal__event")||this.findAncestor(s,"vuecal__event")},onMouseMove(s){const{resizeAnEvent:t,dragAnEvent:l,dragCreateAnEvent:n}=this.domEvents;t._eid===null&&l._eid===null&&!n.start||(s.preventDefault(),t._eid?this.eventResizing(s):this.dragToCreateEvent&&n.start&&this.eventDragCreation(s))},onMouseUp(s){const{focusAnEvent:t,resizeAnEvent:l,clickHoldAnEvent:n,clickHoldACell:i,dragCreateAnEvent:a}=this.domEvents,{_eid:c}=n,{_eid:m}=l;let u=!1;const{event:d,start:v}=a,g=this.isDOMElementAnEvent(s.target),_=t.mousedUp;if(t.mousedUp=!1,g&&(this.domEvents.cancelClickEventCreation=!0),i.eventCreated)return;if(m){const{originalEnd:S,originalEndTimeMinutes:$,endTimeMinutes:b}=l,D=this.view.events.find(R=>R._eid===l._eid);if(u=b&&b!==$,D&&D.end.getTime()!==S.getTime()){const R=this.mutableEvents.find(w=>w._eid===l._eid);R.endTimeMinutes=D.endTimeMinutes,R.end=D.end;const L=this.cleanupEvent(D),O={...this.cleanupEvent(D),end:S,endTimeMinutes:D.originalEndTimeMinutes};this.$emit("event-duration-change",{event:L,oldDate:l.originalEnd,originalEvent:O}),this.$emit("event-change",{event:L,originalEvent:O})}D&&(D.resizing=!1),l._eid=null,l.start=null,l.split=null,l.segment=null,l.originalEndTimeMinutes=null,l.originalEnd=null,l.endTimeMinutes=null,l.startCell=null,l.endCell=null}else v&&(d&&(this.emitWithEvent("event-drag-create",d),a.event.resizing=!1),a.start=null,a.split=null,a.event=null);!g&&!m&&this.unfocusEvent(),n.timeoutId&&!c&&(clearTimeout(n.timeoutId),n.timeoutId=null),i.timeoutId&&(clearTimeout(i.timeoutId),i.timeoutId=null);const E=typeof this.onEventClick=="function";if(_&&!u&&!c&&!d&&E){let S=this.view.events.find($=>$._eid===t._eid);return!S&&this.isMonthView&&(S=this.view.outOfScopeEvents.find($=>$._eid===t._eid)),S&&this.onEventClick(S,s)}},onKeyUp(s){s.keyCode===27&&this.cancelDelete()},eventResizing(s){const{resizeAnEvent:t}=this.domEvents,l=this.view.events.find(d=>d._eid===t._eid)||{segments:{}},{minutes:n,cursorCoords:i}=this.minutesAtCursor(s),a=l.segments&&l.segments[t.segment],{date:c,event:m}=this.utils,u=Math.max(n,this.timeFrom+1,(a||l).startTimeMinutes+1);if(l.endTimeMinutes=t.endTimeMinutes=u,this.snapToTime){const d=l.endTimeMinutes+this.snapToTime/2;l.endTimeMinutes=d-d%this.snapToTime}if(a&&(a.endTimeMinutes=l.endTimeMinutes),l.end.setHours(0,l.endTimeMinutes,l.endTimeMinutes===Be?-1:0,0),this.resizeX&&this.isWeekView){l.daysCount=c.countDays(l.start,l.end);const d=this.cellsEl,v=d.offsetWidth/d.childElementCount,g=Math.floor(i.x/v);if(t.startCell===null&&(t.startCell=g-(l.daysCount-1)),t.endCell!==g){t.endCell=g;const _=c.addDays(l.start,g-t.startCell),E=Math.max(c.countDays(l.start,_),1);if(E!==l.daysCount){let S=null;E>l.daysCount?S=m.addEventSegment(l):S=m.removeEventSegment(l),t.segment=S,l.endTimeMinutes+=.001}}}this.$emit("event-resizing",{_eid:l._eid,end:l.end,endTimeMinutes:l.endTimeMinutes})},eventDragCreation(s){const{dragCreateAnEvent:t}=this.domEvents,{start:l,startCursorY:n,split:i}=t,a=new Date(l),{minutes:c,cursorCoords:{y:m}}=this.minutesAtCursor(s);if(!(!t.event&&Math.abs(n-m)<this.dragToCreateThreshold))if(t.event){if(a.setHours(0,c,c===Be?-1:0,0),this.snapToTime){let v=a.getHours()*60+a.getMinutes();const g=v+this.snapToTime/2;v=g-g%this.snapToTime,a.setHours(0,v,0,0)}const u=l<a,{event:d}=t;d.start=u?l:a,d.end=u?a:l,d.startTimeMinutes=d.start.getHours()*60+d.start.getMinutes(),d.endTimeMinutes=d.end.getHours()*60+d.end.getMinutes()}else{if(t.event=this.utils.event.createAnEvent(l,1,{split:i}),!t.event){t.start=null,t.split=null,t.event=null;return}t.event.resizing=!0}},unfocusEvent(){const{focusAnEvent:s,clickHoldAnEvent:t}=this.domEvents,l=this.view.events.find(n=>n._eid===(s._eid||t._eid));s._eid=null,t._eid=null,l&&(l.focused=!1,l.deleting=!1)},cancelDelete(){const{clickHoldAnEvent:s}=this.domEvents;if(s._eid){const t=this.view.events.find(l=>l._eid===s._eid);t&&(t.deleting=!1),s._eid=null,s.timeoutId=null}},onEventTitleBlur(s,t){if(t.title===s.target.innerHTML)return;const l=t.title;t.title=s.target.innerHTML;const n=this.cleanupEvent(t);this.$emit("event-title-change",{event:n,oldTitle:l}),this.$emit("event-change",{event:n,originalEvent:{...n,title:l}})},updateMutableEvents(){const s=this.utils.date;this.mutableEvents=[],this.events.forEach(t=>{const l=typeof t.start=="string"?s.stringToDate(t.start):t.start,n=s.formatDateLite(l),i=s.dateToMinutes(l);let a=null;typeof t.end=="string"&&t.end.includes("24:00")?(a=new Date(t.end.replace(" 24:00","")),a.setHours(23,59,59,0)):a=typeof t.end=="string"?s.stringToDate(t.end):t.end;let c=s.formatDateLite(a),m=s.dateToMinutes(a);(!m||m===Be)&&(!this.time||typeof t.end=="string"&&t.end.length===10?a.setHours(23,59,59,0):a.setSeconds(a.getSeconds()-1),c=s.formatDateLite(a),m=Be);const u=n!==c;t=Object.assign({...this.utils.event.eventDefaults},t,{_eid:`${this._.uid}_${this.eventIdIncrement++}`,segments:u?{}:null,start:l,startTimeMinutes:i,end:a,endTimeMinutes:m,daysCount:u?s.countDays(l,a):1,class:t.class}),this.mutableEvents.push(t)})},minutesAtCursor(s){return this.utils.cell.minutesAtCursor(s)},createEvent(s,t,l={}){return this.utils.event.createAnEvent(s,t,l)},cleanupEvent(s){return s={...s},["segments","deletable","deleting","titleEditable","resizable","resizing","draggable","dragging","draggingStatic","focused"].forEach(l=>{l in s&&delete s[l]}),s.repeat||delete s.repeat,s},emitWithEvent(s,t){this.$emit(s,this.cleanupEvent(t))},updateSelectedDate(s){if(s&&typeof s=="string"?s=this.utils.date.stringToDate(s):s=new Date(s),s&&s instanceof Date){const{selectedDate:t}=this.view;t&&(this.transitionDirection=t.getTime()>s.getTime()?"left":"right"),s.setHours(0,0,0,0),(!t||t.getTime()!==s.getTime())&&(this.view.selectedDate=s),this.switchView(this.view.id)}this.$emit("update:selected-date",this.view.selectedDate)},getWeekNumber(s){const t=this.utils.date,n=this.firstCellDateWeekNumber+s,i=this.startWeekOnSunday?1:0;return n>52?t.getWeek(t.addDays(this.view.firstCellDate,7*s+i)):n},timeTick(){this.now=new Date,this.timeTickerIds[1]=setTimeout(this.timeTick,60*1e3)},updateDateTexts(){this.utils.date.updateTexts(this.texts)},alignWithScrollbar(){if(document.getElementById("vuecal-align-with-scrollbar"))return;const s=this.$refs.vuecal.getElementsByClassName("vuecal__scrollbar-check")[0],t=s.offsetWidth-s.children[0].offsetWidth;if(t){const l=document.createElement("style");l.id="vuecal-align-with-scrollbar",l.type="text/css",l.innerHTML=`.vuecal--view-with-time .vuecal__weekdays-headings,.vuecal--view-with-time .vuecal__all-day {padding-right: ${t}px}`,document.head.appendChild(l)}},cellOrSplitHasEvents(s,t=null){return s.length&&(!t&&s.length||t&&s.some(l=>l.split===t.id))}},created(){this.utils.cell=new Vs(this),this.utils.event=new Is(this,this.utils.date),this.loadLocale(this.locale),this.editEvents.drag&&this.loadDragAndDrop(),this.updateMutableEvents(this.events),this.view.id=this.currentView,this.selectedDate?this.updateSelectedDate(this.selectedDate):(this.view.selectedDate=new Date,this.switchView(this.currentView)),this.time&&this.watchRealTime&&(this.timeTickerIds[0]=setTimeout(this.timeTick,(60-this.now.getSeconds())*1e3))},mounted(){const s=this.utils.date,t="ontouchstart"in window,{resize:l,drag:n,create:i,delete:a,title:c}=this.editEvents,m=this.onEventClick&&typeof this.onEventClick=="function";(l||n||i||a||c||m)&&window.addEventListener(t?"touchend":"mouseup",this.onMouseUp),(l||n||i&&this.dragToCreateEvent)&&window.addEventListener(t?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),c&&window.addEventListener("keyup",this.onKeyUp),t&&(this.$refs.vuecal.oncontextmenu=function(v){v.preventDefault(),v.stopPropagation()}),this.hideBody||this.alignWithScrollbar();const u=this.view.startDate,d={view:this.view.id,startDate:u,endDate:this.view.endDate,...this.isMonthView?{firstCellDate:this.view.firstCellDate,lastCellDate:this.view.lastCellDate}:{},events:this.view.events.map(this.cleanupEvent),...this.isWeekView?{week:s.getWeek(this.startWeekOnSunday?s.addDays(u,1):u)}:{}};this.$emit("ready",d),this.ready=!0},beforeUnmount(){const s="ontouchstart"in window;window.removeEventListener(s?"touchmove":"mousemove",this.onMouseMove,{passive:!1}),window.removeEventListener(s?"touchend":"mouseup",this.onMouseUp),window.removeEventListener("keyup",this.onKeyUp),this.timeTickerIds[0]&&clearTimeout(this.timeTickerIds[0]),this.timeTickerIds[1]&&clearTimeout(this.timeTickerIds[1]),this.timeTickerIds=[null,null]},computed:{editEvents(){return this.editableEvents&&typeof this.editableEvents=="object"?{title:!!this.editableEvents.title,drag:!!this.editableEvents.drag,resize:!!this.editableEvents.resize,create:!!this.editableEvents.create,delete:!!this.editableEvents.delete}:{title:!!this.editableEvents,drag:!!this.editableEvents,resize:!!this.editableEvents,create:!!this.editableEvents,delete:!!this.editableEvents}},views(){return{years:{label:this.texts.years,enabled:!this.disableViews.includes("years")},year:{label:this.texts.year,enabled:!this.disableViews.includes("year")},month:{label:this.texts.month,enabled:!this.disableViews.includes("month")},week:{label:this.texts.week,enabled:!this.disableViews.includes("week")},day:{label:this.texts.day,enabled:!this.disableViews.includes("day")}}},currentView(){return this.validateView(this.activeView)},enabledViews(){return Object.keys(this.views).filter(s=>this.views[s].enabled)},hasTimeColumn(){return this.time&&this.isWeekOrDayView},isShortMonthView(){return this.isMonthView&&this.eventsOnMonthView==="short"},firstCellDateWeekNumber(){const s=this.utils.date,t=this.view.firstCellDate;return s.getWeek(this.startWeekOnSunday?s.addDays(t,1):t)},timeCells(){const s=[];for(let t=this.timeFrom,l=this.timeTo;t<l;t+=this.timeStep)s.push({hours:Math.floor(t/60),minutes:t%60,label:this.utils.date.formatTime(t,this.TimeFormat),value:t});return s},TimeFormat(){return this.timeFormat||(this.twelveHour?"h:mm{am}":"HH:mm")},daySplits(){return(this.splitDays.filter(s=>!s.hide)||[]).map((s,t)=>({...s,id:s.id||t+1}))},hasSplits(){return this.daySplits.length&&this.isWeekOrDayView},hasShortEvents(){return this.showAllDayEvents==="short"},cellOrSplitMinWidth(){let s=null;return this.hasSplits&&this.minSplitWidth?s=this.visibleDaysCount*this.minSplitWidth*this.daySplits.length:this.minCellWidth&&this.isWeekView&&(s=this.visibleDaysCount*this.minCellWidth),s},allDayBar(){let s=this.allDayBarHeight||null;return s&&!isNaN(s)&&(s+="px"),{cells:this.viewCells,options:this.$props,label:this.texts.allDay,shortEvents:this.hasShortEvents,daySplits:this.hasSplits&&this.daySplits||[],cellOrSplitMinWidth:this.cellOrSplitMinWidth,height:s}},minTimestamp(){let s=null;return this.minDate&&typeof this.minDate=="string"?s=this.utils.date.stringToDate(this.minDate):this.minDate&&this.minDate instanceof Date&&(s=this.minDate),s?s.getTime():null},maxTimestamp(){let s=null;return this.maxDate&&typeof this.maxDate=="string"?s=this.utils.date.stringToDate(this.maxDate):this.maxDate&&this.maxDate instanceof Date&&(s=this.maxDate),s?s.getTime():null},weekDays(){let{weekDays:s,weekDaysShort:t=[]}=this.texts;return s=s.slice(0).map((l,n)=>({label:l,...t.length?{short:t[n]}:{},hide:this.hideWeekends&&n>=5||this.hideWeekdays.length&&this.hideWeekdays.includes(n+1)})),this.startWeekOnSunday&&s.unshift(s.pop()),s},weekDaysInHeader(){return this.isMonthView||this.isWeekView&&!this.minCellWidth&&!(this.hasSplits&&this.minSplitWidth)},months(){return this.texts.months.map(s=>({label:s}))},specialDayHours(){return!this.specialHours||!Object.keys(this.specialHours).length?{}:Array(7).fill("").map((s,t)=>{let l=this.specialHours[t+1]||[];return Array.isArray(l)||(l=[l]),s=[],l.forEach(({from:n,to:i,class:a,label:c},m)=>{s[m]={day:t+1,from:[null,void 0].includes(n)?null:n*1,to:[null,void 0].includes(i)?null:i*1,class:a||"",label:c||""}}),s})},viewTitle(){const s=this.utils.date;let t="";const l=this.view.startDate,n=l.getFullYear(),i=l.getMonth();switch(this.view.id){case"years":{t=this.texts.years;break}case"year":{t=n;break}case"month":{t=`${this.months[i].label} ${n}`;break}case"week":{const a=this.view.endDate,c=l.getFullYear();let m=this.texts.months[l.getMonth()];this.xsmall&&(m=m.substring(0,3));let u=`${m} ${c}`;if(a.getMonth()!==l.getMonth()){const d=a.getFullYear();let v=this.texts.months[a.getMonth()];this.xsmall&&(v=v.substring(0,3)),c===d?u=`${m} - ${v} ${c}`:this.small?u=`${m.substring(0,3)} ${c} - ${v.substring(0,3)} ${d}`:u=`${m} ${c} - ${v} ${d}`}t=`${this.texts.week} ${s.getWeek(this.startWeekOnSunday?s.addDays(l,1):l)} (${u})`;break}case"day":{t=this.utils.date.formatDate(l,this.texts.dateFormat,this.texts);break}}return t},viewCells(){const s=this.utils.date;let t=[],l=null,n=!1;this.watchRealTime||(this.now=new Date);const i=this.now;switch(this.view.id){case"years":{l=this.view.startDate.getFullYear(),t=Array.apply(null,Array(25)).map((a,c)=>{const m=new Date(l+c,0,1),u=new Date(l+c+1,0,1);return u.setSeconds(-1),{startDate:m,formattedDate:s.formatDateLite(m),endDate:u,content:l+c,current:l+c===i.getFullYear()}});break}case"year":{l=this.view.startDate.getFullYear(),t=Array.apply(null,Array(12)).map((a,c)=>{const m=new Date(l,c,1),u=new Date(l,c+1,1);return u.setSeconds(-1),{startDate:m,formattedDate:s.formatDateLite(m),endDate:u,content:this.xsmall?this.months[c].label.substr(0,3):this.months[c].label,current:c===i.getMonth()&&l===i.getFullYear()}});break}case"month":{const a=this.view.startDate.getMonth(),c=new Date(this.view.firstCellDate);n=!1,t=Array.apply(null,Array(42)).map((m,u)=>{const d=s.addDays(c,u),v=new Date(d);v.setHours(23,59,59,0);const g=!n&&s.isToday(d)&&!n++;return{startDate:d,formattedDate:s.formatDateLite(d),endDate:v,content:d.getDate(),today:g,outOfScope:d.getMonth()!==a,class:`vuecal__cell--day${d.getDay()||7}`}}),(this.hideWeekends||this.hideWeekdays.length)&&(t=t.filter(m=>{const u=m.startDate.getDay()||7;return!(this.hideWeekends&&u>=6||this.hideWeekdays.length&&this.hideWeekdays.includes(u))}));break}case"week":{n=!1;const a=this.view.startDate,c=this.weekDays;t=c.map((m,u)=>{const d=s.addDays(a,this.startWeekOnSunday&&this.hideWeekends?u-1:u),v=new Date(d);v.setHours(23,59,59,0);const g=(d.getDay()||7)-1;return{startDate:d,formattedDate:s.formatDateLite(d),endDate:v,today:!n&&s.isToday(d)&&!n++,specialHours:this.specialDayHours[g]||[]}}).filter((m,u)=>!c[u].hide);break}case"day":{const a=this.view.startDate,c=new Date(this.view.startDate);c.setHours(23,59,59,0);const m=(a.getDay()||7)-1;t=[{startDate:a,formattedDate:s.formatDateLite(a),endDate:c,today:s.isToday(a),specialHours:this.specialDayHours[m]||[]}];break}}return t},visibleDaysCount(){return this.isDayView?1:7-this.weekDays.reduce((s,t)=>s+t.hide,0)},cellWidth(){return 100/this.visibleDaysCount},cssClasses(){const{resizeAnEvent:s,dragAnEvent:t,dragCreateAnEvent:l}=this.domEvents;return{[`vuecal--${this.view.id}-view`]:!0,[`vuecal--${this.locale}`]:this.locale,"vuecal--no-time":!this.time,"vuecal--view-with-time":this.hasTimeColumn,"vuecal--week-numbers":this.showWeekNumbers&&this.isMonthView,"vuecal--twelve-hour":this.twelveHour,"vuecal--click-to-navigate":this.clickToNavigate,"vuecal--hide-weekends":this.hideWeekends,"vuecal--split-days":this.hasSplits,"vuecal--sticky-split-labels":this.hasSplits&&this.stickySplitLabels,"vuecal--overflow-x":this.minCellWidth&&this.isWeekView||this.hasSplits&&this.minSplitWidth,"vuecal--small":this.small,"vuecal--xsmall":this.xsmall,"vuecal--resizing-event":s._eid,"vuecal--drag-creating-event":l.event,"vuecal--dragging-event":t._eid,"vuecal--events-on-month-view":this.eventsOnMonthView,"vuecal--short-events":this.isMonthView&&this.eventsOnMonthView==="short","vuecal--has-touch":typeof window<"u"&&"ontouchstart"in window}},isYearsOrYearView(){return["years","year"].includes(this.view.id)},isYearsView(){return this.view.id==="years"},isYearView(){return this.view.id==="year"},isMonthView(){return this.view.id==="month"},isWeekOrDayView(){return["week","day"].includes(this.view.id)},isWeekView(){return this.view.id==="week"},isDayView(){return this.view.id==="day"}},watch:{events:{handler(s,t){this.updateMutableEvents(s),this.addEventsToView()},deep:!0},locale(s){this.loadLocale(s)},selectedDate(s){this.updateSelectedDate(s)},activeView(s){this.switchView(s)}}},Yl=Ne(Wl,[["render",Hl]]),zl={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},ql={class:"flex justify-between items-center mb-4"},Gl={class:"flex gap-3"},Kl={class:"flex rounded-md shadow-sm mr-3"},Jl={key:0,class:"mb-4 bg-gray-50 p-4 rounded-lg"},Zl={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Xl=["value"],Ql={class:"mt-1 relative rounded-md shadow-sm"},ea={key:1,class:"text-center text-gray-600 text-sm animate-pulse py-4"},ta={key:2,class:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md"},sa={key:3},la={key:0,class:"space-y-4"},aa={key:0,class:"flex justify-between"},ia={class:"flex-grow"},na={class:"text-sm text-red-500 italic"},oa={class:"flex items-center mt-1"},ra={class:"text-xs text-gray-500"},da={key:1},ua={class:"flex-grow"},ca={class:"flex justify-between items-center mb-3"},ma={class:"text-sm text-gray-600 bg-blue-100 px-2 py-1 rounded-full"},va={class:"mb-3"},pa={class:"text-sm text-gray-700 ml-6"},ga={class:"mb-3"},ha={class:"text-sm text-gray-700 ml-6"},ya={class:"mb-2"},fa={class:"text-sm text-gray-700 ml-6"},ba={class:"flex items-center mt-3 pt-2 border-t border-blue-200"},wa={class:"text-xs text-gray-500"},_a={key:1,class:"text-gray-400 text-sm"},xa={key:4,class:"mt-4"},ka={class:"flex justify-between items-center mb-6"},Da={class:"text-lg font-medium text-gray-900"},Ca=["innerHTML"],Ta=["innerHTML"],Ea={key:0,class:"mt-1 text-xs p-1 rounded bg-red-50 border-l-2 border-red-500 text-red-700"},Sa={class:"mt-6 bg-white rounded-lg shadow p-4"},ja={key:0},Ma={class:"font-medium text-gray-800 mb-2"},$a={class:"font-medium text-blue-800"},Va={class:"text-sm text-gray-600 mt-1"},Aa={key:1,class:"text-gray-500 text-sm"},Ia={__name:"DailyStandups",props:{projectId:{type:Number,required:!0},users:{type:Array,default:()=>[]}},emits:["standupAdded"],setup(s,{emit:t}){const l=s,n=k("list"),i=k(!1),a=k(!1),c=k(""),m=k([]),u=k(""),d=De({startDate:"",endDate:"",search:"",userId:""}),v=h=>{const x=ce(h);return x.isValid()?{start:x.clone().startOf("month").format("YYYY-MM-DD"),end:x.clone().endOf("month").format("YYYY-MM-DD")}:(console.warn("getMonthRange received an invalid input, defaulting to current date:",h),{start:ce().startOf("month").format("YYYY-MM-DD"),end:ce().endOf("month").format("YYYY-MM-DD")})};let g=null;const _=()=>{clearTimeout(g),g=setTimeout(()=>{S()},500)},E=async()=>{a.value=!0,c.value="";try{const h=new URLSearchParams;d.startDate&&h.append("start_date",d.startDate),d.endDate&&h.append("end_date",d.endDate),d.search&&h.append("search",d.search),d.userId&&h.append("user_id",String(d.userId));const x=h.toString(),V=`/api/projects/${l.projectId}/sections/notes?type=standup${x?`&${x}`:""}`,K=await window.axios.get(V);m.value=K.data.filter(ie=>ie.type==="standup")}catch(h){console.error("Error fetching project standups:",h),c.value="Failed to load standups. Please try again."}finally{a.value=!1}},S=()=>{E()},$=()=>{d.search="",d.userId="",d.startDate="",d.endDate="",E()},b=()=>{u.value=ce(u.value).subtract(1,"month").format("YYYY-MM-DD")},D=()=>{u.value=ce(u.value).add(1,"month").format("YYYY-MM-DD")};re(()=>u.value,h=>{if(n.value==="calendar"&&h){const x=v(h);d.startDate=x.start,d.endDate=x.end,E()}}),re(()=>n.value,h=>{h==="calendar"?(d.search="",d.userId="",u.value=v(new Date).start):(d.startDate="",d.endDate="",E())});const R=N(()=>(m.value||[]).map(h=>{var K;if(!(h!=null&&h.created_at))return null;const x=ce(h.created_at);if(!x.isValid())return null;const V=M(h.content);return{start:x.format("YYYY-MM-DD HH:mm"),end:x.format("YYYY-MM-DD HH:mm"),title:`${((K=h.user)==null?void 0:K.name)||"Unknown"} - Standup`,content:`Yesterday: ${V.yesterday}
Today: ${V.today}
Blockers: ${V.blockers}`,class:"standup-event",standupData:h}}).filter(Boolean));be(()=>{E()});const L=N(()=>{if(!m.value)return[];let h=[...m.value];if(d.startDate&&(h=h.filter(x=>x.created_at&&ce(x.created_at).isSameOrAfter(d.startDate,"day"))),d.endDate&&(h=h.filter(x=>x.created_at&&ce(x.created_at).isSameOrBefore(d.endDate,"day"))),d.userId&&(h=h.filter(x=>x.user_id===parseInt(d.userId))),d.search){const x=d.search.toLowerCase();h=h.filter(V=>V.content&&V.content!=="[Encrypted content could not be decrypted]"&&V.content.toLowerCase().includes(x))}return h.sort((x,V)=>ce(V.created_at).valueOf()-ce(x.created_at).valueOf())}),O=h=>{const x=ce(h).day();return x>=1&&x<=5},w=h=>ce(h).isBefore(ce(),"day"),j=(h,x)=>ce(h).isSame(x,"day"),M=h=>{var B,A,C,I;if(!h||typeof h!="string"||h==="[Encrypted content could not be decrypted]"||h.trim()==="")return{yesterday:"N/A",today:"N/A",blockers:"N/A",date:"N/A"};const x=((B=h.match(/\*\*Yesterday:\*\* ([^\n]+)/))==null?void 0:B[1].trim())||"Nothing",V=((A=h.match(/\*\*Today:\*\* ([^\n]+)/))==null?void 0:A[1].trim())||"Nothing",K=((C=h.match(/\*\*Blockers:\*\* ([^\n]+)/))==null?void 0:C[1].trim())||"None",ie=((I=h.match(/\*\*Daily Standup - ([^*]+)\*\*/))==null?void 0:I[1].trim())||ce().format("L");return{yesterday:x,today:V,blockers:K,date:ie}},f=N(()=>{const h={};return(m.value||[]).forEach(x=>{if(!(x!=null&&x.created_at))return;const V=ce(x.created_at).format("YYYY-MM-DD");h[V]||(h[V]=[]),h[V].push(x)}),h});return(h,x)=>(o(),r("div",zl,[e("div",ql,[x[11]||(x[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Daily Standups",-1)),e("div",Gl,[e("div",Kl,[e("button",{type:"button",onClick:x[0]||(x[0]=V=>n.value="list"),class:te([n.value==="list"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-l-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},x[8]||(x[8]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})]),W(" List ")],-1)]),2),e("button",{type:"button",onClick:x[1]||(x[1]=V=>n.value="calendar"),class:te([n.value==="calendar"?"bg-indigo-100 text-indigo-700":"bg-white text-gray-700 hover:text-gray-500","px-4 py-2 text-sm font-medium rounded-r-md border border-gray-300 focus:z-10 focus:outline-none focus:ring-1 focus:ring-indigo-500"])},x[9]||(x[9]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),W(" Calendar ")],-1)]),2)]),p(de,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:x[2]||(x[2]=V=>i.value=!0)},{default:U(()=>x[10]||(x[10]=[W(" Submit Standup ",-1)])),_:1,__:[10]})])]),n.value==="list"?(o(),r("div",Jl,[e("div",Zl,[e("div",null,[x[12]||(x[12]=e("label",{for:"standupStartDate",class:"block text-sm font-medium text-gray-700 mb-1"},"From Date",-1)),me(e("input",{type:"date",id:"standupStartDate","onUpdate:modelValue":x[3]||(x[3]=V=>d.startDate=V),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:S},null,544),[[we,d.startDate]])]),e("div",null,[x[13]||(x[13]=e("label",{for:"standupEndDate",class:"block text-sm font-medium text-gray-700 mb-1"},"To Date",-1)),me(e("input",{type:"date",id:"standupEndDate","onUpdate:modelValue":x[4]||(x[4]=V=>d.endDate=V),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:S},null,544),[[we,d.endDate]])]),e("div",null,[x[15]||(x[15]=e("label",{for:"standupUserFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),me(e("select",{id:"standupUserFilter","onUpdate:modelValue":x[5]||(x[5]=V=>d.userId=V),class:"mt-1 block w-full border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:S},[x[14]||(x[14]=e("option",{value:""},"All Users",-1)),(o(!0),r(Z,null,ee(l.users,V=>(o(),r("option",{key:V.id,value:V.id},y(V.name),9,Xl))),128))],544),[[We,d.userId]])]),e("div",null,[x[17]||(x[17]=e("label",{for:"standupSearchFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Search Content",-1)),e("div",Ql,[me(e("input",{type:"text",id:"standupSearchFilter","onUpdate:modelValue":x[6]||(x[6]=V=>d.search=V),class:"focus:ring-indigo-500 focus:border-indigo-500 block w-full pr-10 sm:text-sm border-gray-300 rounded-md",placeholder:"Search in standup content...",onInput:_},null,544),[[we,d.search]]),x[16]||(x[16]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:$}," Reset Filters ")])])):T("",!0),a.value?(o(),r("div",ea,"Loading standups...")):c.value?(o(),r("div",ta,y(c.value),1)):n.value==="list"?(o(),r("div",sa,[L.value.length?(o(),r("div",la,[(o(!0),r(Z,null,ee(L.value,V=>{var K,ie;return o(),r("div",{key:V.id,class:"p-4 bg-blue-50 rounded-md shadow-sm hover:bg-blue-100 transition-colors border-l-4 border-blue-500"},[V.content==="[Encrypted content could not be decrypted]"?(o(),r("div",aa,[e("div",ia,[e("p",na,[W(y(V.content),1),x[18]||(x[18]=e("span",{class:"text-xs text-red-400 block mt-1"},"(There was an issue decrypting this standup. Please contact an administrator.)",-1))]),e("div",oa,[e("p",ra,"Submitted by "+y(((K=V.user)==null?void 0:K.name)||"Unknown")+" on "+y(J(ce)(V.created_at).format("L")),1)])])])):(o(),r("div",da,[e("div",ua,[e("div",ca,[x[19]||(x[19]=e("h3",{class:"text-md font-bold text-gray-800"},"Daily Standup",-1)),e("span",ma,y(M(V.content).date),1)]),e("div",va,[x[20]||(x[20]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Yesterday:")],-1)),e("p",pa,y(M(V.content).yesterday),1)]),e("div",ga,[x[21]||(x[21]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-green-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Today:")],-1)),e("p",ha,y(M(V.content).today),1)]),e("div",ya,[x[22]||(x[22]=e("div",{class:"flex items-center mb-1"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-red-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("span",{class:"font-semibold text-sm text-gray-700"},"Blockers:")],-1)),e("p",fa,y(M(V.content).blockers),1)]),e("div",ba,[e("p",wa,"Submitted by "+y(((ie=V.user)==null?void 0:ie.name)||"Unknown")+" on "+y(J(ce)(V.created_at).format("L")),1)])])]))])}),128))])):(o(),r("p",_a,"No daily standups found for the selected criteria."))])):n.value==="calendar"?(o(),r("div",xa,[e("div",ka,[e("button",{onClick:b,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},x[23]||(x[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),e("h3",Da,y(u.value?J(ce)(u.value).format("MMMM YYYY"):"Loading..."),1),e("button",{onClick:D,class:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors"},x[24]||(x[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),p(J(Yl),{class:"vuecal--blue-theme","active-view":"month",events:R.value,"selected-date":u.value,"hide-title-bar":"","disable-views":["week","day","years","year"],twelveHour:!0,"time-from":480,"time-to":1200,"time-step":30,"events-on-month-view":"short"},{event:U(({event:V})=>[e("div",{class:"vuecal__event-title",innerHTML:V.title},null,8,Ca),e("div",{class:"vuecal__event-content",innerHTML:V.content},null,8,Ta)]),"cell-content":U(({view:V,date:K})=>[V.id==="month"?(o(),r(Z,{key:0},[K&&O(K)&&w(K)&&!R.value.some(ie=>j(ie.start,K))?(o(),r("div",Ea," No standups ")):T("",!0)],64)):T("",!0)]),_:1},8,["events","selected-date"]),x[26]||(x[26]=Zt('<div class="mt-4 flex items-center space-x-4 text-sm"><div class="flex items-center"><span class="inline-block w-3 h-3 bg-blue-50 border-l-2 border-blue-500 mr-1"></span><span>Standup submitted</span></div><div class="flex items-center"><span class="inline-block w-3 h-3 bg-red-50 border-l-2 border-red-500 mr-1"></span><span>Missing standup</span></div></div>',1)),e("div",Sa,[x[25]||(x[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Standups Outside Current Month View",-1)),Object.entries(f.value).some(([V])=>!J(ce)(V).isSame(u.value,"month"))?(o(),r("div",ja,[(o(!0),r(Z,null,ee(Object.entries(f.value).filter(([V])=>!J(ce)(V).isSame(u.value,"month")).sort((V,K)=>J(ce)(V[0]).valueOf()-J(ce)(K[0]).valueOf()),([V,K])=>(o(),r("div",{key:V,class:"mb-4"},[e("div",Ma,y(J(ce)(V).format("dddd, MMMM Do YYYY")),1),(o(!0),r(Z,null,ee(K,ie=>{var B;return o(),r("div",{key:ie.id,class:"p-2 mb-2 rounded bg-blue-50 border-l-2 border-blue-500"},[e("div",$a,y(((B=ie.user)==null?void 0:B.name)||"Unknown"),1),e("div",Va,y(J(ce)(ie.created_at).format("LT")),1)])}),128))]))),128))])):(o(),r("div",Aa,"No standups outside the current month view."))])])):T("",!0),p(ht,{show:i.value,onClose:x[7]||(x[7]=V=>i.value=!1),onStandupAdded:E,projectId:s.projectId},null,8,["show","projectId"])]))}},Oa={class:"relative"},La={key:0,class:"text-gray-400 text-sm"},Ua=["onClick"],Na=["placeholder"],Pa={key:0,class:"absolute z-50 w-full bg-white border border-gray-300 rounded-md shadow-lg mt-1 max-h-60 overflow-y-auto"},Ra={class:"py-1"},Fa={key:0,class:"px-4 py-2 text-gray-500 text-sm"},Ba=["onClick"],Ha={__name:"CustomMultiSelect",props:{modelValue:{type:Array,default:()=>[]},options:{type:Array,default:()=>[],required:!0},placeholder:{type:String,default:"Select items"},labelKey:{type:String,default:"name"},trackBy:{type:String,default:"id"}},emits:["update:modelValue"],setup(s,{emit:t}){const l=s,n=t,i=k(!1),a=k(""),c=N(()=>{if(!a.value)return l.options;const v=a.value.toLowerCase();return l.options.filter(g=>g[l.labelKey].toLowerCase().includes(v))});re(()=>l.modelValue,v=>{},{deep:!0});const m=v=>{const g=[...l.modelValue],_=g.findIndex(E=>E===v[l.trackBy]);_===-1?g.push(v[l.trackBy]):g.splice(_,1),n("update:modelValue",g),a.value=""},u=v=>{const g=l.options.find(_=>_[l.trackBy]===v);return g?g[l.labelKey]:""},d=v=>l.modelValue.includes(v);return(v,g)=>{const _=Xt("click-outside");return me((o(),r("div",Oa,[e("div",{class:"flex flex-wrap items-center w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm cursor-pointer min-h-[38px] bg-white focus-within:border-indigo-500 focus-within:ring-indigo-500",onClick:g[2]||(g[2]=E=>i.value=!i.value)},[s.modelValue.length===0&&!a.value?(o(),r("span",La,y(s.placeholder),1)):T("",!0),(o(!0),r(Z,null,ee(s.modelValue,E=>(o(),r("div",{key:E,class:"inline-flex items-center bg-indigo-100 text-indigo-800 text-xs font-medium px-2.5 py-0.5 rounded mr-2 mb-1"},[W(y(u(E))+" ",1),e("button",{type:"button",onClick:xe(S=>m(s.options.find($=>$[s.trackBy]===E)),["stop"]),class:"ml-1 text-indigo-800 hover:text-indigo-900 focus:outline-none"},g[3]||(g[3]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Ua)]))),128)),me(e("input",{type:"text","onUpdate:modelValue":g[0]||(g[0]=E=>a.value=E),onInput:g[1]||(g[1]=E=>i.value=!0),class:"flex-grow border-none focus:ring-0 p-0 text-sm placeholder-gray-400 bg-transparent outline-none",placeholder:s.modelValue.length===0?"Search...":""},null,40,Na),[[we,a.value]])]),i.value?(o(),r("div",Pa,[e("ul",Ra,[c.value.length===0?(o(),r("li",Fa,"No items found.")):T("",!0),(o(!0),r(Z,null,ee(c.value,E=>(o(),r("li",{key:E[s.trackBy],class:te(["px-4 py-2 cursor-pointer hover:bg-gray-100 text-sm",{"bg-indigo-50 text-indigo-900":d(E[s.trackBy])}]),onClick:S=>m(E)},y(E[s.labelKey]),11,Ba))),128))])])):T("",!0)])),[[_,()=>i.value=!1]])}}},Le=Ee(Ha,[["__scopeId","data-v-5326f069"]]),Wa={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-6"},Ya={class:"space-y-6"},za={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},qa={class:"flex items-center"},Ga={class:"flex items-center"},Ka={class:"space-y-6 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},Ja={class:"space-y-4"},Za={class:"text-gray-900 font-medium break-words"},Xa={class:"text-gray-900"},Qa={key:0,class:"text-xs text-gray-500 mt-1"},ei={key:0},ti={class:"text-gray-900 whitespace-pre-wrap"},si={key:1},li={class:"flex flex-wrap gap-2"},ai={key:2},ii={class:"text-gray-900"},ni={class:"list-disc list-inside space-y-1 text-gray-900"},oi={key:0},ri={key:1},di={key:2},ui={__name:"MeetingModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},projectName:{type:String,default:"Project"}},emits:["close","saved"],setup(s,{emit:t}){const l=s,n=t,i=()=>Intl.DateTimeFormat().resolvedOptions().timeZone,a=["Africa/Cairo","Africa/Johannesburg","Africa/Lagos","America/Anchorage","America/Bogota","America/Chicago","America/Denver","America/Los_Angeles","America/Mexico_City","America/New_York","America/Phoenix","America/Sao_Paulo","America/Toronto","America/Vancouver","Asia/Dubai","Asia/Hong_Kong","Asia/Jerusalem","Asia/Kolkata","Asia/Seoul","Asia/Shanghai","Asia/Singapore","Asia/Tokyo","Australia/Melbourne","Australia/Perth","Australia/Sydney","Europe/Amsterdam","Europe/Berlin","Europe/Dublin","Europe/Istanbul","Europe/London","Europe/Madrid","Europe/Moscow","Europe/Paris","Europe/Rome","Pacific/Auckland","Pacific/Honolulu","UTC","GMT","Europe/Belfast","America/Adak","America/Boise","America/Detroit","America/Indianapolis","America/Juneau","America/Louisville","America/Menominee","America/Nome","America/Sitka","America/Yakutat","Asia/Karachi","Asia/Kolkata","Pacific/Auckland","Pacific/Chatham","Europe/Athens","Europe/Brussels","Europe/Budapest","Europe/Copenhagen","Europe/Helsinki","Europe/Lisbon","Europe/Oslo","Europe/Stockholm","Europe/Zurich","Europe/Vienna","Europe/Warsaw","Europe/Zurich","Europe/Sofia","Europe/Prague","Europe/Malta","Europe/Luxembourg","Europe/Kiev","Europe/Rome"].sort(),c=N(()=>a.map(O=>({value:O,label:O}))),m=N(()=>{const O=i(),w=a.includes(O);return console.log("DEBUG: Is detected timezone in list?",w,"Detected:",O),w?O:(console.log("DEBUG: Falling back to UTC for timezone as detected timezone not in list."),"UTC")}),u=De({summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0,timezone:m.value,enable_recording:!1}),d=N({get(){return u.summary?`${u.summary} - ${l.projectName}`:""},set(O){const w=` - ${l.projectName}`;O.endsWith(w)?u.summary=O.slice(0,-w.length):u.summary=O}}),v=()=>{u.summary="",u.description="",u.attendee_user_ids=[],u.location="",u.with_google_meet=!0,u.timezone=m.value,u.enable_recording=!1,_(),console.log("DEBUG: Form reset. Current timezone in form:",u.timezone)},g=O=>{const w=new Date(O),j=w.getFullYear(),M=String(w.getMonth()+1).padStart(2,"0"),f=String(w.getDate()).padStart(2,"0"),h=String(w.getHours()).padStart(2,"0"),x=String(w.getMinutes()).padStart(2,"0");return`${j}-${M}-${f}T${h}:${x}`},_=()=>{const O=new Date,w=new Date(O.getTime()+3600*1e3),j=new Date(O.getTime()+7200*1e3);u.start_datetime=g(w),u.end_datetime=g(j),console.log("DEBUG: Default times set. Start:",u.start_datetime,"End:",u.end_datetime)};_(),re(()=>l.show,O=>{O&&v()},{immediate:!0});const E=O=>O?(console.log(O),O.replace("T"," ")+":00"):"",S=O=>{const w={...O};return w.summary=d.value,w.start_datetime=E(O.start_datetime),w.end_datetime=E(O.end_datetime),console.log(w),w},$=N(()=>`/api/projects/${l.projectId}/meetings`),b=O=>{n("saved",O)},D=O=>{console.error("DEBUG: MeetingModal submission error:",O)},R=N(()=>{if(!u.start_datetime||!u.end_datetime)return"";const O=new Date(u.start_datetime),w=new Date(u.end_datetime),j={weekday:"long",year:"numeric",month:"long",day:"numeric"},M={hour:"2-digit",minute:"2-digit"},f=O.toLocaleDateString(void 0,j),h=O.toLocaleTimeString(void 0,M),x=w.toLocaleTimeString(void 0,M);return O.toDateString()===w.toDateString()?`${f}, ${h} - ${x}`:`${f} ${h} - ${w.toLocaleDateString(void 0,j)} ${x}`}),L=N(()=>l.projectUsers.filter(O=>u.attendee_user_ids.includes(O.id)).map(O=>O.name));return(O,w)=>(o(),X(Te,{show:s.show,title:"Schedule a Meeting","api-endpoint":$.value,"http-method":"post","form-data":u,"format-data-for-api":S,"submit-button-text":"Schedule Meeting","success-message":"Meeting scheduled successfully!",onClose:w[9]||(w[9]=j=>O.$emit("close")),onSubmitted:b,onError:D},{default:U(({errors:j})=>[e("div",Wa,[e("div",Ya,[e("div",null,[p(Y,{for:"summary",value:"Meeting Title"}),w[10]||(w[10]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive title for the meeting (e.g., Project Standup). The project name will be added automatically. ",-1)),p(oe,{id:"summary",modelValue:u.summary,"onUpdate:modelValue":w[0]||(w[0]=M=>u.summary=M),type:"text",class:"mt-1 block w-full",placeholder:"e.g., Project Standup",required:""},null,8,["modelValue"]),p(le,{message:j.summary?j.summary[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"description",value:"Description"}),w[11]||(w[11]=e("p",{class:"mt-1 text-sm text-gray-500 mb-2"}," Enter a short, descriptive agenda of the meeting. ",-1)),me(e("textarea",{id:"description","onUpdate:modelValue":w[1]||(w[1]=M=>u.description=M),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Meeting agenda and details..."},null,512),[[we,u.description]]),p(le,{message:j.description?j.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",za,[e("div",null,[p(Y,{for:"start_datetime",value:"Start Date & Time"}),p(oe,{id:"start_datetime",modelValue:u.start_datetime,"onUpdate:modelValue":w[2]||(w[2]=M=>u.start_datetime=M),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(le,{message:j.start_datetime?j.start_datetime[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"end_datetime",value:"End Date & Time"}),p(oe,{id:"end_datetime",modelValue:u.end_datetime,"onUpdate:modelValue":w[3]||(w[3]=M=>u.end_datetime=M),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(le,{message:j.end_datetime?j.end_datetime[0]:"",class:"mt-2"},null,8,["message"])])]),e("div",null,[p(Y,{for:"attendees",value:"Attendees"}),p(Le,{id:"attendees",modelValue:u.attendee_user_ids,"onUpdate:modelValue":w[4]||(w[4]=M=>u.attendee_user_ids=M),options:l.projectUsers,"label-key":"name","track-by":"id",placeholder:"Select attendees",class:"mt-1"},null,8,["modelValue","options"]),w[12]||(w[12]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select project members to invite to this meeting ",-1)),p(le,{message:j.attendee_user_ids?j.attendee_user_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"location",value:"Location (Optional)"}),p(oe,{id:"location",modelValue:u.location,"onUpdate:modelValue":w[5]||(w[5]=M=>u.location=M),type:"text",class:"mt-1 block w-full",placeholder:"Office, Conference Room, etc."},null,8,["modelValue"]),p(le,{message:j.location?j.location[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"timezone",value:"Timezone"}),p(ge,{id:"timezone",modelValue:u.timezone,"onUpdate:modelValue":w[6]||(w[6]=M=>u.timezone=M),options:c.value,"value-key":"value","label-key":"label",placeholder:"Select timezone",class:"mt-1"},null,8,["modelValue","options"]),w[13]||(w[13]=e("p",{class:"mt-1 text-sm text-gray-500"}," Select your timezone for this meeting ",-1)),p(le,{message:j.timezone?j.timezone[0]:"",class:"mt-2"},null,8,["message"])]),e("div",qa,[me(e("input",{id:"with_google_meet","onUpdate:modelValue":w[7]||(w[7]=M=>u.with_google_meet=M),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[et,u.with_google_meet]]),w[14]||(w[14]=e("label",{for:"with_google_meet",class:"ml-2 block text-sm text-gray-900"}," Create Google Meet video conference ",-1))]),e("div",Ga,[me(e("input",{id:"enable_recording","onUpdate:modelValue":w[8]||(w[8]=M=>u.enable_recording=M),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[et,u.enable_recording]]),w[15]||(w[15]=e("label",{for:"enable_recording",class:"ml-2 block text-sm text-gray-900"}," Enable recording and transcript ",-1))])]),e("div",Ka,[w[22]||(w[22]=e("h4",{class:"text-xl font-bold text-gray-800"},"Meeting Preview",-1)),e("div",Ja,[e("div",null,[w[16]||(w[16]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Title",-1)),e("p",Za,y(d.value||"Untitled Meeting"),1)]),e("div",null,[w[17]||(w[17]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Date & Time",-1)),e("p",Xa,y(R.value||"No date and time selected."),1),u.timezone?(o(),r("p",Qa,"Timezone: "+y(u.timezone),1)):T("",!0)]),u.description?(o(),r("div",ei,[w[18]||(w[18]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Description",-1)),e("p",ti,y(u.description),1)])):T("",!0),L.value.length>0?(o(),r("div",si,[w[19]||(w[19]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Attendees",-1)),e("div",li,[(o(!0),r(Z,null,ee(L.value,M=>(o(),r("span",{key:M,class:"px-3 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},y(M),1))),128))])])):T("",!0),u.location?(o(),r("div",ai,[w[20]||(w[20]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Location",-1)),e("p",ii,y(u.location),1)])):T("",!0),e("div",null,[w[21]||(w[21]=e("h5",{class:"font-semibold text-sm text-gray-600 mb-1"},"Options",-1)),e("ul",ni,[u.with_google_meet?(o(),r("li",oi,"Google Meet enabled")):T("",!0),u.enable_recording?(o(),r("li",ri,"Recording and transcript enabled")):T("",!0),!u.with_google_meet&&!u.enable_recording?(o(),r("li",di,"No special options selected.")):T("",!0)])])])])])]),_:1},8,["show","api-endpoint","form-data"]))}},ci=Ee(ui,[["__scopeId","data-v-674b7e2a"]]),mi={class:"p-6"},vi={key:0,class:"mb-4 p-3 bg-green-100 text-green-800 rounded-md"},pi={key:1,class:"mb-4 p-3 bg-red-100 text-red-800 rounded-md"},gi={class:"mb-4"},hi=["value"],yi={class:"mt-6 flex justify-end space-x-3"},fi={__name:"ProjectMagicLinkModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectClients:{type:Array,default:()=>[]}},emits:["close"],setup(s,{emit:t}){const l=s,n=t,i=k(!1),a=k(""),c=k(""),m=k(""),u=async()=>{var v,g;if(!a.value){m.value="Please select a client email";return}i.value=!0,c.value="",m.value="";try{const _=await window.axios.post(`/api/projects/${l.projectId}/magic-link`,{email:a.value});_.data.success?(c.value=_.data.message,a.value=""):m.value=_.data.message||"Failed to send magic link"}catch(_){console.error("Error sending magic link:",_),m.value=((g=(v=_.response)==null?void 0:v.data)==null?void 0:g.message)||"An error occurred while sending the magic link"}finally{i.value=!1}},d=()=>{a.value="",c.value="",m.value="",n("close")};return(v,g)=>(o(),X(Ce,{show:s.show,onClose:d},{default:U(()=>[e("div",mi,[e("div",{class:"flex justify-between items-center mb-4"},[g[2]||(g[2]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Send Magic Link to Client",-1)),e("button",{onClick:d,class:"text-gray-400 hover:text-gray-500"},g[1]||(g[1]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),c.value?(o(),r("div",vi,y(c.value),1)):T("",!0),m.value?(o(),r("div",pi,y(m.value),1)):T("",!0),e("div",gi,[p(Y,{for:"client-email",value:"Select Client"}),me(e("select",{id:"client-email","onUpdate:modelValue":g[0]||(g[0]=_=>a.value=_),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full"},[g[3]||(g[3]=e("option",{value:""},"Select a client",-1)),(o(!0),r(Z,null,ee(s.projectClients,_=>(o(),r("option",{key:_.id,value:_.email},y(_.name)+" ("+y(_.email)+") ",9,hi))),128))],512),[[We,a.value]]),g[4]||(g[4]=e("p",{class:"mt-2 text-sm text-gray-500"}," The magic link will be sent to the selected client's email address. ",-1))]),e("div",yi,[p(ye,{onClick:d,type:"button"},{default:U(()=>g[5]||(g[5]=[W(" Cancel ",-1)])),_:1,__:[5]}),p(de,{onClick:u,disabled:i.value||!a.value,class:"bg-purple-600 hover:bg-purple-700"},{default:U(()=>[W(y(i.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},bi={class:"mt-6 space-y-6"},wi={class:"mt-2 flex space-x-4"},_i={class:"inline-flex items-center"},xi={class:"inline-flex items-center"},ki={key:0},Di={key:1},Ci=["required"],Ti={__name:"ResourceModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},resource:{type:Object,default:null}},emits:["close","saved"],setup(s,{emit:t}){const l=s,n=t,i=k({name:"",type:"link",url:"",file:null,description:""}),a=k(null),c=N(()=>l.resource?`/api/projects/${l.projectId}/resources/${l.resource.id}`:`/api/projects/${l.projectId}/resources`),m=N(()=>l.resource?"put":"post"),u=N(()=>l.resource?"Update Resource":"Add Resource"),d=N(()=>l.resource?"Resource updated successfully!":"Resource added successfully!");re(()=>l.show,S=>{S&&(l.resource?i.value={name:l.resource.name,type:l.resource.type,url:l.resource.type==="link"?l.resource.url:"",file:null,description:l.resource.description||""}:i.value={name:"",type:"link",url:"",file:null,description:""},a.value&&(a.value.value=""))},{immediate:!0});const v=S=>{i.value.file=S.target.files[0]||null},g=S=>{const $=new FormData;return $.append("name",S.name||""),$.append("type",S.type||"link"),$.append("description",S.description||""),S.type==="link"?$.append("url",S.url||""):S.type==="file"&&S.file&&$.append("file",S.file),(m.value==="put"||m.value==="patch")&&$.append("_method","PUT"),$},_=S=>{n("saved",S.resource)},E=()=>{n("close")};return(S,$)=>(o(),X(Te,{show:s.show,title:s.resource?"Edit Resource":"Add Resource","api-endpoint":c.value,"http-method":m.value,"form-data":i.value,"submit-button-text":u.value,"success-message":d.value,"format-data-for-api":g,onClose:E,onSubmitted:_},{default:U(({errors:b})=>[e("div",bi,[e("div",null,[p(Y,{for:"resource-type",value:"Resource Type"}),e("div",wi,[e("label",_i,[me(e("input",{type:"radio","onUpdate:modelValue":$[0]||($[0]=D=>i.value.type=D),value:"link",class:"form-radio text-indigo-600"},null,512),[[ct,i.value.type]]),$[5]||($[5]=e("span",{class:"ml-2 text-gray-700"},"Link",-1))]),e("label",xi,[me(e("input",{type:"radio","onUpdate:modelValue":$[1]||($[1]=D=>i.value.type=D),value:"file",class:"form-radio text-indigo-600"},null,512),[[ct,i.value.type]]),$[6]||($[6]=e("span",{class:"ml-2 text-gray-700"},"File",-1))])])]),e("div",null,[p(Y,{for:"resource-name",value:"Name"}),p(oe,{id:"resource-name",modelValue:i.value.name,"onUpdate:modelValue":$[2]||($[2]=D=>i.value.name=D),type:"text",class:"mt-1 block w-full",placeholder:"Enter resource name",required:""},null,8,["modelValue"]),p(le,{message:b.name?b.name[0]:"",class:"mt-2"},null,8,["message"])]),i.value.type==="link"?(o(),r("div",ki,[p(Y,{for:"resource-url",value:"URL"}),p(oe,{id:"resource-url",modelValue:i.value.url,"onUpdate:modelValue":$[3]||($[3]=D=>i.value.url=D),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com",required:""},null,8,["modelValue"]),p(le,{message:b.url?b.url[0]:"",class:"mt-2"},null,8,["message"])])):T("",!0),i.value.type==="file"?(o(),r("div",Di,[p(Y,{for:"resource-file",value:"File"}),e("input",{id:"resource-file",ref_key:"fileInputRef",ref:a,type:"file",class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",onChange:v,required:!s.resource||i.value.type==="file"},null,40,Ci),p(le,{message:b.file?b.file[0]:"",class:"mt-2"},null,8,["message"])])):T("",!0),e("div",null,[p(Y,{for:"resource-description",value:"Description (Optional)"}),me(e("textarea",{id:"resource-description","onUpdate:modelValue":$[4]||($[4]=D=>i.value.description=D),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter a description for this resource"},null,512),[[we,i.value.description]]),p(le,{message:b.description?b.description[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},Ei=Ee(Ti,[["__scopeId","data-v-f508dda8"]]),Si={class:"flex flex-col space-y-6"},ji={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Mi={key:0},$i={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},Vi={class:"mb-4"},Ai={key:0,class:"text-xs text-gray-500 mt-1"},Ii={key:0,class:"text-xs text-gray-500 mt-1"},Oi={class:"flex justify-between items-center mb-3"},Li={key:0,class:"flex items-center"},Ui={key:1},Ni={class:"bg-gray-100 p-4 rounded-lg shadow-inner min-h-[300px]"},Pi={key:0,class:"flex items-center justify-center h-full"},Ri=["innerHTML"],Fi={__name:"ComposeEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},clients:{type:Array,default:()=>[]}},emits:["close"],setup(s,{emit:t}){const l=s,n=t,i=k([]),a=k(""),c=k(!1),m=k({}),u=k({}),d=k(!1),v=De({template_id:null,template_data:{},project_id:l.projectId,client_ids:[],subject:"",greeting_name:"",custom_greeting_name:"",status:"pending_approval"});tt(l.projectId);const g=N(()=>i.value.find(w=>w.id===v.template_id)),_=async w=>{d.value=!0,u.value={};const j=new Set;w.placeholders.forEach(M=>{(M.is_repeatable||M.is_selectable)&&M.source_model&&j.add(M.source_model)});try{const M=Array.from(j).map(f=>{const h=f.split("\\").pop(),x=`/api/projects/${l.projectId}/model-data/${h}`;return window.axios.get(x).then(V=>{u.value[h]=V.data})});await Promise.all(M)}catch(M){console.error("Failed to fetch source model data:",M)}finally{d.value=!1}},E=async()=>{try{const w=await window.axios.get("/api/email-templates");i.value=w.data}catch(w){console.error("Failed to fetch email templates:",w)}},S=async()=>{if(!v.template_id||v.client_ids.length===0){a.value='<p class="text-gray-500 italic">Select a template and at least one recipient to see a preview.</p>';return}c.value=!0;try{const w=v.client_ids[0],j=typeof w=="object"?w.id:w,M=await window.axios.post(`/api/projects/${l.projectId}/email-preview`,{template_id:v.template_id,client_id:j,template_data:v.template_data});a.value=M.data.body_html,M.data.subject&&(v.subject=M.data.subject)}catch(w){console.error("Failed to fetch email preview:",w),a.value='<p class="text-red-500 italic">Error loading preview.</p>'}finally{c.value=!1}};re(()=>l.show,w=>{w&&(Object.assign(v,{template_id:null,template_data:{},project_id:l.projectId,client_ids:[],subject:"",greeting_name:"",custom_greeting_name:"",status:"pending_approval"}),a.value="",m.value={},u.value={},E())}),re(g,w=>{v.template_data={},w&&w.placeholders&&(w.placeholders.forEach(j=>{j.is_dynamic?v.template_data[j.name]="":(j.is_repeatable||j.is_selectable)&&(j.is_repeatable?v.template_data[j.name]=[]:v.template_data[j.name]=null)}),_(w))});const $=async()=>{if(Array.isArray(v.client_ids)&&v.client_ids.length>0&&typeof v.client_ids[0]=="object"&&(v.client_ids=v.client_ids.map(w=>w.id)),!v.subject&&g.value&&(v.subject=g.value.subject||""),v.client_ids.length>0){const w=v.client_ids[0],j=l.clients.find(M=>M.id===w);j&&(v.greeting_name=j.name||"")}return console.log("Form data prepared:",JSON.stringify(v)),!0},b=()=>{n("close")},D=()=>{n("close")},R=N(()=>i.value.map(w=>({value:w.id,label:w.name}))),L=N(()=>g.value?g.value.placeholders.filter(w=>w.is_dynamic||w.is_repeatable||w.is_selectable):[]),O=N(()=>"/api/emails/templated");return be(()=>{E()}),(w,j)=>(o(),X(Te,{show:s.show,title:"Compose Email from Template","api-endpoint":O.value,"http-method":"post","form-data":v,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!",onClose:D,onSubmitted:b,"before-submit":$},{default:U(({errors:M})=>[e("div",Si,[e("div",ji,[e("div",null,[p(Y,{for:"template",value:"Select Template"}),p(ge,{id:"template",modelValue:v.template_id,"onUpdate:modelValue":j[0]||(j[0]=f=>v.template_id=f),options:R.value,placeholder:"Select a template","value-key":"value","label-key":"label","allow-empty":!0,class:"mt-1"},null,8,["modelValue","options"]),p(le,{message:M.template_id?M.template_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"client_ids",value:"Recipients"}),p(Le,{id:"client_ids",modelValue:v.client_ids,"onUpdate:modelValue":j[1]||(j[1]=f=>v.client_ids=f),options:s.clients,placeholder:"Select clients to send to","label-key":"name","track-by":"id","preserve-search":!0,"object-value":!0,class:"mt-1"},null,8,["modelValue","options"]),p(le,{message:M.client_ids?M.client_ids[0]:"",class:"mt-2"},null,8,["message"])])]),g.value?(o(),r("div",Mi,[j[2]||(j[2]=e("h4",{class:"text-md font-semibold text-gray-800 mb-3"},"Dynamic Placeholders",-1)),e("div",$i,[(o(!0),r(Z,null,ee(L.value,f=>(o(),r("div",{key:f.id},[e("div",Vi,[p(Y,{for:f.name,value:f.name},null,8,["for","value"]),f.is_repeatable&&f.source_model?(o(),r(Z,{key:0},[p(Le,{id:f.name,modelValue:v.template_data[f.name],"onUpdate:modelValue":h=>v.template_data[f.name]=h,options:u.value[f.source_model.split("\\").pop()]||[],placeholder:`Select one or more ${f.name}`,"label-key":f.source_attribute,"track-by":"id",class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue","options","placeholder","label-key"]),d.value?(o(),r("div",Ai," Loading "+y(f.source_model.split("\\").pop())+"... ",1)):T("",!0)],64)):f.is_selectable&&f.source_model?(o(),r(Z,{key:1},[p(ge,{id:f.name,modelValue:v.template_data[f.name],"onUpdate:modelValue":h=>v.template_data[f.name]=h,options:u.value[f.source_model.split("\\").pop()]||[],placeholder:`Select a ${f.name}`,"value-key":f.trackBy??"id","label-key":f.source_attribute,"allow-empty":!0,class:"mt-1"},null,8,["id","modelValue","onUpdate:modelValue","options","placeholder","value-key","label-key"]),d.value?(o(),r("div",Ii," Loading "+y(f.source_model.split("\\").pop())+"... ",1)):T("",!0)],64)):f.is_dynamic&&f.is_link?(o(),X(oe,{key:2,id:f.name,type:"url",class:"mt-1 block w-full",modelValue:v.template_data[f.name],"onUpdate:modelValue":h=>v.template_data[f.name]=h,placeholder:"Enter URL"},null,8,["id","modelValue","onUpdate:modelValue"])):(o(),X(oe,{key:3,id:f.name,type:"text",class:"mt-1 block w-full",modelValue:v.template_data[f.name],"onUpdate:modelValue":h=>v.template_data[f.name]=h},null,8,["id","modelValue","onUpdate:modelValue"])),p(le,{message:M[`template_data.${f.name}`]?M[`template_data.${f.name}`][0]:"",class:"mt-2"},null,8,["message"])])]))),128))])])):T("",!0),e("div",null,[e("div",Oi,[j[4]||(j[4]=e("h4",{class:"text-md font-semibold text-gray-800"},"Email Preview",-1)),p(de,{onClick:S,disabled:!v.template_id||v.client_ids.length===0||c.value,class:te({"opacity-50 cursor-not-allowed":!v.template_id||v.client_ids.length===0||c.value})},{default:U(()=>[c.value?(o(),r("span",Li,j[3]||(j[3]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),W(" Loading... ",-1)]))):(o(),r("span",Ui," Refresh Preview "))]),_:1},8,["disabled","class"])]),e("div",Ni,[c.value?(o(),r("div",Pi,j[5]||(j[5]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"},null,-1)]))):(o(),r("div",{key:1,innerHTML:a.value},null,8,Ri))])])])]),_:1},8,["show","api-endpoint","form-data"]))}},Bi={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Hi={class:"flex justify-between items-center mb-4"},Wi={class:"flex gap-3"},Yi={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},zi={class:"text-2xl font-bold text-gray-900 tracking-tight mb-2"},qi={class:"text-gray-600 text-base"},Gi={class:"space-y-3 text-sm text-gray-700"},Ki={class:"flex flex-wrap gap-2 mt-2 items-center"},Ji=["href"],Zi=["href"],Xi=["href"],Qi={key:3,class:"text-gray-500 text-sm"},en={class:"relative"},tn=["onClick"],sn={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ln={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},an={key:0,class:"resource-tooltip absolute left-0 bottom-full mb-2 w-48 z-10"},nn={class:"bg-white rounded-md shadow-lg p-3 text-sm border border-gray-200"},on={class:"flex justify-between items-center mb-2"},rn={class:"font-medium text-gray-900"},dn={key:0,class:"text-gray-600 text-xs mb-2"},un={class:"flex justify-between mt-2 pt-2 border-t border-gray-100"},cn=["href"],mn={class:"flex space-x-2"},vn=["onClick"],pn=["onClick"],gn={class:"p-6"},hn={key:0,class:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-md"},yn={key:1,class:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-md"},fn={class:"mb-4"},bn={key:0,class:"text-gray-500 text-sm mt-1"},wn={key:1,class:"text-red-500 text-sm mt-1"},_n={class:"flex justify-end mt-6"},xn={__name:"ProjectGeneralInfoCard",props:{project:{type:Object,required:!0},projectId:{type:Number,required:!0},canManageProjects:{type:Boolean,required:!0},canEditProjects:{type:Boolean,required:!1},isSuperAdmin:{type:Boolean,required:!0}},emits:["openEditModal","openStandupModal","openMeetingModal","resourceSaved","openComposeModal"],setup(s,{emit:t}){const l=s,n=t,i=k(!1),a=k(null),c=k([]),m=k(!1),u=k(null),d=k(!1),v=k(!1),g=k(!1),_=k({client_ids:[]}),E=k({}),S=k(""),$=k([]),b=k(!1),D=k("");tt(l.projectId);const R=async()=>{m.value=!0;try{const A=await window.axios.get(`/api/projects/${l.projectId}/resources`);A.data.success?c.value=A.data.resources:console.error("Failed to fetch resources:",A.data.message)}catch(A){console.error("Error fetching resources:",A)}finally{m.value=!1}},L=()=>{a.value=null,i.value=!0},O=A=>{a.value=A,i.value=!0},w=async A=>{if(confirm("Are you sure you want to delete this resource?"))try{const C=await window.axios.delete(`/api/projects/${l.projectId}/resources/${A}`);C.data.success?c.value=c.value.filter(I=>I.id!==A):console.error("Failed to delete resource:",C.data.message)}catch(C){console.error("Error deleting resource:",C)}},j=A=>{if(a.value){const C=c.value.findIndex(I=>I.id===A.id);C!==-1&&(c.value[C]=A)}else c.value.push(A);n("resourceSaved",A)},M=A=>{u.value=u.value===A?null:A},f=()=>{u.value=null},h=A=>{if(u.value!==null){const C=A.target.closest(".resource-tooltip"),I=A.target.closest(".resource-button");!C&&!I&&f()}};be(()=>{R(),document.addEventListener("click",h)}),Qt(()=>{document.removeEventListener("click",h)});const x=async()=>{var A,C;b.value=!0,D.value="";try{const I=await window.axios.get(`/api/projects/${l.projectId}/sections/clients?type=clients`);console.log(I),$.value=I.data}catch(I){console.error("Failed to fetch project clients:",I),D.value=((C=(A=I.response)==null?void 0:A.data)==null?void 0:C.message)||"Failed to load client data."}finally{b.value=!1}},V=()=>{_.value.client_ids=[],E.value={},S.value="",v.value=!0,x()},K=()=>{d.value=!0,x()},ie=()=>{v.value=!1},B=async()=>{if(E.value={},S.value="",g.value=!0,!_.value.client_ids||_.value.client_ids.length===0){E.value={client_ids:["Please select a client."]},g.value=!1;return}try{const A=_.value.client_ids[0];if(!$.value.find(z=>z.id===A)){E.value={client_ids:["Selected client does not have a valid email."]},g.value=!1;return}const I=await window.axios.post(`/api/projects/${l.projectId}/magic-link`,{client_id:A});I.data.success&&(S.value=I.data.message,_.value.client_ids=[])}catch(A){A.response&&A.response.status===422?E.value=A.response.data.errors:A.response&&A.response.data.message?E.value={general:[A.response.data.message]}:E.value={general:["An unexpected error occurred. Please try again."]}}finally{g.value=!1}};return(A,C)=>{var I;return o(),r(Z,null,[e("div",Bi,[e("div",Hi,[C[12]||(C[12]=e("h4",{class:"text-lg font-semibold text-gray-900"},"General Information",-1)),e("div",Wi,[p(de,{class:"bg-blue-600 hover:bg-blue-700 transition-colors",onClick:C[0]||(C[0]=z=>n("openStandupModal"))},{default:U(()=>C[8]||(C[8]=[W(" Daily Standup ",-1)])),_:1,__:[8]}),s.canEditProjects||s.isSuperAdmin?(o(),X(de,{key:0,onClick:C[1]||(C[1]=z=>A.$inertia.visit("/projects/"+s.projectId+"/edit")),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:U(()=>C[9]||(C[9]=[W(" Edit Project ",-1)])),_:1,__:[9]})):T("",!0),s.canManageProjects||s.isSuperAdmin?(o(),X(de,{key:1,class:"bg-green-600 hover:bg-green-700 transition-colors",onClick:C[2]||(C[2]=z=>n("openMeetingModal"))},{default:U(()=>C[10]||(C[10]=[W(" Schedule Meeting ",-1)])),_:1,__:[10]})):T("",!0),s.canManageProjects||s.isSuperAdmin?(o(),X(de,{key:2,class:"bg-blue-400 hover:bg-blue-600 transition-colors",onClick:K},{default:U(()=>C[11]||(C[11]=[W(" Compose Email ",-1)])),_:1,__:[11]})):T("",!0),s.canManageProjects?(o(),X(de,{key:3,class:"bg-purple-600 hover:bg-purple-700 transition-colors",onClick:V,disabled:g.value},{default:U(()=>[W(y(g.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])):T("",!0)])]),e("div",Yi,[e("div",null,[e("h3",zi,y(s.project.name),1),e("p",qi,y(s.project.description||"No description provided"),1)]),e("div",Gi,[e("p",null,[C[13]||(C[13]=e("strong",{class:"text-gray-900"},"Status:",-1)),W(" "+y(((I=s.project.status)==null?void 0:I.replace("_"," ").toUpperCase())||"N/A"),1)]),e("p",null,[C[14]||(C[14]=e("strong",{class:"text-gray-900"},"Project Type:",-1)),W(" "+y(s.project.project_type||"N/A"),1)]),e("p",null,[C[15]||(C[15]=e("strong",{class:"text-gray-900"},"Source:",-1)),W(" "+y(s.project.source||"N/A"),1)]),e("div",Ki,[e("button",{onClick:L,class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Add Resource"},C[16]||(C[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])),s.project.website?(o(),r("a",{key:0,href:s.project.website,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Visit Website"},C[17]||(C[17]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})],-1)]),8,Ji)):T("",!0),s.project.social_media_link?(o(),r("a",{key:1,href:s.project.social_media_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Social Media"},C[18]||(C[18]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})],-1)]),8,Zi)):T("",!0),s.project.google_drive_link?(o(),r("a",{key:2,href:s.project.google_drive_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Google Drive"},C[19]||(C[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]),8,Xi)):T("",!0),m.value?(o(),r("div",Qi," Loading resources... ")):(o(!0),r(Z,{key:4},ee(c.value,z=>(o(),r("div",{key:z.id,class:"relative"},[e("div",en,[e("button",{onClick:xe(ue=>M(z.id),["prevent"]),class:"resource-button p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors block"},[z.type==="link"?(o(),r("svg",sn,C[20]||(C[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.172 13.828a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.102 1.101"},null,-1)]))):(o(),r("svg",ln,C[21]||(C[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])))],8,tn),u.value===z.id?(o(),r("div",an,[e("div",nn,[e("div",on,[e("h4",rn,y(z.name),1),e("button",{onClick:xe(f,["prevent"]),class:"text-gray-400 hover:text-gray-600"},C[22]||(C[22]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),z.description?(o(),r("p",dn,y(z.description),1)):T("",!0),e("div",un,[e("a",{href:z.url,target:"_blank",class:"text-xs text-indigo-600 hover:text-indigo-800"}," Open Link ",8,cn),e("div",mn,[e("button",{onClick:xe(ue=>O(z),["prevent"]),class:"p-1 text-gray-500 hover:text-indigo-600",title:"Edit"},C[23]||(C[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,vn),e("button",{onClick:xe(ue=>w(z.id),["prevent"]),class:"p-1 text-gray-500 hover:text-red-600",title:"Delete"},C[24]||(C[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,pn)])])]),C[25]||(C[25]=e("div",{class:"absolute left-5 bottom-0 transform translate-y-1/2 rotate-45 w-2 h-2 bg-white border-r border-b border-gray-200"},null,-1))])):T("",!0)])]))),128))])])])]),p(Ei,{show:i.value,"project-id":s.projectId,resource:a.value,onClose:C[3]||(C[3]=z=>i.value=!1),onSaved:j},null,8,["show","project-id","resource"]),p(Ce,{show:v.value,onClose:ie},{default:U(()=>[e("div",gn,[C[28]||(C[28]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Send Magic Link ",-1)),S.value?(o(),r("div",hn,y(S.value),1)):T("",!0),E.value.general?(o(),r("div",yn,y(E.value.general[0]),1)):T("",!0),e("form",{onSubmit:xe(B,["prevent"])},[e("div",fn,[p(Y,{for:"client",value:"Select Client"}),b.value?(o(),r("div",bn,"Loading clients...")):D.value?(o(),r("div",wn,y(D.value),1)):(o(),X(Le,{key:2,id:"client",modelValue:_.value.client_ids,"onUpdate:modelValue":C[4]||(C[4]=z=>_.value.client_ids=z),options:$.value,placeholder:"Select a client","label-key":"name","track-by":"id",class:"mt-1"},null,8,["modelValue","options"])),p(le,{message:E.value.client_ids?E.value.client_ids[0]:"",class:"mt-2"},null,8,["message"]),C[26]||(C[26]=e("p",{class:"mt-2 text-sm text-gray-500"}," Select a client to send them a magic link for project access. ",-1))]),e("div",_n,[p(ye,{onClick:ie,class:"mr-3"},{default:U(()=>C[27]||(C[27]=[W(" Cancel ",-1)])),_:1,__:[27]}),p(de,{type:"submit",class:"bg-purple-600 hover:bg-purple-700 transition-colors",disabled:g.value},{default:U(()=>[W(y(g.value?"Sending...":"Send Magic Link"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),p(Fi,{show:d.value,title:"Compose New Email","api-endpoint":"/api/emails/templated","http-method":"post",clients:$.value,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","project-id":s.projectId,onClose:C[5]||(C[5]=z=>d.value=!1),onSubmitted:C[6]||(C[6]=z=>d.value=!1),onError:C[7]||(C[7]=z=>console.error("Email submission error:",z))},null,8,["show","clients","project-id"])],64)}}},kn=Ee(xn,[["__scopeId","data-v-5f39fde9"]]),Dn={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},Cn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Tn={class:"text-2xl font-bold text-indigo-600"},En={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Sn={class:"text-2xl font-bold text-indigo-600"},jn={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Mn={class:"text-2xl font-bold text-indigo-600"},$n={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Vn={class:"text-2xl font-bold text-indigo-600"},An={__name:"ProjectStatsCards",props:{tasks:{type:Array,required:!0},emails:{type:Array,required:!0}},setup(s){const t=s,l=N(()=>t.tasks.filter(c=>c.status!=="Done").length),n=N(()=>t.emails.filter(c=>c.type==="received").length),i=N(()=>{const c=t.emails.filter(m=>m.status==="received"||m.type==="received");if(c.length>0){const m=[...c].sort((u,d)=>new Date(d.created_at)-new Date(u.created_at));return new Date(m[0].created_at).toLocaleDateString()}return"N/A"}),a=N(()=>{const c=t.tasks.filter(m=>m.status!=="Done");if(c.length>0){const m=c.filter(u=>u.due_date);if(m.length>0)return[...m].sort((d,v)=>new Date(d.due_date)-new Date(v.due_date))[0].due_date}return"N/A"});return(c,m)=>(o(),r("div",Dn,[e("div",Cn,[m[0]||(m[0]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Pending Tasks",-1)),e("p",Tn,y(l.value),1)]),e("div",En,[m[1]||(m[1]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Received Emails",-1)),e("p",Sn,y(n.value),1)]),e("div",jn,[m[2]||(m[2]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Last Email Received",-1)),e("p",Mn,y(i.value),1)]),e("div",$n,[m[3]||(m[3]=e("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Next Task Deadline",-1)),e("p",Vn,y(a.value),1)])]))}},In={class:"bg-white p-4 rounded-xl shadow-md mb-6"},On={class:"border-b border-gray-200"},Ln={__name:"ProjectTabsNavigation",props:{selectedTab:{type:String,default:null},canViewEmails:{type:Boolean,required:!0},canViewNotes:{type:Boolean,required:!0},canViewDeliverables:{type:Boolean,required:!0},canViewSeoReports:{type:Boolean,required:!0}},emits:["update:selectedTab"],setup(s,{expose:t,emit:l}){const n=k(null),i=s,a=l,c=N({get:()=>i.selectedTab,set:u=>a("update:selectedTab",u)});return t({scrollIntoView:u=>{n.value&&n.value.scrollIntoView(u)}}),(u,d)=>(o(),r("div",In,[e("div",On,[e("nav",{class:"-mb-px flex space-x-8 overflow-x-auto",ref_key:"navElement",ref:n},[e("button",{onClick:d[0]||(d[0]=v=>c.value=null),class:te([c.value===null?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Overview ",2),e("button",{onClick:d[1]||(d[1]=v=>c.value="tasks"),class:te([c.value==="tasks"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Project Tasks ",2),s.canViewEmails?(o(),r("button",{key:0,onClick:d[2]||(d[2]=v=>c.value="emails"),class:te([c.value==="emails"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Email Communication ",2)):T("",!0),s.canViewNotes?(o(),r("button",{key:1,onClick:d[3]||(d[3]=v=>c.value="notes"),class:te([c.value==="notes"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Notes ",2)):T("",!0),s.canViewNotes?(o(),r("button",{key:2,onClick:d[4]||(d[4]=v=>c.value="standups"),class:te([c.value==="standups"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Daily Standups ",2)):T("",!0),s.canViewDeliverables?(o(),r("button",{key:3,onClick:d[5]||(d[5]=v=>c.value="deliverables"),class:te([c.value==="deliverables"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Deliverables ",2)):T("",!0),s.canViewSeoReports?(o(),r("button",{key:4,onClick:d[6]||(d[6]=v=>c.value="seo-reports"),class:te([c.value==="seo-reports"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," SEO Reports ",2)):T("",!0)],512)])]))}},Un={class:"space-y-4"},Nn={key:0,class:"text-sm text-gray-500"},Pn={class:"flex justify-between items-center"},Rn={key:0,class:"text-sm text-gray-500"},Fn="put",Bn="Update Task",Hn="Task updated successfully!",Wn={__name:"EditTaskModal",props:{show:Boolean,projectId:Number,selectedTask:Object,projectUsers:Array,taskTypes:Array,milestones:Array,loadingTaskTypes:Boolean,loadingMilestones:Boolean},emits:["close","saved","open-add-milestone-modal"],setup(s,{emit:t}){const l=s,n=t,i=De({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]}),a=["To Do","In Progress","Done","Blocked","Archived"],c=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],m=N(()=>"Edit Task"),u=N(()=>{var $;return`/api/tasks/${($=l.selectedTask)==null?void 0:$.id}`});re(()=>[l.show,l.selectedTask],([$,b],[D,R]=[])=>{var L;if($&&b){let O=null;if(b.milestone){const f=l.milestones.find(h=>h.name===b.milestone);f&&(O=f.id)}else b.milestone_id&&(O=b.milestone_id);let w=null;if(b.task_type){const f=l.taskTypes.find(h=>h.name===b.task_type);f&&(w=f.id)}else b.task_type_id&&(w=b.task_type_id);let j=null;if(b.assigned_to&&b.assigned_to!=="Unassigned"){const f=(L=l.projectUsers)==null?void 0:L.find(h=>h.name===b.assigned_to);f&&(j=f.id)}else b.assigned_to_id&&(j=b.assigned_to_id);let M=[];b.tags&&Array.isArray(b.tags)&&b.tags.length>0&&(typeof b.tags[0]=="string"?M=b.tags.map(f=>({id:`new_${f.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:f})):typeof b.tags[0]=="object"&&(M=b.tags)),Object.assign(i,{name:b.title||"",description:b.description||"",assigned_to_user_id:j,due_date:b.due_date||null,status:b.status||"To Do",task_type_id:w,milestone_id:O,priority:b.priority||"medium",tags:M.map(f=>f.id),tags_data:M}),console.log("Task data loaded:",{taskId:b.id,title:b.title,originalTags:b.tags,processedTags:M,formTags:i.tags,formTagsData:i.tags_data})}else $||Object.assign(i,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,priority:"medium",tags:[],tags_data:[]})},{immediate:!0});const d=$=>{n("saved",$),n("close")},v=()=>{n("open-add-milestone-modal")},g=()=>{n("close")},_=N(()=>l.projectUsers.map($=>({value:$.id,label:$.name}))),E=N(()=>l.taskTypes.map($=>({value:$.id,label:$.name}))),S=N(()=>l.milestones.map($=>({value:$.id,label:$.name})));return($,b)=>(o(),X(Te,{show:s.show,title:m.value,"api-endpoint":u.value,"http-method":Fn,"form-data":i,"submit-button-text":Bn,"success-message":Hn,onClose:g,onSubmitted:d},{default:U(({errors:D})=>[e("div",Un,[e("div",null,[p(Y,{for:"task-name",value:"Task Name"}),p(oe,{id:"task-name",modelValue:i.name,"onUpdate:modelValue":b[0]||(b[0]=R=>i.name=R),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),p(le,{message:D.name?D.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"task-description",value:"Description"}),me(e("textarea",{id:"task-description","onUpdate:modelValue":b[1]||(b[1]=R=>i.description=R),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[we,i.description]]),p(le,{message:D.description?D.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"task-status",value:"Status"}),p(ge,{id:"task-status",modelValue:i.status,"onUpdate:modelValue":b[2]||(b[2]=R=>i.status=R),options:a.map(R=>({value:R,label:R})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),p(le,{message:D.status?D.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"task-priority",value:"Priority"}),p(ge,{id:"task-priority",modelValue:i.priority,"onUpdate:modelValue":b[3]||(b[3]=R=>i.priority=R),options:c,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),p(le,{message:D.priority?D.priority[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"task-due-date",value:"Due Date"}),p(oe,{id:"task-due-date",modelValue:i.due_date,"onUpdate:modelValue":b[4]||(b[4]=R=>i.due_date=R),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),p(le,{message:D.due_date?D.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"task-assigned-to",value:"Assigned To"}),p(ge,{id:"task-assigned-to",modelValue:i.assigned_to_user_id,"onUpdate:modelValue":b[5]||(b[5]=R=>i.assigned_to_user_id=R),options:_.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"]),p(le,{message:D.assigned_to_user_id?D.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"task-type",value:"Task Type"}),s.loadingTaskTypes?(o(),r("div",Nn,"Loading task types...")):(o(),X(ge,{key:1,id:"task-type",modelValue:i.task_type_id,"onUpdate:modelValue":b[6]||(b[6]=R=>i.task_type_id=R),options:E.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),p(le,{message:D.task_type_id?D.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[e("div",Pn,[p(Y,{for:"task-milestone",value:"Milestone"}),e("button",{type:"button",onClick:v,class:"text-sm text-indigo-600 hover:text-indigo-800"}," + Create New Milestone ")]),s.loadingMilestones?(o(),r("div",Rn,"Loading milestones...")):(o(),X(ge,{key:1,id:"task-milestone",modelValue:i.milestone_id,"onUpdate:modelValue":b[7]||(b[7]=R=>i.milestone_id=R),options:S.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),p(le,{message:D.milestone_id?D.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Bt,{modelValue:i.tags,"onUpdate:modelValue":b[8]||(b[8]=R=>i.tags=R),initialTags:i.tags_data,label:"Tags",placeholder:"Search or add tags",error:D.tags?D.tags[0]:""},null,8,["modelValue","initialTags","error"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},Yn={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},zn={class:"flex justify-between items-center mb-4"},qn={class:"flex gap-2"},Gn={key:0},Kn={key:1},Jn={class:"mb-6 overflow-x-auto"},Zn={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Xn={key:1,class:"text-center py-4"},Qn={key:2,class:"relative py-8"},eo={class:"relative flex justify-between"},to={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},so={key:1,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},lo={key:2,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ao={key:3,class:"w-2 h-2 bg-white rounded-full"},io={class:"absolute -top-8 transform -translate-x-1/2 left-1/2 w-32"},no=["title"],oo={class:"absolute top-8 transform -translate-x-1/2 left-1/2"},ro={class:"text-xs text-gray-500 whitespace-nowrap"},uo={class:"mb-6 bg-gray-50 p-4 rounded-lg"},co={class:"flex flex-wrap items-center gap-4"},mo={class:"flex-1 min-w-[200px]"},vo={class:"flex-1 min-w-[200px]"},po={class:"flex-1 min-w-[200px]"},go={class:"flex-1 min-w-[200px]"},ho={key:0,class:"mt-3 text-sm text-gray-600"},yo={key:0,class:"text-red-600 font-medium"},fo={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},bo={key:1,class:"text-center py-4"},wo={class:"text-red-600 text-sm font-medium"},_o={key:2,class:"overflow-x-auto"},xo={key:3,class:"text-center py-4"},ko={class:"p-6"},Do={class:"mb-4"},Co={class:"flex justify-end space-x-3"},To={__name:"ProjectTasksTab",props:{projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]},canManageProjects:{type:Boolean,required:!0},tasksFilter:{type:String,default:"all"}},emits:["tasksUpdated","openTaskDetailSidebar","open-create-task-modal","filter-changed"],setup(s,{emit:t}){const l=s,n=t,i=k([]),a=k(!0),c=k(""),m=k(!1),u=k(null),d=k(!1),v=k(!1),g=k(null),_=k(!1),E=k(null),S=k(""),$=k([]),b=k([]),D=k(!1),R=k(!1),L=De({status:"",assigned_to_user_id:null,milestone_id:null,due_date_range:""}),O=[{value:"",label:"All Statuses"},{value:"To Do",label:"To Do"},{value:"In Progress",label:"In Progress"},{value:"Done",label:"Done"},{value:"Blocked",label:"Blocked"},{value:"Archived",label:"Archived"}],w=N(()=>{const P=[{value:null,label:"All Users"},{value:-1,label:"Unassigned"}];return P.push(...l.projectUsers.map(F=>({value:F.id,label:F.name}))),P}),j=N(()=>{const P=[{value:null,label:"All Milestones"},{value:-1,label:"No Milestone"}];return P.push(...b.value.map(F=>({value:F.id,label:F.name}))),P}),M=[{value:"",label:"All Dates"},{value:"today",label:"Due Today"},{value:"this_week",label:"Due This Week"},{value:"next_week",label:"Due Next Week"},{value:"overdue",label:"Overdue"},{value:"no_date",label:"No Due Date"}],f=N(()=>!b.value||!b.value.length?[]:[...b.value].sort((P,F)=>P.completion_date?F.completion_date?new Date(P.completion_date)-new Date(F.completion_date):-1:1)),h=N(()=>i.value.length?(console.log("ProjectTasksTab: Tasks array:",i.value),i.value.filter(P=>{if(L.status&&P.status!==L.status)return!1;if(L.assigned_to_user_id!==null){const F=parseInt(L.assigned_to_user_id);if(F===-1){if(P.assigned_to!=="Unassigned"&&P.assigned_to_id!==null)return!1}else if(P.assigned_to_id!==F)return!1}if(L.milestone_id!==null){const F=parseInt(L.milestone_id);if(F===-1){if(P.milestone_id)return!1}else if(P.milestone_id!==F)return!1}if(L.due_date_range){const F=new Date;F.setHours(0,0,0,0);const q=P.due_date?new Date(P.due_date):null;switch(L.due_date_range){case"today":if(!q||q.toDateString()!==F.toDateString())return!1;break;case"this_week":{if(!q)return!1;const fe=new Date(F);if(fe.setDate(F.getDate()+(6-F.getDay())),q<F||q>fe)return!1;break}case"next_week":{if(!q)return!1;const fe=new Date(F);fe.setDate(F.getDate()+(7-F.getDay()));const Ye=new Date(fe);if(Ye.setDate(fe.getDate()+6),q<fe||q>Ye)return!1;break}case"overdue":{if(!q||q>=F)return!1;break}case"no_date":{if(q)return!1;break}}}return!0})):[]),x=()=>{L.status="",L.assigned_to_user_id=null,L.milestone_id=null,L.due_date_range=""},V=async()=>{a.value=!0,c.value="";try{const P=await Yt(l.projectId);console.log("ProjectTasksTab: Raw API response from fetchProjectTasks:",P),i.value=P,n("tasksUpdated",i.value)}catch(P){c.value="Failed to load tasks data.",console.error("Error fetching project tasks:",P),P.response&&P.response.data&&P.response.data.message&&(c.value=P.response.data.message)}finally{a.value=!1}},K=async P=>{await V()},ie=async()=>{D.value=!0;try{const P=await window.axios.get("/api/task-types");$.value=P.data}catch(P){console.error("Error fetching task types:",P)}finally{D.value=!1}},B=async()=>{R.value=!0;try{const P=await window.axios.get(`/api/projects/${l.projectId}/milestones`);b.value=P.data}catch(P){console.error("Error fetching milestones:",P)}finally{R.value=!1}},A=()=>{n("open-create-task-modal")},C=()=>{V()},I=P=>{console.log("ProjectTasksTab: Emitting openTaskDetailSidebar for taskId:",P,"projectId:",l.projectId),n("openTaskDetailSidebar",P,l.projectId,l.projectUsers)},z=()=>{d.value=!0},ue=P=>{b.value.push(P),V()},Me=()=>{V()},ae=async()=>{if(E.value){if(!S.value.trim()){es("Please provide a reason for blocking the task");return}try{ts("Blocking task..."),await window.axios.post(`/api/tasks/${E.value.id}/block`,{reason:S.value}),ss("Task blocked successfully"),_.value=!1,await V()}catch(P){console.error("Error blocking task:",P),ls("Failed to block task. Please try again.")}}};return be(()=>{V(),ie(),B()}),re(()=>l.projectUsers,()=>{}),re(()=>l.taskTypes,()=>{}),re(()=>l.milestones,()=>{}),re(()=>l.tasksFilter,P=>{P==="due-overdue"?(new Date().setHours(0,0,0,0),L.status="",L.assigned_to_user_id=null,L.milestone_id=null,L.due_date_range="overdue"):P==="all"&&(L.status="",L.assigned_to_user_id=null,L.milestone_id=null,L.due_date_range=""),n("filter-changed",P)}),(P,F)=>(o(),r("div",Yn,[e("div",zn,[F[11]||(F[11]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Tasks",-1)),e("div",qn,[p(ye,{onClick:V,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:U(()=>[a.value?(o(),r("span",Kn,"Loading...")):(o(),r("span",Gn,"Refresh"))]),_:1},8,["disabled"]),s.canManageProjects?(o(),X(de,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:A},{default:U(()=>F[10]||(F[10]=[W(" Add Task ",-1)])),_:1,__:[10]})):T("",!0)])]),e("div",Jn,[R.value?(o(),r("div",Zn," Loading milestones... ")):f.value.length?(o(),r("div",Qn,[F[16]||(F[16]=e("div",{class:"absolute h-1 bg-gray-200 top-1/2 left-0 right-0 transform -translate-y-1/2"},null,-1)),e("div",eo,[(o(!0),r(Z,null,ee(f.value,(q,fe)=>(o(),r("div",{key:q.id,class:te(["flex flex-col items-center relative z-10",{"ml-4":fe===0,"mr-4":fe===f.value.length-1}])},[e("div",{class:te(["w-6 h-6 rounded-full shadow-lg flex items-center justify-center",{"bg-gray-300":q.status==="Not Started","bg-blue-500":q.status==="In Progress","bg-green-500":q.status==="Completed","bg-red-500":q.status==="Overdue"}])},[q.status==="Completed"?(o(),r("svg",to,F[13]||(F[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):q.status==="In Progress"?(o(),r("svg",so,F[14]||(F[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))):q.status==="Overdue"?(o(),r("svg",lo,F[15]||(F[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(o(),r("span",ao))],2),e("div",io,[e("p",{class:"text-xs font-medium text-gray-700 text-center truncate",title:q.name},y(q.name),9,no)]),e("div",oo,[e("p",ro,y(q.completion_date?new Date(q.completion_date).toLocaleDateString():"No date"),1)])],2))),128))])])):(o(),r("div",Xn,F[12]||(F[12]=[e("p",{class:"text-gray-400 text-sm"},"No milestones found for this project.",-1)])))]),e("div",uo,[e("div",co,[e("div",mo,[p(Y,{for:"status-filter",value:"Status"}),p(ge,{id:"status-filter",modelValue:L.status,"onUpdate:modelValue":F[0]||(F[0]=q=>L.status=q),options:O,"value-key":"value","label-key":"label",placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",vo,[p(Y,{for:"assigned-filter",value:"Assigned To"}),p(ge,{id:"assigned-filter",modelValue:L.assigned_to_user_id,"onUpdate:modelValue":F[1]||(F[1]=q=>L.assigned_to_user_id=q),options:w.value,"value-key":"value","label-key":"label",placeholder:"All Users",class:"mt-1"},null,8,["modelValue","options"])]),e("div",po,[p(Y,{for:"milestone-filter",value:"Milestone"}),p(ge,{id:"milestone-filter",modelValue:L.milestone_id,"onUpdate:modelValue":F[2]||(F[2]=q=>L.milestone_id=q),options:j.value,"value-key":"value","label-key":"label",placeholder:"All Milestones",class:"mt-1"},null,8,["modelValue","options"])]),e("div",go,[p(Y,{for:"due-date-filter",value:"Due Date"}),p(ge,{id:"due-date-filter",modelValue:L.due_date_range,"onUpdate:modelValue":F[3]||(F[3]=q=>L.due_date_range=q),options:M,"value-key":"value","label-key":"label",placeholder:"All Dates",class:"mt-1"},null,8,["modelValue"])]),e("div",{class:"flex items-end"},[e("button",{type:"button",onClick:x,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")])]),Object.values(L).some(q=>q!==null&&q!=="")?(o(),r("div",ho,[e("p",null,[W(" Showing "+y(h.value.length)+" of "+y(i.value.length)+" tasks ",1),h.value.length===0?(o(),r("span",yo," (No tasks match the current filters) ")):T("",!0)])])):T("",!0)]),a.value?(o(),r("div",fo," Loading tasks... ")):c.value?(o(),r("div",bo,[e("p",wo,y(c.value),1)])):i.value.length?(o(),r("div",_o,[p(yt,{tasks:h.value,"project-id":s.projectId,"show-project-column":!1,onTaskUpdated:K,onOpenTaskDetail:I},null,8,["tasks","project-id"])])):(o(),r("div",xo,F[17]||(F[17]=[e("p",{class:"text-gray-400 text-sm"},"No tasks found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add Task" button to create a new task. ',-1)]))),p(Wn,{show:m.value,"project-id":s.projectId,"selected-task":u.value,"project-users":s.projectUsers,"task-types":$.value,milestones:b.value,"loading-task-types":D.value,"loading-milestones":R.value,onClose:F[4]||(F[4]=q=>m.value=!1),onSaved:C,onOpenAddMilestoneModal:z},null,8,["show","project-id","selected-task","project-users","task-types","milestones","loading-task-types","loading-milestones"]),p(Ht,{show:d.value,"project-id":s.projectId,onClose:F[5]||(F[5]=q=>d.value=!1),onSaved:ue},null,8,["show","project-id"]),p(Wt,{show:v.value,"task-for-note":g.value,onClose:F[6]||(F[6]=q=>v.value=!1),onNoteAdded:Me},null,8,["show","task-for-note"]),p(Ce,{show:_.value,onClose:F[9]||(F[9]=q=>_.value=!1)},{default:U(()=>[e("div",ko,[F[21]||(F[21]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),e("div",Do,[F[18]||(F[18]=e("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),me(e("textarea",{"onUpdate:modelValue":F[7]||(F[7]=q=>S.value=q),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[we,S.value]])]),e("div",Co,[p(ye,{onClick:F[8]||(F[8]=q=>_.value=!1)},{default:U(()=>F[19]||(F[19]=[W(" Cancel ",-1)])),_:1,__:[19]}),p(de,{onClick:ae,disabled:!S.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:U(()=>F[20]||(F[20]=[W(" Block Task ",-1)])),_:1,__:[20]},8,["disabled"])])])]),_:1},8,["show"])]))}},Eo={class:"p-6"},So={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},jo={class:"block sm:inline"},Mo={class:"mb-4"},$o={class:"mb-6"},Vo={class:"flex justify-end space-x-3"},Ao={__name:"InsertLinkModal",props:{show:{type:Boolean,default:!1}},emits:["close","insert"],setup(s,{emit:t}){const l=t,n=k(""),i=k(""),a=k(""),c=()=>{if(!n.value.trim()){a.value="Link text cannot be empty.";return}let u=i.value.trim();!u.startsWith("http://")&&!u.startsWith("https://")&&(u="http://"+u);try{new URL(u)}catch{a.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const d=`[${n.value.trim()}] {${u}}`;l("insert",d),m()},m=()=>{n.value="",i.value="",a.value="",l("close")};return(u,d)=>(o(),X(Ce,{show:s.show,onClose:m,"max-width":"md"},{default:U(()=>[e("div",Eo,[d[4]||(d[4]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),a.value?(o(),r("div",So,[e("span",jo,y(a.value),1)])):T("",!0),e("div",Mo,[p(Y,{for:"link_text",value:"Link Text"}),p(oe,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=v=>n.value=v),onKeyup:Oe(c,["enter"])},null,8,["modelValue"])]),e("div",$o,[p(Y,{for:"link_url",value:"URL"}),p(oe,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=v=>i.value=v),placeholder:"e.g., https://www.example.com",onKeyup:Oe(c,["enter"])},null,8,["modelValue"])]),e("div",Vo,[p(ye,{onClick:m},{default:U(()=>d[2]||(d[2]=[W("Cancel",-1)])),_:1,__:[2]}),p(de,{onClick:c},{default:U(()=>d[3]||(d[3]=[W("Insert",-1)])),_:1,__:[3]})])])]),_:1},8,["show"]))}},Io={class:"p-6"},Oo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Lo={class:"block sm:inline"},Uo={class:"mb-4"},No={class:"mb-6"},Po={class:"flex justify-end space-x-3"},Ro={__name:"InsertListModal",props:{show:{type:Boolean,default:!1}},emits:["close","insert"],setup(s,{emit:t}){const l=t,n=k(""),i=k("bullet"),a=k(""),c=()=>{const u=n.value.split(`
`).map(g=>g.trim()).filter(g=>g!=="");if(u.length===0){a.value="Please enter at least one list item.";return}const d=i.value==="bullet"?"ul":"ol";let v=`<${d}>`;u.forEach(g=>{v+=`<li>${g}</li>`}),v+=`</${d}>`,l("insert",v),m()},m=()=>{n.value="",i.value="bullet",a.value="",l("close")};return(u,d)=>(o(),X(Ce,{show:s.show,onClose:m,"max-width":"md"},{default:U(()=>[e("div",Io,[d[5]||(d[5]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),a.value?(o(),r("div",Oo,[e("span",Lo,y(a.value),1)])):T("",!0),e("div",Uo,[p(Y,{for:"list_items",value:"List Items (one per line)"}),me(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":d[0]||(d[0]=v=>n.value=v),placeholder:"Enter each list item on a new line"},null,512),[[we,n.value]])]),e("div",No,[p(Y,{for:"list_type",value:"List Type"}),me(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":d[1]||(d[1]=v=>i.value=v)},d[2]||(d[2]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[We,i.value]])]),e("div",Po,[p(ye,{onClick:m},{default:U(()=>d[3]||(d[3]=[W("Cancel",-1)])),_:1,__:[3]}),p(de,{onClick:c},{default:U(()=>d[4]||(d[4]=[W("Insert List",-1)])),_:1,__:[4]})])])]),_:1},8,["show"]))}};function xt(s){const t=i=>{const a=/\[([^\]]+?)\][\s\u00A0]*\{([^}]+?)\}/g;return i.replace(a,(c,m,u)=>{let d=u.trim();return!d.startsWith("http://")&&!d.startsWith("https://")&&(d=`https://${d}`),`<a href="${d}" target="_blank" style="color: #1a73e8; text-decoration: underline;">${m.trim()}</a>`})},l=i=>{const a=/<(ul|ol)>(.*?)<\/(ul|ol)>/gs;return i.replace(a,(c,m,u)=>{const d=m,v=d==="ul"?"list-style-type: disc;":"list-style-type: decimal;",g=/<li>(.*?)<\/li>/gs,_=u.replace(g,(E,S)=>`<li style="margin-bottom: 5px; font-family: 'Inter', sans-serif; font-size: 16px; line-height: 1.6; color: #1a202c;">${S}</li>`);return`<${d} style="margin: 0; padding: 0 0 0 20px; ${v}">${_}</${d}>`})};return{processedHtmlBody:N(()=>{let i=s.value;return i=t(i),i=l(i),i})}}const Fo={key:0},Bo={class:"mb-4"},Ho={class:"mb-6"},Wo={class:"mb-2 flex justify-end space-x-2"},Yo={key:0,class:"min-h-[300px] flex items-center justify-center bg-gray-50 rounded-md"},zo={key:1},qo={key:0,class:"text-red-500 mb-2"},Go={class:"mb-2 flex justify-end space-x-2"},Ko={key:1},Jo={class:"mb-6"},Zo={__name:"EmailActionModal",props:{show:{type:Boolean,default:!1},title:{type:String,required:!0},apiEndpoint:{type:String,required:!0},httpMethod:{type:String,default:"post"},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},emailId:{type:Number,required:!1},projectId:{type:Number,required:!0}},emits:["close","submitted","error","fetchEmails"],setup(s,{emit:t}){const l=s,n=t,i=De({}),a=k(!1),c=k(!1),m=async()=>{if(l.emailId){c.value=!0;try{for(const x in i)delete i[x];if(l.title==="Reject Email"){Object.assign(i,{rejection_reason:""}),c.value=!1;return}const h=(await window.axios.get(`/api/emails/${l.emailId}/edit-content`)).data;h.body_html&&!h.body&&(h.body=h.body_html),Object.assign(i,h),console.log("Fetched email data:",i)}catch(f){console.error("Failed to fetch email data:",f),n("error",f)}finally{c.value=!1}}};re(()=>l.show,f=>{f&&l.emailId&&m()});const u=k(!1),d=k(!1),v=N(()=>(console.log("editorBodyContent computed property called"),console.log("Using localFormData.body:",i.body),i.body||"")),{processedHtmlBody:g}=xt(v),_=f=>{const h={...f};return l.title==="Edit and Approve Email"&&(h.body=g.value),h},E=()=>{console.log("EmailActionModal is closing"),n("close")},S=f=>{n("submitted",f)},$=f=>{n("error",f)},b=()=>{u.value=!0},D=f=>{i.body+=f,u.value=!1},R=()=>{d.value=!0},L=f=>{i.body+=f,d.value=!1},O=k({}),w=k(!1),j=async()=>{w.value=!0;try{console.log("Saving email with ID:",l.emailId),console.log("Email data:",{subject:i.subject,body:i.body}),await window.axios.post(`/api/emails/${l.emailId}/update`,{subject:i.subject,body:i.body}),console.log("Email saved successfully"),alert("Email saved successfully!"),w.value=!1,n("fetchEmails"),E()}catch(f){w.value=!1,console.error("Error saving email:",f);let h="Failed to save email.";f.response&&f.response.data.message&&(h=f.response.data.message),O.value=h,alert(h)}},M=()=>{if(l.emailId){const f=`/emails/${l.emailId}/preview`;window.open(f,"_blank")}else console.warn("Cannot preview email: Email ID not available.")};return(f,h)=>(o(),r(Z,null,[p(Te,{show:s.show,title:s.title,"api-endpoint":s.apiEndpoint,"http-method":s.httpMethod,"form-data":i,"submit-button-text":s.submitButtonText,"success-message":s.successMessage,"format-data-for-api":_,onClose:E,onSubmitted:S,onError:$,"max-width":"3xl"},{default:U(({errors:x})=>[s.title==="Edit and Approve Email"?(o(),r("div",Fo,[e("div",Bo,[p(Y,{for:"edit_subject",value:"Subject"}),p(oe,{id:"edit_subject",type:"text",class:"mt-1 block w-full",modelValue:i.subject,"onUpdate:modelValue":h[0]||(h[0]=V=>i.subject=V),required:""},null,8,["modelValue"]),p(le,{message:x.subject?x.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Ho,[e("div",Wo,[p(ye,{type:"button",onClick:R},{default:U(()=>h[5]||(h[5]=[W(" Insert List ",-1)])),_:1,__:[5]}),p(ye,{type:"button",onClick:b},{default:U(()=>h[6]||(h[6]=[W(" Insert Link ",-1)])),_:1,__:[6]})]),p(Y,{for:"edit_body",value:"Email Body",class:"sr-only"}),a.value?(o(),r("div",Yo,h[7]||(h[7]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"},null,-1)]))):(o(),r("div",zo,[v.value?T("",!0):(o(),r("div",qo,"Warning: Email body content is empty!")),p(bt,{id:"edit_body",modelValue:i.body,"onUpdate:modelValue":h[1]||(h[1]=V=>i.body=V),value:v.value,placeholder:"Edit your email here...",height:"300px"},null,8,["modelValue","value"])])),p(le,{message:x.body?x.body[0]:"",class:"mt-2"},null,8,["message"])]),e("div",Go,[p(de,{type:"button",disabled:w.value,onClick:j},{default:U(()=>[W(y(w.value?"Saving...":"Save"),1)]),_:1},8,["disabled"]),p(ye,{type:"button",onClick:M},{default:U(()=>h[8]||(h[8]=[W(" Preview Email ",-1)])),_:1,__:[8]})])])):s.title==="Reject Email"?(o(),r("div",Ko,[e("div",Jo,[p(Y,{for:"rejection_reason",value:"Rejection Reason"}),me(e("textarea",{id:"rejection_reason",rows:"5",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":h[2]||(h[2]=V=>i.rejection_reason=V),required:"",placeholder:"Please provide a reason for rejecting this email (minimum 10 characters)"},null,512),[[we,i.rejection_reason]]),p(le,{message:x.rejection_reason?x.rejection_reason[0]:"",class:"mt-2"},null,8,["message"])])])):T("",!0)]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]),p(Ao,{show:u.value,onClose:h[3]||(h[3]=x=>u.value=!1),onInsert:D},null,8,["show"]),p(Ro,{show:d.value,onClose:h[4]||(h[4]=x=>d.value=!1),onInsert:L},null,8,["show"])],64))}},Xo=Ee(Zo,[["__scopeId","data-v-e68fe9d9"]]);function Qo(s){const t=Ue();return{userSignature:N(()=>{const n=t.value&&t.value.name?t.value.name:"",i=s.name??"",a="+61 456 639 389",c="ozeeweb.com.au",m="#1a73e8",u="#fbbc05",d="#1a202c",v="#4a5568",g="#e5e7eb",_="#f9fafb",E=`${window.location.origin}/logo.png`,S=`https://img.icons8.com/ios-filled/20/${m.substring(1)}/facebook-new.png`,$=`https://img.icons8.com/ios-filled/20/${m.substring(1)}/twitter.png`,b=`https://img.icons8.com/ios-filled/20/${m.substring(1)}/linkedin.png`,D=`https://img.icons8.com/ios-filled/20/${m.substring(1)}/instagram-new.png`;return`
            <div style="font-family: 'Inter', sans-serif; padding: 20px; border: 1px solid ${g}; margin-top: 30px; background-color: ${_}; border-radius: 8px; overflow: hidden; box-shadow: 0 0 0 3px ${u};">
                <table role="presentation" cellspacing="0" cellpadding="0" width="100%">
                    <tr>
                        <td style="vertical-align: middle;">
                            <p style="margin: 0; font-size: 18px; color: ${d};">Best Regards</p>
                            <p style="margin: 0; font-size: 18px; font-weight: bold; color: ${d};">${n}</p>
                            <p style="margin: 5px 0 5px 0; font-size: 14px; color: ${v};">${i}</p>
                            <p style="margin: 0 0 15px 0; font-size: 12px; color: ${v};">
                                Your website and social media are like your home, first impressions matter!
                            </p>
                            <table role="presentation" cellspacing="0" cellpadding="0">
                                <tr>
                                    <td style="padding-right: 15px;">
                                        <p style="margin: 0; font-size: 13px; color: ${v};">📞 ${a}</p>
                                        <p style="margin: 5px 0 0 0; font-size: 13px; color: ${v};">🌐 <a href="https://${c}" target="_blank" style="color: ${m}; text-decoration: none;">${c}</a></p>
                                    </td>
                                </tr>
                            </table>
                            <div style="margin-top: 15px; text-align: left;">
                                <a href="https://www.facebook.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${m}; text-decoration: none;">
                                    <img src="${S}" alt="Facebook" style="vertical-align: middle;">
                                </a>
                                <a href="https://twitter.com/yourhandle" target="_blank" style="display: inline-block; margin-right: 8px; color: ${m}; text-decoration: none;">
                                    <img src="${$}" alt="Twitter" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.linkedin.com/in/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${m}; text-decoration: none;">
                                    <img src="${b}" alt="LinkedIn" style="vertical-align: middle;">
                                </a>
                                <a href="https://www.instagram.com/yourprofile" target="_blank" style="display: inline-block; margin-right: 8px; color: ${m}; text-decoration: none;">
                                    <img src="${D}" alt="Instagram" style="vertical-align: middle;">
                                </a>
                            </div>
                        </td>
                        <td style="padding-left: 20px; vertical-align: middle; width: 120px; text-align: right;">
                            <img src="${E}" alt="Company Logo" width="100" style="display: block; border-radius: 8px; margin-left: auto;">
                        </td>
                    </tr>
                </table>

                <p style="margin-top: 25px; font-size: 12px; color: ${v}; text-align: center;">
                    Powered by MMS IT & Web Solutions PTY Ltd.
                </p>
                <p style="margin-top: 10px; font-style: italic; color: ${v}; text-align: center; font-size: 13px;">
                    Please consider the environment before printing this email.
                </p>
                <p style="margin-top: 10px; text-align: center; font-size: 13px;">
                    How did I do? <a href="https://www.example.com/review" target="_blank" style="color: ${m}; text-decoration: none; font-weight: bold;">Leave a review!</a>
                </p>
            </div>
        `})}}const er={class:"mb-4"},tr={key:0,class:"text-gray-500 text-sm"},sr={key:1,class:"text-red-500 text-sm"},lr={class:"mb-4"},ar={class:"mb-6"},ir={class:"mb-2 flex justify-end space-x-2"},nr={class:"mb-4"},or={key:0,class:"mt-2"},rr={class:"text-gray-700 text-base mb-2"},dr=["innerHTML"],ur={class:"p-6"},cr={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},mr={class:"block sm:inline"},vr={class:"mb-4"},pr={class:"mb-6"},gr={class:"flex justify-end space-x-3"},hr={class:"p-6"},yr={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},fr={class:"block sm:inline"},br={class:"mb-4"},wr={class:"mb-6"},_r={class:"flex justify-end space-x-3"},xr={__name:"ComponseEmailModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},userProjectRole:{type:Object,required:!0}},emits:["close","submitted","error"],setup(s,{emit:t}){const l=s,n=t,i=De({project_id:l.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),a=k([]),c=k(!0),m=k(""),u=k(!1),d=k(""),v=k(""),g=k(""),_=k(!1),E=k(""),S=k("bullet"),$=k(""),b=k("full_name"),D=k(""),R=k([{value:"full_name",label:"Full Name"},{value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"custom",label:"Custom"}]),{userSignature:L}=Qo(N(()=>l.userProjectRole)),O=N(()=>i.body||""),{processedHtmlBody:w}=xt(O),j=N(()=>{if(i.client_ids&&i.client_ids.length>0){const C=i.client_ids[0],I=a.value.find(z=>z.id===C);if(I){const z=I.name.split(" ").filter(ae=>ae.length>0),ue=z.length>0?z[0]:"",Me=z.length>1?z[z.length-1]:"";switch(b.value){case"full_name":return`Hi ${I.name},`;case"first_name":return`Hi ${ue},`;case"last_name":return`Hi ${Me},`;case"custom":return`Hi ${D.value.trim()||"there"},`;default:return`Hi ${I.name},`}}}return"Hi there,"});re(()=>l.show,C=>{C&&(Object.assign(i,{project_id:l.projectId,client_ids:[],subject:"",body:"",status:"pending_approval"}),b.value="full_name",D.value="",m.value="",A())},{immediate:!0});const M=C=>{const I={...C};return I.client_ids&&Array.isArray(I.client_ids)&&(I.client_ids=I.client_ids.map(z=>({id:z}))),I.body=w.value,I.greeting_name=j.value,I.custom_greeting_name=D.value.trim(),I.first_client_id=i.client_ids&&i.client_ids.length>0?i.client_ids[0]:null,I},f=()=>{n("close")},h=C=>{n("submitted",C)},x=C=>{n("error",C)},V=()=>{d.value="",v.value="",g.value="",u.value=!0},K=()=>{if(!d.value.trim()){g.value="Link text cannot be empty.";return}let C=v.value.trim();!C.startsWith("http://")&&!C.startsWith("https://")&&(C="http://"+C);try{new URL(C)}catch{g.value="Please enter a valid URL (e.g., https://example.com or www.example.com).";return}const I=`[${d.value.trim()}] {${C}}`;i.body+=I,u.value=!1,d.value="",v.value="",g.value=""},ie=()=>{E.value="",S.value="bullet",$.value="",_.value=!0},B=()=>{const C=E.value.split(`
`).map(ue=>ue.trim()).filter(ue=>ue!=="");if(C.length===0){$.value="Please enter at least one list item.";return}const I=S.value==="bullet"?"ul":"ol";let z=`<${I}>`;C.forEach(ue=>{z+=`<li>${ue}</li>`}),z+=`</${I}>`,i.body+=z,_.value=!1,E.value="",$.value=""},A=async()=>{var C,I;c.value=!0,m.value=null;try{const z=await window.axios.get(`/api/projects/${l.projectId}/sections/clients?type=clients`);a.value=z.data}catch(z){console.error("Failed to fetch project clients:",z),m.value=((I=(C=z.response)==null?void 0:C.data)==null?void 0:I.message)||"Failed to load client data."}finally{c.value=!1}};return be(()=>{}),(C,I)=>(o(),r(Z,null,[p(Te,{show:s.show,title:"Compose New Email","api-endpoint":"/api/emails","http-method":"post","form-data":i,"submit-button-text":"Submit for Approval","success-message":"Email submitted for approval successfully!","format-data-for-api":M,onClose:f,onSubmitted:h,onError:x,"max-width":"3xl"},{default:U(({errors:z})=>[e("div",er,[p(Y,{for:"client_ids",value:"To (Clients)"}),c.value?(o(),r("div",tr,"Loading clients...")):m.value?(o(),r("div",sr,y(m.value),1)):(o(),X(Le,{key:2,modelValue:i.client_ids,"onUpdate:modelValue":I[0]||(I[0]=ue=>i.client_ids=ue),options:a.value,placeholder:"Select one or more clients","label-key":"name","value-key":"id"},null,8,["modelValue","options"])),p(le,{message:z.client_ids?z.client_ids[0]:"",class:"mt-2"},null,8,["message"])]),e("div",lr,[p(Y,{for:"subject",value:"Subject"}),p(oe,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:i.subject,"onUpdate:modelValue":I[1]||(I[1]=ue=>i.subject=ue),required:""},null,8,["modelValue"]),p(le,{message:z.subject?z.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",ar,[e("div",ir,[p(ye,{type:"button",onClick:ie},{default:U(()=>I[13]||(I[13]=[W(" Insert List ",-1)])),_:1,__:[13]}),p(ye,{type:"button",onClick:V},{default:U(()=>I[14]||(I[14]=[W(" Insert Link ",-1)])),_:1,__:[14]})]),e("div",nr,[p(Y,{for:"greeting_type",value:"Address Client By"}),p(ge,{id:"greeting_type",modelValue:b.value,"onUpdate:modelValue":I[2]||(I[2]=ue=>b.value=ue),options:R.value,"value-key":"value","label-key":"label",class:"mt-1 block w-full"},null,8,["modelValue","options"]),b.value==="custom"?(o(),r("div",or,[p(Y,{for:"custom_greeting_name",value:"Custom Name"}),p(oe,{id:"custom_greeting_name",type:"text",class:"mt-1 block w-full",modelValue:D.value,"onUpdate:modelValue":I[3]||(I[3]=ue=>D.value=ue),placeholder:"e.g., Azaan"},null,8,["modelValue"])])):T("",!0)]),e("p",rr,y(j.value),1),p(Y,{for:"body",value:"Email Body",class:"sr-only"}),p(bt,{id:"body",modelValue:i.body,"onUpdate:modelValue":I[4]||(I[4]=ue=>i.body=ue),placeholder:"Compose your email here...",height:"300px"},null,8,["modelValue"]),p(le,{message:z.body?z.body[0]:"",class:"mt-2"},null,8,["message"])]),J(L)?(o(),r("div",{key:0,class:"unselectable-signature",innerHTML:J(L)},null,8,dr)):T("",!0)]),_:1},8,["show","form-data"]),p(Ce,{show:u.value,onClose:I[8]||(I[8]=z=>u.value=!1),"max-width":"md"},{default:U(()=>[e("div",ur,[I[17]||(I[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert Link",-1)),g.value?(o(),r("div",cr,[e("span",mr,y(g.value),1)])):T("",!0),e("div",vr,[p(Y,{for:"link_text",value:"Link Text"}),p(oe,{id:"link_text",type:"text",class:"mt-1 block w-full",modelValue:d.value,"onUpdate:modelValue":I[5]||(I[5]=z=>d.value=z),onKeyup:Oe(K,["enter"])},null,8,["modelValue"])]),e("div",pr,[p(Y,{for:"link_url",value:"URL"}),p(oe,{id:"link_url",type:"text",class:"mt-1 block w-full",modelValue:v.value,"onUpdate:modelValue":I[6]||(I[6]=z=>v.value=z),placeholder:"e.g., https://www.example.com",onKeyup:Oe(K,["enter"])},null,8,["modelValue"])]),e("div",gr,[p(ye,{onClick:I[7]||(I[7]=z=>u.value=!1)},{default:U(()=>I[15]||(I[15]=[W("Cancel",-1)])),_:1,__:[15]}),p(de,{onClick:K},{default:U(()=>I[16]||(I[16]=[W("Insert",-1)])),_:1,__:[16]})])])]),_:1},8,["show"]),p(Ce,{show:_.value,onClose:I[12]||(I[12]=z=>_.value=!1),"max-width":"md"},{default:U(()=>[e("div",hr,[I[21]||(I[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Insert List",-1)),$.value?(o(),r("div",yr,[e("span",fr,y($.value),1)])):T("",!0),e("div",br,[p(Y,{for:"list_items",value:"List Items (one per line)"}),me(e("textarea",{id:"list_items",rows:"6",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":I[9]||(I[9]=z=>E.value=z),placeholder:"Enter each list item on a new line"},null,512),[[we,E.value]])]),e("div",wr,[p(Y,{for:"list_type",value:"List Type"}),me(e("select",{id:"list_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":I[10]||(I[10]=z=>S.value=z)},I[18]||(I[18]=[e("option",{value:"bullet"},"Bulleted List",-1),e("option",{value:"numbered"},"Numbered List",-1)]),512),[[We,S.value]])]),e("div",_r,[p(ye,{onClick:I[11]||(I[11]=z=>_.value=!1)},{default:U(()=>I[19]||(I[19]=[W("Cancel",-1)])),_:1,__:[19]}),p(de,{onClick:B},{default:U(()=>I[20]||(I[20]=[W("Insert List",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])],64))}},kt=Ee(xr,[["__scopeId","data-v-70bf1503"]]),kr={class:"mb-4"},Dr={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mt-4"},Cr={key:2},Tr={key:0,class:"text-gray-500 text-sm mt-1"},Er={class:"mt-6"},Sr={class:"flex justify-between items-center mb-3"},jr=["innerHTML"],Mr={__name:"EditTemplateEmailModal",props:{show:Boolean,title:String,apiEndpoint:String,httpMethod:{type:String,default:"post"},submitButtonText:String,successMessage:String,emailId:Number,projectId:Number,clientId:{type:Number,default:null}},emits:["close","submitted","error"],setup(s,{expose:t,emit:l}){const n=s,i=l,a=De({subject:"",template_id:null,template_data:{}}),c=k([]),m=k({}),u=k(!1),d=k(""),v=k(!1),g=N(()=>c.value.find(j=>j.id===a.template_id)),_=N(()=>g.value?g.value.placeholders.filter(j=>j.is_dynamic||j.is_repeatable||j.is_selectable):[]),E=async()=>{try{const j=await window.axios.get("/api/email-templates");c.value=j.data}catch(j){console.error("Failed to fetch email templates:",j)}},S=async j=>{if(!(!j||!j.placeholders)){u.value=!0,m.value={};try{const M=j.placeholders.filter(x=>(x.is_selectable||x.is_repeatable)&&x.source_model);if(M.length===0){u.value=!1;return}const f={};M.forEach(x=>{f[x.source_model]||(f[x.source_model]=[]),f[x.source_model].push(x)});const h=Object.keys(f).map(async x=>{try{const V=await window.axios.get(`/api/source-models/${encodeURIComponent(x)}`);f[x].forEach(K=>{m.value[K.name]=V.data.map(ie=>({id:ie.id,label:ie[K.source_attribute]||ie.name||`ID: ${ie.id}`}))})}catch(V){console.error(`Failed to fetch data for model ${x}:`,V),f[x].forEach(K=>{m.value[K.name]=[]})}});await Promise.all(h)}catch(M){console.error("Error fetching source models data:",M)}finally{u.value=!1}}},$=async j=>{if(Object.assign(a,{subject:"",template_id:null,template_data:{}}),d.value="",m.value={},j.template_id){await E(),a.subject=j.subject,a.template_id=j.template_id,a.template_data=j.template_data||{};const M=c.value.find(f=>f.id===a.template_id);M&&await S(M),D()}else console.error("This modal is only for template-based emails")};t({setData:$});const b=j=>{const M={...j};if(M.composition_type="template",typeof M.template_data=="object"&&M.template_data!==null){const f=c.value.find(h=>h.id===M.template_id);if(f&&f.placeholders){const h={};f.placeholders.forEach(x=>{const V=x.name,K=M.template_data[V];K!=null&&(x.is_repeatable&&Array.isArray(K)||x.is_selectable,h[V]=K)}),M.template_data=h}}else if(typeof M.template_data=="string")try{M.template_data=JSON.parse(M.template_data)}catch(f){console.error("Error parsing template_data:",f),M.template_data={}}else M.template_data={};return M},D=async()=>{v.value=!0;try{const j={},M=c.value.find(x=>x.id===a.template_id);M&&M.placeholders?M.placeholders.forEach(x=>{const V=x.name,K=a.template_data[V];K!=null&&(x.is_repeatable&&Array.isArray(K)||x.is_selectable,j[V]=K)}):Object.assign(j,a.template_data);const f={template_id:a.template_id,template_data:j};n.clientId&&(f.client_id=n.clientId);const h=await window.axios.post(`/api/projects/${n.projectId}/email-preview`,f);d.value=h.data.body_html,a.subject=h.data.subject}catch(j){console.error("Error fetching preview:",j),d.value='<p class="text-red-500 italic">Error loading preview.</p>'}finally{v.value=!1}},R=()=>{i("close")},L=j=>{i("submitted",j)},O=j=>{i("error",j)};re(()=>n.show,j=>{j&&n.emailId&&w()});const w=async()=>{if(n.emailId)try{const M=(await window.axios.get(`/api/emails/${n.emailId}/edit-content`)).data;if(!M.template_id){console.error("This email does not use a template"),i("close");return}await $(M)}catch(j){console.error("Failed to fetch email data:",j),i("error",j)}};return be(()=>{E()}),(j,M)=>(o(),X(Te,{show:s.show,title:s.title,"api-endpoint":s.apiEndpoint,"http-method":s.httpMethod,"form-data":a,"submit-button-text":s.submitButtonText,"success-message":s.successMessage,"format-data-for-api":b,onClose:R,onSubmitted:L,onError:O,"max-width":"4xl"},{default:U(({errors:f})=>[e("div",kr,[p(Y,{for:"edit_subject",value:"Subject"}),p(oe,{id:"edit_subject",type:"text",class:"mt-1 block w-full",modelValue:a.subject,"onUpdate:modelValue":M[0]||(M[0]=h=>a.subject=h),required:""},null,8,["modelValue"]),p(le,{message:f.subject?f.subject[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[M[2]||(M[2]=e("h4",{class:"text-md font-semibold text-gray-800 mb-3 border-b pb-2"},"Editing Template Fields",-1)),e("div",Dr,[(o(!0),r(Z,null,ee(_.value,h=>(o(),r("div",{key:h.id},[p(Y,{for:h.name,value:h.name},null,8,["for","value"]),h.is_dynamic&&!h.is_selectable&&!h.is_repeatable?(o(),X(oe,{key:0,type:"text",class:"mt-1 block w-full",modelValue:a.template_data[h.name],"onUpdate:modelValue":x=>a.template_data[h.name]=x},null,8,["modelValue","onUpdate:modelValue"])):h.is_selectable?(o(),X(ge,{key:1,id:h.name,modelValue:a.template_data[h.name],"onUpdate:modelValue":x=>a.template_data[h.name]=x,options:m.value[h.name]||[],"value-key":"id","label-key":"label",class:"mt-1 block w-full",disabled:u.value},null,8,["id","modelValue","onUpdate:modelValue","options","disabled"])):h.is_repeatable?(o(),r("div",Cr,[u.value?(o(),r("div",Tr,"Loading options...")):(o(),X(Le,{key:1,modelValue:a.template_data[h.name],"onUpdate:modelValue":x=>a.template_data[h.name]=x,options:m.value[h.name]||[],placeholder:`Select ${h.name}`,"label-key":"label","value-key":"id",class:"mt-1"},null,8,["modelValue","onUpdate:modelValue","options","placeholder"]))])):(o(),X(oe,{key:3,type:"text",class:"mt-1 block w-full",modelValue:a.template_data[h.name],"onUpdate:modelValue":x=>a.template_data[h.name]=x},null,8,["modelValue","onUpdate:modelValue"])),p(le,{message:f[`template_data.${h.name}`]?f[`template_data.${h.name}`][0]:"",class:"mt-2"},null,8,["message"])]))),128))]),e("div",Er,[e("div",Sr,[M[1]||(M[1]=e("h4",{class:"text-md font-semibold text-gray-800"},"Email Preview",-1)),p(de,{onClick:D,disabled:v.value},{default:U(()=>[W(y(v.value?"Loading...":"Refresh Preview"),1)]),_:1},8,["disabled"])]),e("div",{class:"bg-gray-100 p-4 rounded-lg shadow-inner min-h-[300px]",innerHTML:d.value},null,8,jr)])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},$r={class:"p-6"},Vr={key:0,class:"space-y-4"},Ar={class:"border-b pb-4"},Ir={class:"text-xl font-medium text-gray-900 mb-2"},Or={class:"grid grid-cols-2 gap-4 text-sm"},Lr={class:"text-gray-600"},Ur={class:"text-gray-900"},Nr={class:"text-gray-600 mt-1"},Pr={class:"text-gray-600"},Rr={class:"text-gray-900"},Fr={class:"prose max-w-none"},Br=["innerHTML"],Hr={key:0,class:"mt-4 p-4 bg-red-50 rounded-md"},Wr={class:"text-red-700"},Yr={key:1,class:"mt-4 text-sm text-gray-600"},zr={key:0},qr={key:2,class:"mt-6 flex justify-end space-x-2"},Gr={__name:"EmailDetailsModal",props:{show:{type:Boolean,required:!0},email:{type:Object,required:!0},canApproveEmails:{type:Boolean,required:!0}},emits:["close","edit","reject"],setup(s,{emit:t}){const l=s,n=t,i=()=>{n("close")},a=()=>{n("edit",l.email)},c=()=>{n("reject",l.email)};return(m,u)=>(o(),X(Ce,{show:s.show,onClose:i},{default:U(()=>{var d;return[e("div",$r,[e("div",{class:"flex justify-between items-center mb-4"},[u[1]||(u[1]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Email Details",-1)),e("button",{onClick:i,class:"text-gray-400 hover:text-gray-500"},u[0]||(u[0]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),s.email?(o(),r("div",Vr,[e("div",Ar,[e("h4",Ir,y(s.email.subject),1),e("div",Or,[e("div",null,[e("p",Lr,[u[2]||(u[2]=W("From: ",-1)),e("span",Ur,y(((d=s.email.sender)==null?void 0:d.name)||"N/A"),1)]),e("p",Nr,[u[3]||(u[3]=W("Status: ",-1)),e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":s.email.status==="sent","bg-yellow-100 text-yellow-800":s.email.status==="pending_approval","bg-red-100 text-red-800":s.email.status==="rejected","bg-gray-100 text-gray-800":s.email.status==="draft"})},y(s.email.status?s.email.status.replace("_"," ").toUpperCase():"N/A"),3)])]),e("div",null,[e("p",Pr,[u[4]||(u[4]=W("Date: ",-1)),e("span",Rr,y(new Date(s.email.created_at).toLocaleString()),1)])])])]),e("div",Fr,[e("div",{innerHTML:s.email.body},null,8,Br)]),s.email.rejection_reason?(o(),r("div",Hr,[u[5]||(u[5]=e("h5",{class:"font-medium text-red-800"},"Rejection Reason:",-1)),e("p",Wr,y(s.email.rejection_reason),1)])):T("",!0),s.email.approver?(o(),r("div",Yr,[e("p",null,"Approved/Rejected by: "+y(s.email.approver.name),1),s.email.sent_at?(o(),r("p",zr,"Sent at: "+y(new Date(s.email.sent_at).toLocaleString()),1)):T("",!0)])):T("",!0),(s.email.status==="pending_approval"||s.email.status==="pending_approval_received")&&s.canApproveEmails?(o(),r("div",qr,[p(de,{onClick:a,class:"bg-blue-600 hover:bg-blue-700"},{default:U(()=>u[6]||(u[6]=[W("Edit & Approve",-1)])),_:1,__:[6]}),p(ye,{onClick:c,class:"text-red-600 hover:text-red-800"},{default:U(()=>u[7]||(u[7]=[W("Reject",-1)])),_:1,__:[7]})])):T("",!0)])):T("",!0)])]}),_:1},8,["show"]))}},Kr={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Jr={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},Zr={key:2,class:"overflow-x-auto"},Xr={class:"min-w-full divide-y divide-gray-200"},Qr={class:"bg-white divide-y divide-gray-200"},ed={class:"px-4 py-3 text-sm text-gray-900"},td={class:"px-4 py-3 text-sm text-gray-700"},sd={class:"px-4 py-3 text-sm text-gray-700"},ld={class:"px-4 py-3 text-sm text-gray-700"},ad={class:"px-4 py-3 text-sm text-gray-700"},id={class:"px-4 py-3 text-right"},nd={key:3,class:"text-gray-400 text-sm"},od={__name:"EmailList",props:{emails:{type:Array,required:!0},loading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["view"],setup(s,{emit:t}){const l=t,n=i=>{l("view",i)};return(i,a)=>(o(),r("div",null,[s.loading?(o(),r("div",Kr," Loading email data... ")):s.error?(o(),r("div",Jr,y(s.error),1)):s.emails.length?(o(),r("div",Zr,[e("table",Xr,[a[1]||(a[1]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Qr,[(o(!0),r(Z,null,ee(s.emails,c=>{var m;return o(),r("tr",{key:c.id,class:"hover:bg-gray-50 transition-colors"},[e("td",ed,y(c.subject),1),e("td",td,y(((m=c.sender)==null?void 0:m.name)||"N/A"),1),e("td",sd,y(new Date(c.created_at).toLocaleDateString()),1),e("td",ld,[e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":c.type==="sent","bg-purple-100 text-purple-800":c.type==="received"})},y(c.type?c.type.toUpperCase():"N/A"),3)]),e("td",ad,[e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":c.status==="sent","bg-yellow-100 text-yellow-800":c.status==="pending_approval","bg-red-100 text-red-800":c.status==="rejected","bg-gray-100 text-gray-800":c.status==="draft","bg-purple-200 text-white-800":c.status==="pending_approval_received","bg-blue-100 text-white-800":c.status==="received"})},y(c.status?c.status.replace("_"," ").toUpperCase():"N/A"),3)]),e("td",id,[p(ye,{class:"text-indigo-600 hover:text-indigo-800",onClick:u=>n(c)},{default:U(()=>a[0]||(a[0]=[W(" View ",-1)])),_:2,__:[0]},1032,["onClick"])])])}),128))])])])):(o(),r("p",nd,"No email communication found."))]))}},rd={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},dd={class:"flex justify-between items-center mb-4"},ud={key:0,class:"flex gap-3"},cd={key:1,class:"mt-2 bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative",role:"alert"},md={class:"block sm:inline"},vd={class:"mb-4 bg-gray-50 p-4 rounded-lg"},pd={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},gd={class:"mt-1 relative rounded-md shadow-sm"},hd={__name:"ProjectEmailsTab",props:{projectId:{type:Number,required:!0},canViewEmails:{type:Boolean,required:!0},canComposeEmails:{type:Boolean,required:!0},canApproveEmails:{type:Boolean,required:!0},userProjectRole:{type:Object,required:!0},openCompose:{type:Boolean,required:!1,default:!1}},emits:["emailsUpdated","resetOpenCompose"],setup(s,{emit:t}){const l=s,n=t,i=k([]),a=k(!0),c=k(""),m=k(null),u=k(!1),d=k(!1),v=k(""),g=k(""),_=k("post"),E=k(""),S=k(""),$=k(!1),b=k(!1),D=k(null),R=k(""),L=k(""),O=k(""),w=k(null);Ue();const j=De({type:"",startDate:"",endDate:"",search:""});let M=null;const f=()=>{V()},h=()=>{j.type="",j.startDate="",j.endDate="",j.search="",V()},x=()=>{clearTimeout(M),M=setTimeout(()=>{f()},500)},V=async()=>{a.value=!0,c.value="";try{const ae=new URLSearchParams;j.type&&ae.append("type",j.type),j.startDate&&ae.append("start_date",j.startDate),j.endDate&&ae.append("end_date",j.endDate),j.search&&ae.append("search",j.search);const P=ae.toString(),F=`/api/projects/${l.projectId}/emails-simplified${P?`?${P}`:""}`,q=await window.axios.get(F);i.value=q.data,n("emailsUpdated",i.value)}catch(ae){c.value="Failed to load email data.",console.error("Error fetching project emails:",ae)}finally{a.value=!1}},K=async ae=>{m.value=null,u.value=!0;try{const P=await window.axios.get(`/api/emails/${ae.id}`);m.value={...ae,subject:P.data.subject,body:P.data.body_html}}catch(P){console.error("Failed to fetch full email details:",P),m.value={subject:"Error",body:"Failed to load email content.",created_at:new Date().toISOString(),status:"error",sender:{name:"System"}}}},ie=async ae=>{try{console.log("Opening email editor for email ID:",ae.id),m.value=ae;const F=(await window.axios.get(`/api/emails/${ae.id}/edit-content`)).data;F.template_id?(console.log("Opening template-based email editor for email ID:",ae.id),D.value=ae.id,R.value=`/api/emails/${ae.id}/edit-and-approve`,L.value="Approve & Send",O.value="Email updated and approved successfully!",w.value=F.client_id,b.value=!0,u.value=!1):(v.value="Edit and Approve Email",g.value=`/api/emails/${ae.id}/edit-and-approve`,_.value="post",E.value="Approve & Send",S.value="Email updated and approved successfully!",d.value=!0,u.value=!1)}catch(P){console.error("Failed to determine email type:",P),c.value="Failed to load email for editing."}},B=ae=>{m.value=ae,v.value="Reject Email",g.value=`/api/emails/${ae.id}/reject`,_.value="post",E.value="Reject Email",S.value="Email rejected successfully!",d.value=!0,u.value=!1},A=async ae=>{console.log("Form submitted successfully:",ae),await V(),d.value=!1},C=()=>{d.value=!1},I=()=>{$.value=!1,n("resetOpenCompose")},z=async ae=>{console.log("Compose email submitted successfully:",ae),await V(),$.value=!1,n("resetOpenCompose")},ue=()=>{b.value=!1},Me=async ae=>{console.log("Template email edited and submitted successfully:",ae),await V(),b.value=!1};return re(()=>l.openCompose,ae=>{console.log("Watcher triggered: openCompose changed to",ae),ae&&(console.log("Opening compose email modal"),$.value=!0)}),be(()=>{l.canViewEmails&&V(),l.openCompose&&($.value=!0)}),(ae,P)=>{var F;return s.canViewEmails?(o(),r("div",rd,[e("div",dd,[P[10]||(P[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Email Communication",-1)),s.canComposeEmails?(o(),r("div",ud,[p(de,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:P[0]||(P[0]=q=>$.value=!0)},{default:U(()=>P[9]||(P[9]=[W(" Compose Email ",-1)])),_:1,__:[9]})])):T("",!0),c.value?(o(),r("div",cd,[e("span",md,y(c.value),1)])):T("",!0)]),e("div",vd,[e("div",pd,[e("div",null,[p(Y,{for:"typeFilter",value:"Type"}),me(e("select",{id:"typeFilter","onUpdate:modelValue":P[1]||(P[1]=q=>j.type=q),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",onChange:f},P[11]||(P[11]=[e("option",{value:""},"All Types",-1),e("option",{value:"sent"},"Sent",-1),e("option",{value:"received"},"Received",-1)]),544),[[We,j.type]])]),e("div",null,[p(Y,{for:"startDate",value:"From Date"}),p(oe,{type:"date",id:"startDate",modelValue:j.startDate,"onUpdate:modelValue":P[2]||(P[2]=q=>j.startDate=q),class:"mt-1 block w-full",onChange:f},null,8,["modelValue"])]),e("div",null,[p(Y,{for:"endDate",value:"To Date"}),p(oe,{type:"date",id:"endDate",modelValue:j.endDate,"onUpdate:modelValue":P[3]||(P[3]=q=>j.endDate=q),class:"mt-1 block w-full",onChange:f},null,8,["modelValue"])]),e("div",null,[p(Y,{for:"searchFilter",value:"Search Content"}),e("div",gd,[p(oe,{type:"text",id:"searchFilter",modelValue:j.search,"onUpdate:modelValue":P[4]||(P[4]=q=>j.search=q),class:"block w-full pr-10",placeholder:"Search in email content...",onInput:x},null,8,["modelValue"]),P[12]||(P[12]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:h}," Reset Filters ")])]),p(od,{emails:i.value,loading:a.value,error:c.value,onView:K},null,8,["emails","loading","error"]),p(Gr,{show:u.value,email:m.value,"can-approve-emails":s.canApproveEmails,onClose:P[5]||(P[5]=q=>u.value=!1),onEdit:ie,onReject:B},null,8,["show","email","can-approve-emails"]),p(kt,{show:$.value,"project-id":s.projectId,"user-project-role":s.userProjectRole,onClose:I,onSubmitted:z,onError:P[6]||(P[6]=q=>console.error("ComposeEmailModal error:",q))},null,8,["show","project-id","user-project-role"]),p(Xo,{show:d.value,title:v.value,"api-endpoint":g.value,"http-method":_.value,"submit-button-text":E.value,"success-message":S.value,"email-id":(F=m.value)==null?void 0:F.id,"project-id":s.projectId,onClose:C,onSubmitted:A,onError:P[7]||(P[7]=q=>console.error("EmailActionModal error:",q)),onFetchEmails:V},null,8,["show","title","api-endpoint","http-method","submit-button-text","success-message","email-id","project-id"]),p(Mr,{show:b.value,title:"Edit Template Email","api-endpoint":R.value,"http-method":"post","submit-button-text":L.value,"success-message":O.value,"email-id":D.value,"project-id":s.projectId,"client-id":w.value,onClose:ue,onSubmitted:Me,onError:P[8]||(P[8]=q=>console.error("EditTemplateEmailModal error:",q))},null,8,["show","api-endpoint","submit-button-text","success-message","email-id","project-id","client-id"])])):T("",!0)}}},yd={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},fd={class:"flex justify-between items-center mb-4"},bd={class:"flex gap-3"},wd={class:"mb-4 bg-gray-50 p-4 rounded-lg"},_d={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},xd={class:"mt-1 relative rounded-md shadow-sm"},kd={class:"mb-8 p-4 bg-blue-50 rounded-md"},Dd={class:"flex items-center"},Cd={class:"text-sm text-blue-800"},Td={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Ed={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},Sd={key:2,class:"space-y-4"},jd={class:"flex justify-between"},Md={class:"flex-grow"},$d={key:0,class:"text-xs text-red-400 block mt-1"},Vd={class:"flex items-center mt-1"},Ad={class:"text-xs text-gray-500"},Id={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},Od={key:0},Ld={key:3,class:"text-gray-400 text-sm"},Ud={class:"p-6"},Nd={class:"flex justify-between items-center mb-4"},Pd={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},Rd={class:"text-sm text-gray-700"},Fd={class:"text-xs text-gray-500 mt-1"},Bd={key:1,class:"mb-4"},Hd={key:0,class:"text-center py-4"},Wd={key:1,class:"space-y-3 max-h-60 overflow-y-auto"},Yd={class:"text-sm text-gray-700"},zd={class:"text-xs text-gray-500 mt-1"},qd={key:2,class:"text-center py-3"},Gd={key:2,class:"mb-4"},Kd={key:0,class:"mt-2 text-sm text-red-600"},Jd={key:3,class:"mt-6 flex justify-end"},Zd={__name:"ProjectNotesTab",props:{projectId:{type:Number,required:!0},googleChatId:{type:String,default:null},canViewNotes:{type:Boolean,required:!0},canAddNotes:{type:Boolean,required:!0}},emits:["notesUpdated"],setup(s,{emit:t}){const l=s,n=t,i=k([]),a=k(!0),c=k(""),m=k(!1),u=k(!1),d=k(null),v=k(""),g=k(""),_=k([]),E=k(!1),S=De({startDate:"",endDate:"",search:""});let $=null;const b=async()=>{a.value=!0,c.value="";try{const M=new URLSearchParams;S.startDate&&M.append("start_date",S.startDate),S.endDate&&M.append("end_date",S.endDate),S.search&&M.append("search",S.search);const f=M.toString(),h=`/api/projects/${l.projectId}/notes${f?`?${f}`:""}`,x=await window.axios.get(h);i.value=x.data,n("notesUpdated",i.value)}catch(M){c.value="Failed to load notes data.",console.error("Error fetching project notes:",M)}finally{a.value=!1}},D=()=>{m.value=!0},R=async M=>{d.value=M,v.value="",g.value="",_.value=[],E.value=!0,u.value=!0;try{const f=await window.axios.get(`/api/projects/${l.projectId}/notes/${M.id}/replies`);f.data.success?_.value=f.data.replies:console.error("Failed to fetch replies:",f.data.message)}catch(f){console.error("Error fetching replies:",f)}finally{E.value=!1}},L=async()=>{var M,f;if(!d.value||!v.value.trim()){g.value="Reply content is required";return}g.value="";try{const h=await window.axios.post(`/api/projects/${l.projectId}/notes/${d.value.id}/reply`,{content:v.value});if(h.data.success){v.value="",E.value=!0;const x=await window.axios.get(`/api/projects/${l.projectId}/notes/${d.value.id}/replies`);x.data.success&&(_.value=x.data.replies),E.value=!1,await b()}else g.value=h.data.message||"Failed to send reply"}catch(h){console.error("Error sending reply:",h),g.value=((f=(M=h.response)==null?void 0:M.data)==null?void 0:f.message)||"An error occurred while sending the reply"}},O=()=>{b()},w=()=>{S.startDate="",S.endDate="",S.search="",b()},j=()=>{clearTimeout($),$=setTimeout(()=>{O()},500)};return be(()=>{l.canViewNotes&&b()}),(M,f)=>s.canViewNotes?(o(),r("div",yd,[e("div",fd,[f[10]||(f[10]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Notes",-1)),e("div",bd,[s.canAddNotes?(o(),X(de,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:D},{default:U(()=>f[9]||(f[9]=[W(" Add Note ",-1)])),_:1,__:[9]})):T("",!0)])]),e("div",wd,[e("div",_d,[e("div",null,[p(Y,{for:"noteStartDate",value:"From Date"}),p(oe,{type:"date",id:"noteStartDate",modelValue:S.startDate,"onUpdate:modelValue":f[0]||(f[0]=h=>S.startDate=h),class:"mt-1 block w-full",onChange:O},null,8,["modelValue"])]),e("div",null,[p(Y,{for:"noteEndDate",value:"To Date"}),p(oe,{type:"date",id:"noteEndDate",modelValue:S.endDate,"onUpdate:modelValue":f[1]||(f[1]=h=>S.endDate=h),class:"mt-1 block w-full",onChange:O},null,8,["modelValue"])]),e("div",null,[p(Y,{for:"noteSearchFilter",value:"Search Content"}),e("div",xd,[p(oe,{type:"text",id:"noteSearchFilter",modelValue:S.search,"onUpdate:modelValue":f[2]||(f[2]=h=>S.search=h),class:"block w-full pr-10",placeholder:"Search in note content...",onInput:j},null,8,["modelValue"]),f[11]||(f[11]=e("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1))])])]),e("div",{class:"mt-3 flex justify-end"},[e("button",{type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:w}," Reset Filters ")])]),e("div",kd,[e("div",Dd,[f[13]||(f[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",Cd,[f[12]||(f[12]=W(" Daily Standups are now available in their own dedicated tab. ",-1)),e("button",{onClick:f[3]||(f[3]=h=>M.$emit("changeTab","standups")),class:"text-blue-600 hover:text-blue-800 font-medium underline"}," Click here to view Daily Standups ")])])]),e("div",null,[f[15]||(f[15]=e("h5",{class:"text-md font-semibold text-gray-900 mb-4 border-b pb-2"},"Notes",-1)),a.value?(o(),r("div",Td," Loading notes... ")):c.value?(o(),r("div",Ed,y(c.value),1)):i.value.length?(o(),r("div",Sd,[(o(!0),r(Z,null,ee(i.value,h=>{var x;return o(),r("div",{key:h.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",jd,[e("div",Md,[e("p",{class:te(["text-sm",{"text-gray-700":h.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":h.content==="[Encrypted content could not be decrypted]"}])},[W(y(h.content)+" ",1),h.content==="[Encrypted content could not be decrypted]"?(o(),r("span",$d," (There was an issue decrypting this note. Please contact an administrator.) ")):T("",!0)],2),e("div",Vd,[e("p",Ad,"Added by "+y(((x=h.user)==null?void 0:x.name)||"Unknown")+" on "+y(new Date(h.created_at).toLocaleDateString()),1),h.reply_count>0?(o(),r("span",Id,y(h.reply_count)+" "+y(h.reply_count===1?"reply":"replies"),1)):T("",!0)])]),s.googleChatId&&h.chat_message_id?(o(),r("div",Od,[p(ye,{class:"text-sm text-indigo-600 hover:text-indigo-800",onClick:V=>R(h)},{default:U(()=>f[14]||(f[14]=[W(" View ",-1)])),_:2,__:[14]},1032,["onClick"])])):T("",!0)])])}),128))])):(o(),r("p",Ld,"No notes available."))]),p(ft,{show:m.value,"project-id":s.projectId,onClose:f[4]||(f[4]=h=>m.value=!1),onNoteAdded:b},null,8,["show","project-id"]),p(Ce,{show:u.value,onClose:f[8]||(f[8]=h=>u.value=!1)},{default:U(()=>{var h;return[e("div",Ud,[e("div",Nd,[f[17]||(f[17]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Reply to Note",-1)),e("button",{onClick:f[5]||(f[5]=x=>u.value=!1),class:"text-gray-400 hover:text-gray-500"},f[16]||(f[16]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),d.value?(o(),r("div",Pd,[e("p",Rd,y(d.value.content),1),e("p",Fd,"Added by "+y(((h=d.value.user)==null?void 0:h.name)||"Unknown")+" on "+y(new Date(d.value.created_at).toLocaleDateString()),1)])):T("",!0),d.value?(o(),r("div",Bd,[f[20]||(f[20]=e("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Replies",-1)),E.value?(o(),r("div",Hd,f[18]||(f[18]=[e("p",{class:"text-gray-500 text-sm"},"Loading replies...",-1)]))):_.value.length?(o(),r("div",Wd,[(o(!0),r(Z,null,ee(_.value,x=>{var V;return o(),r("div",{key:x.id,class:"p-2 bg-gray-50 rounded border-l-2 border-indigo-300"},[e("p",Yd,y(x.content),1),e("p",zd,"Replied by "+y(((V=x.user)==null?void 0:V.name)||"Unknown")+" on "+y(new Date(x.created_at).toLocaleDateString()),1)])}),128))])):(o(),r("div",qd,f[19]||(f[19]=[e("p",{class:"text-gray-500 text-sm"},"No replies yet. Be the first to reply!",-1)])))])):T("",!0),s.canAddNotes?(o(),r("div",Gd,[p(Y,{for:"reply-content",value:"Your Reply"}),me(e("textarea",{id:"reply-content","onUpdate:modelValue":f[6]||(f[6]=x=>v.value=x),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your reply..."},null,512),[[we,v.value]]),g.value?(o(),r("p",Kd,y(g.value),1)):T("",!0)])):T("",!0),s.canAddNotes?(o(),r("div",Jd,[p(ye,{onClick:f[7]||(f[7]=x=>u.value=!1),class:"mr-2"},{default:U(()=>f[21]||(f[21]=[W("Cancel",-1)])),_:1,__:[21]}),p(de,{onClick:L},{default:U(()=>f[22]||(f[22]=[W("Send Reply",-1)])),_:1,__:[22]})])):T("",!0)])]}),_:1},8,["show"])])):T("",!0)}},Xd={class:"w-full"},Qd={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},eu={key:1,class:"text-red-600 text-sm py-2 text-center"},tu={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},su={class:"p-4 bg-blue-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},lu={class:"text-2xl font-bold text-blue-900 mt-1"},au={class:"p-4 bg-green-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},iu={class:"text-2xl font-bold text-green-900 mt-1"},nu={class:"p-4 bg-red-100 rounded-lg shadow-sm transition-shadow hover:shadow-lg"},ou={class:"text-2xl font-bold mt-1"},ru={key:3,class:"space-y-2 text-sm text-gray-700 mt-6 pt-4 border-t border-gray-200"},du={key:0},uu={class:"text-gray-900 whitespace-pre-wrap"},cu={key:4,class:"text-gray-400 text-sm mt-4 text-center"},mu={__name:"ProjectFinancialsCard",props:{projectId:{type:Number,required:!0},canViewProjectServicesAndPayments:{type:Boolean,default:!1},canViewProjectTransactions:{type:Boolean,default:!1}},setup(s){const t=s,l=k(null),n=k([]),i=k(!0),a=k(null),c=He,m=N(()=>{var E;if(!he.value||Object.keys(he.value).length===0)return 0;const _=parseFloat(((E=l.value)==null?void 0:E.total_amount)||0);return Ie(_,"USD",c.value)}),u=N(()=>!n.value.length||!he.value||Object.keys(he.value).length===0?0:n.value.filter(_=>_.type==="expense").reduce((_,E)=>_+Ie(parseFloat(E.amount||0),E.currency,c.value),0)),d=N(()=>!n.value.length||!he.value||Object.keys(he.value).length===0?0:n.value.filter(_=>_.type==="income").reduce((_,E)=>_+Ie(parseFloat(E.amount||0),E.currency,c.value),0)),v=N(()=>d.value-u.value),g=async()=>{var _,E;if(i.value=!0,a.value=null,n.value=[],!he.value||Object.keys(he.value).length===0){a.value="Currency rates not loaded. Please try again.",i.value=!1;return}if(!t.canViewProjectServicesAndPayments&&!t.canViewProjectTransactions){a.value="You don't have permission to view project financials.",i.value=!1;return}try{if(t.canViewProjectServicesAndPayments){const S=await window.axios.get(`/api/projects/${t.projectId}/sections/services-payment`);l.value=S.data}else l.value=null;if(t.canViewProjectTransactions){const S=await window.axios.get(`/api/projects/${t.projectId}/sections/transactions`);n.value=S.data}else n.value=[]}catch(S){console.error("Failed to fetch project financials:",S),a.value=((E=(_=S.response)==null?void 0:_.data)==null?void 0:E.message)||"Failed to load financial data."}finally{i.value=!1}};return re([()=>t.canViewProjectServicesAndPayments,()=>t.canViewProjectTransactions,c,he],(_,E)=>{t.projectId&&he.value&&Object.keys(he.value).length>0?g():t.projectId||(i.value=!0,a.value=null)},{immediate:!0,deep:!0}),(_,E)=>{var S,$;return o(),r("div",Xd,[i.value?(o(),r("div",Qd,[(o(),r(Z,null,ee(4,b=>e("div",{key:b,class:"p-4 bg-gray-100 rounded-lg animate-pulse h-24"},E[0]||(E[0]=[e("div",{class:"h-4 bg-gray-200 rounded w-1/2 mb-3"},null,-1),e("div",{class:"h-6 bg-gray-200 rounded w-3/4"},null,-1)]))),64))])):a.value?(o(),r("div",eu,[e("p",null,y(a.value),1)])):(o(),r("div",tu,[e("div",su,[E[1]||(E[1]=e("p",{class:"text-sm font-medium text-blue-800"},"Contract Value",-1)),e("p",lu,y(J(Ve)(m.value,J(c).value)),1)]),e("div",au,[E[2]||(E[2]=e("p",{class:"text-sm font-medium text-green-800"},"Total Income",-1)),e("p",iu,y(J(Ve)(d.value,J(c))),1)]),e("div",nu,[E[3]||(E[3]=e("p",{class:"text-sm font-medium text-red-800"},"Total Expenses",-1)),e("p",ou,y(J(Ve)(u.value,J(c))),1)]),e("div",{class:te(["p-4 rounded-lg shadow-sm transition-shadow hover:shadow-lg",{"bg-green-100":v.value>=0,"bg-red-100":v.value<0}])},[e("p",{class:te(["text-sm font-medium",{"text-green-800":v.value>=0,"text-red-800":v.value<0}])},"Profit/Loss",2),e("p",{class:te(["text-2xl font-bold mt-1",{"text-green-900":v.value>=0,"text-red-900":v.value<0}])},y(J(Ve)(v.value,J(c))),3)],2)])),!i.value&&!a.value&&((S=l.value)!=null&&S.contract_details)?(o(),r("dl",ru,[($=l.value)!=null&&$.contract_details?(o(),r("div",du,[E[4]||(E[4]=e("dt",{class:"font-medium w-full block mt-2"},"Contract Details:",-1)),e("dd",uu,y(l.value.contract_details),1)])):T("",!0)])):T("",!0),!i.value&&!a.value&&!l.value&&!n.value.length?(o(),r("p",cu," No financial information available. ")):T("",!0)])}}},vu={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},pu={key:0},gu={key:1,class:"text-red-600 text-sm py-2"},hu={key:2,class:"space-y-1 text-sm text-gray-700"},yu={key:0},fu={key:3,class:"text-gray-400 text-sm"},bu={__name:"ProjectClientsCard",props:{projectId:{type:Number,required:!0},canViewClientContacts:{type:Boolean,default:!1}},setup(s){const t=s,l=k([]),n=k(!0),i=k(null),a=async()=>{var c,m;if(n.value=!0,i.value=null,!t.canViewClientContacts){i.value="You don't have permission to view project clients.",n.value=!1;return}try{const u=await window.axios.get(`/api/projects/${t.projectId}/sections/clients?type=clients`);l.value=u.data}catch(u){console.error("Failed to fetch project clients:",u),i.value=((m=(c=u.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load client data."}finally{n.value=!1}};return be(()=>{a()}),re(()=>t.canViewClientContacts,()=>{a()}),(c,m)=>(o(),r("div",vu,[m[1]||(m[1]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Clients",-1)),n.value?(o(),r("div",pu,m[0]||(m[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):i.value?(o(),r("div",gu,[e("p",null,y(i.value),1)])):l.value.length?(o(),r("ul",hu,[(o(!0),r(Z,null,ee(l.value,u=>(o(),r("li",{key:u.id},[W(y(u.name)+" ",1),u.email?(o(),r("span",yu,"("+y(u.email)+")",1)):T("",!0)]))),128))])):(o(),r("p",fu,"No clients assigned."))]))}},wu={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},_u={key:0},xu={key:1,class:"text-red-600 text-sm py-2"},ku={key:2},Du={key:0,class:"space-y-2 text-sm text-gray-700 mb-4"},Cu={class:"font-medium"},Tu={class:"text-xs text-gray-500 mt-1"},Eu={key:1,class:"text-gray-400 text-sm mb-4"},Su={__name:"ProjectTeamCard",props:{projectId:{type:Number,required:!0},canViewUsers:{type:Boolean,default:!1}},setup(s){const t=s,l=Ue(),n=k([]),i=k(!0),a=k(null),c=async()=>{var u,d;if(i.value=!0,a.value=null,!t.canViewUsers){a.value="You don't have permission to view project team members.",i.value=!1,n.value=[];return}try{const v=await window.axios.get(`/api/projects/${t.projectId}/sections/users`);n.value=v.data.users||[],console.log("Fetched team users:",n.value)}catch(v){console.error("Failed to fetch project users:",v),a.value=((d=(u=v.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load team data."}finally{i.value=!1}},m=u=>{if(!u.availabilities||u.availabilities.length===0)return"No availability submitted for today.";const d=u.availabilities[0];return d.is_available?d.time_slots&&d.time_slots.length>0?`${d.time_slots.map(g=>`${g.start_time}-${g.end_time}`).join(", ")}`:"No specific slots provided.":`Not available today: ${d.reason||"No reason provided"}`};return be(()=>{c()}),re([()=>t.canViewUsers,()=>l.value,()=>t.projectId],()=>{c()},{deep:!0}),(u,d)=>(o(),r("div",wu,[d[3]||(d[3]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Project Team",-1)),i.value?(o(),r("div",_u,d[0]||(d[0]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-1/2"})],-1)]))):a.value?(o(),r("div",xu,[e("p",null,y(a.value),1)])):(o(),r("div",ku,[n.value.length?(o(),r("ul",Du,[(o(!0),r(Z,null,ee(n.value,v=>{var g;return o(),r("li",{key:v.id,class:"border-b pb-2 last:border-b-0"},[e("div",null,[e("strong",null,y(v.name),1),d[1]||(d[1]=W(" (Role: ",-1)),e("span",Cu,y(((g=v.pivot)==null?void 0:g.role)||"N/A"),1),d[2]||(d[2]=W(") ",-1))]),e("div",Tu," Today's Availability: "+y(m(v)),1)])}),128))])):(o(),r("p",Eu,"No team members assigned."))]))]))}},ju={class:"bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-lg"},Mu={key:0,class:"space-y-3"},$u={key:1,class:"text-red-600 text-sm py-2 text-center"},Vu={key:2},Au={class:"space-y-1 text-sm text-gray-700"},Iu={key:0},Ou={class:"inline-block text-gray-900"},Lu={class:"inline-block text-gray-900"},Uu={class:"inline-block text-gray-900"},Nu={key:1},Pu={key:0,class:"text-gray-400 text-sm"},Ru={key:1,class:"text-gray-400 text-sm"},Fu={key:0,class:"mt-4 text-right"},Bu={__name:"UserFinancialCard",props:{projectId:{type:Number,required:!0}},emits:["viewUserTransactions"],setup(s,{emit:t}){const l=s,n=t,i=Ue(),a=k(!0),c=k(null),m=k([]),u=He,d=async()=>{var $,b;if(a.value=!0,c.value=null,!i.value||!i.value.id||!l.projectId){m.value=[],a.value=!1;return}if(!he.value||Object.keys(he.value).length===0){c.value="Currency rates not loaded. Please try again.",a.value=!1;return}try{const D=await window.axios.get(`/api/projects/${l.projectId}/sections/transactions?user_id=${i.value.id}`);m.value=D.data,console.log("User-specific transactions:",m.value)}catch(D){console.error("Failed to fetch user transactions for UserFinancialsCard:",D),c.value=((b=($=D.response)==null?void 0:$.data)==null?void 0:b.message)||"Failed to load your financial data.",m.value=[]}finally{a.value=!1}},v=N(()=>!i.value||!i.value.id||!m.value.length||!he.value||Object.keys(he.value).length===0?0:m.value.filter(b=>b.type==="expense").reduce((b,D)=>b+Ie(parseFloat(D.amount||0),D.currency,u.value),0)),g=N(()=>!i.value||!i.value.id||!m.value.length||!he.value||Object.keys(he.value).length===0?0:m.value.filter(b=>b.type==="bonus").reduce((b,D)=>b+Ie(parseFloat(D.amount||0),D.currency,u.value),0)),_=N(()=>!i.value||!i.value.id||!m.value.length||!he.value||Object.keys(he.value).length===0?0:m.value.filter(b=>(b.type==="expense"||b.type==="bonus")&&b.is_paid===1).reduce((b,D)=>b+Ie(parseFloat(D.amount||0),D.currency,u.value),0)),E=N(()=>i.value&&(v.value>0||g.value>0||_.value>0));be(()=>{d()}),re([()=>i.value,()=>l.projectId,u,he],()=>{d()},{deep:!0});const S=()=>{n("viewUserTransactions")};return($,b)=>(o(),r("div",ju,[b[5]||(b[5]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Your Financials",-1)),a.value?(o(),r("div",Mu,b[0]||(b[0]=[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"},null,-1),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"},null,-1)]))):c.value?(o(),r("div",$u,[e("p",null,y(c.value),1)])):(o(),r("div",Vu,[e("dl",Au,[E.value?(o(),r("div",Iu,[e("div",null,[b[1]||(b[1]=e("dt",{class:"font-medium inline-block w-32"},"Agreed Amount:",-1)),e("dd",Ou,y(J(Ve)(v.value,J(u))),1)]),e("div",null,[b[2]||(b[2]=e("dt",{class:"font-medium inline-block w-32"},"Bonus Amount:",-1)),e("dd",Lu,y(J(Ve)(g.value,J(u))),1)]),e("div",null,[b[3]||(b[3]=e("dt",{class:"font-medium inline-block w-32"},"Received Amount:",-1)),e("dd",Uu,y(J(Ve)(_.value,J(u))),1)])])):(o(),r("div",Nu,[J(i)?(o(),r("p",Ru," Your financials for this project are not available or you're not assigned. ")):(o(),r("p",Pu," Sign in to view your specific financials. "))]))]),J(i)?(o(),r("div",Fu,[p(de,{onClick:S},{default:U(()=>b[4]||(b[4]=[W(" View Transactions ",-1)])),_:1,__:[4]})])):T("",!0)]))]))}},Hu=Ee(Bu,[["__scopeId","data-v-34bab241"]]),Wu={class:"p-4"},Yu={key:0,class:"text-center text-gray-600"},zu={key:1,class:"text-red-600 text-sm py-2"},qu={key:2,class:"text-gray-500 text-center py-4"},Gu={key:3,class:"overflow-x-auto"},Ku={class:"min-w-full divide-y divide-gray-200"},Ju={class:"bg-white divide-y divide-gray-200"},Zu={class:"px-4 py-3 text-sm text-gray-900"},Xu={class:"px-4 py-3 text-sm text-gray-700"},Qu={class:"px-4 py-3 text-sm text-right text-gray-900"},ec={class:"px-4 py-3 text-sm"},tc={class:"px-4 py-3 text-sm text-gray-700"},sc={__name:"UserTransactionsModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectName:{type:String,required:!1}},emits:["close"],setup(s,{emit:t}){const l=s,n=Ue(),i=k(!0),a=k(null),c=k([]);k("PKR");const m=(d,v="USD")=>isNaN(d)||d==null?"0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:v,minimumFractionDigits:2,maximumFractionDigits:2}).format(d),u=async()=>{var d,v;if(i.value=!0,a.value=null,c.value=[],!n.value||!n.value.id||!l.projectId){a.value="User not authenticated or project ID missing.",i.value=!1;return}try{const g=await window.axios.get(`/api/projects/${l.projectId}/sections/transactions?user_id=${n.value.id}`);c.value=g.data}catch(g){console.error("Failed to fetch user-specific transactions for modal:",g),a.value=((v=(d=g.response)==null?void 0:d.data)==null?void 0:v.message)||"Failed to load transactions."}finally{i.value=!1}};return re(()=>l.show,d=>{d&&u()},{immediate:!1}),re([()=>{var d;return(d=n.value)==null?void 0:d.id},()=>l.projectId],(d,v)=>{l.show&&u()},{deep:!0}),N(()=>`Your Transactions for Project ${l.projectId}`),(d,v)=>(o(),X(Te,{show:s.show,title:"Transactions for: "+s.projectName,"show-footer":!1,onClose:v[0]||(v[0]=g=>d.$emit("close")),"hide-submit-button":!0,"hide-cancel-button":!0,"api-endpoint":null,"form-data":"{}"},{default:U(({errors:g})=>[e("div",Wu,[i.value?(o(),r("div",Yu,v[1]||(v[1]=[e("div",{class:"space-y-3"},[e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"}),e("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-2/3"})],-1)]))):a.value?(o(),r("div",zu,[e("p",null,y(a.value),1)])):c.value.length===0?(o(),r("div",qu," No transactions found for you on this project. ")):(o(),r("div",Gu,[e("table",Ku,[v[2]||(v[2]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date")])],-1)),e("tbody",Ju,[(o(!0),r(Z,null,ee(c.value,_=>(o(),r("tr",{key:_.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Zu,y(_.description),1),e("td",Xu,y(_.type),1),e("td",Qu,y(m(_.amount,_.currency)),1),e("td",ec,[e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":_.is_paid===1,"bg-yellow-100 text-yellow-800":_.is_paid===0})},y(_.is_paid===1?"Paid":"Unpaid"),3)]),e("td",tc,y(new Date(_.created_at).toLocaleDateString()),1)]))),128))])])]))])]),_:1},8,["show","title"]))}},lc={class:"space-y-4"},ac={key:0},ic=["disabled"],nc={key:0,class:"mt-4"},oc=["src"],rc={class:"flex items-center"},dc="Create New Deliverable",uc="post",cc="Create Deliverable",mc="Deliverable created successfully!",Dt={__name:"CreateDeliverableModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0}},emits:["close","saved"],setup(s,{emit:t}){const l=s,n=t,i=De({title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),a=[{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],c=[{value:"pending_review",label:"Pending Review (Requires Client Approval)"},{value:"for_information",label:"For Information Only (No Approval Needed)"}],m=[{value:null,label:"Select Type (if providing URL)"},{value:"google_doc",label:"Google Document (Doc, Sheet, Slide)"},{value:"pdf",label:"PDF Document"},{value:"image",label:"Image (JPG, PNG, GIF)"},{value:"video",label:"Video (YouTube, Vimeo, etc.)"},{value:"other",label:"Other Web Link"}],u=k(null),d=k(null);re(()=>l.show,b=>{b&&(Object.assign(i,{title:"",description:"",type:"blog_post",content_url:"",content_url_type:null,attachment_file:null,is_visible_to_client:!0,initial_status:"pending_review"}),d.value=null,u.value&&(u.value.value=""))});const v=b=>{const D=b.target.files[0];if(D)if(i.attachment_file=D,i.content_url="",i.content_url_type=null,D.type.startsWith("image/")){const R=new FileReader;R.onload=L=>{d.value=L.target.result},R.readAsDataURL(D)}else d.value=null;else i.attachment_file=null,d.value=null},g=()=>{i.content_url?(i.attachment_file=null,d.value=null,u.value&&(u.value.value="")):i.content_url_type=null},_=b=>{const D=new FormData;return D.append("title",b.title),D.append("description",b.description||""),D.append("type",b.type),D.append("is_visible_to_client",b.is_visible_to_client?1:0),D.append("initial_status",b.initial_status),b.attachment_file?D.append("attachment_file",b.attachment_file):b.content_url&&(D.append("content_url",b.content_url),D.append("content_url_type",b.content_url_type||"")),D},E=N(()=>`/api/projects/${l.projectId}/deliverables`),S=b=>{n("saved",b),n("close")},$=()=>{n("close")};return(b,D)=>(o(),X(Te,{show:s.show,title:dc,"api-endpoint":E.value,"http-method":uc,"form-data":i,"submit-button-text":cc,"success-message":mc,"format-data-for-api":_,onClose:$,onSubmitted:S},{default:U(({errors:R})=>[e("div",lc,[e("div",null,[p(Y,{for:"title",value:"Title"}),p(oe,{id:"title",modelValue:i.title,"onUpdate:modelValue":D[0]||(D[0]=L=>i.title=L),type:"text",class:"mt-1 block w-full",required:"",autofocus:""},null,8,["modelValue"]),p(le,{message:R.title?R.title[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"description",value:"Description"}),me(e("textarea",{id:"description","onUpdate:modelValue":D[1]||(D[1]=L=>i.description=L),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter deliverable description"},null,512),[[we,i.description]]),p(le,{message:R.description?R.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"type",value:"Deliverable Type"}),p(ge,{id:"type",modelValue:i.type,"onUpdate:modelValue":D[2]||(D[2]=L=>i.type=L),options:a,"value-key":"value","label-key":"label",placeholder:"Select a type",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(le,{message:R.type?R.type[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"initial_status",value:"Initial Status"}),p(ge,{id:"initial_status",modelValue:i.initial_status,"onUpdate:modelValue":D[3]||(D[3]=L=>i.initial_status=L),options:c,"value-key":"value","label-key":"label",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(le,{message:R.initial_status?R.initial_status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[p(Y,{for:"content_url",value:"Content URL (for Google Docs, external links)"}),p(oe,{id:"content_url",modelValue:i.content_url,"onUpdate:modelValue":D[4]||(D[4]=L=>i.content_url=L),type:"url",class:"mt-1 block w-full",disabled:!!i.attachment_file,onInput:g,placeholder:"e.g., https://docs.google.com/document/d/..."},null,8,["modelValue","disabled"]),D[7]||(D[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Leave empty if uploading a file below.",-1)),p(le,{message:R.content_url?R.content_url[0]:"",class:"mt-2"},null,8,["message"])]),i.content_url&&!i.attachment_file?(o(),r("div",ac,[p(Y,{for:"content_url_type",value:"Type of Content URL"}),p(ge,{id:"content_url_type",modelValue:i.content_url_type,"onUpdate:modelValue":D[5]||(D[5]=L=>i.content_url_type=L),options:m,"value-key":"value","label-key":"label",placeholder:"Select the type of content this URL links to",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),p(le,{message:R.content_url_type?R.content_url_type[0]:"",class:"mt-2"},null,8,["message"])])):T("",!0),e("div",null,[p(Y,{for:"attachment_file",value:"Upload File (PDF, Image)"}),e("input",{id:"attachment_file",ref_key:"fileInput",ref:u,type:"file",onChange:v,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",disabled:!!i.content_url,accept:"application/pdf,image/*"},null,40,ic),D[9]||(D[9]=e("p",{class:"text-xs text-gray-500 mt-1"},"Max 10MB. Leave empty if providing a URL above.",-1)),p(le,{message:R.attachment_file?R.attachment_file[0]:"",class:"mt-2"},null,8,["message"]),d.value?(o(),r("div",nc,[D[8]||(D[8]=e("p",{class:"text-sm font-medium text-gray-700 mb-2"},"Image Preview:",-1)),e("img",{src:d.value,alt:"File Preview",class:"max-w-full h-auto rounded-lg shadow-md max-h-60 object-contain"},null,8,oc)])):T("",!0)]),e("div",rc,[me(e("input",{id:"is_visible_to_client",type:"checkbox","onUpdate:modelValue":D[6]||(D[6]=L=>i.is_visible_to_client=L),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,512),[[et,i.is_visible_to_client]]),p(Y,{for:"is_visible_to_client",value:"Visible to Client",class:"ml-2"}),p(le,{message:R.is_visible_to_client?R.is_visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","api-endpoint","form-data"]))}},vc={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},pc={class:"flex justify-between items-center mb-4"},gc={class:"flex gap-2"},hc={key:0},yc={key:1},fc={class:"mb-6 bg-gray-50 p-4 rounded-lg"},bc={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},wc={key:0,class:"mt-3 text-sm text-gray-600"},_c={key:0,class:"text-red-600 font-medium"},xc={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},kc={key:1,class:"text-center py-4"},Dc={class:"text-red-600 text-sm font-medium"},Cc={key:2,class:"overflow-x-auto"},Tc={class:"min-w-full divide-y divide-gray-200"},Ec={class:"bg-white divide-y divide-gray-200"},Sc={class:"px-4 py-3 text-sm text-gray-900"},jc={class:"px-4 py-3 text-sm text-gray-700 capitalize"},Mc={class:"px-4 py-3 text-sm text-gray-700"},$c={class:"px-4 py-3 text-sm text-gray-700"},Vc={class:"px-4 py-3 text-sm text-gray-700"},Ac={class:"px-4 py-3 text-sm text-gray-700"},Ic={class:"px-4 py-3 text-sm text-gray-700"},Oc={class:"px-4 py-3 text-right"},Lc={class:"flex justify-end space-x-2"},Uc=["onClick"],Nc={key:3,class:"text-center py-4"},Pc={__name:"ProjectDeliverableTab",props:{projectId:{type:[String,Number],required:!0},canCreateDeliverables:{type:Boolean,default:!1},canViewDeliverables:{type:Boolean,default:!1}},emits:["deliverablesUpdated","openDeliverableDetailSidebar"],setup(s,{emit:t}){const l=s,n=t,i=k([]),a=k(!0),c=k(null),m=k(!1),u=k({status:"",type:"",visibility:"",clientStatus:""}),d=[{value:"",label:"All Statuses"},{value:"pending_review",label:"Pending Review"},{value:"for_information",label:"For Information"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"},{value:"completed",label:"Completed"}],v=[{value:"",label:"All Types"},{value:"blog_post",label:"Blog Post"},{value:"design_mockup",label:"Design Mockup"},{value:"social_media_post",label:"Social Media Post"},{value:"report",label:"Report"},{value:"contract_draft",label:"Contract Draft"},{value:"proposal",label:"Proposal"},{value:"other",label:"Other"}],g=[{value:"",label:"All Visibility"},{value:"visible_to_client",label:"Visible to Client"},{value:"not_visible_to_client",label:"Not Visible to Client"}],_=[{value:"",label:"All Client Status"},{value:"read",label:"Read"},{value:"unread",label:"Unread"},{value:"approved",label:"Approved"},{value:"revisions_requested",label:"Revisions Requested"}],E=L=>{var w;if(!L.is_visible_to_client)return{status:"N/A",class:"bg-gray-100 text-gray-800"};const O=(w=L.client_interactions)==null?void 0:w[0];return O?O.approved_at?{status:"Approved",class:"bg-green-100 text-green-800"}:O.revisions_requested_at?{status:"Revisions Requested",class:"bg-yellow-100 text-yellow-800"}:O.rejected_at?{status:"Rejected",class:"bg-red-100 text-red-800"}:O.read_at?{status:`Read on ${new Date(O.read_at).toLocaleDateString()}`,class:"bg-blue-100 text-blue-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}:{status:"Unread",class:"bg-red-100 text-red-800"}},S=N(()=>i.value.length?i.value.filter(L=>{const O=E(L);return!(u.value.status&&L.status!==u.value.status||u.value.type&&L.type!==u.value.type||u.value.visibility&&(u.value.visibility==="visible_to_client"&&!L.is_visible_to_client||u.value.visibility==="not_visible_to_client"&&L.is_visible_to_client)||u.value.clientStatus&&(u.value.clientStatus==="read"&&!O.status.startsWith("Read")||u.value.clientStatus==="unread"&&O.status!=="Unread"||u.value.clientStatus==="approved"&&O.status!=="Approved"||u.value.clientStatus==="revisions_requested"&&O.status!=="Revisions Requested"))}):[]),$=()=>{u.value.status="",u.value.type="",u.value.visibility="",u.value.clientStatus=""},b=async()=>{if(!l.canViewDeliverables){c.value="You do not have permission to view deliverables.",a.value=!1;return}a.value=!0,c.value=null;try{const L=await window.axios.get(route("projects.deliverables.index",l.projectId));i.value=L.data}catch(L){console.error("Error fetching deliverables:",L),c.value="Failed to load deliverables."}finally{a.value=!1}},D=()=>{b(),n("deliverablesUpdated")},R=L=>{n("openDeliverableDetailSidebar",L)};return be(()=>{b()}),re(()=>l.projectId,()=>{b()}),(L,O)=>(o(),r("div",vc,[e("div",pc,[O[7]||(O[7]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Project Deliverables & Approvals",-1)),e("div",gc,[p(ye,{onClick:b,disabled:a.value,class:"text-indigo-600 hover:text-indigo-800"},{default:U(()=>[a.value?(o(),r("span",yc,"Loading...")):(o(),r("span",hc,"Refresh"))]),_:1},8,["disabled"]),s.canCreateDeliverables?(o(),X(de,{key:0,onClick:O[0]||(O[0]=w=>m.value=!0),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:U(()=>O[6]||(O[6]=[W(" Add New Deliverable ",-1)])),_:1,__:[6]})):T("",!0)])]),e("div",fc,[e("div",bc,[e("div",null,[p(Y,{for:"deliverable-status-filter",value:"Status"}),p(ge,{id:"deliverable-status-filter",modelValue:u.value.status,"onUpdate:modelValue":O[1]||(O[1]=w=>u.value.status=w),options:d,placeholder:"All Statuses",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(Y,{for:"deliverable-type-filter",value:"Type"}),p(ge,{id:"deliverable-type-filter",modelValue:u.value.type,"onUpdate:modelValue":O[2]||(O[2]=w=>u.value.type=w),options:v,placeholder:"All Types",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(Y,{for:"deliverable-visibility-filter",value:"Visibility"}),p(ge,{id:"deliverable-visibility-filter",modelValue:u.value.visibility,"onUpdate:modelValue":O[3]||(O[3]=w=>u.value.visibility=w),options:g,placeholder:"All Visibility",class:"mt-1"},null,8,["modelValue"])]),e("div",null,[p(Y,{for:"deliverable-client-status-filter",value:"Client Status"}),p(ge,{id:"deliverable-client-status-filter",modelValue:u.value.clientStatus,"onUpdate:modelValue":O[4]||(O[4]=w=>u.value.clientStatus=w),options:_,placeholder:"All Client Status",class:"mt-1"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end mt-4"},[e("button",{type:"button",onClick:$,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")]),Object.values(u.value).some(w=>w!==null&&w!=="")?(o(),r("div",wc,[e("p",null,[W(" Showing "+y(S.value.length)+" of "+y(i.value.length)+" deliverables ",1),S.value.length===0?(o(),r("span",_c," (No deliverables match the current filters) ")):T("",!0)])])):T("",!0)]),a.value?(o(),r("div",xc," Loading deliverables... ")):c.value?(o(),r("div",kc,[e("p",Dc,y(c.value),1)])):S.value.length?(o(),r("div",Cc,[e("table",Tc,[O[8]||(O[8]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted By"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted On"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Visibility"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client Status"),W(),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Ec,[(o(!0),r(Z,null,ee(S.value,w=>{var j;return o(),r("tr",{key:w.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Sc,y(w.title),1),e("td",jc,y(w.type.replace(/_/g," ")),1),e("td",Mc,[e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":w.status==="pending_review"||w.status==="revisions_requested","bg-green-100 text-green-800":w.status==="approved","bg-blue-100 text-blue-800":w.status==="completed","bg-gray-100 text-gray-800":w.status==="for_information"})},y(w.status.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase())),3)]),e("td",$c,y(((j=w.team_member)==null?void 0:j.name)||"Unknown"),1),e("td",Vc,y(new Date(w.submitted_at).toLocaleDateString()),1),e("td",Ac,[e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":w.is_visible_to_client,"bg-red-100 text-red-800":!w.is_visible_to_client})},y(w.is_visible_to_client?"Visible":"Hidden"),3)]),e("td",Ic,[e("span",{class:te(["px-2 py-1 rounded-full text-xs font-medium",E(w).class])},y(E(w).status),3)]),e("td",Oc,[e("div",Lc,[e("button",{onClick:M=>R(w.id),class:"text-purple-600 hover:text-purple-800 text-sm font-medium"}," View Details ",8,Uc)])])])}),128))])])])):(o(),r("div",Nc,O[9]||(O[9]=[e("p",{class:"text-gray-400 text-sm"},"No deliverables found for this project.",-1),e("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add New Deliverable" button to create one. ',-1)]))),p(Dt,{show:m.value,"project-id":s.projectId,onClose:O[5]||(O[5]=w=>m.value=!1),onSaved:D},null,8,["show","project-id"])]))}},Rc=Ee(Pc,[["__scopeId","data-v-40d67f52"]]),Fc={class:"p-6 bg-white rounded-lg shadow-md min-h-[calc(100vh-6rem)]"},Bc={class:"flex justify-between items-center mb-4"},Hc={class:"mb-6 bg-gray-50 p-4 rounded-lg"},Wc={class:"flex items-center gap-4"},Yc={class:"flex-1 min-w-[200px]"},zc={key:0,class:"text-red-600 text-sm mt-2"},qc={key:1,class:"text-gray-600 text-sm mt-2 animate-pulse"},Gc={key:2,class:"text-gray-500 text-sm mt-2"},Kc={class:"mt-6"},Jc={class:"flex justify-between items-center mb-3"},Zc={class:"text-md font-medium text-gray-800"},Xc={key:0},Qc={key:1},em={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-8"},tm={key:1,class:"text-center py-8"},sm={class:"text-red-600 text-sm font-medium"},lm={key:2,class:"text-center py-8"},am={class:"text-red-600 text-sm font-medium"},im={key:3,class:"space-y-8"},nm={class:"bg-gray-50 p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},om={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},rm={class:"text-lg font-semibold text-gray-900"},dm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},um={class:"text-lg font-semibold text-gray-900"},cm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},mm={class:"text-lg font-semibold text-gray-900"},vm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},pm={class:"text-lg font-semibold text-gray-900"},gm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},hm={class:"text-lg font-semibold text-gray-900"},ym={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},fm={class:"text-lg font-semibold text-gray-900"},bm={class:"flex flex-col items-center p-3 bg-white rounded-md shadow-xs"},wm={class:"text-lg font-semibold text-gray-900"},_m={class:"bg-white p-6 rounded-lg shadow-sm"},xm={class:"overflow-x-auto max-h-60"},km={class:"min-w-full divide-y divide-gray-200"},Dm={class:"bg-white divide-y divide-gray-200"},Cm={class:"px-4 py-3 text-sm text-gray-900"},Tm={class:"px-4 py-3 text-sm text-gray-700"},Em={class:"px-4 py-3 text-sm text-gray-700"},Sm={key:0,class:"text-gray-500 text-sm py-2"},jm={class:"bg-white p-6 rounded-lg shadow-sm"},Mm={class:"overflow-x-auto max-h-60"},$m={class:"min-w-full divide-y divide-gray-200"},Vm={class:"bg-white divide-y divide-gray-200"},Am={class:"px-4 py-3 text-sm text-gray-900"},Im={class:"px-4 py-3 text-sm text-gray-700"},Om={class:"px-4 py-3 text-sm text-gray-700"},Lm={class:"px-4 py-3 text-sm text-gray-700"},Um={class:"px-4 py-3 text-sm text-gray-700"},Nm={key:0,class:"text-gray-500 text-sm py-2"},Pm={class:"bg-white p-6 rounded-lg shadow-sm"},Rm={class:"overflow-x-auto max-h-60"},Fm={class:"min-w-full divide-y divide-gray-200"},Bm={class:"bg-white divide-y divide-gray-200"},Hm={class:"px-4 py-3 text-sm text-gray-900"},Wm={class:"px-4 py-3 text-sm text-gray-700"},Ym={key:0,class:"text-gray-500 text-sm py-2"},zm={class:"bg-white p-6 rounded-lg shadow-sm"},qm={class:"overflow-x-auto"},Gm={class:"min-w-full divide-y divide-gray-200"},Km={class:"bg-white divide-y divide-gray-200"},Jm={class:"px-4 py-3 text-sm text-gray-900"},Zm={class:"px-4 py-3 text-sm text-gray-700"},Xm={key:0,class:"text-gray-500 text-sm py-2"},Qm={class:"bg-white p-6 rounded-lg shadow-sm"},ev={class:"overflow-x-auto"},tv={class:"min-w-full divide-y divide-gray-200"},sv={class:"bg-white divide-y divide-gray-200"},lv={class:"px-4 py-3 text-sm text-gray-900"},av={class:"px-4 py-3 text-sm text-gray-700"},iv={key:0,class:"text-gray-500 text-sm py-2"},nv={class:"bg-white p-6 rounded-lg shadow-sm"},ov={class:"overflow-x-auto max-h-60"},rv={class:"min-w-full divide-y divide-gray-200"},dv={class:"bg-white divide-y divide-gray-200"},uv={class:"px-4 py-3 text-sm text-gray-900"},cv={class:"px-4 py-3 text-sm text-gray-700"},mv={key:0,class:"text-gray-500 text-sm py-2"},vv={class:"bg-white p-6 rounded-lg shadow-sm grid grid-cols-1 md:grid-cols-2 gap-6"},pv={key:0,class:"space-y-2"},gv={class:"font-medium"},hv={key:1,class:"text-gray-500 text-sm py-2"},yv={key:0,class:"space-y-2"},fv={class:"font-medium"},bv={key:1,class:"text-gray-500 text-sm py-2"},wv={key:4,class:"text-center py-8 text-gray-500"},_v={__name:"SeoReportTab",props:{projectId:{type:[String,Number],required:!0},canCreateSeoReports:{type:Boolean,default:!1}},emits:["openCreateSeoReportModal"],setup(s,{emit:t}){const l=s,n=t,i=k([]),a=k(""),c=k(null),m=k(!0),u=k(!1),d=k(null),v=k(null),g=k(null),_=async()=>{m.value=!0,d.value=null;try{const B=await window.axios.get(`/api/projects/${l.projectId}/seo-reports/available-months`);i.value=B.data.map(A=>({value:A,label:new Date(A+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})})),i.value.length>0&&(a.value=i.value[0].value)}catch(B){console.error("Error fetching available months:",B),d.value="Failed to load available report months."}finally{m.value=!1}},E=B=>{const C=["clientName","reportingPeriod","authorityScoreValue","totalClicksValue","totalImpressionsValue","averagePositionValue","totalBacklinksValue","clicksImpressions","trafficSources","deviceUsage","countryPerformance","coreVitals","topQueries","keywordRankings","backlinks","zeroClickKeywords"].filter(I=>!(I in B));return C.length>0?`Report data is missing expected top-level keys: ${C.join(", ")}. Please ensure the JSON structure is correct.`:!B.clicksImpressions||!Array.isArray(B.clicksImpressions.labels)||!Array.isArray(B.clicksImpressions.clicks)?"clicksImpressions data is malformed.":!B.trafficSources||!Array.isArray(B.trafficSources.labels)||!Array.isArray(B.trafficSources.sessions)?"trafficSources data is malformed.":null},S=async()=>{if(!a.value){c.value=null,g.value=null;return}u.value=!0,v.value=null,g.value=null;try{const A=(await window.axios.get(`/api/projects/${l.projectId}/seo-reports/${a.value}`)).data,C=E(A);C?(g.value=C,c.value=null):c.value=A}catch(B){console.error("Error fetching SEO report:",B),v.value="Failed to load SEO report for the selected month.",c.value=null,g.value=null}finally{u.value=!1}},$=(B=null)=>{n("openCreateSeoReportModal",B)},b=N(()=>{var B;return((B=c.value)==null?void 0:B.clientName)||"N/A"}),D=N(()=>{var B;return((B=c.value)==null?void 0:B.reportingPeriod)||"N/A"}),R=N(()=>{var B;return((B=c.value)==null?void 0:B.authorityScoreValue)||"N/A"}),L=N(()=>{var B;return((B=c.value)==null?void 0:B.totalClicksValue)||"N/A"}),O=N(()=>{var B;return((B=c.value)==null?void 0:B.totalImpressionsValue)||"N/A"}),w=N(()=>{var B;return((B=c.value)==null?void 0:B.averagePositionValue)||"N/A"}),j=N(()=>{var B;return((B=c.value)==null?void 0:B.totalBacklinksValue)||"N/A"}),M=N(()=>{var B;return((B=c.value)==null?void 0:B.clicksImpressions)||{labels:[],clicks:[],impressions:[]}}),f=N(()=>{var B;return((B=c.value)==null?void 0:B.trafficSources)||{labels:[],sessions:[],colors:[]}}),h=N(()=>{var B;return((B=c.value)==null?void 0:B.deviceUsage)||{labels:[],clicks:[],colors:[]}}),x=N(()=>{var B;return((B=c.value)==null?void 0:B.countryPerformance)||{labels:[],clicks:[]}}),V=N(()=>{var B;return((B=c.value)==null?void 0:B.coreVitals)||{mobile:{},desktop:{}}}),K=N(()=>{var B;return((B=c.value)==null?void 0:B.topQueries)||[]}),ie=N(()=>{var B;return((B=c.value)==null?void 0:B.keywordRankings)||[]});return be(()=>{_()}),re(()=>l.projectId,()=>{_()}),re(a,B=>{B?S():(c.value=null,g.value=null)}),(B,A)=>(o(),r("div",Fc,[e("div",Bc,[A[4]||(A[4]=e("h4",{class:"text-lg font-semibold text-gray-900"},"SEO Reports",-1)),s.canCreateSeoReports?(o(),X(de,{key:0,onClick:A[0]||(A[0]=C=>$()),class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:U(()=>A[3]||(A[3]=[W(" Add New Report ",-1)])),_:1,__:[3]})):T("",!0)]),e("div",Hc,[e("div",Wc,[e("div",Yc,[p(Y,{for:"seo-report-month-filter",value:"Select Report Month"}),p(ge,{id:"seo-report-month-filter",modelValue:a.value,"onUpdate:modelValue":A[1]||(A[1]=C=>a.value=C),options:i.value,"value-key":"value","label-key":"label",placeholder:"Select a month",disabled:m.value||i.value.length===0,class:"mt-1"},null,8,["modelValue","options","disabled"])])]),d.value?(o(),r("div",zc,y(d.value),1)):T("",!0),m.value?(o(),r("div",qc,"Loading available months...")):T("",!0),!m.value&&i.value.length===0?(o(),r("div",Gc,"No SEO reports available for this project.")):T("",!0)]),e("div",Kc,[e("div",Jc,[e("h5",Zc,[a.value?(o(),r("span",Xc,"Report for "+y(new Date(a.value+"-01").toLocaleString("en-US",{year:"numeric",month:"long"})),1)):(o(),r("span",Qc,"Select a month to view report"))]),s.canCreateSeoReports&&c.value&&a.value?(o(),X(de,{key:0,onClick:A[2]||(A[2]=C=>$({report_date:a.value,data:JSON.stringify(c.value,null,2)})),class:"bg-blue-500 hover:bg-blue-600 transition-colors text-sm py-1 px-3"},{default:U(()=>A[5]||(A[5]=[W(" Edit Report ",-1)])),_:1,__:[5]})):T("",!0)]),u.value?(o(),r("div",em," Loading SEO report data... ")):v.value?(o(),r("div",tm,[e("p",sm,y(v.value),1)])):g.value?(o(),r("div",lm,[e("p",am,"Data Structure Error: "+y(g.value),1),A[6]||(A[6]=e("p",{class:"text-gray-500 text-sm mt-2"},"Please ensure the JSON data conforms to the expected format.",-1))])):c.value?(o(),r("div",im,[e("div",nm,[e("div",om,[A[7]||(A[7]=e("p",{class:"text-sm text-gray-500"},"Client Name",-1)),e("p",rm,y(b.value),1)]),e("div",dm,[A[8]||(A[8]=e("p",{class:"text-sm text-gray-500"},"Reporting Period",-1)),e("p",um,y(D.value),1)]),e("div",cm,[A[9]||(A[9]=e("p",{class:"text-sm text-gray-500"},"Authority Score",-1)),e("p",mm,y(R.value),1)]),e("div",vm,[A[10]||(A[10]=e("p",{class:"text-sm text-gray-500"},"Total Clicks",-1)),e("p",pm,y(L.value),1)]),e("div",gm,[A[11]||(A[11]=e("p",{class:"text-sm text-gray-500"},"Total Impressions",-1)),e("p",hm,y(O.value),1)]),e("div",ym,[A[12]||(A[12]=e("p",{class:"text-sm text-gray-500"},"Average Position",-1)),e("p",fm,y(w.value),1)]),e("div",bm,[A[13]||(A[13]=e("p",{class:"text-sm text-gray-500"},"Total Backlinks",-1)),e("p",wm,y(j.value),1)])]),e("div",_m,[A[15]||(A[15]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Clicks & Impressions Trend",-1)),e("div",xm,[e("table",km,[A[14]||(A[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions")])],-1)),e("tbody",Dm,[(o(!0),r(Z,null,ee(M.value.labels,(C,I)=>(o(),r("tr",{key:I},[e("td",Cm,y(C),1),e("td",Tm,y(M.value.clicks[I]),1),e("td",Em,y(M.value.impressions[I]),1)]))),128))])])]),M.value.labels.length?T("",!0):(o(),r("p",Sm,"No clicks and impressions data available."))]),e("div",jm,[A[17]||(A[17]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Top Queries",-1)),e("div",Mm,[e("table",$m,[A[16]||(A[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Query"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Impressions"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"CTR"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Position")])],-1)),e("tbody",Vm,[(o(!0),r(Z,null,ee(K.value,C=>(o(),r("tr",{key:C.query},[e("td",Am,y(C.query),1),e("td",Im,y(C.clicks),1),e("td",Om,y(C.impressions),1),e("td",Lm,y(C.ctr)+"%",1),e("td",Um,y(C.position),1)]))),128))])])]),K.value.length?T("",!0):(o(),r("p",Nm,"No top queries data available."))]),e("div",Pm,[A[19]||(A[19]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Keyword Rankings",-1)),e("div",Rm,[e("table",Fm,[A[18]||(A[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Keyword"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ranking")])],-1)),e("tbody",Bm,[(o(!0),r(Z,null,ee(ie.value,C=>(o(),r("tr",{key:C.keyword},[e("td",Hm,y(C.keyword),1),e("td",Wm,y(C.ranking),1)]))),128))])])]),ie.value.length?T("",!0):(o(),r("p",Ym,"No keyword rankings data available."))]),e("div",zm,[A[21]||(A[21]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Traffic Sources",-1)),e("div",qm,[e("table",Gm,[A[20]||(A[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Source"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sessions")])],-1)),e("tbody",Km,[(o(!0),r(Z,null,ee(f.value.labels,(C,I)=>(o(),r("tr",{key:C},[e("td",Jm,y(C),1),e("td",Zm,y(f.value.sessions[I]),1)]))),128))])])]),f.value.labels.length?T("",!0):(o(),r("p",Xm,"No traffic sources data available."))]),e("div",Qm,[A[23]||(A[23]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Device Usage",-1)),e("div",ev,[e("table",tv,[A[22]||(A[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Device"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",sv,[(o(!0),r(Z,null,ee(h.value.labels,(C,I)=>(o(),r("tr",{key:C},[e("td",lv,y(C),1),e("td",av,y(h.value.clicks[I]),1)]))),128))])])]),h.value.labels.length?T("",!0):(o(),r("p",iv,"No device usage data available."))]),e("div",nv,[A[25]||(A[25]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Country Performance (Top 10)",-1)),e("div",ov,[e("table",rv,[A[24]||(A[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Country"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Clicks")])],-1)),e("tbody",dv,[(o(!0),r(Z,null,ee(x.value.labels,C=>(o(),r("tr",{key:C},[e("td",uv,y(C),1),e("td",cv,y(x.value.clicks[x.value.labels.indexOf(C)]),1)]))),128))])])]),x.value.labels.length?T("",!0):(o(),r("p",mv,"No country performance data available."))]),e("div",vv,[e("div",null,[A[26]||(A[26]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Mobile)",-1)),V.value.mobile&&V.value.mobile.labels&&V.value.mobile.labels.length?(o(),r("div",pv,[(o(!0),r(Z,null,ee(V.value.mobile.labels,(C,I)=>(o(),r("div",{key:C,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,y(C)+":",1),e("span",gv,y(V.value.mobile.scores[I]),1)]))),128))])):(o(),r("p",hv,"No mobile core vitals data available."))]),e("div",null,[A[27]||(A[27]=e("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Core Vitals (Desktop)",-1)),V.value.desktop&&V.value.desktop.labels&&V.value.desktop.labels.length?(o(),r("div",yv,[(o(!0),r(Z,null,ee(V.value.desktop.labels,(C,I)=>(o(),r("div",{key:C,class:"flex justify-between items-center text-sm text-gray-700"},[e("span",null,y(C)+":",1),e("span",fv,y(V.value.desktop.scores[I]),1)]))),128))])):(o(),r("p",bv,"No desktop core vitals data available."))])])])):(o(),r("div",wv," No report data to display. Please select a month from the dropdown. "))])]))}},xv=Ee(_v,[["__scopeId","data-v-37cb2f02"]]),kv={class:"space-y-4"},Dv={key:0,class:"text-xs text-gray-500 mt-1 text-red-500"},Cv=["onBlur"],Tv={__name:"CreateSeoReportModal",props:{show:{type:Boolean,default:!1},projectId:{type:[String,Number],required:!0},initialData:{type:Object,default:null}},emits:["close","saved"],setup(s,{emit:t}){const l=s,n=t,i=De({report_date:"",data:""}),a=k(null);re(()=>[l.show,l.initialData],([b,D])=>{b&&(D?Object.assign(i,{report_date:D.report_date||"",data:D.data||""}):Object.assign(i,{report_date:"",data:""}))},{immediate:!0});const c=b=>{let D=b.data;try{D=JSON.stringify(JSON.parse(b.data))}catch{console.warn("Provided data is not valid JSON, sending as plain string. Backend should validate.")}return{report_date:b.report_date,data:D}},m=N(()=>l.initialData?"Edit SEO Report":"Create New SEO Report"),u=N(()=>`/api/projects/${l.projectId}/seo-reports`),d=N(()=>"post"),v=N(()=>l.initialData?"Update Report":"Create Report"),g=N(()=>l.initialData?"SEO Report updated successfully!":"SEO Report created successfully!"),_=b=>{n("saved",b),n("close")},E=()=>{n("close")},S=()=>{try{const b=JSON.parse(i.data);i.data=JSON.stringify(b,null,2)}catch(b){console.error("Invalid JSON for pretty print:",b)}},$=b=>{if(i.data)try{JSON.parse(i.data),b.data&&b.data[0]==="The data field must be a valid JSON string."&&(b.data=[])}catch{(!b.data||b.data.length===0)&&(b.data=["The data field must be a valid JSON string."])}};return(b,D)=>(o(),X(Te,{show:s.show,title:m.value,"api-endpoint":u.value,"http-method":d.value,"form-data":i,"submit-button-text":v.value,"success-message":g.value,"format-data-for-api":c,onClose:E,onSubmitted:_},{default:U(({errors:R})=>[e("div",kv,[e("div",null,[p(Y,{for:"report_date",value:"Report Month (YYYY-MM)"}),p(oe,{id:"report_date",modelValue:i.report_date,"onUpdate:modelValue":D[0]||(D[0]=L=>i.report_date=L),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 2025-07",required:"",autofocus:"",pattern:"\\d{4}-\\d{2}",title:"Please enter a date in YYYY-MM format (e.g., 2025-07)",disabled:!!s.initialData},null,8,["modelValue","disabled"]),p(le,{message:R.report_date?R.report_date[0]:"",class:"mt-2"},null,8,["message"]),D[2]||(D[2]=e("p",{class:"text-xs text-gray-500 mt-1"},"Enter the report month in YYYY-MM format (e.g., 2025-07).",-1)),s.initialData?(o(),r("p",Dv,"Note: Report month cannot be changed when editing.")):T("",!0)]),e("div",null,[p(Y,{for:"report_data",value:"Report Data (JSON)"}),me(e("textarea",{id:"report_data",ref_key:"jsonInputRef",ref:a,"onUpdate:modelValue":D[1]||(D[1]=L=>i.data=L),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 font-mono",rows:"10",placeholder:'Enter JSON data for the report, e.g., {"keywords_ranked": 150, "traffic": 1200, "rankings": {"keyword1": 5, "keyword2": 12}}',required:"",onBlur:L=>$(R)},null,40,Cv),[[we,i.data]]),p(le,{message:R.data?R.data[0]:"",class:"mt-2"},null,8,["message"]),e("div",{class:"flex justify-end mt-2"},[e("button",{type:"button",onClick:S,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," Format JSON ")])])])]),_:1},8,["show","title","api-endpoint","http-method","form-data","submit-button-text","success-message"]))}},Ev={key:0,class:"bg-amber-50 border-l-4 border-amber-500 p-4 mb-6 rounded-md shadow-md"},Sv={class:"flex items-center justify-between"},jv={class:"flex items-center"},Mv={class:"ml-3"},$v={class:"text-sm text-amber-800 font-medium"},Vv={key:0},Av={key:1},Iv={key:2},Ov={__name:"ProjectTaskNotificationPrompt",props:{overdueTasks:{type:Number,required:!0},dueTodayTasks:{type:Number,required:!0}},emits:["view-tasks"],setup(s,{emit:t}){const l=s,n=t,i=N(()=>l.overdueTasks+l.dueTodayTasks),a=N(()=>i.value>0),c=()=>{n("view-tasks")};return(m,u)=>a.value?(o(),r("div",Ev,[e("div",Sv,[e("div",jv,[u[0]||(u[0]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-6 w-6 text-amber-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",Mv,[e("p",$v,[s.overdueTasks>0&&s.dueTodayTasks>0?(o(),r("span",Vv," This project has "+y(s.overdueTasks)+" overdue "+y(s.overdueTasks===1?"task":"tasks")+" and "+y(s.dueTodayTasks)+" "+y(s.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):s.overdueTasks>0?(o(),r("span",Av," This project has "+y(s.overdueTasks)+" overdue "+y(s.overdueTasks===1?"task":"tasks")+" that require attention. ",1)):s.dueTodayTasks>0?(o(),r("span",Iv," This project has "+y(s.dueTodayTasks)+" "+y(s.dueTodayTasks===1?"task":"tasks")+" due today. ",1)):T("",!0)])])]),e("div",null,[p(de,{onClick:c,class:"px-4 py-2 text-sm bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"},{default:U(()=>u[1]||(u[1]=[W(" View ",-1)])),_:1,__:[1]})])])])):T("",!0)}},Lv={class:"py-8 max-w-full mx-auto px-4 sm:px-6 lg:px-8"},Uv={key:0,class:"flex items-center justify-center min-h-[50vh]"},Nv={key:1,class:"text-center text-red-600 text-lg font-medium"},Pv={key:2,class:"space-y-8"},Rv={class:"flex justify-end items-center mb-5"},Fv={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Bv={key:1},Hv={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Wv={class:"flex justify-between items-center mb-4"},Yv={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},zv={class:"flex justify-between items-center mb-4"},qv={key:2,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Gv={class:"flex justify-between items-center mb-4"},Kv={key:0,class:"text-gray-400 text-sm"},Jv={key:1,class:"overflow-x-auto"},Zv={class:"min-w-full divide-y divide-gray-200"},Xv={class:"bg-white divide-y divide-gray-200"},Qv={class:"px-4 py-3 text-sm text-gray-900"},ep={class:"px-4 py-3 text-sm text-gray-700"},tp={class:"px-4 py-3 text-sm text-gray-700"},sp={class:"px-4 py-3 text-sm text-gray-700"},lp={class:"px-4 py-3 text-sm text-gray-700"},ap={class:"px-4 py-3 text-right"},ip={key:3,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},np={class:"flex justify-between items-center mb-4"},op={class:"flex items-center gap-4"},rp={key:0},dp={key:0,class:"space-y-4"},up={class:"flex justify-between"},cp={class:"flex-grow"},mp={key:0,class:"text-xs text-red-400 block mt-1"},vp={class:"flex items-center mt-1"},pp={class:"text-xs text-gray-500"},gp={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},hp={key:0},yp={key:1,class:"text-gray-400 text-sm"},fp={__name:"Show",setup(s){const t=Ue(),l=as().props.id,n=k({clients:[],users:[],notes:[],transactions:[],documents:[],meetings:[],tasks:[],emails:[],deliverables:[]}),i=k(!0),a=k(""),c=k(!1),m=k(!1),u=k(!1),d=k(!1),v=k(!1),g=k(!1),_=k(!1),E=k(!1),S=k(!1),$=k(!1),b=k(null),D=[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"on_hold",label:"On Hold"},{value:"archived",label:"Archived"}],R=[{value:"Website Designing",label:"Website Designing"},{value:"SEO",label:"SEO"},{value:"Social Media",label:"Social Media"},{value:"Content Writing",label:"Content Writing"},{value:"Graphic Design",label:"Graphic Design"}],L=[{value:"UpWork",label:"UpWork"},{value:"Direct",label:"Direct Client"},{value:"Wix Marketplace",label:"Wix Marketplace"},{value:"Referral",label:"Referral"}],O=k(null),w=k(null),j=is(n),{canDo:M,canView:f}=tt(l),h=N(()=>{var se,H;return((H=(se=t.value)==null?void 0:se.role_data)==null?void 0:H.slug)==="super-admin"}),x=N(()=>M("manage_projects").value||h.value),V=N(()=>M("edit_projects").value||h.value),K=N(()=>f("emails").value),ie=N(()=>M("compose_emails").value),B=N(()=>M("approve_emails").value),A=N(()=>f("project_notes").value),C=N(()=>M("add_project_notes").value),I=N(()=>f("deliverables").value),z=N(()=>M("create_deliverables").value),ue=N(()=>f("seo_reports").value),Me=N(()=>M("create_seo_reports").value),ae=N(()=>f("client_contacts").value);N(()=>f("users").value);const P=N(()=>f("project_financial",j).value),F=N(()=>f("project_transactions").value);N(()=>f("client_financial").value);const q=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],fe=k([]),Ye=k(null),ze=k(null),Ke=k("all"),st=async()=>{try{fe.value=await Gt(l)}catch(se){console.error("Error fetching due and overdue tasks:",se)}},Ct=()=>{w.value="tasks",Ke.value="due-overdue",setTimeout(()=>{ze.value&&ze.value.scrollIntoView&&ze.value.scrollIntoView({behavior:"smooth"})},100)},Tt=async()=>{await st()},lt=N(()=>n.value.notes?[...n.value.notes].filter(se=>se.type!=="standup").sort((se,H)=>new Date(H.created_at)-new Date(se.created_at)).slice(0,3):[]),at=k([]),it=async()=>{try{const se=await window.axios.get(`/api/projects/${l}/emails-simplified`,{params:{limit:5}});at.value=se.data}catch(se){console.error("Error fetching latest emails:",se)}},je=async()=>{i.value=!0,a.value="";try{const se=await window.axios.get(`/api/projects/${l}`);n.value=se.data,console.log("Full project data received (Show.vue main fetch):",n.value),await st(),K.value&&await it()}catch(se){a.value="Failed to load project data.",console.error("Error fetching project data:",se),se.response&&(se.response.status===401||se.response.status===403)&&(a.value="You are not authorized to view this project or your session expired. Please log in.")}finally{i.value=!1}},Et=se=>{n.value=se,c.value=!1,je()},St=se=>{n.value.tasks=se},jt=se=>{n.value.emails=se,K.value&&it()},nt=se=>{n.value.notes=se},Mt=()=>{je()},$t=()=>{O.value&&O.value.fetchMeetings()},ot=()=>{je()},Vt=se=>{w.value=se,cs()},At=()=>{g.value=!0},It=()=>{_.value=!0,w.value="emails"},Ot=async()=>{_.value=!1,await je()},Lt=()=>{_.value=!1},rt=(se,H)=>{us(se,H||l,n.value.users)};re(ns,(se,H)=>{H.taskId&&!se.taskId&&je()},{deep:!0});const Ut=()=>{S.value=!0},Nt=()=>{S.value=!1,je()},Pt=(se=null)=>{b.value=se,$.value=!0},Rt=()=>{$.value=!1};return be(async()=>{console.log("Show.vue mounted, fetching initial data...");try{await os(l),console.log("Project permissions fetched (includes global)")}catch(se){console.error(`Error fetching permissions for project ${l}:`,se)}await ms(),await je()}),(se,H)=>(o(),r(Z,null,[p(J(rs),{title:n.value.name||"Project Details"},null,8,["title"]),p(qt,null,{default:U(()=>{var Je;return[e("div",Lv,[i.value?(o(),r("div",Uv,H[25]||(H[25]=[e("div",{class:"flex flex-col items-center space-y-4"},[e("svg",{class:"animate-spin h-16 w-16 text-indigo-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),e("p",{class:"text-lg text-gray-600 font-medium"},"Loading project details...")],-1)]))):a.value?(o(),r("div",Nv,y(a.value),1)):(o(),r("div",Pv,[p(Ov,{"overdue-tasks":fe.value.filter(G=>new Date(G.due_date)<new Date).length,"due-today-tasks":fe.value.filter(G=>new Date(G.due_date).toDateString()===new Date().toDateString()).length,onViewTasks:Ct},null,8,["overdue-tasks","due-today-tasks"]),p(kn,{project:n.value,"project-id":J(l),"can-manage-projects":x.value,"is-super-admin":h.value,"can-edit-projects":V.value,onOpenEditModal:H[0]||(H[0]=G=>c.value=!0),onOpenStandupModal:H[1]||(H[1]=G=>u.value=!0),onOpenMeetingModal:H[2]||(H[2]=G=>m.value=!0),onOpenMagicLinkModal:H[3]||(H[3]=G=>v.value=!0),onResourceSaved:je,onOpenComposeModal:It},null,8,["project","project-id","can-manage-projects","is-super-admin","can-edit-projects"]),p(Ts,{"project-id":J(l),ref_key:"meetingsListComponent",ref:O},null,8,["project-id"]),p(An,{tasks:n.value.tasks||[],emails:n.value.emails||[]},null,8,["tasks","emails"]),e("div",Rv,[p(ge,{id:"display-currency-switcher",modelValue:J(He),"onUpdate:modelValue":H[4]||(H[4]=G=>ds(He)?He.value=G:null),options:q,"value-key":"value","label-key":"label",class:"w-20",containerClasses:"max-w-[150px]"},null,8,["modelValue"])]),P.value&&F.value?(o(),X(mu,{key:0,"project-id":J(l),"can-view-project-services-and-payments":P.value,"can-view-project-transactions":F.value},null,8,["project-id","can-view-project-services-and-payments","can-view-project-transactions"])):T("",!0),e("div",Fv,[ae.value?(o(),X(bu,{key:0,"project-id":J(l),"can-view-client-contacts":ae.value},null,8,["project-id","can-view-client-contacts"])):T("",!0),p(Su,{"project-id":J(l),"can-view-users":!0},null,8,["project-id"]),p(Hu,{"project-id":J(l),onViewUserTransactions:At},null,8,["project-id"])]),p(Ln,{ref_key:"navigationRef",ref:ze,selectedTab:w.value,"onUpdate:selectedTab":H[5]||(H[5]=G=>w.value=G),"can-view-emails":K.value,"can-view-notes":A.value,"can-view-deliverables":I.value,"can-view-seo-reports":ue.value},null,8,["selectedTab","can-view-emails","can-view-notes","can-view-deliverables","can-view-seo-reports"]),w.value===null?(o(),r("div",Bv,[fe.value.length>0?(o(),r("div",Hv,[e("div",Wv,[H[26]||(H[26]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:H[6]||(H[6]=G=>w.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),p(yt,{tasks:fe.value,"project-id":J(l),"show-project-column":!1,onTaskUpdated:Tt,onOpenTaskDetail:rt},null,8,["tasks","project-id"])])):(o(),r("div",Yv,[e("div",zv,[H[27]||(H[27]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Due & Overdue Tasks",-1)),e("button",{onClick:H[7]||(H[7]=G=>w.value="tasks"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Tasks → ")]),H[28]||(H[28]=e("p",{class:"text-gray-400 text-sm"},"No due or overdue tasks.",-1))])),K.value?(o(),r("div",qv,[e("div",Gv,[H[29]||(H[29]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Emails",-1)),e("button",{onClick:H[8]||(H[8]=G=>w.value="emails"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Emails → ")]),(Je=n.value.emails)!=null&&Je.length?(o(),r("div",Jv,[e("table",Zv,[H[31]||(H[31]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Xv,[(o(!0),r(Z,null,ee(at.value,G=>{var Pe;return o(),r("tr",{key:G.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Qv,y(G.subject),1),e("td",ep,y(((Pe=G.sender)==null?void 0:Pe.name)||"N/A"),1),e("td",tp,y(new Date(G.created_at).toLocaleDateString()),1),e("td",sp,[e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-blue-100 text-blue-800":G.type==="sent","bg-purple-100 text-purple-800":G.type==="received"})},y(G.type?G.type.toUpperCase():"N/A"),3)]),e("td",lp,[e("span",{class:te({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":G.status==="sent","bg-yellow-100 text-yellow-800":G.status==="pending_approval","bg-blue-200 text-blue-900":G.status==="pending_approval_received","bg-red-100 text-red-800":G.status==="rejected","bg-gray-100 text-gray-800":G.status==="draft"})},y(G.status.replace("_"," ").toUpperCase()),3)]),e("td",ap,[p(ye,{class:"text-indigo-600 hover:text-indigo-800",onClick:Ft=>se.viewEmail(G)},{default:U(()=>H[30]||(H[30]=[W(" View ",-1)])),_:2,__:[30]},1032,["onClick"])])])}),128))])])])):(o(),r("div",Kv,"No email communication found."))])):T("",!0),A.value?(o(),r("div",ip,[e("div",np,[H[33]||(H[33]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Latest Notes",-1)),e("div",op,[e("button",{onClick:H[9]||(H[9]=G=>w.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View All Notes → "),C.value?(o(),r("div",rp,[p(de,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:H[10]||(H[10]=G=>d.value=!0)},{default:U(()=>H[32]||(H[32]=[W(" Add Note ",-1)])),_:1,__:[32]})])):T("",!0)])]),lt.value.length?(o(),r("div",dp,[(o(!0),r(Z,null,ee(lt.value,G=>{var Pe;return o(),r("div",{key:G.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[e("div",up,[e("div",cp,[e("p",{class:te(["text-sm",{"text-gray-700":G.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":G.content==="[Encrypted content could not be decrypted]"}])},[W(y(G.content)+" ",1),G.content==="[Encrypted content could not be decrypted]"?(o(),r("span",mp," (There was an issue decrypting this note. Please contact an administrator.) ")):T("",!0)],2),e("div",vp,[e("p",pp,"Added by "+y(((Pe=G.user)==null?void 0:Pe.name)||"Unknown")+" on "+y(new Date(G.created_at).toLocaleDateString()),1),G.reply_count>0?(o(),r("span",gp,y(G.reply_count)+" "+y(G.reply_count===1?"reply":"replies"),1)):T("",!0)])]),A.value&&G.chat_message_id&&n.value.google_chat_id?(o(),r("div",hp,[e("button",{onClick:H[11]||(H[11]=Ft=>w.value="notes"),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"}," View ")])):T("",!0)])])}),128))])):(o(),r("p",yp,"No notes available."))])):T("",!0)])):T("",!0),w.value==="tasks"?(o(),X(To,{key:2,ref_key:"tasksTabRef",ref:Ye,"project-id":J(l),"project-users":n.value.users||[],"can-manage-projects":x.value,"tasks-filter":Ke.value,onTasksUpdated:St,onOpenTaskDetailSidebar:rt,onOpenCreateTaskModal:Ut,onFilterChanged:H[12]||(H[12]=G=>Ke.value=G)},null,8,["project-id","project-users","can-manage-projects","tasks-filter"])):T("",!0),w.value==="emails"?(o(),X(hd,{key:3,"project-id":J(l),"can-view-emails":K.value,"can-compose-emails":ie.value,"can-approve-emails":B.value,"user-project-role":J(j),"open-compose":_.value,onEmailsUpdated:jt,onResetOpenCompose:H[13]||(H[13]=G=>_.value=!1)},null,8,["project-id","can-view-emails","can-compose-emails","can-approve-emails","user-project-role","open-compose"])):T("",!0),w.value==="standups"?(o(),X(Ia,{key:4,projectId:J(l),users:n.value.users||[],onStandupAdded:ot},null,8,["projectId","users"])):T("",!0),w.value==="notes"?(o(),X(Zd,{key:5,"project-id":J(l),"google-chat-id":n.value.google_chat_id,"can-view-notes":A.value,"can-add-notes":C.value,onNotesUpdated:nt,onChangeTab:Vt},null,8,["project-id","google-chat-id","can-view-notes","can-add-notes"])):T("",!0),w.value==="deliverables"?(o(),X(Rc,{key:6,"project-id":J(l),"can-create-deliverables":z.value,"can-view-deliverables":I.value,onDeliverablesUpdated:Mt,onOpenDeliverableDetailSidebar:se.handleOpenDeliverableDetailSidebar},null,8,["project-id","can-create-deliverables","can-view-deliverables","onOpenDeliverableDetailSidebar"])):T("",!0),w.value==="seo-reports"?(o(),X(xv,{key:7,"project-id":J(l),"can-create-seo-reports":Me.value,onOpenCreateSeoReportModal:Pt},null,8,["project-id","can-create-seo-reports"])):T("",!0)]))]),p(Ce,{show:c.value,onClose:H[15]||(H[15]=G=>c.value=!1)},{default:U(()=>[p(vs,{show:c.value,project:n.value,statusOptions:D,departmentOptions:R,sourceOptions:L,clientRoleOptions:[],userRoleOptions:[],paymentTypeOptions:[],onClose:H[14]||(H[14]=G=>c.value=!1),onSubmit:Et},null,8,["show","project"])]),_:1},8,["show"]),p(ci,{show:m.value,"project-name":n.value.name,onClose:H[16]||(H[16]=G=>m.value=!1),onSaved:$t,projectId:J(l),projectUsers:n.value.users||[]},null,8,["show","project-name","projectId","projectUsers"]),p(ht,{show:u.value,onClose:H[17]||(H[17]=G=>u.value=!1),onStandupAdded:ot,projectId:J(l)},null,8,["show","projectId"]),p(ft,{show:d.value,"project-id":J(l),onClose:H[18]||(H[18]=G=>d.value=!1),onNoteAdded:nt},null,8,["show","project-id"]),p(fi,{show:v.value,"project-id":J(l),"project-clients":n.value.clients||[],onClose:H[19]||(H[19]=G=>v.value=!1)},null,8,["show","project-id","project-clients"]),p(sc,{show:g.value,"project-id":J(l),"project-name":n.value.name,onClose:H[20]||(H[20]=G=>g.value=!1)},null,8,["show","project-id","project-name"]),p(kt,{show:_.value,"project-id":J(l),"user-project-role":J(j),onClose:Lt,onSubmitted:Ot,onError:H[21]||(H[21]=G=>console.error("Error composing email:",G))},null,8,["show","project-id","user-project-role"]),p(zt,{show:S.value,"project-id":J(l),onClose:H[22]||(H[22]=G=>S.value=!1),onSaved:Nt},null,8,["show","project-id"]),p(Dt,{show:E.value,"project-id":J(l),onClose:H[23]||(H[23]=G=>E.value=!1),onSaved:se.handleDeliverableSaved},null,8,["show","project-id","onSaved"]),p(Tv,{"project-id":J(l),show:$.value,"initial-data":b.value,onClose:H[24]||(H[24]=G=>$.value=!1),onSaved:Rt},null,8,["project-id","show","initial-data"])]}),_:1})],64))}},Vp=Ee(fp,[["__scopeId","data-v-6128d7c0"]]);export{Vp as default};
