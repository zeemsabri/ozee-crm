import{s as S,r as d,c as g,o as u,a as c,e as t,h as v,g as f,b as r,u as w,q as I,t as _,d as V,S as P,k,n as B,p}from"./app-Cq3jf0JG.js";import{_ as A}from"./Checkbox-wniu4RRu.js";import{_ as E}from"./GuestLayout-XkC_Kw35.js";import{_ as y,a as b}from"./InputError-Dzy8YfWP.js";import{P as $}from"./PrimaryButton-DeU3tpPn.js";import{_ as x}from"./TextInput-Ctpb8Vgz.js";import"./ApplicationLogo-B_RBsjdL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const N={key:0,class:"mb-4 text-sm font-medium text-green-600"},R={class:"mt-4"},q={class:"mt-4 block"},z={class:"flex items-center"},C={class:"mt-4 flex items-center justify-end"},L={key:0,class:"mt-4 text-sm text-red-600 text-center"},J={__name:"Login",props:{canResetPassword:{type:Boolean,default:!1},status:{type:String,default:""}},setup(i){const a=S({email:"",password:"",remember:!1}),l=d({}),m=d(""),n=d(!1),h=async()=>{n.value=!0,l.value={},m.value="";try{const s=await p.post("/api/login",a),e=s.data.token,o=s.data.user;localStorage.setItem("authToken",e),localStorage.setItem("userRole",o.role),localStorage.setItem("userId",o.id),localStorage.setItem("userEmail",o.email),localStorage.setItem("remembered",a.remember?"true":"false"),p.defaults.headers.common.Authorization=`Bearer ${e}`,window.location.href=route("dashboard")}catch(s){s.response?s.response.status===422?l.value=s.response.data.errors:s.response.data.message?m.value=s.response.data.message:(m.value="An unexpected API error occurred.",console.error("API Error during login:",s.response.data)):(m.value="An unexpected error occurred during login. Please check your network connection.",console.error("Network or client-side error during login:",s)),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete p.defaults.headers.common.Authorization}finally{n.value=!1,a.reset("password")}};return(s,e)=>(u(),g(E,null,{default:c(()=>[t(w(I),{title:"Log in"}),i.status?(u(),v("div",N,_(i.status),1)):f("",!0),r("form",{onSubmit:V(h,["prevent"])},[r("div",null,[t(y,{for:"email",value:"Email"}),t(x,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:a.email,"onUpdate:modelValue":e[0]||(e[0]=o=>a.email=o),required:"",autofocus:"",autocomplete:"username"},null,8,["modelValue"]),t(b,{class:"mt-2",message:l.value.email?l.value.email[0]:""},null,8,["message"])]),r("div",R,[t(y,{for:"password",value:"Password"}),t(x,{id:"password",type:"password",class:"mt-1 block w-full",modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=o=>a.password=o),required:"",autocomplete:"current-password"},null,8,["modelValue"]),t(b,{class:"mt-2",message:l.value.password?l.value.password[0]:""},null,8,["message"])]),r("div",q,[r("label",z,[t(A,{name:"remember",checked:a.remember,"onUpdate:checked":e[2]||(e[2]=o=>a.remember=o)},null,8,["checked"]),e[3]||(e[3]=r("span",{class:"ms-2 text-sm text-gray-600"},"Remember me",-1))])]),r("div",C,[i.canResetPassword?(u(),g(w(P),{key:0,href:s.route("password.request"),class:"rounded-md text-sm text-gray-600 underline hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},{default:c(()=>e[4]||(e[4]=[k(" Forgot your password? ")])),_:1,__:[4]},8,["href"])):f("",!0),t($,{class:B(["ms-4",{"opacity-25":n.value}]),disabled:n.value},{default:c(()=>e[5]||(e[5]=[k(" Log in ")])),_:1,__:[5]},8,["class","disabled"])]),m.value?(u(),v("div",L,_(m.value),1)):f("",!0)],32)]),_:1}))}};export{J as default};
