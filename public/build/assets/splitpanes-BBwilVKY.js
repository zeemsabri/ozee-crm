import{aV as re,r as M,d as x,w as R,I as Y,b as W,q as ve,aU as P,o as X,L as me,aS as g,aW as de,c as ce,Y as pe,l as ze,u as he,p as q,ab as xe}from"./app-D7QPKPE4.js";const Se={__name:"splitpanes",props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click"],setup(B,{emit:b}){const v=b,r=B,N=re(),l=M([]),w=x(()=>l.value.reduce((e,n)=>(e[~~n.id]=n)&&e,{})),h=x(()=>l.value.length),c=M(null),f=M(!1),m=M({mouseDown:!1,dragging:!1,activeSplitter:null,cursorOffset:0}),z=M({splitter:null,timeoutId:null}),E=x(()=>({[`splitpanes splitpanes--${r.horizontal?"horizontal":"vertical"}`]:!0,"splitpanes--dragging":m.value.dragging})),y=()=>{document.addEventListener("mousemove",o,{passive:!1}),document.addEventListener("mouseup",S),"ontouchstart"in window&&(document.addEventListener("touchmove",o,{passive:!1}),document.addEventListener("touchend",S))},_=()=>{document.removeEventListener("mousemove",o,{passive:!1}),document.removeEventListener("mouseup",S),"ontouchstart"in window&&(document.removeEventListener("touchmove",o,{passive:!1}),document.removeEventListener("touchend",S))},L=(e,n)=>{const i=e.target.closest(".splitpanes__splitter");if(i){const{left:a,top:t}=i.getBoundingClientRect(),{clientX:s,clientY:u}="ontouchstart"in window&&e.touches?e.touches[0]:e;m.value.cursorOffset=r.horizontal?u-t:s-a}y(),m.value.mouseDown=!0,m.value.activeSplitter=n},o=e=>{m.value.mouseDown&&(e.preventDefault(),m.value.dragging=!0,requestAnimationFrame(()=>{J(V(e)),v("resize",l.value.map(n=>({min:n.min,max:n.max,size:n.size})))}))},S=()=>{m.value.dragging&&v("resized",l.value.map(e=>({min:e.min,max:e.max,size:e.size}))),m.value.mouseDown=!1,setTimeout(()=>{m.value.dragging=!1,_()},100)},C=(e,n)=>{"ontouchstart"in window&&(e.preventDefault(),r.dblClickSplitter&&(z.value.splitter===n?(clearTimeout(z.value.timeoutId),z.value.timeoutId=null,D(e,n),z.value.splitter=null):(z.value.splitter=n,z.value.timeoutId=setTimeout(()=>z.value.splitter=null,500)))),m.value.dragging||v("splitter-click",l.value[n])},D=(e,n)=>{let i=0;l.value=l.value.map((a,t)=>(a.size=t===n?a.max:a.min,t!==n&&(i+=a.min),a)),l.value[n].size-=i,v("pane-maximize",l.value[n]),v("resized",l.value.map(a=>({min:a.min,max:a.max,size:a.size})))},j=(e,n)=>{v("pane-click",w.value[n])},V=e=>{const n=c.value.getBoundingClientRect(),{clientX:i,clientY:a}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:i-(r.horizontal?0:m.value.cursorOffset)-n.left,y:a-(r.horizontal?m.value.cursorOffset:0)-n.top}},H=e=>{e=e[r.horizontal?"y":"x"];const n=c.value[r.horizontal?"clientHeight":"clientWidth"];return r.rtl&&!r.horizontal&&(e=n-e),e*100/n},J=e=>{const n=m.value.activeSplitter;let i={prevPanesSize:T(n),nextPanesSize:k(n),prevReachedMinPanes:0,nextReachedMinPanes:0};const a=0+(r.pushOtherPanes?0:i.prevPanesSize),t=100-(r.pushOtherPanes?0:i.nextPanesSize),s=Math.max(Math.min(H(e),t),a);let u=[n,n+1],d=l.value[u[0]]||null,p=l.value[u[1]]||null;const F=d.max<100&&s>=d.max+i.prevPanesSize,oe=p.max<100&&s<=100-(p.max+k(n+1));if(F||oe){F?(d.size=d.max,p.size=Math.max(100-d.max-i.prevPanesSize-i.nextPanesSize,0)):(d.size=Math.max(100-p.max-i.prevPanesSize-k(n+1),0),p.size=p.max);return}if(r.pushOtherPanes){const U=K(i,s);if(!U)return;({sums:i,panesToResize:u}=U),d=l.value[u[0]]||null,p=l.value[u[1]]||null}d!==null&&(d.size=Math.min(Math.max(s-i.prevPanesSize-i.prevReachedMinPanes,d.min),d.max)),p!==null&&(p.size=Math.min(Math.max(100-s-i.nextPanesSize-i.nextReachedMinPanes,p.min),p.max))},K=(e,n)=>{const i=m.value.activeSplitter,a=[i,i+1];return n<e.prevPanesSize+l.value[a[0]].min&&(a[0]=Q(i).index,e.prevReachedMinPanes=0,a[0]<i&&l.value.forEach((t,s)=>{s>a[0]&&s<=i&&(t.size=t.min,e.prevReachedMinPanes+=t.min)}),e.prevPanesSize=T(a[0]),a[0]===void 0)?(e.prevReachedMinPanes=0,l.value[0].size=l.value[0].min,l.value.forEach((t,s)=>{s>0&&s<=i&&(t.size=t.min,e.prevReachedMinPanes+=t.min)}),l.value[a[1]].size=100-e.prevReachedMinPanes-l.value[0].min-e.prevPanesSize-e.nextPanesSize,null):n>100-e.nextPanesSize-l.value[a[1]].min&&(a[1]=Z(i).index,e.nextReachedMinPanes=0,a[1]>i+1&&l.value.forEach((t,s)=>{s>i&&s<a[1]&&(t.size=t.min,e.nextReachedMinPanes+=t.min)}),e.nextPanesSize=k(a[1]-1),a[1]===void 0)?(e.nextReachedMinPanes=0,l.value.forEach((t,s)=>{s<h.value-1&&s>=i+1&&(t.size=t.min,e.nextReachedMinPanes+=t.min)}),l.value[a[0]].size=100-e.prevPanesSize-k(a[0]-1),null):{sums:e,panesToResize:a}},T=e=>l.value.reduce((n,i,a)=>n+(a<e?i.size:0),0),k=e=>l.value.reduce((n,i,a)=>n+(a>e+1?i.size:0),0),Q=e=>[...l.value].reverse().find(n=>n.index<e&&n.size>n.min)||{},Z=e=>l.value.find(n=>n.index>e+1&&n.size>n.min)||{},G=()=>{var e;Array.from(((e=c.value)==null?void 0:e.children)||[]).forEach(n=>{const i=n.classList.contains("splitpanes__pane"),a=n.classList.contains("splitpanes__splitter");!i&&!a&&(n.remove(),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))})},$=(e,n,i=!1)=>{const a=e-1,t=document.createElement("div");t.classList.add("splitpanes__splitter"),i||(t.onmousedown=s=>L(s,a),typeof window<"u"&&"ontouchstart"in window&&(t.ontouchstart=s=>L(s,a)),t.onclick=s=>C(s,a+1)),r.dblClickSplitter&&(t.ondblclick=s=>D(s,a+1)),n.parentNode.insertBefore(t,n)},ee=e=>{e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.remove()},O=()=>{var e;const n=Array.from(((e=c.value)==null?void 0:e.children)||[]);n.forEach(a=>{a.className.includes("splitpanes__splitter")&&ee(a)});let i=0;n.forEach(a=>{a.className.includes("splitpanes__pane")&&(!i&&r.firstSplitter?$(i,a,!0):i&&$(i,a),i++)})},ae=({uid:e,...n})=>{const i=w.value[e];Object.entries(n).forEach(([a,t])=>i[a]=t)},ne=e=>{var n;let i=-1;Array.from(((n=c.value)==null?void 0:n.children)||[]).some(a=>(a.className.includes("splitpanes__pane")&&i++,a.isSameNode(e.el))),l.value.splice(i,0,{...e,index:i}),l.value.forEach((a,t)=>a.index=t),f.value&&q(()=>{O(),A({addedPane:l.value[i]}),v("pane-add",{index:i,panes:l.value.map(a=>({min:a.min,max:a.max,size:a.size}))})})},ie=e=>{const n=l.value.findIndex(a=>a.id===e),i=l.value.splice(n,1)[0];l.value.forEach((a,t)=>a.index=t),q(()=>{O(),A({removedPane:{...i}}),v("pane-remove",{removed:i,panes:l.value.map(a=>({min:a.min,max:a.max,size:a.size}))})})},A=(e={})=>{!e.addedPane&&!e.removedPane?le():l.value.some(n=>n.givenSize!==null||n.min||n.max<100)?se(e):te(),f.value&&v("resized",l.value.map(n=>({min:n.min,max:n.max,size:n.size})))},te=()=>{const e=100/h.value;let n=0;const i=[],a=[];l.value.forEach(t=>{t.size=Math.max(Math.min(e,t.max),t.min),n-=t.size,t.size>=t.max&&i.push(t.id),t.size<=t.min&&a.push(t.id)}),n>.1&&I(n,i,a)},le=()=>{let e=100;const n=[],i=[];let a=0;l.value.forEach(s=>{e-=s.size,s.givenSize!==null&&a++,s.size>=s.max&&n.push(s.id),s.size<=s.min&&i.push(s.id)});let t=100;e>.1&&(l.value.forEach(s=>{s.givenSize===null&&(s.size=Math.max(Math.min(e/(h.value-a),s.max),s.min)),t-=s.size}),t>.1&&I(t,n,i))},se=({addedPane:e,removedPane:n}={})=>{let i=100/h.value,a=0;const t=[],s=[];((e==null?void 0:e.givenSize)??null)!==null&&(i=(100-e.givenSize)/(h.value-1).value),l.value.forEach(u=>{a-=u.size,u.size>=u.max&&t.push(u.id),u.size<=u.min&&s.push(u.id)}),!(Math.abs(a)<.1)&&(l.value.forEach(u=>{(e==null?void 0:e.givenSize)!==null&&(e==null?void 0:e.id)===u.id||(u.size=Math.max(Math.min(i,u.max),u.min)),a-=u.size,u.size>=u.max&&t.push(u.id),u.size<=u.min&&s.push(u.id)}),a>.1&&I(a,t,s))},I=(e,n,i)=>{let a;e>0?a=e/(h.value-n.length):a=e/(h.value-i.length),l.value.forEach((t,s)=>{if(e>0&&!n.includes(t.id)){const u=Math.max(Math.min(t.size+a,t.max),t.min),d=u-t.size;e-=d,t.size=u}else if(!i.includes(t.id)){const u=Math.max(Math.min(t.size+a,t.max),t.min),d=u-t.size;e-=d,t.size=u}}),Math.abs(e)>.1&&q(()=>{f.value&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})};R(()=>r.firstSplitter,()=>O()),R(()=>r.dblClickSplitter,e=>{[...c.value.querySelectorAll(".splitpanes__splitter")].forEach((n,i)=>{n.ondblclick=e?a=>D(a,i):void 0})}),Y(()=>f.value=!1),W(()=>{G(),O(),A(),v("ready"),f.value=!0});const ue=()=>{var e;return xe("div",{ref:c,class:E.value},(e=N.default)==null?void 0:e.call(N))};return P("panes",l),P("indexedPanes",w),P("horizontal",x(()=>r.horizontal)),P("requestUpdate",ae),P("onPaneAdd",ne),P("onPaneRemove",ie),P("onPaneClick",j),(e,n)=>(X(),ve(me(ue)))}},Pe={__name:"pane",props:{size:{type:[Number,String]},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},setup(B){var b;const v=B,r=g("requestUpdate"),N=g("onPaneAdd"),l=g("horizontal"),w=g("onPaneRemove"),h=g("onPaneClick"),c=(b=de())==null?void 0:b.uid,f=g("indexedPanes"),m=x(()=>f.value[c]),z=M(null),E=x(()=>{const o=isNaN(v.size)||v.size===void 0?0:parseFloat(v.size);return Math.max(Math.min(o,_.value),y.value)}),y=x(()=>{const o=parseFloat(v.minSize);return isNaN(o)?0:o}),_=x(()=>{const o=parseFloat(v.maxSize);return isNaN(o)?100:o}),L=x(()=>{var o;return`${l.value?"height":"width"}: ${(o=m.value)==null?void 0:o.size}%`});return W(()=>{N({id:c,el:z.value,min:y.value,max:_.value,givenSize:v.size===void 0?null:E.value,size:E.value})}),R(()=>E.value,o=>r({uid:c,size:o})),R(()=>y.value,o=>r({uid:c,min:o})),R(()=>_.value,o=>r({uid:c,max:o})),Y(()=>w(c)),(o,S)=>(X(),ce("div",{ref_key:"paneEl",ref:z,class:"splitpanes__pane",onClick:S[0]||(S[0]=C=>he(h)(C,o._.uid)),style:ze(L.value)},[pe(o.$slots,"default")],4))}};export{Pe as P,Se as S};
