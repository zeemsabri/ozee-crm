import{r as A,s as B,K as Se,B as he,J as je,i as r,g as h,o as s,F as Y,j as K,b as t,t as j,h as D,L as Je,M as mt,N as Ye,O as Ke,p as U,w as Q,c as E,a as x,d as De,f as Z,l as vt,m as C,e as m,k as de,x as H,P as Ie,G as pt,I as ye,A as re,Q as se,R as G,S as Ae,z as Ee,D as gt,T as Ze,U as ft,V as ze,W as ce,n as ie,X as Ge,Y as Ve,Z as Ue,_ as me,$ as te,a0 as ue,a1 as Ne,a2 as yt,a3 as ht,a4 as Fe,q as kt}from"./app-Bgd6iDAB.js";import{P as X}from"./PrimaryButton-kIXwQJMs.js";import{_ as Be}from"./Modal-CD4V3PzR.js";import{_ as L}from"./InputLabel-DQe11bRh.js";import{_ as O}from"./InputError-CJ8kbWI8.js";import{_ as Te}from"./SecondaryButton-CkynaBuf.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as le}from"./TextInput-BVsxDbiC.js";import{S as oe}from"./SelectDropdown-CRu9ReRj.js";import{_ as bt}from"./Checkbox-CSPke42J.js";import{A as wt}from"./ApplicationLogo-5PFqNgpE.js";import{D as Le}from"./DangerButton-C46C-kxq.js";import{h as xt}from"./moment-BLMuvzoS.js";const _t={key:0,class:"fixed bottom-4 right-4 z-50 flex flex-col items-end space-y-2"},$t={key:0,class:"notification-list w-full max-w-xs space-y-2"},Ct={class:"flex-1 min-w-0"},St={class:"flex items-start justify-between gap-2 mb-1"},Tt={class:"flex-1 min-w-0"},It={key:0,class:"text-base font-semibold text-gray-800 truncate"},At={key:1,class:"text-xs text-gray-500"},jt={key:0,class:"text-xs text-gray-600 mb-2"},Dt={class:"flex items-center justify-between mt-2"},Et={key:0,class:"text-xs text-gray-500 font-medium"},Mt=["onClick"],Pt={key:1,class:"flex justify-end w-full max-w-xs"},Nt={key:0},Vt={key:1},ge="notification_minimized_state",Ut=3,Bt={__name:"PushNotificationContainer",props:{sidebarIsOpen:{type:Boolean,default:!1}},setup(a){const o=A(!1),n=A(null),d=A(0),e=A(null),g=B(()=>Se.value.notifications.filter(y=>y.isNewPush).slice(0,Ut)),u=B(()=>{const y=Math.floor(d.value/60),I=d.value%60;return`${String(y).padStart(2,"0")}:${String(I).padStart(2,"0")}`}),p=y=>{if(!y)return null;const I=y.match(/\/task\/(\d+)/);return I?parseInt(I[1]):null},v=y=>{if(!y)return null;const I=y.match(/\/project\/(\d+)\//);return I?parseInt(I[1]):null},i=()=>{if(o.value=!o.value,clearTimeout(n.value),clearInterval(e.value),o.value){const y=Date.now()+3e5;localStorage.setItem(ge,JSON.stringify({isMinimized:!0,expiryTime:y})),n.value=setTimeout(()=>{o.value=!1,clearInterval(e.value),localStorage.removeItem(ge)},3e5),d.value=300,e.value=setInterval(()=>{d.value>0?d.value--:clearInterval(e.value)},1e3)}else localStorage.removeItem(ge)},b=async y=>{mt(y.id),await Ye(y.view_id);const I=y.task_id||p(y.url),P=y.project_id||v(y.url);I&&P?Ke(I,P):(console.warn("Could not open task sidebar. Falling back to redirecting."),y.url&&(window.location.href=y.url))};return he(()=>{const y=localStorage.getItem(ge);if(y)try{const{isMinimized:I,expiryTime:P}=JSON.parse(y),T=Date.now(),k=P-T;k>0?(o.value=I,d.value=Math.floor(k/1e3),n.value=setTimeout(()=>{o.value=!1,clearInterval(e.value),localStorage.removeItem(ge)},k),e.value=setInterval(()=>{d.value>0?d.value--:clearInterval(e.value)},1e3)):localStorage.removeItem(ge)}catch(I){console.error("Error restoring notification minimized state:",I),localStorage.removeItem(ge)}}),je(()=>{clearTimeout(n.value),clearInterval(e.value)}),(y,I)=>a.sidebarIsOpen?h("",!0):(s(),r("div",_t,[!o.value&&g.value.length>0?(s(),r("div",$t,[(s(!0),r(Y,null,K(g.value,P=>(s(),r("div",{key:P.id,class:"bg-white rounded-lg shadow-lg p-3 flex items-start space-x-3 border border-gray-200 transition-opacity duration-300 opacity-60 hover:opacity-100"},[t("div",Ct,[t("div",St,[t("div",Tt,[P.title?(s(),r("h3",It,j(P.title),1)):h("",!0),P.project_name?(s(),r("p",At,j(P.project_name),1)):h("",!0)])]),P.message?(s(),r("p",jt,j(P.message),1)):h("",!0),t("div",Dt,[P.due_date?(s(),r("div",Et," Due: "+j(D(Je)(P.due_date)),1)):h("",!0),t("button",{onClick:T=>b(P),class:"px-2.5 py-1 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 transition-colors duration-200 shadow"},j(P.button_label||"View"),9,Mt)])])]))),128))])):h("",!0),g.value.length>0?(s(),r("div",Pt,[t("button",{onClick:i,class:"bg-white/80 backdrop-blur-sm text-gray-600 hover:text-gray-900 text-xs font-bold py-1 px-3 rounded-full shadow-md transition-all duration-300"},[o.value?(s(),r("span",Nt,"Show ("+j(u.value)+")",1)):(s(),r("span",Vt,"Minimize"))])])):h("",!0)]))}},Lt={class:"fixed top-4 right-4 z-[100] flex flex-col items-end space-y-3"},Rt={class:"p-4"},zt={class:"text-sm font-medium text-white"},Ft={__name:"StandardNotificationContainer",setup(a,{expose:o}){const n=A([]),d=(u,p="info",v=5e3)=>{const i=crypto.randomUUID();n.value.unshift({id:i,message:u,type:p}),setTimeout(()=>{e(i)},v)},e=u=>{const p=n.value.findIndex(v=>v.id===u);p>-1&&n.value.splice(p,1)},g=u=>{switch(u){case"success":return"bg-green-500";case"error":return"bg-red-500";case"warning":return"bg-yellow-500";case"info":default:return"bg-blue-500"}};return o({addNotification:d}),(u,p)=>(s(),r("div",Lt,[(s(!0),r(Y,null,K(n.value,v=>(s(),r("div",{key:v.id,class:U(["w-full max-w-sm rounded-md shadow-lg pointer-events-auto",g(v.type)])},[t("div",Rt,[t("p",zt,j(v.message),1)])],2))),128))]))}},Wt={class:"p-6"},Ot={class:"mt-6"},qt={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},Ht={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},Jt={class:"flex items-center mb-3"},Yt=["id","onUpdate:modelValue"],Kt=["for"],Zt={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},Gt={key:0},Qt={class:"mb-4"},Xt={class:"flex items-center"},es=["id","checked","onChange"],ts=["for"],ss={key:0,class:"mb-4"},as=["id","onUpdate:modelValue"],os={key:1,class:"mb-4"},ls={class:"flex-1"},rs=["id","onUpdate:modelValue"],ns={class:"flex-1"},is=["id","onUpdate:modelValue"],ds={key:0,class:"flex items-end pb-1"},us=["onClick"],cs=["onClick"],ms={class:"mt-6 flex justify-end space-x-3"},vs={key:0,class:"flex items-center"},ps={key:1},gs={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(a,{emit:o}){const n=()=>{const $=localStorage.getItem("authToken");$&&!H.defaults.headers.common.Authorization&&(H.defaults.headers.common.Authorization=`Bearer ${$}`,console.log("Auth headers set in AvailabilityModal"))},d=a,e=o,g=A({}),u=A({}),p=A(!1),v=A(""),i=()=>{const $=[],f=new Date,l=new Date(f);l.setDate(f.getDate()+1);for(let c=0;c<7;c++){const w=new Date(l);w.setDate(l.getDate()+c);const S=w.toISOString().split("T")[0];$.push({value:S,label:w.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),g.value[S]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return $},b=A([]);he(()=>{n(),d.nextWeekDates.length>0?(b.value=d.nextWeekDates,d.nextWeekDates.forEach($=>{g.value[$.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):b.value=i()});const y=async()=>{try{if(n(),b.value.length===0)return;const $=b.value[0].value,f=b.value[b.value.length-1].value,l=await H.get("/api/availabilities",{params:{start_date:$,end_date:f,user_id:d.userId}});if(l.data&&l.data.availabilities){const c=l.data.availabilities;b.value.forEach(w=>{g.value[w.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),c.forEach(w=>{const S=w.date.split("T")[0];g.value[S]&&(g.value[S].isSelected=!0,g.value[S].isAvailable=w.is_available,w.is_available?g.value[S].timeSlots=w.time_slots&&w.time_slots.length>0?[...w.time_slots]:[{start_time:"",end_time:""}]:g.value[S].reason=w.reason||"")})}}catch($){console.error("Error fetching existing availabilities:",$),b.value.forEach(f=>{g.value[f.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};Q(()=>d.show,async $=>{$&&(u.value={},v.value="",await y())},{immediate:!0});const I=$=>{g.value[$].timeSlots.push({start_time:"",end_time:""})},P=($,f)=>{g.value[$].timeSlots.length>1&&g.value[$].timeSlots.splice(f,1)},T=($,f)=>{g.value[$].isAvailable=f,f?g.value[$].reason="":g.value[$].timeSlots=[{start_time:"",end_time:""}]},k=async()=>{p.value=!0,u.value={},v.value="";const $=[];let f=!1;for(const l of b.value){const c=l.value,w=g.value[c];if(w.isSelected){let S={};if(w.isAvailable)if(w.timeSlots.some(N=>!N.start_time||!N.end_time))S.timeSlots="Please fill in all time slots.",f=!0;else for(const N of w.timeSlots){const q=N.start_time.split(":").map(Number),ne=N.end_time.split(":").map(Number);if(q.length!==2||ne.length!==2||isNaN(q[0])||isNaN(q[1])||isNaN(ne[0])||isNaN(ne[1])){S.timeSlots="Invalid time format. Please use HH:MM format.",f=!0;break}const W=q[0]*60+q[1],V=ne[0]*60+ne[1];if(W>=V){S.timeSlots="End time must be after start time.",f=!0;break}}else w.reason.trim()||(S.reason="Please provide a reason for unavailability.",f=!0);Object.keys(S).length>0&&(u.value[c]=S),Object.keys(S).length===0&&$.push({date:c,is_available:w.isAvailable,reason:w.isAvailable?null:w.reason,time_slots:w.isAvailable?w.timeSlots:null})}}if(f){p.value=!1,u.value.general="Please correct the errors in the highlighted dates.";return}if($.length===0){u.value.general="Please select at least one day to set availability for.",p.value=!1;return}try{n();const l=await H.post("/api/availabilities/batch",{availabilities:$});v.value="Availability saved successfully!";try{const c=await H.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",c.data.should_block_user),localStorage.setItem("allWeekdaysCovered",c.data.all_weekdays_covered);const w=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:c.data.should_block_user,allWeekdaysCovered:c.data.all_weekdays_covered}});window.dispatchEvent(w),console.log("Availability status updated from modal:",{shouldBlockUser:c.data.should_block_user,allWeekdaysCovered:c.data.all_weekdays_covered})}catch(c){console.error("Error updating availability status:",c)}e("availability-saved",l.data.availabilities),setTimeout(()=>{e("close")},1500)}catch(l){console.error("Error saving availability:",l),l.response&&l.response.data&&l.response.data.errors?u.value.general=l.response.data.message||"An error occurred while saving your availability.":l.response&&l.response.status===409?(v.value=l.response.data.message,setTimeout(()=>{e("close")},1500)):u.value.general="An unexpected error occurred while saving your availability."}finally{p.value=!1}};return($,f)=>(s(),E(Be,{show:a.show,onClose:f[1]||(f[1]=l=>$.$emit("close")),"max-width":"xl"},{default:x(()=>[t("div",Wt,[f[6]||(f[6]=t("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),f[7]||(f[7]=t("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),t("div",Ot,[t("form",{onSubmit:De(k,["prevent"])},[v.value?(s(),r("div",qt,j(v.value),1)):h("",!0),u.value.general?(s(),r("div",Ht,j(u.value.general),1)):h("",!0),(s(!0),r(Y,null,K(b.value,l=>{var c,w;return s(),r("div",{key:l.value,class:U(["mb-6 p-4 border rounded-lg shadow-sm",[g.value[l.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",g.value[l.value].isSelected&&!u.value[l.value]?"border-l-4 border-l-indigo-500":""]])},[t("div",Jt,[Z(t("input",{type:"checkbox",id:`select_date_${l.value}`,"onUpdate:modelValue":S=>g.value[l.value].isSelected=S,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,Yt),[[vt,g.value[l.value].isSelected]]),t("label",{for:`select_date_${l.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[C(j(l.label)+" ",1),g.value[l.value].isSelected?(s(),r("span",Zt," Saved ")):h("",!0)],8,Kt)]),g.value[l.value].isSelected?(s(),r("div",Gt,[t("div",Qt,[t("div",Xt,[t("input",{type:"checkbox",id:`isAvailableToggle_${l.value}`,checked:g.value[l.value].isAvailable,onChange:S=>T(l.value,S.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,es),t("label",{for:`isAvailableToggle_${l.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,ts)])]),g.value[l.value].isAvailable?h("",!0):(s(),r("div",ss,[m(L,{for:`reason_${l.value}`,value:"Reason for Not Available"},null,8,["for"]),Z(t("textarea",{id:`reason_${l.value}`,"onUpdate:modelValue":S=>g.value[l.value].reason=S,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,as),[[de,g.value[l.value].reason]]),m(O,{message:(c=u.value[l.value])==null?void 0:c.reason,class:"mt-2"},null,8,["message"])])),g.value[l.value].isAvailable?(s(),r("div",os,[m(L,{value:"Available Time Slots"}),m(O,{message:(w=u.value[l.value])==null?void 0:w.timeSlots,class:"mt-2"},null,8,["message"]),(s(!0),r(Y,null,K(g.value[l.value].timeSlots,(S,N)=>(s(),r("div",{key:N,class:"flex items-center space-x-2 mt-2"},[t("div",ls,[m(L,{for:`start_time_${l.value}_${N}`,value:"Start Time",class:"text-xs"},null,8,["for"]),Z(t("input",{id:`start_time_${l.value}_${N}`,type:"time","onUpdate:modelValue":q=>S.start_time=q,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,rs),[[de,S.start_time]])]),t("div",ns,[m(L,{for:`end_time_${l.value}_${N}`,value:"End Time",class:"text-xs"},null,8,["for"]),Z(t("input",{id:`end_time_${l.value}_${N}`,type:"time","onUpdate:modelValue":q=>S.end_time=q,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,is),[[de,S.end_time]])]),g.value[l.value].timeSlots.length>1?(s(),r("div",ds,[t("button",{type:"button",onClick:q=>P(l.value,N),class:"p-2 text-red-600 hover:text-red-800"},f[2]||(f[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,us)])):h("",!0)]))),128)),t("button",{type:"button",onClick:S=>I(l.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},f[3]||(f[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),C(" Add Another Time Slot ",-1)]),8,cs)])):h("",!0)])):h("",!0)],2)}),128)),t("div",ms,[m(Te,{onClick:f[0]||(f[0]=l=>$.$emit("close"))},{default:x(()=>f[4]||(f[4]=[C(" Cancel ",-1)])),_:1,__:[4]}),m(X,{disabled:p.value,class:U({"opacity-50":p.value})},{default:x(()=>[p.value?(s(),r("span",vs,f[5]||(f[5]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),C(" Saving... ",-1)]))):(s(),r("span",ps,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},fs={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},ys={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},hs={class:"flex justify-center"},ks={__name:"AvailabilityBlocker",setup(a){const o=A(!1),n=A(!0),d=A(!1),e=A([]),g=B(()=>{var k;return((k=Ie().props.auth.user)==null?void 0:k.id)||null}),u=()=>{const k=localStorage.getItem("authToken");k&&!H.defaults.headers.common.Authorization&&(H.defaults.headers.common.Authorization=`Bearer ${k}`)},p=async()=>{n.value=!0;const k=localStorage.getItem("shouldBlockUser"),$=localStorage.getItem("allWeekdaysCovered");if(k==="true"&&$==="false")o.value=!0,await v();else try{u();const f=await H.get("/api/availability-prompt");o.value=f.data.should_block_user&&!f.data.all_weekdays_covered,o.value&&await v()}catch(f){console.error("Error checking if user should be blocked:",f),o.value=!1}n.value=!1},v=async()=>{try{u();const k=await H.get("/api/availability-prompt");i(k.data.next_week_start,k.data.next_week_end)}catch(k){console.error("Error fetching next week dates:",k)}},i=(k,$)=>{const f=[],l=new Date(k),c=new Date($),w=new Date(l);for(;w<=c;)f.push({value:w.toISOString().split("T")[0],label:w.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),w.setDate(w.getDate()+1);e.value=f},b=()=>{d.value=!0},y=()=>{p()},I=k=>{o.value=k.detail.shouldBlockUser&&!k.detail.allWeekdaysCovered},P=()=>{document.visibilityState==="visible"&&ye(()=>{p()})},T=k=>{(k.key==="shouldBlockUser"||k.key==="allWeekdaysCovered")&&ye(()=>{p()})};return he(()=>{p(),window.addEventListener("availability-status-updated",I),document.addEventListener("visibilitychange",P),window.addEventListener("storage",T)}),je(()=>{window.removeEventListener("availability-status-updated",I),document.removeEventListener("visibilitychange",P),window.removeEventListener("storage",T)}),(k,$)=>o.value&&!n.value?(s(),r("div",fs,[t("div",ys,[$[2]||($[2]=pt('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),t("div",hs,[m(X,{onClick:b,class:"bg-red-600 hover:bg-red-700"},{default:x(()=>$[1]||($[1]=[C(" Submit Availability Now ",-1)])),_:1,__:[1]})]),m(gs,{show:d.value,"next-week-dates":e.value,date:e.value.length>0?e.value[0].value:"",userId:g.value,onClose:$[0]||($[0]=f=>d.value=!1),onAvailabilitySaved:y},null,8,["show","next-week-dates","date","userId"])])])):h("",!0)}},bs={class:"p-6"},ws={class:"flex justify-between items-center mb-4"},xs={class:"text-lg font-medium text-gray-900"},_s={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},$s={class:"block sm:inline"},Cs={key:0,class:"mt-6 flex justify-end space-x-3"},Ss={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:a=>["post","put","patch","delete"].includes(a.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:a=>a},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(a,{emit:o}){const n=a,d=o,e=A(!1),g=A({}),u=A("");Q(()=>n.show,i=>{i&&(g.value={},u.value="",e.value=!1)});const p=async()=>{e.value=!0,g.value={},u.value="";try{const i=n.formatDataForApi(n.formData);let b;const y=n.httpMethod.toLowerCase();if(y==="post")b=await window.axios.post(n.apiEndpoint,i);else if(y==="put")b=await window.axios.put(n.apiEndpoint,i);else if(y==="patch")b=await window.axios.patch(n.apiEndpoint,i);else if(y==="delete")b=await window.axios.delete(n.apiEndpoint,{data:i});else throw new Error(`Unsupported HTTP method: ${n.httpMethod}`);se(n.successMessage),d("submitted",b.data),d("close")}catch(i){console.error("API submission error:",i),i.response?i.response.status===422?(g.value=i.response.data.errors,u.value="Please correct the errors in the form."):u.value=i.response.data.message||"An unexpected error occurred.":u.value="A network error occurred or the server is unreachable.",G(u.value),d("error",i)}finally{e.value=!1}},v=()=>{d("close")};return(i,b)=>(s(),E(Be,{show:a.show,onClose:v},{default:x(()=>[t("div",bs,[t("div",ws,[t("h2",xs,j(a.title),1),t("button",{onClick:v,class:"text-gray-400 hover:text-gray-500"},b[0]||(b[0]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),u.value?(s(),r("div",_s,[t("span",$s,j(u.value),1)])):h("",!0),t("form",{onSubmit:De(p,["prevent"])},[re(i.$slots,"default",{errors:g.value},void 0,!0),a.showFooter?(s(),r("div",Cs,[m(Te,{onClick:v,type:"button",disabled:e.value},{default:x(()=>b[1]||(b[1]=[C(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),m(X,{type:"submit",disabled:e.value,class:U({"opacity-75 cursor-not-allowed":e.value})},{default:x(()=>[C(j(e.value?"Submitting...":a.submitButtonText),1)]),_:1},8,["disabled","class"])])):h("",!0)],32)])]),_:3},8,["show"]))}},Me=ke(Ss,[["__scopeId","data-v-380ca613"]]),Ts=(a,o)=>{let n;return(...d)=>{clearTimeout(n),n=setTimeout(()=>a(...d),o)}},Is={class:"relative"},As={class:"flex flex-wrap items-center gap-2 mb-2 p-2 border border-gray-300 rounded-lg bg-white min-h-[44px] focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500 transition-all duration-150"},js=["onClick"],Ds={key:0,class:"absolute z-20 w-full bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto mt-1 transform-gpu"},Es=["onClick"],Ms={key:1,class:"px-4 py-2 text-sm text-gray-500"},Ps={key:2,class:"px-4 py-2 text-sm text-gray-500"},Ns={__name:"TagInput",props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:"Tags"},placeholder:{type:String,default:"Add tags..."},error:{type:String,default:""},initialTags:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(a,{emit:o}){const n=a,d=o,e=A(""),g=A([]),u=A([]),p=A(!1),v=A(null);function i(){d("update:modelValue",u.value.map(f=>f.id))}Q(()=>n.initialTags,f=>{if(u.value=[],f&&f.length>0){const S=[],N=new Set;f.forEach(q=>{N.has(q.id)||(S.push(q),N.add(q.id))}),u.value.push(...S)}const l=f.map(S=>S.id),c=Array.isArray(n.modelValue)?n.modelValue:[];(l.length!==c.length||l.some(S=>!c.includes(S))||c.some(S=>!l.includes(S)))&&i()},{immediate:!0});const b=Ts(async f=>{if(f.length<2){g.value=[],p.value=!1;return}try{const l=await H.get(`/api/tags/search?query=${f}`);g.value=l.data,p.value=!0}catch(l){console.error("Error fetching tags:",l),g.value=[],p.value=!1}},300);Q(e,f=>{n.disabled||b(f)});const y=f=>{u.value.some(l=>l.id===f.id)||(u.value.push(f),e.value="",g.value=[],p.value=!1,i()),ye(()=>v.value.focus())},I=()=>{if(n.disabled)return;const f=e.value.trim();if(!f)return;const l=g.value.find(w=>w.name.toLowerCase()===f.toLowerCase()),c=u.value.some(w=>w.name.toLowerCase()===f.toLowerCase());if(l)y(l);else if(c)e.value="",g.value=[],p.value=!1;else{const w={id:`new_${f.replace(/\s+/g,"-").toLowerCase()}_${Date.now()}`,name:f};u.value.push(w),e.value="",g.value=[],p.value=!1,i()}ye(()=>v.value.focus())},P=f=>{n.disabled||(u.value=u.value.filter(l=>l.id!==f.id),i(),ye(()=>v.value.focus()))},T=()=>{n.disabled||e.value===""&&u.value.length>0&&P(u.value[u.value.length-1])},k=B(()=>g.value.filter(f=>!u.value.some(l=>l.id===f.id))),$=f=>{v.value&&!v.value.$el.contains(f.target)&&(p.value=!1,e.value="")};return he(()=>{document.addEventListener("click",$)}),je(()=>{document.removeEventListener("click",$)}),(f,l)=>(s(),r("div",Is,[m(L,{value:a.label,class:"mb-1"},null,8,["value"]),t("div",As,[(s(!0),r(Y,null,K(u.value,c=>(s(),r("span",{key:c.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},[C(j(c.name)+" ",1),a.disabled?h("",!0):(s(),r("button",{key:0,type:"button",onClick:w=>P(c),class:"ml-2 -mr-1 text-indigo-500 hover:text-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 rounded-full p-0.5"},l[3]||(l[3]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,js))]))),128)),m(le,{ref_key:"inputRef",ref:v,type:"text",placeholder:u.value.length===0?a.placeholder:"",modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=c=>e.value=c),onFocus:l[1]||(l[1]=c=>p.value=!0),onKeydown:[Ae(De(I,["prevent"]),["enter"]),l[2]||(l[2]=Ae(c=>p.value=!1,["tab"])),Ae(T,["delete"])],class:"flex-grow min-w-[100px] border-none focus:ring-0 shadow-none p-0 bg-transparent text-gray-900",disabled:a.disabled},null,8,["placeholder","modelValue","onKeydown","disabled"])]),p.value&&(k.value.length>0||e.value.length>=2||k.value.length===0&&e.value.length<2)&&!a.disabled?(s(),r("div",Ds,[(s(!0),r(Y,null,K(k.value,c=>(s(),r("div",{key:c.id,onClick:w=>y(c),class:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer transition-colors duration-100"},j(c.name),9,Es))),128)),!g.value.some(c=>c.name.toLowerCase()===e.value.toLowerCase())&&e.value.length>=2?(s(),r("div",{key:0,onClick:I,class:"px-4 py-2 text-sm text-indigo-700 bg-indigo-50 hover:bg-indigo-100 cursor-pointer border-t border-indigo-200 font-semibold transition-colors duration-100"},' Add new tag: "'+j(e.value)+'" ',1)):h("",!0),k.value.length===0&&e.value.length<2?(s(),r("div",Ms," Type at least 2 characters to search for tags. ")):h("",!0),k.value.length===0&&e.value.length>=2&&!g.value.some(c=>c.name.toLowerCase()===e.value.toLowerCase())?(s(),r("div",Ps,[l[4]||(l[4]=C(" No matching tags found. Press ",-1)),l[5]||(l[5]=t("span",{class:"font-semibold text-indigo-600"},"Enter",-1)),C(' to add "'+j(e.value)+'" as a new tag. ',1)])):h("",!0)])):h("",!0),m(O,{message:a.error,class:"mt-2"},null,8,["message"])]))}},Qe=ke(Ns,[["__scopeId","data-v-4d528a4c"]]),Vs={class:"space-y-4"},Us="Add New Milestone",Bs="/api/milestones",Ls="post",Rs="Create Milestone",zs="Milestone created successfully!",Fs={__name:"MilestoneFormModal",props:{show:Boolean,projectId:Number},emits:["close","saved"],setup(a,{emit:o}){const n=a,d=o,e=Ee({name:"",description:"",completion_date:null,status:"Not Started",project_id:n.projectId}),g=["Not Started","In Progress","Completed","Overdue"];Q(()=>n.show,v=>{v&&Object.assign(e,{name:"",description:"",completion_date:null,status:"Not Started",project_id:n.projectId})},{immediate:!0});const u=v=>{d("saved",v),d("close")},p=()=>{d("close")};return(v,i)=>(s(),E(Me,{show:a.show,title:Us,"api-endpoint":Bs,"http-method":Ls,"form-data":e,"submit-button-text":Rs,"success-message":zs,onClose:p,onSubmitted:u},{default:x(({errors:b})=>[t("div",Vs,[t("div",null,[m(L,{for:"milestone-name",value:"Milestone Name"}),m(le,{id:"milestone-name",modelValue:e.name,"onUpdate:modelValue":i[0]||(i[0]=y=>e.name=y),type:"text",class:"mt-1 block w-full",placeholder:"Enter milestone name",required:""},null,8,["modelValue"]),m(O,{message:b.name?b.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"milestone-description",value:"Description"}),Z(t("textarea",{id:"milestone-description","onUpdate:modelValue":i[1]||(i[1]=y=>e.description=y),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter milestone description"},null,512),[[de,e.description]]),m(O,{message:b.description?b.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"milestone-completion-date",value:"Completion Date"}),m(le,{id:"milestone-completion-date",modelValue:e.completion_date,"onUpdate:modelValue":i[2]||(i[2]=y=>e.completion_date=y),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),m(O,{message:b.completion_date?b.completion_date[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"milestone-status",value:"Status"}),m(oe,{id:"milestone-status",modelValue:e.status,"onUpdate:modelValue":i[3]||(i[3]=y=>e.status=y),options:g.map(y=>({value:y,label:y})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),m(O,{message:b.status?b.status[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]))}},Ws={class:"space-y-4"},Os={key:0},qs={key:0,class:"text-sm text-gray-500"},Hs={key:0,class:"text-sm text-gray-500"},Js={key:0,class:"text-sm text-gray-500"},Ys={class:"flex items-center gap-2 mt-1"},Ks={key:0,class:"text-sm text-gray-500"},Zs=["disabled"],Gs="Create New Task",Qs="/api/tasks",Xs="post",ea="Create Task",ta="Task created successfully!",sa={__name:"CreateTaskModal",props:{show:Boolean,projectId:{type:Number,default:null}},emits:["close","saved"],setup(a,{emit:o}){const n=a,d=o,e=Ee({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:n.projectId,priority:"medium",tags:[],tags_data:[]}),g=["To Do","In Progress","Done","Blocked","Archived"],u=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],p=A([]),v=A([]),i=A([]),b=A([]),y=A(!0),I=A(!1),P=A(!1),T=A(!1),k=A(!1);Q(()=>n.show,async W=>{W&&(Object.assign(e,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:n.projectId,priority:"medium",tags:[],tags_data:[]}),n.projectId?await f(n.projectId):await $())},{immediate:!0}),Q(()=>e.project_id,async W=>{W?await f(W):(v.value=[],i.value=[],b.value=[])});const $=async()=>{y.value=!0;try{const W=await window.axios.get("/api/projects-simplified");p.value=W.data.map(V=>({value:V.id,label:V.name}))}catch(W){console.error("Error fetching projects:",W),p.value=[]}finally{y.value=!1}},f=async W=>{if(W){I.value=!0,P.value=!0,T.value=!0;try{const[V,z,F]=await Promise.all([window.axios.get(`/api/projects/${W}/users`),window.axios.get("/api/task-types"),window.axios.get(`/api/projects/${W}/milestones`)]);v.value=V.data.map(ae=>({value:ae.id,label:ae.name})),i.value=z.data.map(ae=>({value:ae.id,label:ae.name})),b.value=F.data.map(ae=>({value:ae.id,label:ae.name}))}catch(V){console.error("Error fetching associated task data:",V),v.value=[],i.value=[],b.value=[]}finally{I.value=!1,P.value=!1,T.value=!1}}},l=W=>{d("saved",W),d("close")},c=()=>{d("close")},w=()=>{e.project_id?k.value=!0:alert("Please select a project before adding a milestone.")},S=W=>{if(k.value=!1,W&&W.id&&W.name){const V={value:W.id,label:W.name};b.value.some(z=>z.value===V.value)||b.value.push(V),e.milestone_id=V.value}},N=B(()=>v.value),q=B(()=>i.value),ne=B(()=>b.value);return(W,V)=>(s(),r(Y,null,[m(Me,{show:a.show,title:Gs,"api-endpoint":Qs,"http-method":Xs,"form-data":e,"submit-button-text":ea,"success-message":ta,onClose:c,onSubmitted:l},{default:x(({errors:z})=>[t("div",Ws,[a.projectId?h("",!0):(s(),r("div",Os,[m(L,{for:"task-project",value:"Project"}),y.value?(s(),r("div",qs,"Loading projects...")):(s(),E(oe,{key:1,id:"task-project",modelValue:e.project_id,"onUpdate:modelValue":V[0]||(V[0]=F=>e.project_id=F),options:p.value,"value-key":"value","label-key":"label",placeholder:"Select a project",class:"mt-1",required:!0},null,8,["modelValue","options"])),m(O,{message:z.project_id?z.project_id[0]:"",class:"mt-2"},null,8,["message"])])),t("div",null,[m(L,{for:"task-name",value:"Task Name"}),m(le,{id:"task-name",modelValue:e.name,"onUpdate:modelValue":V[1]||(V[1]=F=>e.name=F),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),m(O,{message:z.name?z.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"task-description",value:"Description"}),Z(t("textarea",{id:"task-description","onUpdate:modelValue":V[2]||(V[2]=F=>e.description=F),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[de,e.description]]),m(O,{message:z.description?z.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"task-status",value:"Status"}),m(oe,{id:"task-status",modelValue:e.status,"onUpdate:modelValue":V[3]||(V[3]=F=>e.status=F),options:g.map(F=>({value:F,label:F})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),m(O,{message:z.status?z.status[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"task-priority",value:"Priority"}),m(oe,{id:"task-priority",modelValue:e.priority,"onUpdate:modelValue":V[4]||(V[4]=F=>e.priority=F),options:u,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1"},null,8,["modelValue"]),m(O,{message:z.priority?z.priority[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"task-due-date",value:"Due Date"}),m(le,{id:"task-due-date",modelValue:e.due_date,"onUpdate:modelValue":V[5]||(V[5]=F=>e.due_date=F),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),m(O,{message:z.due_date?z.due_date[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"task-assigned-to",value:"Assigned To"}),I.value?(s(),r("div",Hs,"Loading users...")):(s(),E(oe,{key:1,id:"task-assigned-to",modelValue:e.assigned_to_user_id,"onUpdate:modelValue":V[6]||(V[6]=F=>e.assigned_to_user_id=F),options:N.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),m(O,{message:z.assigned_to_user_id?z.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"task-type",value:"Task Type"}),P.value?(s(),r("div",Js,"Loading task types...")):(s(),E(oe,{key:1,id:"task-type",modelValue:e.task_type_id,"onUpdate:modelValue":V[7]||(V[7]=F=>e.task_type_id=F),options:q.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),m(O,{message:z.task_type_id?z.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"task-milestone",value:"Milestone"}),t("div",Ys,[T.value?(s(),r("div",Ks,"Loading milestones...")):(s(),E(oe,{key:1,id:"task-milestone",modelValue:e.milestone_id,"onUpdate:modelValue":V[8]||(V[8]=F=>e.milestone_id=F),options:ne.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"flex-grow","allow-empty":!0,disabled:!e.project_id},null,8,["modelValue","options","disabled"])),t("button",{type:"button",onClick:w,disabled:!e.project_id||T.value,class:"px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Add New Milestone"},V[11]||(V[11]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1)]),8,Zs)]),m(O,{message:z.milestone_id?z.milestone_id[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(Qe,{modelValue:e.tags,"onUpdate:modelValue":V[9]||(V[9]=F=>e.tags=F),initialTags:e.tags_data,label:"Tags",placeholder:"Search or add tags",error:z.tags?z.tags[0]:"",disabled:!e.project_id},null,8,["modelValue","initialTags","error","disabled"])])])]),_:1},8,["show","form-data"]),m(Fs,{show:k.value,"project-id":e.project_id,onClose:V[10]||(V[10]=z=>k.value=!1),onSaved:S},null,8,["show","project-id"])],64))}},aa={class:"space-y-4"},oa={class:"flex items-center mt-4"},la={__name:"CreateForm",props:{show:{type:Boolean,default:!1},apiEndpoint:{type:String,required:!0}},emits:["close","resourceCreated"],setup(a,{emit:o}){const n=a,d=o,e=Ee({title:"",description:"",url:"",type:"website",thumbnail_url:"",visible_to_client:!0,tags:[]}),g=B(()=>[{value:"website",label:"Website"},{value:"youtube",label:"YouTube Video"},{value:"document",label:"Document"},{value:"image",label:"Image"},{value:"other",label:"Other"}]),u=i=>i,p=i=>{d("resourceCreated",i),v()},v=()=>{e.title="",e.description="",e.url="",e.type="website",e.thumbnail_url="",e.visible_to_client=!0,e.tags=[],d("close")};return(i,b)=>(s(),E(Me,{show:n.show,title:"Add New Shareable Resource",apiEndpoint:n.apiEndpoint,httpMethod:"post",formData:e,submitButtonText:"Create Resource",successMessage:"Shareable resource created successfully!",formatDataForApi:u,onSubmitted:p,onClose:v},{default:x(({errors:y})=>[t("div",aa,[t("div",null,[m(L,{for:"title",value:"Title",class:"mb-1"}),m(le,{id:"title",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.title,"onUpdate:modelValue":b[0]||(b[0]=I=>e.title=I),required:""},null,8,["modelValue"]),m(O,{message:y.title?y.title[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"url",value:"Resource URL",class:"mb-1"}),m(le,{id:"url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.url,"onUpdate:modelValue":b[1]||(b[1]=I=>e.url=I),required:""},null,8,["modelValue"]),m(O,{message:y.url?y.url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"type",value:"Resource Type",class:"mb-1"}),m(oe,{id:"type",modelValue:e.type,"onUpdate:modelValue":b[2]||(b[2]=I=>e.type=I),options:g.value,valueKey:"value",labelKey:"label",placeholder:"Select Resource Type",required:"",class:"mt-1 block w-full"},null,8,["modelValue","options"]),m(O,{message:y.type?y.type[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"thumbnail_url",value:"Thumbnail URL (Optional)",class:"mb-1"}),m(le,{id:"thumbnail_url",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:e.thumbnail_url,"onUpdate:modelValue":b[3]||(b[3]=I=>e.thumbnail_url=I)},null,8,["modelValue"]),m(O,{message:y.thumbnail_url?y.thumbnail_url[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(L,{for:"description",value:"Description (Optional)",class:"mb-1"}),Z(t("textarea",{id:"description",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm mt-1 block w-full","onUpdate:modelValue":b[4]||(b[4]=I=>e.description=I),rows:"3"},null,512),[[de,e.description]]),m(O,{message:y.description?y.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[m(Qe,{modelValue:e.tags,"onUpdate:modelValue":b[5]||(b[5]=I=>e.tags=I),label:"Associated Tags",placeholder:"Search or add tags",error:y.tags?y.tags[0]:""},null,8,["modelValue","error"])]),t("div",oa,[m(bt,{id:"visible_to_client",checked:e.visible_to_client,"onUpdate:checked":b[6]||(b[6]=I=>e.visible_to_client=I)},null,8,["checked"]),m(L,{for:"visible_to_client",value:"Visible to Client",class:"ml-2"}),m(O,{message:y.visible_to_client?y.visible_to_client[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","apiEndpoint","formData"]))}},ra=ke(la,[["__scopeId","data-v-3e3a6a9f"]]),na={key:0,class:"sidebar-wrapper"},ia={class:"fixed inset-0 z-[100] flex pointer-events-none"},da={class:"flex items-center justify-between p-4 border-b border-gray-200 bg-white rounded-tl-xl sticky top-0 z-20"},ua={class:"text-xl font-semibold text-gray-900"},ca={class:"flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-gray-300 scrollbar-track-gray-100"},ma={key:1,class:"p-4 border-t border-gray-200 bg-white sticky bottom-0 z-20"},va={__name:"RightSidebar",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Details"},initialWidth:{type:Number,default:50},minWidth:{type:Number,default:30},maxWidth:{type:Number,default:90}},emits:["close","update:show"],setup(a,{emit:o}){const n=a,d=o,e=A(n.initialWidth),g=A(!1),u=y=>{g.value=!0,document.addEventListener("pointermove",p),document.addEventListener("pointerup",v)},p=y=>{if(!g.value)return;const I=window.innerWidth,T=(I-y.clientX)/I*100,k=Math.max(n.minWidth,Math.min(n.maxWidth,T));e.value=k},v=()=>{g.value=!1,document.removeEventListener("pointermove",p),document.removeEventListener("pointerup",v)};Q(()=>n.show,y=>{y?document.body.style.overflow="hidden":document.body.style.overflow=""},{immediate:!0});const i=()=>{d("update:show",!1),d("close")},b=B(()=>window.innerWidth<768);return Q(b,y=>{y&&n.show?e.value=100:!y&&n.show&&(e.value=n.initialWidth)},{immediate:!0}),Q(()=>n.show,y=>{y&&(b.value?e.value=100:e.value=n.initialWidth)}),(y,I)=>(s(),E(ft,{to:"body"},[m(Ze,{"enter-active-class":"transition ease-out duration-300 transform","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"transition ease-in duration-200 transform","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:x(()=>[a.show?(s(),r("div",na,[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity z-[99]",onClick:i}),t("div",ia,[t("div",{class:"relative ml-auto h-full bg-white shadow-xl flex flex-col rounded-l-xl pointer-events-auto",style:gt({width:b.value?"100%":`${e.value}vw`})},[b.value?h("",!0):(s(),r("div",{key:0,class:"absolute left-0 top-0 h-full w-2 cursor-col-resize -ml-1 z-10",onPointerdown:u,title:"Drag to resize"},null,32)),t("div",da,[t("h3",ua,j(a.title),1),t("button",{onClick:i,class:"text-gray-400 hover:text-gray-600 transition-colors"},I[0]||(I[0]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("div",ca,[re(y.$slots,"content",{},void 0,!0)]),y.$slots.footer?(s(),r("div",ma,[re(y.$slots,"footer",{},void 0,!0)])):h("",!0)],4)])])):h("",!0)]),_:3})]))}},Xe=ke(va,[["__scopeId","data-v-2d864577"]]),pa={class:"flex border-b border-gray-200"},ga={key:0,class:"ml-2 px-2 py-1 text-xs font-bold bg-red-600 text-white rounded-full"},fa={class:"p-4 space-y-2 overflow-y-auto"},ya={key:0,class:"p-6 text-center text-gray-500"},ha={key:0},ka={key:1},ba=["onClick"],wa={class:"flex-1 min-w-0"},xa={class:"flex items-start justify-between gap-2 mb-1"},_a={class:"flex-1 min-w-0"},$a={key:0,class:"text-base font-semibold text-gray-900 truncate"},Ca={key:1,class:"text-xs text-gray-500"},Sa={key:0,class:"text-sm text-gray-600 mt-1 mb-2"},Ta={class:"flex items-center text-xs text-gray-500 font-medium"},Ia={key:0},Aa={key:1,class:"mx-2"},ja={key:2},Da={__name:"NotificationsSidebar",setup(a){const o=B(()=>Se.value.notifications),n=A("New"),d=B(()=>n.value==="New"?o.value.filter(p=>!p.isRead):o.value),e=async p=>{await Ye(p.view_id);const v=p.task_id||g(p.url),i=p.project_id||u(p.url);v&&i?(Ke(v,i),ze()):(console.warn("Could not open task sidebar. Falling back to opening URL in new tab."),p.url&&window.open(p.url,"_blank"))},g=p=>{const v=p.match(/\/task\/(\d+)/);return v?parseInt(v[1]):null},u=p=>{const v=p.match(/\/project\/(\d+)\//);return v?parseInt(v[1]):null};return(p,v)=>(s(),E(Xe,{show:D(Se).show,"onUpdate:show":D(ze),title:"Notifications","initial-width":35,class:"z-[100]"},{content:x(()=>[t("div",pa,[t("button",{onClick:v[0]||(v[0]=i=>n.value="New"),class:U([{"border-blue-600 text-blue-600 font-semibold":n.value==="New","border-transparent text-gray-500 hover:text-gray-700":n.value!=="New"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])},[v[2]||(v[2]=C(" New ",-1)),o.value.filter(i=>!i.isRead).length>0?(s(),r("span",ga,j(o.value.filter(i=>!i.isRead).length),1)):h("",!0)],2),t("button",{onClick:v[1]||(v[1]=i=>n.value="All"),class:U([{"border-blue-600 text-blue-600 font-semibold":n.value==="All","border-transparent text-gray-500 hover:text-gray-700":n.value!=="All"},"flex-1 py-4 px-1 text-center text-sm border-b-2 transition-colors duration-200"])}," All ",2)]),t("div",fa,[d.value.length===0?(s(),r("div",ya,[n.value==="New"?(s(),r("span",ha,"You have no new notifications.")):(s(),r("span",ka,"You have no notifications."))])):h("",!0),(s(!0),r(Y,null,K(d.value,i=>(s(),r("div",{key:i.id,class:U(["bg-white rounded-xl shadow-sm p-4 flex items-start space-x-4 border border-gray-200 transition-all duration-200 hover:shadow-md cursor-pointer",{"bg-gray-50":i.isRead}]),onClick:b=>e(i)},[t("div",wa,[t("div",xa,[t("div",_a,[i.title?(s(),r("h3",$a,j(i.title),1)):h("",!0),i.project_name?(s(),r("p",Ca,j(i.project_name),1)):h("",!0)])]),i.message?(s(),r("p",Sa,j(i.message),1)):h("",!0),t("div",Ta,[i.due_date?(s(),r("span",Ia,"Due: "+j(D(Je)(i.due_date)),1)):h("",!0),i.due_date&&i.priority?(s(),r("span",Aa,"•")):h("",!0),i.priority?(s(),r("span",ja,"Priority: "+j(i.priority),1)):h("",!0)])])],10,ba))),128))])]),_:1},8,["show","onUpdate:show"]))}},Ea={class:"flex items-center p-4 h-16 border-b border-gray-700"},Ma={key:0,class:"text-xl font-semibold flex-1 truncate"},Pa=["title"],Na={key:0,class:"p-4 border-b border-gray-700"},Va={class:"relative"},Ua={key:1,class:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-500 scrollbar-track-gray-700 p-4"},Ba={key:0,class:"mb-4"},La={class:"ml-2 mt-2 space-y-1"},Ra=["onClick"],za={class:"text-sm font-medium text-gray-300 truncate"},Fa={class:"ml-4 mt-1 space-y-1"},Wa={class:"truncate"},Oa={key:1,class:"mb-4"},qa={class:"ml-2 mt-2 space-y-1"},Ha=["onClick"],Ja={class:"text-sm font-medium text-gray-300 truncate"},Ya={class:"ml-4 mt-1 space-y-1"},Ka={class:"truncate"},Za={key:2,class:"mb-4"},Ga={class:"ml-2 mt-2 space-y-1"},Qa={class:"truncate"},Xa={key:3,class:"mb-4"},eo={class:"ml-2 mt-2 space-y-1"},to={class:"truncate"},so={key:4,class:"text-gray-400 text-sm text-center py-4"},ao={key:5,class:"text-gray-400 text-sm text-center py-4"},oo={key:2,class:"flex flex-col items-center pt-4 space-y-4"},lo={key:0,class:"text-gray-400 text-xs text-center px-2"},ro={__name:"LeftSidebar",props:{allProjects:{type:Array,default:()=>[]},activeProjectId:{type:Number,default:null}},emits:["project-selected"],setup(a,{emit:o}){const n=a,d=o,e=A(localStorage.getItem("leftSidebarCollapsed")!=="false"),g=A(""),u=A({}),p=B(()=>{const l=new Set;return n.allProjects.forEach(c=>{c.project_type&&l.add(c.project_type)}),Array.from(l).sort()}),v=B(()=>{const l=new Set;return n.allProjects.forEach(c=>{Array.isArray(c.tags)&&c.tags.forEach(w=>l.add(w))}),Array.from(l).sort()}),i=B(()=>{if(!g.value)return n.allProjects;const l=g.value.toLowerCase();return n.allProjects.filter(c=>{var w,S,N;return c.name.toLowerCase().includes(l)||((w=c.description)==null?void 0:w.toLowerCase().includes(l))||((S=c.project_type)==null?void 0:S.toLowerCase().includes(l))||Array.isArray(c.tags)&&c.tags.some(q=>q.toLowerCase().includes(l))||((N=c.status)==null?void 0:N.toLowerCase().includes(l))})}),b=B(()=>{const l={};i.value.forEach(c=>{c.project_type&&c.status==="active"&&(l[c.project_type]||(l[c.project_type]=[]),l[c.project_type].push(c))});for(const c in l)l[c].sort((w,S)=>w.name.localeCompare(S.name));return l}),y=B(()=>{const l={};i.value.forEach(c=>{Array.isArray(c.tags)&&c.tags.length>0&&c.tags.forEach(w=>{l[w]||(l[w]=[]),l[w].push(c)})});for(const c in l)l[c]=[...new Set(l[c])].sort((w,S)=>w.name.localeCompare(S.name));return l}),I=B(()=>i.value.filter(l=>l.status!=="active").sort((l,c)=>l.name.localeCompare(c.name))),P=B(()=>i.value.filter(l=>!l.project_type&&(!Array.isArray(l.tags)||l.tags.length===0)).sort((l,c)=>l.name.localeCompare(c.name)));Q(()=>n.allProjects,()=>{p.value.forEach(l=>{const c=`type-${l}`;u.value[c]===void 0&&(u.value[c]=!0)}),v.value.forEach(l=>{const c=`tag-${l}`;u.value[c]===void 0&&(u.value[c]=!0)}),u.value["main-types"]===void 0&&(u.value["main-types"]=!1),u.value["main-tags"]===void 0&&(u.value["main-tags"]=!1),u.value["inactive-projects"]===void 0&&(u.value["inactive-projects"]=!1),u.value.uncategorized===void 0&&(u.value.uncategorized=!1)},{immediate:!0}),Q(e,l=>{localStorage.setItem("leftSidebarCollapsed",l)});const T=()=>{e.value=!e.value},k=l=>{u.value[l]=!u.value[l]},$=l=>{d("project-selected",l)},f=()=>{g.value=""};return(l,c)=>(s(),r("div",{class:U({"w-64":!e.value,"w-16":e.value,"min-w-16":!0,"bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out shrink-0 h-screen overflow-hidden":!0})},[t("div",Ea,[e.value?h("",!0):(s(),r("h2",Ma,"Projects")),t("button",{onClick:T,class:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:e.value?"Expand Sidebar":"Collapse Sidebar"},[(s(),r("svg",{class:U(["w-6 h-6 text-gray-400 transform transition-transform duration-300",{"rotate-180":e.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c[5]||(c[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],8,Pa)]),e.value?h("",!0):(s(),r("div",Na,[t("div",Va,[Z(t("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=w=>g.value=w),placeholder:"Search all projects...",class:"w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 text-sm"},null,512),[[de,g.value]]),g.value?(s(),r("button",{key:0,onClick:f,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200",title:"Clear search"},c[6]||(c[6]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):h("",!0)])])),e.value?(s(),r("div",oo,[(s(!0),r(Y,null,K(n.allProjects,w=>(s(),E(D(ie),{key:w.id,href:l.route("projects.show",w.id),onClick:S=>$(w.id),class:U({"w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-200":!0,"bg-indigo-600 text-white":w.id===a.activeProjectId,"bg-gray-700 text-gray-300 hover:bg-gray-600":w.id!==a.activeProjectId}),title:w.name},{default:x(()=>[C(j(w.name.charAt(0).toUpperCase()),1)]),_:2},1032,["href","onClick","class","title"]))),128)),a.allProjects.length===0?(s(),r("div",lo," No Projects ")):h("",!0)])):(s(),r("div",Ua,[Object.keys(b.value).length>0?(s(),r("div",Ba,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:c[1]||(c[1]=w=>k("main-types"))},[c[8]||(c[8]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Active Projects by Type",-1)),(s(),r("svg",{class:U(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["main-types"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c[7]||(c[7]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("div",La,[(s(!0),r(Y,null,K(b.value,(w,S)=>(s(),r("div",{key:S},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:N=>k(`type-${S}`)},[t("h4",za,j(S),1),(s(),r("svg",{class:U(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value[`type-${S}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c[9]||(c[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,Ra),Z(t("ul",Fa,[(s(!0),r(Y,null,K(w,N=>(s(),r("li",{key:N.id},[m(D(ie),{href:l.route("projects.show",N.id),onClick:q=>$(N.id),class:U({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":N.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":N.id!==a.activeProjectId,"font-bold":N.id===a.activeProjectId})},{default:x(()=>[t("span",Wa,j(N.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value[`type-${S}`]]])]))),128))],512),[[ce,!u.value["main-types"]]])])):h("",!0),Object.keys(y.value).length>0?(s(),r("div",Oa,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:c[2]||(c[2]=w=>k("main-tags"))},[c[11]||(c[11]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Projects by Tag",-1)),(s(),r("svg",{class:U(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["main-tags"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c[10]||(c[10]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("div",qa,[(s(!0),r(Y,null,K(y.value,(w,S)=>(s(),r("div",{key:S},[t("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:N=>k(`tag-${S}`)},[t("h4",Ja,j(S),1),(s(),r("svg",{class:U(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value[`tag-${S}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c[12]||(c[12]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,Ha),Z(t("ul",Ya,[(s(!0),r(Y,null,K(w,N=>(s(),r("li",{key:N.id},[m(D(ie),{href:l.route("projects.show",N.id),onClick:q=>$(N.id),class:U({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":N.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":N.id!==a.activeProjectId,"font-bold":N.id===a.activeProjectId})},{default:x(()=>[t("span",Ka,j(N.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value[`tag-${S}`]]])]))),128))],512),[[ce,!u.value["main-tags"]]])])):h("",!0),I.value.length>0?(s(),r("div",Za,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:c[3]||(c[3]=w=>k("inactive-projects"))},[c[14]||(c[14]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Inactive Projects",-1)),(s(),r("svg",{class:U(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value["inactive-projects"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c[13]||(c[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("ul",Ga,[(s(!0),r(Y,null,K(I.value,w=>(s(),r("li",{key:w.id},[m(D(ie),{href:l.route("projects.show",w.id),onClick:S=>$(w.id),class:U({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":w.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":w.id!==a.activeProjectId,"font-bold":w.id===a.activeProjectId})},{default:x(()=>[t("span",Qa,j(w.name)+" ("+j(w.status.replace("_"," "))+")",1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value["inactive-projects"]]])])):h("",!0),P.value.length>0?(s(),r("div",Xa,[t("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:c[4]||(c[4]=w=>k("uncategorized"))},[c[16]||(c[16]=t("h3",{class:"text-sm font-semibold text-gray-400"},"Uncategorized",-1)),(s(),r("svg",{class:U(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!u.value.uncategorized}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},c[15]||(c[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),Z(t("ul",eo,[(s(!0),r(Y,null,K(P.value,w=>(s(),r("li",{key:w.id},[m(D(ie),{href:l.route("projects.show",w.id),onClick:S=>$(w.id),class:U({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":w.id===a.activeProjectId,"hover:bg-gray-700 text-gray-200":w.id!==a.activeProjectId,"font-bold":w.id===a.activeProjectId})},{default:x(()=>[t("span",to,j(w.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[ce,!u.value.uncategorized]])])):h("",!0),i.value.length===0?(s(),r("div",so," No projects found matching your search. ")):a.allProjects.length===0&&!g.value?(s(),r("div",ao," No projects available. ")):h("",!0)]))],2))}},no=ke(ro,[["__scopeId","data-v-417d431f"]]),io={class:"relative"},et={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(a){const o=a,n=u=>{g.value&&u.key==="Escape"&&(g.value=!1)};he(()=>document.addEventListener("keydown",n)),je(()=>document.removeEventListener("keydown",n));const d=B(()=>({48:"w-48"})[o.width.toString()]),e=B(()=>o.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":o.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),g=A(!1);return(u,p)=>(s(),r("div",io,[t("div",{onClick:p[0]||(p[0]=v=>g.value=!g.value)},[re(u.$slots,"trigger")]),Z(t("div",{class:"fixed inset-0 z-40",onClick:p[1]||(p[1]=v=>g.value=!1)},null,512),[[ce,g.value]]),m(Ze,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:x(()=>[Z(t("div",{class:U(["absolute z-50 mt-2 rounded-md shadow-lg",[d.value,e.value]]),style:{display:"none"},onClick:p[2]||(p[2]=v=>g.value=!1)},[t("div",{class:U(["rounded-md ring-1 ring-black ring-opacity-5",a.contentClasses])},[re(u.$slots,"content")],2)],2),[[ce,g.value]])]),_:3})]))}},ee={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){return(o,n)=>(s(),E(D(ie),Ge({href:a.href,method:a.method,as:a.as},o.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:x(()=>[re(o.$slots,"default")]),_:3},16,["href","method","as"]))}},We={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(a){const o=a,n=B(()=>o.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(d,e)=>(s(),E(D(ie),{href:a.href,class:U(n.value)},{default:x(()=>[re(d.$slots,"default")]),_:3},8,["href","class"]))}};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uo=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(o,n,d)=>d?d.toUpperCase():n.toLowerCase()),co=a=>{const o=uo(a);return o.charAt(0).toUpperCase()+o.slice(1)},mo=(...a)=>a.filter((o,n,d)=>!!o&&o.trim()!==""&&d.indexOf(o)===n).join(" ").trim(),qe=a=>a==="";/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ce={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=({name:a,iconNode:o,absoluteStrokeWidth:n,"absolute-stroke-width":d,strokeWidth:e,"stroke-width":g,size:u=Ce.width,color:p=Ce.stroke,...v},{slots:i})=>Ve("svg",{...Ce,...v,width:u,height:u,stroke:p,"stroke-width":qe(n)||qe(d)||n===!0||d===!0?Number(e||g||Ce["stroke-width"])*24/Number(u):e||g||Ce["stroke-width"],class:mo("lucide",v.class,...a?[`lucide-${Oe(co(a))}-icon`,`lucide-${Oe(a)}`]:["lucide-icon"])},[...o.map(b=>Ve(...b)),...i.default?[i.default()]:[]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(a,o)=>(n,{slots:d,attrs:e})=>Ve(vo,{...e,...n,iconNode:o,name:a},d);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=tt("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);/**
 * @license lucide-vue-next v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=tt("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),fo={class:"hidden sm:flex sm:items-center"},yo={__name:"AdminDropdown",setup(a){const{canDo:o}=Ue(),n=o("manage_projects"),d=o("compose_emails"),e=o("approve_emails"),g=o("create_users");o("manage_roles");const u=o("manage_task_types"),p=o("create_clients");return(v,i)=>(s(),r("div",fo,[m(et,{align:"right",width:"48"},{trigger:x(()=>i[0]||(i[0]=[t("span",{class:"inline-flex rounded-md"},[t("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},[C(" Admin "),t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:x(()=>[D(n)?(s(),E(ee,{key:0,href:v.route("projects.index"),active:v.route().current("projects.index")},{default:x(()=>i[1]||(i[1]=[C(" Projects ",-1)])),_:1,__:[1]},8,["href","active"])):h("",!0),D(e)?(s(),E(ee,{key:1,href:v.route("emails.pending"),active:v.route().current("emails.pending")},{default:x(()=>i[2]||(i[2]=[C(" Approve Emails ",-1)])),_:1,__:[2]},8,["href","active"])):h("",!0),D(d)?(s(),E(ee,{key:2,href:v.route("emails.rejected"),active:v.route().current("emails.rejected")},{default:x(()=>i[3]||(i[3]=[C(" Rejected Emails ",-1)])),_:1,__:[3]},8,["href","active"])):h("",!0),D(g)?(s(),E(ee,{key:3,href:v.route("availability.index"),active:v.route().current("availability.index")},{default:x(()=>i[4]||(i[4]=[C(" Weekly Availability ",-1)])),_:1,__:[4]},8,["href","active"])):h("",!0),D(p)?(s(),E(ee,{key:4,href:v.route("clients.index"),active:v.route().current("clients.index")},{default:x(()=>i[5]||(i[5]=[C(" Clients ",-1)])),_:1,__:[5]},8,["href","active"])):h("",!0),D(g)?(s(),E(ee,{key:5,href:v.route("users.index"),active:v.route().current("users.index")},{default:x(()=>i[6]||(i[6]=[C(" Users ",-1)])),_:1,__:[6]},8,["href","active"])):h("",!0),D(u)?(s(),E(ee,{key:6,href:v.route("task-types.index"),active:v.route().current("task-types.index")},{default:x(()=>i[7]||(i[7]=[C(" Task Types ",-1)])),_:1,__:[7]},8,["href","active"])):h("",!0),D(o)("manage_bonus_configuration")?(s(),E(ee,{key:7,href:v.route("bonus-configuration.index"),active:v.route().current("bonus-configuration.index")},{default:x(()=>i[8]||(i[8]=[C(" Bonus Configuration ",-1)])),_:1,__:[8]},8,["href","active"])):h("",!0),D(o)("manage_email_templates")?(s(),E(ee,{key:8,href:v.route("email-templates.index"),active:v.route().current("email-templates.index")},{default:x(()=>i[9]||(i[9]=[C(" Email Templates ",-1)])),_:1,__:[9]},8,["href","active"])):h("",!0),D(o)("manage_placeholder_definitions")?(s(),E(ee,{key:9,href:v.route("placeholder-definitions.index"),active:v.route().current("placeholder-definitions.index")},{default:x(()=>i[10]||(i[10]=[C(" Placeholder Definitions ",-1)])),_:1,__:[10]},8,["href","active"])):h("",!0),D(o)("manage_roles")?(s(),E(ee,{key:10,href:v.route("admin.roles.index")},{default:x(()=>i[11]||(i[11]=[C(" Manage Roles ",-1)])),_:1,__:[11]},8,["href"])):h("",!0),D(o)("manage_permissions")?(s(),E(ee,{key:11,href:v.route("admin.permissions.index")},{default:x(()=>i[12]||(i[12]=[C(" Manage Permissions ",-1)])),_:1,__:[12]},8,["href"])):h("",!0)]),_:1})]))}},ho={class:"relative ms-3"},ko={class:"inline-flex rounded-md"},bo={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},wo={__name:"UserDropdown",emits:["logoutSuccess","logoutError"],setup(a,{emit:o}){const n=B(()=>Ie().props.auth.user),d=o,e=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,d("logoutSuccess")},g=u=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",d("logoutError",u)};return(u,p)=>(s(),r("div",ho,[m(et,{align:"right",width:"48"},{trigger:x(()=>{var v;return[t("span",ko,[t("button",bo,[C(j(n.value.name)+" ("+j((v=n.value.role_data)==null?void 0:v.name)+") ",1),p[0]||(p[0]=t("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:x(()=>[m(ee,{href:u.route("profile.edit")},{default:x(()=>p[1]||(p[1]=[C(" Profile ",-1)])),_:1,__:[1]},8,["href"]),m(ee,{href:u.route("logout"),method:"post",as:"button",onSuccess:e,onError:g},{default:x(()=>p[2]||(p[2]=[C(" Log Out ",-1)])),_:1,__:[2]},8,["href"])]),_:1})]))}},xo={class:"border-b border-gray-100 bg-white z-10 relative"},_o={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},$o={class:"flex h-16 justify-between"},Co={class:"flex"},So={class:"flex shrink-0 items-center"},To={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},Io={class:"hidden sm:ms-6 sm:flex sm:items-center"},Ao={key:0,class:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-100 transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full"},jo={class:"-me-2 flex items-center sm:hidden"},Do={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},Eo={__name:"TopNavigation",props:{unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar"],setup(a,{emit:o}){const n=o,d=A(!1);B(()=>Ie().props.auth.user);const{canDo:e}=Ue(),g=e("manage_roles");return(u,p)=>(s(),r("nav",xo,[t("div",_o,[t("div",$o,[t("div",Co,[t("div",So,[m(D(ie),{href:u.route("dashboard")},{default:x(()=>[m(wt,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),t("div",To,[m(We,{href:u.route("dashboard"),active:u.route().current("dashboard")},{default:x(()=>p[4]||(p[4]=[C(" Dashboard ",-1)])),_:1,__:[4]},8,["href","active"]),D(e)("view_emails")?(s(),E(We,{key:0,href:u.route("inbox"),active:u.route().current("inbox")},{default:x(()=>p[5]||(p[5]=[C(" Inbox ",-1)])),_:1,__:[5]},8,["href","active"])):h("",!0),D(g)?(s(),E(yo,{key:1})):h("",!0)])]),t("div",Io,[m(X,{type:"button",onClick:p[0]||(p[0]=v=>n("openCreateTaskModal")),class:"mr-4 px-4 py-2 text-sm"},{default:x(()=>p[6]||(p[6]=[C(" Add Task ",-1)])),_:1,__:[6]}),m(X,{type:"button",onClick:p[1]||(p[1]=v=>n("openAddResource")),class:"mr-4 px-4 py-2 text-sm"},{default:x(()=>p[7]||(p[7]=[C(" Add Resource ",-1)])),_:1,__:[7]}),t("button",{onClick:p[2]||(p[2]=v=>n("openNotificationsSidebar")),class:"relative flex-shrink-0 text-gray-400 hover:text-gray-600 p-1 rounded-full transition-colors duration-200 mr-4","aria-label":"View all notifications"},[m(D(po),{class:"h-6 w-6"}),a.unreadNotificationCount>0?(s(),r("span",Ao,j(a.unreadNotificationCount),1)):h("",!0)]),m(wo)]),t("div",jo,[t("button",{onClick:p[3]||(p[3]=v=>d.value=!d.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(s(),r("svg",Do,[t("path",{class:U({hidden:d.value,"inline-flex":!d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),t("path",{class:U({hidden:!d.value,"inline-flex":d.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])])]))}},J={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(a){const o=a,n=B(()=>o.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(d,e)=>(s(),E(D(ie),Ge({href:a.href,method:a.method,as:a.as},d.$attrs,{class:n.value}),{default:x(()=>[re(d.$slots,"default")]),_:3},16,["href","method","as","class"]))}},Mo={class:"space-y-1 pb-3 pt-2"},Po={key:0,class:"mt-3 space-y-1"},No={class:"border-t border-gray-200 pb-1 pt-4"},Vo={class:"px-4"},Uo={class:"text-base font-medium text-gray-800"},Bo={class:"text-sm font-medium text-gray-500"},Lo={class:"text-sm font-medium text-gray-500 capitalize"},Ro={class:"mt-3 space-y-1"},zo={__name:"MobileNavigation",props:{showingNavigationDropdown:{type:Boolean,required:!0},unreadNotificationCount:{type:Number,default:0}},emits:["openCreateTaskModal","openAddResource","openNotificationsSidebar","logoutSuccess","logoutError"],setup(a,{emit:o}){const n=o,d=B(()=>Ie().props.auth.user),{canDo:e}=Ue(),g=e("manage_projects"),u=e("compose_emails"),p=e("approve_emails"),v=e("create_users"),i=e("manage_roles"),b=e("manage_task_types"),y=e("create_clients"),I=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,n("logoutSuccess")},P=T=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login",n("logoutError",T)};return(T,k)=>{var $;return s(),r("div",{class:U([{block:a.showingNavigationDropdown,hidden:!a.showingNavigationDropdown},"sm:hidden"])},[t("div",Mo,[D(i)?(s(),r("div",Po,[k[18]||(k[18]=t("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),m(J,{href:T.route("dashboard"),active:T.route().current("dashboard")},{default:x(()=>k[3]||(k[3]=[C(" Dashboard ",-1)])),_:1,__:[3]},8,["href","active"]),D(e)("view_emails")?(s(),E(J,{key:0,href:T.route("inbox"),active:T.route().current("inbox")},{default:x(()=>k[4]||(k[4]=[C(" Inbox ",-1)])),_:1,__:[4]},8,["href","active"])):h("",!0),D(y)?(s(),E(J,{key:1,href:T.route("clients.index"),active:T.route().current("clients.index")},{default:x(()=>k[5]||(k[5]=[C(" Clients ",-1)])),_:1,__:[5]},8,["href","active"])):h("",!0),D(g)?(s(),E(J,{key:2,href:T.route("projects.index"),active:T.route().current("projects.index")},{default:x(()=>k[6]||(k[6]=[C(" Projects ",-1)])),_:1,__:[6]},8,["href","active"])):h("",!0),D(v)?(s(),E(J,{key:3,href:T.route("users.index"),active:T.route().current("users.index")},{default:x(()=>k[7]||(k[7]=[C(" Users ",-1)])),_:1,__:[7]},8,["href","active"])):h("",!0),D(u)?(s(),E(J,{key:4,href:T.route("emails.compose"),active:T.route().current("emails.compose")},{default:x(()=>k[8]||(k[8]=[C(" Compose Email ",-1)])),_:1,__:[8]},8,["href","active"])):h("",!0),D(p)?(s(),E(J,{key:5,href:T.route("emails.pending"),active:T.route().current("emails.pending")},{default:x(()=>k[9]||(k[9]=[C(" Approve Emails ",-1)])),_:1,__:[9]},8,["href","active"])):h("",!0),D(u)?(s(),E(J,{key:6,href:T.route("emails.rejected"),active:T.route().current("emails.rejected")},{default:x(()=>k[10]||(k[10]=[C(" Rejected Emails ",-1)])),_:1,__:[10]},8,["href","active"])):h("",!0),D(v)?(s(),E(J,{key:7,href:T.route("availability.index"),active:T.route().current("availability.index")},{default:x(()=>k[11]||(k[11]=[C(" Weekly Availability ",-1)])),_:1,__:[11]},8,["href","active"])):h("",!0),D(e)("manage_roles")?(s(),E(J,{key:8,href:T.route("admin.roles.index"),active:T.route().current("admin.roles.index")},{default:x(()=>k[12]||(k[12]=[C(" Manage Roles ",-1)])),_:1,__:[12]},8,["href","active"])):h("",!0),D(e)("manage_permissions")?(s(),E(J,{key:9,href:T.route("admin.permissions.index"),active:T.route().current("admin.permissions.index")},{default:x(()=>k[13]||(k[13]=[C(" Manage Permissions ",-1)])),_:1,__:[13]},8,["href","active"])):h("",!0),D(e)("manage_bonus_configuration")?(s(),E(J,{key:10,href:T.route("bonus-configuration.index"),active:T.route().current("bonus-configuration.index")},{default:x(()=>k[14]||(k[14]=[C(" Bonus Configuration ",-1)])),_:1,__:[14]},8,["href","active"])):h("",!0),D(b)?(s(),E(J,{key:11,href:T.route("task-types.index"),active:T.route().current("task-types.index")},{default:x(()=>k[15]||(k[15]=[C(" Task Types ",-1)])),_:1,__:[15]},8,["href","active"])):h("",!0),D(e)("manage_email_templates")?(s(),E(J,{key:12,href:T.route("email-templates.index"),active:T.route().current("email-templates.index")},{default:x(()=>k[16]||(k[16]=[C(" Email Templates ",-1)])),_:1,__:[16]},8,["href","active"])):h("",!0),D(e)("manage_placeholder_definitions")?(s(),E(J,{key:13,href:T.route("placeholder-definitions.index"),active:T.route().current("placeholder-definitions.index")},{default:x(()=>k[17]||(k[17]=[C(" Placeholder Definitions ",-1)])),_:1,__:[17]},8,["href","active"])):h("",!0)])):h("",!0)]),t("div",No,[t("div",Vo,[t("div",Uo,j(d.value.name),1),t("div",Bo,j(d.value.email),1),t("div",Lo,j(($=d.value.role_data)==null?void 0:$.name),1)]),t("div",Ro,[m(J,{as:"button",onClick:k[0]||(k[0]=f=>n("openCreateTaskModal"))},{default:x(()=>k[19]||(k[19]=[C(" Add Task ",-1)])),_:1,__:[19]}),m(J,{as:"button",onClick:k[1]||(k[1]=f=>n("openAddResource"))},{default:x(()=>k[20]||(k[20]=[C(" Add Resource ",-1)])),_:1,__:[20]}),m(J,{as:"button",onClick:k[2]||(k[2]=f=>n("openNotificationsSidebar"))},{default:x(()=>[C(" Notifications ("+j(a.unreadNotificationCount)+") ",1)]),_:1}),m(J,{href:T.route("profile.edit")},{default:x(()=>k[21]||(k[21]=[C(" Profile ",-1)])),_:1,__:[21]},8,["href"]),m(J,{href:T.route("logout"),method:"post",as:"button",onSuccess:I,onError:P},{default:x(()=>k[22]||(k[22]=[C(" Log Out ",-1)])),_:1,__:[22]},8,["href"])])])],2)}}},Fo={class:"space-y-4"},Wo={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},Oo={class:"text-sm font-medium text-gray-900"},qo={class:"text-xs text-gray-500 mt-1"},Ho={class:"mb-4"},Jo="post",Yo="Add Note",Ko="Note added successfully!",Zo={__name:"TaskNoteModal",props:{show:Boolean,taskForNote:Object},emits:["close","note-added"],setup(a,{emit:o}){const n=a,d=o,e=Ee({note:""}),g=B(()=>{var i;return`Add Note to Task: "${(i=n.taskForNote)==null?void 0:i.name}"`}),u=B(()=>{var i;return`/api/tasks/${(i=n.taskForNote)==null?void 0:i.id}/notes`});Q(()=>n.show,i=>{i&&Object.assign(e,{note:""})},{immediate:!0});const p=i=>{d("note-added",i),d("close")},v=()=>{d("close")};return(i,b)=>(s(),E(Me,{show:a.show,title:g.value,"api-endpoint":u.value,"http-method":Jo,"form-data":e,"submit-button-text":Yo,"success-message":Ko,onClose:v,onSubmitted:p},{default:x(({errors:y})=>[t("div",Fo,[a.taskForNote?(s(),r("div",Wo,[t("p",Oo,j(a.taskForNote.name),1),t("p",qo,"Status: "+j(a.taskForNote.status),1)])):h("",!0),t("div",Ho,[m(L,{for:"task-note-content",value:"Note Content"}),Z(t("textarea",{id:"task-note-content","onUpdate:modelValue":b[0]||(b[0]=I=>e.note=I),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your note...",required:""},null,512),[[de,e.note]]),m(O,{message:y.note?y.note[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","title","api-endpoint","form-data"]))}},Go={class:"task-history-list"},Qo={key:0,class:"text-center py-4"},Xo={key:1,class:"text-gray-500 text-sm py-2"},el={key:2,class:"space-y-3"},tl={class:"flex items-start"},sl={class:"text-xl mr-2"},al={class:"text-sm text-gray-700"},ol={class:"text-xs text-gray-500 mt-1"},ll={__name:"TaskHistoryList",props:{activities:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(a){const o=d=>d?new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",n=d=>(console.log(d),d.includes("created")?"🆕":d.includes("started")?"🚀":d.includes("paused")?"⏸️":d.includes("resumed")?"▶️":d.includes("unblocked")?"🔓":d.includes("blocked")?"⛔":d.includes("completed")?"✅":d.includes("revised")?"🔄":d.includes("deleted")?"🗑️":d.includes("assigned")?"👤":d.includes("updated")?"📝":d.includes("added note")?"🗒️":d.includes("commented")?"💬":"📋");return(d,e)=>(s(),r("div",Go,[a.loading?(s(),r("div",Qo,e[0]||(e[0]=[t("div",{class:"inline-block animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-indigo-500"},null,-1),t("p",{class:"mt-2 text-gray-500"},"Loading activity history...",-1)]))):a.activities.length===0?(s(),r("div",Xo," No activity history available for this task. ")):(s(),r("div",el,[(s(!0),r(Y,null,K(a.activities,g=>{var u;return s(),r("div",{key:g.id,class:"p-3 bg-gray-50 rounded-md"},[t("div",tl,[t("span",sl,j(n(g.description)),1),t("div",null,[t("p",al,j(g.description),1),t("p",ol," By "+j(((u=g.causer)==null?void 0:u.name)||"System")+" on "+j(o(g.created_at)),1)])])])}),128))]))]))}},rl=ke(ll,[["__scopeId","data-v-423d54af"]]),Rr=async()=>{try{return(await H.get("/api/assigned-tasks")).data}catch(a){throw console.error("Error fetching assigned tasks:",a),G("Failed to load assigned tasks"),a}},zr=async a=>{try{return(await H.get(`/api/projects/${a}/tasks`)).data}catch(o){throw console.error("Error fetching project tasks:",o),G("Failed to load project tasks"),o}},Fr=async a=>{try{return(await H.get(`/api/projects/${a}/due-and-overdue-tasks`)).data}catch(o){throw console.error("Error fetching due and overdue tasks:",o),G("Failed to load due and overdue tasks"),o}},nl=async a=>{if(!a||a.status==="In Progress")return a;try{me("Starting task...");const o=await H.post(`/api/tasks/${a.id}/start`);return se("Task started successfully"),o.data}catch(o){throw console.error("Error starting task:",o),G("Failed to start task. Please try again."),o}},il=async a=>{if(!a||a.status!=="In Progress")return te('Task can only be paused from "In Progress" status.'),a;try{me("Pausing task...");const o=await H.post(`/api/tasks/${a.id}/pause`);return se("Task paused successfully"),o.data}catch(o){throw console.error("Error pausing task:",o),G("Failed to pause task. Please try again."),o}},dl=async a=>{if(!a||a.status!=="Paused")return te('Task can only be resumed from "Paused" status.'),a;try{me("Resuming task...");const o=await H.post(`/api/tasks/${a.id}/resume`);return se("Task resumed successfully"),o.data}catch(o){throw console.error("Error resuming task:",o),G("Failed to resume task. Please try again."),o}},ul=async a=>{if(!a||a.status==="Done")return a;if(a.status!=="In Progress")throw te("Task must be started before it can be completed"),new Error("Task must be started before it can be completed");try{me("Completing task...");const o=await H.patch(`/api/tasks/${a.id}/complete`);return se("Task completed successfully"),o.data}catch(o){throw console.error("Error completing task:",o),o.response&&o.response.status===422?te(o.response.data.message||"Task must be started before it can be completed"):G("Failed to complete task. Please try again."),o}},cl=async(a,o)=>{if(!a||a.status==="Blocked")return te("Task is already blocked."),a;if(a.status==="Done")return te("Completed tasks cannot be blocked."),a;if(!o)throw te("Please provide a reason for blocking the task"),new Error("Blocking reason is required");try{me("Blocking task...");const n=await H.post(`/api/tasks/${a.id}/block`,{reason:o});return se("Task blocked successfully"),n.data}catch(n){throw console.error("Error blocking task:",n),G("Failed to block task. Please try again."),n}},ml=async a=>{if(!a||a.status!=="Blocked")return te("Task is not in a blocked state."),a;try{me("Unblocking task...");const o=await H.post(`/api/tasks/${a.id}/unblock`);return se("Task unblocked successfully"),o.data}catch(o){throw console.error("Error unblocking task:",o),G("Failed to unblock task. Please try again."),o}},vl=async a=>{if(!a||a.status!=="Done")return te("Only completed tasks can be revised."),a;try{me("Revising task...");const o=await H.post(`/api/tasks/${a.id}/revise`);return se("Task revised successfully"),o.data}catch(o){throw console.error("Error revising task:",o),o.response&&o.response.status===422?te(o.response.data.message||"Only completed tasks can be revised"):G("Failed to revise task. Please try again."),o}},pl=async a=>{if(!a)return!1;if(a.status!=="To Do")throw te("Only tasks in To Do status can be deleted"),new Error("Only tasks in To Do status can be deleted");if(!confirm("Are you sure you want to delete this task? This action cannot be undone."))return!1;try{return me("Deleting task..."),await H.delete(`/api/tasks/${a.id}`),se("Task deleted successfully"),!0}catch(o){throw console.error("Error deleting task:",o),G("Failed to delete task. Please try again."),o}},gl=a=>{switch(a){case"To Do":return"bg-yellow-100 text-yellow-800";case"In Progress":return"bg-blue-100 text-blue-800";case"Paused":return"bg-orange-100 text-orange-800";case"Blocked":return"bg-red-100 text-red-800";case"Done":return"bg-green-100 text-green-800";case"Archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Wr=a=>{switch(a){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Or=a=>a?a.charAt(0).toUpperCase()+a.slice(1):"Medium",fl=["checked","onChange"],yl={__name:"ChecklistComponent",props:{items:{type:Array,required:!0},apiEndpoint:{type:String,required:!0},title:{type:String,default:"Checklist"},containerClass:{type:String,default:"mt-4 p-3 bg-gray-100 rounded-lg text-sm text-gray-700 border border-gray-200"},titleClass:{type:String,default:"font-semibold text-gray-900 mb-2"},itemsContainerClass:{type:String,default:"space-y-1"},itemClass:{type:String,default:"flex items-center space-x-2"},checkboxClass:{type:String,default:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},completedItemClass:{type:String,default:"line-through text-gray-500"},successMessage:{type:String,default:"Checklist item updated!"},errorMessage:{type:String,default:"Failed to update checklist item"},payloadTransformer:{type:Function,default:null},checkListStyle:{type:String,default:"checklist"}},emits:["update:items","item-toggled"],setup(a,{emit:o}){const n=a,d=o,e=A(JSON.parse(JSON.stringify(n.items)));Q(()=>n.items,u=>{e.value=JSON.parse(JSON.stringify(u))},{deep:!0});async function g(u){const p=e.value[u],v=!p.completed;p.completed=v;try{let i;n.payloadTransformer?i=n.payloadTransformer(e.value,u):i={items:e.value},await H.put(n.apiEndpoint,i),d("update:items",e.value),d("item-toggled",{index:u,item:p,completed:v}),se(n.successMessage)}catch(i){console.error("Error updating checklist item:",i),p.completed=!v,G(n.errorMessage)}}return(u,p)=>e.value&&e.value.length>0?(s(),r("div",{key:0,class:U(a.containerClass)},[t("p",{class:U(a.titleClass)},j(a.title),3),t("ul",{class:U(a.itemsContainerClass)},[(s(!0),r(Y,null,K(e.value,(v,i)=>(s(),r("li",{key:i,class:U(a.itemClass)},[a.checkListStyle==="checklist"?(s(),r("input",{key:0,type:"checkbox",checked:v.completed,onChange:b=>g(i),class:U(a.checkboxClass)},null,42,fl)):h("",!0),t("span",{class:U({[a.completedItemClass]:v.completed})},j(v.name),3)],2))),128))],2)],2)):h("",!0)}};function He(a,o){return s(),r("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z","clip-rule":"evenodd"})])}const hl={class:"mt-4"},kl={__name:"ChecklistCreator",props:{modelValue:{type:Array,required:!0},placeholder:{type:String,default:"e.g., Task 1, Task 2, Task 3"},label:{type:String,default:"Checklist Items"},density:{type:String,default:"spacious",validator:a=>["spacious","tight","notes"].includes(a)}},emits:["update:modelValue"],setup(a,{emit:o}){const n=a,d=o,e=A([]),g=A([]);Q(()=>n.modelValue,b=>{e.value=JSON.parse(JSON.stringify(b)),(e.value.length===0||e.value[e.value.length-1].name.trim()!=="")&&e.value.push({name:"",completed:!1})},{immediate:!0,deep:!0}),Q(()=>e.value,b=>{d("update:modelValue",b)},{deep:!0});function u(b){e.value.splice(b,1),e.value.length===0&&e.value.push({name:"",completed:!1})}function p(b){b===e.value.length-1&&e.value[b].name.trim()!==""&&e.value.push({name:"",completed:!1})}function v(b){b<e.value.length-1&&ye(()=>{var y;(y=g.value[b+1])==null||y.focus()})}const i=B(()=>n.density==="tight"?{listClass:"space-y-1",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-1 text-sm"}:n.density==="notes"?{listClass:"space-y-0.5",itemClass:"flex items-center space-x-1",inputClass:"px-1 py-0.5 text-sm border-transparent focus:border-transparent focus:ring-0 bg-transparent"}:{listClass:"space-y-2",itemClass:"flex items-center space-x-2",inputClass:""});return(b,y)=>(s(),r("div",hl,[a.label?(s(),E(L,{key:0,value:a.label},null,8,["value"])):h("",!0),t("ul",{class:U(i.value.listClass)},[(s(!0),r(Y,null,K(e.value,(I,P)=>(s(),r("li",{key:P,class:U(i.value.itemClass)},[a.density==="notes"?(s(),E(D(He),{key:0,class:"h4 w-4",onClick:T=>u(P)},null,8,["onClick"])):h("",!0),m(le,{modelValue:I.name,"onUpdate:modelValue":T=>I.name=T,type:"text",class:U(["flex-1",i.value.inputClass]),placeholder:P===e.value.length-1?a.placeholder:"",onInput:T=>p(P),onKeyup:Ae(De(T=>v(P),["prevent"]),["enter"]),ref_for:!0,ref:T=>{T&&(g.value[P]=T)}},null,8,["modelValue","onUpdate:modelValue","class","placeholder","onInput","onKeyup"]),e.value.length>1&&a.density!=="notes"?(s(),E(Le,{key:1,type:"button",onClick:T=>u(P)},{default:x(()=>[m(D(He),{class:"h-4 w-4"})]),_:2},1032,["onClick"])):h("",!0)],2))),128))],2)]))}},bl={key:0,class:"text-center py-8 text-gray-500"},wl={key:1,class:"text-center py-8 text-red-600"},xl={key:2,class:"space-y-6"},_l={class:"bg-gray-50 p-4 rounded-lg shadow-sm"},$l={class:"text-xl font-bold text-gray-900 mb-2"},Cl={class:"flex items-center space-x-2 text-sm text-gray-600 mb-4"},Sl={key:0,class:"text-indigo-600 font-medium"},Tl={key:1,class:"text-purple-600 font-medium"},Il={class:"text-gray-700 leading-relaxed"},Al={class:"mt-4 flex flex-wrap gap-2"},jl={key:0,class:"text-xs text-gray-500 mt-1"},Dl={key:0,class:"bg-yellow-50 border-l-4 border-red-400 p-4 rounded-lg shadow-sm"},El={class:"flex items-center"},Ml={class:"ml-3"},Pl={class:"mt-2 text-sm text-yellow-700"},Nl={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm mb-4"},Vl={class:"flex justify-between items-center border-b pb-2 mb-4"},Ul={key:0},Bl={key:1},Ll={key:0,class:"mb-4"},Rl={class:"flex justify-end mt-4"},zl={key:2,class:"text-gray-500 text-sm py-2"},Fl={class:"space-y-4 p-4 bg-white rounded-lg shadow-sm"},Wl={class:"flex items-center justify-between py-2 border-b border-gray-100"},Ol={class:"flex-1 text-right"},ql={key:0,class:"text-xs text-gray-400 ml-1"},Hl={key:1,class:"flex items-center space-x-2"},Jl={class:"flex items-center justify-between py-2 border-b border-gray-100"},Yl={class:"flex-1 text-right"},Kl={key:1,class:"flex items-center space-x-2"},Zl={class:"flex items-center justify-between py-2 border-b border-gray-100"},Gl={class:"flex-1 text-right"},Ql={key:0,class:"text-xs text-gray-400 ml-1"},Xl={key:1,class:"flex items-center space-x-2"},er={class:"flex items-center justify-between py-2 border-b border-gray-100"},tr={class:"text-gray-700"},sr={class:"flex items-start py-2 border-b border-gray-100"},ar={class:"flex-1 flex flex-wrap gap-2"},or={key:0,class:"text-gray-500 text-sm"},lr={class:"bg-white p-4 rounded-lg shadow-sm"},rr={class:"flex justify-between items-center mb-4 border-b pb-2"},nr={key:0,class:"space-y-3"},ir={class:"text-sm text-gray-700"},dr={class:"text-xs text-gray-500 mt-1"},ur={key:1,class:"text-gray-500 text-sm py-2"},cr={class:"bg-white p-4 rounded-lg shadow-sm"},mr={key:3,class:"text-center py-8 text-gray-500"},vr={key:4,class:"mt-4 flex flex-col items-center"},pr={key:0,class:"text-xs text-red-500 mt-1"},gr={class:"p-6"},fr={class:"mb-4"},yr={class:"flex justify-end space-x-3"},hr={__name:"TaskDetailSidebar",props:{taskId:{type:Number,required:!0},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]}},emits:["close","task-updated","task-deleted"],setup(a,{emit:o}){const n=a,d=o,e=A(null),g=A(!0),u=A(""),p=A(!1),v=A(!1),i=A(!1),b=A(null),y=A(null),I=A(null),P=A([]),T=A(!1),k=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],$=A(!1),f=A(!1),l=A([{name:"",completed:!1}]),c=A(!1),w=async()=>{g.value=!0,u.value="";try{const M=await window.axios.get(`/api/tasks/${n.taskId}`);e.value=M.data,b.value=e.value.assigned_to_id||null,y.value=e.value.due_date||null,I.value=e.value.priority||"medium",S()}catch(M){u.value="Failed to load task details.",console.error("Error fetching task details:",M)}finally{g.value=!1}},S=async()=>{T.value=!0;try{const M=await window.axios.get("/api/activities",{params:{subject_type:"App\\Models\\Task",subject_id:n.taskId}});P.value=M.data}catch(M){console.error("Error fetching task activities:",M)}finally{T.value=!1}};Q(()=>n.taskId,M=>{M?w():e.value=null},{immediate:!0});const N=B(()=>n.projectUsers.map(M=>({value:M.id,label:M.name}))),q=async()=>{if(!e.value||b.value===e.value.assigned_to_id){p.value=!1;return}try{const M=await window.axios.patch(`/api/tasks/${e.value.id}`,{assigned_to_user_id:b.value});e.value=M.data,d("task-updated",e.value)}catch(M){console.error("Error updating assigned user:",M),b.value=e.value.assigned_to_id,G("Failed to update assigned user. Please try again.")}finally{p.value=!1}},ne=async()=>{if(!e.value||y.value===e.value.due_date){v.value=!1;return}try{const M=await window.axios.patch(`/api/tasks/${e.value.id}`,{due_date:y.value});e.value=M.data,d("task-updated",e.value)}catch(M){console.error("Error updating due date:",M),y.value=e.value.due_date,G("Failed to update due date. Please try again.")}finally{v.value=!1}},W=async()=>{if(!e.value||I.value===e.value.priority){i.value=!1;return}try{const M=await window.axios.patch(`/api/tasks/${e.value.id}`,{priority:I.value});e.value=M.data,d("task-updated",e.value)}catch(M){console.error("Error updating priority:",M),I.value=e.value.priority,G("Failed to update priority. Please try again.")}finally{i.value=!1}},V=()=>{$.value=!0},z=()=>{w(),$.value=!1},F=async()=>{try{await pl(e.value),d("task-deleted",e.value.id),d("close")}catch(M){console.error("Error deleting task:",M)}},ae=async()=>{try{e.value=await nl(e.value),d("task-updated",e.value),S()}catch(M){console.error("Error starting task:",M)}},st=async()=>{try{e.value=await il(e.value),d("task-updated",e.value),S()}catch(M){console.error("Error pausing task:",M)}},at=async()=>{try{e.value=await dl(e.value),d("task-updated",e.value),S()}catch(M){console.error("Error resuming task:",M)}},ot=async()=>{try{e.value=await ul(e.value),d("task-updated",e.value),S()}catch(M){console.error("Error completing task:",M)}},lt=async()=>{try{e.value=await vl(e.value),d("task-updated",e.value),S()}catch(M){console.error("Error revising task:",M)}},rt=()=>{var M;f.value=!f.value,f.value&&((M=e.value.details)!=null&&M.checklist&&e.value.details.checklist.length>0?(l.value=JSON.parse(JSON.stringify(e.value.details.checklist)),l.value[l.value.length-1].name!==""&&l.value.push({name:"",completed:!1})):l.value=[{name:"",completed:!1}])},nt=async()=>{if(!c.value){c.value=!0;try{const M=l.value.filter(pe=>pe.name.trim()!==""),_={details:{...e.value.details,checklist:M}},ve=await window.axios.patch(`/api/tasks/${e.value.id}`,_);e.value=ve.data,f.value=!1,se("Checklist saved successfully"),d("task-updated",e.value)}catch(M){console.error("Error saving checklist:",M),G("Failed to save checklist")}finally{c.value=!1}}},be=A(!1),fe=A(""),it=()=>{fe.value="",be.value=!0},dt=async()=>{if(!fe.value.trim()){te("Please provide a reason for blocking the task");return}try{e.value=await cl(e.value,fe.value),se("Task blocked successfully"),d("task-updated",e.value),S(),be.value=!1}catch(M){console.error("Error blocking task:",M)}},ut=async()=>{try{e.value=await ml(e.value),d("task-updated",e.value),S()}catch(M){console.error("Error unblocking task:",M)}},ct=B(()=>e.value?gl(e.value.status):""),Pe=B(()=>{var _,ve,pe,we;if(!P.value||((_=e.value)==null?void 0:_.status)!=="Blocked")return null;const M=P.value.find(xe=>{var _e,$e;return xe.event==="updated"&&(($e=(_e=xe.properties)==null?void 0:_e.attributes)==null?void 0:$e.status)==="Blocked"});return M?(console.log(M.properties),{causer:((ve=M.causer)==null?void 0:ve.name)||"Unknown",reason:((we=(pe=M.properties)==null?void 0:pe.attributes)==null?void 0:we.block_reason)||"No reason provided."}):null});return(M,_)=>{var ve,pe,we,xe,_e,$e,Re;return s(),r("div",null,[g.value?(s(),r("div",bl," Loading task details... ")):u.value?(s(),r("div",wl,j(u.value),1)):e.value?(s(),r("div",xl,[t("div",_l,[t("h4",$l,j(e.value.name),1),t("div",Cl,[t("span",{class:U(["px-2 py-1 rounded-full text-xs font-medium",ct.value])},j(e.value.status),3),e.value.task_type?(s(),r("span",Sl," | "+j((ve=e.value.task_type)==null?void 0:ve.name)+" | ",1)):h("",!0),_[14]||(_[14]=t("br",null,null,-1)),(pe=e.value.milestone)!=null&&pe.name?(s(),r("span",Tl,j((we=e.value.milestone)==null?void 0:we.name),1)):h("",!0)]),t("p",Il,j(e.value.description||"No description provided."),1),t("div",Al,[e.value.status==="To Do"?(s(),E(X,{key:0,onClick:ae,class:"bg-blue-600 hover:bg-blue-700"},{default:x(()=>_[15]||(_[15]=[C(" Start Task ",-1)])),_:1,__:[15]})):e.value.status==="In Progress"?(s(),E(X,{key:1,onClick:st,class:"bg-orange-600 hover:bg-orange-700"},{default:x(()=>_[16]||(_[16]=[C(" Pause Task ",-1)])),_:1,__:[16]})):e.value.status==="Paused"?(s(),E(X,{key:2,onClick:at,class:"bg-blue-600 hover:bg-blue-700"},{default:x(()=>_[17]||(_[17]=[C(" Resume Task ",-1)])),_:1,__:[17]})):e.value.status==="Blocked"?(s(),E(X,{key:3,onClick:ut,class:"bg-green-600 hover:bg-green-700"},{default:x(()=>_[18]||(_[18]=[C(" Unblock Task ",-1)])),_:1,__:[18]})):h("",!0),e.value.status==="To Do"||e.value.status==="In Progress"||e.value.status==="Paused"?(s(),E(X,{key:4,onClick:it,class:"bg-red-600 hover:bg-red-700"},{default:x(()=>_[19]||(_[19]=[C(" Block Task ",-1)])),_:1,__:[19]})):h("",!0),e.value.status==="In Progress"?(s(),E(X,{key:5,onClick:ot,class:"bg-green-600 hover:bg-green-700"},{default:x(()=>_[20]||(_[20]=[C(" Complete Task ",-1)])),_:1,__:[20]})):h("",!0),e.value.status==="Done"?(s(),E(X,{key:6,onClick:lt,class:"bg-yellow-600 hover:bg-yellow-700"},{default:x(()=>_[21]||(_[21]=[C(" Revise Task ",-1)])),_:1,__:[21]})):h("",!0)]),e.value.status==="Done"?(s(),r("div",jl,' Revising will change the task status back to "To Do" ')):h("",!0)]),e.value.status==="Blocked"&&Pe.value?(s(),r("div",Dl,[t("div",El,[_[23]||(_[23]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.487 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11.75 13a.75.75 0 01-1.5 0v-2.25a.75.75 0 011.5 0V13zm-1.5-7.5a.75.75 0 011.5 0v1.5a.75.75 0 01-1.5 0V5.5z","clip-rule":"evenodd"})])],-1)),t("div",Ml,[_[22]||(_[22]=t("h3",{class:"text-sm font-medium text-yellow-800"},"Task Blocked",-1)),t("div",Pl,[t("p",null,"This task was blocked by **"+j(Pe.value.causer)+"** with the following reason:",1),t("p",null,j(Pe.value.reason),1)])])])])):h("",!0),t("div",Nl,[t("div",Vl,[_[24]||(_[24]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Task Checklist",-1)),t("button",{onClick:rt,class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium flex items-center"},[f.value?(s(),r("span",Bl,"Cancel")):(s(),r("span",Ul,j((xe=e.value.details)!=null&&xe.checklist&&e.value.details.checklist.length>0?"Edit Checklist":"Add Checklist"),1))])]),f.value?(s(),r("div",Ll,[m(kl,{modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=R=>l.value=R),placeholder:"e.g., Review design, Update documentation",label:"Checklist Items",density:"notes"},null,8,["modelValue"]),t("div",Rl,[m(X,{onClick:nt,disabled:c.value,class:"flex items-center space-x-1"},{default:x(()=>[m(D(go),{class:"h-4 w-4"}),_[25]||(_[25]=t("span",null,"Save Checklist",-1))]),_:1,__:[25]},8,["disabled"])])])):h("",!0),(_e=e.value.details)!=null&&_e.checklist&&e.value.details.checklist.length>0&&!f.value?(s(),E(yl,{key:1,items:e.value.details.checklist,"api-endpoint":`/api/tasks/${e.value.id}`,title:"Items to complete:","payload-transformer":R=>({details:{...e.value.details,checklist:R}})},null,8,["items","api-endpoint","payload-transformer"])):h("",!0),(!(($e=e.value.details)!=null&&$e.checklist)||e.value.details.checklist.length===0)&&!f.value?(s(),r("div",zl,' No checklist items for this task yet. Click "Add Checklist" to create one. ')):h("",!0)]),t("div",Fl,[_[32]||(_[32]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"Task Attributes",-1)),t("div",Wl,[m(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[26]||(_[26]=[C("Assigned To:",-1)])),_:1,__:[26]}),t("div",Ol,[p.value?(s(),r("div",Hl,[m(oe,{id:"edit-assigned-to",modelValue:b.value,"onUpdate:modelValue":_[2]||(_[2]=R=>b.value=R),options:N.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1 flex-1","allow-empty":!0},null,8,["modelValue","options"]),t("button",{onClick:q,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:_[3]||(_[3]=R=>p.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:_[1]||(_[1]=R=>e.value.status!=="Done"?p.value=!0:te("Cannot change assignment for a completed task. Use the Revise button to change the task status first.")),class:U(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[C(j(((Re=e.value.assigned_to)==null?void 0:Re.name)||"Unassigned")+" ",1),e.value.status!=="Done"?(s(),r("span",ql,"(Click to edit)")):h("",!0)],2))])]),t("div",Jl,[m(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[27]||(_[27]=[C("Due Date:",-1)])),_:1,__:[27]}),t("div",Yl,[v.value?(s(),r("div",Kl,[m(le,{id:"edit-due-date",modelValue:y.value,"onUpdate:modelValue":_[5]||(_[5]=R=>y.value=R),type:"date",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:ne,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:_[6]||(_[6]=R=>v.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:_[4]||(_[4]=R=>v.value=!0),class:"cursor-pointer text-indigo-600 hover:text-indigo-800"},[C(j(e.value.due_date?D(xt)(e.value.due_date).format("MMM D, YYYY"):"No Due Date")+" ",1),_[28]||(_[28]=t("span",{class:"text-xs text-gray-400 ml-1"},"(Click to edit)",-1))]))])]),t("div",Zl,[m(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[29]||(_[29]=[C("Priority:",-1)])),_:1,__:[29]}),t("div",Gl,[i.value?(s(),r("div",Xl,[m(oe,{id:"edit-priority",modelValue:I.value,"onUpdate:modelValue":_[8]||(_[8]=R=>I.value=R),options:k,"value-key":"value","label-key":"label",placeholder:"Select priority",class:"mt-1 flex-1"},null,8,["modelValue"]),t("button",{onClick:W,class:"text-green-600 hover:text-green-800 text-sm font-medium"},"Save"),t("button",{onClick:_[9]||(_[9]=R=>i.value=!1),class:"text-gray-600 hover:text-gray-800 text-sm font-medium"},"Cancel")])):(s(),r("div",{key:0,onClick:_[7]||(_[7]=R=>e.value.status!=="Done"?i.value=!0:te("Cannot change priority for a completed task. Use the Revise button to change the task status first.")),class:U(["cursor-pointer",{"text-indigo-600 hover:text-indigo-800":e.value.status!=="Done","text-gray-500":e.value.status==="Done"}])},[t("span",{class:U({"text-red-600 font-medium":e.value.priority==="high","text-yellow-600 font-medium":e.value.priority==="medium","text-green-600 font-medium":e.value.priority==="low"})},j(e.value.priority?e.value.priority.charAt(0).toUpperCase()+e.value.priority.slice(1):"Medium"),3),e.value.status!=="Done"?(s(),r("span",Ql,"(Click to edit)")):h("",!0)],2))])]),t("div",er,[m(L,{class:"min-w-[100px] text-gray-600"},{default:x(()=>_[30]||(_[30]=[C("Created:",-1)])),_:1,__:[30]}),t("span",tr,j(e.value.created_at?new Date(e.value.created_at).toLocaleDateString():"N/A"),1)]),t("div",sr,[m(L,{class:"min-w-[100px] text-gray-600 mt-1"},{default:x(()=>_[31]||(_[31]=[C("Tags:",-1)])),_:1,__:[31]}),t("div",ar,[(s(!0),r(Y,null,K(e.value.tags,R=>(s(),r("span",{key:R.id,class:"inline-flex items-center px-3 py-1 text-sm font-medium bg-indigo-100 text-indigo-800 rounded-full shadow-sm"},j(R.name),1))),128)),!e.value.tags||e.value.tags.length===0?(s(),r("span",or,"No tags")):h("",!0)])])]),t("div",lr,[t("div",rr,[_[34]||(_[34]=t("h5",{class:"text-lg font-semibold text-gray-800"},"Notes",-1)),m(X,{onClick:V,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors"},{default:x(()=>_[33]||(_[33]=[C(" Add Note ",-1)])),_:1,__:[33]})]),e.value.notes&&e.value.notes.length>0?(s(),r("div",nr,[(s(!0),r(Y,null,K(e.value.notes,R=>(s(),r("div",{key:R.id,class:"p-3 bg-gray-50 rounded-md"},[t("p",ir,j(R.content),1),t("p",dr," By "+j(R.creator_name||"Unknown")+" on "+j(new Date(R.created_at).toLocaleDateString()),1)]))),128))])):(s(),r("div",ur,"No notes for this task yet."))]),t("div",cr,[_[35]||(_[35]=t("h5",{class:"text-lg font-semibold text-gray-800 border-b pb-2 mb-4"},"History",-1)),m(rl,{activities:P.value,loading:T.value},null,8,["activities","loading"])])])):(s(),r("div",mr," Select a task to view details. ")),e.value&&e.value.status!=="Done"?(s(),r("div",vr,[m(Le,{onClick:F,disabled:e.value.status!=="To Do"},{default:x(()=>_[36]||(_[36]=[C(" Delete Task ",-1)])),_:1,__:[36]},8,["disabled"]),e.value.status!=="To Do"?(s(),r("p",pr,"Task can only be deleted in 'To Do' status.")):h("",!0)])):h("",!0),m(Zo,{show:$.value,"task-for-note":e.value,onClose:_[10]||(_[10]=R=>$.value=!1),onNoteAdded:z},null,8,["show","task-for-note"]),m(Be,{show:be.value,onClose:_[13]||(_[13]=R=>be.value=!1)},{default:x(()=>[t("div",gr,[_[40]||(_[40]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Block Task ",-1)),t("div",fr,[_[37]||(_[37]=t("p",{class:"text-sm text-gray-600 mb-2"}," Please provide a reason for blocking this task: ",-1)),Z(t("textarea",{"onUpdate:modelValue":_[11]||(_[11]=R=>fe.value=R),class:"w-full rounded-md shadow-sm border-gray-300 focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:"3",placeholder:"Enter reason for blocking..."},null,512),[[de,fe.value]])]),t("div",yr,[m(Te,{onClick:_[12]||(_[12]=R=>be.value=!1)},{default:x(()=>_[38]||(_[38]=[C(" Cancel ",-1)])),_:1,__:[38]}),m(X,{onClick:dt,disabled:!fe.value.trim(),class:"bg-red-600 hover:bg-red-700"},{default:x(()=>_[39]||(_[39]=[C(" Block Task ",-1)])),_:1,__:[39]},8,["disabled"])])])]),_:1},8,["show"])])}}},kr={key:1,class:"p-4 text-gray-500"},br={key:0,class:"flex justify-end space-x-3"},wr={__name:"TaskSidebar",emits:["taskUpdated","taskDeleted"],setup(a){const o=A(null);return(n,d)=>(s(),E(Xe,{show:D(ue).show,"onUpdate:show":D(Ne),title:D(ue).taskId?"Task Details":"Details",initialWidth:50},{content:x(()=>[D(ue).taskId?(s(),E(hr,{key:0,"task-id":D(ue).taskId,"project-id":D(ue).projectId,"project-users":D(ue).projectUsers,ref_key:"taskDetailSidebarRef",ref:o,onClose:D(Ne),onTaskUpdated:d[0]||(d[0]=e=>{n.$emit("taskUpdated",e)}),onTaskDeleted:d[1]||(d[1]=e=>{n.$emit("taskDeleted",e),D(Ne)()})},null,8,["task-id","project-id","project-users","onClose"])):D(ue).show?(s(),r("div",kr," No task selected or task ID is missing. ")):h("",!0)]),footer:x(()=>[D(ue).taskId?(s(),r("div",br,[o.value&&o.value.task&&o.value.task.status!=="In Progress"&&o.value.task.status!=="Done"?(s(),E(Te,{key:0,onClick:o.value.startTask,class:"bg-blue-50 text-blue-700 hover:bg-blue-100"},{default:x(()=>d[2]||(d[2]=[C(" Start Task ",-1)])),_:1,__:[2]},8,["onClick"])):h("",!0),o.value&&o.value.task&&o.value.task.status==="In Progress"?(s(),E(Te,{key:1,onClick:o.value.completeTask,class:"bg-green-50 text-green-700 hover:bg-green-100"},{default:x(()=>d[3]||(d[3]=[C(" Complete Task ",-1)])),_:1,__:[3]},8,["onClick"])):h("",!0),o.value&&o.value.task?(s(),E(Le,{key:2,onClick:o.value.deleteTask,class:"bg-red-50 text-red-700 hover:bg-red-100"},{default:x(()=>d[4]||(d[4]=[C(" Delete Task ",-1)])),_:1,__:[4]},8,["onClick"])):h("",!0)])):h("",!0)]),_:1},8,["show","onUpdate:show","title"]))}},xr={class:"flex h-screen overflow-hidden"},_r={class:"flex-1 flex flex-col overflow-hidden"},$r={key:0,class:"bg-white shadow"},Cr={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},Sr={class:"flex-1 overflow-y-auto"},qr={__name:"AuthenticatedLayout",setup(a){const o=A(!1),n=A(!1),d=A(!1),e=A([]),g=A(!0),u=B(()=>Ie().props.id||null),p=A(null),v=async()=>{const $=localStorage.getItem("authToken");if($){window.axios.defaults.headers.common.Authorization=`Bearer ${$}`;try{await window.axios.get("/api/user")}catch(f){f.response&&f.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},i=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization},b=$=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},y=async()=>{g.value=!0;try{const $=await window.axios.get("/api/projects-simplified");e.value=$.data}catch($){console.error("Error fetching all projects for sidebar:",$),e.value=[]}finally{g.value=!1}},I=$=>{kt.visit(route("projects.show",$))},P=B(()=>Se.value.notifications.filter($=>!$.isRead).length),T=$=>{console.log("Task updated globally.",$)},k=$=>{console.log("Task deleted globally.",$)};return he(()=>{v(),p.value&&yt(p.value),y(),ht()}),($,f)=>(s(),r("div",xr,[m(Ft,{ref_key:"standardNotificationContainerRef",ref:p},null,512),m(Bt,{"sidebar-is-open":D(Se).show},null,8,["sidebar-is-open"]),m(ks),m(no,{"all-projects":e.value,"active-project-id":u.value,onProjectSelected:I},null,8,["all-projects","active-project-id"]),t("div",_r,[m(Eo,{"unread-notification-count":P.value,onOpenCreateTaskModal:f[0]||(f[0]=l=>n.value=!0),onOpenAddResource:f[1]||(f[1]=l=>d.value=!0),onOpenNotificationsSidebar:D(Fe)},null,8,["unread-notification-count","onOpenNotificationsSidebar"]),m(zo,{"showing-navigation-dropdown":o.value,"unread-notification-count":P.value,onOpenCreateTaskModal:f[2]||(f[2]=l=>n.value=!0),onOpenAddResource:f[3]||(f[3]=l=>d.value=!0),onOpenNotificationsSidebar:D(Fe),onLogoutSuccess:i,onLogoutError:b},null,8,["showing-navigation-dropdown","unread-notification-count","onOpenNotificationsSidebar"]),$.$slots.header?(s(),r("header",$r,[t("div",Cr,[re($.$slots,"header")])])):h("",!0),t("main",Sr,[re($.$slots,"default")]),m(sa,{show:n.value,onClose:f[4]||(f[4]=l=>n.value=!1),onSaved:f[5]||(f[5]=l=>n.value=!1)},null,8,["show"]),m(ra,{"api-endpoint":"/api/shareable-resources",show:d.value,onClose:f[6]||(f[6]=l=>d.value=!1)},null,8,["show"])]),m(wr,{onTaskUpdated:T,onTaskDeleted:k}),m(Da)]))}};export{Me as B,ra as C,Qe as T,qr as _,gs as a,Or as b,Wr as c,ul as d,pl as e,Rr as f,gl as g,vl as h,cl as i,yl as j,kl as k,He as l,Fs as m,Zo as n,zr as o,il as p,sa as q,dl as r,nl as s,Fr as t,ml as u};
