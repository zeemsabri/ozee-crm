import{A as be}from"./ApplicationLogo-CP5iE14k.js";import{B as ae,I as de,s as L,r as j,i as v,o as i,b as e,f as R,e as d,A as Z,J as Y,a as g,n as T,T as we,c as P,K as fe,h as I,l as J,w as O,d as ue,g as $,t as D,F as q,j as K,q as ke,m as _,k as ee,x as Q,L as ie,M as xe,H as ne,_ as ce,D as _e,z as pe,N as $e,O as Se,p as Ce}from"./app-DzkBA022.js";import{P as le}from"./PrimaryButton-BeZ86lrs.js";import{a as ge,_ as ye}from"./SecondaryButton-A-YRJ4V5.js";import{_ as W,b as H,a as oe}from"./InputError-CP20Ko4Q.js";let re=null;const Ae=r=>{re=r},me=(r,b="info",u=5e3)=>re?re.addNotification(r,b,u):(console.warn("Notification container not set. Call setNotificationContainer first."),null),je=(r,b=5e3)=>me(r,"success",b),Me=(r,b=5e3)=>me(r,"error",b),Qs=(r,b=5e3)=>me(r,"warning",b),Ee={class:"relative"},ve={__name:"Dropdown",props:{align:{type:String,default:"right"},width:{type:String,default:"48"},contentClasses:{type:String,default:"py-1 bg-white"}},setup(r){const b=r,u=m=>{c.value&&m.key==="Escape"&&(c.value=!1)};ae(()=>document.addEventListener("keydown",u)),de(()=>document.removeEventListener("keydown",u));const k=L(()=>({48:"w-48"})[b.width.toString()]),n=L(()=>b.align==="left"?"ltr:origin-top-left rtl:origin-top-right start-0":b.align==="right"?"ltr:origin-top-right rtl:origin-top-left end-0":"origin-top"),c=j(!1);return(m,x)=>(i(),v("div",Ee,[e("div",{onClick:x[0]||(x[0]=C=>c.value=!c.value)},[Z(m.$slots,"trigger")]),R(e("div",{class:"fixed inset-0 z-40",onClick:x[1]||(x[1]=C=>c.value=!1)},null,512),[[Y,c.value]]),d(we,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:g(()=>[R(e("div",{class:T(["absolute z-50 mt-2 rounded-md shadow-lg",[k.value,n.value]]),style:{display:"none"},onClick:x[2]||(x[2]=C=>c.value=!1)},[e("div",{class:T(["rounded-md ring-1 ring-black ring-opacity-5",r.contentClasses])},[Z(m.$slots,"content")],2)],2),[[Y,c.value]])]),_:3})]))}},X={__name:"DropdownLink",props:{href:{type:String,required:!0},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(r){return(b,u)=>(i(),P(I(J),fe({href:r.href,method:r.method,as:r.as},b.$attrs,{class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 transition duration-150 ease-in-out hover:bg-gray-100 focus:bg-gray-100 focus:outline-none"}),{default:g(()=>[Z(b.$slots,"default")]),_:3},16,["href","method","as"]))}},se={__name:"NavLink",props:{href:{type:String,required:!0},active:{type:Boolean}},setup(r){const b=r,u=L(()=>b.active?"inline-flex items-center px-1 pt-1 border-b-2 border-indigo-400 text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-700 transition duration-150 ease-in-out":"inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-500 hover:text-gray-700 hover:border-gray-300 focus:outline-none focus:text-gray-700 focus:border-gray-300 transition duration-150 ease-in-out");return(k,n)=>(i(),P(I(J),{href:r.href,class:T(u.value)},{default:g(()=>[Z(k.$slots,"default")]),_:3},8,["href","class"]))}},F={__name:"ResponsiveNavLink",props:{href:{type:String,required:!0},active:{type:Boolean},method:{type:String,default:"get"},as:{type:String,default:"a"}},setup(r){const b=r,u=L(()=>b.active?"block w-full ps-3 pe-4 py-2 border-l-4 border-indigo-400 text-start text-base font-medium text-indigo-700 bg-indigo-50 focus:outline-none focus:text-indigo-800 focus:bg-indigo-100 focus:border-indigo-700 transition duration-150 ease-in-out":"block w-full ps-3 pe-4 py-2 border-l-4 border-transparent text-start text-base font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-50 hover:border-gray-300 focus:outline-none focus:text-gray-800 focus:bg-gray-50 focus:border-gray-300 transition duration-150 ease-in-out");return(k,n)=>(i(),P(I(J),fe({href:r.href,method:r.method,as:r.as},k.$attrs,{class:u.value}),{default:g(()=>[Z(k.$slots,"default")]),_:3},16,["href","method","as","class"]))}},Te={class:"p-6"},Ie={class:"mt-6"},Pe={key:0,class:"mb-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded"},Ve={key:1,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},De={class:"flex items-center mb-3"},Be=["id","onUpdate:modelValue"],Le=["for"],Ue={key:0,class:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},Ne={key:0},ze={class:"mb-4"},Re={class:"flex items-center"},We=["id","checked","onChange"],He=["for"],Fe={key:0,class:"mb-4"},qe=["id","onUpdate:modelValue"],Ke={key:1,class:"mb-4"},Ye={class:"flex-1"},Je=["id","onUpdate:modelValue"],Qe={class:"flex-1"},Ge=["id","onUpdate:modelValue"],Xe={key:0,class:"flex items-end pb-1"},Ze=["onClick"],Oe=["onClick"],et={class:"mt-6 flex justify-end space-x-3"},tt={key:0,class:"flex items-center"},st={key:1},at={__name:"AvailabilityModal",props:{show:Boolean,date:{type:String,default:()=>{const r=new Date;return r.setDate(r.getDate()+1),r.toISOString().split("T")[0]}},nextWeekDates:{type:Array,default:()=>[]},userId:{type:Number,default:null}},emits:["close","availability-saved"],setup(r,{emit:b}){const u=()=>{const f=localStorage.getItem("authToken");f&&!Q.defaults.headers.common.Authorization&&(Q.defaults.headers.common.Authorization=`Bearer ${f}`,console.log("Auth headers set in AvailabilityModal"))},k=r,n=b,c=j({}),m=j({}),x=j(!1),C=j(""),y=()=>{const f=[],p=new Date,t=new Date(p);t.setDate(p.getDate()+1);for(let o=0;o<7;o++){const l=new Date(t);l.setDate(t.getDate()+o);const s=l.toISOString().split("T")[0];f.push({value:s,label:l.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),c.value[s]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}return f},w=j([]);ae(()=>{u(),k.nextWeekDates.length>0?(w.value=k.nextWeekDates,k.nextWeekDates.forEach(f=>{c.value[f.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})):w.value=y()});const A=async()=>{try{if(u(),w.value.length===0)return;const f=w.value[0].value,p=w.value[w.value.length-1].value,t=await Q.get("/api/availabilities",{params:{start_date:f,end_date:p,user_id:k.userId}});if(t.data&&t.data.availabilities){const o=t.data.availabilities;w.value.forEach(l=>{c.value[l.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}}),o.forEach(l=>{const s=l.date.split("T")[0];c.value[s]&&(c.value[s].isSelected=!0,c.value[s].isAvailable=l.is_available,l.is_available?c.value[s].timeSlots=l.time_slots&&l.time_slots.length>0?[...l.time_slots]:[{start_time:"",end_time:""}]:c.value[s].reason=l.reason||"")})}}catch(f){console.error("Error fetching existing availabilities:",f),w.value.forEach(p=>{c.value[p.value]={isSelected:!1,isAvailable:!0,reason:"",timeSlots:[{start_time:"",end_time:""}]}})}};O(()=>k.show,async f=>{f&&(m.value={},C.value="",await A())},{immediate:!0});const N=f=>{c.value[f].timeSlots.push({start_time:"",end_time:""})},z=(f,p)=>{c.value[f].timeSlots.length>1&&c.value[f].timeSlots.splice(p,1)},E=(f,p)=>{c.value[f].isAvailable=p,p?c.value[f].reason="":c.value[f].timeSlots=[{start_time:"",end_time:""}]},h=async()=>{x.value=!0,m.value={},C.value="";const f=[];let p=!1;for(const t of w.value){const o=t.value,l=c.value[o];if(l.isSelected){let s={};if(l.isAvailable)if(l.timeSlots.some(a=>!a.start_time||!a.end_time))s.timeSlots="Please fill in all time slots.",p=!0;else for(const a of l.timeSlots){const U=a.start_time.split(":").map(Number),S=a.end_time.split(":").map(Number);if(U.length!==2||S.length!==2||isNaN(U[0])||isNaN(U[1])||isNaN(S[0])||isNaN(S[1])){s.timeSlots="Invalid time format. Please use HH:MM format.",p=!0;break}const M=U[0]*60+U[1],V=S[0]*60+S[1];if(M>=V){s.timeSlots="End time must be after start time.",p=!0;break}}else l.reason.trim()||(s.reason="Please provide a reason for unavailability.",p=!0);Object.keys(s).length>0&&(m.value[o]=s),Object.keys(s).length===0&&f.push({date:o,is_available:l.isAvailable,reason:l.isAvailable?null:l.reason,time_slots:l.isAvailable?l.timeSlots:null})}}if(p){x.value=!1,m.value.general="Please correct the errors in the highlighted dates.";return}if(f.length===0){m.value.general="Please select at least one day to set availability for.",x.value=!1;return}try{u();const t=await Q.post("/api/availabilities/batch",{availabilities:f});C.value="Availability saved successfully!";try{const o=await Q.get("/api/availability-prompt");localStorage.setItem("shouldBlockUser",o.data.should_block_user),localStorage.setItem("allWeekdaysCovered",o.data.all_weekdays_covered);const l=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:o.data.should_block_user,allWeekdaysCovered:o.data.all_weekdays_covered}});window.dispatchEvent(l),console.log("Availability status updated from modal:",{shouldBlockUser:o.data.should_block_user,allWeekdaysCovered:o.data.all_weekdays_covered})}catch(o){console.error("Error updating availability status:",o)}n("availability-saved",t.data.availabilities),setTimeout(()=>{n("close")},1500)}catch(t){console.error("Error saving availability:",t),t.response&&t.response.data&&t.response.data.errors?m.value.general=t.response.data.message||"An error occurred while saving your availability.":t.response&&t.response.status===409?(C.value=t.response.data.message,setTimeout(()=>{n("close")},1500)):m.value.general="An unexpected error occurred while saving your availability."}finally{x.value=!1}};return(f,p)=>(i(),P(ye,{show:r.show,onClose:p[1]||(p[1]=t=>f.$emit("close")),"max-width":"xl"},{default:g(()=>[e("div",Te,[p[6]||(p[6]=e("h2",{class:"text-lg font-medium text-gray-900"}," Submit Your Weekly Availability ",-1)),p[7]||(p[7]=e("p",{class:"mt-1 text-sm text-gray-600"}," Please select the dates you wish to set availability for and provide your details for each. ",-1)),e("div",Ie,[e("form",{onSubmit:ue(h,["prevent"])},[C.value?(i(),v("div",Pe,D(C.value),1)):$("",!0),m.value.general?(i(),v("div",Ve,D(m.value.general),1)):$("",!0),(i(!0),v(q,null,K(w.value,t=>{var o,l;return i(),v("div",{key:t.value,class:T(["mb-6 p-4 border rounded-lg shadow-sm",[c.value[t.value].isSelected?"border-indigo-300 bg-indigo-50":"border-gray-200",c.value[t.value].isSelected&&!m.value[t.value]?"border-l-4 border-l-indigo-500":""]])},[e("div",De,[R(e("input",{type:"checkbox",id:`select_date_${t.value}`,"onUpdate:modelValue":s=>c.value[t.value].isSelected=s,class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,8,Be),[[ke,c.value[t.value].isSelected]]),e("label",{for:`select_date_${t.value}`,class:"ml-2 block text-base font-medium text-gray-800"},[_(D(t.label)+" ",1),c.value[t.value].isSelected?(i(),v("span",Ue," Saved ")):$("",!0)],8,Le)]),c.value[t.value].isSelected?(i(),v("div",Ne,[e("div",ze,[e("div",Re,[e("input",{type:"checkbox",id:`isAvailableToggle_${t.value}`,checked:c.value[t.value].isAvailable,onChange:s=>E(t.value,s.target.checked),class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"},null,40,We),e("label",{for:`isAvailableToggle_${t.value}`,class:"ml-2 block text-sm text-gray-700"}," I am available on this day ",8,He)])]),c.value[t.value].isAvailable?$("",!0):(i(),v("div",Fe,[d(W,{for:`reason_${t.value}`,value:"Reason for Not Available"},null,8,["for"]),R(e("textarea",{id:`reason_${t.value}`,"onUpdate:modelValue":s=>c.value[t.value].reason=s,rows:"2",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"e.g., Out of office, Holiday, Meeting all day"},null,8,qe),[[ee,c.value[t.value].reason]]),d(H,{message:(o=m.value[t.value])==null?void 0:o.reason,class:"mt-2"},null,8,["message"])])),c.value[t.value].isAvailable?(i(),v("div",Ke,[d(W,{value:"Available Time Slots"}),d(H,{message:(l=m.value[t.value])==null?void 0:l.timeSlots,class:"mt-2"},null,8,["message"]),(i(!0),v(q,null,K(c.value[t.value].timeSlots,(s,a)=>(i(),v("div",{key:a,class:"flex items-center space-x-2 mt-2"},[e("div",Ye,[d(W,{for:`start_time_${t.value}_${a}`,value:"Start Time",class:"text-xs"},null,8,["for"]),R(e("input",{id:`start_time_${t.value}_${a}`,type:"time","onUpdate:modelValue":U=>s.start_time=U,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Je),[[ee,s.start_time]])]),e("div",Qe,[d(W,{for:`end_time_${t.value}_${a}`,value:"End Time",class:"text-xs"},null,8,["for"]),R(e("input",{id:`end_time_${t.value}_${a}`,type:"time","onUpdate:modelValue":U=>s.end_time=U,class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm"},null,8,Ge),[[ee,s.end_time]])]),c.value[t.value].timeSlots.length>1?(i(),v("div",Xe,[e("button",{type:"button",onClick:U=>z(t.value,a),class:"p-2 text-red-600 hover:text-red-800"},p[2]||(p[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 012 0v6a1 1 0 11-2 0V8z","clip-rule":"evenodd"})],-1)]),8,Ze)])):$("",!0)]))),128)),e("button",{type:"button",onClick:s=>N(t.value),class:"mt-3 w-full flex items-center justify-center px-4 py-2 border border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-50 transition duration-150 ease-in-out"},p[3]||(p[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),_(" Add Another Time Slot ",-1)]),8,Oe)])):$("",!0)])):$("",!0)],2)}),128)),e("div",et,[d(ge,{onClick:p[0]||(p[0]=t=>f.$emit("close"))},{default:g(()=>p[4]||(p[4]=[_(" Cancel ",-1)])),_:1,__:[4]}),d(le,{disabled:x.value,class:T({"opacity-50":x.value})},{default:g(()=>[x.value?(i(),v("span",tt,p[5]||(p[5]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),_(" Saving... ",-1)]))):(i(),v("span",st,"Save Availability"))]),_:1},8,["disabled","class"])])],32)])])]),_:1},8,["show"]))}},ot={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},lt={class:"bg-white rounded-lg shadow-xl p-6 max-w-lg w-full mx-4"},it={class:"flex justify-center"},nt={__name:"AvailabilityBlocker",setup(r){const b=j(!1),u=j(!0),k=j(!1),n=j([]),c=L(()=>{var h;return((h=ie().props.auth.user)==null?void 0:h.id)||null}),m=()=>{const h=localStorage.getItem("authToken");h&&!Q.defaults.headers.common.Authorization&&(Q.defaults.headers.common.Authorization=`Bearer ${h}`)},x=async()=>{u.value=!0;const h=localStorage.getItem("shouldBlockUser"),f=localStorage.getItem("allWeekdaysCovered");if(h==="true"&&f==="false")b.value=!0,await C();else try{m();const p=await Q.get("/api/availability-prompt");b.value=p.data.should_block_user&&!p.data.all_weekdays_covered,b.value&&await C()}catch(p){console.error("Error checking if user should be blocked:",p),b.value=!1}u.value=!1},C=async()=>{try{m();const h=await Q.get("/api/availability-prompt");y(h.data.next_week_start,h.data.next_week_end)}catch(h){console.error("Error fetching next week dates:",h)}},y=(h,f)=>{const p=[],t=new Date(h),o=new Date(f),l=new Date(t);for(;l<=o;)p.push({value:l.toISOString().split("T")[0],label:l.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),l.setDate(l.getDate()+1);n.value=p},w=()=>{k.value=!0},A=()=>{x()},N=h=>{b.value=h.detail.shouldBlockUser&&!h.detail.allWeekdaysCovered},z=()=>{document.visibilityState==="visible"&&ne(()=>{x()})},E=h=>{(h.key==="shouldBlockUser"||h.key==="allWeekdaysCovered")&&ne(()=>{x()})};return ae(()=>{x(),window.addEventListener("availability-status-updated",N),document.addEventListener("visibilitychange",z),window.addEventListener("storage",E)}),de(()=>{window.removeEventListener("availability-status-updated",N),document.removeEventListener("visibilitychange",z),window.removeEventListener("storage",E)}),(h,f)=>b.value&&!u.value?(i(),v("div",ot,[e("div",lt,[f[2]||(f[2]=xe('<div class="flex items-center mb-4"><div class="flex-shrink-0 mr-3"><svg class="h-8 w-8 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg></div><h2 class="text-xl font-bold text-gray-900">Action Required</h2></div><p class="mb-6 text-gray-700"> You must submit your availability for all weekdays of next week before you can continue using the application. This is required for planning meetings and work schedules. </p>',2)),e("div",it,[d(le,{onClick:w,class:"bg-red-600 hover:bg-red-700"},{default:g(()=>f[1]||(f[1]=[_(" Submit Availability Now ",-1)])),_:1,__:[1]})]),d(at,{show:k.value,"next-week-dates":n.value,date:n.value.length>0?n.value[0].value:"",userId:c.value,onClose:f[0]||(f[0]=p=>k.value=!1),onAvailabilitySaved:A},null,8,["show","next-week-dates","date","userId"])])])):$("",!0)}},rt={class:"p-6"},dt={class:"flex justify-between items-center mb-4"},ut={class:"text-lg font-medium text-gray-900"},ct={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},mt={class:"block sm:inline"},vt={key:0,class:"mt-6 flex justify-end space-x-3"},ft={__name:"BaseFormModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"Modal Title"},apiEndpoint:{type:String,required:!1},httpMethod:{type:String,default:"post",validator:r=>["post","put","patch","delete"].includes(r.toLowerCase())},formData:{type:Object,required:!0},submitButtonText:{type:String,default:"Save"},successMessage:{type:String,default:"Operation successful!"},formatDataForApi:{type:Function,default:r=>r},showFooter:{type:Boolean,default:!0}},emits:["close","submitted","error"],setup(r,{emit:b}){const u=r,k=b,n=j(!1),c=j({}),m=j("");O(()=>u.show,y=>{y&&(c.value={},m.value="",n.value=!1)});const x=async()=>{n.value=!0,c.value={},m.value="";try{const y=u.formatDataForApi(u.formData);console.log("BaseFormModal: Data being sent to API:",y);let w;const A=u.httpMethod.toLowerCase();if(A==="post")w=await window.axios.post(u.apiEndpoint,y);else if(A==="put")w=await window.axios.put(u.apiEndpoint,y);else if(A==="patch")w=await window.axios.patch(u.apiEndpoint,y);else if(A==="delete")w=await window.axios.delete(u.apiEndpoint,{data:y});else throw new Error(`Unsupported HTTP method: ${u.httpMethod}`);je(u.successMessage),k("submitted",w.data),k("close")}catch(y){console.error("BaseFormModal: API submission error:",y),y.response?y.response.status===422?(c.value=y.response.data.errors,m.value="Please correct the errors in the form."):m.value=y.response.data.message||"An unexpected error occurred.":m.value="A network error occurred or the server is unreachable.",Me(m.value),k("error",y)}finally{n.value=!1}},C=()=>{k("close")};return(y,w)=>(i(),P(ye,{show:r.show,onClose:C},{default:g(()=>[e("div",rt,[e("div",dt,[e("h2",ut,D(r.title),1),e("button",{onClick:C,class:"text-gray-400 hover:text-gray-500"},w[0]||(w[0]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),m.value?(i(),v("div",ct,[e("span",mt,D(m.value),1)])):$("",!0),e("form",{onSubmit:ue(x,["prevent"])},[Z(y.$slots,"default",{errors:c.value},void 0,!0),r.showFooter?(i(),v("div",vt,[d(ge,{onClick:C,type:"button",disabled:n.value},{default:g(()=>w[1]||(w[1]=[_(" Cancel ",-1)])),_:1,__:[1]},8,["disabled"]),d(le,{type:"submit",disabled:n.value,class:T({"opacity-75 cursor-not-allowed":n.value})},{default:g(()=>[_(D(n.value?"Submitting...":r.submitButtonText),1)]),_:1},8,["disabled","class"])])):$("",!0)],32)])]),_:3},8,["show"]))}},he=ce(ft,[["__scopeId","data-v-a2f6d2f8"]]),pt=["disabled"],gt={class:"absolute z-50 mt-1 w-full rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"},yt={class:"p-2 border-b border-gray-200"},ht=["onClick"],bt={key:0,class:"block px-4 py-2 text-sm text-gray-500"},wt={__name:"SelectDropdown",props:{modelValue:{type:[String,Number,Object,null],default:null},options:{type:Array,default:()=>[]},placeholder:{type:String,default:"Select an option"},valueKey:{type:String,default:"value"},labelKey:{type:String,default:"label"},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},maxHeight:{type:String,default:"250px"},width:{type:String,default:"full"},labelClass:{type:String,default:"text-xs"}},emits:["update:modelValue","change"],setup(r,{emit:b}){const u=r,k=b,n=j(!1),c=j(""),m=j(null),x=j(null),C=L(()=>{if(!c.value)return u.options;const E=c.value.toLowerCase();return u.options.filter(h=>h[u.labelKey].toLowerCase().includes(E))}),y=E=>{m.value&&!m.value.contains(E.target)&&(n.value=!1,c.value="")},w=E=>{E.key==="Escape"&&n.value&&(n.value=!1,c.value="")};ae(()=>{document.addEventListener("click",y),document.addEventListener("keydown",w)}),de(()=>{document.removeEventListener("click",y),document.removeEventListener("keydown",w)});const A=L(()=>{if(u.modelValue===null||u.modelValue===void 0||u.modelValue==="")return u.placeholder;const E=u.options.find(h=>h[u.valueKey]===u.modelValue);return E?E[u.labelKey]:u.placeholder}),N=E=>{k("update:modelValue",E[u.valueKey]),k("change",E[u.valueKey]),n.value=!1,c.value=""},z=()=>{u.disabled||(n.value=!n.value,n.value&&ne(()=>{x.value&&x.value.focus()}))};return O(()=>u.modelValue,E=>{(E==null||E==="")&&(c.value="")}),(E,h)=>(i(),v("div",{ref_key:"dropdownRef",ref:m,class:T(["relative",{"w-full":r.width==="full"}])},[e("button",{type:"button",onClick:z,disabled:r.disabled,class:T(["border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full text-left px-3 py-2 text-gray-700 bg-white relative flex items-center justify-between",{"opacity-50 cursor-not-allowed":r.disabled}])},[e("span",{class:T({"text-gray-500":!u.modelValue})},D(A.value),3),h[3]||(h[3]=e("svg",{class:"h-4 w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))],10,pt),R(e("div",gt,[e("div",yt,[R(e("input",{ref_key:"searchInputRef",ref:x,type:"text","onUpdate:modelValue":h[0]||(h[0]=f=>c.value=f),onInput:h[1]||(h[1]=f=>n.value=!0),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm",placeholder:"Search...",onClick:h[2]||(h[2]=ue(()=>{},["stop"]))},null,544),[[ee,c.value]])]),e("div",{class:"py-1 overflow-y-auto",style:_e({maxHeight:r.maxHeight})},[(i(!0),v(q,null,K(C.value,f=>(i(),v("div",{key:f[r.valueKey],onClick:p=>N(f),class:T(["block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",{"bg-gray-100":f[r.valueKey]===r.modelValue}])},D(f[r.labelKey]),11,ht))),128)),C.value.length===0?(i(),v("div",bt," No options available ")):$("",!0)],4)],512),[[Y,n.value]])],2))}},te=ce(wt,[["__scopeId","data-v-d2f1cfa0"]]),kt={class:"space-y-4"},xt="Add New Milestone",_t="/api/milestones",$t="post",St="Create Milestone",Ct="Milestone created successfully!",At={__name:"MilestoneFormModal",props:{show:Boolean,projectId:Number},emits:["close","saved"],setup(r,{emit:b}){const u=r,k=b,n=pe({name:"",description:"",completion_date:null,status:"Not Started",project_id:u.projectId}),c=["Not Started","In Progress","Completed","Overdue"];O(()=>u.show,C=>{C&&Object.assign(n,{name:"",description:"",completion_date:null,status:"Not Started",project_id:u.projectId})},{immediate:!0});const m=C=>{k("saved",C),k("close")},x=()=>{k("close")};return(C,y)=>(i(),P(he,{show:r.show,title:xt,"api-endpoint":_t,"http-method":$t,"form-data":n,"submit-button-text":St,"success-message":Ct,onClose:x,onSubmitted:m},{default:g(({errors:w})=>[e("div",kt,[e("div",null,[d(W,{for:"milestone-name",value:"Milestone Name"}),d(oe,{id:"milestone-name",modelValue:n.name,"onUpdate:modelValue":y[0]||(y[0]=A=>n.name=A),type:"text",class:"mt-1 block w-full",placeholder:"Enter milestone name",required:""},null,8,["modelValue"]),d(H,{message:w.name?w.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"milestone-description",value:"Description"}),R(e("textarea",{id:"milestone-description","onUpdate:modelValue":y[1]||(y[1]=A=>n.description=A),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter milestone description"},null,512),[[ee,n.description]]),d(H,{message:w.description?w.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"milestone-completion-date",value:"Completion Date"}),d(oe,{id:"milestone-completion-date",modelValue:n.completion_date,"onUpdate:modelValue":y[2]||(y[2]=A=>n.completion_date=A),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),d(H,{message:w.completion_date?w.completion_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"milestone-status",value:"Status"}),d(te,{id:"milestone-status",modelValue:n.status,"onUpdate:modelValue":y[3]||(y[3]=A=>n.status=A),options:c.map(A=>({value:A,label:A})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),d(H,{message:w.status?w.status[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]))}},jt={class:"space-y-4"},Mt={key:0},Et={key:0,class:"text-sm text-gray-500"},Tt={key:0,class:"text-sm text-gray-500"},It={key:0,class:"text-sm text-gray-500"},Pt={class:"flex items-center gap-2 mt-1"},Vt={key:0,class:"text-sm text-gray-500"},Dt=["disabled"],Bt="Create New Task",Lt="/api/tasks",Ut="post",Nt="Create Task",zt="Task created successfully!",Rt={__name:"CreateTaskModal",props:{show:Boolean,projectId:{type:Number,default:null}},emits:["close","saved"],setup(r,{emit:b}){const u=r,k=b,n=pe({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:u.projectId}),c=["To Do","In Progress","Done","Blocked","Archived"],m=j([]),x=j([]),C=j([]),y=j([]),w=j(!0),A=j(!1),N=j(!1),z=j(!1),E=j(!1);O(()=>u.show,async S=>{S&&(Object.assign(n,{name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,project_id:u.projectId}),u.projectId?await f(u.projectId):await h())},{immediate:!0}),O(()=>n.project_id,async S=>{S?await f(S):(x.value=[],C.value=[],y.value=[])});const h=async()=>{w.value=!0;try{const S=await window.axios.get("/api/projects-simplified");m.value=S.data.map(M=>({value:M.id,label:M.name}))}catch(S){console.error("Error fetching projects:",S),m.value=[]}finally{w.value=!1}},f=async S=>{if(S){A.value=!0,N.value=!0,z.value=!0;try{const[M,V,B]=await Promise.all([window.axios.get(`/api/projects/${S}/users`),window.axios.get("/api/task-types"),window.axios.get(`/api/projects/${S}/milestones`)]);x.value=M.data.map(G=>({value:G.id,label:G.name})),C.value=V.data.map(G=>({value:G.id,label:G.name})),y.value=B.data.map(G=>({value:G.id,label:G.name}))}catch(M){console.error("Error fetching associated task data:",M),x.value=[],C.value=[],y.value=[]}finally{A.value=!1,N.value=!1,z.value=!1}}},p=S=>{k("saved",S),k("close")},t=()=>{k("close")},o=()=>{n.project_id?E.value=!0:alert("Please select a project before adding a milestone.")},l=S=>{if(E.value=!1,S&&S.id&&S.name){const M={value:S.id,label:S.name};y.value.some(V=>V.value===M.value)||y.value.push(M),n.milestone_id=M.value}},s=L(()=>x.value),a=L(()=>C.value),U=L(()=>y.value);return(S,M)=>(i(),v(q,null,[d(he,{show:r.show,title:Bt,"api-endpoint":Lt,"http-method":Ut,"form-data":n,"submit-button-text":Nt,"success-message":zt,onClose:t,onSubmitted:p},{default:g(({errors:V})=>[e("div",jt,[r.projectId?$("",!0):(i(),v("div",Mt,[d(W,{for:"task-project",value:"Project"}),w.value?(i(),v("div",Et,"Loading projects...")):(i(),P(te,{key:1,id:"task-project",modelValue:n.project_id,"onUpdate:modelValue":M[0]||(M[0]=B=>n.project_id=B),options:m.value,"value-key":"value","label-key":"label",placeholder:"Select a project",class:"mt-1",required:!0},null,8,["modelValue","options"])),d(H,{message:V.project_id?V.project_id[0]:"",class:"mt-2"},null,8,["message"])])),e("div",null,[d(W,{for:"task-name",value:"Task Name"}),d(oe,{id:"task-name",modelValue:n.name,"onUpdate:modelValue":M[1]||(M[1]=B=>n.name=B),type:"text",class:"mt-1 block w-full",placeholder:"Enter task name",required:""},null,8,["modelValue"]),d(H,{message:V.name?V.name[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"task-description",value:"Description"}),R(e("textarea",{id:"task-description","onUpdate:modelValue":M[2]||(M[2]=B=>n.description=B),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[ee,n.description]]),d(H,{message:V.description?V.description[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"task-status",value:"Status"}),d(te,{id:"task-status",modelValue:n.status,"onUpdate:modelValue":M[3]||(M[3]=B=>n.status=B),options:c.map(B=>({value:B,label:B})),"value-key":"value","label-key":"label",placeholder:"Select status",class:"mt-1"},null,8,["modelValue","options"]),d(H,{message:V.status?V.status[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"task-due-date",value:"Due Date"}),d(oe,{id:"task-due-date",modelValue:n.due_date,"onUpdate:modelValue":M[4]||(M[4]=B=>n.due_date=B),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),d(H,{message:V.due_date?V.due_date[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"task-assigned-to",value:"Assigned To"}),A.value?(i(),v("div",Tt,"Loading users...")):(i(),P(te,{key:1,id:"task-assigned-to",modelValue:n.assigned_to_user_id,"onUpdate:modelValue":M[5]||(M[5]=B=>n.assigned_to_user_id=B),options:s.value,"value-key":"value","label-key":"label",placeholder:"Unassigned",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),d(H,{message:V.assigned_to_user_id?V.assigned_to_user_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"task-type",value:"Task Type"}),N.value?(i(),v("div",It,"Loading task types...")):(i(),P(te,{key:1,id:"task-type",modelValue:n.task_type_id,"onUpdate:modelValue":M[6]||(M[6]=B=>n.task_type_id=B),options:a.value,"value-key":"value","label-key":"label",placeholder:"Select a task type",class:"mt-1","allow-empty":!0},null,8,["modelValue","options"])),d(H,{message:V.task_type_id?V.task_type_id[0]:"",class:"mt-2"},null,8,["message"])]),e("div",null,[d(W,{for:"task-milestone",value:"Milestone"}),e("div",Pt,[z.value?(i(),v("div",Vt,"Loading milestones...")):(i(),P(te,{key:1,id:"task-milestone",modelValue:n.milestone_id,"onUpdate:modelValue":M[7]||(M[7]=B=>n.milestone_id=B),options:U.value,"value-key":"value","label-key":"label",placeholder:"No milestone",class:"flex-grow","allow-empty":!0,disabled:!n.project_id},null,8,["modelValue","options","disabled"])),e("button",{type:"button",onClick:o,disabled:!n.project_id||z.value,class:"px-3 py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Add New Milestone"},M[9]||(M[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1)]),8,Dt)]),d(H,{message:V.milestone_id?V.milestone_id[0]:"",class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]),d(At,{show:E.value,"project-id":n.project_id,onClose:M[8]||(M[8]=V=>E.value=!1),onSaved:l},null,8,["show","project-id"])],64))}},Wt={class:"flex items-center p-4 h-16 border-b border-gray-700"},Ht={key:0,class:"text-xl font-semibold flex-1 truncate"},Ft=["title"],qt={key:0,class:"p-4 border-b border-gray-700"},Kt={class:"relative"},Yt={key:1,class:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-500 scrollbar-track-gray-700 p-4"},Jt={key:0,class:"mb-4"},Qt={class:"ml-2 mt-2 space-y-1"},Gt=["onClick"],Xt={class:"text-sm font-medium text-gray-300 truncate"},Zt={class:"ml-4 mt-1 space-y-1"},Ot={class:"truncate"},es={key:1,class:"mb-4"},ts={class:"ml-2 mt-2 space-y-1"},ss=["onClick"],as={class:"text-sm font-medium text-gray-300 truncate"},os={class:"ml-4 mt-1 space-y-1"},ls={class:"truncate"},is={key:2,class:"mb-4"},ns={class:"ml-2 mt-2 space-y-1"},rs={class:"truncate"},ds={key:3,class:"mb-4"},us={class:"ml-2 mt-2 space-y-1"},cs={class:"truncate"},ms={key:4,class:"text-gray-400 text-sm text-center py-4"},vs={key:5,class:"text-gray-400 text-sm text-center py-4"},fs={key:2,class:"flex flex-col items-center pt-4 space-y-4"},ps={key:0,class:"text-gray-400 text-xs text-center px-2"},gs={__name:"LeftSidebar",props:{allProjects:{type:Array,default:()=>[]},activeProjectId:{type:Number,default:null}},emits:["project-selected"],setup(r,{emit:b}){const u=r,k=b,n=j(localStorage.getItem("leftSidebarCollapsed")!=="false"),c=j(""),m=j({}),x=L(()=>{const t=new Set;return u.allProjects.forEach(o=>{o.project_type&&t.add(o.project_type)}),Array.from(t).sort()}),C=L(()=>{const t=new Set;return u.allProjects.forEach(o=>{Array.isArray(o.tags)&&o.tags.forEach(l=>t.add(l))}),Array.from(t).sort()}),y=L(()=>{if(!c.value)return u.allProjects;const t=c.value.toLowerCase();return u.allProjects.filter(o=>{var l,s,a;return o.name.toLowerCase().includes(t)||((l=o.description)==null?void 0:l.toLowerCase().includes(t))||((s=o.project_type)==null?void 0:s.toLowerCase().includes(t))||Array.isArray(o.tags)&&o.tags.some(U=>U.toLowerCase().includes(t))||((a=o.status)==null?void 0:a.toLowerCase().includes(t))})}),w=L(()=>{const t={};y.value.forEach(o=>{o.project_type&&o.status==="active"&&(t[o.project_type]||(t[o.project_type]=[]),t[o.project_type].push(o))});for(const o in t)t[o].sort((l,s)=>l.name.localeCompare(s.name));return t}),A=L(()=>{const t={};y.value.forEach(o=>{Array.isArray(o.tags)&&o.tags.length>0&&o.tags.forEach(l=>{t[l]||(t[l]=[]),t[l].push(o)})});for(const o in t)t[o]=[...new Set(t[o])].sort((l,s)=>l.name.localeCompare(s.name));return t}),N=L(()=>y.value.filter(t=>t.status!=="active").sort((t,o)=>t.name.localeCompare(o.name))),z=L(()=>y.value.filter(t=>!t.project_type&&(!Array.isArray(t.tags)||t.tags.length===0)).sort((t,o)=>t.name.localeCompare(o.name)));O(()=>u.allProjects,()=>{x.value.forEach(t=>{const o=`type-${t}`;m.value[o]===void 0&&(m.value[o]=!0)}),C.value.forEach(t=>{const o=`tag-${t}`;m.value[o]===void 0&&(m.value[o]=!0)}),m.value["main-types"]===void 0&&(m.value["main-types"]=!1),m.value["main-tags"]===void 0&&(m.value["main-tags"]=!1),m.value["inactive-projects"]===void 0&&(m.value["inactive-projects"]=!1),m.value.uncategorized===void 0&&(m.value.uncategorized=!1)},{immediate:!0}),O(n,t=>{localStorage.setItem("leftSidebarCollapsed",t)});const E=()=>{n.value=!n.value},h=t=>{m.value[t]=!m.value[t]},f=t=>{k("project-selected",t)},p=()=>{c.value=""};return(t,o)=>(i(),v("div",{class:T({"w-64":!n.value,"w-16":n.value,"min-w-16":!0,"bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out shrink-0 h-screen overflow-hidden":!0})},[e("div",Wt,[n.value?$("",!0):(i(),v("h2",Ht,"Projects")),e("button",{onClick:E,class:"p-2 rounded-full hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:n.value?"Expand Sidebar":"Collapse Sidebar"},[(i(),v("svg",{class:T(["w-6 h-6 text-gray-400 transform transition-transform duration-300",{"rotate-180":n.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},o[5]||(o[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)]),2))],8,Ft)]),n.value?$("",!0):(i(),v("div",qt,[e("div",Kt,[R(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>c.value=l),placeholder:"Search all projects...",class:"w-full p-2 rounded-md bg-gray-700 border border-gray-600 text-white placeholder-gray-400 focus:ring-indigo-500 focus:border-indigo-500 text-sm"},null,512),[[ee,c.value]]),c.value?(i(),v("button",{key:0,onClick:p,class:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-200",title:"Clear search"},o[6]||(o[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):$("",!0)])])),n.value?(i(),v("div",fs,[(i(!0),v(q,null,K(u.allProjects,l=>(i(),P(I(J),{key:l.id,href:t.route("projects.show",l.id),onClick:s=>f(l.id),class:T({"w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-200":!0,"bg-indigo-600 text-white":l.id===r.activeProjectId,"bg-gray-700 text-gray-300 hover:bg-gray-600":l.id!==r.activeProjectId}),title:l.name},{default:g(()=>[_(D(l.name.charAt(0).toUpperCase()),1)]),_:2},1032,["href","onClick","class","title"]))),128)),r.allProjects.length===0?(i(),v("div",ps," No Projects ")):$("",!0)])):(i(),v("div",Yt,[Object.keys(w.value).length>0?(i(),v("div",Jt,[e("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[1]||(o[1]=l=>h("main-types"))},[o[8]||(o[8]=e("h3",{class:"text-sm font-semibold text-gray-400"},"Active Projects by Type",-1)),(i(),v("svg",{class:T(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!m.value["main-types"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[7]||(o[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),R(e("div",Qt,[(i(!0),v(q,null,K(w.value,(l,s)=>(i(),v("div",{key:s},[e("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:a=>h(`type-${s}`)},[e("h4",Xt,D(s),1),(i(),v("svg",{class:T(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!m.value[`type-${s}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[9]||(o[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,Gt),R(e("ul",Zt,[(i(!0),v(q,null,K(l,a=>(i(),v("li",{key:a.id},[d(I(J),{href:t.route("projects.show",a.id),onClick:U=>f(a.id),class:T({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":a.id===r.activeProjectId,"hover:bg-gray-700 text-gray-200":a.id!==r.activeProjectId,"font-bold":a.id===r.activeProjectId})},{default:g(()=>[e("span",Ot,D(a.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[Y,!m.value[`type-${s}`]]])]))),128))],512),[[Y,!m.value["main-types"]]])])):$("",!0),Object.keys(A.value).length>0?(i(),v("div",es,[e("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[2]||(o[2]=l=>h("main-tags"))},[o[11]||(o[11]=e("h3",{class:"text-sm font-semibold text-gray-400"},"Projects by Tag",-1)),(i(),v("svg",{class:T(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!m.value["main-tags"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[10]||(o[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),R(e("div",ts,[(i(!0),v(q,null,K(A.value,(l,s)=>(i(),v("div",{key:s},[e("div",{class:"flex items-center justify-between cursor-pointer py-1 hover:bg-gray-700 rounded-md px-2",onClick:a=>h(`tag-${s}`)},[e("h4",as,D(s),1),(i(),v("svg",{class:T(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!m.value[`tag-${s}`]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[12]||(o[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))],8,ss),R(e("ul",os,[(i(!0),v(q,null,K(l,a=>(i(),v("li",{key:a.id},[d(I(J),{href:t.route("projects.show",a.id),onClick:U=>f(a.id),class:T({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":a.id===r.activeProjectId,"hover:bg-gray-700 text-gray-200":a.id!==r.activeProjectId,"font-bold":a.id===r.activeProjectId})},{default:g(()=>[e("span",ls,D(a.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[Y,!m.value[`tag-${s}`]]])]))),128))],512),[[Y,!m.value["main-tags"]]])])):$("",!0),N.value.length>0?(i(),v("div",is,[e("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[3]||(o[3]=l=>h("inactive-projects"))},[o[14]||(o[14]=e("h3",{class:"text-sm font-semibold text-gray-400"},"Inactive Projects",-1)),(i(),v("svg",{class:T(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!m.value["inactive-projects"]}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[13]||(o[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),R(e("ul",ns,[(i(!0),v(q,null,K(N.value,l=>(i(),v("li",{key:l.id},[d(I(J),{href:t.route("projects.show",l.id),onClick:s=>f(l.id),class:T({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":l.id===r.activeProjectId,"hover:bg-gray-700 text-gray-200":l.id!==r.activeProjectId,"font-bold":l.id===r.activeProjectId})},{default:g(()=>[e("span",rs,D(l.name)+" ("+D(l.status.replace("_"," "))+")",1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[Y,!m.value["inactive-projects"]]])])):$("",!0),z.value.length>0?(i(),v("div",ds,[e("div",{class:"flex items-center justify-between cursor-pointer py-2 hover:bg-gray-700 rounded-md px-2",onClick:o[4]||(o[4]=l=>h("uncategorized"))},[o[16]||(o[16]=e("h3",{class:"text-sm font-semibold text-gray-400"},"Uncategorized",-1)),(i(),v("svg",{class:T(["w-4 h-4 text-gray-400 transform transition-transform duration-200",{"rotate-90":!m.value.uncategorized}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},o[15]||(o[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"},null,-1)]),2))]),R(e("ul",us,[(i(!0),v(q,null,K(z.value,l=>(i(),v("li",{key:l.id},[d(I(J),{href:t.route("projects.show",l.id),onClick:s=>f(l.id),class:T({"block w-full text-left px-3 py-2 rounded-md transition-colors":!0,"bg-indigo-600 text-white":l.id===r.activeProjectId,"hover:bg-gray-700 text-gray-200":l.id!==r.activeProjectId,"font-bold":l.id===r.activeProjectId})},{default:g(()=>[e("span",cs,D(l.name),1)]),_:2},1032,["href","onClick","class"])]))),128))],512),[[Y,!m.value.uncategorized]])])):$("",!0),y.value.length===0?(i(),v("div",ms," No projects found matching your search. ")):r.allProjects.length===0&&!c.value?(i(),v("div",vs," No projects available. ")):$("",!0)]))],2))}},ys=ce(gs,[["__scopeId","data-v-417d431f"]]),hs={class:"flex h-screen overflow-hidden"},bs={class:"flex-1 flex flex-col overflow-hidden"},ws={class:"border-b border-gray-100 bg-white z-10 relative"},ks={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},xs={class:"flex h-16 justify-between"},_s={class:"flex"},$s={class:"flex shrink-0 items-center"},Ss={class:"hidden space-x-8 sm:-my-px sm:ms-10 sm:flex"},Cs={key:4,class:"hidden sm:flex sm:items-center"},As={class:"hidden sm:ms-6 sm:flex sm:items-center"},js={class:"relative ms-3"},Ms={class:"inline-flex rounded-md"},Es={type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},Ts={class:"-me-2 flex items-center sm:hidden"},Is={class:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"},Ps={class:"space-y-1 pb-3 pt-2"},Vs={key:6,class:"mt-3 space-y-1"},Ds={class:"border-t border-gray-200 pb-1 pt-4"},Bs={class:"px-4"},Ls={class:"text-base font-medium text-gray-800"},Us={class:"text-sm font-medium text-gray-500"},Ns={class:"text-sm font-medium text-gray-500 capitalize"},zs={class:"mt-3 space-y-1"},Rs={key:0,class:"bg-white shadow"},Ws={class:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8"},Hs={class:"flex-1 overflow-y-auto"},Gs={__name:"AuthenticatedLayout",setup(r){const b=j(!1),u=L(()=>ie().props.auth.user);L(()=>{var s;return((s=u.value.role_data)==null?void 0:s.name)||""});const{canDo:k}=$e(),n=k("manage_projects"),c=k("compose_emails"),m=k("approve_emails"),x=k("create_users"),C=k("manage_roles"),y=k("manage_task_types"),w=k("create_clients"),A=j(!1),N=j([]),z=j(!0),E=L(()=>ie().props.id||null),h=async()=>{const s=localStorage.getItem("authToken");if(s){window.axios.defaults.headers.common.Authorization=`Bearer ${s}`;try{await window.axios.get("/api/user")}catch(a){a.response&&a.response.status===401&&(console.log("Session expired, redirecting to login"),localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("remembered"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login")}}else delete window.axios.defaults.headers.common.Authorization},f=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization},p=s=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),delete window.axios.defaults.headers.common.Authorization,window.location.href="/login"},t=async()=>{z.value=!0;try{const s=await window.axios.get("/api/projects-simplified");N.value=s.data}catch(s){console.error("Error fetching all projects for sidebar:",s),N.value=[]}finally{z.value=!1}},o=s=>{Ce.visit(route("projects.show",s))},l=j(null);return ae(()=>{h(),l.value&&Ae(l.value),t()}),(s,a)=>{var U;return i(),v("div",hs,[d(Se,{ref_key:"notificationContainerRef",ref:l},null,512),d(nt),d(ys,{"all-projects":N.value,"active-project-id":E.value,onProjectSelected:o},null,8,["all-projects","active-project-id"]),e("div",bs,[e("nav",ws,[e("div",ks,[e("div",xs,[e("div",_s,[e("div",$s,[d(I(J),{href:s.route("dashboard")},{default:g(()=>[d(be,{class:"block h-16 w-auto fill-current text-gray-800"})]),_:1},8,["href"])]),e("div",Ss,[d(se,{href:s.route("dashboard"),active:s.route().current("dashboard")},{default:g(()=>a[5]||(a[5]=[_(" Dashboard ",-1)])),_:1,__:[5]},8,["href","active"]),I(n)?(i(),P(se,{key:0,href:s.route("projects.index"),active:s.route().current("projects.index")},{default:g(()=>a[6]||(a[6]=[_(" Projects ",-1)])),_:1,__:[6]},8,["href","active"])):$("",!0),I(m)?(i(),P(se,{key:1,href:s.route("emails.pending"),active:s.route().current("emails.pending")},{default:g(()=>a[7]||(a[7]=[_(" Approve Emails ",-1)])),_:1,__:[7]},8,["href","active"])):$("",!0),I(c)?(i(),P(se,{key:2,href:s.route("emails.rejected"),active:s.route().current("emails.rejected")},{default:g(()=>a[8]||(a[8]=[_(" Rejected Emails ",-1)])),_:1,__:[8]},8,["href","active"])):$("",!0),I(x)?(i(),P(se,{key:3,href:s.route("availability.index"),active:s.route().current("availability.index")},{default:g(()=>a[9]||(a[9]=[_(" Weekly Availability ",-1)])),_:1,__:[9]},8,["href","active"])):$("",!0),I(C)?(i(),v("div",Cs,[d(ve,{align:"right",width:"48"},{trigger:g(()=>a[10]||(a[10]=[e("span",{class:"inline-flex rounded-md"},[e("button",{type:"button",class:"inline-flex items-center rounded-md border border-transparent bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-500 transition duration-150 ease-in-out hover:text-gray-700 focus:outline-none"},[_(" Admin "),e("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])])],-1)])),content:g(()=>[I(w)?(i(),P(X,{key:0,href:s.route("clients.index"),active:s.route().current("clients.index")},{default:g(()=>a[11]||(a[11]=[_(" Clients ",-1)])),_:1,__:[11]},8,["href","active"])):$("",!0),I(x)?(i(),P(X,{key:1,href:s.route("users.index"),active:s.route().current("users.index")},{default:g(()=>a[12]||(a[12]=[_(" Users ",-1)])),_:1,__:[12]},8,["href","active"])):$("",!0),I(y)?(i(),P(X,{key:2,href:s.route("task-types.index"),active:s.route().current("task-types.index")},{default:g(()=>a[13]||(a[13]=[_(" Task Types ",-1)])),_:1,__:[13]},8,["href","active"])):$("",!0),d(X,{href:s.route("bonus-configuration.index"),active:s.route().current("bonus-configuration.index")},{default:g(()=>a[14]||(a[14]=[_(" Bonus Configuration ",-1)])),_:1,__:[14]},8,["href","active"]),d(X,{href:s.route("admin.roles.index")},{default:g(()=>a[15]||(a[15]=[_(" Manage Roles ",-1)])),_:1,__:[15]},8,["href"]),d(X,{href:s.route("admin.permissions.index")},{default:g(()=>a[16]||(a[16]=[_(" Manage Permissions ",-1)])),_:1,__:[16]},8,["href"])]),_:1})])):$("",!0)])]),e("div",As,[d(le,{type:"button",onClick:a[0]||(a[0]=S=>A.value=!0),class:"mr-4 px-4 py-2 text-sm"},{default:g(()=>a[17]||(a[17]=[_(" Add Task ",-1)])),_:1,__:[17]}),e("div",js,[d(ve,{align:"right",width:"48"},{trigger:g(()=>{var S;return[e("span",Ms,[e("button",Es,[_(D(u.value.name)+" ("+D((S=u.value.role_data)==null?void 0:S.name)+") ",1),a[18]||(a[18]=e("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1))])])]}),content:g(()=>[d(X,{href:s.route("profile.edit")},{default:g(()=>a[19]||(a[19]=[_(" Profile ",-1)])),_:1,__:[19]},8,["href"]),d(X,{href:s.route("logout"),method:"post",as:"button",onSuccess:f,onError:p},{default:g(()=>a[20]||(a[20]=[_(" Log Out ",-1)])),_:1,__:[20]},8,["href"])]),_:1})])]),e("div",Ts,[e("button",{onClick:a[1]||(a[1]=S=>b.value=!b.value),class:"inline-flex items-center justify-center rounded-md p-2 text-gray-400 transition duration-150 ease-in-out hover:bg-gray-100 hover:text-gray-500 focus:bg-gray-100 focus:text-gray-500 focus:outline-none"},[(i(),v("svg",Is,[e("path",{class:T({hidden:b.value,"inline-flex":!b.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,2),e("path",{class:T({hidden:!b.value,"inline-flex":b.value}),"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,2)]))])])])]),e("div",{class:T([{block:b.value,hidden:!b.value},"sm:hidden"])},[e("div",Ps,[d(F,{href:s.route("dashboard"),active:s.route().current("dashboard")},{default:g(()=>a[21]||(a[21]=[_(" Dashboard ",-1)])),_:1,__:[21]},8,["href","active"]),I(w)?(i(),P(F,{key:0,href:s.route("clients.index"),active:s.route().current("clients.index")},{default:g(()=>a[22]||(a[22]=[_(" Clients ",-1)])),_:1,__:[22]},8,["href","active"])):$("",!0),I(n)?(i(),P(F,{key:1,href:s.route("projects.index"),active:s.route().current("projects.index")},{default:g(()=>a[23]||(a[23]=[_(" Projects ",-1)])),_:1,__:[23]},8,["href","active"])):$("",!0),I(x)?(i(),P(F,{key:2,href:s.route("users.index"),active:s.route().current("users.index")},{default:g(()=>a[24]||(a[24]=[_(" Users ",-1)])),_:1,__:[24]},8,["href","active"])):$("",!0),I(c)?(i(),P(F,{key:3,href:s.route("emails.compose"),active:s.route().current("emails.compose")},{default:g(()=>a[25]||(a[25]=[_(" Compose Email ",-1)])),_:1,__:[25]},8,["href","active"])):$("",!0),I(m)?(i(),P(F,{key:4,href:s.route("emails.pending"),active:s.route().current("emails.pending")},{default:g(()=>a[26]||(a[26]=[_(" Approve Emails ",-1)])),_:1,__:[26]},8,["href","active"])):$("",!0),I(c)?(i(),P(F,{key:5,href:s.route("emails.rejected"),active:s.route().current("emails.rejected")},{default:g(()=>a[27]||(a[27]=[_(" Rejected Emails ",-1)])),_:1,__:[27]},8,["href","active"])):$("",!0),d(F,{href:s.route("availability.index"),active:s.route().current("availability.index")},{default:g(()=>a[28]||(a[28]=[_(" Weekly Availability ",-1)])),_:1,__:[28]},8,["href","active"]),I(C)?(i(),v("div",Vs,[a[31]||(a[31]=e("div",{class:"px-4 font-medium text-base text-gray-800"},"Admin",-1)),d(F,{href:s.route("admin.roles.index"),active:s.route().current("admin.roles.index")},{default:g(()=>a[29]||(a[29]=[_(" Manage Roles ",-1)])),_:1,__:[29]},8,["href","active"]),d(F,{href:s.route("admin.permissions.index"),active:s.route().current("admin.permissions.index")},{default:g(()=>a[30]||(a[30]=[_(" Manage Permissions ",-1)])),_:1,__:[30]},8,["href","active"])])):$("",!0)]),e("div",Ds,[e("div",Bs,[e("div",Ls,D(u.value.name),1),e("div",Us,D(u.value.email),1),e("div",Ns,D((U=u.value.role_data)==null?void 0:U.name),1)]),e("div",zs,[d(F,{as:"button",onClick:a[2]||(a[2]=S=>A.value=!0)},{default:g(()=>a[32]||(a[32]=[_(" Add Task ",-1)])),_:1,__:[32]}),d(F,{href:s.route("profile.edit")},{default:g(()=>a[33]||(a[33]=[_(" Profile ",-1)])),_:1,__:[33]},8,["href"]),d(F,{href:s.route("logout"),method:"post",as:"button",onSuccess:f,onError:p},{default:g(()=>a[34]||(a[34]=[_(" Log Out ",-1)])),_:1,__:[34]},8,["href"])])])],2)]),s.$slots.header?(i(),v("header",Rs,[e("div",Ws,[Z(s.$slots,"header")])])):$("",!0),e("main",Hs,[Z(s.$slots,"default")]),d(Rt,{show:A.value,onClose:a[3]||(a[3]=S=>A.value=!1),onSaved:a[4]||(a[4]=S=>A.value=!1)},null,8,["show"])])])}}};export{he as B,te as S,Gs as _,at as a,At as b,Rt as c,Me as e,je as s,Qs as w};
