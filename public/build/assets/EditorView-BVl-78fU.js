import{u as ze}from"./presentationStore-C5_HxxPe.js";import{aU as fe,r as b,c as _,e as C,H as K,f as X,g as Q,aH as E,o as A,a9 as xe,aI as y,aT as Se,a as Z,O as Pe,k as _e,u as z,n as V,$ as ge,E as we,w as B,b as T,d as g,t as Me,i as Ee}from"./app-CcSAzmBw.js";import{_ as ye}from"./AuthenticatedLayout-zRDpj2iX.js";import be from"./SlideManager-DklSa_5k.js";import ke from"./SlideEditor-Csa6g0iM.js";import Re from"./SlidePreview-Cvo4I3uQ.js";import Ne from"./Toolbar-C3kKb8MQ.js";import"./presentationsApi-Wo7lMIPT.js";import"./PrimaryButton-CGyaqSV5.js";import"./Modal-Cd1Ld6K7.js";import"./InputLabel-ZXmhB59o.js";import"./InputError-BIAtq_fL.js";import"./SecondaryButton-D1vuT-lC.js";import"./index-C-_TsGkP.js";import"./BaseFormModal-DvACVTk8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-5UhV8dY0.js";import"./SelectDropdown-DcBtX4i8.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-B1Av4EbZ.js";import"./DangerButton-pd7veRVi.js";import"./moment-BLMuvzoS.js";import"./NoticeboardModal-CboiTIxa.js";import"./vuedraggable.umd-C2xq4_0z.js";import"./SlideThumbnail-CW1qUKxL.js";import"./ContentBlockForm-DYrefy4q.js";import"./TiptapEditor-BudqB0hd.js";import"./IconPicker-DMO7olBC.js";import"./BlockToolbox-BfrDSzEv.js";/* empty css                                                                     */import"./ShareModal-DzoqI_RT.js";import"./BaseModal-lUGcrmjq.js";import"./CollaborateModal-BV4TZOt7.js";import"./MultiSelectDropdown-pcj2pnnA.js";import"./ChevronDownIcon-B2WgdRBP.js";const Oe={__name:"splitpanes",props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click"],setup(L,{emit:c}){const r=c,m=L,P=fe(),s=b([]),x=_(()=>s.value.reduce((e,i)=>(e[~~i.id]=i)&&e,{})),h=_(()=>s.value.length),d=b(null),w=b(!1),v=b({mouseDown:!1,dragging:!1,activeSplitter:null,cursorOffset:0}),S=b({splitter:null,timeoutId:null}),k=_(()=>({[`splitpanes splitpanes--${m.horizontal?"horizontal":"vertical"}`]:!0,"splitpanes--dragging":v.value.dragging})),R=()=>{document.addEventListener("mousemove",u,{passive:!1}),document.addEventListener("mouseup",M),"ontouchstart"in window&&(document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",M))},N=()=>{document.removeEventListener("mousemove",u,{passive:!1}),document.removeEventListener("mouseup",M),"ontouchstart"in window&&(document.removeEventListener("touchmove",u,{passive:!1}),document.removeEventListener("touchend",M))},D=(e,i)=>{const t=e.target.closest(".splitpanes__splitter");if(t){const{left:a,top:n}=t.getBoundingClientRect(),{clientX:l,clientY:o}="ontouchstart"in window&&e.touches?e.touches[0]:e;v.value.cursorOffset=m.horizontal?o-n:l-a}R(),v.value.mouseDown=!0,v.value.activeSplitter=i},u=e=>{v.value.mouseDown&&(e.preventDefault(),v.value.dragging=!0,requestAnimationFrame(()=>{ie(ee(e)),r("resize",s.value.map(i=>({min:i.min,max:i.max,size:i.size})))}))},M=()=>{v.value.dragging&&r("resized",s.value.map(e=>({min:e.min,max:e.max,size:e.size}))),v.value.mouseDown=!1,setTimeout(()=>{v.value.dragging=!1,N()},100)},$=(e,i)=>{"ontouchstart"in window&&(e.preventDefault(),m.dblClickSplitter&&(S.value.splitter===i?(clearTimeout(S.value.timeoutId),S.value.timeoutId=null,U(e,i),S.value.splitter=null):(S.value.splitter=i,S.value.timeoutId=setTimeout(()=>S.value.splitter=null,500)))),v.value.dragging||r("splitter-click",s.value[i])},U=(e,i)=>{let t=0;s.value=s.value.map((a,n)=>(a.size=n===i?a.max:a.min,n!==i&&(t+=a.min),a)),s.value[i].size-=t,r("pane-maximize",s.value[i]),r("resized",s.value.map(a=>({min:a.min,max:a.max,size:a.size})))},G=(e,i)=>{r("pane-click",x.value[i])},ee=e=>{const i=d.value.getBoundingClientRect(),{clientX:t,clientY:a}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:t-(m.horizontal?0:v.value.cursorOffset)-i.left,y:a-(m.horizontal?v.value.cursorOffset:0)-i.top}},ae=e=>{e=e[m.horizontal?"y":"x"];const i=d.value[m.horizontal?"clientHeight":"clientWidth"];return m.rtl&&!m.horizontal&&(e=i-e),e*100/i},ie=e=>{const i=v.value.activeSplitter;let t={prevPanesSize:Y(i),nextPanesSize:O(i),prevReachedMinPanes:0,nextReachedMinPanes:0};const a=0+(m.pushOtherPanes?0:t.prevPanesSize),n=100-(m.pushOtherPanes?0:t.nextPanesSize),l=Math.max(Math.min(ae(e),n),a);let o=[i,i+1],p=s.value[o[0]]||null,f=s.value[o[1]]||null;const W=p.max<100&&l>=p.max+t.prevPanesSize,he=f.max<100&&l<=100-(f.max+O(i+1));if(W||he){W?(p.size=p.max,f.size=Math.max(100-p.max-t.prevPanesSize-t.nextPanesSize,0)):(p.size=Math.max(100-f.max-t.prevPanesSize-O(i+1),0),f.size=f.max);return}if(m.pushOtherPanes){const J=te(t,l);if(!J)return;({sums:t,panesToResize:o}=J),p=s.value[o[0]]||null,f=s.value[o[1]]||null}p!==null&&(p.size=Math.min(Math.max(l-t.prevPanesSize-t.prevReachedMinPanes,p.min),p.max)),f!==null&&(f.size=Math.min(Math.max(100-l-t.nextPanesSize-t.nextReachedMinPanes,f.min),f.max))},te=(e,i)=>{const t=v.value.activeSplitter,a=[t,t+1];return i<e.prevPanesSize+s.value[a[0]].min&&(a[0]=ne(t).index,e.prevReachedMinPanes=0,a[0]<t&&s.value.forEach((n,l)=>{l>a[0]&&l<=t&&(n.size=n.min,e.prevReachedMinPanes+=n.min)}),e.prevPanesSize=Y(a[0]),a[0]===void 0)?(e.prevReachedMinPanes=0,s.value[0].size=s.value[0].min,s.value.forEach((n,l)=>{l>0&&l<=t&&(n.size=n.min,e.prevReachedMinPanes+=n.min)}),s.value[a[1]].size=100-e.prevReachedMinPanes-s.value[0].min-e.prevPanesSize-e.nextPanesSize,null):i>100-e.nextPanesSize-s.value[a[1]].min&&(a[1]=se(t).index,e.nextReachedMinPanes=0,a[1]>t+1&&s.value.forEach((n,l)=>{l>t&&l<a[1]&&(n.size=n.min,e.nextReachedMinPanes+=n.min)}),e.nextPanesSize=O(a[1]-1),a[1]===void 0)?(e.nextReachedMinPanes=0,s.value.forEach((n,l)=>{l<h.value-1&&l>=t+1&&(n.size=n.min,e.nextReachedMinPanes+=n.min)}),s.value[a[0]].size=100-e.prevPanesSize-O(a[0]-1),null):{sums:e,panesToResize:a}},Y=e=>s.value.reduce((i,t,a)=>i+(a<e?t.size:0),0),O=e=>s.value.reduce((i,t,a)=>i+(a>e+1?t.size:0),0),ne=e=>[...s.value].reverse().find(i=>i.index<e&&i.size>i.min)||{},se=e=>s.value.find(i=>i.index>e+1&&i.size>i.min)||{},le=()=>{var e;Array.from(((e=d.value)==null?void 0:e.children)||[]).forEach(i=>{const t=i.classList.contains("splitpanes__pane"),a=i.classList.contains("splitpanes__splitter");!t&&!a&&(i.remove(),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))})},j=(e,i,t=!1)=>{const a=e-1,n=document.createElement("div");n.classList.add("splitpanes__splitter"),t||(n.onmousedown=l=>D(l,a),typeof window<"u"&&"ontouchstart"in window&&(n.ontouchstart=l=>D(l,a)),n.onclick=l=>$(l,a+1)),m.dblClickSplitter&&(n.ondblclick=l=>U(l,a+1)),i.parentNode.insertBefore(n,i)},oe=e=>{e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.remove()},I=()=>{var e;const i=Array.from(((e=d.value)==null?void 0:e.children)||[]);i.forEach(a=>{a.className.includes("splitpanes__splitter")&&oe(a)});let t=0;i.forEach(a=>{a.className.includes("splitpanes__pane")&&(!t&&m.firstSplitter?j(t,a,!0):t&&j(t,a),t++)})},re=({uid:e,...i})=>{const t=x.value[e];Object.entries(i).forEach(([a,n])=>t[a]=n)},ue=e=>{var i;let t=-1;Array.from(((i=d.value)==null?void 0:i.children)||[]).some(a=>(a.className.includes("splitpanes__pane")&&t++,a.isSameNode(e.el))),s.value.splice(t,0,{...e,index:t}),s.value.forEach((a,n)=>a.index=n),w.value&&V(()=>{I(),q({addedPane:s.value[t]}),r("pane-add",{index:t,panes:s.value.map(a=>({min:a.min,max:a.max,size:a.size}))})})},me=e=>{const i=s.value.findIndex(a=>a.id===e),t=s.value.splice(i,1)[0];s.value.forEach((a,n)=>a.index=n),V(()=>{I(),q({removedPane:{...t}}),r("pane-remove",{removed:t,panes:s.value.map(a=>({min:a.min,max:a.max,size:a.size}))})})},q=(e={})=>{!e.addedPane&&!e.removedPane?ve():s.value.some(i=>i.givenSize!==null||i.min||i.max<100)?pe(e):de(),w.value&&r("resized",s.value.map(i=>({min:i.min,max:i.max,size:i.size})))},de=()=>{const e=100/h.value;let i=0;const t=[],a=[];s.value.forEach(n=>{n.size=Math.max(Math.min(e,n.max),n.min),i-=n.size,n.size>=n.max&&t.push(n.id),n.size<=n.min&&a.push(n.id)}),i>.1&&F(i,t,a)},ve=()=>{let e=100;const i=[],t=[];let a=0;s.value.forEach(l=>{e-=l.size,l.givenSize!==null&&a++,l.size>=l.max&&i.push(l.id),l.size<=l.min&&t.push(l.id)});let n=100;e>.1&&(s.value.forEach(l=>{l.givenSize===null&&(l.size=Math.max(Math.min(e/(h.value-a),l.max),l.min)),n-=l.size}),n>.1&&F(n,i,t))},pe=({addedPane:e,removedPane:i}={})=>{let t=100/h.value,a=0;const n=[],l=[];((e==null?void 0:e.givenSize)??null)!==null&&(t=(100-e.givenSize)/(h.value-1).value),s.value.forEach(o=>{a-=o.size,o.size>=o.max&&n.push(o.id),o.size<=o.min&&l.push(o.id)}),!(Math.abs(a)<.1)&&(s.value.forEach(o=>{(e==null?void 0:e.givenSize)!==null&&(e==null?void 0:e.id)===o.id||(o.size=Math.max(Math.min(t,o.max),o.min)),a-=o.size,o.size>=o.max&&n.push(o.id),o.size<=o.min&&l.push(o.id)}),a>.1&&F(a,n,l))},F=(e,i,t)=>{let a;e>0?a=e/(h.value-i.length):a=e/(h.value-t.length),s.value.forEach((n,l)=>{if(e>0&&!i.includes(n.id)){const o=Math.max(Math.min(n.size+a,n.max),n.min),p=o-n.size;e-=p,n.size=o}else if(!t.includes(n.id)){const o=Math.max(Math.min(n.size+a,n.max),n.min),p=o-n.size;e-=p,n.size=o}}),Math.abs(e)>.1&&V(()=>{w.value&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})};C(()=>m.firstSplitter,()=>I()),C(()=>m.dblClickSplitter,e=>{[...d.value.querySelectorAll(".splitpanes__splitter")].forEach((i,t)=>{i.ondblclick=e?a=>U(a,t):void 0})}),K(()=>w.value=!1),X(()=>{le(),I(),q(),r("ready"),w.value=!0});const ce=()=>{var e;return ge("div",{ref:d,class:k.value},(e=P.default)==null?void 0:e.call(P))};return E("panes",s),E("indexedPanes",x),E("horizontal",_(()=>m.horizontal)),E("requestUpdate",re),E("onPaneAdd",ue),E("onPaneRemove",me),E("onPaneClick",G),(e,i)=>(A(),Q(xe(ce)))}},H={__name:"pane",props:{size:{type:[Number,String]},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},setup(L){var c;const r=L,m=y("requestUpdate"),P=y("onPaneAdd"),s=y("horizontal"),x=y("onPaneRemove"),h=y("onPaneClick"),d=(c=Se())==null?void 0:c.uid,w=y("indexedPanes"),v=_(()=>w.value[d]),S=b(null),k=_(()=>{const u=isNaN(r.size)||r.size===void 0?0:parseFloat(r.size);return Math.max(Math.min(u,N.value),R.value)}),R=_(()=>{const u=parseFloat(r.minSize);return isNaN(u)?0:u}),N=_(()=>{const u=parseFloat(r.maxSize);return isNaN(u)?100:u}),D=_(()=>{var u;return`${s.value?"height":"width"}: ${(u=v.value)==null?void 0:u.size}%`});return X(()=>{P({id:d,el:S.value,min:R.value,max:N.value,givenSize:r.size===void 0?null:k.value,size:k.value})}),C(()=>k.value,u=>m({uid:d,size:u})),C(()=>R.value,u=>m({uid:d,min:u})),C(()=>N.value,u=>m({uid:d,max:u})),K(()=>x(d)),(u,M)=>(A(),Z("div",{ref_key:"paneEl",ref:S,class:"splitpanes__pane",onClick:M[0]||(M[0]=$=>z(h)($,u._.uid)),style:_e(D.value)},[Pe(u.$slots,"default")],4))}},Be={class:"flex flex-row h-full bg-gray-50"},Ce={class:"flex-1 flex flex-col min-w-0"},Le={class:"h-8 px-4 border-b bg-white flex items-center text-sm text-slate-700"},De=["title"],Ie={key:0,class:"h-full relative"},Sa={__name:"EditorView",setup(L){const c=ze(),r=we();let P=((r==null?void 0:r.props)||{}).presentationId;if(!P&&(r!=null&&r.url)){const s=r.url.split("?")[0].split("#")[0].split("/").filter(Boolean),x=s.findIndex(h=>h==="presentations");x!==-1&&s[x+1]&&(P=s[x+1])}return X(()=>{P&&c.load(P)}),(s,x)=>(A(),Q(ye,null,{default:B(()=>{var h,d;return[T("div",Be,[g(Ne,{actions:["save","share","collaborate","saveTemplate"],class:"","aria-label":"Editor toolbar"}),T("div",Ce,[T("div",Le,[T("span",{class:"font-medium truncate",title:((h=z(c).presentation)==null?void 0:h.title)||"Untitled Presentation"},Me(((d=z(c).presentation)==null?void 0:d.title)||"Untitled Presentation"),9,De)]),g(z(Oe),{class:"flex-1 overflow-hidden"},{default:B(()=>[g(z(H),{"min-size":z(c).previewMaximized?0:20,size:z(c).previewMaximized?0:10,class:"bg-white border-r overflow-hidden"},{default:B(()=>[g(be)]),_:1},8,["min-size","size"]),g(z(H),{size:z(c).previewMaximized?0:80,class:"bg-white overflow-hidden"},{default:B(()=>[g(ke)]),_:1},8,["size"]),g(z(H),{size:z(c).previewOpen?z(c).previewMaximized?100:30:0,"min-size":"0",class:"bg-white border-l overflow-hidden transition-all"},{default:B(()=>[z(c).previewOpen?(A(),Z("div",Ie,[g(Re)])):Ee("",!0)]),_:1},8,["size"])]),_:1})])])]}),_:1}))}};export{Sa as default};
