import{c as b,r as v,f as C,a as n,o as u,i as f,b as t,v as r,x as m,G as S,F as y,l as V,d as g,u as c,m as N,t as x}from"./app-DbT8OS6U.js";import{u as _}from"./workflowStore-DZJsW282.js";import{P as U}from"./plus-Cqbd8Y22.js";import{S as F}from"./save-Dz7hmyY3.js";import"./createLucideIcon-CcTmroC8.js";const M={key:0,class:"p-4 space-y-4"},T={class:"flex items-center gap-2 mt-1"},j=["value"],B={class:"pt-2"},D={key:1,class:"fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center"},A={class:"bg-white rounded-lg shadow-xl p-6 w-full max-w-lg"},E={class:"mt-4 space-y-4"},L={class:"mt-6 flex justify-end gap-3"},W=["disabled"],H={__name:"AiPromptConfig",setup($){const a=_(),s=b(()=>a.selectedStep),w=b(()=>a.prompts),d=v(!1),o=v({name:"",version:1,system_prompt_text:""}),p=v(!1),k=async()=>{if(!o.value.name||!o.value.system_prompt_text){alert("Name and Prompt Text are required.");return}try{p.value=!0;const i=await a.createPrompt(o.value);s.value&&(s.value.prompt_id=i.id),d.value=!1,o.value={name:"",version:1,system_prompt_text:""}}catch(i){console.error("Failed to create prompt:",i),alert("Could not create prompt. Please check the console.")}finally{p.value=!1}};C(()=>{a.prompts.length===0&&a.fetchPrompts()});const P=async()=>{s.value&&await a.persistStep(s.value)};return(i,e)=>(u(),n(y,null,[s.value?(u(),n("div",M,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-xs font-medium text-gray-700"},"Name",-1)),r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.name=l),type:"text",class:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:"AI Prompt step name"},null,512),[[m,s.value.name]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-xs font-medium text-gray-700"},"Prompt",-1)),t("div",T,[r(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.prompt_id=l),class:"w-full border rounded px-2 py-1 text-sm"},[e[9]||(e[9]=t("option",{value:null},"Select a promptâ€¦",-1)),(u(!0),n(y,null,V(w.value,l=>(u(),n("option",{key:l.id,value:l.id},x(l.name)+" v"+x(l.version),9,j))),128))],512),[[S,s.value.prompt_id]]),t("button",{onClick:e[2]||(e[2]=l=>d.value=!0),class:"p-2 rounded-md bg-gray-100 text-gray-600 hover:bg-gray-200",title:"Create New Prompt"},[g(c(U),{class:"w-4 h-4"})])])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-xs font-medium text-gray-700"},"Delay (minutes)",-1)),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.delay_minutes=l),type:"number",min:"0",class:"mt-1 w-full border rounded px-2 py-1 text-sm"},null,512),[[m,s.value.delay_minutes,void 0,{number:!0}]])]),t("div",B,[t("button",{onClick:P,class:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700"},[g(c(F),{class:"w-4 h-4"}),e[12]||(e[12]=N(" Save Step ",-1))])])])):f("",!0),d.value?(u(),n("div",D,[t("div",A,[e[16]||(e[16]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Create New Prompt",-1)),t("div",E,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-xs font-medium text-gray-700"},"Prompt Name",-1)),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.name=l),type:"text",class:"mt-1 w-full border rounded px-2 py-1 text-sm",placeholder:"e.g., New Lead Welcome Email"},null,512),[[m,o.value.name]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-xs font-medium text-gray-700"},"Version",-1)),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.version=l),type:"number",class:"mt-1 w-full border rounded px-2 py-1 text-sm"},null,512),[[m,o.value.version,void 0,{number:!0}]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-xs font-medium text-gray-700"},"System Prompt Text",-1)),r(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.system_prompt_text=l),rows:"8",class:"mt-1 w-full border rounded px-2 py-1 text-sm font-mono",placeholder:"You are a helpful assistant..."},null,512),[[m,o.value.system_prompt_text]])])]),t("div",L,[t("button",{onClick:e[7]||(e[7]=l=>d.value=!1),class:"px-4 py-2 text-sm rounded-md border text-gray-700 hover:bg-gray-50"},"Cancel"),t("button",{onClick:k,disabled:p.value,class:"px-4 py-2 text-sm rounded-md bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-300"},x(p.value?"Creating...":"Create Prompt"),9,W)])])])):f("",!0)],64))}};export{H as default};
