import{u as w}from"./workflowStore-CMOFNtRR.js";import x from"./StepCard-C_67gK0x.js";import{S as d}from"./SelectDropdown-BP8ZsyDi.js";import{d as V,b as l,q as c,o as i,w as y,a as v,f as k,l as g,c as C,t as B}from"./app-R-i7AP1m.js";import"./createLucideIcon-uJ1YL3gn.js";import"./x-CmpqMLVZ.js";import"./trash-C0sVKEnz.js";/* empty css                                                                       */import"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"flex items-center flex-wrap gap-2 text-md"},U={key:1,class:"w-full text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded-md px-3 py-2"},E={__name:"TriggerStep",props:{step:{type:Object,required:!0}},emits:["update:step"],setup(f,{emit:b}){const a=f,n=b,r=w();V(()=>{r.automationSchema.length||r.fetchAutomationSchema()});const p=l(()=>r.automationSchema||[]),h=l(()=>p.value.map(e=>({label:e.name,value:e.name}))),o=l({get(){var e;return((e=a.step.step_config)==null?void 0:e.model)||null},set(e){const t={model:e,event:null,trigger_event:null};n("update:step",{...a.step,step_config:t})}}),m=l({get(){var e;return((e=a.step.step_config)==null?void 0:e.event)||null},set(e){const t=o.value,s={...a.step.step_config,event:e,trigger_event:t&&e?`${t.toLowerCase()}.${e}`:null};n("update:step",{...a.step,step_config:s})}}),_=l(()=>o.value?p.value.find(e=>e.name===o.value):null),u=l(()=>{if(!o.value)return[];const e=_.value;return e?e.events:[]}),S=l(()=>o.value&&u.value.length===0);return(e,t)=>(i(),c(x,{icon:"⚡",title:a.step.name||"When this happens... (Trigger)","disable-drag":!0,"onUpdate:title":t[2]||(t[2]=s=>n("update:step",{...a.step,name:s}))},{default:y(()=>[v("div",M,[t[3]||(t[3]=v("span",{class:"font-semibold text-gray-700"},"When a",-1)),k(d,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),options:h.value,placeholder:"Select a model",class:"w-56"},null,8,["modelValue","options"]),o.value&&u.value.length?(i(),c(d,{key:0,modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=s=>m.value=s),options:u.value,placeholder:"is...",class:"w-56"},null,8,["modelValue","options"])):g("",!0),S.value?(i(),C("div",U," Triggers are not available for “"+B(o.value)+"”. You can still use this model in conditions or actions. If you need a trigger for it, please contact your workspace admin to request support. ",1)):g("",!0)])]),_:1},8,["title"]))}};export{E as default};
