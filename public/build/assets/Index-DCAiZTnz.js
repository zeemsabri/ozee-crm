import{a as n,o as l,b as t,r as g,f as st,e as ut,c as W,d as c,u as p,h as ct,w as A,i as y,v as h,x as w,t as i,m as v,F as _,l as C,j as F,k as pt,g as Z,s as J,J as K,K as gt,G as xt}from"./app-Bp9pk1df.js";import{r as ft,R as Q,a as ht,b as vt,_ as mt}from"./AuthenticatedLayout-CSPp0v6a.js";import{_ as bt}from"./MultiSelectDropdown-CCR1jazS.js";import"./auto-BIBwKD9g.js";import{C as yt}from"./chart-DUfl3Dpl.js";import{_ as _t}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as wt}from"./ClockIcon-YJBrzPSP.js";import{r as kt,a as Ct,b as jt}from"./NoticeboardModal-d8ayccGb.js";import{r as $t}from"./BriefcaseIcon-CfewAYgg.js";import{r as Mt}from"./PlusIcon-T9qgGIGr.js";import{r as X}from"./ChevronDownIcon-DWkgExD-.js";import{r as Dt}from"./CheckCircleIcon-CUBM1GXe.js";import"./PrimaryButton-CUW-CE6I.js";import"./Modal-CuzlX3yi.js";import"./InputLabel-ZriCr9JV.js";import"./InputError-BuFYllaT.js";import"./SecondaryButton-Chml4OYk.js";import"./index-DpaaaHb0.js";import"./BaseFormModal-DZmJ_Nq7.js";import"./TextInput-qz5y_KDV.js";import"./SelectDropdown-DvCSzoOZ.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-BfiNUJqr.js";import"./createLucideIcon-Ba8FsfYX.js";import"./plus-BSfATL_b.js";import"./DangerButton-Cg3ChMhn.js";import"./moment-BLMuvzoS.js";function Y(m,u){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"})])}function Vt(m,u){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})])}function Et(m,u){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"})])}function tt(m,u){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"})])}function Ut(m,u){return l(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"})])}const St={class:"h-64 w-full"},Tt=["id"],et={__name:"ChartComponent",props:{data:{type:Object,required:!0},title:{type:String,default:"Productivity Chart"},chartId:{type:String,default:"productivity-chart"},type:{type:String,default:"bar"}},setup(m){const u=m,b=g(null);let k=null;const j=()=>{k&&k.destroy(),b.value&&(k=new yt(b.value,{type:u.type,data:u.data,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},title:{display:!!u.title,text:u.title}},scales:u.type==="pie"||u.type==="doughnut"?{}:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}}}))};return st(()=>{j()}),ut(()=>u.data,()=>{j()},{deep:!0}),($,D)=>(l(),n("div",St,[t("canvas",{ref_key:"chartRef",ref:b,id:m.chartId},null,8,Tt)]))}},At={class:"flex justify-between items-center print:hidden"},Ft={class:"py-8 bg-gray-50 min-h-screen print:bg-white print:py-0"},Ht={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6"},It={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 print:hidden"},Pt={class:"grid grid-cols-1 md:grid-cols-5 gap-6 items-end"},Rt={class:"col-span-2"},Lt=["disabled"],Nt={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Bt={class:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm"},Zt={class:"flex items-center justify-between mb-2"},Ot={class:"text-3xl font-black text-gray-900"},qt={class:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm"},zt={class:"flex items-center justify-between mb-2"},Gt={class:"text-3xl font-black text-gray-900"},Wt={class:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm"},Jt={class:"flex items-center justify-between mb-2"},Kt={class:"text-3xl font-black text-gray-900"},Qt={class:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm"},Xt={class:"flex items-center justify-between mb-2"},Yt={class:"text-3xl font-black text-red-600"},te={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ee={class:"lg:col-span-2 bg-white rounded-xl border border-gray-200 p-6 shadow-sm"},se={class:"text-sm font-bold text-gray-900 mb-6 flex items-center justify-between"},oe={class:"flex items-center"},re={class:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm"},ae={class:"text-sm font-bold text-gray-900 mb-6 flex items-center"},le={key:2,class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},ne={class:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/30"},ie={class:"text-sm font-bold text-gray-900 flex items-center"},de={class:"overflow-x-auto"},ue={class:"w-full text-sm text-left"},ce={class:"divide-y divide-gray-100"},pe={class:"px-6 py-4 font-bold text-gray-900"},ge={class:"px-6 py-4 text-right font-mono"},xe={class:"px-6 py-4 text-right"},fe={class:"px-2 py-1 rounded bg-green-50 text-green-700 font-bold text-xs"},he={class:"px-6 py-4"},ve={class:"w-full bg-gray-100 rounded-full h-1.5 overflow-hidden"},me=["onClick"],be={class:"flex items-center space-x-4"},ye=["src"],_e={class:"font-bold text-gray-900"},we={class:"text-xs text-gray-500 uppercase tracking-widest font-bold"},ke={class:"flex items-center space-x-6"},Ce=["onClick"],je={class:"text-right"},$e={class:"text-2xl font-black text-indigo-600"},Me={class:"p-0 overflow-x-auto border-t border-gray-100"},De={class:"w-full text-sm text-left"},Ve={class:"bg-gray-50 text-gray-400 text-[10px] uppercase font-bold tracking-wider"},Ee={class:"px-4 py-3 text-right"},Ue={class:"flex items-center justify-end gap-1"},Se={class:"divide-y divide-gray-200"},Te={class:"hover:bg-indigo-50/30 transition"},Ae=["onClick"],Fe={class:"px-4 py-4"},He=["onClick"],Ie={class:"text-[10px] text-indigo-500 font-bold uppercase"},Pe={class:"px-4 py-4"},Re={class:"flex flex-col gap-1"},Le={class:"text-[10px] font-bold"},Ne={key:0,class:"text-[8px] font-black uppercase bg-red-100 px-1 rounded"},Be={class:"px-4 py-4 text-center overflow-visible"},Ze={class:"group relative inline-block"},Oe={class:"inline-flex items-center px-2 py-1 rounded-full text-[10px] font-bold bg-gray-100 text-gray-600 cursor-help"},qe={key:0,class:"absolute top-full mt-1 left-1/2 -translate-x-1/2 w-52 bg-gray-900 text-white text-[10px] rounded shadow-2xl z-50 hidden group-hover:block p-3 border border-gray-700"},ze={class:"max-h-48 overflow-y-auto space-y-1.5"},Ge={class:"shrink-0 mt-0.5"},We={class:"px-4 py-4 text-right"},Je=["onUpdate:modelValue","onChange"],Ke={class:"px-4 py-4 text-right"},Qe=["onUpdate:modelValue","onChange"],Xe={class:"px-4 py-4 text-right font-black text-gray-900"},Ye={key:0,class:"bg-gray-50/50"},ts={colspan:"7",class:"px-12 py-4"},es={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ss={class:"text-[9px] font-bold text-gray-400 uppercase"},os={class:"text-[11px] font-mono text-gray-600"},rs={class:"text-xs font-black text-indigo-600"},as={key:1,class:"text-xs text-gray-400 italic"},ls={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},ns={class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden transition-all transform scale-100"},is={class:"p-6 border-b border-gray-100 flex justify-between items-center"},ds={class:"text-sm text-gray-500"},us={class:"font-bold text-indigo-600"},cs=["value"],ps={class:"grid grid-cols-2 gap-4"},gs={__name:"Index",setup(m){const u=g([]),b=g({}),k=g([]),j=g([]),$=g(!1),D=g([]),H=g(""),I=g(""),M=g({}),V=g({}),E=g(!1),x=g({user_id:null,user_name:"",name:"",project_id:"",hours:"",date:""}),U=g(!1),P=g(null),S=g(null),O=g([]),R=g(!1),ot=o=>{M.value[o]=!M.value[o]},rt=o=>{V.value[o]=!V.value[o]},at=async o=>{if(!(!o||!o.task_id)){if(P.value=o.task_id,S.value=o.project_id||0,S.value)try{const e=await window.axios.get(`/api/projects/${S.value}/sections/clients-users`);O.value=e.data.users||[]}catch(e){console.error("Failed to fetch project users",e)}U.value=!0}},lt=o=>{x.value={user_id:o.user_id,user_name:o.user_name,name:"",project_id:"",hours:"",date:new Date().toISOString().split("T")[0]},E.value=!0},L=()=>{E.value=!1},nt=async()=>{if(!(!x.value.name||!x.value.hours))try{await window.axios.post("/api/tasks/manual-effort",{name:x.value.name,assigned_to_user_id:x.value.user_id,project_id:x.value.project_id||null,manual_effort_override:parseFloat(x.value.hours),date:x.value.date}),E.value=!1,N()}catch(o){console.error("Failed to create manual entry",o)}},it=o=>{var e;for(let s of u.value){const r=s.tasks.findIndex(a=>a.task_id===o.id);if(r!==-1){const a=s.tasks[r];if(a.task_name=o.name,a.effort=o.effort,a.priority=o.priority,a.status=((e=o.status)==null?void 0:e.value)||o.status,a.due_date=o.due_date,a.subtasks=o.subtasks||[],a.subtasks.length>0){const f=a.subtasks.length,d=a.subtasks.filter(B=>B.status==="done").length;a.checklist=`${d}/${f}`}break}}},T=W(()=>{let o=0,e=0,s=0,r=0;return u.value.forEach(a=>{o+=parseFloat(a.total_hours||0),a.tasks.forEach(f=>{e+=parseInt(f.effort||0),f.status==="Done"&&s++,f.is_late&&r++})}),{totalHours:o.toFixed(1),velocity:e,completed:s,late:r}}),q=W(()=>{const o={};return u.value.forEach(e=>{e.tasks.forEach(s=>{const r=s.due_date||"N/A";if(s.status==="Done"&&(o[r]||(o[r]={hours:0,points:0}),o[r].points+=parseInt(s.effort||0)),(s.sessions||[]).forEach(a=>{const f=(a.start||"").split(" ")[0];f&&(o[f]||(o[f]={hours:0,points:0}),o[f].hours+=parseFloat(a.duration_seconds||0)/3600)}),s.manual_effort_override&&(!s.sessions||s.sessions.length===0)){const a=s.due_date||"Manual";o[a]||(o[a]={hours:0,points:0}),o[a].hours+=parseFloat(s.manual_effort_override)}})}),Object.keys(o).sort().reverse().map(e=>{const s=o[e],r=s.hours>0?(s.points/s.hours).toFixed(1):0;return{date:e,...s,efficiency:r}})}),N=async()=>{$.value=!0;try{const o=await window.axios.get("/api/productivity/report",{params:{user_ids:D.value.join(","),date_start:H.value,date_end:I.value}});u.value=o.data.reportData.details,b.value=o.data.reportData.charts,k.value=o.data.users,j.value=o.data.projects,u.value.length===1&&(M.value[u.value[0].user_id]=!0)}catch(o){console.error(o)}finally{$.value=!1}},z=async(o,e,s,r)=>{if(s==="manual_effort_override"){const a=r===""||r===null?null:parseFloat(r);o.manual_effort_override=a,a!==null&&!isNaN(a)?o.used_seconds=a*3600:o.used_seconds=o.total_seconds||0;let f=0;e.tasks.forEach(d=>{f+=parseFloat(d.used_seconds||0)}),e.total_seconds=f,e.total_hours=(f/3600).toFixed(2)}else o[s]=r;try{await window.axios.post(`/api/tasks/${o.task_id}/productivity-meta`,{[s]:r})}catch(a){console.error("Persistence failed",a)}},G=o=>{if(o==null)return"0h";const e=Math.floor(Math.abs(o)/3600),s=Math.floor(Math.abs(o)%3600/60);return`${e}h ${s}m`};st(()=>N());const dt=()=>window.print();return(o,e)=>(l(),n(_,null,[c(p(ct),{title:"Productivity Dashboard"}),c(mt,null,{header:A(()=>[t("div",At,[e[12]||(e[12]=t("h2",{class:"font-bold text-2xl text-gray-900 tracking-tight"},"Productivity Dashboard",-1)),t("button",{onClick:dt,class:"flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-semibold text-gray-700 hover:bg-gray-50 shadow-sm transition"},[c(p(Ut),{class:"h-4 w-4 mr-2"}),e[11]||(e[11]=v(" Export PDF ",-1))])])]),default:A(()=>[t("div",Ft,[t("div",Ht,[t("div",It,[t("div",Pt,[t("div",Rt,[e[13]||(e[13]=t("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Team Members",-1)),c(bt,{modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=s=>D.value=s),options:k.value,"is-multi":!0,placeholder:"Search team members..."},null,8,["modelValue","options"])]),t("div",null,[e[14]||(e[14]=t("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Range Start",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>H.value=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-indigo-500"},null,512),[[w,H.value]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"text-xs font-bold text-gray-500 uppercase mb-2 block"},"Range End",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>I.value=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-indigo-500"},null,512),[[w,I.value]])]),t("button",{onClick:N,disabled:$.value,class:"w-full bg-indigo-600 text-white font-bold py-2.5 rounded-lg hover:bg-indigo-700 transition disabled:opacity-50"},i($.value?"Generating...":"Refresh Report"),9,Lt)])]),u.value.length?(l(),n("div",Nt,[t("div",Bt,[t("div",Zt,[c(p(wt),{class:"h-6 w-6 text-indigo-500"}),e[16]||(e[16]=t("span",{class:"text-xs font-bold text-gray-400"},"Total Hours",-1))]),t("div",Ot,i(T.value.totalHours)+"h",1)]),t("div",qt,[t("div",zt,[c(p(Y),{class:"h-6 w-6 text-green-500"}),e[17]||(e[17]=t("span",{class:"text-xs font-bold text-gray-400"},"Total Velocity",-1))]),t("div",Gt,i(T.value.velocity)+" pts",1)]),t("div",Wt,[t("div",Jt,[c(p(kt),{class:"h-6 w-6 text-blue-500"}),e[18]||(e[18]=t("span",{class:"text-xs font-bold text-gray-400"},"Tasks Completed",-1))]),t("div",Kt,i(T.value.completed),1)]),t("div",Qt,[t("div",Xt,[c(p(Ct),{class:"h-6 w-6 text-red-500"}),e[19]||(e[19]=t("span",{class:"text-xs font-bold text-gray-400"},"Overdue Items",-1))]),t("div",Yt,i(T.value.late),1)])])):y("",!0),b.value.daily_trend?(l(),n("div",te,[t("div",ee,[t("h3",se,[t("div",oe,[c(p(Y),{class:"h-4 w-4 mr-2 text-indigo-600"}),e[20]||(e[20]=v(" Activity vs Output Trend ",-1))]),e[21]||(e[21]=t("div",{class:"flex gap-4 text-[10px] font-bold uppercase tracking-wider"},[t("span",{class:"flex items-center gap-1"},[t("span",{class:"w-2 h-2 rounded-full bg-indigo-500"}),v(" Hours")]),t("span",{class:"flex items-center gap-1"},[t("span",{class:"w-2 h-2 rounded-full bg-green-500"}),v(" Points")])],-1))]),c(et,{data:b.value.daily_trend,type:"line",height:"250"},null,8,["data"])]),t("div",re,[t("h3",ae,[c(p($t),{class:"h-4 w-4 mr-2 text-green-600"}),e[22]||(e[22]=v(" Project Load ",-1))]),c(et,{data:b.value.project_dist,type:"pie",height:"250"},null,8,["data"])])])):y("",!0),q.value.length?(l(),n("div",le,[t("div",ne,[t("h3",ie,[c(p(Et),{class:"h-4 w-4 mr-2 text-indigo-600"}),e[23]||(e[23]=v(" Daily Productivity Breakdown ",-1))])]),t("div",de,[t("table",ue,[e[24]||(e[24]=t("thead",{class:"bg-gray-50/50 text-[10px] uppercase font-bold text-gray-500 tracking-wider"},[t("tr",null,[t("th",{class:"px-6 py-3"},"Date"),t("th",{class:"px-6 py-3 text-right"},"Hours Logged"),t("th",{class:"px-6 py-3 text-right"},"Points Done"),t("th",{class:"px-6 py-3 text-right"},"Efficiency (Pts/Hr)"),t("th",{class:"px-6 py-3 w-1/3"},"Velocity Meter")])],-1)),t("tbody",ce,[(l(!0),n(_,null,C(q.value,s=>(l(),n("tr",{key:s.date,class:"hover:bg-gray-50/50"},[t("td",pe,i(s.date),1),t("td",ge,i(s.hours.toFixed(1))+"h",1),t("td",xe,[t("span",fe,i(s.points)+" pts",1)]),t("td",{class:F(["px-6 py-4 text-right font-black",s.efficiency>2?"text-green-600":"text-gray-500"])},i(s.efficiency),3),t("td",he,[t("div",ve,[t("div",{class:"bg-indigo-500 h-full rounded-full transition-all duration-500",style:pt({width:Math.min(s.points*10,100)+"%"})},null,4)])])]))),128))])])])])):y("",!0),(l(!0),n(_,null,C(u.value,s=>(l(),n("div",{key:s.user_id,class:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden"},[t("div",{onClick:r=>ot(s.user_id),class:"p-6 flex items-center justify-between bg-gray-50/50 cursor-pointer hover:bg-gray-100 transition print:cursor-default"},[t("div",be,[t("img",{src:s.avatar,class:"h-12 w-12 rounded-full border-2 border-white shadow-sm"},null,8,ye),t("div",null,[t("h4",_e,i(s.user_name),1),t("p",we,i(s.tasks.length)+" Tasks Managed",1)])]),t("div",ke,[t("button",{onClick:J(r=>lt(s),["stop"]),class:"p-2 rounded-full hover:bg-white text-gray-400 hover:text-indigo-600 transition print:hidden",title:"Add Manual Activity"},[c(p(Mt),{class:"h-5 w-5"})],8,Ce),t("div",je,[t("div",$e,i(s.total_hours)+" hrs",1),e[25]||(e[25]=t("p",{class:"text-[10px] text-gray-400 font-bold uppercase"},"Total Charged",-1))]),(l(),Z(K(M.value[s.user_id]?p(tt):p(X)),{class:"h-5 w-5 text-gray-400 print:hidden"}))])],8,me),h(t("div",Me,[t("table",De,[t("thead",Ve,[t("tr",null,[e[27]||(e[27]=t("th",{class:"px-4 py-3 w-8"},null,-1)),e[28]||(e[28]=t("th",{class:"px-4 py-3"},"Task Detail",-1)),e[29]||(e[29]=t("th",{class:"px-4 py-3"},"Status / Due",-1)),e[30]||(e[30]=t("th",{class:"px-4 py-3 text-center"},"Checklist",-1)),t("th",Ee,[t("div",Ue,[e[26]||(e[26]=v(" Effort ",-1)),c(p(ft),{class:"h-3 w-3 cursor-pointer",onClick:e[3]||(e[3]=r=>R.value=!0)})])]),e[31]||(e[31]=t("th",{class:"px-4 py-3 text-right"},"Manual (Hrs)",-1)),e[32]||(e[32]=t("th",{class:"px-4 py-3 text-right"},"Total Time",-1))])]),t("tbody",Se,[(l(!0),n(_,null,C(s.tasks,r=>{var a,f;return l(),n(_,{key:r.task_id},[t("tr",Te,[t("td",{class:"px-4 py-4 cursor-pointer text-gray-300 hover:text-indigo-600",onClick:d=>rt(r.task_id)},[(l(),Z(K(V.value[r.task_id]?p(tt):p(X)),{class:"h-4 w-4"}))],8,Ae),t("td",Fe,[t("div",{onClick:d=>at(r),class:"font-bold text-gray-900 mb-0.5 cursor-pointer hover:text-indigo-600 hover:underline transition print:no-underline"},i(r.task_name),9,He),t("div",Ie,i(r.project_name),1)]),t("td",Pe,[t("div",Re,[t("span",{class:F([{"bg-green-100 text-green-700":r.status==="Done","bg-yellow-100 text-yellow-700":r.status==="In Progress","bg-gray-100 text-gray-600":r.status==="To Do"},"px-2 py-0.5 rounded text-[9px] font-black uppercase w-fit"])},i(r.status),3),t("div",{class:F(["flex items-center gap-1",r.is_late?"text-red-500":"text-gray-400"])},[c(p(Vt),{class:"h-3 w-3"}),t("span",Le,i(r.due_date||"No Date"),1),r.is_late?(l(),n("span",Ne,"Late")):y("",!0)],2)])]),t("td",Be,[t("div",Ze,[t("span",Oe,[c(p(Dt),{class:"h-3 w-3 mr-1"}),v(" "+i(r.checklist||"0/0"),1)]),(a=r.subtasks)!=null&&a.length?(l(),n("div",qe,[e[33]||(e[33]=t("div",{class:"mb-2 font-black border-b border-gray-700 pb-1 uppercase tracking-tighter text-gray-400"},"Task Checklist Detail",-1)),t("div",ze,[(l(!0),n(_,null,C(r.subtasks,d=>(l(),n("div",{key:d.id,class:"flex items-start gap-2 text-left"},[t("span",Ge,i(d.status==="done"?"✅":"⬜"),1),t("span",{class:F([{"opacity-50 line-through":d.status==="done"},"leading-tight"])},i(d.name),3)]))),128))])])):y("",!0)])]),t("td",We,[h(t("input",{type:"number","onUpdate:modelValue":d=>r.effort=d,onChange:d=>z(r,s,"effort",r.effort),class:"w-16 text-right border-0 bg-transparent focus:ring-1 focus:ring-indigo-200 rounded text-xs font-bold"},null,40,Je),[[w,r.effort]])]),t("td",Ke,[h(t("input",{type:"number",step:"0.5","onUpdate:modelValue":d=>r.manual_effort_override=d,onChange:d=>z(r,s,"manual_effort_override",r.manual_effort_override),class:"w-16 text-right border-0 bg-transparent focus:ring-1 focus:ring-indigo-200 rounded text-xs font-bold"},null,40,Qe),[[w,r.manual_effort_override]])]),t("td",Xe,i(G(r.used_seconds)),1)]),V.value[r.task_id]?(l(),n("tr",Ye,[t("td",ts,[e[34]||(e[34]=t("div",{class:"text-[10px] font-black text-gray-400 uppercase mb-3 tracking-widest"},"Activity Session Logs",-1)),(f=r.sessions)!=null&&f.length?(l(),n("div",es,[(l(!0),n(_,null,C(r.sessions,(d,B)=>(l(),n("div",{key:B,class:"bg-white p-3 rounded-lg border border-gray-100 shadow-sm flex items-center justify-between"},[t("div",null,[t("div",ss,i(d.type==="ongoing"?"Running":"Recorded"),1),t("div",os,i((d.start||"").split(" ")[1])+" - "+i(d.end==="Now"?"Now":(d.end||"").split(" ")[1]),1)]),t("div",rs,i(G(d.duration_seconds)),1)]))),128))])):(l(),n("div",as,"No activity logs tracked for this specific period."))])])):y("",!0)],64)}),128))])])],512),[[gt,M.value[s.user_id]]])]))),128))])]),c(Q,{show:R.value,"onUpdate:show":e[4]||(e[4]=s=>R.value=s),title:"Effort Estimation Guide",initialWidth:30},{content:A(()=>[c(ht)]),_:1},8,["show"]),c(Q,{show:U.value,"onUpdate:show":e[6]||(e[6]=s=>U.value=s),title:"Task Details",initialWidth:45},{content:A(()=>[P.value?(l(),Z(vt,{key:0,"task-id":P.value,"project-id":S.value,"project-users":O.value,onClose:e[5]||(e[5]=s=>U.value=!1),onTaskUpdated:it},null,8,["task-id","project-id","project-users"])):y("",!0)]),_:1},8,["show"]),E.value?(l(),n("div",ls,[t("div",{class:"absolute inset-0 bg-gray-900/60 backdrop-blur-sm",onClick:L}),t("div",ns,[t("div",is,[e[35]||(e[35]=t("h3",{class:"text-lg font-bold text-gray-900"},"Add Manual Activity",-1)),t("button",{onClick:L,class:"text-gray-400 hover:text-gray-600"},[c(p(jt),{class:"h-6 w-6"})])]),t("form",{onSubmit:J(nt,["prevent"]),class:"p-6 space-y-4"},[t("p",ds,[e[36]||(e[36]=v("Manual entry for: ",-1)),t("span",us,i(x.value.user_name),1)]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-1"},"Task Title",-1)),h(t("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=s=>x.value.name=s),required:"",class:"w-full rounded-lg border-gray-300 focus:ring-indigo-500 text-sm",placeholder:"Work description..."},null,512),[[w,x.value.name]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-1"},"Project Link",-1)),h(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>x.value.project_id=s),class:"w-full rounded-lg border-gray-300 focus:ring-indigo-500 text-sm"},[e[38]||(e[38]=t("option",{value:""},"General / Internal",-1)),(l(!0),n(_,null,C(j.value,s=>(l(),n("option",{key:s.value,value:s.value},i(s.label),9,cs))),128))],512),[[xt,x.value.project_id]])]),t("div",ps,[t("div",null,[e[40]||(e[40]=t("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-1"},"Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[9]||(e[9]=s=>x.value.date=s),required:"",class:"w-full rounded-lg border-gray-300 focus:ring-indigo-500 text-sm"},null,512),[[w,x.value.date]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-xs font-bold text-gray-500 uppercase mb-1"},"Hours Logged",-1)),h(t("input",{type:"number",step:"0.1","onUpdate:modelValue":e[10]||(e[10]=s=>x.value.hours=s),required:"",class:"w-full rounded-lg border-gray-300 focus:ring-indigo-500 text-sm",placeholder:"e.g. 1.5"},null,512),[[w,x.value.hours]])])]),t("div",{class:"pt-4 flex gap-3"},[e[42]||(e[42]=t("button",{type:"submit",class:"flex-1 bg-indigo-600 text-white font-bold py-2.5 rounded-xl hover:bg-indigo-700 transition"},"Save Log",-1)),t("button",{type:"button",onClick:L,class:"px-6 py-2.5 border border-gray-200 text-gray-600 font-bold rounded-xl hover:bg-gray-50 transition"},"Cancel")])],32)])])):y("",!0)]),_:1})],64))}},Bs=_t(gs,[["__scopeId","data-v-a7027441"]]);export{Bs as default};
