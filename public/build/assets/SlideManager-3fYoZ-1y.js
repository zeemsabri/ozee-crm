import{c as p,r as c,a as f,o as b,b as l,d as _,v as x,x as k,t as d,m as G,w as I,y as L,j as U,s as $,u as j,i as D,F as K,l as W,G as q,L as y,O as z}from"./app-BVX1Xzgm.js";import{u as O}from"./presentationStore-BkL6fjDI.js";import{d as H}from"./vuedraggable.umd-CIKwnRVH.js";import R from"./SlideThumbnail-BQ4Hgb79.js";import{B as J}from"./BaseFormModal-5czfdIGu.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./presentationsApi-BHZmoWwq.js";import"./index-CHJvA3mY.js";import"./Modal-g15qzrXp.js";import"./PrimaryButton-CSPVqQc4.js";import"./SecondaryButton-MUG3LyAH.js";const X={class:"p-4 h-full overflow-y-auto"},Y={class:"flex items-center mb-4 gap-3"},Z=["disabled"],ee=["disabled"],te=["onClick","onKeydown"],ae={class:"flex justify-between items-center"},le={class:"truncate font-medium text-gray-700 drag-handle cursor-move flex-1"},oe={class:"flex gap-2"},se=["onClick"],ie={class:"space-y-4"},ne={key:0,class:"text-sm text-red-600 mt-1"},re=["value"],de={key:0,class:"text-sm text-red-600 mt-1"},me={__name:"SlideManager",setup(ue){const o=O(),S=p(()=>o.selectedSlideId),g=c(""),m=c(!1),v=c(!1),r=c({prompt:"",template_name:"Default"}),h=p(()=>{var a;return!!((a=o.presentation)!=null&&a.id)}),T=p(()=>{var a;return(a=o.presentation)!=null&&a.id?`/api/presentations/${o.presentation.id}/generate-slide`:""}),V=["IntroCover","ThreeColumn","FourColumn","TwoColumnWithImageRight","TwoColumnWithImageLeft","FourStepProcess","ThreeStepProcess","TwoColumnWithChart","ProjectDetails","CallToAction","Default","Heading"];function M(){if(!h.value){y("No presentation loaded.");return}r.value={prompt:"",template_name:"Default"},v.value=!0}async function P(){return h.value?(r.value.prompt||"").trim()?!0:(y("Please enter a prompt."),!1):(y("No presentation loaded."),!1)}async function B(){var t;const a=(t=o.presentation)==null?void 0:t.id;if(!a)return;await o.load(a);const e=o.slides||[];if(e.length){const s=e[e.length-1];s!=null&&s.id&&o.selectSlide(s.id)}}const C=p({get(){const a=g.value.toLowerCase();return a?o.slides.filter(e=>(e.title||"").toLowerCase().includes(a)):o.slides},set(a){const e=[...o.slides],t=a.map(n=>n.id),s=t.map(n=>e.find(w=>w.id===n)),u=e.filter(n=>!t.includes(n.id)),i=[...s,...u];i.forEach((n,w)=>{n&&(n.display_order=w+1)}),o.presentation.slides=i}});function A(a){o.selectSlide(a)}async function F(){m.value=!0,await o.addSlide(),m.value=!1}async function N(a){await z("Delete this slide?",{confirmText:"Delete",cancelText:"Cancel",type:"warning"})&&await o.deleteSlide(a.id)}function E(){const a=o.slides.map(e=>e.id);o.reorderSlides(a)}return(a,e)=>(b(),f("div",X,[l("div",Y,[x(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>g.value=t),placeholder:"Search slides...",class:"w-25 sm:w-56 md:w-56 border border-gray-200 rounded-lg p-2 focus:ring-2 focus:ring-indigo-500","aria-label":"Search slides"},null,512),[[k,g.value]]),l("button",{onClick:F,class:"btn btn-primary","aria-label":"Add new slide",disabled:m.value},d(m.value?"...":"Add"),9,Z),l("button",{onClick:M,class:"btn bg-purple-100 text-purple-700 hover:bg-purple-200 flex items-center gap-2",disabled:!h.value,"aria-label":"Generate slide with AI",title:"Generate slide with AI"},e[5]||(e[5]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-5 h-5"},[l("path",{d:"M12 2a5 5 0 00-5 5v1.1A5.002 5.002 0 002 13a5 5 0 005 5h.1A5.002 5.002 0 0013 22a5 5 0 005-5v-.1A5.002 5.002 0 0022 11a5 5 0 00-5-5h-.1A5.002 5.002 0 0012 2z"})],-1),G(" AI ",-1)]),8,ee)]),_(j(H),{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=t=>C.value=t),"item-key":"id",class:"grid grid-cols-1 gap-4",handle:".drag-handle",onEnd:E,role:"list","aria-label":"Slides list"},{item:I(({element:t})=>[l("div",{class:U([{"bg-indigo-50 border-indigo-300":t.id===S.value,"border-transparent":t.id!==S.value},"p-4 border rounded-lg shadow-sm cursor-pointer hover:shadow-md transition-all duration-200"]),onClick:s=>A(t.id),role:"listitem",tabindex:"0",onKeydown:L(s=>A(t.id),["enter"])},[_(R,{slide:t,class:"mb-2","aria-label":"Slide thumbnail"},null,8,["slide"]),l("div",ae,[l("span",le," #"+d(t.display_order)+" Â· "+d(t.title||t.template_name),1),l("div",oe,[l("button",{onClick:$(s=>N(t),["stop"]),class:"btn btn-xs text-red-500","aria-label":"Delete slide"},"Delete",8,se)])])],42,te)]),_:1},8,["modelValue"]),_(J,{show:v.value,title:"Generate slide with AI","api-endpoint":T.value,"http-method":"post","form-data":r.value,"submit-button-text":"Generate","success-message":"AI slide generated","before-submit":P,onClose:e[4]||(e[4]=t=>v.value=!1),onSubmitted:B},{default:I(({errors:t})=>{var s,u;return[l("div",ie,[l("div",null,[e[6]||(e[6]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Prompt",-1)),x(l("textarea",{"onUpdate:modelValue":e[2]||(e[2]=i=>r.value.prompt=i),class:"w-full border border-gray-300 rounded-md p-2 min-h-[120px] focus:ring-2 focus:ring-indigo-500",placeholder:"Describe the slide you want to generate...","aria-label":"AI prompt",required:""},null,512),[[k,r.value.prompt]]),t.prompt?(b(),f("p",ne,d(((s=t.prompt)==null?void 0:s[0])||t.prompt),1)):D("",!0)]),l("div",null,[e[7]||(e[7]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Template",-1)),x(l("select",{"onUpdate:modelValue":e[3]||(e[3]=i=>r.value.template_name=i),class:"w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-indigo-500 bg-white","aria-label":"Slide template"},[(b(),f(K,null,W(V,i=>l("option",{key:i,value:i},d(i),9,re)),64))],512),[[q,r.value.template_name]]),t.template_name?(b(),f("p",de,d(((u=t.template_name)==null?void 0:u[0])||t.template_name),1)):D("",!0)])])]}),_:1},8,["show","api-endpoint","form-data"])]))}},Se=Q(me,[["__scopeId","data-v-8299432b"]]);export{Se as default};
