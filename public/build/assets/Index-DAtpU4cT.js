import{B as D,_ as J}from"./AuthenticatedLayout-Cty4jfmy.js";import{u as O,r as g,a as j,c as H,o as z,b as _,d as m,e as t,f as a,h as G,w as p,g as o,i as y,j as f,t as c,F as q,k as Q,l as K,m as R}from"./app-U1HYzxwv.js";import{P as S}from"./PrimaryButton-D_bsf8_I.js";import{D as $}from"./DangerButton-xqS5zZ0W.js";import{_ as W}from"./Modal-BlfLRqGm.js";import{_ as i}from"./InputLabel-DWiWZ5MK.js";import{_ as d}from"./TextInput-B-lyUlZ8.js";import{_ as u}from"./InputError-Bd6E7bNX.js";import{_ as X}from"./SecondaryButton-l6dahQhg.js";import{S as F}from"./SelectDropdown-bdiuKYah.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Checkbox-B50ovmzG.js";import"./ApplicationLogo-zdUJEYJM.js";import"./moment-BLMuvzoS.js";const Z={class:"py-12"},ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},le={class:"p-6 text-gray-900"},oe={key:0,class:"mb-6"},ae={key:1,class:"text-gray-600"},se={key:2,class:"text-red-600"},ne={key:3,class:"text-gray-600"},re={key:4},ie={class:"min-w-full divide-y divide-gray-200"},de={class:"bg-white divide-y divide-gray-200"},ue={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-6 py-4 whitespace-nowrap"},_e={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ve={class:"flex items-center space-x-2"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},fe={class:"mb-4"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},he={class:"mb-4"},ye={class:"mb-4"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},we={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},xe={class:"mb-4"},Ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Pe={class:"mb-4"},Me={class:"mb-4"},Be={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Ce={class:"p-6"},Ue={key:0,class:"mt-4 text-gray-800"},De={key:1,class:"text-red-600 text-sm mb-4"},qe={class:"mt-6 flex justify-end"},He={__name:"Index",setup(Ke){const{canDo:C}=O();C("view_monthly_budgets");const V=C("manage_monthly_budgets"),P=g([]),M=g(!0),v=g(""),k=g(!1),w=g(!1),b=g(!1),l=j({id:null,year:new Date().getFullYear(),month:new Date().getMonth()+1,total_budget_pkr:0,consistent_contributor_pool_pkr:0,high_achiever_pool_pkr:0,team_total_points:0,points_value_pkr:0,most_improved_award_pkr:0,first_place_award_pkr:0}),h=g(null),U=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],A=H(()=>{const r=new Date().getFullYear(),e=[];for(let s=r-5;s<=r+5;s++)e.push({value:s,label:s.toString()});return e}),B=r=>{var e;return((e=U.find(s=>s.value===r))==null?void 0:e.label)||""},x=async()=>{M.value=!0,v.value="";try{const r=await R.get("/admin/monthly-budgets/all");P.value=r.data}catch(r){v.value="Failed to fetch monthly budgets.",console.error("Error fetching monthly budgets:",r)}finally{M.value=!1}},T=()=>{l.reset(),l.clearErrors(),l.year=new Date().getFullYear(),l.month=new Date().getMonth()+1,k.value=!0},E=()=>{k.value=!1,x()},N=r=>{l.reset(),l.clearErrors(),l.id=r.id,l.year=r.year,l.month=r.month,l.total_budget_pkr=r.total_budget_pkr,l.consistent_contributor_pool_pkr=r.consistent_contributor_pool_pkr,l.high_achiever_pool_pkr=r.high_achiever_pool_pkr,l.team_total_points=r.team_total_points,l.points_value_pkr=r.points_value_pkr,l.most_improved_award_pkr=r.most_improved_award_pkr,l.first_place_award_pkr=r.first_place_award_pkr,w.value=!0},Y=()=>{w.value=!1,x()},L=r=>{h.value=r,b.value=!0},I=()=>{R.delete(`/admin/monthly-budgets/${h.value.id}`).then(()=>{b.value=!1,x()}).catch(r=>{v.value="Failed to delete monthly budget.",console.error("Error deleting monthly budget:",r)})};return z(()=>{x()}),(r,e)=>(m(),_(q,null,[t(a(G),{title:"Monthly Budgets"}),t(J,null,{header:p(()=>e[21]||(e[21]=[o("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Monthly Budgets",-1)])),default:p(()=>[o("div",Z,[o("div",ee,[o("div",te,[o("div",le,[e[26]||(e[26]=o("h3",{class:"text-2xl font-bold mb-4"},"Manage Monthly Budgets",-1)),a(V)?(m(),_("div",oe,[t(S,{onClick:T},{default:p(()=>e[22]||(e[22]=[f(" Create New Monthly Budget ",-1)])),_:1,__:[22]})])):y("",!0),M.value?(m(),_("div",ae,"Loading monthly budgets...")):v.value?(m(),_("div",se,c(v.value),1)):P.value.length===0?(m(),_("div",ne,"No monthly budgets found.")):(m(),_("div",re,[o("table",ie,[e[25]||(e[25]=o("thead",{class:"bg-gray-50"},[o("tr",null,[o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Period"),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Total Budget (PKR)"),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Team Points"),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Point Value (PKR)"),o("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),o("tbody",de,[(m(!0),_(q,null,Q(P.value,s=>(m(),_("tr",{key:s.id},[o("td",ue,c(B(s.month))+" "+c(s.year),1),o("td",me,c(s.total_budget_pkr.toLocaleString()),1),o("td",_e,c(s.team_total_points.toLocaleString()),1),o("td",pe,c(s.points_value_pkr.toLocaleString()),1),o("td",ce,[o("div",ve,[a(V)?(m(),K(S,{key:0,onClick:n=>N(s)},{default:p(()=>e[23]||(e[23]=[f(" Edit ",-1)])),_:2,__:[23]},1032,["onClick"])):y("",!0),a(V)?(m(),K($,{key:1,onClick:n=>L(s)},{default:p(()=>e[24]||(e[24]=[f(" Delete ",-1)])),_:2,__:[24]},1032,["onClick"])):y("",!0)])])]))),128))])])]))])])])]),t(D,{show:k.value,title:"Create New Monthly Budget","api-endpoint":"/admin/monthly-budgets","http-method":"post","form-data":a(l),"submit-button-text":"Create Budget","success-message":"Monthly budget created successfully!",onClose:e[9]||(e[9]=s=>k.value=!1),onSubmitted:E},{default:p(({errors:s})=>[o("div",ge,[o("div",null,[t(i,{for:"create_year",value:"Year"}),t(F,{id:"create_year",modelValue:a(l).year,"onUpdate:modelValue":e[0]||(e[0]=n=>a(l).year=n),options:A.value,placeholder:"Select Year",class:"mt-1 block w-full"},null,8,["modelValue","options"]),t(u,{message:s.year,class:"mt-2"},null,8,["message"])]),o("div",null,[t(i,{for:"create_month",value:"Month"}),t(F,{id:"create_month",modelValue:a(l).month,"onUpdate:modelValue":e[1]||(e[1]=n=>a(l).month=n),options:U,placeholder:"Select Month",class:"mt-1 block w-full"},null,8,["modelValue"]),t(u,{message:s.month,class:"mt-2"},null,8,["message"])])]),o("div",fe,[t(i,{for:"create_total_budget",value:"Total Budget (PKR)"}),t(d,{id:"create_total_budget",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).total_budget_pkr,"onUpdate:modelValue":e[2]||(e[2]=n=>a(l).total_budget_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.total_budget_pkr,class:"mt-2"},null,8,["message"])]),o("div",be,[o("div",null,[t(i,{for:"create_consistent_contributor_pool",value:"Consistent Contributor Pool (PKR)"}),t(d,{id:"create_consistent_contributor_pool",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).consistent_contributor_pool_pkr,"onUpdate:modelValue":e[3]||(e[3]=n=>a(l).consistent_contributor_pool_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.consistent_contributor_pool_pkr,class:"mt-2"},null,8,["message"])]),o("div",null,[t(i,{for:"create_high_achiever_pool",value:"High Achiever Pool (PKR)"}),t(d,{id:"create_high_achiever_pool",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).high_achiever_pool_pkr,"onUpdate:modelValue":e[4]||(e[4]=n=>a(l).high_achiever_pool_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.high_achiever_pool_pkr,class:"mt-2"},null,8,["message"])])]),o("div",he,[t(i,{for:"create_team_total_points",value:"Team Total Points"}),t(d,{id:"create_team_total_points",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).team_total_points,"onUpdate:modelValue":e[5]||(e[5]=n=>a(l).team_total_points=n),required:""},null,8,["modelValue"]),t(u,{message:s.team_total_points,class:"mt-2"},null,8,["message"])]),o("div",ye,[t(i,{for:"create_points_value",value:"Points Value (PKR)"}),t(d,{id:"create_points_value",type:"number",step:"0.0001",min:"0",class:"mt-1 block w-full",modelValue:a(l).points_value_pkr,"onUpdate:modelValue":e[6]||(e[6]=n=>a(l).points_value_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.points_value_pkr,class:"mt-2"},null,8,["message"])]),o("div",ke,[o("div",null,[t(i,{for:"create_most_improved_award",value:"Most Improved Award (PKR)"}),t(d,{id:"create_most_improved_award",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).most_improved_award_pkr,"onUpdate:modelValue":e[7]||(e[7]=n=>a(l).most_improved_award_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.most_improved_award_pkr,class:"mt-2"},null,8,["message"])]),o("div",null,[t(i,{for:"create_first_place_award",value:"First Place Award (PKR)"}),t(d,{id:"create_first_place_award",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).first_place_award_pkr,"onUpdate:modelValue":e[8]||(e[8]=n=>a(l).first_place_award_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.first_place_award_pkr,class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","form-data"]),t(D,{show:w.value,title:"Edit Monthly Budget","api-endpoint":`/admin/monthly-budgets/${a(l).id}`,"http-method":"put","form-data":a(l),"submit-button-text":"Update Budget","success-message":"Monthly budget updated successfully!",onClose:e[18]||(e[18]=s=>w.value=!1),onSubmitted:Y},{default:p(({errors:s})=>[o("div",we,[o("div",null,[t(i,{for:"edit_year",value:"Year"}),t(d,{id:"edit_year",type:"number",class:"mt-1 block w-full",modelValue:a(l).year,"onUpdate:modelValue":e[10]||(e[10]=n=>a(l).year=n),disabled:""},null,8,["modelValue"])]),o("div",null,[t(i,{for:"edit_month",value:"Month"}),t(d,{id:"edit_month",type:"text",class:"mt-1 block w-full",value:B(a(l).month),disabled:""},null,8,["value"])])]),o("div",xe,[t(i,{for:"edit_total_budget",value:"Total Budget (PKR)"}),t(d,{id:"edit_total_budget",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).total_budget_pkr,"onUpdate:modelValue":e[11]||(e[11]=n=>a(l).total_budget_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.total_budget_pkr,class:"mt-2"},null,8,["message"])]),o("div",Ve,[o("div",null,[t(i,{for:"edit_consistent_contributor_pool",value:"Consistent Contributor Pool (PKR)"}),t(d,{id:"edit_consistent_contributor_pool",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).consistent_contributor_pool_pkr,"onUpdate:modelValue":e[12]||(e[12]=n=>a(l).consistent_contributor_pool_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.consistent_contributor_pool_pkr,class:"mt-2"},null,8,["message"])]),o("div",null,[t(i,{for:"edit_high_achiever_pool",value:"High Achiever Pool (PKR)"}),t(d,{id:"edit_high_achiever_pool",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).high_achiever_pool_pkr,"onUpdate:modelValue":e[13]||(e[13]=n=>a(l).high_achiever_pool_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.high_achiever_pool_pkr,class:"mt-2"},null,8,["message"])])]),o("div",Pe,[t(i,{for:"edit_team_total_points",value:"Team Total Points"}),t(d,{id:"edit_team_total_points",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).team_total_points,"onUpdate:modelValue":e[14]||(e[14]=n=>a(l).team_total_points=n),required:""},null,8,["modelValue"]),t(u,{message:s.team_total_points,class:"mt-2"},null,8,["message"])]),o("div",Me,[t(i,{for:"edit_points_value",value:"Points Value (PKR)"}),t(d,{id:"edit_points_value",type:"number",step:"0.0001",min:"0",class:"mt-1 block w-full",modelValue:a(l).points_value_pkr,"onUpdate:modelValue":e[15]||(e[15]=n=>a(l).points_value_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.points_value_pkr,class:"mt-2"},null,8,["message"])]),o("div",Be,[o("div",null,[t(i,{for:"edit_most_improved_award",value:"Most Improved Award (PKR)"}),t(d,{id:"edit_most_improved_award",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).most_improved_award_pkr,"onUpdate:modelValue":e[16]||(e[16]=n=>a(l).most_improved_award_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.most_improved_award_pkr,class:"mt-2"},null,8,["message"])]),o("div",null,[t(i,{for:"edit_first_place_award",value:"First Place Award (PKR)"}),t(d,{id:"edit_first_place_award",type:"number",step:"0.01",min:"0",class:"mt-1 block w-full",modelValue:a(l).first_place_award_pkr,"onUpdate:modelValue":e[17]||(e[17]=n=>a(l).first_place_award_pkr=n),required:""},null,8,["modelValue"]),t(u,{message:s.first_place_award_pkr,class:"mt-2"},null,8,["message"])])])]),_:1},8,["show","api-endpoint","form-data"]),t(W,{show:b.value,onClose:e[20]||(e[20]=s=>b.value=!1)},{default:p(()=>[o("div",Ce,[e[30]||(e[30]=o("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this monthly budget? ",-1)),e[31]||(e[31]=o("p",{class:"mt-1 text-sm text-gray-600"}," This action cannot be undone. All points calculations based on this budget will be affected. ",-1)),h.value?(m(),_("div",Ue,[e[27]||(e[27]=o("strong",null,"Period:",-1)),f(" "+c(B(h.value.month))+" "+c(h.value.year),1)])):y("",!0),v.value?(m(),_("div",De,c(v.value),1)):y("",!0),o("div",qe,[t(X,{onClick:e[19]||(e[19]=s=>b.value=!1)},{default:p(()=>e[28]||(e[28]=[f("Cancel",-1)])),_:1,__:[28]}),t($,{class:"ms-3",onClick:I},{default:p(()=>e[29]||(e[29]=[f("Delete Budget",-1)])),_:1,__:[29]})])])]),_:1},8,["show"])]),_:1})],64))}};export{He as default};
