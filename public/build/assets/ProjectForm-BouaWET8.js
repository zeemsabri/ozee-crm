import{x as xe,r as P,M as R,z as ve,w as te,B as me,i as d,o as l,b as t,m as F,g as x,e as i,f as ge,k as je,c as se,a as Q,p as H,L as re,s as E,F as ce,j as ue,t as $,v as Ve,O as Ke,Y as Ne,h as S,ai as Ge,l as Ye,a7 as We,aj as Je,ak as Xe,al as Qe,$ as Ze}from"./app-LVJx7_bI.js";import{_ as D}from"./InputLabel-CBNE2Wzj.js";import{_ as L,a as O}from"./InputError-BJ3-j-HB.js";import{P as ae}from"./PrimaryButton-CAJgoEm1.js";import{S as oe,T as et}from"./AuthenticatedLayout-uIIuDcrP.js";import{P as tt,_ as at}from"./ProjectTypeInput-DQ5x1rqq.js";import{_ as st}from"./Checkbox-Bti-hCmj.js";import{a as he}from"./SecondaryButton-6J3uj4Gp.js";const ot=P([]),nt=P([]),Ie=P([]),Ce=P([]),Ue=async e=>{try{const p=(await xe.get(`/api/roles?type=${e}`)).data.map(v=>({value:v.id,label:v.name}));return e==="client"?ot.value=p:e==="project"&&(nt.value=p),p}catch(g){return console.error(`Error fetching ${e} roles:`,g),R(`Failed to load ${e} roles. Please refresh the page.`),[]}},lt=async(e,g)=>{try{let a;return g&&!e||e&&(a=await window.axios.get("/api/clients"),Ie.value=a.data.data||a.data),Ie.value}catch(a){return console.error("Error fetching clients:",a),R("Failed to load clients. Please try again."),[]}},rt=async(e,g)=>{try{let a;return g&&!e||e&&(a=await window.axios.get("/api/users"),Ce.value=a.data),Ce.value}catch(a){return console.error("Error fetching users:",a),R("Failed to load users. Please try again."),[]}},we=async(e,g,a)=>{let p="",v=null;try{switch(g){case"basic":p=`/api/projects/${e}/sections/basic`;break;case"client":(a.canViewProjectClients||a.canManageProjectClients||a.canViewProjectUsers||a.canManageProjectUsers)&&(p=`/api/projects/${e}/sections/clients-users`);break;case"services":(a.canViewProjectServicesAndPayments||a.canManageProjectServicesAndPayments)&&(p=`/api/projects/${e}/sections/services-payment`);break;case"documents":a.canViewProjectDocuments&&(p=`/api/projects/${e}/sections/documents`);break;case"notes":(a.canViewProjectNotes||a.canAddProjectNotes)&&(p=`/api/projects/${e}/sections/notes?type=private`);break;case"transactions":return null;default:return console.warn(`Attempted to fetch data for unknown tab: ${g}`),null}return p&&(v=(await window.axios.get(p)).data),v}catch(k){throw console.error(`Error fetching data for tab '${g}':`,k),R(`Failed to load data for ${g} section. Please try again.`),k}},it={class:"space-y-6 bg-white p-6 rounded-lg border border-gray-100 font-inter"},dt={key:0,class:"text-center py-8 text-gray-500 text-lg"},ct={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ut={key:0},mt={key:1},vt={key:2},gt=["disabled"],pt={key:0,class:"mt-2"},yt=["src"],ft={class:"mt-6"},bt=["disabled"],wt={class:"mt-6"},ht={class:"mt-6"},xt={class:"mt-6 flex justify-end"},jt={key:0,class:"flex items-center"},kt={key:1},_t={__name:"ProjectEditBasicInfo",props:{projectId:{type:[Number,String],required:!0},errors:{type:Object,default:()=>({})},statusOptions:{type:Array,required:!0,default:()=>[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"paid",label:"Paid"},{value:"on-hold",label:"On-hold"}]},sourceOptions:{type:Array,required:!0},canManageProjects:{type:Boolean,default:!1},canManageProjectBasicDetails:{type:Boolean,default:!1},isSaving:{type:Boolean,default:!1}},setup(e){const g=e,a=ve({id:null,name:"",description:"",website:"",social_media_link:"",preferred_keywords:"",google_chat_id:"",google_drive_link:"",logo:null,status:"active",project_type:"",source:"",tags:[],tags_data:[],timezone:null}),p=P(!1),v=P(!0),k=b=>{const u=b.target.files[0];u?a.logo=u:a.logo=null},N=async()=>{p.value=!0;const b=new FormData,u=["id","tags","tags_data","logo"];for(const s in a)u.includes(s)||a[s]!==null&&a[s]!==void 0&&b.append(s,a[s]);Array.isArray(a.tags)&&a.tags.forEach(s=>{const n=typeof s=="object"&&s!==null&&s.id?s.id:s;n!=null&&b.append("tags[]",n)}),a.logo instanceof File&&b.append("logo",a.logo),b.append("_method","PUT");try{const s=await window.axios.post(`/api/projects/${g.projectId}/sections/basic`,b,{headers:{"Content-Type":"multipart/form-data"}});re("Project basic information updated successfully!"),s.data&&Object.assign(a,{name:s.data.name||a.name,description:s.data.description||a.description,website:s.data.website||a.website,social_media_link:s.data.social_media_link||a.social_media_link,preferred_keywords:s.data.preferred_keywords||a.preferred_keywords,google_chat_id:s.data.google_chat_id||a.google_chat_id,google_drive_link:s.data.google_drive_link||a.google_drive_link,logo:s.data.logo||a.logo,status:s.data.status||a.status,project_type:s.data.project_type||a.project_type,source:s.data.source||a.source,tags:s.data.tags||a.tags,tags_data:s.data.tags_data||a.tags_data,timezone:s.data.timezone||a.timezone})}catch(s){console.error("Error saving basic info:",s);let n="Failed to save basic information.";s.response&&s.response.data&&s.response.data.message&&(n=s.response.data.message),R(n)}finally{p.value=!1}},C=async()=>{if(!g.projectId){v.value=!1;return}v.value=!0;try{const b=await we(g.projectId,"basic",{});b&&Object.assign(a,{id:b.id||g.projectId,name:b.name||"",description:b.description||"",website:b.website||"",social_media_link:b.social_media_link||"",preferred_keywords:b.preferred_keywords||"",google_chat_id:b.google_chat_id||"",google_drive_link:b.google_drive_link||"",logo:b.logo||null,status:b.status||"active",project_type:b.project_type||"",source:b.source||"",tags:b.tags||[],tags_data:b.tags_data||[],timezone:b.timezone||null})}catch(b){console.error("Error fetching basic info:",b),R("Failed to load basic project information.")}finally{v.value=!1}};return te(()=>g.projectId,async b=>{setTimeout(async()=>{b&&await C()},500)},{immediate:!0}),me(()=>{}),(b,u)=>(l(),d("div",it,[v.value?(l(),d("div",dt,u[12]||(u[12]=[t("svg",{class:"animate-spin h-8 w-8 text-indigo-500 mx-auto mb-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),F(" Loading basic project information... ",-1)]))):(l(),d("div",ct,[t("div",null,[i(D,{for:"name",value:"Project Name"}),i(L,{id:"name",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:a.name,"onUpdate:modelValue":u[0]||(u[0]=s=>a.name=s),required:"",autofocus:"",disabled:!e.canManageProjects||p.value||e.isSaving},null,8,["modelValue","disabled"]),i(O,{message:e.errors.name?e.errors.name[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[i(D,{for:"website",value:"Website"}),i(L,{id:"website",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:a.website,"onUpdate:modelValue":u[1]||(u[1]=s=>a.website=s),disabled:!e.canManageProjects||p.value||e.isSaving},null,8,["modelValue","disabled"]),i(O,{message:e.errors.website?e.errors.website[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[i(D,{for:"social_media_link",value:"Social Media Link"}),i(L,{id:"social_media_link",type:"url",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:a.social_media_link,"onUpdate:modelValue":u[2]||(u[2]=s=>a.social_media_link=s),disabled:!e.canManageProjects||p.value||e.isSaving},null,8,["modelValue","disabled"]),i(O,{message:e.errors.social_media_link?e.errors.social_media_link[0]:"",class:"mt-2"},null,8,["message"])]),e.canManageProjectBasicDetails?(l(),d("div",ut,[i(D,{for:"google_chat_id",value:"Google Chat ID"}),i(L,{id:"google_chat_id",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:a.google_chat_id,"onUpdate:modelValue":u[3]||(u[3]=s=>a.google_chat_id=s),disabled:!e.canManageProjects||p.value||e.isSaving},null,8,["modelValue","disabled"]),i(O,{message:e.errors.google_chat_id?e.errors.google_chat_id[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0),e.canManageProjectBasicDetails?(l(),d("div",mt,[i(D,{for:"google_drive_link",value:"Google Drive Link"}),i(L,{id:"google_drive_link",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:a.google_drive_link,"onUpdate:modelValue":u[4]||(u[4]=s=>a.google_drive_link=s),disabled:!e.canManageProjects||p.value||e.isSaving},null,8,["modelValue","disabled"]),i(O,{message:e.errors.google_drive_link?e.errors.google_drive_link[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0),t("div",null,[i(D,{for:"status",value:"Status"}),i(oe,{id:"status",modelValue:a.status,"onUpdate:modelValue":u[5]||(u[5]=s=>a.status=s),options:e.statusOptions,valueKey:"value",labelKey:"label",placeholder:"Select Project Status",disabled:!e.canManageProjects||p.value||e.isSaving,required:!0,class:"mt-1 block w-full"},null,8,["modelValue","options","disabled"]),i(O,{message:e.errors.status?e.errors.status[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[i(tt,{id:"project_type",modelValue:a.project_type,"onUpdate:modelValue":u[6]||(u[6]=s=>a.project_type=s),disabled:!e.canManageProjects||p.value||e.isSaving,class:"mt-1 block w-full"},null,8,["modelValue","disabled"]),i(O,{message:e.errors.project_type?e.errors.project_type[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[i(D,{for:"source",value:"Source"}),i(oe,{id:"source",modelValue:a.source,"onUpdate:modelValue":u[7]||(u[7]=s=>a.source=s),options:e.sourceOptions,valueKey:"value",labelKey:"label",placeholder:"Select a Source",disabled:!e.canManageProjects||p.value||e.isSaving,class:"mt-1 block w-full"},null,8,["modelValue","options","disabled"]),i(O,{message:e.errors.source?e.errors.source[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[i(at,{id:"timezone",modelValue:a.timezone,"onUpdate:modelValue":u[8]||(u[8]=s=>a.timezone=s),disabled:!e.canManageProjects||p.value||e.isSaving,class:"mt-1 block w-full"},null,8,["modelValue","disabled"]),i(O,{message:e.errors.timezone?e.errors.timezone[0]:"",class:"mt-2"},null,8,["message"])]),e.canManageProjectBasicDetails?(l(),d("div",vt,[i(D,{for:"logo",value:"Project Logo"}),t("input",{type:"file",id:"logo",onChange:k,class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 cursor-pointer",accept:"image/*",disabled:!e.canManageProjectBasicDetails||p.value||e.isSaving},null,40,gt),a.logo&&typeof a.logo=="string"?(l(),d("div",pt,[u[13]||(u[13]=t("p",{class:"text-sm text-gray-600"},"Current Logo:",-1)),t("img",{src:a.logo,alt:"Project Logo",class:"h-20 w-20 object-contain rounded-lg shadow-md border border-gray-200"},null,8,yt)])):x("",!0),i(O,{message:e.errors.logo?e.errors.logo[0]:"",class:"mt-2"},null,8,["message"])])):x("",!0)])),t("div",ft,[i(D,{for:"description",value:"Description"}),ge(t("textarea",{id:"description",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm mt-1 block w-full","onUpdate:modelValue":u[9]||(u[9]=s=>a.description=s),disabled:!e.canManageProjects||p.value||e.isSaving,rows:"4"},null,8,bt),[[je,a.description]]),i(O,{message:e.errors.description?e.errors.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",wt,[i(D,{for:"preferred_keywords",value:"Client Preferred Keywords"}),i(L,{id:"preferred_keywords",type:"text",class:"mt-1 block w-full rounded-lg shadow-sm",modelValue:a.preferred_keywords,"onUpdate:modelValue":u[10]||(u[10]=s=>a.preferred_keywords=s),disabled:!e.canManageProjects||p.value||e.isSaving},null,8,["modelValue","disabled"]),i(O,{message:e.errors.preferred_keywords?e.errors.preferred_keywords[0]:"",class:"mt-2"},null,8,["message"])]),t("div",ht,[i(et,{modelValue:a.tags,"onUpdate:modelValue":u[11]||(u[11]=s=>a.tags=s),initialTags:a.tags_data,label:"Associated Tags",placeholder:"Search or add tags",error:e.errors.tags?e.errors.tags[0]:"",disabled:!e.canManageProjects||p.value||e.isSaving},null,8,["modelValue","initialTags","error","disabled"])]),t("div",xt,[e.canManageProjectBasicDetails?(l(),se(ae,{key:0,onClick:N,disabled:!e.canManageProjects||p.value||e.isSaving,class:H([{"opacity-50 cursor-not-allowed":p.value||e.isSaving},"px-6 py-2 rounded-lg text-base shadow-md hover:shadow-lg transition-all"])},{default:Q(()=>[p.value||e.isSaving?(l(),d("span",jt,u[14]||(u[14]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),F(" Updating... ",-1)]))):(l(),d("span",kt," Update Basic Information "))]),_:1},8,["disabled","class"])):x("",!0)])]))}},Pt={class:"mb-4"},$t={class:"mt-2"},St={key:0,class:"text-gray-500 text-sm mb-2"},Vt={class:"mb-4"},It={key:1,class:"space-y-3"},Ct={class:"flex-grow text-gray-800 font-medium"},Ut={class:"text-gray-600 text-sm"},Dt={class:"flex items-center space-x-2"},At=["onClick"],Mt={key:2,class:"p-4 bg-gray-50 rounded-lg text-gray-600 text-center border border-dashed border-gray-200"},De={__name:"MultiSelectWithRoles",props:{label:{type:String,required:!0},items:{type:Array,default:()=>[]},endpoint:{type:String,default:""},selectedItems:{type:Array,default:()=>[]},itemText:{type:String,default:"name"},itemSubtext:{type:String,default:"email"},itemValue:{type:String,default:"id"},roleOptions:{type:Array,default:()=>[]},roleType:{type:String,default:"application"},defaultRoleId:{type:Number,default:null},error:{type:String,default:""},placeholder:{type:String,default:"Select an item"},showRemoveButton:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},emits:["update:selectedItems"],setup(e,{emit:g}){const a=e,p=g,v=P([]),k=P([]),N=P([]),C=P([]),b=P(!1),u=async()=>{if(!(a.roleOptions.length>0))try{const U=(await xe.get(`/api/roles?type=${a.roleType}`)).data;N.value=U.map(B=>({value:B.id,label:B.name}))}catch(m){console.error("Error fetching roles:",m)}},s=E(()=>N.value.length>0?N.value:a.roleOptions),n=()=>a.defaultRoleId?a.defaultRoleId:s.value.length>0?s.value[0].value:1,j=()=>{v.value=[],k.value=[],!(!a.selectedItems||a.selectedItems.length===0)&&a.selectedItems.forEach(m=>{const U=typeof m=="object"?m[a.itemValue]:m,B=typeof m=="object"&&m.role_id!==void 0?m.role_id:n();if(!v.value.includes(U))v.value.push(U),k.value.push({id:U,role_id:B});else{const q=k.value.find(W=>W.id===U);q&&q.role_id!==B&&(q.role_id=B)}})};te(()=>a.selectedItems,(m,U)=>{JSON.stringify(m)!==JSON.stringify(U)&&j()},{deep:!0,immediate:!0}),te(k,m=>{p("update:selectedItems",m)},{deep:!0});const w=m=>{a.disabled||m&&!v.value.includes(m)&&(v.value.push(m),k.value.push({id:m,role_id:n()}))},V=m=>{a.disabled||(v.value=v.value.filter(U=>U!==m),k.value=k.value.filter(U=>U.id!==m))},K=(m,U)=>{if(a.disabled)return;const B=k.value.find(q=>q.id===m);B&&(B.role_id=parseInt(U))},G=m=>M.value.find(U=>U[a.itemValue]===m),Y=m=>{const U=k.value.find(B=>B.id===m);return U?U.role_id:n()},I=async()=>{if(a.endpoint){b.value=!0;try{const m=await xe.get(a.endpoint);m.data&&Array.isArray(m.data)?C.value=m.data:m.data&&m.data.data&&Array.isArray(m.data.data)&&(C.value=m.data.data)}catch(m){console.error("Error fetching items from endpoint:",m)}finally{b.value=!1}}},M=E(()=>a.endpoint&&C.value.length>0?C.value:a.items),ne=E(()=>M.value.filter(m=>!v.value.includes(m[a.itemValue])).map(m=>({value:m[a.itemValue],label:`${m[a.itemText]} (${m[a.itemSubtext]})`})));return me(()=>{u(),a.endpoint&&I()}),(m,U)=>(l(),d("div",Pt,[i(D,{value:e.label},null,8,["value"]),t("div",$t,[b.value?(l(),d("div",St,"Loading available items...")):x("",!0),t("div",Vt,[i(oe,{modelValue:m.selectedItemToAdd,"onUpdate:modelValue":U[0]||(U[0]=B=>m.selectedItemToAdd=B),options:ne.value,valueKey:"value",labelKey:"label",placeholder:e.placeholder,disabled:b.value||e.disabled,onChange:w,class:"w-full"},null,8,["modelValue","options","placeholder","disabled"])]),v.value.length>0?(l(),d("div",It,[(l(!0),d(ce,null,ue(v.value,B=>{var q,W;return l(),d("div",{key:B,class:"flex items-center p-3 border border-gray-200 rounded-lg bg-gray-50 shadow-sm"},[t("div",Ct,[F($((q=G(B))==null?void 0:q[e.itemText])+" ",1),t("span",Ut,"("+$((W=G(B))==null?void 0:W[e.itemSubtext])+")",1)]),t("div",Dt,[i(oe,{modelValue:Y(B),"onUpdate:modelValue":f=>K(B,f),options:s.value,valueKey:"value",labelKey:"label",placeholder:"Select Role",disabled:e.disabled,class:"w-32"},null,8,["modelValue","onUpdate:modelValue","options","disabled"]),e.showRemoveButton&&!e.disabled?(l(),d("button",{key:0,type:"button",class:"text-red-500 hover:text-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 rounded-full p-1 transition-colors duration-200",onClick:f=>V(B),"aria-label":"Remove item"},U[1]||(U[1]=[t("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,At)):x("",!0)])])}),128))])):(l(),d("div",Mt," No "+$(e.label.toLowerCase())+" selected. ",1))]),i(O,{message:e.error,class:"mt-2"},null,8,["message"])]))}},Nt={class:"space-y-8"},Bt={key:0,class:"bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},Ot={key:0,class:"mt-6 flex justify-end"},Rt={key:0},Tt={key:1},Ft={key:1,class:"mt-3 text-green-600 text-sm flex items-center"},Et={key:2,class:"mt-3 text-red-600 text-sm flex items-center"},zt={class:"bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},Lt=["disabled"],qt={key:1,class:"bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},Ht={key:0,class:"mt-6 flex justify-end"},Kt={key:0},Gt={key:1},Yt={key:1,class:"mt-3 text-green-600 text-sm flex items-center"},Wt={key:2,class:"mt-3 text-red-600 text-sm flex items-center"},Jt={__name:"ProjectFormClientsUsers",props:{projectId:{type:[Number,String],required:!0},errors:{type:Object,default:()=>({})},clientRoleOptions:{type:Array,default:()=>[]},userRoleOptions:{type:Array,default:()=>[]},clients:{type:Array,default:()=>[]},users:{type:Array,default:()=>[]},canViewProjectClients:{type:Boolean,default:!1},canManageProjectClients:{type:Boolean,default:!1},canViewProjectUsers:{type:Boolean,default:!1},canManageProjectUsers:{type:Boolean,default:!1},isSaving:{type:Boolean,default:!1}},setup(e){const g=e,a=ve({client_ids:[],user_ids:[],contract_details:""}),p=P(!1),v=P(!1),k=P(""),N=P(!1),C=P(!1),b=P(""),u=async()=>{if(g.projectId)try{const j=await we(g.projectId,"client",{canViewProjectClients:g.canViewProjectClients,canManageProjectClients:g.canManageProjectClients,canViewProjectUsers:g.canViewProjectUsers,canManageProjectUsers:g.canManageProjectUsers});j&&(a.client_ids=j.clients?j.clients.map(w=>{var V;return{id:w.id,role_id:((V=w.pivot)==null?void 0:V.role_id)||(g.clientRoleOptions.length>0?g.clientRoleOptions[0].value:null)}}):[],a.user_ids=j.users?j.users.map(w=>{var V;return{id:w.id,role_id:((V=w.pivot)==null?void 0:V.role_id)||(g.userRoleOptions.length>0?g.userRoleOptions[0].value:null)}}):[],a.contract_details=j.contract_details||"")}catch(j){console.error("Error fetching clients/users data:",j),R("Failed to load clients and users data.")}};te(()=>g.projectId,async j=>{j&&await u()},{immediate:!0});const s=async()=>{var j,w;if(!g.projectId){R("Project ID is missing. Cannot save clients.");return}if(!a.client_ids||a.client_ids.length===0){R("Please select at least one client to save.");return}p.value=!0,v.value=!1,k.value="";try{await window.axios.post(`/api/projects/${g.projectId}/attach-clients`,{client_ids:a.client_ids}),re("Clients saved successfully!"),v.value=!0,await u()}catch(V){console.error("Error saving clients:",V),k.value=((w=(j=V.response)==null?void 0:j.data)==null?void 0:w.message)||"Failed to save clients.",R(k.value)}finally{p.value=!1,setTimeout(()=>v.value=!1,3e3)}},n=async()=>{var j,w;if(!g.projectId){R("Project ID is missing. Cannot save users.");return}if(!a.user_ids||a.user_ids.length===0){R("Please select at least one user to save.");return}N.value=!0,C.value=!1,b.value="";try{await window.axios.post(`/api/projects/${g.projectId}/attach-users`,{user_ids:a.user_ids}),re("Users saved successfully!"),C.value=!0,await u()}catch(V){console.error("Error saving users:",V),b.value=((w=(j=V.response)==null?void 0:j.data)==null?void 0:w.message)||"Failed to save users.",R(b.value)}finally{N.value=!1,setTimeout(()=>C.value=!1,3e3)}};return me(()=>{}),(j,w)=>(l(),d("div",Nt,[e.canViewProjectClients?(l(),d("div",Bt,[w[5]||(w[5]=t("h3",{class:"text-xl font-semibold text-gray-800 mb-5"},"Project Clients",-1)),i(De,{label:"Select Clients",items:e.clients,selectedItems:a.client_ids,"onUpdate:selectedItems":w[0]||(w[0]=V=>a.client_ids=V),roleOptions:e.clientRoleOptions,roleType:"client",error:e.errors.client_ids?e.errors.client_ids[0]:"",placeholder:"Search and select clients to add",disabled:!e.canManageProjectClients||e.isSaving||p.value,readonly:!e.canManageProjectClients&&e.canViewProjectClients,showRemoveButton:e.canManageProjectClients,class:"mb-4"},null,8,["items","selectedItems","roleOptions","error","disabled","readonly","showRemoveButton"]),e.canManageProjectClients?(l(),d("div",Ot,[i(ae,{onClick:s,disabled:p.value||e.isSaving,class:"px-6 py-3 rounded-lg text-lg shadow-md hover:shadow-lg transition-all duration-200"},{default:Q(()=>[p.value?(l(),d("span",Rt,"Saving Clients...")):(l(),d("span",Tt,"Save Clients"))]),_:1},8,["disabled"])])):x("",!0),v.value?(l(),d("div",Ft,w[3]||(w[3]=[t("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),F(" Clients saved successfully! ",-1)]))):x("",!0),k.value?(l(),d("div",Et,[w[4]||(w[4]=t("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),F(" "+$(k.value),1)])):x("",!0)])):x("",!0),t("div",zt,[w[6]||(w[6]=t("h3",{class:"text-xl font-semibold text-gray-800 mb-5"},"Contract Information",-1)),i(D,{for:"contract_details",value:"Contract Details",class:"mb-1"}),ge(t("textarea",{id:"contract_details",class:"block w-full px-4 py-2 border-gray-300 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-indigo-500 transition-colors duration-200 resize-y min-h-[120px]","onUpdate:modelValue":w[1]||(w[1]=V=>a.contract_details=V),disabled:!e.canManageProjectClients||e.isSaving,placeholder:"Enter contract terms, agreements, or important notes about the client relationship."},null,8,Lt),[[je,a.contract_details]]),i(O,{message:e.errors.contract_details?e.errors.contract_details[0]:"",class:"mt-2"},null,8,["message"])]),e.canViewProjectUsers?(l(),d("div",qt,[w[9]||(w[9]=t("h3",{class:"text-xl font-semibold text-gray-800 mb-5"},"Assign Project Users",-1)),i(De,{label:"Assign Users",items:e.users,selectedItems:a.user_ids,"onUpdate:selectedItems":w[2]||(w[2]=V=>a.user_ids=V),roleOptions:e.userRoleOptions,roleType:"project",defaultRoleId:2,error:e.errors.user_ids?e.errors.user_ids[0]:"",placeholder:"Search and assign users to this project",disabled:!e.canManageProjectUsers||e.isSaving||N.value,readonly:!e.canManageProjectUsers&&e.canViewProjectUsers,showRemoveButton:e.canManageProjectUsers,class:"mb-4"},null,8,["items","selectedItems","roleOptions","error","disabled","readonly","showRemoveButton"]),e.canManageProjectUsers?(l(),d("div",Ht,[i(ae,{onClick:n,disabled:N.value||e.isSaving,class:"px-6 py-3 rounded-lg text-lg shadow-md hover:shadow-lg transition-all duration-200"},{default:Q(()=>[N.value?(l(),d("span",Kt,"Saving Users...")):(l(),d("span",Gt,"Save Users"))]),_:1},8,["disabled"])])):x("",!0),C.value?(l(),d("div",Yt,w[7]||(w[7]=[t("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),F(" Users saved successfully! ",-1)]))):x("",!0),b.value?(l(),d("div",Wt,[w[8]||(w[8]=t("svg",{class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),F(" "+$(b.value),1)])):x("",!0)])):x("",!0)]))}},Xt={class:"space-y-6"},Qt={key:0,class:"bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200"},Zt={class:"mt-6"},ea={key:0},ta={key:1},aa={key:0,class:"text-sm text-red-500 mt-3"},sa={key:1,class:"mt-8 bg-white p-6 rounded-lg shadow-md border border-gray-200"},oa={class:"space-y-3"},na={class:"flex items-center"},la={class:"mr-3 text-indigo-500"},ra={key:0,class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ia={key:1,class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},da={key:2,class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ca={key:3,class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ua=["href"],ma={key:1,class:"text-gray-700 font-medium break-all mr-4"},va=["onClick","disabled"],ga={key:2,class:"p-6 bg-gray-50 rounded-lg text-gray-600 text-center border border-gray-200 shadow-sm"},pa={__name:"ProjectFormDocuments",props:{projectId:{type:[Number,String],required:!0},errors:{type:Object,default:()=>({})},canUploadProjectDocuments:{type:Boolean,default:!1},canViewProjectDocuments:{type:Boolean,default:!1},isSaving:{type:Boolean,default:!1}},setup(e){const g=e,a=ve({documents:[]}),p=P(null),v=P(!1),k=async()=>{if(g.projectId)try{const u=await we(g.projectId,"documents",{canViewProjectDocuments:g.canViewProjectDocuments});u&&(a.documents=u||[])}catch(u){console.error("Error fetching documents data:",u),R("Failed to load documents data.")}};te(()=>g.projectId,async u=>{u&&await k()},{immediate:!0});const N=u=>{const s=Array.from(u.target.files);if(s.length>0){const n=Array.isArray(a.documents)?a.documents.filter(j=>typeof j=="object"&&"path"in j):[];a.documents=[...n,...s]}},C=async()=>{if(!g.projectId){R("Project ID is missing. Cannot upload documents.");return}const u=a.documents.filter(s=>s&&typeof s=="object"&&"name"in s&&"size"in s&&"type"in s);if(!u||u.length===0){R("Please select documents to upload.");return}v.value=!0;try{const s=new FormData;u.forEach((j,w)=>{s.append(`documents[${w}]`,j)});const n=await window.axios.post(`/api/projects/${g.projectId}/documents`,s,{headers:{"Content-Type":"multipart/form-data"}});a.documents=n.data.documents||[],re("Documents uploaded successfully!"),await k()}catch(s){R("Failed to upload documents."),console.error("Error uploading documents:",s)}finally{v.value=!1,p.value&&(p.value.value="")}},b=u=>{a.documents=a.documents.filter((s,n)=>n!==u)};return me(()=>{}),(u,s)=>(l(),d("div",Xt,[e.canUploadProjectDocuments?(l(),d("div",Qt,[i(D,{for:"documents-upload",value:"Upload New Documents",class:"mb-2 text-lg"}),t("input",{type:"file",id:"documents-upload",ref_key:"documentFileInput",ref:p,onChange:N,class:"mt-2 block w-full text-sm text-gray-600 file:mr-4 file:py-2.5 file:px-5 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 transition-colors duration-200 cursor-pointer",multiple:"",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif"},null,544),s[0]||(s[0]=t("p",{class:"text-sm text-gray-500 mt-2"},"Supported formats: PDF, DOC, DOCX, JPG, JPEG, PNG, GIF. Max file size: 5MB.",-1)),i(O,{message:e.errors.documents?e.errors.documents[0]:"",class:"mt-2"},null,8,["message"]),t("div",Zt,[i(ae,{type:"button",onClick:C,disabled:!e.projectId||!a.documents||!a.documents.some(n=>n&&typeof n=="object"&&"name"in n&&"size"in n&&"type"in n)||v.value||e.isSaving,class:"px-6 py-3 rounded-lg text-lg shadow-md hover:shadow-lg transition-all duration-200"},{default:Q(()=>[v.value?(l(),d("span",ea,"Uploading...")):(l(),d("span",ta,"Upload Selected Documents"))]),_:1},8,["disabled"]),e.projectId?x("",!0):(l(),d("p",aa," Please save the project first before uploading documents. "))])])):x("",!0),e.canViewProjectDocuments&&a.documents&&a.documents.length>0?(l(),d("div",sa,[s[7]||(s[7]=t("h3",{class:"text-xl font-semibold text-gray-800 mb-5"},"Existing Project Documents",-1)),t("ul",oa,[(l(!0),d(ce,null,ue(a.documents,(n,j)=>(l(),d("li",{key:j,class:"flex items-center justify-between p-4 bg-gray-50 rounded-md border border-gray-100 shadow-sm transition-shadow hover:shadow-md duration-200"},[t("div",na,[t("span",la,[typeof n=="object"&&"type"in n&&n.type.includes("image")?(l(),d("svg",ra,s[1]||(s[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 002.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1)]))):typeof n=="object"&&"type"in n&&n.type.includes("pdf")?(l(),d("svg",ia,s[2]||(s[2]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)]))):typeof n=="object"&&"type"in n&&(n.type.includes("word")||n.type.includes("document"))?(l(),d("svg",da,s[3]||(s[3]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)]))):(l(),d("svg",ca,s[4]||(s[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"},null,-1)])))]),typeof n=="object"&&"path"in n?(l(),d("a",{key:0,href:`/storage/${n.path}`,target:"_blank",class:"text-blue-600 hover:text-blue-800 hover:underline font-medium break-all mr-4"},$(n.filename),9,ua)):(l(),d("span",ma,[F($(n.name)+" ",1),s[5]||(s[5]=t("span",{class:"text-gray-500 text-sm"},"(Pending Upload)",-1))]))]),e.canUploadProjectDocuments?(l(),d("button",{key:0,type:"button",onClick:w=>b(j),class:"p-2 rounded-full text-red-500 hover:bg-red-100 hover:text-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors duration-200",title:"Remove document",disabled:v.value||e.isSaving},s[6]||(s[6]=[t("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,va)):x("",!0)]))),128))])])):e.canViewProjectDocuments?(l(),d("div",ga," No documents found for this project. ")):x("",!0),s[8]||(s[8]=t("div",{class:"mt-6 p-4 bg-blue-50 rounded-lg text-blue-700 text-sm border border-blue-200"},[t("p",null,"Note: Uploaded documents will be stored in the project's designated Google Drive folder.")],-1))]))}},ya={class:"p-6 bg-white rounded-lg font-inter"},fa={key:0,class:"p-6 bg-gray-50 rounded-lg text-gray-600 text-center border border-gray-200 shadow-sm"},ba={key:1},wa={class:"mb-6 flex justify-between items-center"},ha={key:0,class:"flex items-center"},xa={key:1},ja={key:0,class:"text-sm text-red-500 mb-4 bg-red-50 p-3 rounded-md border border-red-200"},ka={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},_a={class:"flex justify-between items-start mb-3"},Pa=["onClick","disabled"],$a=["onUpdate:modelValue","readonly"],Sa={class:"mt-auto pt-3 border-t border-gray-100 text-xs text-gray-500 flex justify-between items-center"},Va={class:"font-medium text-gray-700"},Ia={key:2,class:"p-8 bg-gray-50 rounded-lg text-gray-600 text-center border border-gray-200 shadow-sm flex flex-col items-center justify-center h-64"},Ca={__name:"ProjectFormNotes",props:{projectId:{type:[Number,String],required:!0},errors:{type:Object,default:()=>({})},canAddProjectNotes:{type:Boolean,default:!1},canViewProjectNotes:{type:Boolean,default:!1},isSaving:{type:Boolean,default:!1}},setup(e){const g=e,a=ve({notes:[]}),p=P(!1),v=async()=>{if(g.projectId)try{const u=await we(g.projectId,"notes",{canViewProjectNotes:g.canViewProjectNotes,canAddProjectNotes:g.canAddProjectNotes});u&&(a.notes=u.map(s=>{var n,j;return{id:s.id,content:s.content,created_at:s.created_at,creator_name:s.creator_name||((n=s.user)==null?void 0:n.name)||((j=s.creator)==null?void 0:j.name)||"Unknown"}})||[])}catch(u){console.error("Error fetching notes data:",u),R("Failed to load notes data.")}};te(()=>g.projectId,async u=>{u&&await v()},{immediate:!0});const k=()=>{g.canAddProjectNotes&&a.notes.push({id:null,content:"",created_at:new Date().toISOString(),creator_name:"You"})},N=u=>{g.canAddProjectNotes&&a.notes.splice(u,1)},C=async()=>{if(!g.projectId){R("Project ID is missing. Cannot save notes.");return}p.value=!0;const u=a.notes.map(s=>({id:s.id||null,content:s.content}));try{const s=await window.axios.put(`/api/projects/${g.projectId}/sections/notes?type=private`,{notes:u});a.notes=s.data.notes.map(n=>{var j,w;return{id:n.id,content:n.content,created_at:n.created_at,creator_name:n.creator_name||((j=n.user)==null?void 0:j.name)||((w=n.creator)==null?void 0:w.name)||"Unknown"}})||[],re("Notes updated successfully!"),await v()}catch(s){console.error("Error updating notes:",s),R("Failed to update notes.")}finally{p.value=!1}},b=u=>u?new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return me(()=>{}),(u,s)=>(l(),d("div",ya,[e.canViewProjectNotes?(l(),d("div",ba,[t("div",wa,[i(ae,{onClick:k,type:"button",class:"px-5 py-2.5 rounded-lg text-base shadow-sm hover:shadow-md transition-all duration-200",disabled:!e.canAddProjectNotes||p.value||e.isSaving},{default:Q(()=>s[0]||(s[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),F(" Add New Note ",-1)])),_:1,__:[0]},8,["disabled"]),i(ae,{onClick:C,disabled:!e.projectId||!e.canAddProjectNotes||p.value||e.isSaving,class:H([{"opacity-50 cursor-not-allowed":p.value||e.isSaving},"px-6 py-3 rounded-lg text-lg shadow-md hover:shadow-lg transition-all duration-200"])},{default:Q(()=>[p.value||e.isSaving?(l(),d("span",ha,s[1]||(s[1]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),F(" Saving... ",-1)]))):(l(),d("span",xa,"Save All Notes"))]),_:1},8,["disabled","class"])]),e.projectId?x("",!0):(l(),d("p",ja," Please save the project first before adding or editing notes. ")),a.notes&&a.notes.length>0?(l(),d("div",ka,[(l(!0),d(ce,null,ue(a.notes,(n,j)=>(l(),d("div",{key:n.id||`new-note-${j}`,class:H(["relative bg-white p-5 rounded-lg shadow-md border border-gray-200 flex flex-col h-64 transition-all duration-200 ease-in-out hover:shadow-lg",{"opacity-75 cursor-not-allowed":!e.canAddProjectNotes||p.value||e.isSaving}])},[t("div",_a,[i(D,{value:`Note ${j+1}`,class:"text-sm font-semibold text-gray-700"},null,8,["value"]),e.canAddProjectNotes?(l(),d("button",{key:0,type:"button",onClick:w=>N(j),class:"p-1 rounded-full text-red-500 hover:bg-red-100 hover:text-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors duration-200",title:"Remove note",disabled:p.value||e.isSaving},s[2]||(s[2]=[t("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Pa)):x("",!0)]),ge(t("textarea",{"onUpdate:modelValue":w=>n.content=w,readonly:!e.canAddProjectNotes||p.value||e.isSaving,placeholder:"Type your note content here...",class:"flex-grow border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-lg shadow-sm block w-full resize-none transition-colors duration-200 p-3 text-sm overflow-auto",rows:"6"},null,8,$a),[[je,n.content]]),i(O,{message:e.errors[`notes.${j}.content`]?e.errors[`notes.${j}.content`][0]:"",class:"mt-2"},null,8,["message"]),t("div",Sa,[t("span",null,[s[3]||(s[3]=F("By: ",-1)),t("span",Va,$(n.creator_name||"Unknown"),1)]),t("span",null,"Last updated: "+$(b(n.created_at)),1)])],2))),128))])):(l(),d("div",Ia,s[4]||(s[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("p",{class:"text-lg font-medium"},"No notes found for this project.",-1),t("p",{class:"text-sm mt-2"},'Click "Add New Note" to start creating your project notes.',-1)])))])):(l(),d("div",fa," You do not have permission to view project notes. "))]))}},Ua={class:"p-6 bg-white rounded-lg font-inter"},Da={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},Aa={class:"block sm:inline ml-2"},Ma={key:1,class:"flex items-center justify-center py-8"},Na={key:2},Ba={key:0,class:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-lg shadow-md mb-6"},Oa={class:"flex items-center justify-between"},Ra={class:"text-3xl font-bold mt-1"},Ta={class:"text-sm opacity-90 mt-2"},Fa={class:"font-semibold"},Ea={class:"font-semibold"},za={key:1,class:"bg-gray-100 text-gray-600 p-4 rounded-lg shadow-sm mb-6 text-center"},La={class:"bg-gray-50 p-6 rounded-lg shadow-sm mb-6 border border-gray-200"},qa={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ha=["disabled"],Ka=["value"],Ga={class:"bg-gray-50 p-6 rounded-lg shadow-sm mb-6 border border-gray-200"},Ya={class:"mb-4"},Wa={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-1 gap-4"},Ja={class:"flex items-center justify-between"},Xa=["for"],Qa={class:"ms-2 text-base font-medium text-gray-800"},Za=["onClick"],es={key:0,class:"mt-4 pt-4 border-t border-gray-200"},ts={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4"},as={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4"},ss=["id","onUpdate:modelValue","disabled"],os={key:0,class:"mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200"},ns={class:"flex justify-between items-center mb-3"},ls={class:"space-y-4"},rs={class:"flex justify-between items-center mb-2"},is=["onClick"],ds={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},cs=["onClick"],us={key:0},ms={class:"mt-6 pt-4 border-t border-gray-200"},vs={key:1,class:"mt-4 flex items-center"},gs={key:2,class:"mt-6 flex justify-end"},ps={__name:"ServicesAndPaymentForm",props:{projectId:{type:[Number,String],required:!0},paymentTypeOptions:{type:Array,required:!0},canManageProjectServicesAndPayments:{type:Boolean,required:!0},canViewProjectServicesAndPayments:{type:Boolean,required:!0}},emits:["updated"],setup(e,{emit:g}){const a=e,p=g,v=P({}),k=P(!1),N=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],b=P([...[{value:"Website Designing",label:"Website Designing"},{value:"SEO",label:"SEO"},{value:"Social Media",label:"Social Media"},{value:"Content Writing",label:"Content Writing"},{value:"Graphic Design",label:"Graphic Design"}]]),u=P(""),s=P(!1),n=ve({services:[],service_details:[],payment_type:"one_off",currency:"AUD"}),j=ve({}),w=E(()=>{let f=0;return n.services.forEach(r=>{const o=m(r);o&&o.amount&&(f+=parseFloat(o.amount))}),f.toFixed(2)}),V=E(()=>{let f=null,r=null;const o=new Date;return o.setHours(0,0,0,0),n.service_details.forEach(y=>{y.frequency==="one_off"&&y.payment_breakdown&&y.payment_breakdown.forEach(A=>{var X;if(A.due_date){const J=new Date(A.due_date);J.setHours(0,0,0,0),J>=o&&(!f||J<f.date)&&(f={date:J,serviceId:y.service_id,paymentLabel:A.label},r=((X=b.value.find(de=>de.value===y.service_id))==null?void 0:X.label)||y.service_id)}})}),f?{date:f.date.toLocaleDateString(),serviceLabel:r,paymentLabel:f.paymentLabel}:null}),K=E(()=>{const f=n.services.filter(r=>{const o=m(r);return o&&o.frequency!=="monthly"});return f.length===0?!0:f.every(r=>U(r)===100)}),G=E(()=>!a.projectId||!a.canManageProjectServicesAndPayments||!K.value),Y=()=>{const f=u.value.trim();f&&!b.value.some(r=>r.label.toLowerCase()===f.toLowerCase())&&(b.value.push({value:f,label:f}),u.value="",s.value=!1)},I=async()=>{if(a.projectId){k.value=!0;try{const r=(await window.axios.get(`/api/projects/${a.projectId}/sections/services-payment`)).data;return n.services=r.services||[],n.service_details=r.service_details||[],n.payment_type=r.payment_type||"one_off",n.currency=r.currency||"AUD",n.services.forEach(o=>{b.value.some(y=>y.value===o)||b.value.push({value:o,label:o}),j[o]=!1}),n.service_details.forEach(o=>{if(o.payment_breakdown&&!Array.isArray(o.payment_breakdown)){const y=o.payment_breakdown;o.payment_breakdown=[{label:"First",percentage:parseInt(y.first)||30,due_date:null},{label:"Second",percentage:parseInt(y.second)||30,due_date:null},{label:"Third",percentage:parseInt(y.third)||40,due_date:null}]}else!o.payment_breakdown||o.payment_breakdown.length===0?o.payment_breakdown=[{label:"Payment 1",percentage:100,due_date:null}]:o.payment_breakdown.forEach(y=>{y.due_date===void 0&&(y.due_date=null)})}),r}catch(f){return console.error("Error fetching services and payment data:",f),v.value.general="Failed to fetch services and payment data.",null}finally{k.value=!1}}},M=async()=>{v.value={},k.value=!0;try{const f={services:n.services,service_details:n.service_details,total_amount:parseFloat(w.value),payment_type:n.payment_type,currency:n.currency},r=await window.axios.put(`/api/projects/${a.projectId}/sections/services-payment`,f);re("Services and payment information updated successfully!"),p("updated")}catch(f){f.response&&f.response.status===422?v.value=f.response.data.errors:f.response&&f.response.data.message?v.value.general=f.response.data.message:(v.value.general="Failed to update services and payment information.",console.error("Error:",f))}finally{k.value=!1}},ne=(f,r)=>{r?(n.service_details.some(o=>o.service_id===f)||n.service_details.push({service_id:f,amount:"",frequency:"one_off",start_date:"",payment_breakdown:[{label:"Payment 1",percentage:100,due_date:null}],currency:n.currency}),j[f]=!0):(n.service_details=n.service_details.filter(o=>o.service_id!==f),j[f]=!1)},m=f=>{let r=n.service_details.find(o=>o.service_id===f);if(!r)r={service_id:f,amount:"",frequency:"one_off",start_date:"",payment_breakdown:[{label:"Payment 1",percentage:100,due_date:null}],currency:n.currency},n.service_details.push(r);else if(r.payment_breakdown&&!Array.isArray(r.payment_breakdown)){const o=r.payment_breakdown;r.payment_breakdown=[{label:"First",percentage:parseInt(o.first)||30,due_date:null},{label:"Second",percentage:parseInt(o.second)||30,due_date:null},{label:"Third",percentage:parseInt(o.third)||40,due_date:null}]}else!r.payment_breakdown||r.payment_breakdown.length===0?r.payment_breakdown=[{label:"Payment 1",percentage:100,due_date:null}]:r.payment_breakdown.forEach(o=>{o.due_date===void 0&&(o.due_date=null)});return r},U=f=>{const r=m(f);return!r.payment_breakdown||!Array.isArray(r.payment_breakdown)?0:r.payment_breakdown.reduce((o,y)=>o+(parseInt(y.percentage)||0),0)},B=f=>{const r=m(f);if(r.payment_breakdown||(r.payment_breakdown=[]),!Array.isArray(r.payment_breakdown)){const A=r.payment_breakdown;r.payment_breakdown=[{label:"First",percentage:parseInt(A.first)||30,due_date:null},{label:"Second",percentage:parseInt(A.second)||30,due_date:null},{label:"Third",percentage:parseInt(A.third)||40,due_date:null}]}const o=r.payment_breakdown.length;let y=0;if(o>0){const A=r.payment_breakdown[o-1];y=Math.floor(A.percentage/2),A.percentage-=y}else y=100;r.payment_breakdown.push({label:`Payment ${o+1}`,percentage:y,due_date:null})},q=(f,r)=>{const o=m(f);if(!o.payment_breakdown||!Array.isArray(o.payment_breakdown)||o.payment_breakdown.length<=1)return;const y=parseInt(o.payment_breakdown[r].percentage)||0;if(o.payment_breakdown.splice(r,1),y>0&&o.payment_breakdown.length>0){const A=r>0&&r<=o.payment_breakdown.length?r-1:0;o.payment_breakdown[A].percentage=(parseInt(o.payment_breakdown[A].percentage)||0)+y}o.payment_breakdown.forEach((A,X)=>{A.label=`Payment ${X+1}`})},W=f=>{j[f]=!j[f]};return te(()=>a.projectId,f=>{f&&I()},{immediate:!0}),(f,r)=>(l(),d("div",Ua,[v.value.general?(l(),d("div",Da,[r[6]||(r[6]=t("strong",{class:"font-bold"},"Error!",-1)),t("span",Aa,$(v.value.general),1)])):x("",!0),k.value?(l(),d("div",Ma,r[7]||(r[7]=[t("svg",{class:"animate-spin -ml-1 mr-3 h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),t("span",{class:"text-gray-600"},"Loading services and payment data...",-1)]))):(l(),d("div",Na,[V.value?(l(),d("div",Ba,[t("div",Oa,[t("div",null,[r[10]||(r[10]=t("p",{class:"text-sm opacity-90"},"Next Payment Due",-1)),t("p",Ra,$(V.value.date),1),t("p",Ta,[r[8]||(r[8]=F(" For: ",-1)),t("span",Fa,$(V.value.serviceLabel),1),r[9]||(r[9]=F(" - ",-1)),t("span",Ea,$(V.value.paymentLabel),1)])]),r[11]||(r[11]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 opacity-70",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1))])])):(l(),d("div",za," No upcoming payment due dates found for one-off services. ")),t("div",La,[r[13]||(r[13]=t("h4",{class:"text-xl font-semibold text-gray-700 mb-4"},"Overall Project Payment Details",-1)),t("div",qa,[t("div",null,[i(D,{for:"calculated_total_amount",value:"Calculated Total Amount"}),i(L,{id:"calculated_total_amount",type:"text",class:"mt-1 block w-full bg-gray-100 cursor-not-allowed",value:w.value,disabled:""},null,8,["value"]),r[12]||(r[12]=t("p",{class:"text-sm text-gray-500 mt-1"},"This amount is automatically calculated from selected services.",-1))]),t("div",null,[i(D,{for:"payment_type",value:"Payment Type"}),ge(t("select",{id:"payment_type",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full p-2.5","onUpdate:modelValue":r[0]||(r[0]=o=>n.payment_type=o),required:"",disabled:!e.canManageProjectServicesAndPayments},[(l(!0),d(ce,null,ue(e.paymentTypeOptions,o=>(l(),d("option",{key:o.value,value:o.value},$(o.label),9,Ka))),128))],8,Ha),[[Ve,n.payment_type]]),i(O,{message:v.value.payment_type?v.value.payment_type[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[i(D,{for:"overall_currency",value:"Overall Project Currency"}),i(oe,{id:"overall_currency",modelValue:n.currency,"onUpdate:modelValue":r[1]||(r[1]=o=>n.currency=o),options:N,"value-key":"value","label-key":"label",class:"w-full mt-1",disabled:!e.canManageProjectServicesAndPayments},null,8,["modelValue","disabled"]),i(O,{message:v.value.currency?v.value.currency[0]:"",class:"mt-2"},null,8,["message"])])])]),t("div",Ga,[r[20]||(r[20]=t("h4",{class:"text-xl font-semibold text-gray-700 mb-4"},"Manage Services",-1)),t("div",Ya,[i(D,{for:"services",value:"Select Services",class:"mb-2"}),t("div",Wa,[(l(!0),d(ce,null,ue(b.value,o=>(l(),d("div",{key:o.value,class:"bg-white p-4 rounded-lg shadow-sm border border-gray-200"},[t("div",Ja,[t("label",{for:`service_${o.value}`,class:"flex items-center cursor-pointer"},[i(st,{id:`service_${o.value}`,value:o.value,checked:n.services,"onUpdate:checked":[r[2]||(r[2]=y=>n.services=y),y=>ne(o.value,y)],disabled:!e.canManageProjectServicesAndPayments},null,8,["id","value","checked","onUpdate:checked","disabled"]),t("span",Qa,$(o.label),1)],8,Xa),(n.services||[]).includes(o.value)?(l(),d("button",{key:0,onClick:y=>W(o.value),type:"button",class:H(["text-gray-500 hover:text-gray-700 transition-transform duration-200",{"rotate-180":j[o.value]}])},r[14]||(r[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)]),10,Za)):x("",!0)]),(n.services||[]).includes(o.value)&&j[o.value]?(l(),d("div",es,[t("div",ts,[t("div",null,[i(D,{for:`service_amount_${o.value}`,value:"Amount"},null,8,["for"]),i(L,{id:`service_amount_${o.value}`,type:"number",step:"0.01",placeholder:"Service Amount",class:"w-full mt-1",modelValue:m(o.value).amount,"onUpdate:modelValue":y=>m(o.value).amount=y,disabled:!e.canManageProjectServicesAndPayments},null,8,["id","modelValue","onUpdate:modelValue","disabled"])]),t("div",null,[i(D,{for:`service_currency_${o.value}`,value:"Currency"},null,8,["for"]),i(oe,{id:`service_currency_${o.value}`,modelValue:m(o.value).currency,"onUpdate:modelValue":y=>m(o.value).currency=y,options:N,"value-key":"value","label-key":"label",class:"w-full mt-1",disabled:!e.canManageProjectServicesAndPayments},null,8,["id","modelValue","onUpdate:modelValue","disabled"])])]),t("div",as,[t("div",null,[i(D,{for:`service_frequency_${o.value}`,value:"Frequency"},null,8,["for"]),ge(t("select",{id:`service_frequency_${o.value}`,class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full p-2.5","onUpdate:modelValue":y=>m(o.value).frequency=y,disabled:!e.canManageProjectServicesAndPayments},r[15]||(r[15]=[t("option",{value:"monthly"},"Monthly",-1),t("option",{value:"one_off"},"One off",-1)]),8,ss),[[Ve,m(o.value).frequency]])]),t("div",null,[i(D,{for:`service_start_date_${o.value}`,value:"Start Date"},null,8,["for"]),i(L,{id:`service_start_date_${o.value}`,type:"date",class:"w-full mt-1",modelValue:m(o.value).start_date,"onUpdate:modelValue":y=>m(o.value).start_date=y,disabled:!e.canManageProjectServicesAndPayments},null,8,["id","modelValue","onUpdate:modelValue","disabled"])])]),m(o.value).frequency!=="monthly"?(l(),d("div",os,[t("div",ns,[i(D,{value:"Payment Breakdown (%)",class:"text-base font-medium text-blue-800"}),e.canManageProjectServicesAndPayments?(l(),se(ae,{key:0,type:"button",onClick:y=>B(o.value),class:"px-4 py-2 text-sm"},{default:Q(()=>r[16]||(r[16]=[F(" + Add Payment Step ",-1)])),_:2,__:[16]},1032,["onClick"])):x("",!0)]),t("div",ls,[(l(!0),d(ce,null,ue(m(o.value).payment_breakdown,(y,A)=>(l(),d("div",{key:A,class:"bg-white p-4 rounded-md shadow-sm border border-blue-100"},[t("div",rs,[i(D,{for:`payment_label_${A}_${o.value}`,value:y.label,class:"font-semibold"},null,8,["for","value"]),e.canManageProjectServicesAndPayments&&m(o.value).payment_breakdown.length>1?(l(),d("button",{key:0,type:"button",class:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",onClick:X=>q(o.value,A),title:"Remove payment step"},r[17]||(r[17]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 011-1h4a1 1 0 110 2H8a1 1 0 01-1-1zm-1 3a1 1 0 100 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})],-1)]),8,is)):x("",!0)]),t("div",ds,[t("div",null,[i(D,{for:`payment_percentage_${A}_${o.value}`,value:"Percentage (%)",class:"text-sm"},null,8,["for"]),i(L,{id:`payment_percentage_${A}_${o.value}`,type:"number",min:"0",max:"100",class:"w-full mt-1",modelValue:y.percentage,"onUpdate:modelValue":X=>y.percentage=X,modelModifiers:{number:!0},onInput:X=>{y.percentage=Math.max(0,Math.min(100,parseInt(X.target.value)||0))},disabled:!e.canManageProjectServicesAndPayments},null,8,["id","modelValue","onUpdate:modelValue","onInput","disabled"])]),t("div",null,[i(D,{for:`payment_due_date_${A}_${o.value}`,value:"Due Date (Optional)",class:"text-sm"},null,8,["for"]),i(L,{id:`payment_due_date_${A}_${o.value}`,type:"date",class:"w-full mt-1",modelValue:y.due_date,"onUpdate:modelValue":X=>y.due_date=X,disabled:!e.canManageProjectServicesAndPayments},null,8,["id","modelValue","onUpdate:modelValue","disabled"]),e.canManageProjectServicesAndPayments&&y.due_date?(l(),d("button",{key:0,type:"button",class:"text-xs text-red-500 hover:text-red-700 mt-1",onClick:X=>y.due_date=null}," Clear Date ",8,cs)):x("",!0)])])]))),128))]),t("div",{class:H(["text-sm mt-4 p-2 rounded-md",{"bg-green-100 text-green-700":U(o.value)===100,"bg-red-100 text-red-700 font-bold":U(o.value)!==100}])},[F(" Total Percentage: "+$(U(o.value))+"% ",1),U(o.value)!==100?(l(),d("span",us," (Total must be 100%) ")):x("",!0)],2)])):x("",!0)])):x("",!0)]))),128))])]),t("div",ms,[e.canManageProjectServicesAndPayments&&!s.value?(l(),d("button",{key:0,type:"button",class:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 active:bg-blue-900 focus:outline-none focus:border-blue-900 focus:ring ring-blue-300 disabled:opacity-25 transition ease-in-out duration-150 shadow-md",onClick:r[3]||(r[3]=o=>s.value=!0)},r[18]||(r[18]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),F(" Add New Service/Department ",-1)]))):x("",!0),e.canManageProjectServicesAndPayments&&s.value?(l(),d("div",vs,[i(L,{type:"text",class:"flex-grow mr-2 border-gray-300 rounded-md shadow-sm p-2.5",modelValue:u.value,"onUpdate:modelValue":r[4]||(r[4]=o=>u.value=o),placeholder:"Enter new service/department name",onKeyup:Ke(Y,["enter"])},null,8,["modelValue"]),i(ae,{onClick:Y},{default:Q(()=>r[19]||(r[19]=[F("Add",-1)])),_:1,__:[19]}),t("button",{type:"button",class:"ml-2 text-sm text-gray-500 hover:text-gray-700 px-3 py-2 rounded-md transition-colors",onClick:r[5]||(r[5]=o=>{s.value=!1,u.value=""})}," Cancel ")])):x("",!0)]),i(O,{message:v.value.services?v.value.services[0]:"",class:"mt-2"},null,8,["message"])]),e.canManageProjectServicesAndPayments?(l(),d("div",gs,[i(ae,{onClick:M,disabled:G.value,class:H([{"opacity-50 cursor-not-allowed":G.value},"px-6 py-3 text-base"])},{default:Q(()=>r[21]||(r[21]=[F(" Update Services & Payment ",-1)])),_:1,__:[21]},8,["disabled","class"])])):x("",!0)]))]))}},z=P({}),ys=localStorage.getItem("displayCurrency"),Be=P(ys||"USD");te(Be,e=>{localStorage.setItem("displayCurrency",e)});const Ae=async()=>{try{const e=await window.axios.get("/api/currency-rates");z.value=e.data,console.log("Fetched currency rates:",z.value)}catch(e){console.error("Failed to fetch currency rates:",e),z.value={PKR:.0034,AUD:.65,INR:.012,EUR:1.08,GBP:1.28,USD:1}}},ee=(e,g="USD")=>{if(isNaN(e)||e==null)return"0.00";try{return new Intl.NumberFormat("en-US",{style:"currency",currency:g,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}catch(a){return console.warn(`Error formatting currency for ${e} ${g}:`,a),`${g} ${parseFloat(e).toFixed(2)}`}},ye=(e,g,a)=>{if(isNaN(e)||e==null||!g||!a)return 0;if(g.toUpperCase()===a.toUpperCase())return Number(e);const p=z.value,v=p[g.toUpperCase()],k=p[a.toUpperCase()];if(!v||!k)return console.warn(`Missing conversion rates for: ${g} or ${a}. Cannot perform conversion.`),Number(e);const C=Number(e)*v/k;return Number(C.toFixed(2))},fs={class:"p-6 bg-white rounded-lg"},bs={key:0,class:"text-red-600 text-sm mb-4"},ws={key:1,class:"mb-6 p-4 bg-gray-50 rounded-md"},hs={class:"mb-6"},xs={class:"flex justify-end items-center mb-4"},js={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ks={class:"p-3 bg-blue-100 rounded-md"},_s={class:"text-lg font-bold text-blue-800"},Ps={class:"p-3 bg-red-100 rounded-md"},$s={class:"text-lg font-bold text-red-800"},Ss={class:"text-xs text-gray-500"},Vs={class:"p-3 bg-purple-100 rounded-md"},Is={class:"text-lg font-bold text-purple-800"},Cs={class:"p-3 bg-green-100 rounded-md"},Us={class:"text-lg font-bold text-green-800"},Ds={class:"p-3 bg-yellow-100 rounded-md col-span-full md:col-span-1"},As={class:"text-lg font-bold text-yellow-800"},Ms={class:"text-xs text-gray-500"},Ns={class:"p-3 bg-orange-100 rounded-md col-span-full md:col-span-1"},Bs={class:"text-lg font-bold text-orange-900 mt-1"},Os={class:"text-xs text-gray-500"},Rs={class:"p-3 bg-gray-100 rounded-md col-span-full md:col-span-1"},Ts={class:"text-lg font-bold mt-1 text-green-400"},Fs={class:"p-3 bg-gray-100 rounded-md col-span-full md:col-span-1"},Es={class:"text-lg font-bold text-red-400 mt-1"},zs={class:"grid grid-cols-1 gap-4 md:grid-cols-2"},Ls={key:0},qs={key:1},Hs={class:"mt-4 flex justify-end"},Ks={key:2},Gs={key:0,class:"space-y-3"},Ys={key:1,class:"p-4 bg-gray-50 rounded-md text-gray-600 text-center"},Ws={key:2,class:"space-y-4"},Js={class:"flex justify-between items-start mb-2"},Xs={class:"flex-grow"},Qs={class:"font-medium text-gray-900 text-lg"},Zs={class:"text-xs text-gray-500 mt-1"},eo={class:"flex-shrink-0 text-right"},to={key:0,class:"text-sm text-gray-600"},ao={class:"flex justify-between items-end text-xs text-gray-600 mt-2 border-t border-gray-200 pt-2"},so={key:0,class:"block"},oo={key:1,class:"block"},no={key:2,class:"block mt-1 text-gray-500"},lo={class:"flex space-x-2 mt-2"},ro={key:0,class:"mt-4 p-4 bg-blue-50 rounded-md border border-blue-200"},io={class:"text-md font-medium text-gray-900 mb-4"},co={class:"mb-4"},uo={class:"mb-4"},mo={class:"flex items-center"},vo=["disabled"],go={class:"text-sm text-gray-700"},po={key:0,class:"mb-4"},yo={class:"flex justify-end space-x-2"},Me=.25,fo={__name:"ProjectTransactions",props:{projectId:{type:[Number,String],required:!0},userProjectRole:{type:Object,default:()=>({})}},setup(e){const g=e,{canDo:a,canManage:p}=Ne(()=>g.projectId),v=p("project_expenses",g.userProjectRole),k=p("project_income",g.userProjectRole),N=a("view_project_transactions",g.userProjectRole),C=P([]),b=P([]),u=P({}),s=P(""),n=P(!1),j=P(null),w=P(""),V=P(!1),K=P({}),G=P(null),Y=P(""),I=P({description:"",amount:"",currency:"PKR",user_id:null,hours_spent:"",type:"expense"}),M=Be,ne=[{value:"PKR",label:"PKR"},{value:"AUD",label:"AUD"},{value:"INR",label:"INR"},{value:"USD",label:"USD"},{value:"EUR",label:"EUR"},{value:"GBP",label:"GBP"}],m=[{value:"expense",label:"Expense"},{value:"income",label:"Income"},{value:"bonus",label:"Bonus"}],U=E(()=>b.value.map(h=>({value:h.id,label:h.name||"Unknown User"}))),B=()=>{const h=new Date,c=h.getFullYear(),T=String(h.getMonth()+1).padStart(2,"0"),Z=String(h.getDate()).padStart(2,"0");return`${c}-${T}-${Z}`},q=async()=>{if(!(!g.projectId||!N.value))try{const h=await window.axios.get(`/api/projects/${g.projectId}/sections/clients-users`);b.value=h.data.users||[]}catch(h){s.value="Failed to fetch users.",console.error("Error fetching users:",h)}},W=async()=>{if(!(!g.projectId||!N.value)){n.value=!0;try{(!z.value||Object.keys(z.value).length===0)&&await Ae();const h=await window.axios.get(`/api/projects/${g.projectId}/sections/transactions`);C.value=h.data}catch(h){s.value="Failed to fetch transactions.",console.error("Error fetching transactions:",h)}finally{n.value=!1}}},f=async()=>{var h;if(!v.value&&!k.value){R("You do not have permission to manage transactions.");return}if(!I.value.amount||isNaN(I.value.amount)){u.value.amount=["Please enter a valid amount"];return}if(I.value.type==="expense"&&!v.value){R("You do not have permission to add expenses.");return}if(I.value.type==="income"&&!k.value){R("You do not have permission to add income.");return}if(I.value.type==="bonus"&&!v.value){R("You do not have permission to add bonuses.");return}u.value={},s.value="",n.value=!0;try{const c={...I.value,amount:Number(I.value.amount)},T=await window.axios.post(`/api/projects/${g.projectId}/transactions`,c);await W(),r(),re("Transaction saved successfully!")}catch(c){((h=c.response)==null?void 0:h.status)===422?u.value=c.response.data.errors:(s.value="Failed to save transaction.",console.error("Error saving transaction:",c))}finally{n.value=!1}},r=()=>{I.value={description:"",amount:"",currency:"PKR",user_id:null,hours_spent:"",type:"expense"}},o=async h=>{if(!v.value&&!k.value){R("You do not have permission to delete transactions.");return}if(window.confirm("Are you sure you want to delete this transaction?"))try{const c=C.value[h].id;await window.axios.delete(`/api/projects/${g.projectId}/transactions/${c}`),await W(),re("Transaction deleted successfully!")}catch(c){s.value="Failed to delete transaction.",console.error("Error deleting transaction:",c)}},y=h=>{if(!v.value&&!k.value){R("You do not have permission to manage transactions.");return}const c=C.value[h];j.value===c.id?(j.value=null,G.value=null,Y.value=""):(G.value=h,j.value=c.id,w.value=c.amount,V.value=!1,K.value={},Y.value=B(),(Number(c.amount)===0||Math.abs(Number(w.value)-Number(c.amount))<.01)&&(V.value=!0))};te(w,h=>{if(G.value!==null){const c=C.value[G.value];V.value=Math.abs(Number(h)-Number(c.amount))<.01}});const A=()=>{j.value=null,G.value=null,w.value="",V.value=!1,K.value={},Y.value=""},X=async()=>{var Z;if(!v.value&&!k.value){R("You do not have permission to manage transactions.");return}const h=G.value,c=C.value[h],T=Number(w.value);if(!V.value&&(!w.value||isNaN(T)||T<=0||T>Number(c.amount))){K.value.amount=["Please enter a valid amount between 0 and "+ee(Number(c.amount),c.currency)];return}if(!Y.value){K.value.date=["Please select a payment date."];return}K.value={},n.value=!0;try{const ie=c.id,pe=V.value||Math.abs(T-Number(c.amount))<.01,be={payment_amount:pe?Number(c.amount):T,pay_in_full:pe,transaction_currency:c.currency,transaction_type:c.type,original_description:c.description,payment_date:Y.value};await window.axios.patch(`/api/projects/${g.projectId}/transactions/${ie}/process-payment`,be),await W(),re("Payment processed successfully!"),A()}catch(ie){((Z=ie.response)==null?void 0:Z.status)===422?K.value=ie.response.data.errors:(s.value="Failed to process payment.",console.error("Error processing payment:",ie))}finally{n.value=!1}},J=E(()=>!z.value||Object.keys(z.value).length===0?0:C.value.filter(h=>h.type==="income").reduce((h,c)=>h+ye(parseFloat(c.amount||0),c.currency,M.value),0)),de=E(()=>!z.value||Object.keys(z.value).length===0?0:C.value.filter(h=>h.type==="expense").reduce((h,c)=>h+ye(parseFloat(c.amount||0),c.currency,M.value),0)),fe=E(()=>!z.value||Object.keys(z.value).length===0?0:C.value.filter(h=>h.type==="bonus").reduce((h,c)=>h+ye(parseFloat(c.amount||0),c.currency,M.value),0)),Oe=E(()=>ee(J.value,M.value)),Re=E(()=>ee(de.value,M.value)),Te=E(()=>ee(fe.value,M.value)),Fe=E(()=>{if(!z.value||Object.keys(z.value).length===0)return ee(0,M.value);const h=de.value+fe.value;return ee(J.value-h,M.value)}),Ee=E(()=>J.value===0?"0.00%":`${(de.value/J.value*100).toFixed(2)}%`),ze=E(()=>J.value===0?"0.00%":`${((de.value+fe.value)/J.value*100).toFixed(2)}%`),Le=E(()=>{if(J.value<=0)return ee(0,M.value);const h=J.value*Me;return ee(h,M.value)}),qe=E(()=>{const h=C.value.filter(T=>(T.type==="expense"||T.type==="bonus")&&T.is_paid&&T.payment_date);if(h.length===0)return"N/A";const c=h.reduce((T,Z)=>new Date(Z.payment_date)>new Date(T.payment_date)?Z:T);return new Date(c.payment_date).toLocaleDateString()}),He=E(()=>{const h=C.value.filter(T=>T.type==="income"&&T.payment_date);if(h.length===0)return"N/A";const c=h.reduce((T,Z)=>new Date(Z.payment_date)>new Date(T.payment_date)?Z:T);return new Date(c.payment_date).toLocaleDateString()});return me(async()=>{const h=localStorage.getItem("displayCurrency");h&&(M.value=h),await Ae(),W(),q()}),te([()=>g.projectId,M,z],()=>{g.projectId&&z.value&&Object.keys(z.value).length>0&&(W(),q())},{deep:!0}),te(M,h=>{h&&localStorage.setItem("displayCurrency",h)},{deep:!0}),(h,c)=>{var T,Z,ie,pe,be,ke;return l(),d("div",fs,[s.value?(l(),d("div",bs,$(s.value),1)):x("",!0),S(v)||S(k)?(l(),d("div",ws,[t("div",hs,[t("div",xs,[c[10]||(c[10]=t("span",{class:"text-sm font-medium text-gray-700 mr-2"},"Currency:",-1)),i(oe,{id:"transactions-display-currency-switcher",modelValue:S(M),"onUpdate:modelValue":c[0]||(c[0]=_=>Ge(M)?M.value=_:null),options:ne,"value-key":"value","label-key":"label",class:"w-24"},null,8,["modelValue"])]),c[19]||(c[19]=t("h4",{class:"text-md font-medium text-gray-700 mb-2"},"Summary",-1)),t("div",js,[t("div",ks,[c[11]||(c[11]=t("p",{class:"text-sm text-gray-600"},"Total Income",-1)),t("p",_s,$(Oe.value),1)]),t("div",Ps,[c[12]||(c[12]=t("p",{class:"text-sm text-gray-600"},"Total Expenses",-1)),t("p",$s,$(Re.value),1),t("p",Ss,"("+$(Ee.value)+" of Income)",1)]),t("div",Vs,[c[13]||(c[13]=t("p",{class:"text-sm text-gray-600"},"Total Bonuses",-1)),t("p",Is,$(Te.value),1)]),t("div",Cs,[c[14]||(c[14]=t("p",{class:"text-sm text-gray-600"},"Balance",-1)),t("p",Us,$(Fe.value),1)]),t("div",Ds,[c[15]||(c[15]=t("p",{class:"text-sm text-gray-600"},"Expense + Bonus",-1)),t("p",As,$(S(ee)(de.value+fe.value,S(M))),1),t("p",Ms,"("+$(ze.value)+" of Income)",1)]),t("div",Ns,[c[16]||(c[16]=t("p",{class:"text-sm font-medium text-orange-800"},"Estimated Income Tax (AUD)",-1)),t("p",Bs,$(Le.value),1),t("p",Os," (Based on "+$((Me*100).toFixed(1))+"% of Total Income. This is an estimation.) ",1)]),t("div",Rs,[c[17]||(c[17]=t("p",{class:"text-sm font-medium text-gray-800"},"Last Payment Received Date",-1)),t("p",Ts,$(He.value),1)]),t("div",Fs,[c[18]||(c[18]=t("p",{class:"text-sm font-medium text-gray-800"},"Last Payment Sent Date",-1)),t("p",Es,$(qe.value),1)])])]),c[20]||(c[20]=t("h4",{class:"text-md font-medium text-gray-700 mb-4"},"Add Transaction",-1)),t("div",zs,[t("div",null,[i(D,{for:"description",value:"Description"}),i(L,{id:"description",modelValue:I.value.description,"onUpdate:modelValue":c[1]||(c[1]=_=>I.value.description=_),class:"mt-1 block w-full",disabled:n.value},null,8,["modelValue","disabled"]),i(O,{message:(T=u.value.description)==null?void 0:T[0],class:"mt-2"},null,8,["message"])]),t("div",null,[i(D,{for:"amount",value:"Amount"}),i(L,{id:"amount",type:"number",modelValue:I.value.amount,"onUpdate:modelValue":c[2]||(c[2]=_=>I.value.amount=_),class:"mt-1 block w-full",disabled:n.value},null,8,["modelValue","disabled"]),i(O,{message:(Z=u.value.amount)==null?void 0:Z[0],class:"mt-2"},null,8,["message"])]),t("div",null,[i(D,{for:"currency",value:"Currency"}),i(oe,{id:"currency",modelValue:I.value.currency,"onUpdate:modelValue":c[3]||(c[3]=_=>I.value.currency=_),options:ne,disabled:n.value},null,8,["modelValue","disabled"]),i(O,{message:(ie=u.value.currency)==null?void 0:ie[0],class:"mt-2"},null,8,["message"])]),t("div",null,[i(D,{for:"type",value:"Type"}),i(oe,{id:"type",modelValue:I.value.type,"onUpdate:modelValue":c[4]||(c[4]=_=>I.value.type=_),options:m,disabled:n.value||!S(v)&&I.value.type==="expense"&&I.value.type!=="bonus"||!S(k)&&I.value.type==="income"},null,8,["modelValue","disabled"]),i(O,{message:(pe=u.value.type)==null?void 0:pe[0],class:"mt-2"},null,8,["message"])]),I.value.type==="expense"||I.value.type==="bonus"?(l(),d("div",Ls,[i(D,{for:"user_id",value:"User"}),i(oe,{id:"user_id",modelValue:I.value.user_id,"onUpdate:modelValue":c[5]||(c[5]=_=>I.value.user_id=_),options:U.value,disabled:n.value||!b.value.length,placeholder:"Select a user"},null,8,["modelValue","options","disabled"]),i(O,{message:(be=u.value.user_id)==null?void 0:be[0],class:"mt-2"},null,8,["message"])])):x("",!0),I.value.type==="expense"||I.value.type==="bonus"?(l(),d("div",qs,[i(D,{for:"hours_spent",value:"Hours Spent (Optional)"}),i(L,{id:"hours_spent",type:"number",modelValue:I.value.hours_spent,"onUpdate:modelValue":c[6]||(c[6]=_=>I.value.hours_spent=_),class:"mt-1 block w-full",disabled:n.value},null,8,["modelValue","disabled"]),i(O,{message:(ke=u.value.hours_spent)==null?void 0:ke[0],class:"mt-2"},null,8,["message"])])):x("",!0)]),t("div",Hs,[i(ae,{onClick:f,disabled:n.value},{default:Q(()=>[F($(n.value?"Saving...":"Save Transaction"),1)]),_:1},8,["disabled"])])])):x("",!0),S(N)?(l(),d("div",Ks,[c[24]||(c[24]=t("h4",{class:"text-md font-medium text-gray-700 mb-4"},"Transaction History",-1)),n.value?(l(),d("div",Gs,c[21]||(c[21]=[t("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-full"},null,-1),t("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-5/6"},null,-1),t("div",{class:"h-4 bg-gray-200 rounded animate-pulse w-3/4"},null,-1)]))):C.value.length===0?(l(),d("div",Ys," No transactions found for this project. ")):(l(),d("div",Ws,[(l(!0),d(ce,null,ue(C.value,(_,_e)=>{var Pe,$e,Se;return l(),d("div",{key:_.id,class:H([{"bg-green-50 border-green-200":_.type==="income","bg-red-50 border-red-200":_.type==="expense","bg-purple-50 border-purple-200":_.type==="bonus","border-l-4":!0},"p-4 rounded-md shadow-sm transition-all duration-200 ease-in-out hover:shadow-md"])},[t("div",Js,[t("div",Xs,[t("p",Qs,$(_.description),1),t("p",Zs,$(_.type==="income"?"Income":_.type==="expense"?"Expense":"Bonus")+" on "+$(new Date(_.created_at).toLocaleDateString()),1)]),t("div",eo,[t("p",{class:H(["text-lg font-bold",{"text-green-700":_.type==="income","text-red-700":_.type==="expense","text-purple-700":_.type==="bonus"}])},$(S(ee)(_.amount,_.currency)),3),_.currency.toUpperCase()!==S(M).toUpperCase()?(l(),d("p",to," ("+$(S(ee)(S(ye)(_.amount,_.currency,S(M)),S(M)))+") ",1)):x("",!0),t("span",{class:H(["block text-xs mt-1",_.is_paid?"text-green-600":"text-red-600"])},$(_.is_paid?"Paid":"Unpaid"),3)])]),t("div",ao,[t("div",null,[_.user_id?(l(),d("span",so,"User: "+$(((Pe=b.value.find(le=>le.id===_.user_id))==null?void 0:Pe.name)||"Unknown"),1)):x("",!0),_.hours_spent?(l(),d("span",oo,"Hours: "+$(_.hours_spent),1)):x("",!0),(_.type==="expense"||_.type==="bonus")&&J.value>0?(l(),d("span",no,$((S(ye)(_.amount,_.currency,S(M))/J.value*100).toFixed(2))+"% of Income ",1)):x("",!0)]),t("div",lo,[!_.is_paid&&(S(v)||S(k))?(l(),se(he,{key:0,onClick:le=>y(_e),class:H({"text-green-600":_.type!=="income","text-blue-600":_.type==="income"})},{default:Q(()=>[F($(_.type==="income"?"Receive":"Pay"),1)]),_:2},1032,["onClick","class"])):x("",!0),S(v)||S(k)?(l(),se(he,{key:1,onClick:le=>o(_e),class:"text-red-600"},{default:Q(()=>c[22]||(c[22]=[F(" Delete ",-1)])),_:2,__:[22]},1032,["onClick"])):x("",!0)])]),j.value===_.id?(l(),d("div",ro,[t("h4",io,$(_.type==="income"?"Record Receipt":"Make Payment"),1),t("div",co,[i(D,{for:"payment_date",value:"Date"}),i(L,{id:"payment_date",type:"date",modelValue:Y.value,"onUpdate:modelValue":c[7]||(c[7]=le=>Y.value=le),class:"mt-1 block w-full",disabled:n.value},null,8,["modelValue","disabled"]),i(O,{message:($e=K.value.date)==null?void 0:$e[0],class:"mt-2"},null,8,["message"])]),t("div",uo,[t("label",mo,[ge(t("input",{type:"checkbox","onUpdate:modelValue":c[8]||(c[8]=le=>V.value=le),class:"mr-2 rounded text-blue-600 focus:ring-blue-500",disabled:n.value},null,8,vo),[[Ye,V.value]]),t("span",go,$(_.type==="income"?"Receive in Full":"Pay in Full"),1)])]),V.value?x("",!0):(l(),d("div",po,[i(D,{for:"payment_amount",value:"Amount"}),i(L,{id:"payment_amount",type:"number",modelValue:w.value,"onUpdate:modelValue":c[9]||(c[9]=le=>w.value=le),class:"mt-1 block w-full",disabled:n.value,placeholder:"Enter partial "+(_.type==="income"?"receipt":"payment")+" amount (Max: "+S(ee)(_.amount,_.currency)+")"},null,8,["modelValue","disabled","placeholder"]),i(O,{message:(Se=K.value.amount)==null?void 0:Se[0],class:"mt-2"},null,8,["message"])])),t("div",yo,[i(he,{onClick:A,disabled:n.value},{default:Q(()=>c[23]||(c[23]=[F(" Cancel ",-1)])),_:1,__:[23]},8,["disabled"]),i(ae,{onClick:X,disabled:n.value},{default:Q(()=>[F($(n.value?"Processing...":_.type==="income"?"Record Receipt":"Submit Payment"),1)]),_:2},1032,["disabled"])])])):x("",!0)],2)}),128))]))])):x("",!0)])}}},bo={class:"p-6 w-full mx-auto bg-white rounded-xl shadow-2xl transition-all duration-300"},wo={class:"border-b border-gray-200 mb-6"},ho={class:"flex -mb-px space-x-4 overflow-x-auto pb-2"},xo={class:"py-4"},Co={__name:"ProjectForm",props:{projectId:{type:[Number,String],default:null},statusOptions:{type:Array,required:!0},departmentOptions:{type:Array,required:!0},sourceOptions:{type:Array,required:!0},clientRoleOptions:{type:Array,default:()=>[]},userRoleOptions:{type:Array,default:()=>[]},paymentTypeOptions:{type:Array,required:!0},errors:{type:Object,default:()=>({})},isSaving:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:g}){We();const a=e,p=P(a.projectId);te(()=>a.projectId,o=>{p.value=o,o&&Je(o)},{immediate:!0}),Xe(p);const v=Qe(p),{canDo:k,canView:N,canManage:C}=Ne(p),b=k("manage_projects",v);k("create_clients",v);const u=k("upload_project_documents",v),s=C("project_services_and_payments",v),n=k("add_project_notes",v),j=C("project_users",v),w=C("project_clients",v),V=k("manage_project_basic_details",v),K=N("project_documents",v),G=N("project_services_and_payments",v),Y=N("project_notes",v),I=N("project_users",v),M=N("project_clients",v),ne=N("project_transactions",v),m=P("basic"),U=E(()=>M.value&&I.value?"Clients and Users":M.value?"Clients":I.value?"Users":"Clients and Users"),B=P([]),q=P([]),W=P([]),f=P([]),r=o=>{if(o!=="basic"&&!a.projectId){Ze("Please create the project first before managing this section."),m.value="basic";return}m.value=o};return me(async()=>{try{B.value=await Ue("client"),q.value=await Ue("project"),W.value=await lt(!0,null),f.value=await rt(!0,null)}catch(o){console.error("Error fetching global data for ProjectForm:",o)}}),(o,y)=>(l(),d("div",bo,[y[6]||(y[6]=t("div",{class:"flex justify-between items-center pb-4 mb-6 border-b border-gray-200"},[t("h2",{class:"text-2xl font-semibold text-gray-800"},"Edit Project")],-1)),t("div",wo,[t("nav",ho,[t("button",{onClick:y[0]||(y[0]=A=>r("basic")),class:H(["py-3 px-5 text-center border-b-2 font-medium text-base rounded-t-lg transition-colors duration-200 whitespace-nowrap",m.value==="basic"?"border-indigo-600 text-indigo-700 bg-indigo-50":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300 hover:bg-gray-50"])}," Basic Information ",2),e.projectId&&(S(M)||S(I))?(l(),d("button",{key:0,onClick:y[1]||(y[1]=A=>r("client")),class:H(["py-3 px-5 text-center border-b-2 font-medium text-base rounded-t-lg transition-colors duration-200 whitespace-nowrap",m.value==="client"?"border-indigo-600 text-indigo-700 bg-indigo-50":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300 hover:bg-gray-50"])},$(U.value),3)):x("",!0),e.projectId&&(S(s)||S(G))?(l(),d("button",{key:1,onClick:y[2]||(y[2]=A=>r("services")),class:H(["py-3 px-5 text-center border-b-2 font-medium text-base rounded-t-lg transition-colors duration-200 whitespace-nowrap",m.value==="services"?"border-indigo-600 text-indigo-700 bg-indigo-50":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300 hover:bg-gray-50"])}," Services & Payment ",2)):x("",!0),e.projectId&&S(ne)?(l(),d("button",{key:2,onClick:y[3]||(y[3]=A=>r("transactions")),class:H(["py-3 px-5 text-center border-b-2 font-medium text-base rounded-t-lg transition-colors duration-200 whitespace-nowrap",m.value==="transactions"?"border-indigo-600 text-indigo-700 bg-indigo-50":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300 hover:bg-gray-50"])}," Transactions ",2)):x("",!0),e.projectId&&S(K)?(l(),d("button",{key:3,onClick:y[4]||(y[4]=A=>r("documents")),class:H(["py-3 px-5 text-center border-b-2 font-medium text-base rounded-t-lg transition-colors duration-200 whitespace-nowrap",m.value==="documents"?"border-indigo-600 text-indigo-700 bg-indigo-50":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300 hover:bg-gray-50"])}," Documents ",2)):x("",!0),e.projectId&&(S(n)||S(Y))?(l(),d("button",{key:4,onClick:y[5]||(y[5]=A=>r("notes")),class:H(["py-3 px-5 text-center border-b-2 font-medium text-base rounded-t-lg transition-colors duration-200 whitespace-nowrap",m.value==="notes"?"border-indigo-600 text-indigo-700 bg-indigo-50":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300 hover:bg-gray-50"])}," Notes ",2)):x("",!0)])]),t("div",xo,[m.value==="basic"?(l(),se(_t,{key:0,projectId:e.projectId,errors:a.errors,statusOptions:e.statusOptions,sourceOptions:e.sourceOptions,canManageProjects:S(b),canManageProjectBasicDetails:S(V),isSaving:a.isSaving},null,8,["projectId","errors","statusOptions","sourceOptions","canManageProjects","canManageProjectBasicDetails","isSaving"])):x("",!0),m.value==="client"?(l(),se(Jt,{key:1,projectId:e.projectId,errors:a.errors,clientRoleOptions:B.value,userRoleOptions:q.value,clients:W.value,users:f.value,canViewProjectClients:S(M),canManageProjectClients:S(w),canViewProjectUsers:S(I),canManageProjectUsers:S(j),isSaving:a.isSaving},null,8,["projectId","errors","clientRoleOptions","userRoleOptions","clients","users","canViewProjectClients","canManageProjectClients","canViewProjectUsers","canManageProjectUsers","isSaving"])):x("",!0),m.value==="services"?(l(),se(ps,{key:2,projectId:e.projectId,departmentOptions:e.departmentOptions,paymentTypeOptions:e.paymentTypeOptions,canManageProjectServicesAndPayments:S(s),canViewProjectServicesAndPayments:S(G),isSaving:a.isSaving},null,8,["projectId","departmentOptions","paymentTypeOptions","canManageProjectServicesAndPayments","canViewProjectServicesAndPayments","isSaving"])):x("",!0),m.value==="transactions"&&S(ne)?(l(),se(fo,{key:3,projectId:e.projectId,userProjectRole:S(v),isSaving:a.isSaving},null,8,["projectId","userProjectRole","isSaving"])):x("",!0),m.value==="documents"?(l(),se(pa,{key:4,projectId:e.projectId,errors:a.errors,canUploadProjectDocuments:S(u),canViewProjectDocuments:S(K),isSaving:a.isSaving},null,8,["projectId","errors","canUploadProjectDocuments","canViewProjectDocuments","isSaving"])):x("",!0),m.value==="notes"?(l(),se(Ca,{key:5,projectId:e.projectId,errors:a.errors,canAddProjectNotes:S(n),canViewProjectNotes:S(Y),"is-saving":a.isSaving},null,8,["projectId","errors","canAddProjectNotes","canViewProjectNotes","is-saving"])):x("",!0)])]))}};export{Co as _,ye as a,Ae as b,z as c,Be as d,ee as f};
