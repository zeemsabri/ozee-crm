import{d as R}from"./vuedraggable.umd-Cv3onlYi.js";import{_ as S}from"./Modal-BUM9gTnU.js";import{_}from"./TextInput-BkFkKbbu.js";import{_ as E}from"./TextareaInput-BKRayd2N.js";import{_ as y}from"./PrimaryButton-s0LLA_zq.js";import{_ as D}from"./SecondaryButton-dXnWi67E.js";import{r as q}from"./InformationCircleIcon-q4uwPNtb.js";import{r as Y}from"./TrashIcon-C2BqsVNr.js";import{r as V,m as L,c,o as i,a as o,f as r,l as g,q as j,w as u,i as m,u as C}from"./app-Cac_F2Ek.js";const F={class:"space-y-3"},G={class:"flex items-start gap-3"},H={class:"flex gap-2"},J={key:0,class:"flex items-start text-sm text-gray-600 bg-gray-50 border border-gray-200 rounded-md px-3 py-2"},K={class:"flex items-start gap-2"},O={class:"flex-1"},Q={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-2 w-full"},W={key:1},X={class:"mt-1 flex gap-2"},Z=["onClick"],ee=["onClick"],te=["onClick"],le={class:"p-6"},ae={class:"mt-6 flex justify-end gap-3"},pe={__name:"RepeatableDynamicField",props:{modelValue:{type:Array,default:()=>[]},allowLinks:{type:Boolean,default:!1},placeholderName:{type:String,default:"item"},addButtonText:{type:String,default:"Add item"},labelPlaceholder:{type:String,default:"Label"},urlPlaceholder:{type:String,default:"https://example.com"},itemPlaceholder:{type:String,default:"Enter value"}},emits:["update:modelValue"],setup(n,{emit:P}){const v=n,B=P,l=V([...v.modelValue]),k=V(!1),p=V(""),$=(t,e)=>{if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a])return!1;return!0};L(()=>v.modelValue,t=>{const e=Array.isArray(t)?t:[];$(e,l.value)||(l.value=[...e])}),L(()=>[...l.value],t=>{const e=Array.isArray(v.modelValue)?v.modelValue:[];$(t,e)||B("update:modelValue",t)});const A=/^\((.*?)\)\[(.*?)\]$/,M=()=>{l.value.push("")},N=()=>{l.value.push("(Label)[]")},U=()=>{if(!p.value)return;const t=p.value.split(`
`).map(e=>e.trim()).filter(e=>e.length>0);t.length>0&&l.value.push(...t),h()},h=()=>{p.value="",k.value=!1},z=t=>{window.confirm("Remove this item?")&&l.value.splice(t,1)},b=t=>typeof t=="string"&&A.test(t),f=t=>{const e=typeof t=="string"?t.match(A):null;return{label:e?e[1]:"",url:e?e[2]:""}},x=(t,e)=>`(${t||""})[${e||""}]`,T=t=>{const e=l.value[t]??"";l.value[t]=x(e,"")},I=t=>{const{label:e,url:a}=f(l.value[t]);l.value[t]=e||a||""};return(t,e)=>(i(),c("div",F,[o("div",G,[o("div",H,[r(y,{type:"button",onClick:M},{default:u(()=>e[3]||(e[3]=[m(" Add text ",-1)])),_:1,__:[3]}),n.allowLinks?(i(),j(y,{key:0,type:"button",onClick:N},{default:u(()=>e[4]||(e[4]=[m(" Add link ",-1)])),_:1,__:[4]})):g("",!0),r(y,{type:"button",onClick:e[0]||(e[0]=a=>k.value=!0)},{default:u(()=>e[5]||(e[5]=[m(" Bulk paste ",-1)])),_:1,__:[5]})]),n.allowLinks?(i(),c("div",J,[r(C(q),{class:"h-5 w-5 text-indigo-500 mr-2 mt-0.5"}),e[6]||(e[6]=o("div",null,[m(" You can insert inline links by typing: "),o("code",null,"(Label)[https://example.com]"),m(" inside any text item. You can also add a dedicated link item with the button. Drag to reorder. ")],-1))])):g("",!0)]),r(C(R),{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value=a),"item-key":"__index",handle:".drag-handle",class:"space-y-2"},{item:u(({element:a,index:s})=>[o("div",K,[e[7]||(e[7]=o("button",{type:"button",class:"drag-handle cursor-move text-gray-400 hover:text-gray-600 p-2","aria-label":"Drag to reorder"},[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[o("path",{d:"M7 4a1 1 0 110-2 1 1 0 010 2zM13 4a1 1 0 110-2 1 1 0 010 2zM7 11a1 1 0 110-2 1 1 0 010 2zM13 11a1 1 0 110-2 1 1 0 010 2zM7 18a1 1 0 110-2 1 1 0 010 2zM13 18a1 1 0 110-2 1 1 0 010 2z"})])],-1)),o("div",O,[b(a)?(i(),c("div",Q,[r(_,{id:`${n.placeholderName}-${s}-label`,type:"text",class:"block w-full",placeholder:n.labelPlaceholder,"model-value":f(a).label,"onUpdate:modelValue":d=>{const w=f(l.value[s]);l.value[s]=x(d,w.url)}},null,8,["id","placeholder","model-value","onUpdate:modelValue"]),r(_,{id:`${n.placeholderName}-${s}-url`,type:"url",class:"block w-full",placeholder:n.urlPlaceholder,"model-value":f(a).url,"onUpdate:modelValue":d=>{const w=f(l.value[s]);l.value[s]=x(w.label,d)}},null,8,["id","placeholder","model-value","onUpdate:modelValue"])])):(i(),c("div",W,[r(_,{id:`${n.placeholderName}-${s}`,type:"text",class:"block w-full",placeholder:n.itemPlaceholder,modelValue:l.value[s],"onUpdate:modelValue":d=>l.value[s]=d},null,8,["id","placeholder","modelValue","onUpdate:modelValue"])])),o("div",X,[n.allowLinks&&!b(a)?(i(),c("button",{key:0,type:"button",class:"text-xs text-indigo-600 hover:underline",onClick:d=>T(s)},"Convert to link",8,Z)):g("",!0),n.allowLinks&&b(a)?(i(),c("button",{key:1,type:"button",class:"text-xs text-indigo-600 hover:underline",onClick:d=>I(s)},"Convert to text",8,ee)):g("",!0)])]),o("button",{type:"button",class:"text-red-500 hover:text-red-600 p-2",onClick:d=>z(s),"aria-label":"Remove item"},[r(C(Y),{class:"h-5 w-5"})],8,te)])]),_:1},8,["modelValue"]),r(S,{show:k.value,onClose:h,"max-width":"lg"},{default:u(()=>[o("div",le,[e[10]||(e[10]=o("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Bulk Paste Items ",-1)),e[11]||(e[11]=o("p",{class:"text-sm text-gray-600 mb-4"}," Paste your multi-line message below. Each line will be added as a separate text item. ",-1)),r(E,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=a=>p.value=a),class:"w-full h-48",placeholder:"Paste your text here...",autofocus:""},null,8,["modelValue"]),o("div",ae,[r(D,{onClick:h},{default:u(()=>e[8]||(e[8]=[m(" Cancel ",-1)])),_:1,__:[8]}),r(y,{onClick:U},{default:u(()=>e[9]||(e[9]=[m(" Add Lines ",-1)])),_:1,__:[9]})])])]),_:1},8,["show"])]))}};export{pe as _};
