import{u as ze}from"./presentationStore-CUexZeva.js";import{aV as fe,r as y,l as _,m as C,I as G,b as W,q as H,aU as E,o as T,K as xe,aS as b,aW as Se,c as J,Z as Pe,j as _e,u as z,p as F,ab as ge,G as we,w as B,a as A,e as g,t as Me,k as Ee}from"./app-BWTxZZDy.js";import{_ as be}from"./AuthenticatedLayout-BMPCQPv1.js";import ye from"./SlideManager-Bew9C4Yv.js";import ke from"./SlideEditor-DBDzhXNA.js";import Re from"./SlidePreview-VqwyP1Id.js";import Ne from"./Toolbar-AErPK0dC.js";import"./presentationsApi-DecaqiJL.js";import"./PrimaryButton-BzIltyHC.js";import"./Modal-DhzQz1HA.js";import"./InputLabel-BQibQid6.js";import"./InputError-CvLO1Qua.js";import"./SecondaryButton-BkrXt0yv.js";import"./index-BgGJTKOW.js";import"./BaseFormModal-BUVfnO--.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput--vAmjZn0.js";import"./SelectDropdown-OjIlWwqk.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./RightSidebar-SqaNTBDP.js";import"./ApplicationLogo-he3qmFdk.js";import"./MultiSelectDropdown-Clvs2N0y.js";import"./createLucideIcon-oq7di1Il.js";import"./plus-DNukUt4O.js";import"./DangerButton-D_i8NBBl.js";import"./moment-BLMuvzoS.js";import"./taskState-CZv-z7Oy.js";import"./NoticeboardModal-DTW0kpEY.js";import"./x-Dr1vY3Z0.js";import"./vuedraggable.umd-C0GP25sm.js";import"./SlideThumbnail-B1Vqa6DY.js";import"./ContentBlockForm-D_86sLxe.js";import"./TiptapEditor-Dy0UNuj_.js";import"./IconPicker-DCb_5_xM.js";import"./BlockToolbox-ym_3_tWf.js";/* empty css                                                                     */import"./ShareModal-BQBENeGa.js";import"./BaseModal-DsgNqKTY.js";import"./CollaborateModal-DDLygjlF.js";const Oe={__name:"splitpanes",props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click"],setup(L,{emit:c}){const r=c,m=L,P=fe(),s=y([]),x=_(()=>s.value.reduce((e,a)=>(e[~~a.id]=a)&&e,{})),h=_(()=>s.value.length),d=y(null),w=y(!1),p=y({mouseDown:!1,dragging:!1,activeSplitter:null,cursorOffset:0}),S=y({splitter:null,timeoutId:null}),k=_(()=>({[`splitpanes splitpanes--${m.horizontal?"horizontal":"vertical"}`]:!0,"splitpanes--dragging":p.value.dragging})),R=()=>{document.addEventListener("mousemove",u,{passive:!1}),document.addEventListener("mouseup",M),"ontouchstart"in window&&(document.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchend",M))},N=()=>{document.removeEventListener("mousemove",u,{passive:!1}),document.removeEventListener("mouseup",M),"ontouchstart"in window&&(document.removeEventListener("touchmove",u,{passive:!1}),document.removeEventListener("touchend",M))},D=(e,a)=>{const t=e.target.closest(".splitpanes__splitter");if(t){const{left:i,top:n}=t.getBoundingClientRect(),{clientX:l,clientY:o}="ontouchstart"in window&&e.touches?e.touches[0]:e;p.value.cursorOffset=m.horizontal?o-n:l-i}R(),p.value.mouseDown=!0,p.value.activeSplitter=a},u=e=>{p.value.mouseDown&&(e.preventDefault(),p.value.dragging=!0,requestAnimationFrame(()=>{ae(ee(e)),r("resize",s.value.map(a=>({min:a.min,max:a.max,size:a.size})))}))},M=()=>{p.value.dragging&&r("resized",s.value.map(e=>({min:e.min,max:e.max,size:e.size}))),p.value.mouseDown=!1,setTimeout(()=>{p.value.dragging=!1,N()},100)},U=(e,a)=>{"ontouchstart"in window&&(e.preventDefault(),m.dblClickSplitter&&(S.value.splitter===a?(clearTimeout(S.value.timeoutId),S.value.timeoutId=null,$(e,a),S.value.splitter=null):(S.value.splitter=a,S.value.timeoutId=setTimeout(()=>S.value.splitter=null,500)))),p.value.dragging||r("splitter-click",s.value[a])},$=(e,a)=>{let t=0;s.value=s.value.map((i,n)=>(i.size=n===a?i.max:i.min,n!==a&&(t+=i.min),i)),s.value[a].size-=t,r("pane-maximize",s.value[a]),r("resized",s.value.map(i=>({min:i.min,max:i.max,size:i.size})))},Q=(e,a)=>{r("pane-click",x.value[a])},ee=e=>{const a=d.value.getBoundingClientRect(),{clientX:t,clientY:i}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:t-(m.horizontal?0:p.value.cursorOffset)-a.left,y:i-(m.horizontal?p.value.cursorOffset:0)-a.top}},ie=e=>{e=e[m.horizontal?"y":"x"];const a=d.value[m.horizontal?"clientHeight":"clientWidth"];return m.rtl&&!m.horizontal&&(e=a-e),e*100/a},ae=e=>{const a=p.value.activeSplitter;let t={prevPanesSize:X(a),nextPanesSize:O(a),prevReachedMinPanes:0,nextReachedMinPanes:0};const i=0+(m.pushOtherPanes?0:t.prevPanesSize),n=100-(m.pushOtherPanes?0:t.nextPanesSize),l=Math.max(Math.min(ie(e),n),i);let o=[a,a+1],v=s.value[o[0]]||null,f=s.value[o[1]]||null;const K=v.max<100&&l>=v.max+t.prevPanesSize,he=f.max<100&&l<=100-(f.max+O(a+1));if(K||he){K?(v.size=v.max,f.size=Math.max(100-v.max-t.prevPanesSize-t.nextPanesSize,0)):(v.size=Math.max(100-f.max-t.prevPanesSize-O(a+1),0),f.size=f.max);return}if(m.pushOtherPanes){const Z=te(t,l);if(!Z)return;({sums:t,panesToResize:o}=Z),v=s.value[o[0]]||null,f=s.value[o[1]]||null}v!==null&&(v.size=Math.min(Math.max(l-t.prevPanesSize-t.prevReachedMinPanes,v.min),v.max)),f!==null&&(f.size=Math.min(Math.max(100-l-t.nextPanesSize-t.nextReachedMinPanes,f.min),f.max))},te=(e,a)=>{const t=p.value.activeSplitter,i=[t,t+1];return a<e.prevPanesSize+s.value[i[0]].min&&(i[0]=ne(t).index,e.prevReachedMinPanes=0,i[0]<t&&s.value.forEach((n,l)=>{l>i[0]&&l<=t&&(n.size=n.min,e.prevReachedMinPanes+=n.min)}),e.prevPanesSize=X(i[0]),i[0]===void 0)?(e.prevReachedMinPanes=0,s.value[0].size=s.value[0].min,s.value.forEach((n,l)=>{l>0&&l<=t&&(n.size=n.min,e.prevReachedMinPanes+=n.min)}),s.value[i[1]].size=100-e.prevReachedMinPanes-s.value[0].min-e.prevPanesSize-e.nextPanesSize,null):a>100-e.nextPanesSize-s.value[i[1]].min&&(i[1]=se(t).index,e.nextReachedMinPanes=0,i[1]>t+1&&s.value.forEach((n,l)=>{l>t&&l<i[1]&&(n.size=n.min,e.nextReachedMinPanes+=n.min)}),e.nextPanesSize=O(i[1]-1),i[1]===void 0)?(e.nextReachedMinPanes=0,s.value.forEach((n,l)=>{l<h.value-1&&l>=t+1&&(n.size=n.min,e.nextReachedMinPanes+=n.min)}),s.value[i[0]].size=100-e.prevPanesSize-O(i[0]-1),null):{sums:e,panesToResize:i}},X=e=>s.value.reduce((a,t,i)=>a+(i<e?t.size:0),0),O=e=>s.value.reduce((a,t,i)=>a+(i>e+1?t.size:0),0),ne=e=>[...s.value].reverse().find(a=>a.index<e&&a.size>a.min)||{},se=e=>s.value.find(a=>a.index>e+1&&a.size>a.min)||{},le=()=>{var e;Array.from(((e=d.value)==null?void 0:e.children)||[]).forEach(a=>{const t=a.classList.contains("splitpanes__pane"),i=a.classList.contains("splitpanes__splitter");!t&&!i&&(a.remove(),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))})},Y=(e,a,t=!1)=>{const i=e-1,n=document.createElement("div");n.classList.add("splitpanes__splitter"),t||(n.onmousedown=l=>D(l,i),typeof window<"u"&&"ontouchstart"in window&&(n.ontouchstart=l=>D(l,i)),n.onclick=l=>U(l,i+1)),m.dblClickSplitter&&(n.ondblclick=l=>$(l,i+1)),a.parentNode.insertBefore(n,a)},oe=e=>{e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.remove()},I=()=>{var e;const a=Array.from(((e=d.value)==null?void 0:e.children)||[]);a.forEach(i=>{i.className.includes("splitpanes__splitter")&&oe(i)});let t=0;a.forEach(i=>{i.className.includes("splitpanes__pane")&&(!t&&m.firstSplitter?Y(t,i,!0):t&&Y(t,i),t++)})},re=({uid:e,...a})=>{const t=x.value[e];Object.entries(a).forEach(([i,n])=>t[i]=n)},ue=e=>{var a;let t=-1;Array.from(((a=d.value)==null?void 0:a.children)||[]).some(i=>(i.className.includes("splitpanes__pane")&&t++,i.isSameNode(e.el))),s.value.splice(t,0,{...e,index:t}),s.value.forEach((i,n)=>i.index=n),w.value&&F(()=>{I(),q({addedPane:s.value[t]}),r("pane-add",{index:t,panes:s.value.map(i=>({min:i.min,max:i.max,size:i.size}))})})},me=e=>{const a=s.value.findIndex(i=>i.id===e),t=s.value.splice(a,1)[0];s.value.forEach((i,n)=>i.index=n),F(()=>{I(),q({removedPane:{...t}}),r("pane-remove",{removed:t,panes:s.value.map(i=>({min:i.min,max:i.max,size:i.size}))})})},q=(e={})=>{!e.addedPane&&!e.removedPane?pe():s.value.some(a=>a.givenSize!==null||a.min||a.max<100)?ve(e):de(),w.value&&r("resized",s.value.map(a=>({min:a.min,max:a.max,size:a.size})))},de=()=>{const e=100/h.value;let a=0;const t=[],i=[];s.value.forEach(n=>{n.size=Math.max(Math.min(e,n.max),n.min),a-=n.size,n.size>=n.max&&t.push(n.id),n.size<=n.min&&i.push(n.id)}),a>.1&&V(a,t,i)},pe=()=>{let e=100;const a=[],t=[];let i=0;s.value.forEach(l=>{e-=l.size,l.givenSize!==null&&i++,l.size>=l.max&&a.push(l.id),l.size<=l.min&&t.push(l.id)});let n=100;e>.1&&(s.value.forEach(l=>{l.givenSize===null&&(l.size=Math.max(Math.min(e/(h.value-i),l.max),l.min)),n-=l.size}),n>.1&&V(n,a,t))},ve=({addedPane:e,removedPane:a}={})=>{let t=100/h.value,i=0;const n=[],l=[];((e==null?void 0:e.givenSize)??null)!==null&&(t=(100-e.givenSize)/(h.value-1).value),s.value.forEach(o=>{i-=o.size,o.size>=o.max&&n.push(o.id),o.size<=o.min&&l.push(o.id)}),!(Math.abs(i)<.1)&&(s.value.forEach(o=>{(e==null?void 0:e.givenSize)!==null&&(e==null?void 0:e.id)===o.id||(o.size=Math.max(Math.min(t,o.max),o.min)),i-=o.size,o.size>=o.max&&n.push(o.id),o.size<=o.min&&l.push(o.id)}),i>.1&&V(i,n,l))},V=(e,a,t)=>{let i;e>0?i=e/(h.value-a.length):i=e/(h.value-t.length),s.value.forEach((n,l)=>{if(e>0&&!a.includes(n.id)){const o=Math.max(Math.min(n.size+i,n.max),n.min),v=o-n.size;e-=v,n.size=o}else if(!t.includes(n.id)){const o=Math.max(Math.min(n.size+i,n.max),n.min),v=o-n.size;e-=v,n.size=o}}),Math.abs(e)>.1&&F(()=>{w.value&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})};C(()=>m.firstSplitter,()=>I()),C(()=>m.dblClickSplitter,e=>{[...d.value.querySelectorAll(".splitpanes__splitter")].forEach((a,t)=>{a.ondblclick=e?i=>$(i,t):void 0})}),G(()=>w.value=!1),W(()=>{le(),I(),q(),r("ready"),w.value=!0});const ce=()=>{var e;return ge("div",{ref:d,class:k.value},(e=P.default)==null?void 0:e.call(P))};return E("panes",s),E("indexedPanes",x),E("horizontal",_(()=>m.horizontal)),E("requestUpdate",re),E("onPaneAdd",ue),E("onPaneRemove",me),E("onPaneClick",Q),(e,a)=>(T(),H(xe(ce)))}},j={__name:"pane",props:{size:{type:[Number,String]},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},setup(L){var c;const r=L,m=b("requestUpdate"),P=b("onPaneAdd"),s=b("horizontal"),x=b("onPaneRemove"),h=b("onPaneClick"),d=(c=Se())==null?void 0:c.uid,w=b("indexedPanes"),p=_(()=>w.value[d]),S=y(null),k=_(()=>{const u=isNaN(r.size)||r.size===void 0?0:parseFloat(r.size);return Math.max(Math.min(u,N.value),R.value)}),R=_(()=>{const u=parseFloat(r.minSize);return isNaN(u)?0:u}),N=_(()=>{const u=parseFloat(r.maxSize);return isNaN(u)?100:u}),D=_(()=>{var u;return`${s.value?"height":"width"}: ${(u=p.value)==null?void 0:u.size}%`});return W(()=>{P({id:d,el:S.value,min:R.value,max:N.value,givenSize:r.size===void 0?null:k.value,size:k.value})}),C(()=>k.value,u=>m({uid:d,size:u})),C(()=>R.value,u=>m({uid:d,min:u})),C(()=>N.value,u=>m({uid:d,max:u})),G(()=>x(d)),(u,M)=>(T(),J("div",{ref_key:"paneEl",ref:S,class:"splitpanes__pane",onClick:M[0]||(M[0]=U=>z(h)(U,u._.uid)),style:_e(D.value)},[Pe(u.$slots,"default")],4))}},Be={class:"flex flex-row h-full bg-gray-50"},Ce={class:"flex-1 flex flex-col min-w-0"},Le={class:"h-8 px-4 border-b bg-white flex items-center text-sm text-slate-700"},De=["title"],Ie={key:0,class:"h-full relative"},wi={__name:"EditorView",setup(L){const c=ze(),r=we();let P=((r==null?void 0:r.props)||{}).presentationId;if(!P&&(r!=null&&r.url)){const s=r.url.split("?")[0].split("#")[0].split("/").filter(Boolean),x=s.findIndex(h=>h==="presentations");x!==-1&&s[x+1]&&(P=s[x+1])}return W(()=>{P&&c.load(P)}),(s,x)=>(T(),H(be,null,{default:B(()=>{var h,d;return[A("div",Be,[g(Ne,{actions:["save","share","collaborate","saveTemplate"],class:"","aria-label":"Editor toolbar"}),A("div",Ce,[A("div",Le,[A("span",{class:"font-medium truncate",title:((h=z(c).presentation)==null?void 0:h.title)||"Untitled Presentation"},Me(((d=z(c).presentation)==null?void 0:d.title)||"Untitled Presentation"),9,De)]),g(z(Oe),{class:"flex-1 overflow-hidden"},{default:B(()=>[g(z(j),{"min-size":z(c).previewMaximized?0:20,size:z(c).previewMaximized?0:10,class:"bg-white border-r overflow-hidden"},{default:B(()=>[g(ye)]),_:1},8,["min-size","size"]),g(z(j),{size:z(c).previewMaximized?0:80,class:"bg-white overflow-hidden"},{default:B(()=>[g(ke)]),_:1},8,["size"]),g(z(j),{size:z(c).previewOpen?z(c).previewMaximized?100:30:0,"min-size":"0",class:"bg-white border-l overflow-hidden transition-all"},{default:B(()=>[z(c).previewOpen?(T(),J("div",Ie,[g(Re)])):Ee("",!0)]),_:1},8,["size"])]),_:1})])])]}),_:1}))}};export{wi as default};
