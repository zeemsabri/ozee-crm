import{aA as J,r as m,q as K,c as h,f as O,a as u,o as l,d as o,u as Q,h as R,w as r,b as t,i as v,m as p,t as f,F,l as W,g as y,x as j,A as I}from"./app-DkYG0ZoN.js";import{_ as X}from"./AuthenticatedLayout-WHJO5EYe.js";import{P as T}from"./PrimaryButton-WlUZpj5v.js";import{D as P}from"./DangerButton-C1Ig5ccz.js";import{_ as E}from"./SecondaryButton-KKZvDRxV.js";import{_ as M}from"./Modal-BrOkWPaS.js";import{_ as b}from"./InputLabel-H32RRwnd.js";import{_ as Y}from"./TextInput-C75iwrAH.js";import{_ as C}from"./InputError-DHZanCJs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SelectDropdown-tkiGYWKl.js";import"./Checkbox-DJfxhAx1.js";import"./ApplicationLogo-hBvsm0im.js";import"./moment-BLMuvzoS.js";const Z={class:"py-12"},ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},se={class:"p-6 text-gray-900"},ae={key:0,class:"mb-6"},oe={key:1,class:"text-gray-600"},le={key:2,class:"text-red-600"},ie={key:3,class:"text-gray-600"},ne={key:4},re={class:"min-w-full divide-y divide-gray-200"},de={class:"bg-white divide-y divide-gray-200"},ue={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4"},me={class:"px-6 py-4 whitespace-nowrap"},ve={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},fe={class:"flex items-center space-x-2"},ye={class:"p-6"},xe={class:"mt-6"},_e={class:"mb-4"},ge={class:"mb-4"},ke={class:"mt-6 flex justify-end"},we={class:"p-6"},he={class:"mt-6"},Te={class:"mb-4"},be={class:"mb-4"},Ce={class:"mt-6 flex justify-end"},De={class:"p-6"},$e={key:0,class:"mt-4 text-gray-800"},Ve={key:1,class:"mt-4 text-red-600"},Ne={class:"mt-6 flex justify-end"},He={__name:"Index",setup(Ee){const x=J(),c=m([]),D=m(!0),d=m({}),n=m(""),_=m(!1),g=m(!1),k=m(!1),i=m({id:null,name:"",description:""}),w=m(null),{canDo:$}=K(),V=h(()=>x.value?x.value.role_data&&x.value.role_data.slug==="super-admin"||x.value.role==="super_admin"||x.value.role==="super-admin":!1),U=h(()=>$("create_projects").value||V.value),A=h(()=>$("manage_projects").value||V.value),N=h(()=>$("delete_projects").value||V.value),q=async()=>{D.value=!0,n.value="";try{const a=await window.axios.get("/api/task-types");c.value=a.data}catch(a){n.value="Failed to load task types.",console.error("Error fetching task types:",a),a.response&&(a.response.status===401||a.response.status===403)&&(n.value="You are not authorized to view this content or your session expired. Please log in.")}finally{D.value=!1}},L=()=>{if(!U.value){alert("You do not have permission to create task types.");return}i.value={id:null,name:"",description:""},d.value={},_.value=!0},S=a=>{if(!A.value){alert("You do not have permission to edit task types.");return}i.value={id:a.id,name:a.name,description:a.description||""},d.value={},g.value=!0},B=async()=>{d.value={},n.value="";try{let a;if(i.value.id){a=await window.axios.put(`/api/task-types/${i.value.id}`,i.value);const e=c.value.findIndex(s=>s.id===i.value.id);e!==-1&&(c.value[e]=a.data),g.value=!1,alert("Task type updated successfully!")}else a=await window.axios.post("/api/task-types",i.value),c.value.push(a.data),_.value=!1,alert("Task type created successfully!")}catch(a){console.error("Error submitting task type form:",a),a.response&&a.response.data&&a.response.data.errors?d.value=a.response.data.errors:n.value="Failed to save task type. Please try again."}},z=a=>{if(!N.value){alert("You do not have permission to delete task types.");return}w.value=a,k.value=!0},G=async()=>{var e;n.value="";const a=(e=w.value)==null?void 0:e.id;if(!a){n.value="Invalid task type.";return}if(!N.value){n.value="You do not have permission to delete task types.";return}try{await window.axios.delete(`/api/task-types/${a}`),c.value=c.value.filter(s=>s.id!==a),k.value=!1,w.value=null,alert("Task type deleted successfully!")}catch(s){n.value="Failed to delete task type.",s.response&&s.response.data.message&&(n.value=s.response.data.message),console.error("Error deleting task type:",s)}};return O(()=>{q()}),(a,e)=>(l(),u(F,null,[o(Q(R),{title:"Task Types"}),o(X,null,{header:r(()=>e[10]||(e[10]=[t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Task Types",-1)])),default:r(()=>[t("div",Z,[t("div",ee,[t("div",te,[t("div",se,[e[15]||(e[15]=t("h3",{class:"text-2xl font-bold mb-4"},"Task Types Management",-1)),U.value?(l(),u("div",ae,[o(T,{onClick:L},{default:r(()=>e[11]||(e[11]=[p(" Create New Task Type ",-1)])),_:1,__:[11]})])):v("",!0),D.value?(l(),u("div",oe,"Loading task types...")):n.value?(l(),u("div",le,f(n.value),1)):c.value.length===0?(l(),u("div",ie,"No task types found.")):(l(),u("div",ne,[t("table",re,[e[14]||(e[14]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Created By"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Created At"),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",de,[(l(!0),u(F,null,W(c.value,s=>(l(),u("tr",{key:s.id},[t("td",ue,f(s.name),1),t("td",pe,f(s.description||"No description"),1),t("td",me,f(s.created_by_user?s.created_by_user.name:"Unknown"),1),t("td",ve,f(new Date(s.created_at).toLocaleDateString()),1),t("td",ce,[t("div",fe,[A.value?(l(),y(T,{key:0,onClick:H=>S(s)},{default:r(()=>e[12]||(e[12]=[p("Edit",-1)])),_:2,__:[12]},1032,["onClick"])):v("",!0),N.value?(l(),y(P,{key:1,onClick:H=>z(s)},{default:r(()=>e[13]||(e[13]=[p("Delete",-1)])),_:2,__:[13]},1032,["onClick"])):v("",!0)])])]))),128))])])]))])])])]),o(M,{show:_.value,onClose:e[3]||(e[3]=s=>_.value=!1)},{default:r(()=>[t("div",ye,[e[18]||(e[18]=t("h2",{class:"text-lg font-medium text-gray-900"}," Create New Task Type ",-1)),t("div",xe,[t("div",_e,[o(b,{for:"name",value:"Name"}),o(Y,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:i.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>i.value.name=s),required:"",autofocus:""},null,8,["modelValue"]),d.value.name?(l(),y(C,{key:0,message:d.value.name[0],class:"mt-2"},null,8,["message"])):v("",!0)]),t("div",ge,[o(b,{for:"description",value:"Description"}),j(t("textarea",{id:"description",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm","onUpdate:modelValue":e[1]||(e[1]=s=>i.value.description=s),rows:"3"},null,512),[[I,i.value.description]]),d.value.description?(l(),y(C,{key:0,message:d.value.description[0],class:"mt-2"},null,8,["message"])):v("",!0)])]),t("div",ke,[o(E,{onClick:e[2]||(e[2]=s=>_.value=!1),class:"mr-2"},{default:r(()=>e[16]||(e[16]=[p(" Cancel ",-1)])),_:1,__:[16]}),o(T,{onClick:B},{default:r(()=>e[17]||(e[17]=[p(" Create ",-1)])),_:1,__:[17]})])])]),_:1},8,["show"]),o(M,{show:g.value,onClose:e[7]||(e[7]=s=>g.value=!1)},{default:r(()=>[t("div",we,[e[21]||(e[21]=t("h2",{class:"text-lg font-medium text-gray-900"}," Edit Task Type ",-1)),t("div",he,[t("div",Te,[o(b,{for:"edit-name",value:"Name"}),o(Y,{id:"edit-name",type:"text",class:"mt-1 block w-full",modelValue:i.value.name,"onUpdate:modelValue":e[4]||(e[4]=s=>i.value.name=s),required:"",autofocus:""},null,8,["modelValue"]),d.value.name?(l(),y(C,{key:0,message:d.value.name[0],class:"mt-2"},null,8,["message"])):v("",!0)]),t("div",be,[o(b,{for:"edit-description",value:"Description"}),j(t("textarea",{id:"edit-description",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm","onUpdate:modelValue":e[5]||(e[5]=s=>i.value.description=s),rows:"3"},null,512),[[I,i.value.description]]),d.value.description?(l(),y(C,{key:0,message:d.value.description[0],class:"mt-2"},null,8,["message"])):v("",!0)])]),t("div",Ce,[o(E,{onClick:e[6]||(e[6]=s=>g.value=!1),class:"mr-2"},{default:r(()=>e[19]||(e[19]=[p(" Cancel ",-1)])),_:1,__:[19]}),o(T,{onClick:B},{default:r(()=>e[20]||(e[20]=[p(" Update ",-1)])),_:1,__:[20]})])])]),_:1},8,["show"]),o(M,{show:k.value,onClose:e[9]||(e[9]=s=>k.value=!1)},{default:r(()=>[t("div",De,[e[25]||(e[25]=t("h2",{class:"text-lg font-medium text-gray-900"}," Are you sure you want to delete this task type? ",-1)),e[26]||(e[26]=t("p",{class:"mt-1 text-sm text-gray-600"}," This action cannot be undone. If tasks are using this task type, the deletion will fail. ",-1)),w.value?(l(),u("div",$e,[e[22]||(e[22]=t("strong",null,"Task Type:",-1)),p(" "+f(w.value.name),1)])):v("",!0),n.value?(l(),u("div",Ve,f(n.value),1)):v("",!0),t("div",Ne,[o(E,{onClick:e[8]||(e[8]=s=>k.value=!1),class:"mr-2"},{default:r(()=>e[23]||(e[23]=[p(" Cancel ",-1)])),_:1,__:[23]}),o(P,{onClick:G},{default:r(()=>e[24]||(e[24]=[p(" Delete ",-1)])),_:1,__:[24]})])])]),_:1},8,["show"])]),_:1})],64))}};export{He as default};
