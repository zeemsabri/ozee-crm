import{c,r as f,e as g,f as k,a as u,o as n,b as o,d as m,m as C,u as _,F,l as A,v as w,x as M}from"./app-DbT8OS6U.js";import{u as T}from"./workflowStore-DZJsW282.js";import{S as x}from"./SelectDropdown-CHW2wT9H.js";import{P as U}from"./plus-Cqbd8Y22.js";import{T as N}from"./trash-2-TxAo_pPz.js";/* empty css                                                                       */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-CcTmroC8.js";const S={class:"space-y-4"},j={class:"flex items-center justify-between"},B={key:0,class:"mt-2 space-y-2"},D={class:"flex items-center gap-2"},K=["onUpdate:modelValue"],P={class:"text-right"},R=["onClick"],E={key:1,class:"text-center text-xs text-gray-500 py-4 border-2 border-dashed rounded-lg mt-2"},J={__name:"CreateRecordConfig",setup(L){const r=T(),s=c(()=>r.selectedStep),y=c(()=>r.automationSchema),p=c(()=>{var l;return((l=y.value)==null?void 0:l.models)||[]}),a=f([]),d=f(null),h=c(()=>{if(!d.value)return[];const l=p.value.find(e=>e.name===d.value);return l?l.columns.map(e=>({value:e,label:e})):[]}),b=()=>{a.value.push({selectedColumn:null,value:""})},V=l=>{a.value.splice(l,1)};return g(s,l=>{l&&l.step_config?(d.value=l.step_config.target_model||null,l.step_config.fields&&Array.isArray(l.step_config.fields)?a.value=l.step_config.fields.map(e=>({selectedColumn:e.field||null,value:e.value||""})):a.value=[]):(d.value=null,a.value=[])},{immediate:!0}),g([d,a],([l,e])=>{s.value&&((!s.value.step_config||typeof s.value.step_config!="object"||Array.isArray(s.value.step_config))&&(s.value.step_config={}),s.value.step_config.target_model=l,s.value.step_config.fields=e.filter(t=>t.selectedColumn).map(t=>({field:t.selectedColumn,value:t.value})))},{deep:!0}),k(()=>{Object.keys(r.automationSchema).length||r.fetchAutomationSchema()}),(l,e)=>(n(),u("div",S,[o("div",null,[e[1]||(e[1]=o("label",{class:"block text-xs font-medium text-gray-700"},"Target Model",-1)),m(x,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),options:p.value,valueKey:"name",labelKey:"name",placeholder:"Select a module...",class:"w-full mt-1"},null,8,["modelValue","options"])]),o("div",null,[o("div",j,[e[3]||(e[3]=o("label",{class:"text-xs font-medium text-gray-700"},"Fields to create",-1)),o("button",{onClick:b,class:"flex items-center gap-1 px-2 py-1 text-xs rounded-md bg-gray-100 hover:bg-gray-200"},[m(_(U),{class:"w-3 h-3"}),e[2]||(e[2]=C(" Add Field ",-1))])]),a.value.length>0?(n(),u("div",B,[(n(!0),u(F,null,A(a.value,(t,v)=>(n(),u("div",{key:v,class:"p-2 border rounded-md bg-gray-50/50 space-y-2"},[o("div",D,[m(x,{modelValue:t.selectedColumn,"onUpdate:modelValue":i=>t.selectedColumn=i,options:h.value,placeholder:"Select a field...",class:"w-full",disabled:!d.value},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),o("div",null,[w(o("input",{"onUpdate:modelValue":i=>t.value=i,type:"text",class:"w-full border rounded px-2 py-1 text-sm",placeholder:"Value"},null,8,K),[[M,t.value]])]),o("div",P,[o("button",{onClick:i=>V(v),class:"text-red-500 hover:text-red-700 p-1",title:"Remove Field"},[m(_(N),{class:"w-3 h-3"})],8,R)])]))),128))])):(n(),u("div",E," No fields defined. "))])]))}};export{J as default};
