import{a,o as r,b as o,c,i as p,g as y,a8 as B,t as w,d as n,u as h,j as F,C as U,r as A,D as W,f as Z,aT as G,e as X,h as q,w as x,X as J,F as I,l as K,m as S,p as Q}from"./app-CZiJFItQ.js";import{R as Y,_ as ee}from"./AuthenticatedLayout-5eicP0ec.js";import te from"./EmailFilters-CFgl4C45.js";import oe from"./EmailCategoryFilters-BvQb2mc-.js";import ie from"./EmailList-CPah12mB.js";import{_ as re,f as se,m as ae}from"./EmailDetailsContent-DE6Fsczl.js";import ne from"./ComposeEmailContent-DmGmL860.js";import le from"./CustomComposeEmailContent-i-8vew1c.js";import de from"./EmailActionContent-D2gV0Hzy.js";import me from"./ReceivedEmailActionContent-BtUp_vuK.js";import ce from"./CustomEmailApprovalContent-BOPMo8Wg.js";import{r as ue}from"./InformationCircleIcon-Dr5MRSUM.js";import{r as pe,b as fe}from"./NoticeboardModal-DfKygsts.js";import{a as ge,r as ve}from"./XCircleIcon-D4SX5alb.js";import{r as be,a as he}from"./PaperAirplaneIcon--5na2jbK.js";import{r as we}from"./ListBulletIcon-DJCUT80C.js";import"./PrimaryButton-2iaxY83O.js";import"./Modal-akPUGSqW.js";import"./InputLabel-DjoiOvom.js";import"./InputError-BBwwpFKS.js";import"./SecondaryButton-DrE06oah.js";import"./index-oewZdsII.js";import"./BaseFormModal-C31yazTC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TextInput-Cne22vOS.js";import"./SelectDropdown-CCQ94vKn.js";/* empty css                                                                       */import"./debounce-C-hnF4Z3.js";import"./ApplicationLogo-Cljoy5r1.js";import"./MultiSelectDropdown-BJfQuDgP.js";import"./createLucideIcon-77yR4NzK.js";import"./plus-CRvmTldv.js";import"./DangerButton-BTftXjdU.js";import"./moment-BLMuvzoS.js";import"./ChevronDownIcon-B08uKl_N.js";import"./EmailAttachmentsList-BFqUqEzu.js";import"./TrashIcon-DmVXhA-I.js";import"./TaskCreationForm-CucsGjdA.js";import"./CustomMultiSelect-DAk9TvPj.js";import"./RepeatableDynamicField-Dx0bvqFx.js";import"./vuedraggable.umd-3MpZkuYd.js";import"./EmailEditor-RAcMGwG3.js";import"./EmailEditor.vue_vue_type_style_index_0_lang-0CH_UzLK.js";import"./useEmailSignature-eq-lWmLI.js";import"./useEmailTemplate-CzadihGM.js";function xe(l,e){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"})])}function ye(l,e){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})])}function _e(l,e){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function ke(l,e){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function Ce(l,e){return r(),a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"})])}const Ee={class:"flex items-center"},$e={class:"flex-1"},je={key:0,class:"font-bold"},Ae={class:"text-sm"},Ie={__name:"Notification",props:{notification:Object},emits:["close"],setup(l,{emit:e}){const m=l,f=c(()=>{var d;switch((d=m.notification)==null?void 0:d.type){case"success":return"bg-green-100 text-green-700 border-green-200";case"error":return"bg-red-100 text-red-700 border-red-200";case"warning":return"bg-yellow-100 text-yellow-700 border-yellow-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}}),g=c(()=>{var d;switch((d=m.notification)==null?void 0:d.type){case"success":return ve;case"error":return ge;case"warning":return pe;default:return ue}});return(b,d)=>l.notification&&l.notification.message?(r(),a("div",{key:0,class:F(["fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 mx-auto mt-4 max-w-sm rounded-md border p-4 shadow-lg transition-all duration-300 ease-out z-[9999]",f.value]),role:"alert","aria-live":"polite"},[o("div",Ee,[(r(),y(B(g.value),{class:"h-6 w-6 mr-3 flex-shrink-0"})),o("div",$e,[l.notification.title?(r(),a("h4",je,w(l.notification.title),1)):p("",!0),o("p",Ae,w(l.notification.message),1)]),o("button",{onClick:d[0]||(d[0]=C=>b.$emit("close")),class:"ml-auto -mr-1.5 p-1 rounded-md hover:bg-opacity-50","aria-label":"Close notification"},[n(h(fe),{class:"h-5 w-5"})])])],2)):p("",!0)}},Se={class:"flex justify-between items-center"},Be={class:"flex items-center gap-2"},Fe={class:"py-12"},Re={class:"max-w-8xl mx-auto sm:px-6 lg:px-8 h-[calc(100vh-200px)]"},De={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg h-full flex"},Me={key:0,class:"w-64 p-4 border-r border-gray-200 overflow-y-auto transform"},Ne={class:"flex-1 overflow-y-auto"},Pe={class:"flex items-center justify-start p-6 space-x-4"},He=["onClick"],Te={key:0,class:"ml-2 px-2 py-0.5 text-xs font-semibold rounded-full bg-white text-gray-800"},Ve={class:"hidden sm:inline"},Le={class:"p-6"},Oe={key:0},ze={key:1},Ue={key:2},We={key:3},Ze={key:4},Ge={key:5},Tt={__name:"Index",setup(l){const e=U({sidebar:{show:!1,title:"",mode:null,loading:!1,data:null},filters:{type:"new",status:"",startDate:"",endDate:"",search:"",projectId:null,senderId:"",categoryIds:[]},emails:[],loadingEmails:!1,emailError:null,pagination:{},counts:{new:0,"waiting-approval":0,sent:0,received:0,all:0}}),m=A(!1),f=A(null),{canDo:g}=W();c(()=>g("view_emails").value),c(()=>g("approve_emails").value);const b=c(()=>g("compose_emails").value),d=c(()=>g("create_custom_emails").value),C=c(()=>[{type:"new",label:"New Emails",icon:Ce},{type:"waiting-approval",label:"Waiting Approval",icon:ke},{type:"sent",label:"Sent",icon:be},{type:"received",label:"Received",icon:he},{type:"all",label:"All Emails",icon:we}]),R=c(()=>{var t;return e.sidebar.mode==="view-email"?((t=e.sidebar.data)==null?void 0:t.subject)||"Email Details":e.sidebar.mode==="compose"?"Compose New Email":e.sidebar.mode==="edit"?"Edit & Approve Template Email":e.sidebar.mode==="custom-edit"?"Edit & Approve Custom Email":e.sidebar.mode==="reject"?"Reject Email":e.sidebar.mode==="received-edit"?"Approve Received Email":"Inbox"}),_=async()=>{try{const t=await Q.get("/api/inbox/counts");e.counts={...e.counts,"waiting-approval":t.data["waiting-approval"],received:t.data.received}}catch(t){console.error("Failed to fetch email counts:",t)}},D=()=>{e.sidebar.show=!0,e.sidebar.title="Compose New Email",e.sidebar.mode="compose",e.sidebar.data=null},M=async()=>{e.sidebar.show=!0,e.sidebar.title="Compose Custom Email",e.sidebar.mode="custom-compose",e.sidebar.data=null},N=async t=>{e.sidebar.loading=!0,e.sidebar.show=!0,e.sidebar.title="Email Details",e.sidebar.mode="view-email",e.sidebar.data=t;try{await ae(t.id)}catch(i){console.error("Failed to mark email as read:",i)}finally{e.sidebar.loading=!1,v(),_()}},v=async(t=1)=>{e.loadingEmails=!0,e.emailError=null;try{const i={...e.filters,category_ids:e.filters.categoryIds},s=await se(i,t);e.emails=s.data,e.pagination={currentPage:s.current_page,lastPage:s.last_page,total:s.total},e.counts[e.filters.type]=s.total}catch(i){console.error("Error fetching emails:",i),e.emailError="Failed to load emails. Please try again."}finally{e.loadingEmails=!1}},P=t=>{v(t)},H=t=>{Object.assign(e.filters,t)},T=t=>{e.filters.type=t,t==="all"&&(e.filters.status="",e.filters.startDate="",e.filters.endDate="",e.filters.search="",e.filters.projectId=null,e.filters.senderId=""),t!=="waiting-approval"&&t!=="received"&&(e.counts[t]=0)},V=t=>{e.filters.categoryIds=t},L=t=>{f.value=t,setTimeout(()=>{f.value=null},5e3)};Z(()=>{G().fetchGlobalPermissions(),_()});const O=t=>{e.sidebar.show=!0,e.sidebar.data=t,t.type==="received"&&(t.status==="pending_approval_received"||t.status==="received")?(e.sidebar.mode="received-edit",e.sidebar.title="Approve Received Email"):t.template_id?(e.sidebar.mode="edit",e.sidebar.title="Edit & Approve Template Email"):(e.sidebar.mode="custom-edit",e.sidebar.title="Edit & Approve Custom Email")},z=t=>{e.sidebar.show=!0,e.sidebar.title="Reject Email",e.sidebar.mode="reject",e.sidebar.data=t},u=()=>{e.sidebar.show=!1,v(),_()};let E=null;return X(()=>e.filters,()=>{clearTimeout(E),E=setTimeout(()=>{v(1)},500)},{deep:!0,immediate:!0}),(t,i)=>(r(),a(I,null,[n(h(q),{title:"Inbox"}),n(ee,null,{header:x(()=>[o("div",Se,[i[8]||(i[8]=o("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Inbox ",-1)),o("div",Be,[b.value?(r(),a("button",{key:0,onClick:D,class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-25 transition"},i[6]||(i[6]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),S(" Compose Email ",-1)]))):p("",!0),d.value?(r(),a("button",{key:1,onClick:M,class:"inline-flex items-center px-4 py-2 bg-emerald-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:opacity-25 transition"},i[7]||(i[7]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),S(" Custom Emails ",-1)]))):p("",!0)])])]),default:x(()=>[o("div",Fe,[o("div",Re,[o("div",De,[n(J,{"enter-active-class":"transition-all duration-300 ease-out","leave-active-class":"transition-all duration-300 ease-in","enter-from-class":"-translate-x-full opacity-0","leave-to-class":"-translate-x-full opacity-0"},{default:x(()=>[m.value?(r(),a("div",Me,[i[9]||(i[9]=o("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Advanced Filters",-1)),n(te,{"initial-filters":e.filters,onChange:H},null,8,["initial-filters"])])):p("",!0)]),_:1}),o("div",Ne,[o("div",Pe,[(r(!0),a(I,null,K(C.value,s=>(r(),a("button",{key:s.type,onClick:k=>T(s.type),class:F({"px-4 py-2 rounded-md font-medium text-sm transition-colors flex items-center space-x-2":!0,"text-white bg-indigo-600 hover:bg-indigo-700":e.filters.type===s.type,"text-gray-700 bg-white border border-gray-300 hover:bg-gray-100":e.filters.type!==s.type})},[(r(),y(B(s.icon),{class:"h-5 w-5"})),o("span",null,w(s.label),1),e.counts[s.type]>0?(r(),a("span",Te,w(e.counts[s.type]),1)):p("",!0)],10,He))),128)),o("button",{onClick:i[0]||(i[0]=s=>m.value=!m.value),class:"px-4 py-2 rounded-md font-medium text-sm text-gray-700 bg-white border border-gray-300 hover:bg-gray-100 transition-colors flex items-center space-x-2"},[n(h(xe),{class:"h-5 w-5"}),o("span",Ve,w(m.value?"Hide Filters":"Show Filters"),1),m.value?(r(),y(h(ye),{key:1,class:"h-4 w-4"})):(r(),y(h(_e),{key:0,class:"h-4 w-4"}))]),o("button",{onClick:i[1]||(i[1]=s=>v(1)),class:"px-4 py-2 rounded-md font-medium text-sm text-gray-700 bg-white border border-gray-300 hover:bg-gray-100 transition-colors flex items-center space-x-2"},i[10]||(i[10]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),o("span",{class:"hidden sm:inline"},"Refresh",-1)]))]),n(oe,{"selected-categories":e.filters.categoryIds,filters:e.filters,"onUpdate:selectedCategories":V},null,8,["selected-categories","filters"]),o("div",Le,[n(ie,{emails:e.emails,loading:e.loadingEmails,error:e.emailError,pagination:e.pagination,onViewEmail:N,onChangePage:P,onRefresh:v,onShowNotification:L},null,8,["emails","loading","error","pagination"])])]),n(Y,{show:e.sidebar.show,title:R.value,onClose:i[4]||(i[4]=s=>e.sidebar.show=!1),loading:e.sidebar.loading},{content:x(()=>{var s,k,$,j;return[e.sidebar.mode==="view-email"?(r(),a("div",Oe,[n(re,{email:e.sidebar.data,"can-approve-emails":(s=e.sidebar.data)==null?void 0:s.can_approve,onEdit:O,onReject:z,onDeleted:u,onUpdated:u},null,8,["email","can-approve-emails"])])):e.sidebar.mode==="compose"?(r(),a("div",ze,[n(ne,{"project-id":(j=($=(k=e.sidebar.data)==null?void 0:k.conversation)==null?void 0:$.project)==null?void 0:j.id,onSubmitted:u},null,8,["project-id"])])):e.sidebar.mode==="edit"||e.sidebar.mode==="reject"?(r(),a("div",Ue,[n(de,{email:e.sidebar.data,mode:e.sidebar.mode,onSubmitted:u},null,8,["email","mode"])])):e.sidebar.mode==="received-edit"?(r(),a("div",We,[n(me,{email:e.sidebar.data,onSubmitted:u,onError:i[2]||(i[2]=()=>console.log("Error from received-edit"))},null,8,["email"])])):e.sidebar.mode==="custom-edit"?(r(),a("div",Ze,[n(ce,{email:e.sidebar.data,onSubmitted:u,onError:()=>{}},null,8,["email"])])):e.sidebar.mode==="custom-compose"?(r(),a("div",Ge,[n(le,{"project-id":null,"user-project-role":{},onSubmitted:i[3]||(i[3]=()=>{u()}),onError:()=>{}})])):p("",!0)]}),_:1},8,["show","title","loading"])])])]),n(Ie,{notification:f.value,onClose:i[5]||(i[5]=s=>f.value=null)},null,8,["notification"])]),_:1})],64))}};export{Tt as default};
