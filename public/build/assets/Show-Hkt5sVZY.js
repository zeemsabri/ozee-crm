import{r as u,w as zt,c as nt,o as a,a as m,b as t,h as l,g as c,e as r,f as j,j as H,u as Oe,l as Qt,t as n,k as v,n as re,B as Yt,z as W,C as Jt,L as Kt,M as Xt,p as M,D as Zt,s as Ze,A as es,N as ts,q as ss,F as T,i as N,v as z,d as Ve}from"./app-DZKMFnH5.js";import{_ as os}from"./AuthenticatedLayout-C19xpnYd.js";import{P as V}from"./PrimaryButton-Ds_WRDSR.js";import{a as S,_ as q}from"./SecondaryButton-BU5WXo-H.js";import{_ as as}from"./ProjectForm-BftriDwA.js";import{_ as ls}from"./NotesModal-UFI2WWuj.js";import{_ as P,a as _e}from"./TextInput-CrL1XZVZ.js";import{_ as U}from"./InputError-Tcq58wKD.js";import{s as rt}from"./vue-multiselect-CDbkj3mT.js";import{R as lt}from"./RichTextEditor-BeNtwr6A.js";import{_ as ns}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BKvC_8Gv.js";import"./Checkbox-DeHRkrNa.js";const rs={class:"p-6"},is={class:"mt-6 space-y-6"},ds={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},us={class:"flex items-center"},cs={key:0,class:"text-sm text-red-600"},vs={class:"flex justify-end mt-6 space-x-3"},ms={__name:"MeetingModal",props:{show:{type:Boolean,default:!1},projectId:{type:Number,required:!0},projectUsers:{type:Array,default:()=>[]}},emits:["close","saved"],setup(We,{emit:f}){const Q=We,be=f,k=u({summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0}),A=u({}),X=u(!1),Y=u("");zt(()=>Q.show,y=>{y||He()});const Se=y=>new Date(y).toISOString().slice(0,16),d=()=>{const y=new Date,g=new Date(y.getTime()+60*60*1e3),_=new Date(y.getTime()+2*60*60*1e3);k.value.start_datetime=Se(g),k.value.end_datetime=Se(_)},He=()=>{k.value={summary:"",description:"",start_datetime:"",end_datetime:"",attendee_user_ids:[],location:"",with_google_meet:!0},d(),A.value={},Y.value="",X.value=!1};d();const Pe=y=>y?y.replace("T"," ")+":00":"",we=async()=>{X.value=!0,A.value={},Y.value="";try{const y={...k.value};y.start_datetime=Pe(y.start_datetime),y.end_datetime=Pe(y.end_datetime);const g=await window.axios.post(`/api/projects/${Q.projectId}/meetings`,y);be("saved",g.data),be("close")}catch(y){X.value=!1,y.response?y.response.status===422?A.value=y.response.data.errors:Y.value=y.response.data.message||"An error occurred while creating the meeting.":(Y.value="An unexpected error occurred. Please try again.",console.error("Error creating meeting:",y))}},J=()=>{be("close")};return(y,g)=>(a(),nt(q,{show:We.show,onClose:J,"max-width":"2xl"},{default:m(()=>[t("div",rs,[g[11]||(g[11]=t("h2",{class:"text-lg font-medium text-gray-900"}," Schedule a Meeting ",-1)),t("div",is,[t("div",null,[r(P,{for:"summary",value:"Meeting Title"}),r(_e,{id:"summary",modelValue:k.value.summary,"onUpdate:modelValue":g[0]||(g[0]=_=>k.value.summary=_),type:"text",class:"mt-1 block w-full",placeholder:"Project Status Meeting",required:""},null,8,["modelValue"]),r(U,{message:A.value.summary?A.value.summary[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[r(P,{for:"description",value:"Description"}),j(t("textarea",{id:"description","onUpdate:modelValue":g[1]||(g[1]=_=>k.value.description=_),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Meeting agenda and details..."},null,512),[[H,k.value.description]]),r(U,{message:A.value.description?A.value.description[0]:"",class:"mt-2"},null,8,["message"])]),t("div",ds,[t("div",null,[r(P,{for:"start_datetime",value:"Start Date & Time"}),r(_e,{id:"start_datetime",modelValue:k.value.start_datetime,"onUpdate:modelValue":g[2]||(g[2]=_=>k.value.start_datetime=_),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),r(U,{message:A.value.start_datetime?A.value.start_datetime[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[r(P,{for:"end_datetime",value:"End Date & Time"}),r(_e,{id:"end_datetime",modelValue:k.value.end_datetime,"onUpdate:modelValue":g[3]||(g[3]=_=>k.value.end_datetime=_),type:"datetime-local",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),r(U,{message:A.value.end_datetime?A.value.end_datetime[0]:"",class:"mt-2"},null,8,["message"])])]),t("div",null,[r(P,{for:"attendees",value:"Attendees"}),r(Oe(rt),{id:"attendees",modelValue:k.value.attendee_user_ids,"onUpdate:modelValue":g[4]||(g[4]=_=>k.value.attendee_user_ids=_),options:Q.projectUsers.map(_=>_.id),"custom-label":_=>{const Z=Q.projectUsers.find(R=>R.id===_);return Z?`${Z.name} (${Z.email})`:""},placeholder:"Select attendees",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,"show-labels":!1,class:"mt-1"},null,8,["modelValue","options","custom-label"]),g[7]||(g[7]=t("p",{class:"mt-1 text-sm text-gray-500"}," Select project members to invite to this meeting ",-1)),r(U,{message:A.value.attendee_user_ids?A.value.attendee_user_ids[0]:"",class:"mt-2"},null,8,["message"])]),t("div",null,[r(P,{for:"location",value:"Location (Optional)"}),r(_e,{id:"location",modelValue:k.value.location,"onUpdate:modelValue":g[5]||(g[5]=_=>k.value.location=_),type:"text",class:"mt-1 block w-full",placeholder:"Office, Conference Room, etc."},null,8,["modelValue"]),r(U,{message:A.value.location?A.value.location[0]:"",class:"mt-2"},null,8,["message"])]),t("div",us,[j(t("input",{id:"with_google_meet","onUpdate:modelValue":g[6]||(g[6]=_=>k.value.with_google_meet=_),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[Qt,k.value.with_google_meet]]),g[8]||(g[8]=t("label",{for:"with_google_meet",class:"ml-2 block text-sm text-gray-900"}," Create Google Meet video conference ",-1))]),Y.value?(a(),l("div",cs,n(Y.value),1)):c("",!0),t("div",vs,[r(S,{onClick:J},{default:m(()=>g[9]||(g[9]=[v(" Cancel ")])),_:1,__:[9]}),r(V,{onClick:we,class:re({"opacity-25":X.value}),disabled:X.value},{default:m(()=>g[10]||(g[10]=[v(" Schedule Meeting ")])),_:1,__:[10]},8,["class","disabled"])])])])]),_:1},8,["show"]))}},ps={class:"py-8 max-w-full mx-auto px-4 sm:px-6 lg:px-8"},gs={key:0,class:"text-center text-gray-600 text-lg animate-pulse"},fs={key:1,class:"text-center text-red-600 text-lg font-medium"},ys={key:2,class:"space-y-8"},xs={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},_s={class:"flex justify-between items-center mb-4"},bs={key:0,class:"flex gap-3"},ws={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ks={class:"text-2xl font-bold text-gray-900 tracking-tight mb-2"},hs={class:"text-gray-600 text-base"},js={class:"space-y-3 text-sm text-gray-700"},Cs={class:"flex space-x-4 mt-2"},Ds=["href"],Ms=["href"],Es=["href"],$s={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow mb-6"},Ts={key:0,class:"text-sm text-gray-500"},As={key:1,class:"text-sm text-gray-500"},Ns={key:2,class:"space-y-3"},Vs={class:"flex justify-between items-start"},Ss={class:"font-medium text-gray-900"},Ps={class:"text-sm text-gray-600"},Us={key:0,class:"text-sm text-gray-600 mt-1"},Rs={class:"flex space-x-2"},Fs=["href"],Ls=["href"],Bs=["onClick"],Is={class:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6"},Os={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Ws={class:"text-2xl font-bold text-indigo-600"},Hs={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},qs={class:"text-2xl font-bold text-indigo-600"},Gs={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},zs={class:"text-2xl font-bold text-indigo-600"},Qs={class:"bg-white p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Ys={class:"text-2xl font-bold text-indigo-600"},Js={class:"grid grid-cols-3 sm:grid-cols-3 gap-4 mb-6"},Ks={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Xs={class:"space-y-3 text-sm text-gray-700"},Zs={key:0},eo={class:"mt-2 space-y-2"},to=["onClick"],so={class:"font-medium text-gray-800"},oo={class:"text-indigo-600"},ao={class:"text-gray-500"},lo={key:0},no={key:1},ro={key:0,class:"p-3 bg-white"},io={class:"text-sm text-gray-700"},uo={key:0,class:"mt-2"},co={class:"list-disc ml-5 mt-1 text-xs text-gray-600"},vo={key:1,class:"text-gray-400"},mo={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},po={key:0,class:"space-y-3 text-sm text-gray-700"},go={class:"text-gray-900"},fo={key:1,class:"text-gray-400 text-sm"},yo={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},xo={key:0,class:"space-y-3 text-sm text-gray-700"},_o={class:"text-gray-900"},bo={key:1,class:"text-gray-400 text-sm"},wo={class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},ko={class:"flex justify-between items-center mb-4"},ho={class:"flex gap-2"},jo={key:0},Co={key:1},Do={class:"mb-6 overflow-x-auto"},Mo={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Eo={key:1,class:"text-center py-4"},$o={key:2,class:"relative py-8"},To={class:"relative flex justify-between"},Ao={key:0,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},No={key:1,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Vo={key:2,class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},So={key:3,class:"w-2 h-2 bg-white rounded-full"},Po={class:"absolute -top-8 transform -translate-x-1/2 left-1/2 w-32"},Uo=["title"],Ro={class:"absolute top-8 transform -translate-x-1/2 left-1/2"},Fo={class:"text-xs text-gray-500 whitespace-nowrap"},Lo={class:"mb-6 bg-gray-50 p-4 rounded-lg"},Bo={class:"flex flex-wrap items-center gap-4"},Io={class:"flex-1 min-w-[200px]"},Oo={class:"flex-1 min-w-[200px]"},Wo=["value"],Ho={class:"flex-1 min-w-[200px]"},qo=["value"],Go={class:"flex-1 min-w-[200px]"},zo=["value"],Qo={key:0,class:"mt-3 text-sm text-gray-600"},Yo={key:0,class:"text-red-600 font-medium"},Jo={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},Ko={key:1,class:"text-center py-4"},Xo={class:"text-red-600 text-sm font-medium"},Zo={key:2,class:"overflow-x-auto"},ea={class:"min-w-full divide-y divide-gray-200"},ta={class:"bg-white divide-y divide-gray-200"},sa={class:"px-4 py-3 text-sm text-gray-900"},oa={class:"px-4 py-3 text-sm text-gray-700"},aa={class:"px-4 py-3 text-sm text-gray-700"},la={class:"px-4 py-3 text-sm text-gray-700"},na={class:"px-4 py-3 text-sm text-gray-700"},ra={class:"px-4 py-3 text-right"},ia={class:"flex justify-end space-x-2"},da=["onClick"],ua=["onClick"],ca=["onClick"],va=["onClick"],ma={key:3,class:"text-center py-4"},pa={key:0,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},ga={class:"flex justify-between items-center mb-4"},fa={key:0,class:"flex gap-3"},ya={key:1,class:"mt-2 bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded relative",role:"alert"},xa={class:"block sm:inline"},_a={key:0,class:"text-center text-gray-600 text-sm animate-pulse py-4"},ba={key:1,class:"text-center text-red-600 text-sm font-medium py-4"},wa={key:2,class:"overflow-x-auto"},ka={class:"min-w-full divide-y divide-gray-200"},ha={class:"bg-white divide-y divide-gray-200"},ja={class:"px-4 py-3 text-sm text-gray-900"},Ca={class:"px-4 py-3 text-sm text-gray-700"},Da={class:"px-4 py-3 text-sm text-gray-700"},Ma={class:"px-4 py-3 text-sm text-gray-700"},Ea={class:"px-4 py-3 text-right"},$a={key:3,class:"text-gray-400 text-sm"},Ta={key:1,class:"bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow"},Aa={class:"flex justify-between items-center mb-4"},Na={key:0},Va={key:0,class:"space-y-4"},Sa={class:"flex justify-between"},Pa={class:"flex-grow"},Ua={key:0,class:"text-xs text-red-400 block mt-1"},Ra={class:"flex items-center mt-1"},Fa={class:"text-xs text-gray-500"},La={key:0,class:"ml-2 px-2 py-0.5 bg-indigo-100 text-indigo-800 text-xs rounded-full"},Ba={key:0},Ia={key:1,class:"text-gray-400 text-sm"},Oa={class:"p-6"},Wa={class:"flex justify-between items-center mb-4"},Ha={key:0,class:"space-y-4"},qa={class:"border-b pb-4"},Ga={class:"text-xl font-medium text-gray-900 mb-2"},za={class:"grid grid-cols-2 gap-4 text-sm"},Qa={class:"text-gray-600"},Ya={class:"text-gray-900"},Ja={class:"text-gray-600 mt-1"},Ka={class:"text-gray-600"},Xa={class:"text-gray-900"},Za={class:"prose max-w-none"},el=["innerHTML"],tl={key:0,class:"mt-4 p-4 bg-red-50 rounded-md"},sl={class:"text-red-700"},ol={key:1,class:"mt-4 text-sm text-gray-600"},al={key:0},ll={key:2,class:"mt-6 flex justify-end space-x-2"},nl={class:"p-6"},rl={class:"flex justify-between items-center mb-4"},il={key:0,class:"space-y-4"},dl={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},ul={class:"block sm:inline"},cl={class:"mb-4"},vl={class:"mb-6"},ml={class:"mt-6 flex justify-end space-x-2"},pl={class:"p-6"},gl={class:"flex justify-between items-center mb-4"},fl={key:0,class:"space-y-4"},yl={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},xl={class:"block sm:inline"},_l={class:"mb-6"},bl={class:"mt-6 flex justify-end space-x-2"},wl={class:"p-6"},kl={class:"flex justify-between items-center mb-4"},hl={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert"},jl={class:"block sm:inline"},Cl={class:"mb-4"},Dl={class:"multiselect__tag"},Ml=["onClick"],El={class:"mb-4"},$l={class:"mb-6"},Tl={class:"flex items-center justify-end"},Al={class:"p-6"},Nl={class:"flex justify-between items-center mb-4"},Vl={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},Sl={class:"text-sm text-gray-700"},Pl={class:"text-xs text-gray-500 mt-1"},Ul={key:1,class:"mb-4"},Rl={key:0,class:"text-center py-4"},Fl={key:1,class:"space-y-3 max-h-60 overflow-y-auto"},Ll={class:"text-sm text-gray-700"},Bl={class:"text-xs text-gray-500 mt-1"},Il={key:2,class:"text-center py-3"},Ol={key:2,class:"mb-4"},Wl={key:0,class:"mt-2 text-sm text-red-600"},Hl={key:3,class:"mt-6 flex justify-end"},ql={class:"p-6"},Gl={class:"flex justify-between items-center mb-4"},zl={class:"text-lg font-semibold text-gray-900"},Ql={key:0,class:"mt-1 text-sm text-red-600"},Yl={key:0,class:"mt-1 text-sm text-red-600"},Jl={key:0,class:"mt-1 text-sm text-red-600"},Kl={key:0,class:"mt-1 text-sm text-red-600"},Xl=["value"],Zl={key:0,class:"mt-1 text-sm text-red-600"},en={key:0,class:"text-sm text-gray-500"},tn=["value"],sn={key:2,class:"mt-1 text-sm text-red-600"},on={key:0,class:"text-sm text-gray-500"},an=["value"],ln={key:2,class:"mt-1 text-sm text-red-600"},nn={class:"mt-6 flex justify-end space-x-3"},rn={class:"p-6"},dn={class:"flex justify-between items-center mb-4"},un={key:0,class:"mt-1 text-sm text-red-600"},cn={key:0,class:"mt-1 text-sm text-red-600"},vn={key:0,class:"mt-1 text-sm text-red-600"},mn={key:0,class:"mt-1 text-sm text-red-600"},pn={class:"mt-6 flex justify-end space-x-3"},gn={class:"p-6"},fn={class:"flex justify-between items-center mb-4"},yn={key:0,class:"mb-4 p-3 bg-gray-100 rounded-md"},xn={class:"text-sm font-medium text-gray-900"},_n={class:"text-xs text-gray-500 mt-1"},bn={class:"mb-4"},wn={key:0,class:"mt-2 text-sm text-red-600"},kn={class:"mt-6 flex justify-end"},hn={__name:"Show",setup(We){const f=Yt(),Q=W().props.id,{permissions:be,loading:k,error:A}=Jt(),{permissions:X,loading:Y,error:Se}=Kt(Q),d=u({}),He=u([]),Pe=u([]),we=u(!0),J=u(""),y=u(!1),g=u(!1),_=u(!1),Z=u(!1),R=u(null),ie=u(""),ee=u(""),ke=u([]),he=u(!1),qe=u([]),Ge=u(!1),Ue=u(null),it=()=>{g.value=!0},dt=async o=>{R.value=o,ie.value="",ee.value="",ke.value=[],he.value=!0,_.value=!0;try{const e=await window.axios.get(`/api/projects/${d.value.id}/notes/${o.id}/replies`);e.data.success?ke.value=e.data.replies:console.error("Failed to fetch replies:",e.data.message)}catch(e){console.error("Error fetching replies:",e)}finally{he.value=!1}},ut=async()=>{var o,e;if(!R.value||!ie.value.trim()){ee.value="Reply content is required";return}ee.value="";try{const s=await window.axios.post(`/api/projects/${d.value.id}/notes/${R.value.id}/reply`,{content:ie.value});if(s.data.success){ie.value="";try{he.value=!0;const i=await window.axios.get(`/api/projects/${d.value.id}/notes/${R.value.id}/replies`);i.data.success&&(ke.value=i.data.replies)}catch(i){console.error("Error fetching updated replies:",i)}finally{he.value=!1}await Fe()}else ee.value=s.data.message||"Failed to send reply"}catch(s){console.error("Error sending reply:",s),ee.value=((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||"An error occurred while sending the reply"}},ct=[{value:"active",label:"Active"},{value:"completed",label:"Completed"},{value:"on_hold",label:"On Hold"},{value:"archived",label:"Archived"}],vt=[{value:"Website Designing",label:"Website Designing"},{value:"SEO",label:"SEO"},{value:"Social Media",label:"Social Media"},{value:"Content Writing",label:"Content Writing"},{value:"Graphic Design",label:"Graphic Design"}],mt=[{value:"UpWork",label:"UpWork"},{value:"Direct",label:"Direct Client"},{value:"Wix Marketplace",label:"Wix Marketplace"},{value:"Referral",label:"Referral"}],pt=[{value:"Primary",label:"Primary"},{value:"Accountant",label:"Accountant"},{value:"Other",label:"Other"}],gt=[{value:"Manager",label:"Manager"},{value:"Developer",label:"Developer"},{value:"QA",label:"QA"},{value:"Other",label:"Other"}],ft=[{value:"one_off",label:"One-Off"},{value:"monthly",label:"Monthly"}],w=Xt(d),et=M(()=>!!w.value),tt=M(()=>{if(!w.value)return!1;const o=w.value.name,e=w.value.slug;return o==="Manager"||o==="Project Manager"||e==="manager"||e==="project-manager"}),{canDo:je,canView:te}=Zt(Q),se=M(()=>f.value?f.value.role_data&&f.value.role_data.slug==="super-admin"||f.value.role==="super_admin"||f.value.role==="super-admin":!1);M(()=>f.value?f.value.role_data&&f.value.role_data.slug==="manager"||f.value.role==="manager"||f.value.role==="manager-role"||f.value.role==="manager_role"||tt.value:!1),M(()=>!f.value||et.value&&!tt.value?!1:f.value.role_data&&f.value.role_data.slug==="employee"||f.value.role==="employee"||f.value.role==="employee-role"),M(()=>!f.value||et.value?!1:f.value.role_data&&f.value.role_data.slug==="contractor"||f.value.role==="contractor"||f.value.role==="contractor-role");const Re=M(()=>{console.log("userProjectRole in canManageProjects:",w.value);const o=w.value&&w.value.permissions&&w.value.permissions.some(D=>D.slug==="manage_projects");console.log("Has project-specific manage_projects permission:",o);const e=f.value&&f.value.global_permissions&&f.value.global_permissions.some(D=>D.slug==="manage_projects");console.log("Has global manage_projects permission:",e);const s=f.value&&f.value.role&&f.value.role.permissions&&f.value.role.permissions.some(D=>D.slug==="manage_projects");console.log("Has role manage_projects permission:",s);const i=je("manage_projects",w).value;console.log("canDo result for manage_projects:",i);const p=i||se.value;return console.log("Final canManageProjects result:",p),p}),st=M(()=>te("project_financial",w).value||se.value),yt=M(()=>te("project_transactions",w).value||se.value),xt=M(()=>te("client_contacts",w).value||se.value),_t=M(()=>te("client_financial",w).value||se.value);M(()=>te("users",w).value||se.value);const bt=M(()=>te("emails",w).value||!1),wt=M(()=>je("compose_emails",w).value||!1),kt=M(()=>je("approve_emails",w).value||!1),ot=M(()=>te("project_notes",w).value||!1),at=M(()=>je("project_notes",w).value||!1),Fe=async()=>{we.value=!0,J.value="";try{const o=W().props.id;console.log("Fetching project data for ID:",o);const e=await window.axios.get(`/api/projects/${o}/sections/basic`);console.log("Basic project data received:",e.data),d.value=e.data;try{const s=await window.axios.get(`/api/projects/${o}/sections/clients-users`);if(console.log("Clients and users data received:",s.data),s.data.clients&&(d.value.clients=s.data.clients),s.data.users){if(d.value.users=s.data.users,console.log("Project users:",d.value.users.length),d.value.users.length>0){const i=d.value.users[0];console.log("First user structure:",{id:i.id,name:i.name,hasPivot:!!i.pivot,pivotData:i.pivot?{hasRoleId:!!i.pivot.role_id,hasRoleData:!!i.pivot.role_data,roleDataStructure:i.pivot.role_data}:"No pivot data"});const p=d.value.users.find(D=>D.id===f.value.id);console.log("Current user in project:",p?{name:p.name,hasPivot:!!p.pivot,pivotData:p.pivot?{hasRoleId:!!p.pivot.role_id,hasRoleData:!!p.pivot.role_data,roleDataStructure:p.pivot.role_data}:"No pivot data"}:"Not found")}}else console.log("No users array in project data")}catch(s){console.error("Error fetching clients and users:",s)}if(st.value)try{const s=await window.axios.get(`/api/projects/${o}/sections/services-payment`);console.log("Financial data received:",s.data),d.value.services=s.data.services,d.value.service_details=s.data.service_details,d.value.total_amount=s.data.total_amount,d.value.payment_type=s.data.payment_type}catch(s){console.error("Error fetching financial information:",s)}if(yt.value)try{const s=await window.axios.get(`/api/projects/${o}/sections/transactions`);console.log("Transactions data received:",s.data),d.value.transactions=s.data}catch(s){console.error("Error fetching transactions:",s)}try{const s=await window.axios.get(`/api/projects/${o}/sections/documents`);console.log("Documents data received:",s.data),d.value.documents=s.data}catch(s){console.error("Error fetching documents:",s)}if(_t.value)try{const s=await window.axios.get(`/api/projects/${o}/contract-details`);console.log("Contract details received:",s.data),d.value.contract_details=s.data}catch(s){console.error("Error fetching contract details:",s)}try{const s=await window.axios.get(`/api/projects/${o}/sections/notes`);console.log("Notes data received:",s.data),d.value.notes=s.data}catch(s){console.error("Error fetching notes:",s)}if(console.log("Project value after assignment:",d.value),console.log("userProjectRole after project set:",w.value),Re.value){console.log("User can manage projects, fetching additional data");const s=await window.axios.get("/api/clients");He.value=s.data;const i=await window.axios.get("/api/users");Pe.value=i.data.filter(p=>p.role==="contractor")}else console.log("User cannot manage projects, skipping additional data fetch")}catch(o){J.value="Failed to load project data.",console.error("Error fetching project data:",o),o.response&&(o.response.status===401||o.response.status===403)&&(J.value="You are not authorized to view this project or your session expired. Please log in.")}finally{we.value=!1}},ht=()=>{y.value=!0},jt=o=>{d.value=o,y.value=!1,alert("Project updated successfully!"),Fe()},G=u([]),Ce=u(!1),De=u(""),oe=u(!1),de=u(null),h=u({name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,tags:[]}),E=u({}),Me=u([]),F=u([]),Le=u(!1),Ee=u(!1),$=u({status:"",assigned_to_user_id:"",milestone_id:"",due_date_range:""}),Ct=[{value:"",label:"All Dates"},{value:"today",label:"Due Today"},{value:"this_week",label:"Due This Week"},{value:"next_week",label:"Due Next Week"},{value:"overdue",label:"Overdue"},{value:"no_date",label:"No Due Date"}],ze=M(()=>!F.value||!F.value.length?[]:[...F.value].sort((o,e)=>o.completion_date?e.completion_date?new Date(o.completion_date)-new Date(e.completion_date):-1:1)),Qe=M(()=>G.value.length?G.value.filter(o=>{var e;if($.value.status&&o.status!==$.value.status)return!1;if($.value.assigned_to_user_id){const s=parseInt($.value.assigned_to_user_id);if(s===-1){if(o.assigned_to!=="Unassigned")return!1}else{const i=(e=d.value.users)==null?void 0:e.find(p=>p.id===s);if(i&&o.assigned_to!==i.name)return!1}}if($.value.milestone_id){const s=parseInt($.value.milestone_id);if(s===-1){if(o.milestone)return!1}else{const i=F.value.find(p=>p.id===s);if(i&&o.milestone!==i.name&&o.milestone_id!==s)return!1}}if($.value.due_date_range){const s=new Date;s.setHours(0,0,0,0);const i=o.due_date?new Date(o.due_date):null;switch($.value.due_date_range){case"today":if(!i||i.toDateString()!==s.toDateString())return!1;break;case"this_week":{if(!i)return!1;const p=new Date(s);if(p.setDate(s.getDate()+(6-s.getDay())),i<s||i>p)return!1;break}case"next_week":{if(!i)return!1;const p=new Date(s);p.setDate(s.getDate()+(7-s.getDay()));const D=new Date(p);if(D.setDate(p.getDate()+6),i<p||i>D)return!1;break}case"overdue":{if(!i||i>=s)return!1;break}case"no_date":{if(i)return!1;break}}}return!0}):[]),Dt=()=>{$.value={status:"",assigned_to_user_id:"",milestone_id:"",due_date_range:""}},ue=u(!1),ce=u(null),ve=u(""),ae=u(""),Be=u(!1),me=u(!1),O=u({name:"",description:"",completion_date:null,status:"Not Started",project_id:W().props.id}),L=u({}),Ie=u(!1),pe=async()=>{Ce.value=!0,De.value="";try{const o=W().props.id,e=await window.axios.get(`/api/projects/${o}/tasks`);G.value=e.data,console.log("Tasks fetched:",G.value)}catch(o){De.value="Failed to load tasks data.",console.error("Error fetching project tasks:",o),o.response&&o.response.data&&o.response.data.message&&(De.value=o.response.data.message)}finally{Ce.value=!1}},Ye=async()=>{Le.value=!0;try{const o=await window.axios.get("/api/task-types");Me.value=o.data}catch(o){console.error("Error fetching task types:",o)}finally{Le.value=!1}},Je=async()=>{Ee.value=!0;try{const o=W().props.id,e=await window.axios.get(`/api/projects/${o}/milestones`);F.value=e.data}catch(o){console.error("Error fetching milestones:",o)}finally{Ee.value=!1}},Mt=()=>{O.value={name:"",description:"",completion_date:null,status:"Not Started",project_id:W().props.id},L.value={},me.value=!0},Et=async()=>{L.value={},Ie.value=!0;try{const o=await window.axios.post("/api/milestones",O.value);F.value.push(o.data),h.value.milestone_id=o.data.id,me.value=!1,alert("Milestone created successfully!")}catch(o){console.error("Error creating milestone:",o),o.response&&o.response.data&&o.response.data.errors?L.value=o.response.data.errors:alert("Failed to create milestone. Please try again.")}finally{Ie.value=!1}},$t=async()=>{de.value=null,h.value={name:"",description:"",assigned_to_user_id:null,due_date:null,status:"To Do",task_type_id:null,milestone_id:null,tags:[]},E.value={},Me.value.length===0&&await Ye(),F.value.length===0&&await Je(),oe.value=!0},Tt=async o=>{var p;de.value=o,Me.value.length===0&&await Ye(),F.value.length===0&&await Je();let e=null;if(o.milestone){const D=F.value.find(Ne=>Ne.name===o.milestone);D&&(e=D.id)}let s=null;if(o.task_type){const D=Me.value.find(Ne=>Ne.name===o.task_type);D&&(s=D.id)}let i=null;if(o.assigned_to&&o.assigned_to!=="Unassigned"){const D=(p=d.value.users)==null?void 0:p.find(Ne=>Ne.name===o.assigned_to);D&&(i=D.id)}h.value={name:o.title,description:o.description||"",assigned_to_user_id:i||o.assigned_to_id||null,due_date:o.due_date||null,status:o.status,task_type_id:s||o.task_type_id||null,milestone_id:e,tags:o.tags||[]},E.value={},oe.value=!0},At=async o=>{try{await window.axios.post(`/api/tasks/${o.id}/complete`),await pe()}catch(e){console.error("Error marking task as completed:",e),alert("Failed to mark task as completed. Please try again.")}},Nt=async o=>{try{await window.axios.post(`/api/tasks/${o.id}/start`),await pe()}catch(e){console.error("Error starting task:",e),alert("Failed to start task. Please try again.")}},Vt=o=>{ce.value=o,ve.value="",ae.value="",ue.value=!0},St=async()=>{if(!ve.value.trim()){ae.value="Note content is required";return}ae.value="",Be.value=!0;try{await window.axios.post(`/api/tasks/${ce.value.id}/notes`,{note:ve.value}),ue.value=!1,ve.value="",ce.value=null,await pe(),alert("Note added successfully!")}catch(o){console.error("Error adding note to task:",o),o.response&&o.response.data&&o.response.data.message?ae.value=o.response.data.message:ae.value="Failed to add note. Please try again."}finally{Be.value=!1}},Pt=async()=>{E.value={};try{let o;de.value?o=await window.axios.put(`/api/tasks/${de.value.id}`,h.value):o=await window.axios.post("/api/tasks",{...h.value,milestone_id:h.value.milestone_id||null}),oe.value=!1,await pe()}catch(o){console.error("Error submitting task form:",o),o.response&&o.response.data&&o.response.data.errors?E.value=o.response.data.errors:alert("Failed to save task. Please try again.")}},ge=u([]),Ke=u(!1),b=u(""),x=u(null),le=u(!1),fe=u(!1),ye=u(!1),K=Ze({subject:"",body:""}),ne=u({}),$e=Ze({rejection_reason:""}),Te=u({}),B=u(""),xe=u(!1),C=Ze({project_id:"",client_ids:[],subject:"",body:""}),I=u({}),Ae=async()=>{Ke.value=!0,b.value="";try{const o=W().props.id,e=await window.axios.get(`/api/projects/${o}/emails-simplified`);ge.value=e.data}catch(o){b.value="Failed to load email data.",console.error("Error fetching project emails:",o)}finally{Ke.value=!1}},Xe=async()=>{Ge.value=!0;try{const o=W().props.id,e=await window.axios.get(`/api/projects/${o}/meetings`);qe.value=e.data}catch(o){console.error("Error fetching project meetings:",o)}finally{Ge.value=!1}},Ut=()=>{Z.value=!0},Rt=o=>{Xe()},Ft=async o=>{if(confirm("Are you sure you want to delete this meeting?"))try{const e=W().props.id;await window.axios.delete(`/api/projects/${e}/meetings/${o}`),Xe()}catch(e){console.error("Error deleting meeting:",e),alert("Failed to delete meeting. Please try again.")}},Lt=o=>{x.value=o,le.value=!0},Bt=async o=>{B.value="",b.value="";try{await window.axios.post(`/api/emails/${o.id}/approve`),B.value="Email approved successfully!",await Ae(),le.value=!1}catch(e){e.response&&e.response.data.message?b.value=e.response.data.message:(b.value="Failed to approve email.",console.error("Error approving email:",e))}},It=o=>{x.value=o,K.subject=o.subject,K.body=o.body,ne.value={},fe.value=!0,le.value=!1},Ot=async()=>{ne.value={},b.value="",B.value="";try{const o={subject:K.subject,body:K.body};await window.axios.post(`/api/emails/${x.value.id}/edit-and-approve`,o),B.value="Email updated and approved successfully!",fe.value=!1,await Ae()}catch(o){o.response&&o.response.status===422?ne.value=o.response.data.errors:o.response&&o.response.data.message?b.value=o.response.data.message:(b.value="Failed to update and approve email.",console.error("Error updating and approving email:",o))}},Wt=o=>{x.value=o,$e.rejection_reason="",Te.value={},ye.value=!0,le.value=!1},Ht=async()=>{Te.value={},b.value="",B.value="";try{await window.axios.post(`/api/emails/${x.value.id}/reject`,{rejection_reason:$e.rejection_reason}),B.value="Email rejected successfully!",$e.rejection_reason="",ye.value=!1,await Ae()}catch(o){o.response&&o.response.status===422?Te.value=o.response.data.errors:o.response&&o.response.data.message?b.value=o.response.data.message:(b.value="Failed to reject email.",console.error("Error rejecting email:",o))}},qt=()=>{C.project_id=d.value.id,C.client_ids=[],C.subject="",C.body="",I.value={},B.value="",xe.value=!0},Gt=async()=>{if(I.value={},b.value="",B.value="",!C.client_ids||C.client_ids.length===0){I.value.client_ids=["Please select at least one client."];return}try{const o=C.client_ids.map(s=>typeof s=="object"&&s!==null?{id:s.id}:{id:s}),e={project_id:C.project_id,client_ids:o,subject:C.subject,body:C.body,status:"pending_approval"};await window.axios.post("/api/emails",e),B.value="Email submitted for approval successfully!",C.client_ids=[],C.subject="",C.body="",I.value={},xe.value=!1,await Ae()}catch(o){o.response&&o.response.status===422?I.value=o.response.data.errors:o.response&&o.response.data.message?b.value=o.response.data.message:(b.value="Failed to submit email. An unexpected error occurred.",console.error("Error submitting email:",o))}};return es(async()=>{console.log("Component mounted, fetching data...");try{const o=W().props.id,e=await ts(o);console.log("Project permissions fetched (includes global):",e)}catch(o){console.error(`Error fetching permissions for project ${Q}:`,o)}await Fe(),await Ae(),await pe(),await Xe();try{await Ye(),await Je(),console.log("Task types and milestones fetched successfully")}catch(o){console.error("Error fetching task types or milestones:",o)}console.log("All data loaded, permission status:"),console.log("- Global permissions:",be.value),console.log("- Global permissions loading:",k.value),console.log("- Global permissions error:",A.value),console.log("- Project permissions:",X.value),console.log("- Project permissions loading:",Y.value),console.log("- Project permissions error:",Se.value),console.log("- User project role:",w.value),console.log("- Can manage projects:",Re.value)}),(o,e)=>(a(),l(T,null,[r(Oe(ss),{title:d.value.name||"Project Details"},null,8,["title"]),r(os,null,{default:m(()=>[t("div",ps,[we.value?(a(),l("div",gs," Loading project details... ")):J.value?(a(),l("div",fs,n(J.value),1)):(a(),l("div",ys,[t("div",xs,[t("div",_s,[e[55]||(e[55]=t("h4",{class:"text-lg font-semibold text-gray-900"},"General Information",-1)),Re.value||se.value?(a(),l("div",bs,[r(V,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors mr-2",onClick:ht},{default:m(()=>e[53]||(e[53]=[v(" Edit Project ")])),_:1,__:[53]}),r(V,{class:"bg-green-600 hover:bg-green-700 transition-colors",onClick:Ut},{default:m(()=>e[54]||(e[54]=[v(" Schedule Meeting ")])),_:1,__:[54]})])):c("",!0)]),t("div",ws,[t("div",null,[t("h3",ks,n(d.value.name),1),t("p",hs,n(d.value.description||"No description provided"),1)]),t("div",js,[t("p",null,[e[56]||(e[56]=t("strong",{class:"text-gray-900"},"Status:",-1)),v(" "+n(d.value.status.replace("_"," ").toUpperCase()),1)]),t("p",null,[e[57]||(e[57]=t("strong",{class:"text-gray-900"},"Project Type:",-1)),v(" "+n(d.value.project_type||"N/A"),1)]),t("p",null,[e[58]||(e[58]=t("strong",{class:"text-gray-900"},"Source:",-1)),v(" "+n(d.value.source||"N/A"),1)]),t("div",Cs,[d.value.website?(a(),l("a",{key:0,href:d.value.website,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Visit Website"},e[59]||(e[59]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})],-1)]),8,Ds)):c("",!0),d.value.social_media_link?(a(),l("a",{key:1,href:d.value.social_media_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Social Media"},e[60]||(e[60]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})],-1)]),8,Ms)):c("",!0),d.value.google_drive_link?(a(),l("a",{key:2,href:d.value.google_drive_link,target:"_blank",class:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",title:"Google Drive"},e[61]||(e[61]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)]),8,Es)):c("",!0)])])])]),t("div",$s,[e[66]||(e[66]=t("h4",{class:"text-md font-semibold text-gray-900 mb-2"},"Upcoming Meetings",-1)),Ge.value?(a(),l("div",Ts," Loading meetings... ")):qe.value.length===0?(a(),l("div",As," No upcoming meetings scheduled. ")):(a(),l("div",Ns,[(a(!0),l(T,null,N(qe.value,s=>(a(),l("div",{key:s.id,class:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors"},[t("div",Vs,[t("div",null,[t("h5",Ss,n(s.summary),1),t("p",Ps,n(new Date(s.start_time).toLocaleString())+" - "+n(new Date(s.end_time).toLocaleTimeString()),1),s.location?(a(),l("p",Us,[e[62]||(e[62]=t("span",{class:"font-medium"},"Location:",-1)),v(" "+n(s.location),1)])):c("",!0)]),t("div",Rs,[t("a",{href:s.google_event_link,target:"_blank",class:"text-blue-600 hover:text-blue-800",title:"View in Google Calendar"},e[63]||(e[63]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)]),8,Fs),s.google_meet_link?(a(),l("a",{key:0,href:s.google_meet_link,target:"_blank",class:"text-green-600 hover:text-green-800",title:"Join Google Meet"},e[64]||(e[64]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)]),8,Ls)):c("",!0),t("button",{onClick:i=>Ft(s.google_event_id),class:"text-red-600 hover:text-red-800",title:"Delete Meeting"},e[65]||(e[65]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Bs)])])]))),128))]))]),t("div",Is,[t("div",Os,[e[67]||(e[67]=t("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Pending Tasks",-1)),t("p",Ws,n(G.value.filter(s=>s.status!=="Done").length),1)]),t("div",Hs,[e[68]||(e[68]=t("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Unread Emails",-1)),t("p",qs,n(ge.value.filter(s=>s.status==="Received").length),1)]),t("div",Gs,[e[69]||(e[69]=t("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Last Email Received",-1)),t("p",zs,n(ge.value.filter(s=>s.status==="Received").length?ge.value.filter(s=>s.status==="Received")[0].date:"N/A"),1)]),t("div",Qs,[e[70]||(e[70]=t("h4",{class:"text-sm font-semibold text-gray-500 mb-1"},"Next Task Deadline",-1)),t("p",Ys,n(G.value.filter(s=>s.status!=="Completed").length?G.value.filter(s=>s.status!=="Completed").sort((s,i)=>new Date(s.due_date)-new Date(i.due_date))[0].due_date:"N/A"),1)])]),t("div",Js,[st.value?(a(),l("div",Ks,[e[77]||(e[77]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Financial Information",-1)),t("div",Xs,[t("p",null,[e[71]||(e[71]=t("strong",{class:"text-gray-900"},"Total Amount:",-1)),v(" $"+n(d.value.total_amount||"0.00"),1)]),t("p",null,[e[72]||(e[72]=t("strong",{class:"text-gray-900"},"Payment Type:",-1)),v(" "+n(d.value.payment_type.replace("_"," ").toUpperCase()),1)]),d.value.service_details&&d.value.service_details.length?(a(),l("div",Zs,[e[76]||(e[76]=t("strong",{class:"text-gray-900"},"Service Details:",-1)),t("div",eo,[(a(!0),l(T,null,N(d.value.service_details,s=>(a(),l("div",{key:s.service_id,class:"border border-gray-200 rounded-lg overflow-hidden"},[t("button",{onClick:i=>Ue.value=Ue.value===s.service_id?null:s.service_id,class:"w-full flex justify-between items-center p-3 bg-gray-50 hover:bg-gray-100 transition-colors text-left"},[t("div",so,[v(n(s.service_id)+": ",1),t("span",oo,"$"+n(s.amount),1)]),t("span",ao,[Ue.value===s.service_id?(a(),l("span",lo,"▼")):(a(),l("span",no,"▶"))])],8,to),Ue.value===s.service_id?(a(),l("div",ro,[t("div",io,[t("p",null,[e[73]||(e[73]=t("strong",null,"Frequency:",-1)),v(" "+n(s.frequency),1)]),t("p",null,[e[74]||(e[74]=t("strong",null,"Start Date:",-1)),v(" "+n(s.start_date||"N/A"),1)]),s.payment_breakdown?(a(),l("div",uo,[e[75]||(e[75]=t("p",{class:"font-medium text-gray-600"},"Payment Breakdown:",-1)),t("ul",co,[Array.isArray(s.payment_breakdown)?(a(!0),l(T,{key:1},N(s.payment_breakdown,(i,p)=>(a(),l("li",{key:p},n(i.label)+": "+n(i.percentage)+"% ",1))),128)):(a(),l(T,{key:0},[t("li",null,"First: "+n(s.payment_breakdown.first)+"%",1),t("li",null,"Second: "+n(s.payment_breakdown.second)+"%",1),t("li",null,"Third: "+n(s.payment_breakdown.third)+"%",1)],64))])])):c("",!0)])])):c("",!0)]))),128))])])):(a(),l("p",vo,"No service details available."))])])):c("",!0),xt.value?(a(),l("div",mo,[e[78]||(e[78]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Clients",-1)),d.value.clients&&d.value.clients.length?(a(),l("div",po,[(a(!0),l(T,null,N(d.value.clients,s=>(a(),l("div",{key:s.id,class:"border-l-4 border-indigo-500 pl-3"},[t("p",null,[t("strong",go,n(s.name),1)])]))),128))])):(a(),l("p",fo,"No clients assigned."))])):c("",!0),t("div",yo,[e[79]||(e[79]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Assigned Team",-1)),d.value.users&&d.value.users.length?(a(),l("div",xo,[(a(!0),l(T,null,N(d.value.users,s=>(a(),l("div",{key:s.id,class:"border-l-4 border-blue-500 pl-3"},[t("p",null,[t("strong",_o,n(s.name),1),v(" ("+n(s.pivot.role)+")",1)])]))),128))])):(a(),l("p",bo,"No team members assigned."))])]),t("div",wo,[t("div",ko,[e[81]||(e[81]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Project Tasks",-1)),t("div",ho,[r(S,{onClick:pe,disabled:Ce.value,class:"text-indigo-600 hover:text-indigo-800"},{default:m(()=>[Ce.value?(a(),l("span",Co,"Loading...")):(a(),l("span",jo,"Refresh"))]),_:1},8,["disabled"]),Re.value?(a(),nt(V,{key:0,class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:$t},{default:m(()=>e[80]||(e[80]=[v(" Add Task ")])),_:1,__:[80]})):c("",!0)])]),t("div",Do,[Ee.value?(a(),l("div",Mo," Loading milestones... ")):ze.value.length?(a(),l("div",$o,[e[86]||(e[86]=t("div",{class:"absolute h-1 bg-gray-200 top-1/2 left-0 right-0 transform -translate-y-1/2"},null,-1)),t("div",To,[(a(!0),l(T,null,N(ze.value,(s,i)=>(a(),l("div",{key:s.id,class:re(["flex flex-col items-center relative z-10",{"ml-4":i===0,"mr-4":i===ze.value.length-1}])},[t("div",{class:re(["w-6 h-6 rounded-full shadow-lg flex items-center justify-center",{"bg-gray-300":s.status==="Not Started","bg-blue-500":s.status==="In Progress","bg-green-500":s.status==="Completed","bg-red-500":s.status==="Overdue"}])},[s.status==="Completed"?(a(),l("svg",Ao,e[83]||(e[83]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):s.status==="In Progress"?(a(),l("svg",No,e[84]||(e[84]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))):s.status==="Overdue"?(a(),l("svg",Vo,e[85]||(e[85]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(a(),l("span",So))],2),t("div",Po,[t("p",{class:"text-xs font-medium text-gray-700 text-center truncate",title:s.name},n(s.name),9,Uo)]),t("div",Ro,[t("p",Fo,n(s.completion_date?new Date(s.completion_date).toLocaleDateString():"No date"),1)])],2))),128))])])):(a(),l("div",Eo,e[82]||(e[82]=[t("p",{class:"text-gray-400 text-sm"},"No milestones found for this project.",-1)])))]),t("div",Lo,[t("div",Bo,[t("div",Io,[e[88]||(e[88]=t("label",{for:"status-filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),j(t("select",{id:"status-filter","onUpdate:modelValue":e[0]||(e[0]=s=>$.value.status=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"},e[87]||(e[87]=[t("option",{value:""},"All Statuses",-1),t("option",{value:"To Do"},"To Do",-1),t("option",{value:"In Progress"},"In Progress",-1),t("option",{value:"Done"},"Done",-1),t("option",{value:"Blocked"},"Blocked",-1),t("option",{value:"Archived"},"Archived",-1)]),512),[[z,$.value.status]])]),t("div",Oo,[e[91]||(e[91]=t("label",{for:"assigned-filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Assigned To",-1)),j(t("select",{id:"assigned-filter","onUpdate:modelValue":e[1]||(e[1]=s=>$.value.assigned_to_user_id=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"},[e[89]||(e[89]=t("option",{value:""},"All Users",-1)),e[90]||(e[90]=t("option",{value:"-1"},"Unassigned",-1)),(a(!0),l(T,null,N(d.value.users,s=>(a(),l("option",{key:s.id,value:s.id},n(s.name),9,Wo))),128))],512),[[z,$.value.assigned_to_user_id]])]),t("div",Ho,[e[94]||(e[94]=t("label",{for:"milestone-filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Milestone",-1)),j(t("select",{id:"milestone-filter","onUpdate:modelValue":e[2]||(e[2]=s=>$.value.milestone_id=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"},[e[92]||(e[92]=t("option",{value:""},"All Milestones",-1)),e[93]||(e[93]=t("option",{value:"-1"},"No Milestone",-1)),(a(!0),l(T,null,N(F.value,s=>(a(),l("option",{key:s.id,value:s.id},n(s.name),9,qo))),128))],512),[[z,$.value.milestone_id]])]),t("div",Go,[e[95]||(e[95]=t("label",{for:"due-date-filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Due Date",-1)),j(t("select",{id:"due-date-filter","onUpdate:modelValue":e[3]||(e[3]=s=>$.value.due_date_range=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"},[(a(),l(T,null,N(Ct,s=>t("option",{key:s.value,value:s.value},n(s.label),9,zo)),64))],512),[[z,$.value.due_date_range]])]),t("div",{class:"flex items-end"},[t("button",{onClick:Dt,class:"px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md transition-colors"}," Clear Filters ")])]),Object.values($.value).some(s=>s!=="")?(a(),l("div",Qo,[t("p",null,[v(" Showing "+n(Qe.value.length)+" of "+n(G.value.length)+" tasks ",1),Qe.value.length===0?(a(),l("span",Yo," (No tasks match the current filters) ")):c("",!0)])])):c("",!0)]),Ce.value?(a(),l("div",Jo," Loading tasks... ")):De.value?(a(),l("div",Ko,[t("p",Xo,n(De.value),1)])):G.value.length?(a(),l("div",Zo,[t("table",ea,[e[96]||(e[96]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Title"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned To"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Due Date"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Milestone"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",ta,[(a(!0),l(T,null,N(Qe.value,s=>(a(),l("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[t("td",sa,n(s.title),1),t("td",oa,[t("span",{class:re({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-yellow-100 text-yellow-800":s.status==="To Do","bg-blue-100 text-blue-800":s.status==="In Progress","bg-green-100 text-green-800":s.status==="Done","bg-red-100 text-red-800":s.status==="Blocked","bg-gray-100 text-gray-800":s.status==="Archived"})},n(s.status),3)]),t("td",aa,n(s.assigned_to),1),t("td",la,n(s.due_date?s.due_date:"N/A"),1),t("td",na,n(s.milestone||"N/A"),1),t("td",ra,[t("div",ia,[t("button",{onClick:i=>Tt(s),class:"text-indigo-600 hover:text-indigo-800 text-sm font-medium"}," Edit ",8,da),t("button",{onClick:i=>Vt(s),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Add Note ",8,ua),s.status==="To Do"?(a(),l("button",{key:0,onClick:i=>Nt(s),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Start ",8,ca)):c("",!0),s.status!=="Done"?(a(),l("button",{key:1,onClick:i=>At(s),class:"text-green-600 hover:text-green-800 text-sm font-medium"}," Complete ",8,va)):c("",!0)])])]))),128))])])])):(a(),l("div",ma,e[97]||(e[97]=[t("p",{class:"text-gray-400 text-sm"},"No tasks found for this project.",-1),t("p",{class:"text-gray-500 text-sm mt-2"},' Click the "Add Task" button to create a new task. ',-1)])))]),bt.value?(a(),l("div",pa,[t("div",ga,[e[99]||(e[99]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Email Communication",-1)),wt.value?(a(),l("div",fa,[r(V,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:qt},{default:m(()=>e[98]||(e[98]=[v(" Compose Email ")])),_:1,__:[98]})])):c("",!0),B.value?(a(),l("div",ya,[t("span",xa,n(B.value),1)])):c("",!0)]),Ke.value?(a(),l("div",_a," Loading email data... ")):b.value?(a(),l("div",ba,n(b.value),1)):ge.value.length?(a(),l("div",wa,[t("table",ka,[e[101]||(e[101]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Subject"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"From"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",ha,[(a(!0),l(T,null,N(ge.value,s=>{var i;return a(),l("tr",{key:s.id,class:"hover:bg-gray-50 transition-colors"},[t("td",ja,n(s.subject),1),t("td",Ca,n(((i=s.sender)==null?void 0:i.name)||"N/A"),1),t("td",Da,n(new Date(s.created_at).toLocaleDateString()),1),t("td",Ma,[t("span",{class:re({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":s.status==="sent","bg-yellow-100 text-yellow-800":s.status==="pending_approval","bg-red-100 text-red-800":s.status==="rejected","bg-gray-100 text-gray-800":s.status==="draft"})},n(s.status.replace("_"," ").toUpperCase()),3)]),t("td",Ea,[r(S,{class:"text-indigo-600 hover:text-indigo-800",onClick:p=>Lt(s)},{default:m(()=>e[100]||(e[100]=[v(" View ")])),_:2,__:[100]},1032,["onClick"])])])}),128))])])])):(a(),l("p",$a,"No email communication found."))])):c("",!0),ot.value?(a(),l("div",Ta,[t("div",Aa,[e[103]||(e[103]=t("h4",{class:"text-lg font-semibold text-gray-900"},"Notes",-1)),Oe(je)("add_project_notes").value?(a(),l("div",Na,[r(V,{class:"bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:it},{default:m(()=>e[102]||(e[102]=[v(" Add Note ")])),_:1,__:[102]})])):c("",!0)]),d.value.notes&&d.value.notes.length?(a(),l("div",Va,[(a(!0),l(T,null,N(d.value.notes,s=>{var i;return a(),l("div",{key:s.id,class:"p-4 bg-gray-50 rounded-md shadow-sm hover:bg-gray-100 transition-colors"},[t("div",Sa,[t("div",Pa,[t("p",{class:re(["text-sm",{"text-gray-700":s.content!=="[Encrypted content could not be decrypted]","text-red-500 italic":s.content==="[Encrypted content could not be decrypted]"}])},[v(n(s.content)+" ",1),s.content==="[Encrypted content could not be decrypted]"?(a(),l("span",Ua," (There was an issue decrypting this note. Please contact an administrator.) ")):c("",!0)],2),t("div",Ra,[t("p",Fa,"Added by "+n(((i=s.user)==null?void 0:i.name)||"Unknown")+" on "+n(new Date(s.created_at).toLocaleDateString()),1),s.reply_count>0?(a(),l("span",La,n(s.reply_count)+" "+n(s.reply_count===1?"reply":"replies"),1)):c("",!0)])]),ot.value&&s.chat_message_id&&d.value.google_chat_id?(a(),l("div",Ba,[r(S,{class:"text-sm text-indigo-600 hover:text-indigo-800",onClick:p=>dt(s)},{default:m(()=>e[104]||(e[104]=[v(" View ")])),_:2,__:[104]},1032,["onClick"])])):c("",!0)])])}),128))])):(a(),l("p",Ia,"No notes available."))])):c("",!0)]))]),r(q,{show:y.value,onClose:e[5]||(e[5]=s=>y.value=!1)},{default:m(()=>[r(as,{show:y.value,project:d.value,statusOptions:ct,departmentOptions:vt,sourceOptions:mt,clientRoleOptions:pt,userRoleOptions:gt,paymentTypeOptions:ft,onClose:e[4]||(e[4]=s=>y.value=!1),onSubmit:jt},null,8,["show","project"])]),_:1},8,["show"]),r(q,{show:le.value,onClose:e[10]||(e[10]=s=>le.value=!1)},{default:m(()=>{var s;return[t("div",Oa,[t("div",Wa,[e[106]||(e[106]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Email Details",-1)),t("button",{onClick:e[6]||(e[6]=i=>le.value=!1),class:"text-gray-400 hover:text-gray-500"},e[105]||(e[105]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),x.value?(a(),l("div",Ha,[t("div",qa,[t("h4",Ga,n(x.value.subject),1),t("div",za,[t("div",null,[t("p",Qa,[e[107]||(e[107]=v("From: ")),t("span",Ya,n(((s=x.value.sender)==null?void 0:s.name)||"N/A"),1)]),t("p",Ja,[e[108]||(e[108]=v("Status: ")),t("span",{class:re({"px-2 py-1 rounded-full text-xs font-medium":!0,"bg-green-100 text-green-800":x.value.status==="sent","bg-yellow-100 text-yellow-800":x.value.status==="pending_approval","bg-red-100 text-red-800":x.value.status==="rejected","bg-gray-100 text-gray-800":x.value.status==="draft"})},n(x.value.status.replace("_"," ").toUpperCase()),3)])]),t("div",null,[t("p",Ka,[e[109]||(e[109]=v("Date: ")),t("span",Xa,n(new Date(x.value.created_at).toLocaleString()),1)])])])]),t("div",Za,[t("div",{innerHTML:x.value.body},null,8,el)]),x.value.rejection_reason?(a(),l("div",tl,[e[110]||(e[110]=t("h5",{class:"font-medium text-red-800"},"Rejection Reason:",-1)),t("p",sl,n(x.value.rejection_reason),1)])):c("",!0),x.value.approver?(a(),l("div",ol,[t("p",null,"Approved/Rejected by: "+n(x.value.approver.name),1),x.value.sent_at?(a(),l("p",al,"Sent at: "+n(new Date(x.value.sent_at).toLocaleString()),1)):c("",!0)])):c("",!0),x.value.status==="pending_approval"&&kt.value?(a(),l("div",ll,[r(V,{onClick:e[7]||(e[7]=i=>Bt(x.value)),class:"bg-green-600 hover:bg-green-700"},{default:m(()=>e[111]||(e[111]=[v(" Approve ")])),_:1,__:[111]}),r(V,{onClick:e[8]||(e[8]=i=>It(x.value)),class:"bg-blue-600 hover:bg-blue-700"},{default:m(()=>e[112]||(e[112]=[v(" Edit & Approve ")])),_:1,__:[112]}),r(S,{onClick:e[9]||(e[9]=i=>Wt(x.value)),class:"text-red-600 hover:text-red-800"},{default:m(()=>e[113]||(e[113]=[v(" Reject ")])),_:1,__:[113]})])):c("",!0)])):c("",!0)])]}),_:1},8,["show"]),r(ls,{show:g.value,"project-id":d.value.id,onClose:e[11]||(e[11]=s=>g.value=!1),onNoteAdded:Fe},null,8,["show","project-id"]),r(q,{show:fe.value,onClose:e[16]||(e[16]=s=>fe.value=!1),"max-width":"3xl"},{default:m(()=>[t("div",nl,[t("div",rl,[e[115]||(e[115]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Edit and Approve Email",-1)),t("button",{onClick:e[12]||(e[12]=s=>fe.value=!1),class:"text-gray-400 hover:text-gray-500"},e[114]||(e[114]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),x.value?(a(),l("div",il,[t("form",{onSubmit:Ve(Ot,["prevent"])},[b.value?(a(),l("div",dl,[t("span",ul,n(b.value),1)])):c("",!0),t("div",cl,[r(P,{for:"subject",value:"Subject"}),r(_e,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:K.subject,"onUpdate:modelValue":e[13]||(e[13]=s=>K.subject=s),required:""},null,8,["modelValue"]),r(U,{message:ne.value.subject?ne.value.subject[0]:"",class:"mt-2"},null,8,["message"])]),t("div",vl,[r(P,{for:"body",value:"Email Body"}),r(lt,{id:"body",modelValue:K.body,"onUpdate:modelValue":e[14]||(e[14]=s=>K.body=s),placeholder:"Edit your email here...",height:"300px"},null,8,["modelValue"]),r(U,{message:ne.value.body?ne.value.body[0]:"",class:"mt-2"},null,8,["message"])]),t("div",ml,[r(S,{onClick:e[15]||(e[15]=s=>fe.value=!1)},{default:m(()=>e[116]||(e[116]=[v("Cancel")])),_:1,__:[116]}),r(V,{type:"submit",class:"bg-green-600 hover:bg-green-700"},{default:m(()=>e[117]||(e[117]=[v("Save & Approve")])),_:1,__:[117]})])],32)])):c("",!0)])]),_:1},8,["show"]),r(q,{show:ye.value,onClose:e[20]||(e[20]=s=>ye.value=!1),"max-width":"2xl"},{default:m(()=>[t("div",pl,[t("div",gl,[e[119]||(e[119]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Reject Email",-1)),t("button",{onClick:e[17]||(e[17]=s=>ye.value=!1),class:"text-gray-400 hover:text-gray-500"},e[118]||(e[118]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),x.value?(a(),l("div",fl,[t("form",{onSubmit:Ve(Ht,["prevent"])},[b.value?(a(),l("div",yl,[t("span",xl,n(b.value),1)])):c("",!0),t("div",_l,[r(P,{for:"rejection_reason",value:"Rejection Reason"}),j(t("textarea",{id:"rejection_reason",rows:"5",class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full","onUpdate:modelValue":e[18]||(e[18]=s=>$e.rejection_reason=s),required:"",placeholder:"Please provide a reason for rejecting this email (minimum 10 characters)"},null,512),[[H,$e.rejection_reason]]),r(U,{message:Te.value.rejection_reason?Te.value.rejection_reason[0]:"",class:"mt-2"},null,8,["message"])]),t("div",bl,[r(S,{onClick:e[19]||(e[19]=s=>ye.value=!1)},{default:m(()=>e[120]||(e[120]=[v("Cancel")])),_:1,__:[120]}),r(V,{type:"submit",class:"bg-red-600 hover:bg-red-700"},{default:m(()=>e[121]||(e[121]=[v("Reject Email")])),_:1,__:[121]})])],32)])):c("",!0)])]),_:1},8,["show"]),r(q,{show:xe.value,onClose:e[26]||(e[26]=s=>xe.value=!1),"max-width":"3xl"},{default:m(()=>[t("div",wl,[t("div",kl,[e[123]||(e[123]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Compose New Email",-1)),t("button",{onClick:e[21]||(e[21]=s=>xe.value=!1),class:"text-gray-400 hover:text-gray-500"},e[122]||(e[122]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("form",{onSubmit:Ve(Gt,["prevent"])},[b.value?(a(),l("div",hl,[t("span",jl,n(b.value),1)])):c("",!0),t("div",Cl,[r(P,{for:"client_ids",value:"To (Clients)"}),r(Oe(rt),{id:"client_ids",modelValue:C.client_ids,"onUpdate:modelValue":e[22]||(e[22]=s=>C.client_ids=s),options:d.value.clients||[],multiple:!0,"close-on-select":!0,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select one or more clients",label:"name","track-by":"id",searchable:!0,"allow-empty":!0},{option:m(({option:s})=>[v(n(s.name),1)]),tag:m(({option:s,remove:i})=>[t("span",Dl,[v(n(s.name)+" ",1),t("i",{class:"multiselect__tag-icon",onClick:p=>i(s)},null,8,Ml)])]),_:1},8,["modelValue","options"]),r(U,{message:I.value.client_ids?I.value.client_ids[0]:"",class:"mt-2"},null,8,["message"])]),t("div",El,[r(P,{for:"subject",value:"Subject"}),r(_e,{id:"subject",type:"text",class:"mt-1 block w-full",modelValue:C.subject,"onUpdate:modelValue":e[23]||(e[23]=s=>C.subject=s),required:""},null,8,["modelValue"]),r(U,{message:I.value.subject?I.value.subject[0]:"",class:"mt-2"},null,8,["message"])]),t("div",$l,[r(P,{for:"body",value:"Email Body"}),r(lt,{id:"body",modelValue:C.body,"onUpdate:modelValue":e[24]||(e[24]=s=>C.body=s),placeholder:"Compose your email here...",height:"300px"},null,8,["modelValue"]),r(U,{message:I.value.body?I.value.body[0]:"",class:"mt-2"},null,8,["message"])]),t("div",Tl,[r(S,{onClick:e[25]||(e[25]=s=>xe.value=!1),class:"mr-2"},{default:m(()=>e[124]||(e[124]=[v("Cancel")])),_:1,__:[124]}),r(V,{type:"submit"},{default:m(()=>e[125]||(e[125]=[v("Submit for Approval")])),_:1,__:[125]})])],32)])]),_:1},8,["show"]),r(q,{show:_.value,onClose:e[30]||(e[30]=s=>_.value=!1)},{default:m(()=>{var s;return[t("div",Al,[t("div",Nl,[e[127]||(e[127]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Reply to Note",-1)),t("button",{onClick:e[27]||(e[27]=i=>_.value=!1),class:"text-gray-400 hover:text-gray-500"},e[126]||(e[126]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),R.value?(a(),l("div",Vl,[t("p",Sl,n(R.value.content),1),t("p",Pl,"Added by "+n(((s=R.value.user)==null?void 0:s.name)||"Unknown")+" on "+n(new Date(R.value.created_at).toLocaleDateString()),1)])):c("",!0),R.value?(a(),l("div",Ul,[e[130]||(e[130]=t("h4",{class:"text-sm font-medium text-gray-700 mb-2"},"Replies",-1)),he.value?(a(),l("div",Rl,e[128]||(e[128]=[t("p",{class:"text-gray-500 text-sm"},"Loading replies...",-1)]))):ke.value.length?(a(),l("div",Fl,[(a(!0),l(T,null,N(ke.value,i=>{var p;return a(),l("div",{key:i.id,class:"p-2 bg-gray-50 rounded border-l-2 border-indigo-300"},[t("p",Ll,n(i.content),1),t("p",Bl,"Replied by "+n(((p=i.user)==null?void 0:p.name)||"Unknown")+" on "+n(new Date(i.created_at).toLocaleDateString()),1)])}),128))])):(a(),l("div",Il,e[129]||(e[129]=[t("p",{class:"text-gray-500 text-sm"},"No replies yet. Be the first to reply!",-1)])))])):c("",!0),at.value?(a(),l("div",Ol,[e[131]||(e[131]=t("label",{for:"reply-content",class:"block text-sm font-medium text-gray-700 mb-1"},"Your Reply",-1)),j(t("textarea",{id:"reply-content","onUpdate:modelValue":e[28]||(e[28]=i=>ie.value=i),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your reply..."},null,512),[[H,ie.value]]),ee.value?(a(),l("p",Wl,n(ee.value),1)):c("",!0)])):c("",!0),at.value?(a(),l("div",Hl,[r(S,{onClick:e[29]||(e[29]=i=>_.value=!1),class:"mr-2"},{default:m(()=>e[132]||(e[132]=[v("Cancel")])),_:1,__:[132]}),r(V,{onClick:ut},{default:m(()=>e[133]||(e[133]=[v("Send Reply")])),_:1,__:[133]})])):c("",!0)])]}),_:1},8,["show"]),r(q,{show:oe.value,onClose:e[40]||(e[40]=s=>oe.value=!1)},{default:m(()=>[t("div",ql,[t("div",Gl,[t("h3",zl,n(de.value?"Edit Task":"Add New Task"),1),t("button",{onClick:e[31]||(e[31]=s=>oe.value=!1),class:"text-gray-400 hover:text-gray-500"},e[134]||(e[134]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("form",{onSubmit:Ve(Pt,["prevent"]),class:"space-y-4"},[t("div",null,[e[135]||(e[135]=t("label",{for:"task-name",class:"block text-sm font-medium text-gray-700"},"Task Name",-1)),j(t("input",{id:"task-name","onUpdate:modelValue":e[32]||(e[32]=s=>h.value.name=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Enter task name"},null,512),[[H,h.value.name]]),E.value.name?(a(),l("p",Ql,n(E.value.name[0]),1)):c("",!0)]),t("div",null,[e[136]||(e[136]=t("label",{for:"task-description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),j(t("textarea",{id:"task-description","onUpdate:modelValue":e[33]||(e[33]=s=>h.value.description=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter task description"},null,512),[[H,h.value.description]]),E.value.description?(a(),l("p",Yl,n(E.value.description[0]),1)):c("",!0)]),t("div",null,[e[138]||(e[138]=t("label",{for:"task-status",class:"block text-sm font-medium text-gray-700"},"Status",-1)),j(t("select",{id:"task-status","onUpdate:modelValue":e[34]||(e[34]=s=>h.value.status=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},e[137]||(e[137]=[t("option",{value:"To Do"},"To Do",-1),t("option",{value:"In Progress"},"In Progress",-1),t("option",{value:"Done"},"Done",-1),t("option",{value:"Blocked"},"Blocked",-1),t("option",{value:"Archived"},"Archived",-1)]),512),[[z,h.value.status]]),E.value.status?(a(),l("p",Jl,n(E.value.status[0]),1)):c("",!0)]),t("div",null,[e[139]||(e[139]=t("label",{for:"task-due-date",class:"block text-sm font-medium text-gray-700"},"Due Date",-1)),j(t("input",{id:"task-due-date","onUpdate:modelValue":e[35]||(e[35]=s=>h.value.due_date=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[H,h.value.due_date]]),E.value.due_date?(a(),l("p",Kl,n(E.value.due_date[0]),1)):c("",!0)]),t("div",null,[e[141]||(e[141]=t("label",{for:"task-assigned-to",class:"block text-sm font-medium text-gray-700"},"Assigned To",-1)),j(t("select",{id:"task-assigned-to","onUpdate:modelValue":e[36]||(e[36]=s=>h.value.assigned_to_user_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[140]||(e[140]=t("option",{value:null},"Unassigned",-1)),(a(!0),l(T,null,N(d.value.users,s=>(a(),l("option",{key:s.id,value:s.id},n(s.name),9,Xl))),128))],512),[[z,h.value.assigned_to_user_id]]),E.value.assigned_to_user_id?(a(),l("p",Zl,n(E.value.assigned_to_user_id[0]),1)):c("",!0)]),t("div",null,[e[143]||(e[143]=t("label",{for:"task-type",class:"block text-sm font-medium text-gray-700"},"Task Type",-1)),Le.value?(a(),l("div",en,"Loading task types...")):j((a(),l("select",{key:1,id:"task-type","onUpdate:modelValue":e[37]||(e[37]=s=>h.value.task_type_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[142]||(e[142]=t("option",{value:null},"Select a task type",-1)),(a(!0),l(T,null,N(Me.value,s=>(a(),l("option",{key:s.id,value:s.id},n(s.name),9,tn))),128))],512)),[[z,h.value.task_type_id]]),E.value.task_type_id?(a(),l("p",sn,n(E.value.task_type_id[0]),1)):c("",!0)]),t("div",null,[t("div",{class:"flex justify-between items-center"},[e[144]||(e[144]=t("label",{for:"task-milestone",class:"block text-sm font-medium text-gray-700"},"Milestone",-1)),t("button",{type:"button",onClick:Mt,class:"text-sm text-indigo-600 hover:text-indigo-800"}," + Create New Milestone ")]),Ee.value?(a(),l("div",on,"Loading milestones...")):j((a(),l("select",{key:1,id:"task-milestone","onUpdate:modelValue":e[38]||(e[38]=s=>h.value.milestone_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[145]||(e[145]=t("option",{value:null},"No milestone",-1)),(a(!0),l(T,null,N(F.value,s=>(a(),l("option",{key:s.id,value:s.id},n(s.name),9,an))),128))],512)),[[z,h.value.milestone_id]]),E.value.milestone_id?(a(),l("p",ln,n(E.value.milestone_id[0]),1)):c("",!0)]),t("div",nn,[r(S,{onClick:e[39]||(e[39]=s=>oe.value=!1)},{default:m(()=>e[146]||(e[146]=[v(" Cancel ")])),_:1,__:[146]}),r(V,{type:"submit",disabled:Le.value||Ee.value},{default:m(()=>[v(n(de.value?"Update Task":"Create Task"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),r(q,{show:me.value,onClose:e[47]||(e[47]=s=>me.value=!1)},{default:m(()=>[t("div",rn,[t("div",dn,[e[148]||(e[148]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Add New Milestone",-1)),t("button",{onClick:e[41]||(e[41]=s=>me.value=!1),class:"text-gray-400 hover:text-gray-500"},e[147]||(e[147]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("form",{onSubmit:Ve(Et,["prevent"]),class:"space-y-4"},[t("div",null,[e[149]||(e[149]=t("label",{for:"milestone-name",class:"block text-sm font-medium text-gray-700"},"Milestone Name",-1)),j(t("input",{id:"milestone-name","onUpdate:modelValue":e[42]||(e[42]=s=>O.value.name=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Enter milestone name"},null,512),[[H,O.value.name]]),L.value.name?(a(),l("p",un,n(L.value.name[0]),1)):c("",!0)]),t("div",null,[e[150]||(e[150]=t("label",{for:"milestone-description",class:"block text-sm font-medium text-gray-700"},"Description",-1)),j(t("textarea",{id:"milestone-description","onUpdate:modelValue":e[43]||(e[43]=s=>O.value.description=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:"3",placeholder:"Enter milestone description"},null,512),[[H,O.value.description]]),L.value.description?(a(),l("p",cn,n(L.value.description[0]),1)):c("",!0)]),t("div",null,[e[151]||(e[151]=t("label",{for:"milestone-completion-date",class:"block text-sm font-medium text-gray-700"},"Completion Date",-1)),j(t("input",{id:"milestone-completion-date","onUpdate:modelValue":e[44]||(e[44]=s=>O.value.completion_date=s),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[H,O.value.completion_date]]),L.value.completion_date?(a(),l("p",vn,n(L.value.completion_date[0]),1)):c("",!0)]),t("div",null,[e[153]||(e[153]=t("label",{for:"milestone-status",class:"block text-sm font-medium text-gray-700"},"Status",-1)),j(t("select",{id:"milestone-status","onUpdate:modelValue":e[45]||(e[45]=s=>O.value.status=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},e[152]||(e[152]=[t("option",{value:"Not Started"},"Not Started",-1),t("option",{value:"In Progress"},"In Progress",-1),t("option",{value:"Completed"},"Completed",-1),t("option",{value:"Overdue"},"Overdue",-1)]),512),[[z,O.value.status]]),L.value.status?(a(),l("p",mn,n(L.value.status[0]),1)):c("",!0)]),t("div",pn,[r(S,{onClick:e[46]||(e[46]=s=>me.value=!1),type:"button"},{default:m(()=>e[154]||(e[154]=[v(" Cancel ")])),_:1,__:[154]}),r(V,{type:"submit",disabled:Ie.value},{default:m(()=>[v(n(Ie.value?"Creating...":"Create Milestone"),1)]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),r(q,{show:ue.value,onClose:e[51]||(e[51]=s=>ue.value=!1)},{default:m(()=>[t("div",gn,[t("div",fn,[e[156]||(e[156]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Add Note to Task",-1)),t("button",{onClick:e[48]||(e[48]=s=>ue.value=!1),class:"text-gray-400 hover:text-gray-500"},e[155]||(e[155]=[t("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),ce.value?(a(),l("div",yn,[t("p",xn,n(ce.value.title),1),t("p",_n,"Status: "+n(ce.value.status),1)])):c("",!0),t("div",bn,[e[157]||(e[157]=t("label",{for:"task-note-content",class:"block text-sm font-medium text-gray-700 mb-1"},"Note Content",-1)),j(t("textarea",{id:"task-note-content","onUpdate:modelValue":e[49]||(e[49]=s=>ve.value=s),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full h-32",placeholder:"Enter your note..."},null,512),[[H,ve.value]]),ae.value?(a(),l("p",wn,n(ae.value),1)):c("",!0)]),t("div",kn,[r(S,{onClick:e[50]||(e[50]=s=>ue.value=!1),class:"mr-2"},{default:m(()=>e[158]||(e[158]=[v("Cancel")])),_:1,__:[158]}),r(V,{onClick:St,disabled:Be.value},{default:m(()=>[v(n(Be.value?"Adding...":"Add Note"),1)]),_:1},8,["disabled"])])])]),_:1},8,["show"]),r(ms,{show:Z.value,onClose:e[52]||(e[52]=s=>Z.value=!1),onSaved:Rt,projectId:d.value.id,projectUsers:d.value.users||[]},null,8,["show","projectId","projectUsers"])]),_:1})],64))}},Rn=ns(hn,[["__scopeId","data-v-3bf5629e"]]);export{Rn as default};
