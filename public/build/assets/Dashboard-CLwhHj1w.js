import{a as V,_ as I}from"./AuthenticatedLayout-n-kBzsPc.js";import{r as l,z as M,h as s,g as D,o as a,b as e,e as h,k as y,t as r,a as b,n as z,m as C,u as N,q as U,F as T,i as B,S as E}from"./app-BX-MO2gA.js";import{_ as W}from"./NotesModal-CNbZ4yGN.js";import{P as Y}from"./PrimaryButton-cDVGy_SR.js";import"./ApplicationLogo-BSjX68Gr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SecondaryButton-BYiqSkqb.js";import"./InputError-Ds8wopg2.js";import"./TextInput-BF0UT1k7.js";const F={class:"flex"},L={class:"flex-shrink-0"},q={key:0,class:"h-5 w-5 text-red-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},H={key:1,class:"h-5 w-5 text-indigo-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},O={class:"ml-3 flex-1 md:flex md:justify-between"},R={key:0,class:"text-sm text-indigo-700"},G={key:1,class:"text-sm text-green-700"},J={key:2,class:"text-sm text-red-700 font-medium"},K={key:3,class:"text-sm text-green-700"},Q={class:"mt-3 text-sm md:mt-0 md:ml-6"},X={__name:"AvailabilityPrompt",setup(P){const v=l(!1),g=l(!0),x=l([]),m=l(!1),_=l(""),p=l(!1),u=l(!1),c=l(null),w=l(!1),$=()=>{const o=localStorage.getItem("authToken");o&&!C.defaults.headers.common.Authorization&&(C.defaults.headers.common.Authorization=`Bearer ${o}`,console.log("Auth headers set in AvailabilityPrompt"))},k=async()=>{g.value=!0,_.value="";try{$();const o=await C.get("/api/availability-prompt");v.value=o.data.should_show_prompt,p.value=o.data.should_block_user,u.value=o.data.all_weekdays_covered,c.value=o.data.current_day,w.value=o.data.is_thursday_to_saturday,v.value&&A(o.data.next_week_start,o.data.next_week_end),localStorage.setItem("shouldBlockUser",p.value),localStorage.setItem("allWeekdaysCovered",u.value);const n=new CustomEvent("availability-status-updated",{detail:{shouldBlockUser:p.value,allWeekdaysCovered:u.value}});window.dispatchEvent(n)}catch(o){console.error("Error checking availability prompt:",o),v.value=!1,o.response&&o.response.status===401&&(o.value="Authentication error. Please refresh the page or log in again.")}finally{g.value=!1}},A=(o,n)=>{const d=[],t=new Date(o),i=new Date(n),f=new Date(t);for(;f<=i;)d.push({value:f.toISOString().split("T")[0],label:f.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})}),f.setDate(f.getDate()+1);x.value=d},S=()=>{m.value=!0},j=()=>{k()};return M(()=>{k()}),(o,n)=>v.value&&!g.value?(a(),s("div",{key:0,class:z(["border-l-4 p-4 mb-6 rounded-md shadow-sm",p.value?"bg-red-50 border-red-500":"bg-indigo-50 border-indigo-500"])},[e("div",F,[e("div",L,[p.value?(a(),s("svg",q,n[1]||(n[1]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(a(),s("svg",H,n[2]||(n[2]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)])))]),e("div",O,[c.value===4&&!u.value?(a(),s("p",R," Please submit your availability for next week. This helps in planning meetings and work schedules. ")):c.value===4&&u.value?(a(),s("p",G," Thank you for submitting your availability for next week! You can still update it if needed. ")):(c.value===5||c.value===6)&&!u.value?(a(),s("p",J,[n[3]||(n[3]=e("span",{class:"font-bold"},"Action Required:",-1)),y(" You must submit your availability for all weekdays of next week. "+r(p.value?"Other features are currently blocked until you complete this task.":""),1)])):(c.value===5||c.value===6)&&u.value?(a(),s("p",K," Thank you for submitting your availability for next week! You can still update it if needed. ")):D("",!0),e("p",Q,[h(Y,{onClick:S,class:z(["whitespace-nowrap",{"bg-red-600 hover:bg-red-700":p.value}])},{default:b(()=>[y(r(u.value?"Update Availability":"Submit Availability"),1)]),_:1},8,["class"])])])]),h(V,{show:m.value,"next-week-dates":x.value,date:x.value.length>0?x.value[0].value:"",onClose:n[0]||(n[0]=d=>m.value=!1),onAvailabilitySaved:j},null,8,["show","next-week-dates","date"])],2)):D("",!0)}},Z={class:"py-12"},ee={class:"mx-auto max-w-7xl sm:px-6 lg:px-8 space-y-6"},te={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},se={class:"p-6 text-gray-900"},ae={class:"flex justify-between items-center"},oe={class:"mt-1 text-sm text-gray-600"},le={class:"font-bold"},ie={key:0,class:"mt-4"},ne={key:0,class:"text-sm text-gray-500"},de={key:1,class:"text-sm text-red-500"},re={key:2,class:"text-sm text-gray-500"},ue={key:3,class:"mt-3"},ce={class:"min-w-full divide-y divide-gray-200"},pe={class:"bg-white divide-y divide-gray-200"},ve={class:"px-3 py-2 whitespace-nowrap text-sm"},xe={class:"px-3 py-2 whitespace-nowrap text-sm capitalize"},me={class:"px-3 py-2 whitespace-nowrap text-sm"},he={class:"flex space-x-2"},ye=["onClick"],ge={class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},_e={class:"p-6 text-gray-900"},fe={class:"flex justify-between items-center"},we={class:"mt-1 text-sm text-gray-600"},ke={class:"font-bold"},be={key:0,class:"mt-4"},Ce={key:0,class:"text-sm text-gray-500"},$e={key:1,class:"text-sm text-red-500"},Ae={key:2,class:"text-sm text-gray-500"},De={key:3,class:"mt-3"},Se={class:"min-w-full divide-y divide-gray-200"},je={class:"bg-white divide-y divide-gray-200"},Ne={class:"px-3 py-2 whitespace-nowrap text-sm"},Te={class:"px-3 py-2 whitespace-nowrap text-sm"},Pe={class:"px-3 py-2 whitespace-nowrap text-sm"},ze={class:"px-3 py-2 whitespace-nowrap text-sm"},Be={class:"px-3 py-2 whitespace-nowrap text-sm"},Ee={class:"flex space-x-2"},He={__name:"Dashboard",props:{projectCount:Number},setup(P){const v=l([]),g=l(!0),x=l(""),m=l(!1),_=l({total_due_tasks:0,projects:[]}),p=l(!1),u=l(""),c=l(!1),w=l(!1),$=l(null),k=async()=>{g.value=!0,x.value="";try{const d=await C.get("/api/projects-simplified");v.value=d.data}catch(d){x.value="Failed to load projects",console.error("Error fetching projects:",d)}finally{g.value=!1}},A=async()=>{p.value=!0,u.value="";try{const d=await C.get("/api/task-statistics");_.value=d.data}catch(d){u.value="Failed to load task statistics",console.error("Error fetching task statistics:",d)}finally{p.value=!1}},S=()=>{m.value=!m.value,m.value&&v.value.length===0&&k()},j=()=>{c.value=!c.value,c.value&&_.value.projects.length===0&&A()},o=d=>{$.value=d,w.value=!0},n=()=>{k()};return M(()=>{A()}),(d,t)=>(a(),s(T,null,[h(N(U),{title:"Dashboard"}),h(I,null,{header:b(()=>t[1]||(t[1]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Dashboard ",-1)])),default:b(()=>[e("div",Z,[e("div",ee,[h(X),e("div",te,[e("div",se,[e("div",ae,[t[2]||(t[2]=e("h3",{class:"text-lg font-medium text-gray-900"},"Projects",-1)),e("button",{onClick:S,class:"text-sm text-blue-600 hover:text-blue-800"},r(m.value?"Collapse":"Expand"),1)]),e("p",oe,[t[3]||(t[3]=y(" You have access to ")),e("span",le,r(P.projectCount),1),t[4]||(t[4]=y(" project(s). "))]),m.value?(a(),s("div",ie,[g.value?(a(),s("div",ne,"Loading projects...")):x.value?(a(),s("div",de,r(x.value),1)):v.value.length===0?(a(),s("div",re,"No projects found.")):(a(),s("div",ue,[e("table",ce,[t[6]||(t[6]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",pe,[(a(!0),s(T,null,B(v.value,i=>(a(),s("tr",{key:i.id},[e("td",ve,r(i.name),1),e("td",xe,r(i.status.replace("_"," ")),1),e("td",me,[e("div",he,[h(N(E),{href:`/projects/${i.id}`,class:"text-xs bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded"},{default:b(()=>t[5]||(t[5]=[y(" View ")])),_:2,__:[5]},1032,["href"]),e("button",{onClick:f=>o(i.id),class:"text-xs bg-purple-500 hover:bg-purple-700 text-white py-1 px-2 rounded"}," Notes ",8,ye)])])]))),128))])])]))])):D("",!0)])]),e("div",ge,[e("div",_e,[e("div",fe,[t[7]||(t[7]=e("h3",{class:"text-lg font-medium text-gray-900"},"Due Tasks",-1)),e("button",{onClick:j,class:"text-sm text-blue-600 hover:text-blue-800"},r(c.value?"Collapse":"Expand"),1)]),e("p",we,[t[8]||(t[8]=y(" You have ")),e("span",ke,r(_.value.total_due_tasks),1),t[9]||(t[9]=y(" task(s) due. "))]),c.value?(a(),s("div",be,[p.value?(a(),s("div",Ce,"Loading tasks...")):u.value?(a(),s("div",$e,r(u.value),1)):_.value.projects.length===0?(a(),s("div",Ae,"No due tasks found.")):(a(),s("div",De,[e("table",Se,[t[11]||(t[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Project Name"),e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Due Tasks"),e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Due Today"),e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Assigned Me"),e("th",{scope:"col",class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",je,[(a(!0),s(T,null,B(_.value.projects,i=>(a(),s("tr",{key:i.id},[e("td",Ne,r(i.name),1),e("td",Te,r(i.due_tasks),1),e("td",Pe,r(i.due_today),1),e("td",ze,r(i.assigned_to_me),1),e("td",Be,[e("div",Ee,[h(N(E),{href:`/projects/${i.id}`,class:"text-xs bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded"},{default:b(()=>t[10]||(t[10]=[y(" View ")])),_:2,__:[10]},1032,["href"])])])]))),128))])])]))])):D("",!0)])]),t[12]||(t[12]=e("div",{class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},[e("div",{class:"p-6 text-gray-900"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Notice Board"),e("p",{class:"mt-1 text-sm text-gray-600"}," No new announcements at this time. ")])],-1))])]),h(W,{show:w.value,"project-id":$.value,onClose:t[0]||(t[0]=i=>w.value=!1),onNoteAdded:n},null,8,["show","project-id"])]),_:1})],64))}};export{He as default};
